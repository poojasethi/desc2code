    #include<stdio.h>
    #include<math.h>
     
    int main()
    {
        unsigned long long n,t,i,j,t1,t2,ans,temp1,temp2;
        long power[100001];
        power[0]=1;
        for(i=1;i<100001;i++)
            power[i]=(power[i-1]*2)%1000000007;
        scanf("%llu",&t);
       while(t--)
        {
            ans=0;
            scanf("%llu",&n);
            scanf("%llu",&t1);
     
            for(j=0;j<n;j++)
            {
                scanf("%llu",&t2);
                temp1=(t2*t1);
                temp1%=1000000007;
                ans+=(temp1*power[n-j]);
                ans%=1000000007;
                t1+=(power[j]*t2);
                t1%=1000000007;
            }
            printf("%llu\n",ans);
        }
        return 0;
    }
      