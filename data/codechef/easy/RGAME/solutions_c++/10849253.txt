#include <iostream>
#include <math.h>
using namespace std;
#define MOD 1000000007
typedef long long ll;

int pwr[100000];

int main() {
	ll t;
	scanf("%lld",&t);
	
	pwr[0] = 1;
	for (int i = 1; i < 100000; i++)
		pwr[i] = (pwr[i - 1] << 1) % MOD;
		
	
	while(t--){
	
		ll n;
		scanf("%lld",&n);	
	
		ll sum = 0;
	
		ll ai;		
		scanf("%lld",&ai);	
		ll extra = 2*ai;
	
		for(int i=1;i<=n;i++){
			scanf("%lld",&ai);
			sum = (sum*2 + extra*ai)%MOD;		
			extra = (extra + pwr[i]*ai)%MOD;
			}
			
		printf("%lld\n",sum);
	}
	return 0;
}