#include <iostream>
#include <vector>
#include <stdio.h>
#include <algorithm>
#define mod 1000000007
#define ll long long
using namespace std;
ll a[100001];
ll b[100001];
void precompute()
{
    b[0]=2;
    b[1]=2;
    for(int i=2;i<100001;i++)
        b[i]=(2*b[i-1])%mod;
}
int main()
{
    precompute();
    int t;
    cin>>t;
    while(t--)
    {
        int n;
        cin>>n;
        n=n+1;
        cin>>a[0];
        ll c[n];
        ll p[n];
        p[0]=(b[0]*a[0])%mod;
        c[0]=p[0];
        for(int i=1;i<n;i++)
        {
            cin>>a[i];
            p[i]=(a[i]*b[i])%mod;
            c[i]=(c[i-1]+p[i])%mod;
        }
         if(n>=2){
            ll ans = a[0]*a[1]*2;
            for(int i=2;i<n;i++)
            {
                ans=(ans*2)%mod;
                a[i]=(a[i]*c[i-1])%mod;
                ans=(ans+a[i])%mod;
            }
            cout<<ans<<endl;
         }
         else
            cout<<"0"<<endl;
    }
}