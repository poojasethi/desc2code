import sys

# number of test cases
T = int(sys.stdin.readline())

modval = 1000000000 + 7

for testIndex in range(T):


    N = int(sys.stdin.readline())

    # N + 1 integers
    a = [ int(x) for x in sys.stdin.readline().split('\n')[0].split(' ')]

    if N == 0:
        print 0
        continue


    # generic solution
    overallsum = 0

    nextPowerTwo = 2
    prevLineterm = 0
    
    for i in range(1, N + 1):

        if (i > 1):
            # for i = 2 we go up to 2**j = 2**1
            assert nextPowerTwo == 2**(i-1)
            lineterm = (prevLineterm + nextPowerTwo * a[i-1]) % modval
                
            nextPowerTwo = (nextPowerTwo * 2) % modval
        else:
            lineterm = prevLineterm

        linesum = (lineterm + 2 * a[0] ) * a[i]
        # print "linesum=",i,linesum

        overallsum = (linesum + 2 * overallsum) % modval

        # prepare next iteration
        prevLineterm = lineterm


    print overallsum
        

            
        
        
        
    
