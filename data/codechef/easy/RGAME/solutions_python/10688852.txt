for t in xrange(int(raw_input())):
    n = int(raw_input())
    a = map(int, raw_input().split())
    sum = 2*(a[0]*a[1])
    p = a[0] + a[1]
    c = 2
    mod = (10**9)+7

    for i in range(2,n+1):
    	val = a[i]
    	sum = (2*(sum+ val*p))%mod
    	p = ((c*val)+p)%mod
    	c = (c*2)%mod
    print sum 	