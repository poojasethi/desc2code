M = 10**9 + 7
t = input()
while t:
    n = input()
    inpt = raw_input()
    li = inpt.split()
    for k in xrange(len(li)):
        li[k] = int(li[k])
    pr = 2*(li[0]*li[1])
    s = li[0]+li[1]
    c = 2
    for j in li[2:]:
        pr = 2*(pr+(j*s))%M
        s = ((c*j)+s)%M
        c = (c*2)%M
    print pr
    t -= 1

