for _ in range (int (raw_input())):
    n = int (raw_input())
    ques = raw_input()
    ans = raw_input()
    w = map (int, raw_input().split())
    
    m = w[0]
    num = 0
    for i in range (n):
        if ques[i] == ans[i]:
            num += 1
            m = max (m, w[num])
    if num == n:
        m = w[n]
    print m