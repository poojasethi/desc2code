total_cases = int(raw_input())
while total_cases > 0:
	ans = 0
	total_cases -= 1
	no_of_ques = int(raw_input())
	corr_ans = list(raw_input())
	my_ans = list(raw_input())
	winnings = [int(j) for j in raw_input().split()]
	k = 0
	for i in corr_ans:
		if i == my_ans[k]:
			ans = ans + 1
		k += 1
		
	if ans == no_of_ques:
		print winnings[ans]
	else:
		print max(winnings[:ans+1])