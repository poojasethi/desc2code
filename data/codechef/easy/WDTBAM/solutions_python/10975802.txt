def millionaire():
    for a in xrange(int(raw_input())):
        N=int(raw_input())
        str1=raw_input()
        str2=raw_input()
        w=map(int,raw_input().split())
        count=0
        out=w[0]
        for i in range(N):
            if(str1[i]==str2[i]):
                count=count+1
                out=max(out,w[count])
        if(count==N):
            out=w[N]
        print out
millionaire()
            
