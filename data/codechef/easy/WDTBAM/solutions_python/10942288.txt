def wdtbam(N, CoA, ChA, W):

	maxValue = W[0]
	cnt = 0

	for i in range(N):
		if(CoA[i] == ChA[i]):
			cnt+=1
		
	if(cnt == N):
		print W[N]
	else:
		print max(W[0:cnt+1])


def main():
	
		
	T = int(raw_input())
	for i in range(T):
		N = int(raw_input())
		CoA = list( raw_input() )
		ChA = list( raw_input() ) 
		W = map(int, raw_input().split())
		wdtbam(N, CoA, ChA, W)
	
main()