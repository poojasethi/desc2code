from sys import stdin

# The first line of input contains an integer T denoting the number of test cases. The description of T test cases follows.
# The first line of each test case contains a single integer N denoting the number of questions.
# Next line contains N capital Latin letters denoting the correct answers to these questions.
# Next line contains N capital Latin letters denoting answers given by Chef to these questions.
# Next line contains N + 1 space-separated integers W0, W1, ..., WN denoting the winnings for 0, 1, ..., N correct answers.

test_count = int(stdin.readline())

for i in range(0, test_count):
    question_count = int(stdin.readline())

    correct_answers = stdin.readline().strip()
    chef_answers = stdin.readline().strip()

    winnings = [int(x) for x in stdin.readline().strip().split(' ')]

    answers = zip(correct_answers, chef_answers)
    max_correct_answers = len([x for x in answers if x[0] == x[1]])

    if max_correct_answers == question_count:
        print winnings[max_correct_answers]
    else:
        print max(winnings[0:max_correct_answers+1])
