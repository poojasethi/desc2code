for _ in range(int(raw_input())):  #number of test cases
    qN = int(raw_input())
    correctAns = raw_input().strip()
    givenAns = raw_input().strip()
    winSum = map(int, raw_input().split())
    
    n = 0
    for e in range(len(correctAns)):
        if correctAns[e] == givenAns[e]:
            n += 1
        
    if n == qN:
        print winSum[n]
        
    else:
        maxW = winSum[0]
        for e in range(n+1):
            maxW = max(maxW, winSum[e])
        print maxW
         