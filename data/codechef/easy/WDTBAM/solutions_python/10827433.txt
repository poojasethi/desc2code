for t in xrange(int(raw_input())):
  n = int(raw_input())
  right = raw_input()
  chefs = raw_input()
  match = 0
  for i in xrange(n):
    if right[i] == chefs[i]:
      match += 1
  w = map(int, raw_input().split())
  if match == n:
    print w[n]
  else:
    print max(w[:match + 1])