n_test_cases = int(raw_input())

for i in range(0, n_test_cases):
	n_questions = int(raw_input())
	answers = list(raw_input())
	chef_answers = list(raw_input())
	scores = [int(i) for i in raw_input().split()]

	# print n_questions
	# print answers
	# print chef_answers
	# print scores

	score = 0

	for c_i, chef_answer in enumerate(chef_answers):
		if answers[c_i] == chef_answer:
			score += 1

	if(score==n_questions):
		print scores[n_questions]
	else:
		print max(scores[0:score+1])
