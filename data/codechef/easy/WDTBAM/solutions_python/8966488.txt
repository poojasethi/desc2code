#codechef ProblemCode:  WDTBAM
for testcases in xrange( int(raw_input()) ) :
    l = int(raw_input() )
    str1 = str( raw_input() )
    str2 = str( raw_input() )
    winnings = map(int, raw_input().split() )
    correct = 0
    for i in xrange( l ) :
        if ( str1[i] == str2[i] ) :
            correct += 1
    print (winnings[-1] if correct == l else max(winnings[:correct+1]) )