import sys

test_cases = int(sys.stdin.readline())
while test_cases > 0:
    test_cases -= 1
    no_of_questions = int(sys.stdin.readline())
    correct_answer = sys.stdin.readline()
    chefs_answer = sys.stdin.readline()
    weight = map(int, sys.stdin.readline().split())
    correct_answers = 0
    for i in range(0, no_of_questions):
        if correct_answer[i] == chefs_answer[i]: correct_answers += 1
    if correct_answers == no_of_questions: print weight[no_of_questions]
    else: print max(weight[0:correct_answers + 1:1])