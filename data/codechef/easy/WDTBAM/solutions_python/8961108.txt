for t in xrange(int(raw_input())):
	n=int(raw_input())
	C=raw_input()
	Q=raw_input()
	score=map(int,raw_input().split())
	correct=0
	for i in xrange(n):
		if C[i]==Q[i]:
			correct+=1
	if (correct==n):
		print score[-1]
	else:
		print max(score[:correct+1]) 