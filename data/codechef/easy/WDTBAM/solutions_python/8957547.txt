for _ in range(input()):
    numberOfQuestion = input()
    correctAns=list(raw_input())
    chefAns=list(raw_input())
    winList=list(map(int,raw_input().split()))
    count=0
    for i in range(len(chefAns)):
        if correctAns[i]==chefAns[i]:
            count+=1
    print(winList[numberOfQuestion] if count==numberOfQuestion else max(winList[:count+1]))