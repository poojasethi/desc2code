# -*- coding: utf-8 -*-
"""
Spyder Editor

This is a temporary script file.
"""

"""
The first line of input contains an integer T denoting the number of test cases. The description of T test cases follows.

The first line of each test case contains a single integer N denoting the number of questions.

Next line contains N capital Latin letters denoting the correct answers to these questions.

Next line contains N capital Latin letters denoting answers given by Chef to these questions.

Next line contains N + 1 space-separated integers W0, W1, ..., WN denoting the winnings for 0, 1, ..., N correct answers.
"""

Correct_answers=""
Chefs_answers =""
Max_op=[]

T=raw_input()


for i in range (0,int(T)):
    N=raw_input()
    Correct_answers=raw_input()
    
    Chefs_answers=raw_input()
    
    Weights=raw_input()
    Weights=Weights.split(' ')
    temp=[]
    
    max_=0
    count=0
    
    for j in range (0,int(N)):
        if Correct_answers[j]==Chefs_answers[j]:
            count+=1
    if count<int(N):
        for j in range(0,count+1):
            if int(Weights[j])>max_:
                max_=int(Weights[j])
    else :
                max_=int(Weights[int(N)])
            
    
    Max_op.append(max_)
    

for i in Max_op:
    print i