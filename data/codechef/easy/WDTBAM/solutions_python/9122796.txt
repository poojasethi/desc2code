total_tests = input()
 
while total_tests > 0:
    questions = input()
    correct = list(raw_input())
    actual = list(raw_input())
    scores = map(int, raw_input().split())
    good_answers = 0
    highest = scores[good_answers]
    for i in range(questions):
        if actual[i] == correct[i]:
            good_answers += 1
            if (good_answers == questions or scores[good_answers] > highest):
                highest = scores[good_answers]
    print highest
    total_tests -= 1