# cook your code here
def wdtb():
    n=input()
    q=raw_input()
    a=raw_input()
    c=0
    sc=[int(j) for j in raw_input().split()]
    for x in range(len(q)):
        if q[x]==a[x]:
            c+=1
    print max(sc[:c+1]) if c!=n else sc[-1]
    
for i in range(input()):
    wdtb()