#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
int main()
{
    ll t;
    cin>>t;
    while(t--)
    {
        ll n;
        cin>>n;
        string corr;
        string av_ans;
        cin>>corr;
        cin>>av_ans;
        ll s[n+1];
        for(ll i=0;i<n+1;i++)
        cin>>s[i];
        ll count=0;
        ll max=s[0];
        for(ll i=0;i<n;i++)
        {
            if(corr[i]==av_ans[i])
            {
                count++;
                if(s[count]>max)
                    max=s[count];
            }
        }
        if (count<n)
        cout<<max<<endl;
        else if(count==0)
            cout<<s[0]<<endl;
        else if(count==n)
            cout<<s[n]<<endl;


    }
}
