#include <iostream>
#include <bits/stdc++.h>
typedef long long int ll;

using namespace std;
ll arr[1000] = {};

int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,cnt=0;
		cin>>n;
		string s1,s2;
		cin>>s1>>s2;
		for(int i=0;i<=n;i++)
		{
			cin>>arr[i];
		}
		for(unsigned int i=0;i<s1.length();i++)
		{
			if(s1[i]==s2[i])
				cnt++;
		}
		if(cnt == n)
			cout<<arr[cnt]<<endl;
		else  //since rewards are ranged in random order
		{
			ll ans = 0;
			for(int i=0;i<=cnt;i++)
			{
				ans = max(ans,arr[i]);
			}
			cout<<ans<<endl;
		}
	}
	return 0;
}
