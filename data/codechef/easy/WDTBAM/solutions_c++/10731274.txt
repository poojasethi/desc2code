#include <iostream>
using namespace std;

int main() {
	int t,c,i,n;
	char *x,*y;
	long long int *w,max;
	cin>>t;
	while(t--)
	{
		cin>>n;
		x=new char[n];
		y=new char[n];
		w=new long long int[n+1];
		c=0,max=0;
		for(i=0;i<n;i++)
		cin>>x[i];
		for(i=0;i<n;i++)
		cin>>y[i];
		for(i=0;i<n;i++)
		{
			if(x[i]==y[i])
			c++;
		}
		for(i=0;i<n+1;i++)
		cin>>w[i];
		if(c==n)// if all answers are correct cant quit game in b/w , thus will be bound to take last index w[n-1] 
		max=w[n]; //n not n-1
		else
		{
			for(i=0;i<=c;i++)
			{
				if(w[i]>max)
				{
					max=w[i];
				}	
			}
		}	
		cout<<max<<endl;
	}	
	return 0;
}