#include <iostream>
#include<vector>

using namespace std;

int fast_read()
{
    int value=0;
    char hld;
    fread(&hld,1,1,stdin);
    while(!(hld>='0'&&hld<='9'))
    {
        fread(&hld,1,1,stdin);
    }
    while(hld>='0'&&hld<='9')
    {
        value=(value<<3)+(value<<1)+(hld-'0');
         fread(&hld,1,1,stdin);
    }
    return value;
}

char fast_read_char()
{
    char ch;
    fread(&ch,1,1,stdin);
    while(!(ch>='A' && ch <='Z'))
        fread(&ch,1,1,stdin);
    return ch;
}

int main()
{
    int t,n,run,cor_ans,max_val;
    vector<int> w;
    vector<char> ans,que;
    char ch;
    t=fast_read();
    while(t>0)
    {
        n=fast_read();
        cor_ans=0;
        max_val=0;
        que.clear();
        ans.clear();
        w.clear();

        for(run=0;run<n;run++)
        {
            ch=fast_read_char();
            que.push_back(ch);

        }
        for(run=0;run<n;run++)
        {
            ch=fast_read_char();
            ans.push_back(ch);

            if(ans.at(run)==que.at(run)){cor_ans++;}
        }

        for(run=0;run<=n;run++)
        {
            w.push_back(fast_read());
        }

        if(cor_ans==0){max_val=w.at(0);}
        else if(cor_ans==n){max_val=w.at(n);}
        else{
                for(run=0;run<=n;run++)
                        {
                           if(w.at(run)>max_val && run<=cor_ans)
                           {
                               max_val=w.at(run);
                           }
                        }
                }

        printf("%d\n",max_val);
        t--;
    }
    return 0;
}
