#include <iostream>
using namespace std;
 
int main() {
 
	int numTests;
	int numQuestions;
	int maxCorrect;
	unsigned long long maxScore;
	cin >> numTests;
 
	for (int testNum = 0; testNum < numTests; testNum++) {
 
	
		cin >> numQuestions;
 
		//Generate arrays for chef answers, correct answers, and scores.
		char chefAnswers[numQuestions];
		char correctAnswers[numQuestions];
		unsigned long long scores[numQuestions + 1];
 
		for (int i = 0; i < numQuestions; i++) {
			cin >> chefAnswers[i];
		}
 
		for (int i = 0; i < numQuestions; i++) {
			cin >> correctAnswers[i];
		}
 
		for (int i = 0; i < numQuestions + 1; i++) {
			cin >> scores[i];
		}
 
		//Iterate through char arrays.
		maxCorrect = 0;
		for (int index = 0; index < numQuestions; index++) {
			if (chefAnswers[index] == correctAnswers[index]) {
				maxCorrect += 1;
			}
		}	
 
		//Now search for max score possible
		if (maxCorrect == numQuestions) {
			maxScore = scores[maxCorrect];
		}
		else {
			maxScore = 0;
			for (int i = 0; i <= maxCorrect; i++) {
				if (scores[i] > maxScore) {
					maxScore = scores[i];
				}
			}
		}		
 
 
		cout << maxScore << "\n";
		}
	}