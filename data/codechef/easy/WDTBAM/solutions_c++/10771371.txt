 #include<iostream>
    using namespace std;
    int main()
    {
     
        int t;
		cin>>t;
        while(t--)
        {
        	int n,i,j,k=0;
			long long int ans;
        	cin>>n;
        	char a[n],b[n];
        	cin>>a;
        	cin>>b;
        	int c[n+1];
        	for(i=0;i<=n;i++)
        	cin>>c[i];
        	for(j=0;j<n;j++){
        		if(a[j]==b[j])
        		k++;
			}
			ans=c[0];
			if(k==n)
			cout<<c[n]<<endl;
			else{
				for(i=0;i<=k;i++){
					if(ans<c[i])
					ans=c[i];
				}
				cout<<ans<<endl;
			}
        }
        return 0;
    }
    