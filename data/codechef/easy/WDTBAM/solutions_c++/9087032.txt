#include<stdio.h>
main()
{
    int q,w,e,r,t,y,u,count,j;
    scanf("%d",&q);
    while(q--)
    {
        scanf("%d",&w);
        char a[w+1];
        char b[w+1];
        int  c[w+1];
        scanf("%s",a);
        scanf("%s",b);
        for(e=0;e<w+1;e++)
        {
            scanf("%d",&c[e]);
           // printf("\nc=%d",c[e]);

        }
       // printf("%s",a);
       // printf("%s",b);
        count=0;
        t=c[0];

    for(r=0;r<w;r++)
    {
        if(a[r]==b[r])
        {
            count++;
            //printf("\nok");
        }
    }
  // printf("\ncount=%d",count);
  //  printf("\nt=%d",t);
  if(count==0)
        {
            printf("%d\n",c[0]);
        }
   if(count==w)
   {
       printf("%d\n",c[w]);
   }
   else
   {



    for(j=1;j<=count;j++)
    {

        if(t<c[j])
        {


            t=c[j];
        }
    }
    if(count!=0)
    {
        printf("%d\n",t);

    }
   }



}
}
