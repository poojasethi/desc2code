  #include <iostream>
#include <iomanip>
#include <stdio.h>
#include <vector>
 
using namespace std;
 
int main(){ long long int T,N,i,ctr,WinP;
				char A[1011],B[1011];
				long long int Prize=0;
				
			cin>>T;
			while(T-->0)
			{cin>>N;
			
			vector <long long int> W;
			ctr=0;
			
			for(i=0;i<N;i++)
				{cin>>A[i];}
				
			for(i=0;i<N;i++)
				{cin>>B[i];}
				
				
				
				
			for(i=0;i<=N;i++)
				{
				cin>>WinP;
				W.push_back(WinP); 
				}
				
				Prize=W[0];
				
				
				for(i=0;i<N;i++)
				{
				if (A[i]==B[i])
				{ctr+=1;
				
				if (Prize<W[ctr])
							{Prize=W[ctr];}
				}
				
				}
				if (ctr==N)
				{Prize=W[N];}
				
				
				
				cout<<Prize<<endl;
				
			
 
		} 
	
return 0;	
		
}   