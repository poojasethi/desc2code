#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <cmath>
#include <vector>
#include <string>
#include <iostream>

using namespace std;

int n,t;
int res[501];
vector<int> w;
string s1,s2;


int main()
{
    int wi,isti;

    scanf("%d",&t);
    for(int i = 0; i < t;i++)
    {
        scanf("%d",&n);
        cin >> s1;
        cin >> s2;
        isti = 0;
        w.clear();
        for(int j = 0; j <= n;j++)
        {
         scanf("%d",&wi);
         w.push_back(wi);

        }

        for(int j = 0;j < n;j++)
            if(s1[j] == s2[j])
                isti++;


        if(isti == n) res[i] = w[n];

        else
         for(int j = 0;j <= isti;j++)
            if(w[j]>res[i]) res[i] = w[j];

    }


    for(int i = 0;i < t;i++)
      printf("%d\n",res[i]);

    return 0;
}
