#include <iostream>
#include <queue>
#include <utility>
using namespace std;

int main(){
	int T,N;
	cin >> T;
	
	while(T--){
		cin>>N;
		int count=0;
		char Ans[N];
		priority_queue< pair<int,int> > Q;
		char myans;
		for(int i=0;i<N;i++){
			cin>>Ans[i];
		}
		
		for(int i=0;i<N;i++){
			cin>>myans;
			if(myans == Ans[i])count++;
		}
		int mny;
		for(int i=0;i<N+1;i++){
			cin>>mny;
			Q.push(make_pair(mny,-i));
		}
	    while(!Q.empty()){
			int no = -1 * Q.top().second;
			mny = Q.top().first;
			Q.pop();
			
			//cout<<count<<","<<no<<","<<mny<<endl;
			
			if(no == count)break;	
			if(no < count && count < N)break;
		}
		
		cout<<mny<<endl;
	
	}
	
	
	
	
	
	
}
