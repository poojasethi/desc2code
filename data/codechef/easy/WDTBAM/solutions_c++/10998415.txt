#include <iostream>
#include <algorithm>
#include <cstring>
using namespace std;

int main() {
	int t;
	cin>>t;
	while(t)
	{
	    int n;
	    cin>>n;
    	long long int w[n+1];
    	string arr1, arr2;
    	cin >> arr1;
    	cin >> arr2;
    	for(int i=0;i<n+1;i++){
    	    cin >> w[i];
    	}
    	int cnt=0;
    	for(int i=0;i<n;i++){
    	    if(arr1[i]==arr2[i])
    	    {
    	        cnt++;
    	    }
    	}
    	if(cnt==n){
    	    cout << w[n] <<endl;
    	}
    	else{
    	    cout<< *max_element(w,w+cnt+1) << endl;
    	}
    	t--;
	}
	return 0;
}
