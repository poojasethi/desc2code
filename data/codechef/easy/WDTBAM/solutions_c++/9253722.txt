#include <bits/stdc++.h>

using namespace std;

int main()
{
	int n,t,i,count=0;
	
    string s1;
    string s2;
    long long int W[10000];
    scanf("%d",&t);
    while(t--)
    {
    	count=0;
        scanf("%d",&n);
         cin>>s1>>s2;
        for(i=0;i<n;i++)
        {
            if(s1[i]==s2[i])
                ++count;
        }
              for(i = 0;i<= n;i++) {
            cin >> W[i];
            if (i > 0 && count != n)
                W[i] = max(W[i],W[i-1]);
        }
        printf("%lld\n",W[count]);
            }

    return 0;
}
