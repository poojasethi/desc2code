for t in xrange(int(raw_input())):
  n = int(raw_input())
  coords = []
  for x in xrange(n):
    for y, cell in enumerate(map(int, raw_input().split())):
      coords.append((cell, x, y))
  coords.sort()
  moves = 0
  x, y = coords[0][1:]
  for coord in coords[1:]:
    moves += abs(x - coord[1]) + abs(y - coord[2])
    x, y = coord[1:]
  print moves