# finds number of steps between two given numbers in a given matrix

def location_finder(matrix):
    location_list = []
    for row_index, row in enumerate(matrix):
        for col_index, num in enumerate(row):
            location_list.append((num, row_index, col_index))
    location_list.sort()
    return sorted(location_list)



def step_counter(matrix):
    L = location_finder(matrix)
    total_steps = 0
    for i in range(N**2 - 1):
        total_steps += abs(L[i][1] - L[i+1][1]) + abs(L[i][2] - L[i+1][2])
    return total_steps



#get input and run on each

T = int(raw_input())
for i in range(T):
    N = int(raw_input())
    matrix = []
    for i in range(N):
        matrix.append([int(j) for j in raw_input().split()])
    print step_counter(matrix)
    
