for testcases in xrange( input() ) :
    size = input()
    matrix = []
    list1 = []
    for x in xrange( size ) :
        Line = map(int, raw_input().split() )
        for y in xrange(len(Line) ) :
            list1.append( [ Line[y], x, y ] ) 
    dist = 0
    list1.sort()
    for i in xrange( len(list1) - 1) :
        dist += ( abs( list1[i][1] - list1[i+1][1] ) + abs( list1[i][2] - list1[i+1][2] ) )
    print dist