#codechef ProblemCode: MSTEP
for testcases in xrange( int(raw_input() ) ) :
    size = int(raw_input())
    matrix = []
    locList = []
    for x in xrange( size ) :
        Line = map(int, raw_input().split() )
        for y in xrange(len(Line) ) :
            locList.append( [ Line[y], x, y ] ) 
    
    dist = 0
    locList.sort()
    for i in xrange( len(locList) - 1) :
        dist += ( abs( locList[i][1] - locList[i+1][1] ) + abs( locList[i][2] - locList[i+1][2] ) )
    print dist