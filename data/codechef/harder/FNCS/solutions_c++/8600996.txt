#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define m	405
#define	n	100005
#define I64	long long
#define For(i,a,b)	for(int i=a,lim=b;i<lim;i++)

#define CH	(ch=getchar())
int		IN(){
		int x=0,ch;
		for	(;CH<'0'||ch>'9';);
		for	(;ch>='0'&&ch<='9';CH)	(x*=10)+=ch-'0';
		return	x;
}

int		N,Q,A[n],L[n],R[n],G[m][n];
I64		S[m],T[n];

void	Add(int x,int k){
		for (;x<N;x+=x&-x)	T[x]+=k;
}
I64		Ask(int x){
		I64	ret=0;
		for (;x;x-=x&-x)	ret+=T[x];
		return	ret;
}

int		main(){
		N=IN();	N++;
		For(i,1,N)	A[i]=IN(),Add(i,A[i]);
		For(i,1,N)	L[i]=IN(),R[i]=IN();

		int D=300;
		for (int i=0,t=0;i<N;i+=D,t++)	{
			For(j,i,min(i+D,N))	G[t][L[j]]++,G[t][R[j]+1]--;
			For(j,1,N)	G[t][j]+=G[t][j-1],S[t]+=1ll*A[j]*G[t][j];
		}

		for (Q=IN();Q--;)	{
			int k=IN(),x=IN(),y=IN();
			if	(k==1)	{
				Add(x,-A[x]+y);
				for (int i=0,t=0;i<N;i+=D,t++)	S[t]+=1ll*(-A[x]+y)*G[t][x];	A[x]=y;
			}	else	{
				I64	Ans=0;	int a=x/D,b=y/D;
				if	(a==b||a+1==b)	{
					For(i,x,y+1)	Ans+=Ask(R[i])-Ask(L[i]-1);
				}	else	{
					For(i,a+1,b)	Ans+=S[i];
					For(i,x,(a+1)*D)Ans+=Ask(R[i])-Ask(L[i]-1);
					For(i,b*D,y+1)	Ans+=Ask(R[i])-Ask(L[i]-1);
				}
				printf("%llu\n",Ans);
			}
		}
}