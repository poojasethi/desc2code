#include <iostream>
#include <stdio.h>
#include <string.h>
#include <algorithm>
#include <cmath>
#include <map>
#include <vector>
#include <queue>
using namespace std;
#define x first
#define y second
#define pii pair<int,int>
#define vi vector<int>
#define pb push_back
#define mp make_pair
#define all(x) x.begin(),x.end()
#define FOREACH(it,x) for(typeof(x.begin())it=x.begin();it!=x.end();it++)
#define DBG(x) cerr<<#x<<"="<<x<<"\n";
#define ull unsigned long long
#define ll long long
#define inf 1000000007
#define mod 1000000007
#define N 100010
 
typedef pair<ll,int>pli;
pli find(ll l,ll r)
{
    ll m;
    if(l==r)return pli(0,1);
    for(m=1;m<=r;m<<=1);
    m/=2;
    if(l==0){
        ll val=2*m-1;
        int res=2LL*(m%mod)*((r-m+1)%mod)%mod;
        if(r<2*m-1)return pli(val,res);
        return pli(val,2LL*res%mod);
    }
    if(r==2*m-1)return find(0,r-l);
    if(l<m){
        pli p1=find(0,r-m);
        pli p2=find(0,m-1-l);
        if(p2.x>p1.x)swap(p1,p2);
        if(p1.x==p2.x)p1.y=(p1.y+p2.y)%mod;
        return p1;
    }
    return find(l-m,r-m);
}
int main()
{
    int i,j,k,ca=0,m,T;
    scanf("%d",&T);
    while(T--)
    {
        ll l,r;
        cin>>l>>r;
        pli ans=find(l,r);
        cout<<ans.x<<" "<<ans.y<<"\n";
    }
    return 0;    
} 