#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

int t,n,m,a[4][100005],w[4],r[4],mi,out;
char c,s[10];

void update(int z)
{
	int s=0,temp;
	while ((r[0]<w[0])&&(a[0][r[0]]<=z))
	{
		r[0]++;
	}
	s+=w[0]-r[0];
	while ((r[1]<w[1])&&(a[1][r[1]]<=z))
	{
		r[1]++;
	}
	s+=r[1];
	temp=0;
	while ((r[2]<w[2])&&(a[2][r[2]]==z))
	{
		r[2]++;
		temp++;
	}
	s+=w[2]-temp;
	temp=0;
	while ((r[3]<w[3])&&(a[3][r[3]]==z))
	{
		r[3]++;
		temp++;
	}
	s+=temp;
//printf("%d  %d\n",z,s);
	if ((z>0)&&(z<=1000000000))
	{
		out=min(out,s);
	}
}	

void pro()
{
	out=100005;
	int temp=0;
	while (1)
	{
		mi=2000000000;
		for (int i=0; i<4; i++)
		{
			if ((r[i]<w[i])&&(a[i][r[i]]<mi))
			{
				mi=a[i][r[i]];
			}
		}
		if (mi==2000000000)
		{
			break;
		}
		if (temp+1!=mi)
		{
			temp++;
			update(temp);
		}
		temp=mi;
		update(temp);
	}
	if (temp<1000000000)
	{
		update(1000000000);
	}
}	

int main()
{
	scanf("%d",&t);
	while (t--)
	{
		scanf("%d",&n);
		memset(w,0,sizeof(w));
		for (int i=0; i<n; i++)
		{
			do
			{
				c=fgetc(stdin);
			}while ((c!='>')&&(c!='<')&&(c!='='));
			scanf("%d%s",&m,s);
			if (s[0]=='Y')
			{
				if (c=='>')
				{
					a[0][w[0]]=m+1;
					w[0]++;
				}
				else
				if (c=='<')
				{
					a[1][w[1]]=m;
					w[1]++;
				}
				else
				{
					a[2][w[2]]=m;
					w[2]++;
				}
			}
			else
			{
				if (c=='>')
				{
					a[1][w[1]]=m+1;
					w[1]++;
				}
				else
				if (c=='<')
				{
					a[0][w[0]]=m;
					w[0]++;
				}
				else
				{
					a[3][w[3]]=m;
					w[3]++;
				}
			}	
		}
		for (int i=0; i<4; i++)
		{
			sort(a[i],a[i]+w[i]);
		}
		memset(r,0,sizeof(r));
		pro();
		printf("%d\n",out);
	}
	return 0;
}
