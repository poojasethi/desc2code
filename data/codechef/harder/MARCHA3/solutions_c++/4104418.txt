#include <stdio.h>
#include <iostream>
#include <algorithm>
#include <vector>
#include <string>
#define mp make_pair

using namespace std;
const int INF=(int)1e9;

int test, m, n;

int main() {
    scanf("%d",&test);
    while (test--) {
        vector <pair<int, int> > v;
        string s1, s2;
        int x, sum=0, ans=0;
        scanf("%d",&m);
        int temp=m;
        while (m--) {
            cin>>s1>>x>>s2;
            if (s2=="Yes")
                if (s1==">") {
                    if (x==INF) continue;
                    v.push_back(mp(x+1,-1));
                    v.push_back(mp(INF,1));
                }
                else if (s1=="<") {
                    if (x==1) continue;
                    v.push_back(mp(1,-1));
                    v.push_back(mp(x-1,1));
                }
                else {
                    v.push_back(mp(x,-1));
                    v.push_back(mp(x,1));
                }
            if (s2=="No")
                if (s1==">") {
                    v.push_back(mp(1,-1));
                    v.push_back(mp(x,1));
                }
                else if (s1=="<") {
                    v.push_back(mp(x,-1));
                    v.push_back(mp(INF,1));
                }
                else {
                    if (x>1) {
                        v.push_back(mp(1,-1));
                        v.push_back(mp(x-1,1));
                    }
                    if (x<INF) {
                        v.push_back(mp(x+1,-1));
                        v.push_back(mp(INF,1));
                    }
                }
        }
        sort(v.begin(),v.end());
        for (int i=0;i<v.size();i++) {
            sum+=v[i].second;
            if (v[i].second<0) ans=min(ans,sum);
        }
        printf("%d\n",temp+ans);
    }
}
