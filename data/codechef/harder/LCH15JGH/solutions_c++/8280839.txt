#include<bits/stdc++.h>
using namespace std;
 
 
const int f=320;
long long cnt[f+5];
long long bit[100050];
long long tot;
long long query(long long x)
{
    long long s=0;
    while(x)s+=bit[x],x-=x&-x;
    return s;
}
void updat(long long x,long long s)
{
    while(x<100005)bit[x]+=s,x+=x&-x;
}
void insert(long long x,long long y)
{
    if(x<f)cnt[x]+=y;
    else
    {
        tot+=y;
        long long z=-1ll*x*y;
        for(int i=x;i<100005;i+=x)
            updat(i,z);
    }
}
int main()
{
    //freopen("1.txt","r",stdin);
    long long n,m,x,y;
    while(~scanf("%lld",&n))
    {
        memset(cnt,0,sizeof(cnt));
        memset(bit,0,sizeof(bit));
        for(int i=0;i<n;i++)
            scanf("%lld%lld",&x,&y),insert(x,y);
        scanf("%lld",&m);
        char s[6];
        for(int i=0;i<m;i++)
        {
            scanf("%s%lld",s,&y);
            if(s[0]=='?')
            {
                long long sum=0;
                for(int i=1;i<f;i++)
                    sum+=y%i*cnt[i];
                sum+=tot*y+query(y);
                printf("%lld\n",sum);
            }
            else
                insert(y,s[0]=='+'?1:-1);
        }
    }
    return 0;
}