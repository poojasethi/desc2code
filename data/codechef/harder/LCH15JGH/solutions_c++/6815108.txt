#include <bits/stdc++.h>
#define maxn 100000+3
using namespace std;
#define ll long long
long long total ,a, b, ans;
long long BIT[maxn];
int y, n, m;
char op;

ll read()
{
    ll x=0,f=1;char ch=getchar();
    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}
    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}
    return x*f;
}
void add(int i, long long int b) {
    i++;
    while(i < maxn){
        BIT[i] += b;
        i += i&-i;
    }
}
long long sum(int i) {
    i++;
    long long temp = 0;
    while(i>0) {
        temp += BIT[i];
        i -= i&-i;
    }
    return temp;
}
long long getSum(int l, int r) {
    return ( sum(r)-sum(l-1) );
}
void cal(int a) {
    
    long long temp = 0;
    ans = 0;
    ans += (total*a);
    
    int l = 1;
    
    while(l <= a) {
        int x = (a/l);    
        int r = (a/x);
        
        r = min(r, a);
        temp += ( getSum(l,r)*x );
        l = r+1;
    }
    ans = ans - temp;
    printf("%lld\n", ans);
}
int main() {
    scanf("%d",&n);
    total = 0;
	for(int i=0;i<n;i++) {
	    a = read();
	    b = read();
		total += b;
		add(a, a*b);
	}
	
	scanf("%d",&m);
	while(m--) {
		scanf(" %c %d ",&op, &y);
		if(op == '?') {
		    cal(y);
		} else if(op == '+') {
			add(y, y);
			total++;
		} else if(op == '-'){
			add(y, -y);
			total--;
		}
	}

}