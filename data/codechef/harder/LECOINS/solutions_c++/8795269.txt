#include <stdio.h>
#include <stdlib.h>
#include <map>
#include <string.h>
#include <algorithm>
using namespace std;

int T,n,m,c,i,j,k,l,p,u,v;
int a[35],b[35],d[35];
int q[1000005],ll,rr;
long long f[35][200005],g[35][200005],t[35][200005],x;
bool inq[200005];

map <int,int> Hash;

int main()
{
	scanf("%d",&n);
	for(i=1;i<=n;++i)
	{
		scanf("%d%d",&a[i],&b[i]);
		if(!Hash[b[i]])Hash[b[i]]=++m;
		b[i]=Hash[b[i]];
	}
	c=a[1];
	for(i=1;i<=n;++i)if(a[i]<c)c=a[i];
	for(i=1;i<=n;++i)if(a[i]==c)k=b[i];
	for(i=1;i<=n;++i)if(b[i]==k)b[i]=m;else if(b[i]==m)b[i]=k;
	memset(f,0x7f,sizeof(f));
	memset(g,0x7f,sizeof(g));
	f[0][0]=0;
	for(i=1;i<=m;++i)
	{
		memcpy(g,f,sizeof(f));
		k=0;
		for(j=1;j<=n;++j)if(b[j]==i)d[++k]=a[j];
		for(j=0;j<i;++j)
		for(l=0;l<c;++l)
		for(p=1;p<=k;++p)
		{
			u=(l+d[p])%c;
			if(g[j][l]+d[p]<f[j+1][u])f[j+1][u]=g[j][l]+d[p];
		}
		for(j=1;j<=i;++j)
		{
			ll=rr=0;
			for(l=0;l<c;++l)q[++rr]=l,inq[l]=true;
			while(ll!=rr)
			{
				++ll;if(ll==1000000)ll=1;
				u=q[ll];inq[u]=false;
				for(p=1;p<=k;++p)
				{
					v=(u+d[p])%c;
					if(f[j][u]+d[p]<f[j][v])
					{
						f[j][v]=f[j][u]+d[p];
						if(!inq[v])
						{
							++rr;if(rr==1000000)rr=1;
							q[rr]=v;inq[v]=true;
						}
					}
				}
			}
		}
	}
	scanf("%d",&T);
	for(;T;--T)
	{
		scanf("%lld",&x);
		u=x%c;v=-1;
		for(i=0;i<=m;++i)
		{
			if(f[i][u]<=x&&i>v)v=i;
			if(g[i][u]<x&&i+1>v)v=i+1;
		}
		printf("%d\n",v);
	}
}