#include<cstdio>
#include<cstring>
#include<algorithm>
#include<set>
#include<map>
#include<vector>
#define rep(i,j,k) for(int i=(int)j;i<=(int)k;i++)
#define per(i,j,k) for(int i=(int)j;i>=(int)k;i--)
using namespace std;
typedef long long LL;
typedef double db;
const int N=32;
const int V=200005;
LL inf;
inline void Min(LL &x,LL y){if(y<x)x=y;}
struct thi{int w,c;}a[N];
inline bool cmp(const thi &a,const thi &b){return a.c<b.c;}
int n;
LL f[N][V];
LL g[V];
int M;
void relax(int l,int r,int pp){
	rep(i,0,M-1)g[i]=inf;
	rep(i,l,r)rep(k,0,M-1)
	Min(g[(k+a[i].w)%M],f[pp][k]+a[i].w);
	//printf("__%d %d %d\n",pp,l,r);
	rep(i,l,r){
		int xx=__gcd(a[i].w,M);
		rep(j,0,xx-1){
			Min(g[(j+a[i].w)%M],g[j]+a[i].w);
			for(int k=(j+a[i].w)%M;k!=j;k=(k+a[i].w)%M)
			Min(g[(k+a[i].w)%M],g[k]+a[i].w);
		
			Min(g[(j+a[i].w)%M],g[j]+a[i].w);
			for(int k=(j+a[i].w)%M;k!=j;k=(k+a[i].w)%M)
			Min(g[(k+a[i].w)%M],g[k]+a[i].w);
		}
	}
	
	//printf("____%lld %lld\n",g[3],f[1][3]);
	rep(j,0,M-1)Min(f[pp+1][j],g[j]);
	//printf("____%lld %lld\n",g[3],f[1][3]);
}
int main(){
	inf=2;
	rep(i,1,18)inf=inf*10ll;
	scanf("%d",&n);
	rep(i,1,n)scanf("%d%d",&a[i].w,&a[i].c);
	sort(a+1,a+1+n,cmp);
	M=a[n].w;
	rep(i,0,n)rep(j,0,M-1)f[i][j]=inf;
	
	f[0][0]=0;
	
	int tt=0;
	for(int i=1;i<=n;i++){
		int j=i;
		while(a[j+1].c==a[i].c)j++;
		per(k,tt,0)relax(i,j,k);
		tt++;
		i=j;
	}
	int Q;scanf("%d",&Q);
	while(Q--){
		LL S;scanf("%lld",&S);
		int ans=-1;
		per(i,tt,0){if(f[i][S%M]<=S){ans=i;break;}}
		printf("%d\n",ans);
	}
	return 0;
}

