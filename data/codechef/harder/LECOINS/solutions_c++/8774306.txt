#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n	35
#define m	200005
#define I64	long long
#define INF	(1ll<<60)
#define For(i,a,b)	for(int i=a;i<=b;i++)
#define Rep(i,a,b)	for(int i=a;i>=b;i--)

I64		F[n][m];
int		N,M,V,Q;
struct	Nod{int v,c;}A[n];

bool	Cmp(Nod a,Nod b)	{return	a.c<b.c;}
void	Min(I64&a,I64 b)	{a=min(a,b);}

void	Upd(int d,int l,int r){
		For(i,l,r)	{
			For(j,0,V)	Min(F[d][(j+A[i].v)%V],F[d-1][j]+A[i].v);
			int g=__gcd(A[i].v,V),t=V/g*2;
			For(s,0,g-1)for	(int k=1,x,y=s;k<=t;k++,y=x)
				Min(F[d][x=(y+A[i].v)%V],F[d][y]+A[i].v);
		}
}

int		main(){
		scanf("%d",&N);	V=1<<30;
		For(i,1,N)	scanf("%d%d",&A[i].v,&A[i].c),V=min(V,A[i].v);
		sort(A+1,A+N+1,Cmp);

		For(i,0,V)	F[0][i]=INF;	F[0][0]=0;
		for	(int i=1,j;i<=N;i=j+1){
			for	(j=i;j+1<=N&&A[j+1].c==A[j].c;j++);	M++;
			For(k,0,V)	F[M][k]=INF;
			Rep(k,M,1)	Upd(k,i,j);
		}

		scanf("%d",&Q);
		for	(I64 S;Q--;){
			scanf("%lld",&S);	int Ans=M;
			for	(;Ans>=0;Ans--)	if	(F[Ans][S%V]<=S)	break;
			printf("%d\n",Ans);
		}
}