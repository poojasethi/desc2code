#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <algorithm>
#include <utility>
#define m_p(x,y) make_pair(x,y)
const long long oo=(1LL<<60);
using namespace std;
typedef long long ll;
struct tag{
    long long a,b;
}t[2],s[8000000][2];
int n,m,ss,root,l[8000000],r[8000000];
int ori()
{
	++ss;
	s[ss][0].a=s[ss][0].b=-oo,
	s[ss][1].a=s[ss][1].b=0;
	l[ss]=r[ss]=0;
	return ss;
}
pair < ll , ll > ask(int x,long long L,long long R,int w)
{
    if (!x) return m_p(-oo,0);
    if (L==R) {
        return m_p(s[x][0].b,s[x][1].b);
    }
    long long mid=((L+R)>>1);
    pair < ll ,ll > sum;
    if (w<=mid) sum=ask(l[x],L,mid,w);
    else sum=ask(r[x],mid+1,R,w);
    if (s[x][0].a>-oo && s[x][0].b>-oo) sum.first=max(sum.first,s[x][0].a*(w-L)+s[x][0].b);
   // cout<<w<<' '<<s[x][0].a<<' '<<s[x][0].b<<' '<<L<<' '<<R<<endl;
    sum.second+=s[x][1].a*(w-L)+s[x][1].b;
    return sum;
}
bool cmp(tag p,tag q,long long x)
{
	if (p.a<=-oo || p.b<=-oo) return 1;
	if (p.a*x+p.b!=q.a*x+q.b)
		return p.a*x+p.b<q.a*x+q.b;
	return p.a<q.a;
}
void pushdown(int x,long long L,long long R,tag t)
{
	if (L==R) {
		if (cmp(s[x][0],t,L-L)) s[x][0]=t;
		return ;
	}
	long long mid=(L+R)>>1;
	if (cmp(s[x][0],t,L-L)) swap(s[x][0],t);
	if (s[x][0].a==t.a || t.a<=-oo) return ;
	long long p=(t.b-s[x][0].b)/(s[x][0].a-t.a)+L;
	//cout<<p<<' '<<L<<' '<<R<<endl;
	for (long long k=max(L,p-3);k<=min(R,p+3);k++) 
		if (cmp(s[x][0],t,k-L)) {
			if (k<=mid) {
				if (!l[x]) l[x]=ori();
				swap(s[x][0],t);
				pushdown(l[x],L,mid,t);
			}
			else {
				if (!r[x]) r[x]=ori();
				if (t.a>-oo) t.b+=t.a*(mid+1-L);
				pushdown(r[x],mid+1,R,t);
			}
			break;
		}
	//cout<<s[x][1].a<<' '<<s[x][1].b<<' '<<L<<' '<<R<<endl;
}
void updata(tag s[],tag t[],int e,int x,long long L,long long R)
{
	if (e) {
		if (t[1].a || t[1].b) {
            s[1].a+=t[1].a;
            s[1].b+=t[1].b;
            //cout<<s[1].a<<' '<<s[1].b<<' '<<L<<' '<<R<<endl;
    }
	}
	else {
		if (t[0].a>-oo && t[0].b>-oo) {
			pushdown(x,L,R,t[0]);
			//cout<<s[0].a<<' '<<s[0].b<<' '<<L<<' '<<R<<' '<<t[0].a<<' '<<t[0].b<<endl;
    }
	}
}
void modify(int x,long long L,long long R,long long ls,long long rs,tag t[])
{
		if (L>R) return ;
		long long mid=((L+R)>>1);
    if (L==ls && R==rs) {
				updata(s[x],t,1,x,L,R);
        updata(s[x],t,0,x,L,R);
        return ;
    }
    if (rs<=mid) {
        if (!l[x]) l[x]=ori();
        modify(l[x],L,mid,ls,rs,t);
    }
    else if (ls>=mid+1) {
        if (!r[x]) r[x]=ori();
        modify(r[x],mid+1,R,ls,rs,t);
    }
    else {
        if (!l[x]) l[x]=ori();
        if (!r[x]) r[x]=ori();
        modify(l[x],L,mid,ls,mid,t);
        tag tt[2];
        tt[0]=t[0],tt[1]=t[1];
        if (tt[0].a>-oo) tt[0].b+=tt[0].a*(mid+1-ls);
        tt[1].b+=tt[1].a*(mid+1-ls);
        modify(r[x],mid+1,R,mid+1,rs,tt);
    }
}
int main()
{
    scanf("%d%d",&n,&m);
    ss=0;
    root=ori();
    for (int i=1;i<=m;i++) {
    	int c;
			long long a,b,L,R;
        scanf("%d",&c);
        if (3==c) {
        		long long x;
            scanf("%lld",&x);
            pair < ll , ll > ans;
            ans=ask(root,1,n,x);
            if (ans.first>-oo) printf("%lld\n",ans.first+ans.second);
            else printf("NA\n");
        }
        else if (1==c) {
            scanf("%lld%lld%lld%lld",&L,&R,&a,&b);
            t[0].a=a,t[0].b=b,t[1].a=0,t[1].b=0;
            modify(root,1,n,L,R,t);
        }
        else if (2==c) {
            scanf("%lld%lld%lld%lld",&L,&R,&a,&b);
            t[0].a=-oo,t[0].b=-oo,t[1].a=a,t[1].b=b;
            modify(root,1,n,L,R,t);
        }
    }
    return 0;
}