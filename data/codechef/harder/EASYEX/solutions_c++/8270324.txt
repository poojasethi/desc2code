#include <cmath>
#include <cstdio>
#include <algorithm>
using namespace std;

#define n	1005
#define P	2003
#define m	200005
#define DB	double
#define I64	long long
#define For(i,a,b)	for(int i=a;i<b;i++)

const	DB	Pi=acos(-1);
int		T,M,N,K,L,F,rev[m],S[n][n];

struct	Cpx{
		DB	x,y;
		Cpx	operator +	(const Cpx&a)	{return	(Cpx){x+a.x,y+a.y};}
		Cpx	operator -	(const Cpx&a)	{return	(Cpx){x-a.x,y-a.y};}
		Cpx	operator *	(const Cpx&a)	{return	(Cpx){x*a.x-y*a.y,x*a.y+y*a.x};}
}A[m],B[m],w[2][m];

void	Pre(){
		For(i,0,M)	{
			w[1][i]=w[0][i]=(Cpx){cos(2*Pi/M*i),sin(2*Pi/M*i)};	w[1][i].y*=-1;	rev[i]=0;
			for (int x=1,t=i;x<M;x<<=1,t>>=1)	(rev[i]<<=1)|=t&1;
		}
}
void	FFT(Cpx*A,int f)	{
		For(i,0,M)	if	(rev[i]>i)	swap(A[i],A[rev[i]]);
		for (int i=1;i<M;i<<=1)
		for (int j=0,t=M/(i<<1);j<M;j+=i<<1)
		for (int k=0,l=0;k<i;k++,l+=t){
			Cpx	x=A[j+k],y=A[j+k+i]*w[f][l];
			A[j+k]=x+y;	A[j+k+i]=x-y;
		}
		if	(f)	For(i,0,M)	A[i].x/=M;
}

int		Pow(int a,int b){
		int ret=1;
		for (;b;b>>=1,a=a*a%P)
			if	(b&1)	ret=ret*a%P;
		return	ret;
}

int		main(){
		S[0][0]=1;
		For(i,1,n)	For(j,1,i+1)
			S[i][j]=(S[i-1][j]*j+S[i-1][j-1])%P;

		scanf("%d",&T);
		for (;T--;)	{
			scanf("%d%d%d%d",&N,&K,&L,&F);
			for (M=1;M<=L*F+1;M<<=1);	M<<=1;
			For(i,0,M)	A[i]=B[i]=(Cpx){0,0};
			For(i,0,F+1)A[i]=(Cpx){S[F][i],0};	B[0]=(Cpx){1,0};

			int TL=L;
			for (int t=1;;L>>=1,t<<=1){
				for (M=1;M<=t*F+1;M<<=1);	M<<=1;	Pre();	FFT(A,0);
				if	(L&1)	{
					FFT(B,0);	For(i,0,M)	B[i]=B[i]*A[i];	FFT(B,1);
					For(i,0,M)	B[i]=(Cpx){(I64)(B[i].x+.5)%P,0};
				}
				if	(L==1)	break;
				For(i,0,M)	A[i]=A[i]*A[i];	FFT(A,1);
				For(i,0,M)	A[i]=(Cpx){(I64)(A[i].x+.5)%P,0};
			}

			int Ans=0,t=1,rev=Pow(K%P,P-2);
			For(i,0,TL*F+1)	Ans=(1ll*t*(int)(B[i].x)*Pow(rev,i)+Ans)%P,t=1ll*t*(N-i)%P;
			printf("%d\n",Ans);
		}
}