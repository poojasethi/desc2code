#include<iostream>
#include<cmath>
#include<set>
#include<vector>
#include<list>
#include<map>
#include<algorithm>
#include<stdio.h>
#include<string.h>
#include<stack>
#include<queue>
#include<climits>
#include <string>
#include <sstream>

typedef unsigned long long int ULONG;
typedef unsigned int UINT;

using namespace std;
#define FOR(i,a,b) for(int i=a;i<b;++i)

#ifndef ONLINE_JUDGE
#include <time.h>
#endif

int N;
int G[101][101];
int V[101],VM[101];

int P2[]={0,0,1,2,4,8,16,32};

#define oo 100000000

int DPS[101][65][4][7];
int DPD[101][65][4][7];

struct VX{
	char n,m,m4,m7;
	inline VX(int xn,int xm,int xm4,int xm7){
		n=xn;
		m=xm;
		m4=xm4;
		m7=xm7;
	}

};
bool operator < (const VX& A, const VX& B)  {
	return A.n < B.n;
}
	

int main(){
#ifndef ONLINE_JUDGE
	freopen("input.txt","r",stdin);
	clock_t start = clock();
#endif
	
	while(scanf("%d",&N)>0 && N!=0){
		FOR(i,0,N)scanf("%d",&V[i]);
		FOR(i,0,N)FOR(j,0,N)scanf("%d",&G[i][j]);
				
		FOR(i,0,N)FOR(j,0,65)FOR(k,0,4)FOR(l,0,7)
						DPS[i][j][k][l]=-1,DPD[i][j][k][l]=oo;

		DPD[0][0][V[0]%4][V[0]%7]=0;

		int MK=oo,Min;
		priority_queue< pair<int,VX> > Q;
		Q.push( pair<int,VX>(  -V[0] ,VX(0,0,V[0]%4,V[0]%7)) );

		while(!Q.empty()){
			pair<int,VX> top=Q.top();Q.pop();
			int s=-top.first,n=top.second.n,m=top.second.m,m4=top.second.m4,m7=top.second.m7;

			m=(m|P2[V[n]]);
			if(DPS[n][m][m4][m7]!=-1)goto EN;
			DPS[n][m][m4][m7]=0;

			if(n==N-1){
				FOR(i,2,8){
					if((P2[i]&m)!=0){
						switch(i){
						case 2:if(V[n]%2!=0)goto E;break;
						case 3:if(s%3!=0)goto E;break;
						case 4:if(m4!=0)goto E;break;
						case 5:if(V[n]!=5)goto E;break;
						case 6:if(V[n]%2!=0 || s%3!=0)goto E;break;
						case 7:if(m7!=0)goto E;break;
						}
					}
				}
				if(s<MK)MK=s;
			}
			E:;

			Min=oo;
			FOR(i,0,N){
				if(G[n][i]==1 && DPD[i][m][(m4*10+V[i])%4][(m7*10+V[i])%7] > s+V[i] ){
					DPD[i][m][(m4*10+V[i])%4][(m7*10+V[i])%7]=s+V[i];
					Q.push( pair<int,VX>(  -(s+V[i]) ,VX(i,m,(m4*10+V[i])%4,(m7*10+V[i])%7)) );
				}
			}
			EN:;
		}
		if(MK>=oo)printf("%d\n",-1);
		else printf("%d\n",MK);
	}
	

#ifndef ONLINE_JUDGE	
	printf("Time elapsed: %f\n", ((double)clock() - start) / CLOCKS_PER_SEC);
#endif
	return 0;
}



