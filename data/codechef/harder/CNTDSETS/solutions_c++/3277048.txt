#include <cstdio>

using namespace std;

#define MOD 1000000007

long long mod_pow(long long a, int b, long long c){
    long long ret = 1;
    
    while(b){
        if(b & 1) ret = ret * a % c;
        a = a * a % c;
        b >>= 1;
    }
    
    return ret;
}

int N;

long long f(int D){
    long long C = 1,ans = 0;
    
    for(int i = 0;i <= N;++i){
        long long aux = C * mod_pow(2,mod_pow(D,i,MOD - 1) * mod_pow(D + 1,N - i,MOD - 1) % (MOD - 1),MOD) % MOD;
        
        if(i & 1){
            ans -= aux;
            if(ans < 0) ans += MOD;
        }else{
            ans += aux;
            if(ans >= MOD) ans -= MOD;
        }
        
        C = C * (N - i) % MOD * mod_pow(1 + i,MOD - 2,MOD) % MOD;
    }
    
    return ans;
}

int main(){
    int T,D;
    
    scanf("%d",&T);
    
    while(T--){
        scanf("%d %d",&N,&D);
        
        long long ans = f(D) - f(D - 1);
        if(ans < 0) ans += MOD;
        
        printf("%lld\n",ans);
    }
    
    return 0;
}