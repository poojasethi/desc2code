#include <iostream>
#include <algorithm>
#include <cstring>
#include <cstdio>
using namespace std;
const int z = int(1e9)+7;
char s[200200],a[1000100],b[1000100];
int m,n,pre[1000100],add[1000200],match;

void preCalc(char a[],int n,char b[],int m)
{
	int i=0,j=-1;
	pre[0]=-1;
	while (i<n)
	{
		while (j>=0 && a[i]!=a[j]) j=pre[j];
		i++; j++;
		pre[i]=(j>=n || a[i]!=a[j]?j:pre[j]);
	}	
	
	i=j=0;
	while (i<m)
	{
		while (j>=0 && a[j]!=b[i]) j=pre[j];
		++i; ++j;
		if (j==n) break;
	}
	match=j; 
	
	for (int i=n-1;i>=0;i--) pre[i]++;
	pre[n]=0;
}

void solve()
{
	add[0]=0;
	for (int i=0;i<n;i++)
	{
		add[i+1]=add[i]*2-add[pre[i]]-2;
		if (add[i+1]<0) add[i+1]+=z;
		if (add[i+1]>=z) add[i+1]-=z;
	}
	
	int ans=-add[n]+add[match];
	if (ans>=z) ans-=z;
	if (ans<0) ans+=z;
	cout << ans << endl;
}

int main()
{
	int test;
	cin >> test;
	while (test--)
	{
		cin >> n;
		scanf("%s",s);
		int l=strlen(s);
		for (int i=0;i<l;i++)
		{
			int z=(s[i]<='Z'?s[i]-'A'+26:s[i]-'a');
			for (int j=0;j<5;j++) a[i*5+4-j]=(z>>j&1);
		}
		
		cin >> m;
		scanf("%s",s);
		l=strlen(s);
		for (int i=0;i<l;i++)
		{
			int z=(s[i]<='Z'?s[i]-'A'+26:s[i]-'a');
			for (int j=0;j<5;j++) b[i*5+4-j]=(z>>j&1);
		}
		
		preCalc(a,n,b,m);
		solve();
	}
}
