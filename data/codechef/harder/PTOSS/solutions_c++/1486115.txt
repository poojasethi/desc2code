#include<cstdio>
#include<cstring>
const int n=1000005;
const int oo=1000000007;
int T,N,M,l,l1,l2,i,j,p,tmp,res;
char S1[n],S2[n];
int A[n],B[n],fail[n],error[n],P[n];
int main()
{
	for(scanf("%d",&T);T--;)
	{
		scanf("%d%s",&N,S1);
		scanf("%d%s",&M,S2);
		if(!N)
		{
			printf("0\n");
			continue;
		}
		l=strlen(S1),l1=0;
		for(i=0;i<l;++i)
		{
			if(S1[i]>='a') tmp=S1[i]-'a';
			else tmp=S1[i]-'A'+26;
			for(j=5;j;--j)
			{
				if(l1+j<=N) A[l1+j]=tmp&1;
				tmp>>=1;
			}
			l1+=5;
			if(l1>=N)
			{
				l1=N;
				break;
			}
		}
		l=strlen(S2),l2=0;
		for(i=0;i<l;++i)
		{
			if(S2[i]>='a') tmp=S2[i]-'a';
			else tmp=S2[i]-'A'+26;
			for(j=5;j;--j)
			{
				if(l2+j<=M) B[l2+j]=tmp&1;
				tmp>>=1;
			}
			l2+=5;
			if(l2>=M)
			{
				l2=M;
				break;
			}
		}
		fail[1]=0;
		for(i=2;i<=l1;++i)
		{
			for(j=fail[i-1];j&&A[j+1]!=A[i];j=fail[j]);
			if(A[j+1]==A[i]) fail[i]=j+1;
			else fail[i]=0;
		}
		p=0;
		for(i=1;i<=l2;++i)
		{
			for(;p&&A[p+1]!=B[i];p=fail[p]);
			if(A[p+1]==B[i]) ++p;
			else p=0;
			if(p==l1)
			{
				printf("0\n");
				break;
			}
		}
		if(p==l1) continue;
		for(i=1;i<l1;++i)
		{
			for(j=fail[i];j&&A[j+1]==A[i+1];j=fail[j]);
			if(A[j+1]!=A[i+1]) error[i]=j+1;
			else error[i]=0;
		}
		P[0]=0,P[1]=oo-2;
		for(i=2;i<=l1;++i)
			P[i]=((2*P[i-1]%oo+oo-P[error[i-1]])%oo+oo-2)%oo;
		res=(oo-P[l1]+P[p])%oo;
		printf("%d\n",res);
	}
	return 0;
}
