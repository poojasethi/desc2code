#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
using namespace std;
char a[1000001],b[1000001],c[1000001],A[1000001],B[1000001];
int flag,sign,n,f[1000001],g[1000001],v[1000001],t,tmp;
void origin()
{
  int i;
  for (i=1;i<=n;i++) 
    if (a[i]==b[i]) A[i]=a[i];
    else if (a[i]>b[i])
      for (;i<=n;i++) A[i]=a[i];
    else for (;i<=n;i++) A[i]=b[i];
  for (i=n;i>=1;i--)
    if (a[i]==b[i]) B[i]=b[i];
    else if (a[i]<b[i]) 
      for (;i>=1;i--) B[i]=a[i];
    else for (;i>=1;i--) B[i]=b[i];
  for (i=n-1,f[n]=n;i>=1;i--)
    if (A[i]==A[i+1]) f[i]=f[i+1];else f[i]=i;
  for (i=2,g[1]=1;i<=n;i++)
    if (B[i]==B[i-1]) g[i]=g[i-1];else g[i]=i;
  memset(v,0,sizeof(v));
  for (i=1;i<=n;i++) v[c[i]]++;
}
int check(int x,int y)
{
  int i,k;
  if (!flag && y<=A[x]) {
    k=x;
    for (i='9';i>='0';k+=v[i],i--) 
      if (!v[i]) continue;
      else if (i>A[k+1]) break;
      else if (i<A[k+1]) return 0;
      else if (k+v[i]>f[k+1]) {
        if (i>A[f[k+1]+1]) break;
        return 0;
      }
      else if (k+v[i]<f[k+1]) return 0;
    if (i<'0') return 0;
  }
  k=n;
  for (i='0';i<='9';k-=v[i],i++) 
    if (!v[i]) continue;
    else if (i<B[k]) break;
    else if (i>B[k]) return 0;
    else if (k-v[i]+1<g[k]) {
      if (i<B[g[k]-1]) break;
      return 0;
    }
    else if (k-v[i]+1>max(g[k],x+1)) return 0;
  if (i<='9') return 1;
  if (y<B[x]) return 1;else if (y>B[x]) return 0;
  return sign;
}
int main()
{
  int i,j;
  scanf("%d\n",&t);
  for (;t;t--) {
    scanf("%d\n",&n);
    scanf("%s\n%s\n%s\n\n",a+1,b+1,c+1);
    origin();
    for (flag=0,sign=0,i=1;i<=n;i++) {
      if (!flag) j=A[i];else j='0';
      if (i==667)
        int k=1;
      for (;j<='9';j++) 
	      if (v[j] && (v[j]--,tmp=check(i,j),v[j]++,tmp)) break;
      if (j>'9') break;
      c[i]=j;v[c[i]]--;
      if (c[i]<B[i]) sign=1;else if (c[i]>B[i]) sign=0;
      if (!flag && c[i]!=A[i]) flag=1;
    }
    if (i<=n) printf("-1\n",i,c+1);
    else printf("%s\n",c+1);
  }
  return 0;
}
