#include<iostream>
#include<string>
#include<stdlib.h>
#include<stdio.h>
using namespace std;
int main(){
//	string a,b,c;
//	cin>>a>>b>>c;
//	int la=a.size();
//	int lb=b.size();
//	int lc=c.size();
//	for(int i=0;i<la;++i){
//		a[i]-=48;
//		c[i]-=48;
//	}
//	for(int i=0;i<lb;++i)
//		b[i]-=48;
//		int la=1000;
//		int lb=10000000;
//		int lc=la;
//		char a[1000];
//		char* b=new char [10000000];
//		char* c=new char [1000];
//		srand(2);
//		for(int i=0;i<la;++i){
//					a[i]=rand()&1;
//					c[i]=rand()&1;
//			a[i]=1;
//			c[i]=1;
//		}
//		for(int i=0;i<lb;++i){
//					b[i]=rand()&1;
//			b[i]=1;
//		}
	//	for(int i=0;i<lc;++i)
	//		c[i]=rand()&1;
	////////////////////////
	int j;
	char* a=new char[1000];
	char* b=new char[10000000];
	char* c=new char[1000];
	int la;
	int lb;
	int lc;

	int l;
	char* s;
	char* sch=new char[2000010];
	int si;
	s=a;
	for(int k=0;k<3;++k){
			scanf("%s",sch);
			si=0;
		for(l=0;sch[si]!='\0';l+=5,++si){
			if(sch[si]<97){
				sch[si]-=39;
			}
			else{
				sch[si]-=97;
			}
			for(j=4;j>=0;--j){
				s[l+j]=(sch[si]&1)?1:0;
				sch[si]>>=1;
			}
		}
		if(k==0){
			la=l;
			s=b;
		}else if(k==1){
			lb=l;
			s=c;
		}
	}
	lc=l;


//	////////////////////////
//	la=1000;
//	lc=la;
//	lb=10000000;
//	for(int i=0;i<la;++i){
//		a[i]=rand()&1;
//		c[i]=rand()&1;
//	}
//	for(int i=0;i<lb;++i)
//		b[i]=rand()&1;
//
	////////////////////////
	int e[1003][5];
	int es[1003];
	int w[1003]={0};

	int wg[1003]={0};
	/*
		for(int i=0;i<lb;++i){
		int j,d;
		for(j=0,d=0;j<la&&i+j<lb;++j){
		if(a[j]!=b[i+j]){
		if(c[j]){
		++d;
		if(d>2){
		break;
		}
		}
		else
		break;
		}
		}
		++wg[j];
		}
	 */
	for(int i=0;i<la;++i){
		es[i]=0;
		e[i][0]=-1;
		e[i][1]=-1;
		e[i][2]=-1;
		e[i][3]=-1;
		e[i][4]=-1;
		for(j=0;i+j<la;++j){
			if(a[j]!=a[i+j]){
				e[i][es[i]]=j;
				++es[i];
				if(es[i]>4)
					break;
			}
		}
	}
	int ml=0;
	int mi;
	int g[10]={-1,-1,-1};
	int gs=0;
	int h[10];
	int hs;
	int gv;
	int ev;
	int ess;
	int mml;
	for(int i=0;i<lb;){
		while( (i+ml)<lb&&ml<la){
			if( a[ml]!=b[i+ml] ){
				g[gs]=ml;
				//				cout<<ml<<" gs ";
				++gs;
				if(gs>2)
					break;
			}
			++ml;
		}
		//				cout<<i<<" "<<ml<<")";
		for(mml=0;mml<gs;++mml){
			if(!c[g[mml]]){
				++w[g[mml]];
				break;
			}
		}
		if(mml==gs){
			++w[ml];
		}
		/*
			if(ml==0){
			++i;
			continue;
			}
		 */
		//		cout<<"<"<<gs<<">"<<endl;
		for(mi=1,--ml;ml>0;++mi,--ml){

			gv=0;
			for(j=0;j<gs;++j){
				if(g[j]){
					g[gv]=g[j]-1;
					++gv;
				}
			}
			gs=gv;
			//		cout<<endl;

			gv=0;
			ev=0;
			/*
				cout<<"gs"<<gs<<endl;
				for(int j=0;j<gs;++j)
				cout<<g[j]<<" ";
				cout<<endl;
				cout<<"e[mi]"<<es[mi]<<endl;
				for(int j=0;j<es[mi];++j)
				cout<<e[mi][j]<<" ";
				cout<<endl;
			 */

//			for(ess=0;ess<es[mi]&&e[mi][ess]<ml;++ess)
//				;
			for(hs=0;hs<3;){
//				cerr<<"!";
				if(gv<gs){
					if(ev<es[mi]){
						//cout<<g[gv]<<"==?"<<e[mi][ev]<<endl;
						if(g[gv]==e[mi][ev]){
							++gv;
							++ev;
							continue;
						}
						else if(g[gv]>e[mi][ev]){
							if(e[mi][ev]>=ml)
								break;
							h[hs]=e[mi][ev];
							//cout<<"\n"<<h[hs]<<" "<<hs<<"!h"<<endl;
							++hs;
							++ev;
						}
						else{
								if(g[gv]>=ml)
									break;
							h[hs]=g[gv];
							//cout<<"\n"<<h[hs]<<" "<<hs<<"!h"<<endl;
							++hs;
							++gv;
						}
					}
					else {
						if(g[gv]>=ml)
							break;
						h[hs]=g[gv];
						//cout<<"\n"<<h[hs]<<" "<<hs<<" h"<<endl;
						++gv;
						++hs;
					}
				}
				else if(ev<es[mi]){
					if(e[mi][ev]>=ml)
						break;
					h[hs]=e[mi][ev];
					//cout<<"\n"<<h[hs]<<" "<<hs<<" h"<<endl;
					++ev;
					++hs;
				}
				else
					break;
				//				cout<<h[0]<<" "<<g[0]<<" "<<g[1]<<" "<<gs<<"]]]";
			}
			/*
				for(int j=0;j<gs;++j)
				cout<<"???"<<g[j]<<" ";
				cout<<endl;
				for(int j=0;j<hs;++j)
				cout<<h[j]<<" ?";
				cout<<endl;
			 */
			
	//		if(hs&&h[hs-1]==ml)
	//			--hs;
			/*	
			for(j=0;j<hs;++j){
				if(h[j]>=ml){
					cout<<"!";
					hs=j;
					break;
				}
			}
			*/
			
			if(hs==3){
				/*
					for(int j=0,k=0;j<gs;++j){
					if(g[j]){
					g[k]=g[j]-1;
					++k;
					}
					}
				 */
				//cout<<h[2]<<"!!";
				for(mml=0;mml<2;++mml){
					if(!c[h[mml]]){
						++w[h[mml]];
						break;
					}
				}
				if(mml==2)
					++w[h[mml]];
			}
			else{
				gs=hs;
				for(j=0;j<hs;++j)
					g[j]=h[j];
				break;
			}
		}
		//	if(i>3)
		//		break;
		i+=mi;
	}
	/*
		for(int i=0;i<=la;++i){
		if(w[i]!=wg[i])
		cout<<"!";
		}

	 */
	/*
		for(int i=0;i<la;++i)
		cout<<e[i]<<" ";
		cout<<endl;
		for(int i=0;i<=la;++i){
		cout<<w[i]<<" ";

		}
		cout<<endl;
		for(int i=0;i<=la;++i){
		cout<<wg[i]<<" ";
		}
		cout<<endl;
	 */
	long long sum = 0;
	for(long long int i=la;i>0;--i){
		sum=(sum+i*i*w[i])%1000000007;
		w[i-1]+=w[i];
	}
//	cout<<w[0]<<endl;
	printf("%lld\n",sum);
//	cout<<sum<<endl;
/*	
		for(int i=0;i<la;++i)
		cout<<(int)a[i];
		cout<<endl;
		for(int i=0;i<lb;++i)
		cout<<(int)b[i];
		cout<<endl;
*/
	 


	/*
		for(int j=0;j<gs+es[mi]&&j<3;++j){
		if(gv<gs){
		if(ev<es[i]){
		}
		else{
		if(g[gv]<=ml)
		g[j]=
		}
		}
		else{
		if(e[mi][ev]<=ml)
		g[j]=e[mi][ev];
		}
		}
	 */
	/*
		if(e[mi]<0){
		if(ml<la-mi){
		++w[ml];
		}
		else{
		break;
		}
		}
		else{
		if(ml>e[mi]){
		++w[e[mi]];
		}
		else{
		break;
		}
		}
	 */

	return 0;
}
