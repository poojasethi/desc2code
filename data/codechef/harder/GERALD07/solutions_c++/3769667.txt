// __   _   _   _   _____   _   _   _____   _   _       ___
//|  \ | | | | | | /  ___| | | | | /  ___/ | | | |     /   |
//|   \| | | | | | | |     | | | | | |___  | |_| |    / /| |
//| |\   | | | | | | |  _  | | | | \___  \ |  _  |   / / | |
//| | \  | | |_| | | |_| | | |_| |  ___| | | | | |  / /  | |
//|_|  \_| \_____/ \_____/ \_____/ /_____/ |_| |_| /_/   |_|

#include<iostream>
#include<fstream>
#include<stdio.h>
#include<cstdio>
#include<stdlib.h>
#include<string>
#include<string.h>
#include<ctype.h>
#include<algorithm>
#include<cmath>
#include<set>
#include<queue>
#include<stack>
#include<iomanip>
#include<vector>
#include<map>
#define PB(x) push_back(x)
#define MP(x, y) make_pair(x, y)
#define ff first
#define ss second
#define ll long long
#define pii pair< int, int >
#define MEM(p, v) memset(p, v, sizeof(p))
#define READ(f) freopen(f, "r", stdin)
#define WRITE(f) freopen(f, "w", stdout)
#define S system("pause")
#define R return(0)
#define INF int(1e9)
#define MAX_5 250055
#define ll long long
using namespace std;
int a[MAX_5],b[MAX_5],par[MAX_5],ANS[MAX_5],l[MAX_5],r[MAX_5],i,m,ans,k,j,q,x,n,ma,mi,ret,f,ans1;
pair<int,int>p[MAX_5];
string s;
int pp(int a){
        return ((par[a]==-1)?a:(par[a]=pp(par[a])));
}
void merge(int a,int b){
        a=pp(a);b=pp(b);
        if(a!=b){ans--;par[b]=a;}
}
int pp1(int a){
        if(par[a]==-1)
        {
            return a;
        }else
        {
            int f=pp1(par[a]);
            p[ret++]=MP(par[a],a);
            par[a]=f;
            return f;
        }
}

void merge1(int a,int b){
        a=pp1(a);b=pp1(b);
        if(a!=b)
        {
            ans--;
            p[ret++]=MP(par[b],b);
            par[b]=a;
        }
}
vector< pair<pii,pii> >v;
main()
{
int t;
cin>>t;
while(t--)
{
            v.clear();
          scanf("%d%d%d",&n,&m,&q);
          k=sqrt(m);
          for(i=0;i<m;i++)scanf("%d%d",&a[i],&b[i]);
          for(i=0;i<q;i++)scanf("%d%d",&l[i],&r[i]),l[i]--,r[i]--;

   //       cout<<"------------------"<<endl;
          for(i=0;i<q;i++)v.push_back(MP(MP(l[i]/k,r[i]),MP(l[i],i)));


          sort(v.begin(),v.end());

    //      for(i=0;i<q;i++)cout<<v[i].ff.ff<<" "<<v[i].ff.ss<<" "<<v[i].ss.ff<<" "<<v[i].ss.ss<<endl;

   //       cout<<endl;
   //       cout<<"------------------"<<endl;
   //     cout<<endl;


                  for(j=1;j<=n;j++)par[j]=-1;
     //         for(j=1;j<=n;j++)cout<<par[j]<<" ";cout<<endl;
     //         cout<<endl;

    int start=0;
          for(i=0;i<q;i++)
          {
     //         cout<<endl;
      //        cout<<v[i].ff.ff<<" "<<v[i].ff.ss<<" "<<v[i].ss.ff<<" "<<v[i].ss.ss<<endl;

              if(!i || v[i].ff.ff!=v[i-1].ff.ff)
              {
                  ans=n;
                  for(j=1;j<=n;j++)par[j]=-1;
                  f=(v[i].ff.ff+1)*k;
                  start=f;
              }
              ret=0;
     //         cout<<f<< " <-----  f"<<endl;

      //        for(j=1;j<=n;j++)cout<<par[j]<<" ";cout<<endl;
              for(;start<=v[i].ff.ss  && start<m;start++)
                   merge(a[start],b[start]);

              ans1=ans;

       //       for(j=1;j<=n;j++)cout<<par[j]<<" ";cout<<endl;

              for(j=v[i].ss.ff;j<=min(f-1,v[i].ff.ss) && j<m;j++)
                   merge1(a[j],b[j]);


      //        for(j=1;j<=n;j++)cout<<par[j]<<" ";cout<<endl;

      //        cout<<ans1<<endl;

              for(j=ret-1;j>=0;j--)
                  par[p[j].ss]=p[j].ff;
/**/
              ANS[v[i].ss.ss]=ans;
              ans=ans1;

     //         for(j=1;j<=n;j++)cout<<par[j]<<" ";cout<<endl;

     //         cout<<" ---- "<<endl;

          }
//cout<<"ANS"<<endl;
          for(i=0;i<q;i++)printf("%d\n",ANS[i]);
//cout<<"ANS <---"<<endl;


}
}
