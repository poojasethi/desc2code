#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cmath>
#include <algorithm>
using namespace std;
 
#define MAX_N 310000
#define MOD 1000000007
#define REP1(i, n) for (int i = 1; i <= n; i++)
#define REP(i, l, r) for (int i = l; i <= r; i++)
#define RP(i, r, l) for (int i = r; i >= l; i--)
 
int a[MAX_N], b[MAX_N], s[MAX_N];
int n, m, q, mn;
 
void Prepare(void)
{
     int h = 1, t = 0;
     REP1(i, 9) if (i * i <= q) b[++t] = i, s[t] = i * i;
     for (int h = 1; t <= mn; h++)
     {
         REP(i, 0, 9) if (s[h] + i * i <= q) s[++t] = s[h] + i * i,
                         b[t] = (b[h] * 10LL + i) % MOD;
     }
     REP1(i, n) a[i] = (b[a[i]] + a[i - 1]) % MOD;
}
 
int main(void)
{
    #define ONLINE_JUDGE 
    #ifndef ONLINE_JUDGE
    freopen ("input.txt", "r", stdin);
    freopen ("output.txt", "w", stdout);
    #endif
    scanf("%d%d", &q, &n); REP1(i, n) { scanf("%d", a + i); if (a[i] > mn) mn = a[i]; }
    Prepare(), scanf("%d", &m);
    REP1(i, m)
    { int x, y; scanf("%d%d", &x, &y), printf ("%d\n", (a[y] - a[x - 1] + MOD) % MOD); }
    return 0;
}
 