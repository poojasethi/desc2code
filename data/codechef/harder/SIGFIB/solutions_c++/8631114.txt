#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n	13
#define I64	long long
#define For(i,a,b)	for(int i=a;i<=b;i++)
#define Rep(i,a,b)	for(int i=a;i>=b;i--)

I64		N;
int		T,M;
int		Fib[n],st[n],Trans[n],Len[205],Ans[205][200005];

struct	Mat{
		int A[n][n];
		Mat()	{For(i,1,12)For(j,1,12)A[i][j]=0;}
		Mat	operator *	(const Mat&b){
			Mat	c,a=*this;
			For(i,1,12)	For(j,1,12)	For(k,1,12)
				c.A[i][j]=(1ll*a.A[i][k]*b.A[k][j]+c.A[i][j])%M;
			return	c;
		}
		Mat	operator ^	(I64 k){
			Mat	ret,a=*this;
			For(i,1,12)	ret.A[i][i]=1;
			for (;k;k>>=1,a=a*a)
				if	(k&1)	ret=ret*a;
			return	ret;
		}
};

int		main(){
		Fib[1]=1;
		For(i,2,12)	Fib[i]=Fib[i-1]+Fib[i-2];
		For(i,3,12)	For(x,1,i)	For(y,1,i-x-1)	st[i]+=x*y*(i-x-y)*Fib[x]*Fib[y]*Fib[i-x-y];

		Trans[0]=1;
		For(i,1,6)	Rep(j,12,0)	Trans[j+2]-=Trans[j],Trans[j+1]-=Trans[j];
		For(i,1,12)	Trans[i]*=-1;

		For(P,1,200){
			For(i,1,12)	Ans[P][i]=st[i]%P;
			for (int i=13;;i++){
				For(j,1,12)	Ans[P][i]=(Ans[P][i-j]*Trans[j]%P+Ans[P][i]+P)%P;	int flag=1;
				For(j,1,12)	if	(Ans[P][i-12+j]!=Ans[P][j])	flag=0;
				if	(flag)	{Len[P]=i-12;break;}
			}
		}

		scanf("%d",&T);
		for (;T--;)	{
			scanf("%d%lld",&M,&N);
			if	(N<=12)	printf("%d\n",6*st[N]%M);	else
			if	(M<=200)	printf("%d\n",6*Ans[M][N?(N-1)%Len[M]+1:0]%M);
			else	{
				Mat	S;	int	ret=0;
				For(i,1,12)	S.A[i][1]=Trans[i]%M;
				For(i,1,11)	S.A[i][i+1]=1;	S=S^(N-12);
				For(i,1,12)	ret=(1ll*S.A[i][1]*st[13-i]+ret)%M;
				printf("%d\n",6*(ret+M)%M);
			}
		}
}