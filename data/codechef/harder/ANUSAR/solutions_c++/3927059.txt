#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<fstream>
#include<cmath>
#include<iomanip>
#include<time.h>
using namespace std;
#define ll long long
#define ull unsigned long long
#define inf 1000000007
#define mod 1000000007
#define pii pair<int,int>
#define vi vector<int>
#define VS vector<string>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 200010
#define pi 3.14159265358979323846
#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(__typeof(t.begin()) i=t.begin();i!=t.end();i++)

struct node
{
	int ch[26],fail,len,v;
	char c;
	void init()
	{
		memset(ch,0,sizeof(ch));
		fail=-1;len=0;c='#';v=1;
	}
}t[N*50];
int sz;
void add(char *s)
{
	int ed=0,i,j;
	for(i=0;s[i];i++)
	{
		j=s[i]-'a';
		int p=++sz;t[p].init();t[p].len=t[ed].len+1;t[p].c=s[i];
		while(ed>=0&&!t[ed].ch[j])t[ed].ch[j]=p,ed=t[ed].fail;
		if(ed==-1){t[p].fail=0;ed=p;continue;}
		int q=t[ed].ch[j];
		if(t[q].len==t[ed].len+1)t[p].fail=q;
		else
		{
			int r=++sz;t[r]=t[q];t[r].len=t[ed].len+1;
			t[p].fail=t[q].fail=r;t[r].v=0;
			while(ed>=0&&t[ed].ch[j]==q)t[ed].ch[j]=r,ed=t[ed].fail;
		}
		ed=p;
	}
}
int id[N*10],f[N];ll cnt[N*10];char s[N];
bool cmp(int i,int j)
{
	return t[i].len>t[j].len;
}
ll c[N<<2];bool same[N<<2];
#define lst p<<1,l,m
#define rst p<<1|1,m+1,r
void down(int p)
{
	if(same[p])
	{
		c[p<<1]=c[p<<1|1]=0;
		same[p<<1]=same[p<<1|1]=1;
		same[p]=0;
	}
	if(c[p])
	{
		c[p<<1]+=c[p],c[p<<1|1]+=c[p];
		c[p]=0;
	}
}
void update(int p,int l,int r,int x,int y,ll v)
{
	if(l>=x&&r<=y){c[p]+=v;return;}
	int m=(l+r)>>1;
	down(p);
	if(x<=m)update(lst,x,y,v);
	if(y>m)update(rst,x,y,v);
}
ll query(int p,int l,int r,int x)
{
	if(l==r)return c[p];
	int m=(l+r)>>1;
	down(p);
	if(x<=m)return query(lst,x);
	else return query(rst,x);
}
void solve()
{
	int i,j,k,n;
	n=strlen(s);
	for(i=0;i<=sz;i++)id[i]=i,cnt[i]=0;
	sort(id,id+sz+1,cmp);
	for(k=0;k<=sz;k++)
	{
		i=id[k];
		if(t[i].v)cnt[i]++;
		//cerr<<t[i].c<<" "<<t[i].len<<" "<<cnt[i]<<"\n";
		j=t[i].fail;
		ll v=(ll)(t[i].len-t[j].len)*cnt[i];
		if(cnt[i]<N-1)update(1,1,N-1,1,cnt[i],v);
		else c[1]+=v;
		//DBG(v)DBG(ans[1])
		cnt[j]+=cnt[i];
	}
}
int main()
{
	int i,j,T,ca=0,k,m,n;
	scanf("%d",&T);
	while(T--)
	{
		scanf("%s",s);n=strlen(s);
		t[0].init();sz=0;
		add(s);
		scanf("%d",&m);
		//for(i=0;i<=n+1;i++)cnt[i]=0;
		for(i=0;i<m;i++)scanf("%d",&f[i]);
		solve();
		for(i=0;i<m;i++)printf("%lld\n",query(1,1,N-1,f[i]));
		same[1]=1;c[1]=0;
	}
	return 0;
}