#include <cstdio>
#include <cassert>
#include <stack>
using namespace std;
 
#define MAX 100000
int arr[MAX+1];
long long match[MAX];
 
int main(){
	int T;
	scanf("%d", &T);
	while(T--){
		long long N;
		int Q;
		scanf("%lld %d", &N, &Q);
		for(int i=0; i<N; i++){
			scanf("%d", arr+i);
			assert(N-1<=arr[i] && arr[i]<=N+1);
		}
		arr[N]=N;
		fill(match, match+N, -1);
		stack<int> st;
		long long total=N*(N+1);
		for(int pass=0; pass<2; pass++)
		for(int i=0; i<N; i++){
			if(arr[i]==N+1)
				st.push(i);
			else if(arr[i]==N-1 && !st.empty()){
				int j=st.top();
				st.pop();
				match[i]=match[j]=((i+N)*(N+1)-j*N)%total;
			}
		}
 
		for(int i=0; i<Q; i++){
			long long q;
			scanf("%lld", &q);
			int hole=q%N;
			int peg=q%(N+1);
			int ans=N;
			if(arr[hole]==N-1 && (match[hole]==-1 || match[hole]>q))
				ans--;
			if(arr[peg]==N+1 && (match[peg]==-1 || match[peg]>q))
				ans++;
			printf("%d ", ans);
		}
		putchar('\n');
	}
	return 0;
}