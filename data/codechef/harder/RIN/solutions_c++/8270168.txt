#include<cstdio>
#include<algorithm>
#include<cstring>
#include<iostream>
#include<cstdlib>
#include<cmath>
#include<vector>
#include<map>
#include<set>
#include<queue>
#include<bitset>
using namespace std;
#define inf 1000000005
typedef long long ll;
typedef double db;
void gn(int &x){
    int sg=1;char c;while(((c=getchar())<'0'||c>'9')&&c!='-');
    if(c=='-')sg=-1,x=0;else x=c-'0';
    while((c=getchar())>='0'&&c<='9')x=x*10+c-'0';
    x*=sg;
}
void gn(ll &x){
    int sg=1;char c;while(((c=getchar())<'0'||c>'9')&&c!='-');
    if(c=='-')sg=-1,x=0;else x=c-'0';
    while((c=getchar())>='0'&&c<='9')x=x*10+c-'0';
    x*=sg;
}
const int mo=1000000007;
int qp(int a,ll b){int ans=1;do{if(b&1)ans=1ll*ans*a%mo;a=1ll*a*a%mo;}while(b>>=1);return ans;}
int gcd(int a,int b){return b?gcd(b,a%b):a;}

struct edge{int v,next,f;}e[550005];int etot=0;
int g[555005];
void ae(int u,int v,int f){
     e[etot].v=v;e[etot].next=g[u];e[etot].f=f;g[u]=etot++;
     e[etot].v=u;e[etot].next=g[v];e[etot].f=0;g[v]=etot++;
}
int d[555005];
int s,t;
int qu[555005],p,q;
int label(){
	for (int i=1;i<=t;i++)d[i]=0;
	p=q=0;
	qu[q++]=s;
	d[s]=1;
	while(p!=q){
		int u=qu[p++];
		for(int i=g[u];~i;i=e[i].next)if(e[i].f){
			int v=e[i].v;
			if(!d[v]){
				d[v]=d[u]+1;
				if(v==t)return 1;
				qu[q++]=v;
			}
		}
	}
	return 0;
}
int aug(int u,int mi=inf){
	if(u==t)return mi;
	int sum=0;
	for (int i=g[u];~i;i=e[i].next)if(e[i].f){
		int v=e[i].v;
		if(d[v]==d[u]+1){
			int del=aug(v,min(mi,e[i].f));
			e[i].f-=del;
			e[i^1].f+=del;
			mi-=del;
			sum+=del;
			if(!mi)break;
		}
	}
	if(!sum)d[u]=-1;
	return sum;
}
			
int dinic(){
	int flow=0;
	while(label()){
		int tmp=aug(s);
		flow+=tmp;
	}
	return flow;
}

int x[105][105];
int main(){
	memset(g,-1,sizeof(g));
	int n,m,k;
	scanf("%d%d%d",&n,&m,&k);
	int su=0;
	for (int i=1;i<=n;i++){
		int ma=0;
		for (int j=1;j<=m;j++){
			scanf("%d",&x[i][j]);
			ma=max(ma,x[i][j]);
		}
		su+=ma;
		for (int j=1;j<=m;j++){
			int d=inf;
			if(x[i][j]!=-1)d=ma-x[i][j];
			ae((m+1)*(i-1)+j,(m+1)*(i-1)+j+1,d);
		}
	}
	s=n*(m+1)+1;t=s+1;
	for (int i=1;i<=n;i++){
		ae(s,(m+1)*(i-1)+1,inf);
		ae((m+1)*i,t,inf);
	}
	while(k--){
		int a,b;
		scanf("%d%d",&a,&b);
		for (int i=1;i<=m;i++)
			ae((a-1)*(m+1)+i,(b-1)*(m+1)+i+1,inf);
	}
	su-=dinic();
	printf("%.2lf\n",1.0*su/n);
	return 0;
}
