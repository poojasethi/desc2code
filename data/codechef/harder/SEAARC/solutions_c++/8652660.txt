#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define p 1000000007
using namespace std;

int n,m,S,i,j,k,ans,sum,inv2;
int a[100005],b[100005],c[100005],d[100005],d2[100005],f[100005];

int Power(int a,int b)
{
	int ans=1;
	for(;b;b>>=1,a=(long long)a*a%p)if(b&1)ans=(long long)ans*a%p;
	return ans;
}

int main()
{
	scanf("%d",&n);S=(int)sqrt(n/log2(n));
	
	for(i=1;i<=n;++i)
	{
		scanf("%d",&a[i]);++b[a[i]];
		if(a[i]>m)m=a[i];
	}
	
	for(i=1;i<=m;++i)
	{
		k=(long long)b[i]*(b[i]-1)/2%p;
		ans+=(long long)sum*k%p;if(ans>=p)ans-=p;
		sum+=k;if(sum>=p)sum-=p;
	}
	
	for(i=n;i>=1;--i)
	{
		c[i]=c[i+1]+d[a[i]];if(c[i]>=p)c[i]-=p;
		++d[a[i]];
	}
	for(i=1;i<=m;++i)d[i]=0;
	k=0;
	for(i=1;i<n;++i)
	{
		++d[a[i]];
		ans-=(d[a[i]]-1)*(c[i+1]+p-(long long)(b[a[i]]-d[a[i]])*(b[a[i]]-d[a[i]]-1)/2%p)%p;
		if(ans<0)ans+=p;
	}
	
	inv2=Power(2,p-2);
	for(i=1;i<=m;++i)
	if(b[i]>S)
	{
		for(j=1;j<=m;++j)d[j]=0;
		for(j=n;j>=1;--j)c[j]=c[j+1]+(a[j]==i);
		k=0;
		for(j=1;j<=n;++j)
		if(a[j]!=i)
		{
			ans-=(long long)d[a[j]]*c[j]%p;if(ans<0)ans+=p;
			d[a[j]]+=k;if(d[a[j]]>=p)d[a[j]]-=p;
		}
		else ++k;
		
		for(j=1;j<=m;++j)c[j]=0;
		for(j=1;j<=m;++j)d[j]=d2[j]=0;
		k=0;
		for(j=n;j>=1;--j)
		if(a[j]!=i)
		{
			if(b[a[j]]<=S)
			{
				sum=((long long)k*(k-1)%p*c[a[j]]%p+p-(long long)(2*k-1)*d[a[j]]%p+d2[a[j]])%p;
				ans-=(long long)sum*inv2%p;if(ans<0)ans+=p;
				++c[a[j]];
				d[a[j]]+=k;if(d[a[j]]>=p)d[a[j]]-=p;
				d2[a[j]]+=(long long)k*k%p;if(d2[a[j]]>=p)d2[a[j]]-=p;
			}
		}else ++k;
	}
	
	for(i=1;i<=n;++i)c[i]=0;
	for(i=1;i<=m;++i)d[i]=0;
	for(i=n;i>=1;--i)c[i]=d[a[i]],d[a[i]]=i;
	for(i=1;i<=m;++i)d[i]=0;
	for(i=n;i>=1;--i)
	if(b[a[i]]<=S)
	{
		for(j=c[i],sum=0;j;j=c[j],++sum)
		{
			for(k=j-1;k;k-=k&-k)
			{
				ans-=f[k];
				if(ans<0)ans+=p;
			}
			ans+=(long long)sum*(sum-1)/2%p;
			if(ans>=p)ans-=p;
		}
		for(j=c[i];j;j=c[j])
		for(k=j;k<=n;k+=k&-k)
		++f[k];
	}
	
	printf("%d\n",ans);
}