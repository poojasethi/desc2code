#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n	100005
#define P	1000000007
#define For(i,a,b)	for(int i=a;i<=b;i++)
#define Rep(i,a,b)	for(int i=a;i>=b;i--)

int		N,M,A[n],B[n],C[n],D[n],L[n],R[n],T[n],S1[n],S2[n];

void	Add(int&x,int y)	{
		if	((x+=y)>=P)	x-=P;
}
void	Modify(int x){
		for (;x<=N;x+=x&-x)	T[x]++;
}
int		Query(int x){
		int ret=0;
		for (;x;x-=x&-x)	ret+=T[x];
		return	ret;
}

int		main(){
		scanf("%d",&N);
		For(i,1,N)	scanf("%d",&A[i]),B[++M]=A[i];
		sort(B+1,B+M+1);	M=unique(B+1,B+M+1)-B-1;
		For(i,1,N)	A[i]=lower_bound(B+1,B+M+1,A[i])-B,C[A[i]]++;

		For(i,1,N)	L[i]=S1[A[i]],S1[A[i]]=i;
		Rep(i,N,1)	R[i]=S2[A[i]],S2[A[i]]=i;
		For(i,1,M)	for (int x=S2[i],t=0;x;x=R[x])	D[x]=++t;

		int Lim=350,Ans=0;
		For(i,1,M)	if	(C[i]>Lim)	{
			For(j,1,N)	T[j]=T[j-1]+(A[j]==i);	C[i]=-1;
			For(j,1,M)	if	(C[j]!=-1)	{
				int x=S2[j],sum1=0,sum2=0;
				for (;x;x=R[x])	Add(Ans,(1ll*T[x]*sum1-sum2+P)%P),Add(sum1,T[x]),Add(sum2,1ll*T[x]*T[x]%P);
			}

			Rep(j,N,1)	T[j]=T[j+1]+(A[j]==i);
			For(j,1,M)	if	(C[j]!=-1)	{
				int x=S1[j],sum1=0,sum2=0;
				for (;x;x=L[x])	Add(Ans,(1ll*T[x]*sum1-sum2+P)%P),Add(sum1,T[x]),Add(sum2,1ll*T[x]*T[x]%P);
			}
		}

		For(i,1,N)	T[i]=0;
		For(i,1,N)	if	(C[A[i]]!=-1)	{
			for (int x=R[i];x;x=R[x])	Add(Ans,Query(x-1)-Query(i)),Add(Ans,P-1ll*(D[x]-D[i]-1)*(D[i]-1)%P);
			for (int x=R[i];x;x=R[x])	Modify(x);
		}
		printf("%d\n",Ans);
}