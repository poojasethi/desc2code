#include<iostream>
#include<string.h>
using namespace std;
int sol[1005][1005];

char x[1005];//="pppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp";
char y[1005];//="pppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp";
int maxm(int a,int b)
{
    if(a>b) return a;
    return b;
}
int main()
{
    int t,n,m,i,j,k;
    cin>>t;
    for(k=1;k<=t;k++)
    {
        int arr[1005],arr2[1005];
        char s[1005];
        int l=0;
        cin>>n>>x>>m>>y;
        for(i=0;i<=n;i++)
        {
            for(j=0;j<=m;j++)
            {
               if(i==0||j==0) sol[i][j]=0;
              else if(x[i-1]==y[j-1])
                {
                   sol[i][j]=sol[i-1][j-1]+1;
                }
               else
                {
                    sol[i][j]=maxm(sol[i-1][j],sol[i][j-1]);
                }
            }
        }
        for(i=n-1,j=m-1;i>=0&&j>=0;)
        {
            if(x[i]==y[j])
            {
                s[l]=x[i];
                s[l+1]='\0';
                arr[l]=i+1;
                arr2[l++]=j+1;
                i--;
                j--;
            }
            else if(sol[i][j+1]>sol[i+1][j])
            {
                i--;
            }
            else j--;
        }
     //   cout<<sol[n][m]<<"\n";
        cout<<"case "<<k;
        if(sol[n][m]<1) cout<<" N\n";
        else
        {
            cout<<" Y\n"<<sol[n][m]<<"\n";
            for(i=l-1;i>=0;i--)
            {
                cout<<s[i]<<" "<<arr[i]<<" "<<arr2[i]<<"\n";
            }
        }

    }

    return 0;
}
