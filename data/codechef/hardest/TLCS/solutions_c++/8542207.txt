#include<iostream>
#include<cstdlib>
#include<cstring>


using namespace std;


void LCS(char *X,char *Y,int m,int n,int cnt)
{
    int L[m+1][n+1];
    for(int i=0;i<=m;i++)
    {
        for(int j=0;j<=n;j++)
        {
            if(i==0 || j==0)
            {
                L[i][j]=0;
            }
            else if(X[i-1]==Y[j-1])
            {
                L[i][j]=L[i-1][j-1]+1;
            }
            else
                L[i][j]=max(L[i][j-1],L[i-1][j]);


        }


    }
    cout<<endl;
    if(L[m][n]==0 || L[m][n]==1)
    {
        cout<<"case"<<" "<<cnt<<" "<<'N'<<endl;
    }
    else
{
    int i=m;
    int j=n;

    int index=L[m][n];
    char lcs[index+1];

    lcs[index]='\0';

    int x=0;
    while(i>0 && j>0)
    {
        if(X[i-1]==Y[j-1])
        {
            lcs[index-1]=X[i-1];
            


            i--;
            j--;
            index--;


            
        }
        else if(L[i-1][j]<L[i][j-1])
        {
            j--;
        }
        else
            i--;
    }




    cout<<"case"<<" "<<cnt<<" "<<'Y'<<endl;
        cout<<strlen(lcs)<<endl;

        /*for(int p=0;p<strlen(lcs);p++)
        {
            cout<<lcs[p]<<" ";
            for(int q=0;q<strlen(X);q++)
            {
                if(X[q]==lcs[p] && p-1)
                  {
                      cout<<q+1<<" ";
                      break;
            }
            }
            for(int k=0;k<strlen(Y);k++)
            {
                if(Y[k]==lcs[p])
                    cout<<k+1;
            }
            cout<<endl;

}
*/      int result=-1;
        int result1=-1;
        for(int a=0;a<strlen(lcs);a++)
        {
            for(int b=0;b<strlen(X);b++)
            {
                if(lcs[a]==X[b] && b>result)
                {
                    cout<<lcs[a]<<" "<<b+1;
                    result=b;
                    break;
                }
            }
            for(int c=0;c<strlen(Y);c++)
            {
                if(lcs[a]==Y[c] && c>result1)
                {
                    cout<<" "<<c+1<<endl;
                    result1=c;
                    break;
                }
            }
            
        }
}
}
int main()
{
    int t,n,m;
    char X[1001],Y[1001];
    cin>>t;
    int cnt=1;
    while(t--)
    {
        cin>>m;
        cin>>X;
        cin>>n;
        cin>>Y;


     LCS(X,Y,m,n,cnt);


     cnt++;
    }
    return 0;
}


