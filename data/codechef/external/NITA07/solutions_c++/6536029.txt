#include<queue>
#include<utility>
#include<iostream>
using namespace std;
#define mp make_pair

int n, m, arr[105][105], visited[105][105], dis[105][105];

int dirx[] = {-1, -1, -1, 0, 0, 1, 1, 1};
int diry[] = {-1, 0, 1, -1, 1, -1, 0, 1};

int isSafe(int i, int j)
{
	return(i>=0 && i<n && j>=0 && j<m && visited[i][j]==0 && arr[i][j]==0);
}

int bfs()
{
	int x, y;
	pair<pair<int, int>, int> v;
	queue<pair<pair<int, int>, int> > q;
    q.push(mp(mp(0, 0), 0));
    visited[0][0]=1;
    
    while(!q.empty())
    {
        v=q.front();
        q.pop();
        x=v.first.first, y=v.first.second;
        dis[x][y]=v.second;
        if(x==n-1 && y==m-1) return dis[x][y];
        for(int k=0; k<8; k++)
        {
        	int xx=x+dirx[k], yy=y+diry[k];
            if(isSafe(xx, yy))
            {
                q.push(mp(mp(xx, yy), dis[x][y]+1));
                visited[xx][yy]=1;
                //if(xx==n-1 && yy==m-1) return dis[xx][yy];
            }
        }
    }
    return dis[n-1][m-1];
}

int main()
{
    cin>>n;
    string s;
    for(int i=0; i<n; i++)
    {
    	cin>>s;
    	if(i==0) m = s.length();
    	for(int j=0; j<m; j++) arr[i][j] = s[j]-48;
    }
    cout<<bfs()+1;
    return 0;
}