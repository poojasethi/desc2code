#include <iostream>
#include <cstdio>
#include <algorithm>
#define size 300
using namespace std;

int lbcount[40000] = {0};

void init(int maxlb){
    for(int i=1;i<maxlb;i++){
        lbcount[i] = i;
    }
}
int mymin(int i,int j){

    if (i>0 && j>0)return min(i,j);
    else if (i==0 && j==0) return 0;
    else if (j>0) return j;
    else if (i>0) return i;

}

int chkeight(int arr[size][size],int i,int j){
    return mymin(mymin(arr[i][j-1],arr[i-1][j-1]),
                 mymin(arr[i-1][j],arr[i-1][j+1]));

}


int twopass(int arr[size][size],int out[size][size],int n,int m){

    int count = 0;
    int maxcount = 1;
    //fist pass
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            if (arr[i][j] == 1){
                out[i][j] = chkeight(out,i,j);
                if (out[i][j] == 0){
                    out[i][j] = maxcount;
                    maxcount++;
                }
            }
        }
    }
    init(maxcount);
    //second pass
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            if (out[i][j] >= 1){
                int temp = chkeight(out,i,j);
               // cout <<" temp = "<<temp<<endl;
                if (temp >0){
                    if (out[i][j]    > temp && lbcount[out[i][j]]     > temp) lbcount[out[i][j]]     = temp;
                    if (out[i-1][j-1]> temp && lbcount[out[i-1][j-1]] > temp) lbcount[out[i-1][j-1]] = temp;
                    if (out[i-1][j]  > temp && lbcount[out[i-1][j]]   > temp) lbcount[out[i-1][j]]   = temp;
                    if (out[i-1][j+1]> temp && lbcount[out[i-1][j+1]] > temp) lbcount[out[i-1][j+1]] = temp;
                    if (out[i][j-1]  > temp && lbcount[out[i][j-1]]   > temp) lbcount[out[i][j-1]]   = temp;
                }
            }
        }
    }
    for(int i=1;i<=maxcount;i++){
   //     cout << lbcount[i] <<endl;
        if (lbcount[i]==i) count++;
    }
    return count;
}



int acase(int *cc)
{
    int m,n;
    int arr[size][size] = {0};
    int out[size][size] = {0};
    scanf("%d %d",&n,&m);
    char temp;
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            cin >> temp;
            if(temp == '#') arr[i][j] = 1;
        }
    }
    (*cc) = twopass(arr,out,n,m);
/*
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            cout << out[i][j] << " ";
        }
        cout <<endl;
    }
*/
}

int main(){
    int numcase;
    cin >> numcase;
    int cases[20];
    for(int i=0;i<numcase;i++){
        acase(&cases[i]);
    }
    for(int i=0;i<numcase;i++){
        cout << cases[i];
        if( i<numcase-1) cout <<endl;
    }
}
