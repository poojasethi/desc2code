
#include<bits/stdc++.h>

using namespace std;

#define si(x) scanf("%d",&x)
#define pri(x) printf("%d",x)
#define sll(x) scanf("%lld",&x)
#define pll(x) printf("%lld",x)
#define sstr(s) scanf("%s",s)
#define pstr(s) printf("%s",s)
#define nl printf("\n")
#define ll long long int

struct sgt {
    ll mini,maxi;
};
sgt tr[1000000];
ll a[1000000];

ll buildmin(int pos, int st, int end)
{
    if(st>end)
	return 100000000000ll;
    if(st == end)
    {
	tr[pos].mini = a[st];
	return a[st];
    }
    ll x=buildmin(pos*2+1,st,(st+end)/2);
    ll y=buildmin(pos*2+2,1+(st+end)/2,end);
    tr[pos].mini=min(x,y);
}

ll buildmax(int pos, int st, int end)
{
    if(st>end)
	return -100;
    if(st == end)
    {
	tr[pos].maxi = a[st];
	return a[st];
    }
    ll x=buildmax(pos*2+1,st,(st+end)/2);
    ll y=buildmax(pos*2+2,1+(st+end)/2,end);
    tr[pos].maxi=max(x,y);
}

ll querymin(int pos, int st, int end, int qs, int qe)
{
    if(st>end || st>qe || end<qs)
	return 100000000000ll;
    if(st>=qs && end<=qe)
    {
	return tr[pos].mini;
    }
    if(st!=end)
    {
	ll x=querymin(2*pos+1,st,(st+end)/2,qs,qe);
	ll y=querymin(2*pos+2,1+(st+end)/2,end,qs,qe);
	return min(x,y);
    }
}

ll querymax(int pos, int st, int end, int qs, int qe)
{   
    if(st>end || st>qe || end<qs)
	return -100;
    if(st>=qs && end<=qe)
    {
	return tr[pos].maxi;
    }   
    if(st!=end)
    {   
	ll x=querymax(2*pos+1,st,(st+end)/2,qs,qe);
	ll y=querymax(2*pos+2,1+(st+end)/2,end,qs,qe);
	return max(x,y);
    }
} 
int main()
{
    int n,q;
    si(n); si(q);
    for(int i=0;i<n;++i)
    {
	sll(a[i]);
    }
    buildmin(0,0,n-1);
    buildmax(0,0,n-1);
//    for(int i=0;i<10;++i)
//	cout<<tr[i].mini<<" ";
//    nl;
    while(q--)
    {
	int x,y;
	si(x); si(y);
	ll a=querymin(0,0,n-1,x,y);
	ll b=querymax(0,0,n-1,x,y);
	pll(b-a);
	nl;
    }
    return 0;
}
