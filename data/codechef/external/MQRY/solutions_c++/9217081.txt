#include <bits/stdc++.h>

using namespace std;

void maketree(long long int arr[],long long int maxtree[],long long int mintree[],long int low,long int high,long int pos)
{
    if(low==high)
    {
        maxtree[pos]=arr[low];
        mintree[pos]=arr[low];
        return;
    }
    int mid=(low+high)/2;
    maketree(arr,maxtree,mintree,low,mid,2*pos+1);
    maketree(arr,maxtree,mintree,mid+1,high,2*pos+2);
    maxtree[pos]=max(maxtree[2*pos+1],maxtree[2*pos+2]);
    mintree[pos]=min(mintree[2*pos+1],mintree[2*pos+2]);
}

long long int rangemin(long long int mintree[],long int qlow,long int qhigh,long int low,long int high,long int pos)
{
    if(qlow<=low&&qhigh>=high)
        return mintree[pos];
    if(qlow>high||qhigh<low)
        return INT_MAX;
    long int mid=(high+low)/2;
    return min(rangemin(mintree,qlow,qhigh,low,mid,2*pos+1),rangemin(mintree,qlow,qhigh,mid+1,high,2*pos+2));
}

long long int rangemax(long long int maxtree[],long int qlow,long int qhigh,long int low,long int high,long int pos)
{
    if(qlow<=low&&qhigh>=high)
        return maxtree[pos];
    if(qlow>high||qhigh<low)
        return INT_MIN;
    long int mid=(high+low)/2;
    return max(rangemax(maxtree,qlow,qhigh,low,mid,2*pos+1),rangemax(maxtree,qlow,qhigh,mid+1,high,2*pos+2));
}

int main()
{
    long int n,q;
    scanf("%ld %ld",&n,&q);
    long long int arr[n];
    for(long int i=0;i<n;i++)
        scanf("%lld",&arr[i]);
    long long int s=1;
    while(s<n)
        s<<=1;
    long long int maxsegtree[2*s-1],minsegtree[2*s-1];
    memset(maxsegtree,INT_MIN,sizeof(maxsegtree));
    memset(minsegtree,INT_MAX,sizeof(minsegtree));
    maketree(arr,maxsegtree,minsegtree,0,n-1,0);
    /*for(long int i=0;i<2*s-1;i++)
        printf("%lld ",maxsegtree[i]);
    printf("\n");
    for(long int i=0;i<2*s-1;i++)
        printf("%lld ",minsegtree[i]);*/
    while(q--)
    {
        long int x,y;
        scanf("%ld %ld",&x,&y);
        printf("%lld\n",rangemax(maxsegtree,x,y,0,n-1,0)-rangemin(minsegtree,x,y,0,n-1,0));
    }
    return 0;
}
