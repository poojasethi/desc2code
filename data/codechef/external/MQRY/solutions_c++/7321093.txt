#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
using namespace std;
int n,q,i,j,x,y;
int A[17][100001],B[17][100001];
int main()
{
  scanf("%d%d",&n,&q);
  for(i=0;i<n;i++)
  {
    scanf("%d",&A[0][i]);
    B[0][i]=A[0][i];
  }
  for(i=1;1<<i<=n;i++)
    for(j=0;j+(1<<(i-1))<n;j++)
    {
      A[i][j]=min(A[i-1][j],A[i-1][j+(1<<(i-1))]);
      B[i][j]=max(B[i-1][j],B[i-1][j+(1<<(i-1))]);
    }
  while(q--)
  {
    scanf("%d%d",&x,&y);
    for(i=0;1<<(i+1)<=y-x+1;i++);
    printf("%d\n",max(B[i][x],B[i][y-(1<<i)+1])-min(A[i][x],A[i][y-(1<<i)+1]));
  }
	return 0;
}
