#include<bits/stdc++.h>
using namespace std;
int a[100007][18][2],n;
long b[100007];

void func()
{
    int i,j,k,p,q,x,y;
    for(i=0;i<n;i++){
        a[i][0][0]=i;
        a[i][0][1]=i;
    }
    k=(int)(log(n)/log(2));
    for(j=1;j<=k;j++){
        for(i=0;i+(int)pow(2,j-1)<n;i++){
            p=a[i][j-1][0];
            q=a[i+(int)pow(2,j-1)][j-1][0];
            x=a[i][j-1][1];
            y=a[i+(int)pow(2,j-1)][j-1][1];
            a[i][j][1]=(b[x]>=b[y])?x:y;
            a[i][j][0]=(b[p]<=b[q])?p:q;
        }
    }
}

int main()
{
    int i,j,k,l,m,q,x,y,r,s;
    long long a1,a2;
    scanf("%d %d",&n,&q);
    for(i=0;i<n;i++){
        scanf("%ld",&b[i]);
    }
    func();
    while(q--){
        scanf("%d %d",&i,&j);
        k=(int)(log(j-i+1)/log(2));
        x=a[i][k][0];
        y=a[j+1-(int)pow(2,k)][k][0];
        r=a[i][k][1];
        s=a[j+1-(int)pow(2,k)][k][1];
        a1=(b[x]<=b[y])?b[x]:b[y];
        a2=(b[r]>=b[s])?b[r]:b[s];
        printf("%ld\n",a2-a1);
    }
}
