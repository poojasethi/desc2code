#include<stdio.h>
#define mod 1000000007
long long int t,a,b,c,d,e,te[10][10],ar[10][10],ans[10][10];
void po(long long int n)
{
	long long int i,j,k,q;
	while(n)
	{
		if(n%2==1)
		{
			for(i=0;i<5;i++)
			{
				for(j=0;j<5;j++)
				{
					q=0;
					for(k=0;k<5;k++)
					{
						q=(q+(ar[i][k]*ans[k][j])%mod)%mod;
						if(q<0)
						q=(q+mod)%mod;
					}
					te[i][j]=q;
				}
			}
			for(i=0;i<5;i++)
			{
				for(j=0;j<5;j++)
				ans[i][j]=te[i][j]%mod;
			}
		}
		 for(i=0;i<5;i++)
			{
				for(j=0;j<5;j++)
				{
					q=0;
					for(k=0;k<5;k++)
					{
						q=(q+(ar[i][k]*ar[k][j])%mod)%mod;
						if(q<0)
						q=q+mod;
					}
					te[i][j]=q%mod;
					if(te[i][j]<0)
					te[i][j]+=mod;
				}
			}
			for(i=0;i<5;i++)
			{
				for(j=0;j<5;j++)
				ar[i][j]=te[i][j];
			}
		n=n/2;
	}
}
int main()
{
	//freopen("cook.txt","r",stdin);
	long long int tem[10];
	long long int n,i,j,su=0;
	scanf("%lld",&t);
	while(t--)
	{
		su=0;
		for(i=0;i<5;i++)
		{
			for(j=0;j<5;j++)
			{
				if(i==j)
				{
					ans[i][j]=1;
				}
				else
				ans[i][j]=0;
			}
		}
		scanf("%lld",&n);
		scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e,tem,tem+1,tem+2,tem+3);
		ar[0][0]=a;
		ar[0][1]=b;
		ar[0][2]=c;
		ar[0][3]=d;
		ar[0][4]=e;
		ar[1][0]=1;
		ar[1][1]=0;
		ar[1][2]=0;
		ar[1][3]=0;
		ar[1][4]=0;
		ar[2][0]=0;
		ar[2][1]=1;
		ar[2][2]=0;
		ar[2][3]=0;
		ar[2][4]=0;
		ar[3][0]=0;
		ar[3][1]=0;
		ar[3][2]=1;
		ar[3][3]=0;
		ar[3][4]=0;
		ar[4][0]=0;
		ar[4][1]=0;
		ar[4][2]=0;
		ar[4][3]=0;
		ar[4][4]=1;
		po(n-4);
		su=(su+(tem[3]*ans[0][0])%mod)%mod;
		if(su<0)
		su+=mod;
		su=(su+(tem[2]*ans[0][1])%mod)%mod;
		if(su<0)
		su+=mod;
		su=(su+(tem[1]*ans[0][2])%mod)%mod;
		if(su<0)
		su+=mod;
		su=(su+(tem[0]*ans[0][3])%mod)%mod;
		if(su<0)
		su+=mod;
		su=(su+(ans[0][4])%mod)%mod;
		if(su<0)
		su+=mod;
		printf("%lld\n",su);
	}
	return 0;
}
