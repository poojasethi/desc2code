#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
typedef vector<vector<ll> >matrix;
const ll K=5;
#define MOD 1000000007
matrix mul(matrix a,matrix b)
{
matrix C(K+1,vector<ll>(K+1));
for(int i=1;i<=K;i++)
{
for(int j=1;j<=K;j++)
{
for(int k=1;k<=K;k++)
{
C[i][j]=(C[i][j]+(a[i][k]*b[k][j])%MOD)%MOD;
}
}
}
return C;
}
matrix pow(matrix a,ll n)
{
if(n==1)
return a;
if(n&1)
return mul(a,pow(a,n-1));
matrix x=pow(a,n/2);
return mul(x,x);
}
int main()
{
    ll t,n,a,b,c,d,e,p,q,r,s;
    scanf("%lld",&t);
    while(t--)
    {scanf("%lld",&n);
    scanf("%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e);
    scanf("%lld%lld%lld%lld",&p,&q,&r,&s);
        matrix T(K+1,vector<ll>(K+1));
        T[5][5]=1,T[1][2]=1,T[2][3]=1,T[3][4]=1,T[4][5]=1;
 
        T[4][1]=d%MOD,T[4][2]=c%MOD,T[4][3]=b%MOD,T[4][4]=a%MOD;
       /* for(ll i=1;i<=5;i++)
           {
            for(ll j=1;j<=5;j++)
            cout<<T[i][j]<<" ";
        cout<<endl;}*/
       T=pow(T,n-1);
      /* for(ll i=1;i<=5;i++)
           {
            for(ll j=1;j<=5;j++)
            cout<<T[i][j]<<" ";
        cout<<endl;}*/
       ll res=((T[1][1]*p)%MOD+((T[1][2]*q)%MOD+((T[1][3]*r)%MOD+((T[1][4]*s)%MOD+(T[1][5]*e)%MOD)%MOD)%MOD)%MOD)%MOD;
       if(res<0)
        res+=MOD;
       printf("%lld\n",res);
    }
    return 0;
}
