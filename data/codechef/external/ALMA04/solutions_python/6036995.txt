#include <bits/stdc++.h>
using namespace std ;

#define MAXN 5 
#define LL long long 
#define sc(x) scanf("%d",&x) 
#define pr(x) printf("%d\n",x) 
#define MOD 1000000007


int res[MAXN][MAXN],Temp[MAXN][MAXN],A[MAXN][MAXN],F[MAXN] , T , N ;



void init(){
	memset(res,0,sizeof res) ;
	memset(A,0,sizeof A) ;
	for(int i=0;i<MAXN;i++)
		res[i][i] = 1 ;
	A[0][1] = A[1][2] = A[2][3] = A[4][4] = 1 ;
}


void mult(int A[MAXN][MAXN],int B[MAXN][MAXN]){

	for(int i=0;i<MAXN;i++){
		for(int j=0;j<MAXN;j++){
			Temp[i][j] = 0 ;
			for(int k=0;k<MAXN;k++){
				Temp[i][j] += (1LL * A[i][k] * B[k][j]) % MOD ;
				Temp[i][j] %= MOD ; 
			}
		}
	}
	for(int i=0;i<MAXN;i++){
		for(int j=0;j<MAXN;j++){
			A[i][j] = Temp[i][j] ;
		}
	}
}

void power(int N){

	while(N){
		if(N&1){
			mult(res,A) ;
		}
		N /= 2 ;
		mult(A,A) ;
	}
}
int main(){

	sc(T) ;
	while(T--){
		sc(N) ;		
		init() ;
		for(int i=0;i<MAXN;i++){
			sc(A[3][i]) ;
			A[3][i] += MOD ;
			A[3][i] %= MOD ;
		}
		swap(A[3][0],A[3][3]) ;
		swap(A[3][1],A[3][2]) ;
		for(int i=0;i<MAXN-1;i++){
			sc(F[i]) ;
			F[i] += MOD ;
			F[i] %= MOD ;
		}
		F[4] = 1 ;
		power(N-1) ;
		int ans = 0 ;
		for(int i=0;i<MAXN;i++){
			ans += (1LL * F[i] * res[0][i]) % MOD ;
			ans %= MOD ;
		}
		pr(ans) ;
	}
	return 0 ; 
}
