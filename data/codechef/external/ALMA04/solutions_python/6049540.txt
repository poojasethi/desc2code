#include<bits/stdc++.h>
int tempporr;
#define mod 1000000007
#define n 5
#define s(x) tempporr=scanf("%lld", &x)
#define lld long long int
using namespace std;
lld a[200][200],k;
 
void exp(){
    lld identity[200][200];       
        for(int i=0; i<n; i++){
                for(int j=0; j<n; j++){
                        identity[i][j]=0;
                }identity[i][i]=1;
        }
        while(k>0){
                if(k%2==1){
            lld temp[200][200]={0};
                        for(int i=0; i<n; i++){
                                for(int j=0; j<n; j++){
                                        for(int k=0; k<n; k++){
                                                temp[i][j]+= ((a[i][k]%mod)*(identity[k][j]%mod));
                                                temp[i][j]+=mod;
                                                temp[i][j]%=mod;        
                                        }
                                }
                        }
                        for(int i=0; i<n; i++){
                                for(int j=0; j<n; j++){
                                        identity[i][j]=(temp[i][j]);
                                        identity[i][j]+=mod;
                                        identity[i][j]%=mod;
                                }
                        }
                }
        lld temp[200][200]={0};
                for(int i=0; i<n; i++){
                        for(int j=0; j<n; j++){
                                for(int k=0; k<n; k++){
                                        temp[i][j]=temp[i][j]%mod + ((a[i][k]%mod)*(a[k][j])%mod);
                                        temp[i][j]+=mod;
                                        temp[i][j]%=mod;        
                                }
                        }
                }
                for(int i=0; i<n; i++){
                        for(int j=0; j<n; j++){
                                a[i][j]=temp[i][j];
                                a[i][j]+=mod;
                                a[i][j]%=mod;
                        }
                }
                        
        k/=2;           
        }
    for(int i=0; i<n; i++){
        for(int j=0; j<n; j++){
            a[i][j]=identity[i][j];
            a[i][j]+=mod;
            a[i][j]%=mod;
        }
    }
}
 
int main(){
        lld t;
        s(t);
        while(t--){
        	lld N; s(N);
        	lld val1,val2,val3,val4,constt,t1,t2,t3,t4;
        	s(val1); s(val2); s(val3); s(val4); s(constt); s(t1); s(t2); s(t3); s(t4);
        	a[0][0]=val1;
        	a[0][1]=val2;
        	a[0][2]=val3;
        	a[0][3]=val4;
        	a[0][4]=1;
        	for(int i=1; i<=3; i++){
        		for(int j=0; j<5; j++){
        			a[i][j]=0;
        			a[i][i-1]=1;
        		}
        	}
        	for(int i=0; i<5; i++) a[4][i]=0;
        	a[4][4]=1;
        	k=N-4;
        	exp();
        	lld ans=((((((a[0][0]*t4)%mod + (a[0][1]*t3)%mod )%mod + (a[0][2]*t2)%mod)%mod + (a[0][3]*t1)%mod)%mod + (a[0][4]*constt%mod))%mod);
            ans+=mod;
        	cout<<ans%mod<<endl;
        }
} 