#include<bits/stdc++.h>
using namespace std;
 
 int pow(  long long a[5][5], long long int  b)
{
    long long  x[5][5],y[5][5],l[5][5];
    long long int i,j,k;
    for(i=0;i<5;i++)
    {
    	for(j=0;j<5;j++)
    	{
    		if(i==j)
    		{
    			x[i][j]=1;
    		}
    		else
    		  x[i][j]=0;
    		y[i][j]=a[i][j];
    	}
    }
    
    while(b > 0)
    {
        if(b%2 == 1)
        {
            for(i=0;i<5;i++)
            {
            	for(j=0;j<5;j++)
            	{
            		l[i][j]=0;
            		for(k=0;k<5;k++)
            		{
            			l[i][j]+=x[i][k]*y[k][j];
            			l[i][j]%=1000000007;
            			if(l[i][j]<0)
            			  l[i][j]+=1000000007;
            		}
            	}
            }
            
            for(i=0;i<5;i++)
            {
            	for(j=0;j<5;j++)
            	{
            		x[i][j]=l[i][j];
            	}
            }
            
        }
        
        
        for(i=0;i<5;i++)
            {
            	for(j=0;j<5;j++)
            	{
            		l[i][j]=0;
            		for(k=0;k<5;k++)
            		{
            			l[i][j]+=y[i][k]*y[k][j];
            				l[i][j]%=1000000007;
            				if(l[i][j]<0)
            			  l[i][j]+=1000000007;
            		}
            	}
            }
            
            for(i=0;i<5;i++)
            {
            	for(j=0;j<5;j++)
            	{
            		y[i][j]=l[i][j];
            	}
            }
        
        
        b /= 2;
    }
     for(i=0;i<5;i++)
            {
            	for(j=0;j<5;j++)
            	{
            		a[i][j]=x[i][j];
            	}
            }
            return 0;
    
}
 
int main()
{
	long long t;
	scanf("%lld",&t);
	while(t--)
	{
		long long n,k,ans,i,g,b,c,d,e,t1,t2,t3,t4,t5;
		long long a[5][5];
		
	
		scanf("%lld",&n);
		scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld",&g,&b,&c,&d,&e,&t1,&t2,&t3,&t4);
		a[0][0]=g; a[1][0]=b; a[2][0]=c; a[3][0]=d; a[4][0]=e; 
		a[0][1]=1; a[1][1]=0; a[2][1]=0; a[3][1]=0; a[4][1]=0;
		a[0][2]=0; a[1][2]=1; a[2][2]=0; a[3][2]=0; a[4][2]=0;
		a[0][3]=0; a[1][3]=0; a[2][3]=1; a[3][3]=0; a[4][3]=0;
		a[0][4]=0; a[1][4]=0; a[2][4]=0; a[3][4]=0; a[4][4]=1;
		n=n-4;
		i=pow(a,n);
		ans=0;
		ans+=t4*a[0][0];
		ans%=1000000007;
		if(ans<0)
		 ans+=1000000007;
		ans+=t3*a[1][0];
		ans%=1000000007;
		if(ans<0)
		 ans+=1000000007;
		ans+=t2*a[2][0];
		ans%=1000000007;
		if(ans<0)
		 ans+=1000000007;
		ans+=t1*a[3][0];
		ans%=1000000007;
		if(ans<0)
		 ans+=1000000007;
		ans+=1*a[4][0];
		ans%=1000000007;
		if(ans<0)
		 ans+=1000000007;
	    printf("%lld\n",ans);
		
		
	}
	return 0;
} 