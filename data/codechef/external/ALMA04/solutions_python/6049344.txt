#include<stdio.h>
#include<stdlib.h>
#define mod 1000000007
long long int modexp(long long int arr[],long long int p)
{
     long long int val[5][5],xrr[5][5],i,j,k,l,temp[5][5],sum,ans,var,a,b;
     for(i=0;i<5;i++)
     {
                     for(j=0;j<5;j++)
                     {
                     if(i==j)
                     val[i][j]=1;
                     
                     else
                     val[i][j]=0;
                     }
     }
     xrr[0][0]=arr[0];xrr[0][1]=arr[1];xrr[0][2]=arr[2];xrr[0][3]=arr[3];xrr[0][4]=1;
     xrr[1][0]=1;xrr[1][1]=0;xrr[1][2]=0;xrr[1][3]=0;xrr[1][4]=0;
     xrr[2][0]=0;xrr[2][1]=1;xrr[2][2]=0;xrr[2][3]=0;xrr[2][4]=0;
     xrr[3][0]=0;xrr[3][1]=0;xrr[3][2]=1;xrr[3][3]=0;xrr[3][4]=0;
     xrr[4][0]=0;xrr[4][1]=0;xrr[4][2]=0;xrr[4][3]=0;xrr[4][4]=1;
     
     while(p>0)
     {
               if(p%2==1)
               {
                          //printf("%lld %lld %lld %lld %lld\n",val[0][0],val[0][1],val[0][2],val[0][3],val[0][4]);
     
                         for(i=0;i<5;i++)
                         {
                                         for(j=0;j<5;j++)
                                         {
                                                         sum=0;
                                                         for(k=0;k<5;k++)
                                                         {
                                                                  a=(val[i][k]+mod)%mod;
                                                                  b=(xrr[k][j]+mod)%mod;
                                                                  var=(a*b)%mod;
                                                                  sum=(((sum+var+mod)%mod));
                                                         }
                                                         sum=(sum+mod)%mod;
                                                         temp[i][j]=sum;
                                         }
                         }
                         
                         for(i=0;i<5;i++)
                         {
                                         for(j=0;j<5;j++)
                                         {
                                                     val[i][j]=temp[i][j];
                                         }
                         }
                        //  printf("%lld %lld %lld %lld %lld\n",val[0][0],val[0][1],val[0][2],val[0][3],val[0][4]);
     
                         
               }
               
                        for(i=0;i<5;i++)
                         {
                                         for(j=0;j<5;j++)
                                         {
                                                         sum=0;
                                                         for(k=0;k<5;k++)
                                                         {
                                                                  a=(xrr[i][k]+mod)%mod;
                                                                  b=(xrr[k][j]+mod)%mod;
                                                                  var=(a*b)%mod;
                                                                  sum=(((sum+var+mod)%mod));
                                                         }
                                                         sum=(sum+mod)%mod;
                                                         temp[i][j]=sum;
                                         }
                         }
                         
                         for(i=0;i<5;i++)
                         {
                                         for(j=0;j<5;j++)
                                         {
                                                     xrr[i][j]=temp[i][j];
                                         }
                         }
                         
                         
                         p=p/2;
     }
  
     
     ans=( ((((val[0][0]+mod)%mod)*((arr[8]+mod)%mod)))%mod +((((val[0][1]+mod)%mod)*((arr[7]+mod)%mod)))%mod + ((((val[0][2]+mod)%mod)*((arr[6]+mod)%mod)))%mod + ((((val[0][3]+mod)%mod)*((arr[5]+mod)%mod)))%mod + ((((val[0][4]+mod)%mod)*((arr[4]+mod)%mod)))%mod )   ;
     ans= (ans+mod)%mod;
     return ans;
}
 
int main()
{
    long long int i,j,k,t,n,arr[9],ans;
    scanf("%lld",&t);
    while(t--)
    {
              scanf("%lld",&n);
              
              for(i=0;i<9;i++)
              scanf("%lld",&arr[i]);
              
              
              ans=modexp(arr,n-4);
              
              printf("%lld\n",ans);
    }
    system("pause");
    return 0;
}
              
              
