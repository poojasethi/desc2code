#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
#include<vector>
#define mod 1000000007
#define FOR(x,K) for(int x=1;x<=K+1;x++)
using namespace std;
typedef long long ll;
typedef  vector<vector<ll> >matrix;
const ll K=4;
matrix mulmod(matrix A,matrix B)
{
    matrix C(K+2,vector<ll>(K+2));
    FOR(i,K)
     FOR(j,K)
     FOR(k,K)
     C[i][j]=(C[i][j]+(A[i][k]*B[k][j])%mod)%mod;
     return C;
     }
matrix power(matrix A,ll n)
{
    if(n==1)
        return A;
    if(n&1)
       return mulmod(A,power(A,n-1));
    matrix X=power(A,n/2);
    return mulmod(X,X);
}
int main(void)
{
    ll t,n,a,b,c,d,e,p,q,r,s;
    scanf("%lld",&t);
    while(t--)
    {scanf("%lld",&n);
    scanf("%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e);
    scanf("%lld%lld%lld%lld",&p,&q,&r,&s);
        matrix T(K+2,vector<ll>(K+2));
        T[5][5]=1,T[1][2]=1,T[2][3]=1,T[3][4]=1,T[4][5]=1;

        T[4][1]=d,T[4][2]=c,T[4][3]=b,T[4][4]=a;
       /* for(ll i=1;i<=5;i++)
           {
            for(ll j=1;j<=5;j++)
            cout<<T[i][j]<<" ";
        cout<<endl;}*/
       T=power(T,n-1);
      /* for(ll i=1;i<=5;i++)
           {
            for(ll j=1;j<=5;j++)
            cout<<T[i][j]<<" ";
        cout<<endl;}*/
       ll res=((T[1][1]*p)%mod+((T[1][2]*q)%mod+((T[1][3]*r)%mod+((T[1][4]*s)%mod+(T[1][5]*e)%mod)%mod)%mod)%mod)%mod;
       if(res<0)
        res+=mod;
       printf("%lld\n",res);
    }
    return 0;
}

