#include<stdio.h>
#define LL long long int
#define mod 1000000007
int mat[9][9],C[9][9];
int a,b,c,d,e,one,two,three,four,ans;
int power_matrix(int n)
{	int temp[9][9],val;
	int i,j,k;
	for(i=1;i<=5;i++)
		for(j=1;j<=5;j++)
			temp[i][j]=0;
	for(i=1;i<=6;i++) temp[i][i]=1;
	while(n>0)
	{	if(!(n&1))
		{	//mat*mat
			for(i=1;i<=5;i++)
			{	for(k=1;k<=5;k++)
				{	int sum=0;
					for(j=1;j<=5;j++)
						sum=(sum%mod*(1LL)+((mat[i][j]%mod*(1LL)*mat[j][k]%mod)%mod)*(1LL))%mod;
					C[i][k]=sum%mod;
				}
			}
			for(i=1;i<=5;i++)
				for(j=1;j<=5;j++)
					mat[i][j]=C[i][j]%mod;
			n>>=1;
		}
		else
		{	//temp=temp*mat
			for(i=1;i<=5;i++)
			{	for(k=1;k<=5;k++)
				{	int sum=0;
					for(j=1;j<=5;j++)
						sum=(sum%mod*(1LL)+((mat[i][j]%mod*(1LL)*temp[j][k]%mod)%mod)*(1LL))%mod;
					C[i][k]=sum%mod;
				}
			}
			for(i=1;i<=5;i++)
				for(j=1;j<=5;j++)
					temp[i][j]=C[i][j]%mod;
			n--;
		}
	}
	one=(one+mod)%mod;two=(two+mod)%mod;three=(three+mod)%mod;four=(four+mod)%mod;
	val=(temp[1][1]%mod*(1LL)*four)%mod;
	val=((val%mod+(temp[1][2]%mod*(1LL)*three)%mod)*(1LL))%mod;
	val=((val%mod+(temp[1][3]%mod*(1LL)*two)%mod)*(1LL))%mod;
	val=((val%mod+(temp[1][4]%mod*(1LL)*one)%mod)*(1LL))%mod;
	val=((val%mod+temp[1][5]%mod)*(1LL))%mod;
	return val%mod;
}
int main()
{	int t,i,j;
	int n;
	scanf("%d",&t);
	while(t--)
	{	for(i=1;i<=5;i++)
			for(j=1;j<=5;j++)
				mat[i][j]=(LL)0;
		scanf("%d",&n);
		scanf("%d%d%d%d%d",&a,&b,&c,&d,&e);
		scanf("%d%d%d%d",&one,&two,&three,&four);
		mat[1][1]=(a+mod)%mod;mat[1][2]=(b+mod)%mod;mat[1][3]=(c+mod)%mod;mat[1][4]=(d+mod)%mod;mat[1][5]=(e+mod)%mod;
		mat[2][1]=1;mat[3][2]=1;mat[4][3]=1;mat[5][5]=1;
		//cout<<"hell";
		ans=power_matrix(n-4)%mod;
		printf("%d\n",ans%mod);
	}
	return 0;
}