#include<stdio.h>
#define mod 1000000007
#define ll long long
ll int M[5][5];
ll int a[5][5];
void multiply(ll int a[][5],ll int b[][5])
{
    ll int ans[5][5];
    int i,j,k;
    for(i=0;i<5;i++)
    {
        for(j=0;j<5;j++)
            ans[i][j]=0;
    }
    for(i=0;i<5;i++)
    {
        for(j=0;j<5;j++)
        {
            for(k=0;k<5;k++)
            {
                ans[i][j]=(ans[i][j]+(a[i][k]*b[k][j])%mod)%mod;
            }
        }
    }
    for(i=0;i<5;i++)
    {
        for(j=0;j<5;j++)
            a[i][j]=ans[i][j];
    }
}
void matrix_expo(ll int a[][5],int n)
{
    if((n==0)||(n==1))
        return ;
    matrix_expo(a,n/2);
    multiply(a,a);
    if((n%2)!=0)
        multiply(a,M);
}
int main()
{
    int t,n,i,j;
    scanf("%d",&t);
    ll int fn,aa,b,c,d,e,t1,t2,t3,t4;
    while(t--)
    {
        for(i=0;i<5;i++)
        {
            for(j=0;j<5;j++)
                a[i][j]=0;
        }
        fn=0;
        scanf("%d",&n);
        scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld",&aa,&b,&c,&d,&e,&t1,&t2,&t3,&t4);
        M[0][0]=a[0][0]=(aa+mod)%mod;
        M[0][1]=a[0][1]=(b+mod)%mod;
        M[0][2]=a[0][2]=(c+mod)%mod;
        M[0][3]=a[0][3]=(d+mod)%mod;
        M[0][4]=a[0][4]=1;
        M[1][0]=a[1][0]=1;
        M[2][1]=a[2][1]=1;
        M[3][2]=a[3][2]=1;
        M[4][4]=a[4][4]=1;
        t4=(t4+mod)%mod;
        t3=(t3+mod)%mod;
        t2=(t2+mod)%mod;
        t1=(t1+mod)%mod;
        e=(e+mod)%mod;
        matrix_expo(a,n-4);
        fn=(a[0][0]*t4)%mod;
        fn=(fn+(a[0][1]*t3)%mod)%mod;
        fn=(fn+(a[0][2]*t2)%mod)%mod;
        fn=(fn+(a[0][3]*t1)%mod)%mod;
        fn=(fn+(a[0][4]*e)%mod)%mod;
        printf("%lld\n",fn);
    }
    return 0;
}
