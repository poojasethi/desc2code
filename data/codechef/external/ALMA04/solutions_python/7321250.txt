#include<bits/stdc++.h>
using namespace std;
#define lli long long int
lli M,t1,t2,t3,t4,A,B,C,D,E;
#define sz 5
void multiply(lli a[sz][sz],lli b[sz][sz]){
	lli ans[sz][sz]={0};
	for(lli i=0;i<sz;i++){
		for(lli j=0;j<sz;j++){
			for(lli k=0;k<sz;k++){
				ans[i][j]=(ans[i][j]+a[i][k]*b[k][j])%M;
			}
		}
	}
	for(lli i=0;i<sz;i++){
		for(lli j=0;j<sz;j++){
			a[i][j]=ans[i][j]%M;
		}
	}
}
void exp_rec(lli f[sz][sz],lli n){
	if(n==0||n==1)return ;//base case
	lli ans[sz][sz]={{A,B,C,D,1},
					{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,0,1}	
					};
	exp_rec(f,n>>1);
	multiply(f,f);
	if(n&1){
		multiply(f,ans);
	}
}
lli fib(lli n){
	if(n==0)return t1;
	if(n==1)return t2;
	if(n==2)return t3;
	if(n==3)return t4;
	lli f[sz][sz]={{A,B,C,D,1},
					{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,0,1}	
					};
	exp_rec(f,n-4);
	return (t4*f[0][0]%M+t3*f[0][1]%M+t2*f[0][2]%M+t1*f[0][3]%M+E*f[0][4]%M)%M;
}
int main(){
	M=1000000007;
//	A=B=C=D=E=t1=t2=t3=t4=1;
//	cout<<fib(8);
	int t;
	cin>>t;
	while(t--){
		lli n;
		scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld%lld",&n,&A,&B,&C,&D,&E,&t1,&t2,&t3,&t4);
		//cin>>n>>A>>B>>C>>D>>E>>t1>>t2>>t3>>t4;
		t1=(t1+M)%M;
		t2=(t2+M)%M;
		t3=(t3+M)%M;
		t4=(t4+M)%M;
		A=(A+M)%M;
		B=(B+M)%M;
		C=(C+M)%M;
		D=(D+M)%M;
		E=(E+M)%M;
		lli ans=(fib(n)+M)%M;
		printf("%lld\n",(ans+M)%M);
		//cout<<(ans+M)%M<<"\n";
	}
	
	return  0;
}