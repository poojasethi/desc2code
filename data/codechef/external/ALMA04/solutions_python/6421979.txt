#include<bits/stdc++.h>
#include<stdio.h>
#include<string.h>
#include<iostream>
using namespace std;
long long int arr[6][6],res[5][5],crr[5][5];

inline long long int inp()
{
    long long int n=0;
    long long int ch=getchar();
    while( ch< '0' || ch > '9'){  ch=getchar();  }
    while( ch>='0' && ch<='9')  n=(n<<3) + (n<<1) + ch-'0',ch=getchar();
    return n;
}

void multiply(){
    long long int i,j,k;
    for(i=0;i<5;i++)
    for(j=0;j<5;j++){
            crr[i][j]=0;
            for(k=0;k<5;k++){
                crr[i][j]=crr[i][j]+(arr[i][k]*arr[k][j]);
                crr[i][j]%=1000000007;
                if(crr[i][j]<0)
                    crr[i][j]+=1000000007;
            }
    }
    for(i=0;i<5;i++)
        for(j=0;j<5;j++)
            arr[i][j]=crr[i][j];
}
void power(long long int n)
{

    for(long long int i=0;i<5;i++)    for(long long int j=0;j<5;j++)    if(i==j) res[i][j]=1;else res[i][j]=0;
    while(n){
        if(n%2==1){
            for(int i=0;i<5;i++){
                for(int j=0;j<5;j++){
                        crr[i][j]=0;
                        for(int k=0;k<5;k++){
                                crr[i][j]=crr[i][j]+(res[i][k]*arr[k][j]);
                                crr[i][j]%=1000000007;
                                if(crr[i][j]<0)
                                    crr[i][j]+=1000000007;
                                }
                }
            }
            for(int i=0;i<5;i++)
                for(int j=0;j<5;j++)
                    res[i][j]=crr[i][j];
        }
        multiply();//multilying a=a*a % 1000000007
        n=n/2;
    }
}

long long int mat_exp(long long int a,long long int b,long long int c,long long int d,long long int e,long long int n)
{

    arr[0][0]=a;    arr[0][1]=b;    arr[0][2]=c;    arr[0][3]=d;    arr[0][4]=e;
    for(int i=1;i<5;i++){
        for(int j=0;j<5;j++)
            if(j==i-1)  arr[i][j]=1;
            else arr[i][j]=0;
    }
    arr[4][3]=0;arr[4][4]=1;
    power(n-4);

}
int main()
{
    long long int n,a,b,c,d,e,t1,t2,t3,t4,i,j,ans;
    int t;
    scanf("%d",&t);
    while(t--){
            //cin>>n;
        n=inp();
        //a=inp();b=inp();c=inp();d=inp();e=inp();t1=inp();t2=inp();t3=inp();t4=inp();
        //cin>>a>>b>>c>>d>>e>>t1>>t2>>t3>>t4;
        scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e,&t1,&t2,&t3,&t4);
        mat_exp(a,b,c,d,e,n);
        ans=0;
        ans=(ans+res[0][0]*t4)%1000000007;
        if(ans<0)   ans+=1000000007;
         ans=(ans+res[0][1]*t3)%1000000007;
         if(ans<0)  ans+=1000000007;
          ans=(ans+res[0][2]*t2)%1000000007;
          if(ans<0) ans+=1000000007;
           ans=(ans+res[0][3]*t1)%1000000007;
           if(ans<0) ans+=1000000007;
           ans=(ans+res[0][4])%1000000007;
           if(ans<0)    ans+=1000000007;

           //cout<<1000000007<<endl;
      printf("%lld\n",ans);
    // cout<<ans<<endl;
    }
    return 0;
}
