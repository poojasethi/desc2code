#include <iostream>
#include <cstdio>
#include <cstring>
#include <map>
#include <vector>
#include <cmath>
#include <queue>
#include <algorithm>
#ifndef ONLINE_JUDGE
#define gc getchar
#else
#define gc getchar_unlocked
#endif
#define ll long long
#define nl() printf ("\n")
#define si(a) scanf("%d",&a)
#define sl(a) scanf("%lld",&a)
#define pi(x) printf ("%d",x)
#define pl(x) printf ("%lld",x)
#define pc(x) printf ("%c",x)
#define ps(x) printf ("%s",x)
#define pb(x) push_back(x)
#define mp(a,b) make_pair(a,b)
#define repu(i,a,n,step) for (i = a; i < n; i += step)
#define repd(i,a,n,step) for (i = a - 1; i >= n; i += step)
#define MOD 1000000007 
using namespace std;
int readi () {
	int n=0,sign=0;
	char c=gc();
	while (c<48) {
		if (c==45) sign=1;
		c=gc();
	}
	while (c>47) {
		n=n*10+c-'0';
		c=gc();
	}
	if (sign) return (-n);
	return n;
}
ll readl () {
	ll n=0;int sign=0;
	char c=gc();
	while (c<48) {
		if (c==45) sign=1;
		c=gc();
	}
	while (c>47) {
		n=n*10+c-'0';
		c=gc();
	}
	if (sign) return (-n);
	return n;
}
double power(double x, int y)
{
    double temp;
    if( y == 0)
       return 1;
    temp = power(x, y/2);
    if (y%2 == 0)
        return temp*temp;
    else
    {
        if(y > 0)
            return x*temp*temp;
        else
            return (temp*temp)/x;
    }
}
void multiply(ll F[5][5], ll M[5][5]) {
        ll c[5][5];
  		for(int i=0;i<5;++i) {
   			for(int j=0;j<5;++j) {
    			c[i][j]=0;
    			for(int k=0;k<5;++k)
     			c[i][j]=(c[i][j]+(F[i][k]*M[k][j]))%MOD;
     			c[i][j] += MOD;
     			c[i][j] %= MOD;
   			}
		}
		for (int i=0;i<5;i++) {
			for (int j=0;j<5;j++) {
				F[i][j] = (c[i][j]%MOD);
				F[i][j] += MOD;
				F[i][j] %= MOD;
			}
		}
}
void powmat(ll F[5][5], ll n, ll gb[5][5]) {
        if (n == 0 || n == 1) {
                return;
        }
        else if (! (n & 1)){
                (powmat(F,n/2, gb));
                multiply(F,F);
                //cout<<F[0][0]<<" "<<F[0][1]<< " "<<F[1][0]<<" "<<F[1][1]<<"\n";
        }
        else{
                powmat(F,(n-1),gb);
                multiply(F,gb);
               // multiply(F,gb);
        }
}
 
ll value (ll n,ll M[5][5],ll gb[5][5], ll t1, ll t2, ll t3, ll t4, ll a, ll b, ll c, ll d, ll e) {
        if (n == 1) return t1;
        if (n == 2) return t2;
        if (n == 3) return t3;
        if (n == 4) return t4;
        powmat(M,n-4,gb);
        //cout<<M[0][0]<<" "<<M[0][1]<<" "<<M[0][2]<<" "<<M[0][3]<<" "<<a<<" "<<b<<" "<<c<<" "<<d<<" "<<e<<"\n";
        ll ans = ((t1*M[0][0])%MOD + MOD + (t2*M[0][1])%MOD + MOD + (t3*M[0][2])%MOD + MOD + (t4*M[0][3])%MOD + MOD + (e*M[0][4])%MOD + MOD) %MOD;
        return ans;
}
 
 
int main() {
        int t;
        ll n,a,b,c,d,e,t1,t2,t3,t4;
        t = readi();
        while (t--) {
                n = readl();
                a=readl();b=readl();c=readl();d=readl();e=readl();
                t1=readl();t2=readl();t3=readl();t4=readl();
                //cout<<t1<<" "<<t2<<" "<<t3<<" "<<t4<<"\n";
                ll gb[5][5] = {{a,b,c,d,1},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,0,1}};
				ll M[5][5] = {{a,b,c,d,1},{1,0,0,0,0},{0,1,0,0,0},{0,0,1,0,0},{0,0,0,0,1}};
				long long val = (value(n,M,gb,t4,t3,t2,t1,d,c,b,a,e));
                if (val < 0) {
                	val = (val+MOD);
                }
                pl(val);
                nl();
        }
return 0;
}
 