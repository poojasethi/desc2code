#include <iostream>
using namespace std;
 

int main()
{
    register int t=0;
    cin>>t;
    for(register int i=0;i<t;i++){
        register unsigned long long int a,d,n,x;
        cin>>a>>d>>n>>x;
    
    register unsigned long long int result = a;  
 
    for (int i=1; i<(int)n+1; i++)
    result = (((result*x))% 274877906944ULL + (a+d*i)% 274877906944ULL)% 274877906944ULL;
        cout<<result<<endl;
    }
    return 0;
} 