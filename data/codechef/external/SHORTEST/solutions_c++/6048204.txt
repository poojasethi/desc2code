#include <bits/stdc++.h>
  
#ifndef ONLINE_JUDGE
    #define gc getchar
    #define pc putchar
#else
    #define gc getchar_unlocked
    #define pc putchar_unlocked
#endif 
  
using namespace std;  
 
typedef long long ll;
typedef vector<int> vi;
typedef pair<int, int> ii;
typedef vector<ii> vii;
typedef set<int> si;
typedef map<string, int> msi;
 
template< class T > T _abs(T n) { return (n < 0 ? -n : n); }  
template< class T > T _max(T a, T b) { return (!(a < b) ? a : b); }  
template< class T > T _min(T a, T b) { return (a < b ? a : b); }    
template< class T > T gcd(T a, T b) { return (b != 0 ? gcd<T>(b, a%b) : a); }  
template< class T > T lcm(T a, T b) { return (a / gcd<T>(a, b) * b); }  
template< class T > bool inside(T a, T b, T c) { return a<=b && b<=c; }    
 
inline int fr() {
    register int c = gc();
	int x = 0; 
    for(; (c<48 || c>57); c = gc());
    for(; c>47 && c<58 ; c = gc()) {
        x = x*10 + c - 48;
}
return x;}
inline void fp(int n){
    if (n / 10 != 0)
        fp(n / 10);
    putchar((n % 10) + '0');
} 
inline ll frl() {
    register int c = gc();
	ll x = 0; 
    for(; (c<48 || c>57); c = gc());
    for(; c>47 && c<58 ; c = gc()) {
        x = x*10 + c - 48;
}
return x;}
inline void fpl(ll n){
    if (n / 10 != 0)
        fpl(n / 10);
    putchar((n % 10) + '0');
} 
#define SWAP(a,b) {a^=b;b^=a;a^=b;}
#define MP(x, y) make_pair(x, y)
#define SZ(a) int((a).size())     
#define SET(p) memset(p, -1, sizeof(p))  
#define SETINF(p) memset(p, 127, sizeof(p))  
#define CLR(p) memset(p, 0, sizeof(p))    
#define CPY(d, s) memcpy(d, s, sizeof(s))    
#define PB(x) push_back(x)  
#define bitcount      __builtin_popcount
#define all(c) (c).begin(),(c).end() 
#define present(c,x) ((c).find(x) != (c).end()) 
#define cpresent(c,x) (find(all(c),x) != (c).end()) 

#define fi first  
#define se second    

#define REP(i, a, b) for (int i = int(a); i < int(b); i++) // a to b, and variable i is local!
#define REPN(i, a, b) for (int i = int(a); i <= int(b); i++)
#define RTR(container, it) for(typeof(container.begin()) it = container.end()-1; it >= container.begin(); --it)
#define TR(container, it) for(typeof(container.begin()) it = container.begin(); it != container.end(); ++it)

#define TRY(i,o) freopen(i,"r",stdin); freopen(o,"w",stdout);

#define sf(n)                       scanf("%lf",&n)
#define ss(n)                       scanf("%s",n)

#define INF 0x7f7f7f7f
#define SINF 1000000000 //safe inf for floyd warshall

vii g[1001];
int d[1001];

int main() { 
	//TRY("in.txt","out.txt");
	int n,m,t=fr(),a,b,q,w;
	priority_queue<ii,deque<ii>,greater<ii> > pq;
	while(t--){
		while(!pq.empty())pq.pop();
		n=fr();m=fr();q=fr();
		REPN(i,0,n)g[i].clear();
		while(m--){
			a=fr();b=fr();w=fr();
			g[a].PB(MP(b,w));
			g[b].PB(MP(a,w));
		}
		memset(d,63,sizeof(d));
		pq.push(MP(0,1));
		d[1]=0;
		while(!pq.empty()){
			int u=pq.top().se,dis=pq.top().fi;
			pq.pop();
			if(dis==d[u]){
				for(int i=0;i<g[u].size();++i){
					int v=g[u][i].fi;
					if(d[v]>d[u]+g[u][i].se){
						d[v]=d[u]+g[u][i].se;
						pq.push(MP(d[v],v));
					}
				}
			}
		}
		while(q--){
			fp(d[fr()]);pc('\n');
		}
	}
	return 0;  
}   