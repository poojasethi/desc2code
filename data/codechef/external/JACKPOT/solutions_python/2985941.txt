#include <iostream>
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <ctype.h>
#include <time.h>
#include <math.h>
#include <string>
#include <algorithm>
#include <sstream>
#include <fstream>
#include <map>
#include <vector>
#include <queue>
#include <set>
#include <stack>
#include <utility>
#include <iomanip>
using namespace std;




#define LL long long
#define rep(i,a,n) for(LL i = a;i<n;i++)
#define S(a) scanf("%d",&a)
#define P(a) printf("%d\n",a)
#define PS(s) printf(s)
#define SLL(a) scanf("%lld",&a)
#define PLL(a) printf("%lld\n",a)


#define II LL


#define MOD 1000000007      

LL dig(LL n, LL a)
{
	//a--;
	//LL ret;
	//return n&1;
	//printf("dig(%lld,%lld) = %lld",n,a,(n>>a)&1);
	return (n>>a)&1;
}
LL nextone(LL n, LL idx)
{
	//printf( "one at %lld, ",idx);
	idx--;
	while(idx>=0 && dig(n,idx) != 1)
	{
		idx--;
	}
	//printf("next i = %lld\n",idx);
	return idx;
}
LL ans(LL n)
{
	LL h = 0;
	while(n>=(1LL<<h)) 
	{
		//printf("n = %lld 1<<h = %d\n",n,(1<<h));
		h++;
	}
	//printf("h=%lld\n",h);
	//h++;
	LL i,j = 0; LL count = 0;//,margin=0;	
	while(count<h-2)
	{
		if(dig(n,j)==1){count+=2;}
		else{count+=1;}
		j++;
	}
	i = nextone(n,h-1);
	if(i<0) return h-2;
	if(i<=j) return h-1;
	LL ci = 0,cj = h-1 - count; count  = h-1;
	while(i>j)
	{
		//if(ci<2 && cj< 2) { ci++;cj++;count++; continue;}
		//printf("i = %lld, j = %lld, ci = %lld, cj = %lld\n",i,j,ci,cj);
		ci++;cj++;count++;
		if(dig(n,j)==1 && cj>=2)
		{
			cj-=2;j++;			
		}
		else if(dig(n,j)==0&&cj>=1)
		{
			cj--;j++;
		}
		if(i==j) return count-min(ci,cj);
		if(ci>=1)
		{
			ci-=1; i = nextone(n,i);
		}
		if(i<=j) return count - min(ci,cj);
	}
	return count-min(ci,cj);

}

int main()
{
    LL test;
    SLL(test);
    
    while(test--)
    {
    	LL n;
    	SLL(n);
    	printf("%lld\n",ans(n));
    }
    
    
	return 0;
}



