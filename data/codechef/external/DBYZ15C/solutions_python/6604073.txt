#include<bits/stdc++.h>
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define p(n) printf("%d\n",n)
#define mod 1000000007LL
#define ll long long
#define pb push_back
#define mp make_pair

#define LN 21
using namespace std;
int n;
 void copymatrix(vector<vector<ll> >a,vector<vector<ll> >b,int row,int col)
{
 int i,j;
 for(i=0;i<row;++i)
 for(j=0;j<col;++j)
 a[i][j]=b[i][j];
}
vector<vector<ll> > multiply(vector<vector<ll> >a,vector<vector<ll> >b,int row,int col)
{
    vector<vector<ll> >c;
    int i,j,k;
    for(i=0;i<row;++i)
    {
    vector<ll>v;
    for(j=0;j<col;++j)
    v.pb(0);
    c.pb(v);
    }

    for(i=0;i<row;i++)
    {
        for(j=0;j<col;j++)
        {
           c[i][j]=0;
            for(k=0;k<col;k++)
            {
                c[i][j]=(c[i][j]+a[i][k]*1LL*b[k][j]%mod)%mod;
            }
        }
    }
    return c;
}
vector<vector<ll> > add(vector<vector<ll> >a,vector<vector<ll> >b,int row,int col)
{
    vector<vector<ll> >c;
    int i,j,k;
    for(i=0;i<row;++i)
    {
    vector<ll>v;
    for(j=0;j<col;++j)
    v.pb(0);
    c.pb(v);
    }
    for(i=0;i<row;i++)
    {
        for(j=0;j<col;j++)
        {
            c[i][j]=a[i][j]+b[i][j];
            c[i][j]%=mod;
        }
    }
    return c;
}
vector<vector<ll> > matpow(vector<vector<ll> >a,ll b,int row,int col)
{
     vector<vector<ll> >c;
    int i,j;
    for(i=0;i<row;++i)
    {
    vector<ll>v;
    for(j=0;j<col;++j)
    v.pb(0);
    c.pb(v);
    }
    for(i=0;i<col;i++)
        c[i][i]=1;

    while(b)
    {
        if(b&1)
            c=multiply(c,a,row,col);
        a=multiply(a,a,row,col);
        b/=2;
    }
     return c;
}
vector<vector<ll> > getgp(vector<vector<ll> >po,ll r)
{
 if(r==1)
 return po;
 else if(r%2==0)
 {
   vector<vector<ll> >ans1=getgp(po,r/2);
   vector<vector<ll> >ans2=matpow(po,r/2,n,n);
   vector<vector<ll> >ans3=multiply(ans1,ans2,n,n);
   vector<vector<ll> >fans=add(ans1,ans3,n,n);
   return fans;
 }
 else
 {
   vector<vector<ll> >ans1=getgp(po,r/2);
   vector<vector<ll> >ans2=matpow(po,r/2,n,n);
   vector<vector<ll> >ans3=matpow(po,r/2+1,n,n);
   vector<vector<ll> >ans5=add(ans1,ans3,n,n);
   vector<vector<ll> >ans4=multiply(ans2,ans5,n,n);
   vector<vector<ll> >fans=add(ans1,ans4,n,n);
   return fans;
 }
}
int main()
{
   int m,q,i,j,n1,n2;
   ll k;
   s(n);s(m);sl(k);
   vector<vector<ll> >pom;
   for(i=0;i<n;++i)
   {
    vector<ll>v;
    for(j=0;j<n;++j)
    v.pb(0);
    pom.pb(v);
   }
   for(i=0;i<m;++i)
   {
     s(n1);s(n2);
     n1--;n2--;
     pom[n1][n2]++;
   }
   vector<vector<ll> >ans;
   ans=getgp(pom,k);
   s(q);
   while(q--)
   {
    int a,b;
    s(a);s(b);
    a--;b--;
    printf("%lld\n",ans[a][b]);
   }
    return 0;
}
