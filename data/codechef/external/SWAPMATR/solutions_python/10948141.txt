#include <iostream>

using namespace std;

bool matrix[1001][1001];
int arr[1001][1001];

inline int ones(int x1,int y1, int x2, int y2)
{
  int ctr=arr[x2][y2]-arr[x1][y2]-arr[x2][y1]+arr[x1][y1];
  return ctr;
}

void ones(int n)
{
  for(int x=1;x<=n;++x)
  {
   for( int y=1;y<=n;++y)
   {
    arr[x][y]=arr[x-1][y]+arr[x][y-1]-arr[x-1][y-1];
    if( matrix[x][y] ) arr[x][y]+=1;
   }
  }
}

int main()
{
     int t,n,h,w,area,temp,m;
     cin>>t;
     while(t--)
     {
        cin>>n;

        for(int i=0;i<=n; ++i)
        {
          arr[0][i]=0;
          arr[i][0]=0;
        }

        for(int i=1;i<=n;++i)
        for(int j=1;j<=n;++j)
        cin>>matrix[i][j];

        ones(n);
        area=arr[n][n];
        h=1;
        m=-1;

        if(area==1 || area==0) { cout<< 0 <<endl; continue; }
        while(h<=n)
        {
          if(area%h==0)
          {
           w=area/h;
           if(w<=n)
           for( int i=1; i<=n-h+1; ++i )
           for( int j=1; j<=n-w+1; ++j )
           {
             temp=ones(i-1,j-1,i+h-1,j+w-1);
             if(temp>m) m=temp;
           }
          }
          h++;
        }
        if(m<0) cout<<m<<endl;
        else
        cout<<area-m<<endl;
     }

    return 0;
}
