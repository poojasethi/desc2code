#include<bits/stdc++.h>
using namespace std;
#define pii pair<int,int>
#define mp(x,y) make_pair(x,y)
#define pii2 pair<lli,pii >
const int lim=2e4+5;
vector<pii >g[lim];
int vis1[lim],vis2[lim];
typedef long long int lli;

lli dis[lim];
lli prim(int n,int m);
lli dijkstra(int src);
int main()
{
    //freopen("input.txt","r",stdin);
    //freopen("output.txt","w",stdout);
    int t;
    scanf("%d",&t);
    while(t--)
    {
        int n,m,x,y,z;
        scanf("%d%d",&n,&m);
        for(int i=0;i<m;++i)
        {
            scanf("%d%d%d",&x,&y,&z);
            g[x].push_back(mp(y,z));
            g[y].push_back(mp(x,z));
        }
        lli c=prim(n,m);
        if(c==-1)
        {
            printf("NO\n");
        }
        else
        {
            for(int i=0;i<n+2;++i)
            {
                dis[i]=1e17;
            }
            lli d=dijkstra(0);
            if(c==d)
            {
                printf("YES\n");
            }
            else
            {
                printf("NO\n");
            }
        }
        if(t)
        {
            for(int i=0;i<n+2;++i)
            {
                vis1[i]=vis2[i]=0;
                g[i].clear();
            }
        }

    }



    return 0;
}
lli prim(int n,int m)
{
    priority_queue<pii,vector<pii >,greater<pii> >q;
    vis1[0]=1;int p=0;
    long long int cost=0,temp;
    for(int i=0;i<g[0].size();++i)
    {
        pii x=g[0][i];
        q.push(mp(x.second,x.first));
    }
    while(!q.empty())
    {
        pii x=q.top();
        q.pop();
        if(!vis1[x.second])
        {
            ++p;
            vis1[x.second]=1;
            temp=x.first;
            cost+=temp;
            int u=x.second;
            for(int i=0;i<g[u].size();++i)
            {
                pii v=g[u][i];
                if(!vis1[v.first])
                {
                    q.push(mp(v.second,v.first));
                }
            }
        }
    }
    if(p==(n-1))
    return cost;
    else
    return -1;

}
lli dijkstra(int src)
{
    priority_queue<pii2,vector<pii2 >,greater<pii2 > >q;
    lli cost=0,temp;
    dis[0]=0;
    q.push(mp(dis[0],mp(0,0)));//dis[u],weight of(u,v),vertex no
    while(!q.empty())
    {
        pii2 x=q.top();q.pop();
        int u=x.second.second;
        if(!vis2[u])
        {

            cost+=x.second.first;
            vis2[u]=1;

            for(int i=0;i<g[u].size();++i)
            {
                int v=g[u][i].first;temp=g[u][i].second+dis[u];

                if(!vis2[v]&&temp<=dis[v])
                {
                    dis[v]=temp;
                    q.push(mp(dis[v],mp(g[u][i].second,v)));
                }


            }


        }

    }
    return cost;
}
