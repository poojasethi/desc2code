#include <stdio.h>
#include <iostream>
#include <cmath>
#include <algorithm>
#include <vector>
#include <bits/stdc++.h>        //include every c++ library
                                //fgets(array_name,array_size);
#define limit 1000000007
#define ll long long int
using namespace std;

int main()
{
    bool flag=true;
    while(flag)
    {
        char b[] = "TheEnd",a[200];
        int n,m;
        scanf("%s",a);
        if(strcmp(a,b)!=0)
        {
            scanf("%d %d",&n,&m);
            char B[n][200];
            ll P[n][m],i,j;
            for(i=0;i<n;i++)
            {
                scanf("%s",B[i]);
                for(j=0;j<m;j++)
                {
                    scanf("%lld",&P[i][j]);
                }
            }
            ll minloss=INT_MAX,temp,k,totloss=0,DP[m],tposx=-1,posx[m],posy[m];
            memset(DP,INT_MAX,sizeof(DP));
            memset(posx,0,sizeof(posx));
            memset(posy,-1,sizeof(posy));

            for(i=m-1;i>=0;i--)
            {
                minloss = INT_MAX;
                for(k=0;k<n;k++)
                {
                    if(P[k][i]<minloss)
                    {
                        minloss = P[k][i];
                        posx[i] = k;
                    }
                }
                DP[i] = minloss;
                minloss = INT_MAX;
                for(j=m-1;j>i;j--)
                {
                    minloss = INT_MAX;
                    for(k=0;k<n;k++)
                    {
                        temp = P[k][i] - P[k][j];
                        if(temp < minloss)
                        {
                            minloss = temp;
                            tposx = k;
                        }
                    }
                    temp = DP[j] + minloss + 100;
                    if(temp<DP[i])
                    {
                        DP[i] = temp;
                        posx[i] = tposx;
                        posy[i] = j;
                    }
                }

            }

            printf("%s\n",a);
            printf("Tk %lld\n",DP[0]);
            i=0;
            while(i<m)
            {
                if(posy[i]==-1)
                    posy[i] = m;

                printf("%s for %lld month(s)\n",B[posx[i]],posy[i]-i);
                i = posy[i];
            }
            printf("\n");
        }

        else
            flag = false;
    }
    printf("TheEnd\n");
    return 0;
}
