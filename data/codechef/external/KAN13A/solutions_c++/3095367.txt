#include <cstdio>
#include <cstring>
#include <cmath>
#include <algorithm>
#include <vector>
#include <utility>
#include <set>
#include <map>
#include <iostream>
#include <queue>
#include <climits>

using namespace std;

typedef long long LL;

#define PB push_back
#define FRO freopen("in.txt","r",stdin);

#define CLR(arr) memset( (arr),0,sizeof(arr) );
#define NEG(arr) memset( (arr),-1,sizeof(arr) );

typedef pair<int,int> pint;
typedef map<int,int> mint;

char arr[200];

int dp[210][ 210 ];
int price[ 210 ] [ 210 ];
char name[ 210 ][ 210 ];
int brand,month;

int func( int totake,int have ){

    //cout<<totake<<' '<<have<<endl;

    if ( totake > month )return -100;

    if ( dp[ totake ][ have ] != -1 )return dp[ totake ][ have ];

    int ans = (1<<30);

    if ( totake != 1 ){
        ans= func( totake+1,have );
    }

    for (int i=1;i<=brand;++i){
        ans = min( ans, -price[ have ][totake]+100+price[i][totake]+func( totake+1, i ) );
    }
    return dp[ totake ][ have ]= ans;
}

int ans [210];

void pp( int totake,int have ){
    if ( totake > month  )return ;

    if ( totake != 1 ){
        if ( dp[totake][have] ==  func( totake+1,have ) ){
            ans[ totake ] = have;
            pp( totake+1,have );
            return ;
        }
    }

    for (int i=1;i<=brand;++i){
        if ( dp[totake][have] == -price[ have ][totake]+100+price[i][totake]+func( totake+1, i )  ){
            ans[ totake ] = i;
            pp( totake+1,i );

            return ;
        }
    }
}

int main(){

    //FRO

    while ( scanf("%s",arr) == 1 && strcmp( arr,"TheEnd" )!= 0 ){
        scanf("%d %d",&brand,&month);

        for (int i=1;i<=brand;++i){
            scanf("%s",name[i]);
            for (int j=1;j<=month;++j){
                scanf("%d",&price[i][j]);
                //cout<<price[i][j]<<endl;
            }
        }

        printf("%s\n",arr);
        NEG(dp);
        printf("Tk %d\n",func( 1,0 ));

        pp( 1,0 );

        for ( int i=1;i<=month;++i ){
            //cout<<ans[i]<<endl;

            if ( ans[i] != ans[i-1] ){
                int cnt = 0;
                for (int j=i;j<=month && ans[j] == ans[i] ;++j){
                    cnt++;
                }
                printf("%s for %d month(s)\n",name[ ans[i] ],cnt);
                i+= cnt-1;
            }
        }
        printf("\n");
    }

    printf("TheEnd\n");

    return 0;
}
