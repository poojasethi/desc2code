#include <iostream>
#include <cstring>

using namespace std;

int N = 103, M = 203;

int dp[103][203] = {0};
int prices[103][203] = {0};
int history[103][203] = {0};
char models[103][20];
char* usageHistory[203];

int main()
{
	char testCase[20];
	int n, m, i, j, min = 100000000;
	while(1)
	{
		scanf("%s", testCase);
		if(strcmp(testCase, "TheEnd") == 0)
			break;

		scanf("%d %d", &n, &m);
		for(i=0; i < n; i++)
		{
			scanf("%s", models[i]);
			for(j=0; j < m; j++)
			{
				scanf("%d", &prices[i][j]);
			}
		}

		for(i=0;i<n;i++)
		{
			dp[i][0] = prices[i][0];
			//printf("%d ", dp[i][0]);
		}

		for(j=1;j<m;j++)
		{
			for(i=0;i<n;i++)
			{
				dp[i][j] = dp[i][j-1];
				history[i][j] = i;
				for(int k=0;k<n;k++)
				{
					int c = dp[k][j-1] + prices[i][j] - (prices[k][j]-100);
					//printf("c: %d\n",c);
					if (dp[i][j]  > c)
					{
						dp[i][j]  = c;
						history[i][j] = k;
					}
				}
			}
		}

		int totalCost = 100000000;
		int model = -1;
		for(i=0;i<n;i++)
		{
			if(totalCost > dp[i][m-1])
			{
				totalCost = dp[i][m-1];
				model = i;
			}
		}
		printf("%s\n", testCase);
		printf("Tk %d\n", totalCost);
		
		for(j=m-1;j>=0;j--)
		{
			usageHistory[j] = models[model];
			model = history[model][j];
		}

		char* prevModel = usageHistory[0];
		int count = 0;
		for(j=0;j<m;j++)
		{
			//printf("%s\n", usageHistory[j]);
			
			if(usageHistory[j] == prevModel)
				count++;
			else
			{
				printf("%s for %d month(s)\n", prevModel, count);
				prevModel = usageHistory[j];
				count = 1;
			}
			
		}

		printf("%s for %d month(s)\n", prevModel, count);
		printf("\n");
	}
	printf("TheEnd\n");

}