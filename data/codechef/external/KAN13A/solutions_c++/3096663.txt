#include <iostream>
#include<string>
#include<vector>
#include<algorithm>
#include<cstring>
using namespace std;
string s;
string t[105];
int a[105][205],dp[105][205][2],month[205];
int n,m;
using namespace std;
/*int f(int b,int d)
{
	if(d==m+1) return 0;
	if(dp[b][d][0]>-1) return dp[b][d][0];
	int ret =1000000000,brand=b,temp;
	if(b) ret=f(b,d+1);
	for(int i=1;i<=n;i++)
	{
		if(i==b) continue;
		temp = -a[b][d] + 100 + a[i][d] + f(i,d+1);
		if(ret > temp)
		{
			ret = temp;
			brand = i;
		}
	}
	dp[b][d][1]=brand;
	//cout<<b<<" "<<d<<" "<<ret<<" "<<brand<<endl;
	return dp[b][d][0] = ret;
}*/
void g()
{
	int ret,brand,temp,i,j,k;
	for(i=0;i<=n;i++)
	{
		dp[i][m+1][0]=0;
	}
	for(int i=m;i>=1;i--)
	{
		for(int j=1;j<=n;j++)
		{
			ret = dp[j][i+1][0],brand = j;
			for(int k=1;k<=n;k++)
			{
				if(k==j) continue;
				temp = -a[j][i] + 100 + a[k][i] + dp[k][i+1][0];
				if(ret > temp)
				{
					ret = temp;
					brand = k;
				}
				dp[j][i][1]=brand;
				dp[j][i][0]=ret;
			}
		}
	}
	ret =1000000000,brand = -1;
	i=1;j=0;
	for(int k=1;k<=n;k++)
	{
		temp =  a[k][i] + dp[k][i+1][0];
		if(ret > temp)
		{
			ret = temp;
			brand = k;
		}
		dp[j][i][1]=brand;
		dp[j][i][0]=ret;
	}
}
int main(int argc, char *argv[]) {
	ios_base::sync_with_stdio(0);
	while(1)
	{
		cin >> s;
		if(s=="TheEnd") break;
		cin >> n >> m;
		for(int i=1;i<=n;i++)
		{
			cin >> t[i];
			for(int j=1;j<=m;j++)
			{
				cin >> a[i][j];
			}
		}
		int ret = 1000000000,brand,temp;
		cout<< s <<"\n";
		g();
		temp = dp[0][1][0];
		cout<<"Tk "<<temp<<"\n";
		int mon=1;
		brand = dp[0][1][1];
		for(int i=2;i<=m;i++)
		{
			if(brand == dp[brand][i][1]) mon++;
			else {
				cout<<t[brand]<<" for "<<mon<<" month(s)\n";
				mon=1;
				brand = dp[brand][i][1];
			}
		}
		cout<<t[brand]<<" for "<<mon<<" month(s)\n\n";
	}
	cout<<"TheEnd\n";
	return 0;
}