#include <stdio.h>
#include <iostream>
#include <algorithm>
#include <utility>


using namespace std;

pair<int,int> dp[105][205];
int n,m;
int cost[105][205];
string str,name[105];


pair<int,int> f(int x,int y)
{
    if(dp[x][y].first!=-1) return dp[x][y];
    if(y==m)    return dp[x][y]=make_pair(0,0);

    int i,j,k,r,p;

    r=f(x,y+1).first;
    p=0;

    for(i=1;i<=n;i++)
    {
        if(i==x) continue;
        k=cost[i][y+1]-cost[x][y+1]+100;

        if(k+f(i,y+1).first<r)
        {
            r=k+f(i,y+1).first;
            p=i;
        }
    }

    return dp[x][y]=make_pair(r,p);

}


int main()
{
    int i,j,k,ret,c,p,q;
    pair<int,int> pq;

   // freopen("Harddisk.in","r",stdin);
   // freopen("ans.txt","w",stdout);

    while(cin>>str)
    {
        if(str=="TheEnd") break;

        cout<<str<<endl;

        scanf("%d %d",&n,&m);

        for(i=1;i<=n;i++)
        {
            cin>>name[i];

            for(j=1;j<=m;j++)
            {
                scanf("%d",&cost[i][j]);
                dp[i][j].first=-1;
            }
        }

        ret=cost[1][1]+f(1,1).first;
        k=1;

        for(i=2;i<=n;i++)
        {
            j=cost[i][1]+f(i,1).first;

            if(j<ret)
            {
                ret=j;
                k=i;
            }
        }

        printf("Tk %d\n",ret);

        c=0;

        for(i=1;i<=m;i++)
        {
            pq=f(k,i);

            c++;
            if(pq.second==0)    continue;


            else
            {
                cout<<name[k]<<" ";
                printf("for %d month(s)\n",c);

                c=0;
                k=pq.second;

            }

        }

        cout<<name[k]<<" ";
        printf("for %d month(s)\n\n",c);
    }

    cout<<str<<endl;

    return 0;

}
