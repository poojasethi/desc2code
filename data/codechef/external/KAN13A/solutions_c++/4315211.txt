#include<iostream>
#include<cstdio>
#include<string>
#include<vector>
using namespace std;
main()
{
    int i,j,k,t,n,m,p,id,cnt,mn;
    string Set;
    while(1)
    {
        cin>>Set;
        if(Set=="TheEnd") break;

        scanf("%d %d",&n,&m);
        int a[n+1][m+1],cost[n+1][m+1],prev[n+1][m+1];
        string s[n+1];
        vector<int> v;

        for(i=1;i<=n;i++)
        {
            cin>>s[i];
            for(j=1;j<=m;j++)
            {
                cin>>a[i][j];
            }
        }

     for(i=1;i<=n;i++) cost[i][1]=a[i][1];

     for(j=2;j<=m;j++)
        for(i=1;i<=n;i++)
        {
            cost[i][j]=100000000;
        for(k=1;k<=n;k++)
     {
         if(i==k)
         {
             if(cost[i][j-1]<cost[i][j])
             {
                 cost[i][j]=cost[i][j-1];
                 prev[i][j]=i;
             }
         }
         else
         {
             if(cost[k][j-1]+a[i][j]+100-a[k][j]<cost[i][j])
             {
                 cost[i][j]=cost[k][j-1]+a[i][j]+100-a[k][j];
                 prev[i][j]=k;
             }
         }
     }
        }


        mn=100000000;

        for(i=1;i<=n;i++)
        {
            if(mn>cost[i][m])
            {
                mn=cost[i][m];
                id=i;
            }
        }

        v.push_back(id);
        for(i=m;i>=2;i--)
        {
            id=prev[id][i];
            v.push_back(id);
        }
        cout<<Set<<endl;
        cout<<"Tk "<<cost[v[0]][m]<<endl;

        for(i=v.size()-1;i>=0;i--)
        {
            p=v[i];
            cnt=1;
            while(p==v[i-1]&&i>=1)
            {
                cnt++;
                i--;
            }
            cout<<s[p]<<" "<<"for"<<" "<<cnt<<" month(s)"<<endl;
        }

         cout<<endl;
    }
    cout<<"TheEnd";
}
