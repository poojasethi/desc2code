#include<iostream>
#include<cstdio>
#include<vector>
#include<cstring>
#include<list>
using namespace std;
 
 
 
int main()
{
    char name[110][20];
    string str;
    int i,j,a[110][210],dp[110][210],prev[110][210];
    int n,m,k,next[200];
    for(int t=1;;++t)
    {
        //scanf("%s",&str);
        //if(t>1) getchar();
        //getline(cin,str);
        cin>>str;
        if(str=="TheEnd") break;
        scanf("%d %d",&n,&m);
        for(i=0;i<n;++i)
        {
            scanf("%s",&name[i]);
            for(j=0;j<m;++j)
                    scanf("%d",&a[i][j]);
        }
        for(i=0;i<n;++i)
        {
            dp[i][0]=a[i][0];
            prev[i][0]=-1;
        }
        for(j=1;j<m;++j)
        {
            int min=dp[0][j-1]-a[0][j]+100;
            int cur_m=0;
            for(i=1;i<n;++i)
            {
                if((dp[i][j-1]-(a[i][j]-100))<min)
                {
                    min=(dp[i][j-1]-(a[i][j]-100));
                    cur_m=i;
                }
            }
           // cout<<"min for : "<<j<<"is "<<min<<endl;
            for(i=0;i<n;++i)
            {
                if(dp[i][j-1]<min+a[i][j])
                {
                    dp[i][j]=dp[i][j-1];
                    prev[i][j]=i;
                }
                else
                {
                    dp[i][j]=min+a[i][j];
                    prev[i][j]=cur_m;
                }
            }
 
        }
        /*for(i=0;i<n;++i)
        {
            for(j=0;j<m;++j)
                cout<<dp[i][j]<<" ";
            cout<<endl;
        }*/
        int res=0;
        for(i=1;i<n;++i)
            if(dp[i][m-1]<dp[res][m-1])
                res=i;
        cout<<str<<endl;
        printf("Tk %d\n",dp[res][m-1]);
        int curr=prev[res][m-1];
        next[m-1]=res;
        for(j=m-2;j>=0;--j)
        {
            next[j]=curr;
            curr=prev[curr][j];
        }
        curr=next[0];
        int curr_count=1;
        for(j=1;j<m;++j)
        {
              if(next[j]!=curr)
              {
                  //cout<<"j: "<<j<<" next[j]: "<<next[j]<<" curr: "<<curr;
                  printf("%s for %d month(s)\n",name[curr],curr_count);
                  curr=next[j];
                  curr_count=1;
              }
              else ++curr_count;
        }
        printf("%s for %d month(s)\n\n",name[curr],curr_count);
    }
    printf("TheEnd");
}
 