#include<iostream>
#include<vector>
#include<string>
#include<cstring>
#include<algorithm>
using namespace std;
string s[205];
int dp[205][205];
int a[205][205];
int tr[205][205];
vector<string> v;
void f(int n,int ind)
{
     if(n<0)return;
     v.push_back(s[ind]);
     f(n-1,tr[n][ind]);
}
     
int main()
{
          string ss;
          while(1){
                   cin>>ss;
                   if(ss=="TheEnd")break;
                   cout<<ss<<endl;
                  int n,m,i,j,k;   
                  cin>>n>>m;
                  //vector<string> v;
        
                  for(i=0;i<n;i++){
                                   cin>>s[i];
                                   for(j=0;j<m;j++)cin>>a[i][j],dp[j][i]=99999999;
                  }
        
                  
                 int mnm=99999999;
                 int ind;
                  
                  for(i=0;i<n;i++)dp[0][i]=a[i][0];
                  for(i=1;i<m;i++){
                                  for(j=0;j<n;j++){
                                                  for(k=0;k<n;k++){
                                                                  if(j==k){
                                                                           if(dp[i-1][k]<dp[i][k]){
                                                                                                  dp[i][k]=dp[i-1][k];
                                                                                                  tr[i][k]=k;
                                                                           }
                                                                  } else {
                                                                          if((dp[i-1][j]-a[j][i]+100+a[k][i])<dp[i][k]){
                                                                                                         dp[i][k]=dp[i-1][j]-a[j][i]+100+a[k][i];
                                                                                                         tr[i][k]=j;
                                                                          }
                                                                  }
                                                                  //cout<<i<<" "<<j<<" "<<k<<" "<<dp[i-1][j]<<" "<<dp[i][k]<<" "<<dp[i-1][j]-a[j][i]+100+a[k][i]<<endl;
                                                  }               
                                 }
                 }
        
                 int ans=99999999;
                 for(i=0;i<n;i++){
                                  if(dp[m-1][i]<ans){
                                                     ans=dp[m-1][i];
                                                     ind=i;
                                  }
                 }
                 cout<<"Tk "<<ans<<endl; 
                 f(m-1,ind);
                 reverse(v.begin(),v.end());
                 int cnt=1;
                 for(i=1;i<v.size();i++){
                                         if(v[i]!=v[i-1]){
                                                          cout<<v[i-1]<<" for "<<cnt<<" month(s)"<<endl;
                                                          cnt=1;
                                         } else cnt++;
                 }
                 cout<<v[i-1]<<" for "<<cnt<<" month(s)"<<endl;
                 v.clear();
                 memset(dp,0,sizeof(dp)), memset(a,0,sizeof(a)), memset(tr,0,sizeof(tr));
                 cout<<endl;
         }
         cout<<"TheEnd\n";
         //system("pause");
}
