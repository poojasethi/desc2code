#include<cstdio>
#include<iostream>
#include<cstring>
using namespace std;
long int dp[101][201];
long int dp1[101][201];
char inp[101][25]; 
int a[101][201];
int n,m;
long int ret(int i,int j){
//	printf("%d %d\n",i,j);
	if(j==m){
		return 0;
	}
	if(dp[i][j]==-1){
		int k;
		int ind;
		long int minn=ret(i,j+1);
		ind=i;
		long int y;
		for(k=0;k<n;k++){
			if(k!=i){
				y=ret(k,j+1)+a[k][j]-(a[i][j]-100);
				if(y<minn){
					minn=y;
					ind=k;
				}
			}
		}
		dp[i][j]=minn;
		dp1[i][j]=ind;
	}
	return dp[i][j];
}
int main(){
	char s[100];
	while(1){
		scanf("%s",s);
		if(strcmp(s,"TheEnd")==0){
			break;
		}
		cin >> n >> m;
		int i,j;
		//cout << n << m << endl;
		for(i=0;i<n;i++){
			scanf("%s",inp[i]);
			for(j=0;j<m;j++){
				scanf("%d",&a[i][j]);
				dp[i][j]=-1;
			}
		}
/*		for(i=0;i<n;i++){
			for(j=0;j<m;j++){
				printf("%d ",a[i][j]);
			}
			printf("\n");
		}*/
		long int minn=a[0][0]+ret(0,1);
		long int y;
		int out[m];
		int ind=0;
		for(i=1;i<n;i++){
			y=a[i][0]+ret(i,1);
			if(y<minn){
				minn=y;
				ind=i;
			}
		}
		int k;
		k=0;
		out[k]=ind;
		k++;
		ind=dp1[ind][k];
		while(k<m){
			out[k]=ind;
			k++;
			ind=dp1[ind][k];
		}
/*		for(i=0;i<m;i++){
			printf("%d ",out[i]);
		}
		printf("\n");*/
		printf("%s\n",s);
		cout << "Tk "<< minn << endl;
		i=0;
		int c=0;
		while(i<m-1){
			c=1;
			while(1){
				if(i>=m-1){
					break;
				}
				if(out[i]==out[i+1]){
					i++;
					c++;
				}
				else{
				break;
				}
			}
			printf("%s for %d month(s)\n",inp[out[i]],c);
			i++;
		}
		if(out[m-1]!=out[m-2]){
			printf("%s for 1 month(s)\n",inp[out[m-1]]);
		}
		cout << endl;
	}
	printf("TheEnd\n");
	return 0;
}
