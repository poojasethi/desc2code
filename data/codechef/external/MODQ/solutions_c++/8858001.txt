#include<bits/stdc++.h>
using namespace std;

#define sd(a) scanf("%d",&a)
#define ss(a) scanf("%s",&a)
#define sl(a) scanf("%lld",&a)
#define clr(a) memset(a,0,sizeof(a))
#define debug(a) printf("check%d\n",a)
#define rep(i)
#define F first
#define S second
#define MP make_pair
#define PB push_back
#define ll long long
#define M 10000

int ans[110][10010];
int diff[110][10010];
int diff1[110][10010];
int a[10010];
int pre[10010];

int main()
{
	//freopen("in.txt","r",stdin);
	//freopen("out.txt","w",stdout);

	int t,n,m,s,i,j,mod;
	sd(t);
	while(t--)
	{
		sd(n);
		s=sqrt(n);
		for(i=0;i*s<n;++i)
			for(j=0;j<10010;++j)
				ans[i][j]=diff[i][j]=diff1[i][j]=0;
		for(i=0;i<n;++i)
		{
			int minn=100000;
			sd(a[i]);
			pre[i]=a[i];
			if(i)
				pre[i]+=pre[i-1];
			
			diff1[i/s][a[i]+1]+=a[i];
			diff1[i/s][a[i]+2]-=a[i];

			diff1[i/s][M+1]-=a[i];
			diff1[i/s][M+2]+=a[i];

			for(j=1;j*j<=a[i];++j)
			{
				int l=a[i]/(j+1)+1;
				int r=a[i]/j;
				int A=a[i]%l;
				minn=min(minn,l);
				
				diff1[i/s][l]+=A;
				diff1[i/s][l+1]-=A;
				
				diff1[i/s][l+1]-=j;
				diff1[i/s][r+1]+=j;

				diff1[i/s][r+1]-=(A-(r-l)*j);
				diff1[i/s][r+2]+=(A-(r-l)*j);

			}
			
			for(j=1;j*j<a[i]&&j<minn;++j)
			{
				diff1[i/s][j  ]+=(a[i]%j);
				diff1[i/s][j+1]-=(a[i]%j);
				diff1[i/s][j+1]-=(a[i]%j);
				diff1[i/s][j+2]+=(a[i]%j);
			}
		}
		
		for(i=0;i*s<n;++i)
		{
			diff[i][0]=diff1[i][0];
			for(j=1;j<10010;++j)
				diff[i][j]=diff[i][j-1]+diff1[i][j];
			ans[i][0]=diff[i][0];
			for(j=1;j<10010;++j)
				ans[i][j]=ans[i][j-1]+diff[i][j];
		}
		sd(m);
		while(m--)
		{
			int l,r;
			sd(l);sd(r);sd(mod);
			--l;--r;
			if(mod>M)
			{
				int ans=pre[r];
				if(l)
					ans-=pre[l-1];
				printf("%d\n",ans);
				return 0;
			}
			int out=0;
			int sl=l/s+1,sr=r/s-1;
			if(l%s==0)
				sl--;
			if((r+1)%s==0)
				sr++;
			if(sl>sr)
			{
				for(i=l;i<=r;++i)
					out=out+a[i]%mod;
			}
			else
			{
				for(i=l;i<sl*s;++i)
					out=out+a[i]%mod;
				for(i=(sr+1)*s;i<=r;++i)
					out=out+a[i]%mod;
				for(i=sl;i<=sr;++i)
					out+=ans[i][mod];
			}
			printf("%d\n",out);
		}
	}
	//for(i=0;i*s<n;++i)
	//	cout<<ans[i][9]<<'\n';
}
