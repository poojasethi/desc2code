#include<bits/stdc++.h>
using namespace std;
int prime[100050];
int pr[100050];
void pre()
{
	int i,j;
	prime[0]=1;
	prime[1]=1;
	for(i=2;i<=100049;i++)
	{
		if(!prime[i])
		{
			for(j=2*i;j<=100049;j+=i)
			prime[j]=1;
		}
	}
	int cc;
	for(i=100048;i>=0;i--)
	{
		if(prime[i]==0)
		{
			pr[i]=i;
			cc=i;
		}
		else
		{
			pr[i]=cc;
		}
		//cout<< pr[i] << "  "
	}
}
int a[1005][1005];
int main()
{
	pre();
	int n,m;
	scanf("%d %d",&n,&m);
	int i,j;
	for(i=0;i<n;i++)
	{
		for(j=0;j<m;j++)
		scanf("%d",&a[i][j]);
	}
	long long int mini=1e15;
	for(i=0;i<n;i++)
	{
		long long int co=0;
		for(j=0;j<m;j++)
		{
			if(prime[a[i][j]]==1)
			{
			    //cout<<pr[a[i][j]]<<endl;
				co+=pr[a[i][j]]-a[i][j];
			}
		}
	//	printf("%d ",co);
		mini=min(mini,co);
	}
	//printf("\n");
	for(i=0;i<m;i++)
	{
		long long int co=0;
		for(j=0;j<n;j++)
		{
			if(prime[a[j][i]]==1)
			{
				co+=pr[a[j][i]]-a[j][i];
			}
		}
	//	printf("%d ",co);
		mini=min(mini,co);
	}
	//printf("\n");
	printf("%lld\n",mini);
	return 0;
}
