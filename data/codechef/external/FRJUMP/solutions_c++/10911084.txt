    #include<bits/stdc++.h>
    using namespace std;
    const long long int mo= 1000000007;
    long long r[100001]={}, a[1000001]={}, d[100001]={};
    long double b[100001]={}, fl;
    long long power(long long a, long long b){
    	long long f=a, ans= 1;
    	while(b){
    		if(b&1){
    			ans=ans*f;
    			ans=ans%mo;
    		}
    		f=f*f;
    		f=f%mo;
    		b=b>>1;
    	}
    	return ans%mo;
    }
    long long inv(long long a){
    	return power(a, mo-2);
    }
    int main(){
    	long long i, j, k, f, p, q, n, m, z, w;
    	scanf("%lld", &n);
    	for(i=0; i<n; i++){
    		scanf("%lld", &a[i]);
    	}

    	for(i=1; i<n; i++){
    		r[i]=1;
    		for(j=i; j<n; j+=i){
    			r[i]*=a[j];
    			b[i]+=log10(a[j]);
    			r[i]%=mo;
    		}
    		//cout<<r[i]<<" ";
    	}
    	scanf("%lld", &q);
    	while(q--){
    		scanf("%lld", &w);
    		if(w==1){
    			//cin>>p>>f;
    			scanf("%lld %lld", &p, &f);
    			p--;
    			z=sqrt(p);
    			long long gh=inv(a[p]);
    		//	if(p==0)z=sqrt(n-1);
    			for(i=1; i<=z; i++){
    				if(p%i==0){
    				//	cout<<"hi";
    					r[i]*=gh;
    					b[i]-=log10(a[p]);
    					r[i]=r[i]%mo;
    					r[i]*=f;
    					b[i]+=log10(f);
    					r[i]=r[i]%mo;
    					if(p/i!=i){
    						r[p/i]*=gh;
    						b[p/i]-=log10(a[p]);
    						r[p/i]=r[p/i]%mo;
    						r[p/i]*=f;
    						b[p/i]+=log10(f);
    						r[p/i]=r[p/i]%mo;
    					}
    				}
    			}
    			a[p]=f;
    		}
    		else{
    			//cin>>i;
    			scanf("%lld", &i);
    			fl=(log10(a[0])+b[i])-(floor)(log10(a[0])+b[i]);
    			p=pow(10, fl);
    			if(n<=10)p=a[0]*r[i];
    			while(p>9){
    				p/=10;
    			}
    			//cout<<p<<" "<<(a[0]*r[i])%mo<<endl;
    			printf("%lld %lld\n", p, (a[0]*r[i])%mo);
    		}
    	}
    } 