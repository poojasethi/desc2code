#include <bits/stdc++.h>
#define MOD 1000000007
#define ll long long int
#define MAX(a,b) (((a)>(b))?(a):(b))
#define MIN(a,b) (((a)<(b))?(a):(b))
#define rf(i, x, y) for (int i = (x); i < (y); i++)
#define rfe(i, x, y) for (int i = (x); i <= (y); i++)
#define rb(i, x, y) for (int i = (x); i > (y); i--)
#define rbe(i, x, y) for (int i = (x); i >= (y); i--)
#define sfi(x) scanf("%d", &x)
#define pfi(x) printf("%d", x)
#define sfll(x) scanf("%lld", &x)
#define pfll(x) printf("%lld", x)
#define sfs(x) scanf("%s", x)
#define pfs(x) printf("%s", x)
#define le printf("\n")

#define SIZE 1005
using namespace std;

int ltr[SIZE][SIZE];
int rtl[SIZE][SIZE];
int ttb[SIZE][SIZE];
int btt[SIZE][SIZE];
int in[SIZE][SIZE];

void print_mtrx(int mno, int m, int n) {
  switch(mno){
    case 0:
    pfs("LTR\n");
    rfe(i,1,n){
      rfe(j,1,m)
        cout<<ltr[i][j]<<" ";
        le;
      }
      break;
    case 1:
    pfs("RTL\n");
    rfe(i,1,n){
      rfe(j,1,m)
        cout<<rtl[i][j]<<" ";
        le;
      }
      break;
    case 2:
    pfs("TTB\n");
    rfe(i,1,n){
      rfe(j,1,m)
        cout<<ttb[i][j]<<" ";
        le;
      }
      break;
    case 3:
    pfs("BTT\n");
    rfe(i,1,n){
      rfe(j,1,m)
        cout<<btt[i][j]<<" ";
        le;
      }
      break;
  }
}

int main() {

    int t,n,m, bt, rl;
    ll ans;

    sfi(t);
    while(t--) {
      sfi(n);
      sfi(m);
      rfe(i,1,n)
        ltr[i][0] = rtl[i][m+1] = 0;
      rfe(i,1,m)
        ttb[0][i] = btt[n+1][i] = 0;

      rfe(i,1,n)
        rfe(j,1,m)
          sfi(in[i][j]);
      rfe(i,1,n)
        rfe(j,1,m){
            ltr[i][j] = MIN(ltr[i][j-1]+in[i][j], in[i][j]);
            ttb[i][j] = MIN(ttb[i-1][j]+in[i][j], in[i][j]);
            rl = m+1-j;
            rtl[i][rl] = MIN(rtl[i][rl+1]+in[i][rl], in[i][rl]);
            bt = n+1-i;
            btt[bt][j] = MIN(btt[bt+1][j]+in[bt][j], in[bt][j]);
        }

   ans = LONG_LONG_MAX;
      rfe(i,1,n)
          rfe(j,1,m)
             ans = MIN(ans, ltr[i][j]+rtl[i][j]+ttb[i][j]+btt[i][j]-3*in[i][j]);
      pfll(ans);
      le;
    }
    return 0;
}
