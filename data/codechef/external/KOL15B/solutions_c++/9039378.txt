#include <bits/stdc++.h>
#define lli long long int
#define s(x) scanf("%lld", &x)
#define MAXX 1005

using namespace std;

lli arr[MAXX][MAXX], lft[MAXX][MAXX], rgt[MAXX][MAXX], up[MAXX][MAXX], dwn[MAXX][MAXX];

int main()
{
    lli i,j,k,ans,tcase,n,m,csum,zz,mini;

    s(tcase);

    while (tcase--) {
        s(n);
        s(m);

        for (i = 1; i <= n; ++i) {
            for (j = 1; j <= m; ++j) {
                s(arr[i][j]);
            }
        }

        for (i = 1; i <= n; ++i) {
            csum = 0;
            for (j = 1; j <= m; ++j) {
                lft[i][j] = csum;

                csum += arr[i][j];

                if (csum > 0)
                    csum = 0;
            }
        }


        for (i = 1; i <= n; ++i) {
            csum = 0;
            for (j = m; j >= 1; --j) {
                rgt[i][j] = csum;

                csum += arr[i][j];

                if (csum > 0)
                    csum = 0;
            }
        }

        for (j = 1; j <= m; ++j) {
            csum = 0;
            for (i = 1; i <= n; ++i) {
                up[i][j] = csum;

                csum += arr[i][j];

                if (csum > 0)
                    csum = 0;
            }
        }

        for (j = 1; j <= m; ++j) {
            csum = 0;
            for (i = n; i >= 1; --i) {
                dwn[i][j] = csum;

                csum += arr[i][j];

                if (csum > 0)
                    csum = 0;
            }
        }

        zz = 0;

        for (i = 1; i <= n; ++i) {
            for (j = 1; j <= m; ++j) {
                ans = up[i][j] + dwn[i][j] + lft[i][j] + rgt[i][j] + arr[i][j];

                if (zz == 0) {
                    mini = ans;
                    zz = 1;
                } else if (ans < mini) {
                    mini = ans;
                }
            }
        }

        printf("%lld\n", mini);
    }


    return 0;
}
