#include<bits/stdc++.h>
using namespace std;
#define MAXN 1005
int west[MAXN][MAXN],east[MAXN][MAXN],north[MAXN][MAXN],south[MAXN][MAXN],cost[MAXN][MAXN];
int main()
{
	int t; cin>>t;
	while(t--)
	{
		int n,m; cin>>n>>m;
		for(int i=1;i<=n;i++)
		    for(int j=1;j<=m;j++)
		        cin>>cost[i][j];
	    for(int i=1;i<=n;i++)
	    {
	    	for(int j=1;j<=m;j++)
	    	{
	    		if(j==1)
	    		  west[i][j]=cost[i][j];
	    		else
	    		  west[i][j]=min(cost[i][j],cost[i][j]+west[i][j-1]);
	    		  
			}
		}
		for(int i=1;i<=n;i++)
		{
			for(int j=m;j>=1;j--)
			{
				if(j==m)
				  east[i][j]=cost[i][j];
				else
				  east[i][j]=min(cost[i][j],cost[i][j]+east[i][j+1]);
			}
		}
		for(int j=1;j<=m;j++)
		{
			for(int i=1;i<=n;i++)
			{
				if(i==1)
				  north[i][j]=cost[i][j];
				else
				  north[i][j]=min(cost[i][j],cost[i][j]+north[i-1][j]);
			}
		}
		for(int j=1;j<=m;j++)
		{
			for(int i=n;i>=1;i--)
			{
				if(i==n)
				  south[i][j]=cost[i][j];
				else
				  south[i][j]=min(cost[i][j],cost[i][j]+south[i+1][j]);
			}
		}
		int ans=INT_MAX;
		for(int i=1;i<=n;i++)
		{
			for(int j=1;j<=m;j++)
			{
				ans=min(ans,west[i][j]+east[i][j]+north[i][j]+south[i][j]-3*cost[i][j]);
			}
		}
		cout<<ans<<endl;
	}
	return 0;
}