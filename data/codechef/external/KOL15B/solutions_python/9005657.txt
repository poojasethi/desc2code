#include<bits/stdc++.h>
using namespace std;

int i,j,n,m,t,a[1005][1005],dp1[1005][1005],dp2[1005][1005],dp3[1005][3005],dp4[1005][1005],rs;

int main()
{
  ios_base::sync_with_stdio(0); cin.tie(0);

  for(cin>>t;t;--t)
  {
    cin>>n>>m;
    for(i=1;i<=n;++i)
     for(j=1;j<=m;++j)
     {
       cin>>a[i][j];
       dp1[i][j]=dp1[i][j+1]=dp1[i+1][j]=0;
       dp2[i][j]=dp2[i][j+1]=dp2[i+1][j]=0;
       dp3[i][j]=dp3[i][j+1]=dp3[i+1][j]=0;
       dp4[i][j]=dp4[i][j+1]=dp4[i+1][j]=0;
     }

    for(i=1;i<=n;++i)
     for(j=1;j<=m;++j)
     {
       dp1[i][j]=a[i][j]+min(0,dp1[i-1][j]);
       dp2[i][j]=a[i][j]+min(0,dp2[i][j-1]);
     }

    for(i=n;i;--i)
     for(j=m;j;--j)
     {
       dp3[i][j]=a[i][j]+min(0,dp3[i+1][j]);
       dp4[i][j]=a[i][j]+min(0,dp4[i][j+1]);
     }

    for(i=1,rs=2e9;i<=n;++i)
     for(j=1;j<=m;++j)
     rs=min(rs,dp1[i][j]+dp2[i][j]+dp3[i][j]+dp4[i][j]-3*a[i][j]);

    cout<<rs<<'\n';
  }

 return 0;
}