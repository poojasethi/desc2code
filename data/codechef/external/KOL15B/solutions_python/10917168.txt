#include <bits/stdc++.h>
using namespace std;
#define gc getchar_unlocked
void scanint(int &x)
{
    register int c = gc();
    x = 0;
    int neg = 0;
    for(;((c<48 || c>57) && c != '-');c = gc());
    if(c=='-') {neg=1;c=gc();}
    for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
    if(neg) x=-x;
}

int a[1001][1001],b[1001][1001],c[1001][1001],sumrow[1001][1001],sumcol[1001][1001];
int main() {
    //std::ios::sync_with_stdio(false);
	int t,n,m,i,j;
	scanint(t);
	while(t--)
	{
	   scanint(n);
	   scanint(m);
	    for(i=0;i<=m;i++){
	       sumcol[0][i]=0;
	        b[0][i]=0;
	        c[0][i]=0;
	        sumrow[0][i]=0;
	        sumcol[n+1][i]=0;
	        
	    }
	    for(i=0;i<=n;i++){
	              sumrow[i][0]=0;
	        sumcol[i][0]=0;
	             sumrow[i][m+1]=0;
	   
	        b[i][0]=0;
	        c[i][0]=0;
	        
	    }
	    
	    for(i=1;i<=n;i++)
	    {
	        for(j=1;j<=m;j++)
	        {
	           scanint(a[i][j]);
	           sumcol[i][j]=0;
	             sumrow[i][j]=0;
	   
	        b[i][j]=0;
	        c[i][j]=0;
	        }
	    }
	    
	    for(i=1;i<=n;i++)
	    {
	        for(j=1;j<=m;j++)
	        {
	            b[i][j]=min(a[i][j],b[i-1][j]+a[i][j]);
	            c[i][j]=min(a[i][j],c[i][j-1]+a[i][j]);
	        }
	    }
	    
	    for(i=n;i>=1;i--)
	    {
	        for(j=m;j>=1;j--)
	        {
	            sumrow[i][j]=min(a[i][j],sumrow[i][j+1]+a[i][j]);
	            sumcol[i][j]=min(a[i][j],sumcol[i+1][j]+a[i][j]);
	        }
	    }
	    int ANS=1e09;
	    
	    for(i=1;i<=n;i++)
	    {
	        for(j=1;j<=m;j++)
	        {
	            
	            ANS=min(ANS,b[i][j]+c[i][j]+sumrow[i][j]+sumcol[i][j]-(3*a[i][j]));
	           
	        }
	    }
	    cout<<ANS<<"\n";
	   
	}
	// your code goes here
	return 0;
}