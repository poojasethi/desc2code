#include<bits/stdc++.h>
#define M 1000000007
using namespace std;
 
#define MAXN 1005
#define rep(i,a,b) for(i=a;i<b;i++)
#define f0(i,m) for(i=0;i<m;i++)
#define ll long long
#define INF 1000000010
long long a[MAXN][MAXN],L[MAXN][MAXN],R[MAXN][MAXN],Up[MAXN][MAXN],Dn[MAXN][MAXN];
int main()
{
	ios::sync_with_stdio(false); cin.tie(0);
	int n,m,k,i,j;
	ll temp1,temp2;
	int t;
	cin>>t;
	while(t--)
	{
		cin>>n>>m;
		f0(i,n)
			f0(j,m)
				cin>>a[i+1][j+1];
		f0(i,n+2)
        	f0(j,m+2)
        		L[i][j]=Up[i][j]=Dn[i][j]=R[i][j]=INF;
		ll ans=INF;
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
			{
				L[i][j]=min(a[i][j],L[i-1][j]+a[i][j]);
				Up[i][j]=min(a[i][j],Up[i][j-1]+a[i][j]);
			}
		}
		for(i=n;i>=1;i--)
		{
			for(j=m;j>=1;j--)
			{
				R[i][j]=min(a[i][j],R[i+1][j]+a[i][j]);
				Dn[i][j]=min(a[i][j],Dn[i][j+1]+a[i][j]);
			}
		}
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
			{
				ans=min(ans,L[i][j]+R[i][j]+Up[i][j]+Dn[i][j]-3*a[i][j]);
			}
		}
		cout<<ans<<endl;
	}
	return 0;
}