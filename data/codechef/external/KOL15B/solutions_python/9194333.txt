#include<bits/stdc++.h>
#define fr(i,a,b) for(i=a;i<b;i++)
#define frn(i,a,b) for(i=a;i>=b;i--)
#define ll long long
using namespace std;
int a[1001][1001],north[1001][1001],south[1001][1001],east[1001][1001],west[1001][1001];
int main()
{
    int t;
    cin >> t;
    while(t--)
    {
        int n,m;
        cin >> n >> m;
        int i,j;
        fr(i,0,n)
        {
            fr(j,0,m)
            {
                cin >> a[i][j];
            }
        }east[0][0]=a[0][0];
        fr(i,0,n)
        {
            fr(j,1,m)
            {
                east[i][j]=min(a[i][j],a[i][j]+east[i][j-1]);
            }
            east[i+1][0]=a[i+1][0];
        }
        west[0][m-1]=a[0][m-1];
        fr(i,0,n)
        {
            frn(j,m-2,0)
            {
              west[i][j]=min(a[i][j],a[i][j]+west[i][j+1]);
            }
            west[i+1][m-1]=a[i+1][m-1];
        }
        north[0][0]=a[0][0];
        fr(j,0,m)
        {
            fr(i,1,n)
            {
                north[i][j]=min(a[i][j],a[i][j]+north[i-1][j]);
            }
            north[0][j+1]=a[0][j+1];
        }
        south[n-1][0]=a[n-1][0];
        fr(j,0,m)
        {
            frn(i,n-2,0)
            {
               south[i][j]=min(a[i][j],a[i][j]+south[i+1][j]);
            }
            south[n-1][j+1]=a[n-1][j+1];
        }
        int ans=a[0][0];
        fr(i,0,n)
        {
            fr(j,0,m)
            {
                ans=min(ans,south[i][j]+north[i][j]+west[i][j]+east[i][j]-(3*a[i][j]));
            }
        }
        cout << ans << "\n";
    }
    return 0;
}