#include <iostream>
#include <cmath>
#include <cstdio>
#include <memory.h>
using namespace std;

#define NMAX 1002
#define INF 10000001
#define sl(n) scanf("%lld",&n)
#define mset(n) memset(n,0,sizeof(n))
typedef long long int ll;

ll input[NMAX][NMAX], up[NMAX][NMAX], leftdp[NMAX][NMAX], down[NMAX][NMAX], rightdp[NMAX][NMAX] ;

int main() {

    ll t, n, m, i, j, ans;
    sl(t);
    while(t--){
        
        
        sl(n);
        sl(m);
        for(i=0 ; i<n+2 ; i++)
        
        {
            for(j=0 ; j<m+2 ; j++ )
            {
                up[i][j]=leftdp[i][j]=rightdp[i][j]=down[i][j]=INF;
            }
        }
       
        for(i=1 ; i<=n ; i++)
        {
            for(j=1 ; j<=m ; j++ )
            {
                sl(input[i][j]);
                
                leftdp[i][j] = min( input[i][j] , input[i][j] + leftdp[i][j-1]);
                up[i][j] = min( input[i][j] , input[i][j] + up[i-1][j]);
                
            }
          
        }
        
        for(i=n ; i>=1 ; i--)
        {
            for(j=m ; j>=1 ; j-- )
            {
                
                rightdp[i][j] = min( input[i][j] , input[i][j] + rightdp[i][j+1]);
                down[i][j] = min( input[i][j] , input[i][j] + down[i+1][j]);
            }
        }
        ans = INF;
        for(i=1 ; i<=n ; i++)
        {
            for(j=1 ; j<=m ; j++ )
            {
               ans = min(ans , up[i][j] + down[i][j] + leftdp[i][j] + rightdp[i][j] - 3*input[i][j]);
            }
        }
        cout<<ans<<endl;
    }
    
    return 0;
}
