#include <bits/stdc++.h>
#define ll long long int
using namespace std;

int min(int a,int b)
{
    return a<b?a:b;
}

int north[1005][1005];
	    int south[1005][1005];
	    int east[1005][1005];
	    int west[1005][1005];

int main() {
	// your code goes here
	ios_base::sync_with_stdio(false);
	cin.tie(NULL),cout.tie(NULL);
	int t,i,n,m,j,cost;
	cin>>t;
	while(t--)
	{
	    cin>>n>>m;
	    int arr[n][m];
	    cost=INT_MAX;
	    for(i=0;i<n;i++)
	    {
	        for(j=0;j<m;j++)
	        {
	            cin>>arr[i][j];
	        }
	    }
	   
	    //memset(north,0,sizeof(north));
	    //memset(south,0,sizeof(south));
	    //memset(east,0,sizeof(east));
	    //memset(west,0,sizeof(west));
	    
	    for(i=0;i<m;i++)
	    {
	        south[n-1][i]=arr[n-1][i];
	        north[0][i]=arr[0][i];
	    }
	    
	    for(i=0;i<n;i++)
	    {
	        east[i][m-1]=arr[i][m-1];
	        west[i][0]=arr[i][0];
	    }
	    
	    for(i=0;i<n;i++)
	    {
	        for(j=0;j<m;j++)
	        {
	            if(i!=0)
	            {
	             north[i][j]=min(arr[i][j],arr[i][j]+north[i-1][j]);
	            }
	            if(j!=0)
	            {
	             west[i][j]=min(arr[i][j],arr[i][j]+west[i][j-1]);
	            }
	        }
	    }
	    
	    for(i=n-1;i>=0;i--)
	    {
	        for(j=m-1;j>=0;j--)
	        {
	            if(i!=n-1)
	            {
	             south[i][j]=min(arr[i][j],arr[i][j]+south[i+1][j]);
	            }
	            if(j!=m-1)
	            {
	             east[i][j]=min(arr[i][j],arr[i][j]+east[i][j+1]);
	            }
	        }
	    }
	    
	    for(i=0;i<n;i++)
	    {
	        for(j=0;j<m;j++)
	        {
	            cost=min(cost,east[i][j]+west[i][j]+north[i][j]+south[i][j]-3*arr[i][j]);
	        }
	    }
	    
	    cout<<cost<<'\n';
	}
	return 0;
}
