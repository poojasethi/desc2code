#include<bits/stdc++.h>

using namespace std;

#define rep(i,j,k) for(i=j;i<k;i++)
#define MOD 1000000007
#define N 1005
long long int a[N][N],b[N][N],c[N][N],d[N][N],inp[N][N];

int main()
{
	long long int t,n,m,i,j;
	scanf("%lld",&t);
	long long int ans;
	do{
	ans=MOD;
	
	scanf("%lld %lld",&n,&m);
	rep(i,1,n+1)
		rep(j,1,m+1){
			
			scanf("%lld",&inp[i][j]);
			}
			
	rep(i,1,n+1){
		rep(j,1,m+1)
		{
			
					a[i][j]=min(a[i][j-1]+inp[i][j],inp[i][j]);
			
		}
		
		for(j=m;j>=1;j--)
		{		
				
				b[i][j]=min(b[i][j+1]+inp[i][j],inp[i][j]);
				if(j==m)
				b[i][j]=inp[i][j];
		}	
		
					
	}
	
	
	rep(i,1,m+1){
		rep(j,1,n+1)
	{
			
					c[j][i]=min(c[j-1][i]+inp[j][i],inp[j][i]);
					
		}
		
		for(j=n;j>=1;j--)
		{	
					d[j][i]=min(d[j+1][i]+inp[j][i],inp[j][i]);
				if(j==n)
				d[j][i]=inp[j][i];
								
		}			
		
					
	}
	
	rep(i,1,n+1)
		rep(j,1,m+1)
			ans=min(ans,a[i][j]+b[i][j]+c[i][j]+d[i][j]-3*inp[i][j]);
			
			
	printf("%lld\n",ans);
	
	}while(--t);
	
	
	return 0;
}	
