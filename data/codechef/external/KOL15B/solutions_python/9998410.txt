//#include<bits/stdc++.h>
#include<stdio.h>
//using namespace std;
//tuhinkundu
#define MOD 1000000007
#define ll         long long
#define s(n)                        scanf("%d",&n)
#define sc(n)                       scanf("%c",&n)
#define sll(n)                       scanf("%lld",&n)
#define sf(n)                       scanf("%lf",&n)
#define sstr(n)                       scanf("%s",&n)
#define p(n)	printf("%d\n",n)
#define pll(n)	printf("%lld\n",n)
#define pc(n)	printf("%c\n",n)
#define pstr(n)	printf("%s\n",n)
#define pbl   printf(" ")
#define pnew printf("\n")
int a[1000][1000],left[1000][1000],right[1000][1000],up[1000][1000],down[1000][1000];
int main()
{
	
	int t=0,n,m,i,j;
	long int csum,zz,mini=0;
	s(t);
	
	while(t--)
	{
		s(n),s(m);
		
		long int ans;	
		for(i=0;i<n;i++)
		for(j=0;j<m;j++)
		s(a[i][j]);
		
		for(i=0;i<n;i++)
		{
			csum=0;
			for(j=0;j<m;j++)
			{
				left[i][j]=csum;
				
				csum+=a[i][j];
				if(csum>0)
				csum=0;
			}
		}
		for(i=0;i<n;i++)
		{
			csum=0;
			for(j=m-1;j>=0;j--)
			{
				right[i][j]=csum;
				
				csum+=a[i][j];
				if(csum>0)
				csum=0;
			}
		}
		for(j=0;j<m;j++)
		{
			csum=0;
			for(i=0;i<n;i++)
			{
				up[i][j]=csum;
				
				csum+=a[i][j];
				if(csum>0)
				csum=0;
			}
		}
		for(j=0;j<m;j++)
		{
			csum=0;
			for(i=n-1;i>=0;i--)
			{
				down[i][j]=csum;
				
				csum+=a[i][j];
				if(csum>0)
				csum=0;
			}
		}
		zz=0;
		for(i=0;i<n;i++)
		{
			for(j=0;j<m;j++)
			{
				ans=up[i][j]+down[i][j]+left[i][j]+right[i][j]+a[i][j];
				
				if(zz==0)
				{
					mini=ans;
					zz=1;
				}
				else
				if(ans<mini)
				{
					mini=ans;
				}
			}
		}
		printf("%ld\n",mini);
	}
	return 0;
}