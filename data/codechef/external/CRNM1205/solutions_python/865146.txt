#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cmath>
#include <cstring>
#include <queue>
#include <cassert>
using namespace std;
#define p(x) cout<<#x<<":"<<x<<"\n"
#define lim 110
#define in(x,y) (x>=0 && x<y)

int n,m,x,y,ex,ey,cs,j,i;
char A[lim][lim];
int dx[]={-1,0,1,0};
int dy[]={0,1,0,-1};
queue <int> Q;
int D[lim][lim];

void push(int x,int y,int z)
{
  if(D[x][y]==-1)
  {
    D[x][y]=z;
	Q.push(m*x+y);
  }
}
int main()
{
  scanf("%d",&cs);
  while(cs--)
  {
    scanf("%d%d%d%d%d%d",&n,&m,&x,&y,&ex,&ey);
	for(i=0;i<n;i++)
	  scanf("%s",A[i]);
	assert(A[x][y]!='#' && A[ex][ey]!='#' && (x!=ex || y!=ey) && in(x,n) && in(y,m) && in(ex,n) && in(ey,m));
	memset(D,-1,sizeof D);
	push(x,y,0);
	while(!Q.empty())
	{
	  x=Q.front()/m;
	  y=Q.front()%m;
	  Q.pop();
	  for(i=0;i<4;i++)
	  {
	    int xx=x,yy=y;
while (1)
{
xx+=dx[i]; yy+=dy[i];
if (xx>=0 && xx<n && yy>=0 && yy<m && A[xx][yy]=='.' && D[xx][yy]==-1)
{
D[xx][yy]=D[x][y]+1;
Q.push(m*xx+yy);
}
else break;
}
}
	}
	printf("%d\n",max(D[ex][ey],0));
  }
  return 0;
}
