#include<iostream>
#define size 1000
using namespace std;
char arr[size][size];
int arr1[size][size];
int queuex[size*size];
int queuey[size*size];
int h,w,f,r,ans1,hashcount;

int check(int x,int y)
{
    if(x>=0 && y>=0 && x<h && y<w && arr[x][y]!='#')
      return 1;
    return 0;
}

void display()
{
     for(int i=f;i<=r;i++)
       cout<<queuex[i]<<" "<<queuey[i]<<"\n";
     for(int i=0;i<h;i++)
       cout<<arr[i]<<"\n";     
     cout<<"\n";
     for(int i=0;i<h;i++)
     {
       for(int j=0;j<w;j++)
       cout<<arr1[i][j]<<" ";     
       cout<<"\n";     
     }
}

void addqueue(int newx,int newy,int posx,int posy)
{
    if(check(newx,newy))
    {
       queuex[++r]=newx;
       queuey[r]=newy;
       arr1[newx][newy]=arr1[posx][posy]+1;            
       arr[newx][newy]='#';
      
    }                   
}

void bfs()
{
     while(f<=r )
     {                   
        int posx=queuex[f];
        int posy=queuey[f];        
        //display();
        //system("pause");
        for(int i=1;posx+i<h && arr[posx+i][posy]!='#';i++)
          addqueue(posx+i,posy,posx,posy);      
        for(int i=1;posx-i>=0 && arr[posx-i][posy]!='#';i++)        
          addqueue(posx-i,posy,posx,posy);                              
        for(int i=1;posy+i<w && arr[posx][posy+i]!='#';i++)        
          addqueue(posx,posy+i,posx,posy);               
        for(int i=1;posy-i>=0 && arr[posx][posy-i]!='#';i++)
          addqueue(posx,posy-i,posx,posy);              
        f++;                      
     }
}

int main()
{
    int t;
    scanf("%d",&t);
    while(t--)              
    {
        int sx,sy,ex,ey;       
        scanf("%d%d",&h,&w);              
        scanf("%d%d",&sx,&sy);        
        scanf("%d%d",&ex,&ey);  
        //cout<<t<<" "<<h<<"\n";      
        //assert(sx>=0 && sx<h && sy>=0 && sy<w);
        //assert(ex>=0 && ex<h && ey>=0 && ey<w);        
        ans1=f=hashcount=0;
        r=-1;
        for(int i=0;i<h;i++)
         for(int j=0;j<w;j++) arr1[i][j]=0;

        for(int i=0;i<h;i++)
           scanf("%s",&arr[i]);
        //assert(arr[sx][sy]!='#' && arr[ex][ey]!='#');
        
        queuex[++r]=sx;
        queuey[r]=sy;
                      
        arr1[sx][sy]=0;
        arr[sx][sy]='#';
        
        
        bfs();
        printf("%d\n",arr1[ex][ey]);
    }
}
