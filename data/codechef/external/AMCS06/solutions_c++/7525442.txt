#include <bits/stdc++.h>
using namespace std;

#define sd(x) scanf("%d",&x)
#define pii pair<int,int>
#define mp make_pair
#define pb push_back
#define F first
#define S second

vector<pii> a;
priority_queue<pii, vector<pii>, greater<pii> > q;

int main(){
	int t,n,l,d,x,c;
	sd(t);
	while(t--){
		sd(n);sd(l);sd(d);
		for(int i=0;i<n;i++){
			sd(x);sd(c);
			a.pb(mp(x,c));
		}
		sort(a.begin(),a.end());
		q.push(mp(0,0));
		for(int i=0;i<n;i++){
			while(!q.empty() && a[i].F-q.top().S>d)q.pop();
			if(q.empty())break;
			q.push(mp(q.top().F+a[i].S,a[i].F));
		}
		while(!q.empty() && l-q.top().S>d)q.pop();
		if(q.empty())printf("NO\n");
		else printf("YES %d\n",q.top().F);
		a.clear();
		while(!q.empty())q.pop();
	}
	return 0;
}
