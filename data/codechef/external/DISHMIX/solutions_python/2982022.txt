#include<stdio.h>

#define MOD 1000000007
#define llu long long unsigned
#define lld long long
#define ld long

long long scan_lld() {
	lld ip=getc(stdin),ret=0;
	for(;ip<'0'||ip>'9';ip=getc(stdin));
	for(;ip>='0'&&ip<='9';ip=getc(stdin))
		ret=ret*10+ip-'0';
	
	return ret;
}
 
void print_lld(lld n) {
	int i=21;
	char output_buffer[22];
	output_buffer[21]='\n';
	
	do { 
		output_buffer[--i]=(n%10)+'0';
		n/=10;
	} while(n);
	
	do {
		putchar_unlocked(output_buffer[i]);
	} while(++i<22);
}

int main() {
    int t,n,i;
    long long int count,v[100005];
    char ch[100005];
    scanf("%d",&t);
    while(t--) {
        count=1;
        scanf("%d",&n);
        for(i=0;i<n;i++) scanf("%lld",&v[i]);
        scanf("%s",ch);
        for(i=0;i<n-1;i++) {
            //scanf("%c",&ch);
            if(ch[i]=='a') {
                v[i+1]+=v[i];
                v[i]=1;
            }    
        }    
        
        for(i=0;i<n;i++) {
            //printf("%lld ",v[i]);
            count = (count*v[i])%MOD;
        }
        printf("%lld\n",count);    
        getchar();
    }    
    return 0;
}     
