#include<stdio.h>

#define MOD 1000000007
#define llu long long unsigned
#define lld long long
#define ld long
 
int main() {
    int t,n,i;
    char ch;
    scanf("%d",&t);
    while(t--) {
        scanf("%d",&n);
        long long int count=1,v[n+1];
        char ch[n+1];
        for(i=0;i<n;i++) scanf("%lld",&v[i]);
        scanf("%s",ch);
        //getchar();
        for(i=0;i<n-1;i++) {
            //scanf("%c",&ch);
            if(ch[i]=='a') {
                v[i+1]+=v[i];
                v[i]=1;
            }    
            //printf("%c %lld\n",ch,v[i]);
        }    
        
        for(i=0;i<n;i++) {
            count = (count*v[i])%MOD;
        }
        printf("%lld\n",count);    
    }    
    return 0;
}     
