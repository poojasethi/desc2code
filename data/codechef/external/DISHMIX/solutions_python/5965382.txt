#include<bits/stdc++.h>
using namespace std;
int main()
{
	int t,n,i;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%d",&n);
		char ch;
		long long int v[n],result=1;
		for(i=0;i<n;i++)
			scanf("%lld",&v[i]);
		i=0;
		while(i<n-1)
		{
			scanf("%c",&ch);
			switch(ch)
			{
				case 'a':
				v[i+1]=v[i]+v[i+1];
				v[i]=1;
				i++;
				break;
				case 'm':
				i++;
				break;
			}
		}
		for(i=0;i<n;i++)
		result=(result*v[i])%1000000007;
		printf("%lld\n",result);
	}
	return 0;
} 
