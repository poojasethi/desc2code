#include<stdio.h>

#define MOD 1000000007
#define llu long long unsigned
#define lld long long
#define ld long
 
int main() {
    int t,n,i;
    long long int count,v[100005];
    char ch[100005];
    scanf("%d",&t);
    while(t--) {
        count=1;
        scanf("%d",&n);
        for(i=0;i<n;i++) scanf("%lld",&v[i]);
        scanf("%s",ch);
        for(i=0;i<n-1;i++) {
            //scanf("%c",&ch);
            if(ch[i]=='a') {
                v[i+1]+=v[i];
                v[i]=1;
            }    
        }    
        
        for(i=0;i<n;i++) {
            //printf("%lld ",v[i]);
            count = (count*v[i])%MOD;
        }
        printf("%lld\n",count);    
        getchar();
    }    
    return 0;
}     
