#include<cctype>
#include<cstdio>
#include<cstring>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

typedef long long ll;

ll gcd(ll a,ll b){ return b?gcd(b,a%b):a; }
ll lcm(ll a,ll b){ return a/gcd(a,b)*b; }

int n_op,op[3000];
int f[6][6][9],g[6][6][9]; // [U,L,F,R,B,D][face][id] -> f:どの面にいくか, g:どの番号にいくか

int loop[6][9]; // ループするまでの操作回数
int rec(int face,int id,int j,int face0,int id0){
	if(~loop[face][id]) return loop[face][id];

	if(j>0 && face==face0 && id==id0) return loop[face][id]=j;

	int face2=face,id2=id;
	rep(i,n_op){
		int tmpf=face2,tmpi=id2;
		face2=f[op[i]][tmpf][tmpi];
		id2  =g[op[i]][tmpf][tmpi];
	}
	return loop[face][id]=rec(face2,id2,j+1,face0,id0);
}

int main(){
	// set f, g
	rep(o,6) rep(k,6) rep(i,9) {
		f[o][k][i]=k;
		g[o][k][i]=i;
	}
	// Up
	f[0][1][0]=4; f[0][1][1]=4; f[0][1][2]=4;
	f[0][2][0]=1; f[0][2][1]=1; f[0][2][2]=1;
	f[0][3][0]=2; f[0][3][1]=2; f[0][3][2]=2;
	f[0][4][0]=3; f[0][4][1]=3; f[0][4][2]=3;
	g[0][0][0]=2; g[0][0][1]=5; g[0][0][2]=8;
	g[0][0][3]=1; g[0][0][4]=4; g[0][0][5]=7;
	g[0][0][6]=0; g[0][0][7]=3; g[0][0][8]=6;
	// Left
	f[1][0][0]=2; f[1][0][3]=2; f[1][0][6]=2;
	f[1][2][0]=5; f[1][2][3]=5; f[1][2][6]=5;
	f[1][5][0]=4; f[1][5][3]=4; f[1][5][6]=4;
	f[1][4][2]=0; f[1][4][5]=0; f[1][4][8]=0;
	g[1][0][0]=0; g[1][0][3]=3; g[1][0][6]=6;
	g[1][2][0]=0; g[1][2][3]=3; g[1][2][6]=6;
	g[1][5][0]=8; g[1][5][3]=5; g[1][5][6]=2;
	g[1][4][2]=6; g[1][4][5]=3; g[1][4][8]=0;
	g[1][1][0]=2; g[1][1][1]=5; g[1][1][2]=8;
	g[1][1][3]=1; g[1][1][4]=4; g[1][1][5]=7;
	g[1][1][6]=0; g[1][1][7]=3; g[1][1][8]=6;
	// Front
	f[2][0][6]=3; f[2][0][7]=3; f[2][0][8]=3;
	f[2][1][2]=0; f[2][1][5]=0; f[2][1][8]=0;
	f[2][5][0]=1; f[2][5][1]=1; f[2][5][2]=1;
	f[2][3][0]=5; f[2][3][3]=5; f[2][3][6]=5;
	g[2][0][6]=0; g[2][0][7]=3; g[2][0][8]=6;
	g[2][1][2]=8; g[2][1][5]=7; g[2][1][8]=6;
	g[2][5][0]=2; g[2][5][1]=5; g[2][5][2]=8;
	g[2][3][0]=2; g[2][3][3]=1; g[2][3][6]=0;
	g[2][2][0]=2; g[2][2][1]=5; g[2][2][2]=8;
	g[2][2][3]=1; g[2][2][4]=4; g[2][2][5]=7;
	g[2][2][6]=0; g[2][2][7]=3; g[2][2][8]=6;
	// Right
	f[3][0][2]=4; f[3][0][5]=4; f[3][0][8]=4;
	f[3][2][2]=0; f[3][2][5]=0; f[3][2][8]=0;
	f[3][5][2]=2; f[3][5][5]=2; f[3][5][8]=2;
	f[3][4][0]=5; f[3][4][3]=5; f[3][4][6]=5;
	g[3][0][2]=6; g[3][0][5]=3; g[3][0][8]=0;
	g[3][2][2]=2; g[3][2][5]=5; g[3][2][8]=8;
	g[3][5][2]=2; g[3][5][5]=5; g[3][5][8]=8;
	g[3][4][0]=8; g[3][4][3]=5; g[3][4][6]=2;
	g[3][3][0]=2; g[3][3][1]=5; g[3][3][2]=8;
	g[3][3][3]=1; g[3][3][4]=4; g[3][3][5]=7;
	g[3][3][6]=0; g[3][3][7]=3; g[3][3][8]=6;
	// Back
	f[4][0][0]=1; f[4][0][1]=1; f[4][0][2]=1;
	f[4][1][0]=5; f[4][1][3]=5; f[4][1][6]=5;
	f[4][5][6]=3; f[4][5][7]=3; f[4][5][8]=3;
	f[4][3][2]=0; f[4][3][5]=0; f[4][3][8]=0;
	g[4][0][0]=6; g[4][0][1]=3; g[4][0][2]=0;
	g[4][1][0]=6; g[4][1][3]=7; g[4][1][6]=8;
	g[4][5][6]=8; g[4][5][7]=5; g[4][5][8]=2;
	g[4][3][2]=0; g[4][3][5]=1; g[4][3][8]=2;
	g[4][4][0]=2; g[4][4][1]=5; g[4][4][2]=8;
	g[4][4][3]=1; g[4][4][4]=4; g[4][4][5]=7;
	g[4][4][6]=0; g[4][4][7]=3; g[4][4][8]=6;
	// Down
	f[5][1][6]=2; f[5][1][7]=2; f[5][1][8]=2;
	f[5][2][6]=3; f[5][2][7]=3; f[5][2][8]=3;
	f[5][3][6]=4; f[5][3][7]=4; f[5][3][8]=4;
	f[5][4][6]=1; f[5][4][7]=1; f[5][4][8]=1;
	g[5][5][0]=2; g[5][5][1]=5; g[5][5][2]=8;
	g[5][5][3]=1; g[5][5][4]=4; g[5][5][5]=7;
	g[5][5][6]=0; g[5][5][7]=3; g[5][5][8]=6;

	int atoop[128];
	atoop['U']=0; atoop['L']=1; atoop['F']=2;
	atoop['R']=3; atoop['B']=4; atoop['D']=5;

	int T; scanf("%d",&T);
	while(T--){
		char s[1001]; scanf("%s",s);

		n_op=0;
		for(int j=0;s[j];j++){
			int o,cnt;
			if     (isalpha(s[j])) o=atoop[s[ j ]], cnt=1;
			else if(s[j]=='2')     o=atoop[s[j-1]], cnt=1;
			else                   o=atoop[s[j-1]], cnt=2;
			while(cnt--) op[n_op++]=o;
		}

		ll ans=1;
		memset(loop,-1,sizeof loop);
		rep(k,6) rep(i,9) ans=lcm(ans,rec(k,i,0,k,i));

		printf("%lld\n",ans);
	}

	return 0;
}
