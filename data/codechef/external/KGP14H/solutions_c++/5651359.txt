#include <iostream>
using namespace std;

int cost[105][105];
int dp[105][105];

int main() {
	int test,z,n,i,j,a,b,k,x,co,s,q,t;
	cin>>test;
	for(z=1;z<=test;z++)
	{
		cin>>n>>co;
		n+=2;
		for(i=1;i<=n;i++)
		{
			cin>>x;
			for(j=1;j<n;j++)
			{
				cin>>a>>b;
				cost[x+1][a+1]=b;
			}
			dp[x][x]=0;
		}
		for(i=1;i<=n;i++)
			dp[i][1]=dp[1][i]=cost[i][1];
		for(i=2;i<=n;i++)
		{
			for(j=i;j<=n;j++)
			{
				dp[i][j]=1000000000;
				s=0;
				for(k=i-1;k>=1;k--)
				{
					if(k==i-1)
						x=j;
					else		x=k+1;
					q=dp[k][x]+s+cost[k][i];
					dp[i][j]=min(dp[i][j],q);
					if(k==(i-1))
						s+=cost[j][k];
					else if(k<(i-1))
						s+=cost[k][k+1];
				}
			}
		}
	/*	for(i=1;i<=n;i++)
		{
			for(j=1;j<=n;j++)	cout<<dp[i][j]<<" ";
			cout<<endl;
		}*/
		cout<<"Case "<<z<<": "<<dp[n][n]+((n-1)*co)<<endl;
	}
	return 0;
}