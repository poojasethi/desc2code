#include <bits/stdc++.h>
using namespace std;
#define N 120


long long dp[N][N],c[N][N];
int main()
{
	long long n,k,r,x,y,d,ptr=0;
	cin>>n;
	//
	//cout<<n<<" "<<k<<"\n";
	for(int C=1;C<=n;C++)
	{
		cin>>k>>r;
		ptr=0;
		while(ptr<=k+1)
		{ 	
			ptr++;
			cin>>x;
			for(int i=0;i<k+1;i++)
			{
				cin>>y>>d;
				//cout<<y<<" "<<d<<"\n";
				c[x][y]=d;
			}
		}
		//check it may be problem
		for(int i=0;i<=k+1;i++) c[k+2][i]=c[k+1][i];
		for(int i=0;i<=k+1;i++) c[i][k+2]=c[i][k+1];
		c[k+1][k+2]=0;
		c[k+2][k+1]=0;
		/*for(int i=0;i<=k+2;i++)
		{
		for(int j=0;j<=k+2;j++)
		cout<<c[i][j]<<" ";
		cout<<"\n";
		}*/
		for(int i=0;i<=k+2;i++)
			for(int j=i+1;j<=k+2;j++)
			{
				
				if(i==0) {dp[i][j]=c[i][j];continue;}
				dp[i][j]=min(c[i-1][j]+dp[i-1][i],c[i-1][i]+dp[i-1][j]);
			}
		cout<<"Case "<<C<<": "<<(dp[k+1][k+2]+r*(k+1))<<"\n";
	}
	return 0;
}