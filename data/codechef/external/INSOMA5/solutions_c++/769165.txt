#include <iostream>
#include <stdio.h>
#include <string.h>
using namespace std;
int a[20][20][4]={0};
char s[40];
void solve(int i,int j,int k)
{	
	if(s[j]=='.')
	{
		a[i][k][0]+=a[i][j][0]*a[j+1][k][0]+a[i][j][0]*a[j+1][k][1]+a[i][j][1]*a[j+1][k][0];
		a[i][k][1]+=a[i][j][1]*a[j+1][k][1];
		
	}
	else if(s[j]=='+')
	{
		a[i][k][0]+=a[i][j][0]*a[j+1][k][0];
		a[i][k][1]+=a[i][j][1]*a[j+1][k][1]+a[i][j][0]*a[j+1][k][1]+a[i][j][1]*a[j+1][k][0];
	}
	else if(s[j]=='*')
	{
		a[i][k][0]+=a[i][j][0]*a[j+1][k][0]+a[i][j][1]*a[j+1][k][1];
		a[i][k][1]+=a[i][j][0]*a[j+1][k][1]+a[i][j][1]*a[j+1][k][0];	
	}
}
int main()
{
	cin>>s;
	int i,j,k,l,m;
	l=strlen(s);
	for(i=0,j=0;i<l;i+=2,j++)
	{
		if(s[i]=='T')
			a[j][j][1]=1;
		else
			a[j][j][0]=1;
	}
	for(i=1,j=0;i<l;i+=2,j++) //gets all the opertions saved
		s[j]=s[i];
	l=j;					//length of array of operators

	for(i=1;i<=l;i++)		//increasing the size of the group
	{
		for(j=0;j<=l-i;j++)
		{
			for(k=0;k<i;k++)
			{
				solve(j,j+k,j+i);	
			}
		}
	}
	cout<<a[0][l][1];
	return 0;
}
		