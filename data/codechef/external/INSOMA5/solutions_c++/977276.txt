#include <iostream>
#define SIZE 20
//#define MyDebug11

using namespace std;

long long catalan[SIZE]={0};
	
void catalans(int n){
	catalan[0] = 1;
	for(int i=1; i<n;++i){
		catalan[i] = 0;
		for(int j=0;j<i;++j){
			catalan[i] += catalan[i-j-1]*catalan[j];
		}
	}	
}

int main(){
	char str[SIZE*3];
	char tf[SIZE*3],opr[SIZE*3];
	int mat[SIZE][SIZE] = {0};
	
	cin >> str;
	int i=0, count=0,k=0,x=0;
	catalans(SIZE);
	#ifdef MyDebug11
	for(int i=1; i<SIZE;++i){
		cout << catalan[i] << " ";
	}
	#endif
	while(str[i]){
		if(str[i]=='T')
		{
			mat[count][count] = 1;
			tf[k++] = 'T';
			count++;
		} else if(str[i] == 'F'){
			mat[count][count] = 0;
			tf[k++] = 'F';
			count++;
		} else {
			if(str[i]=='.' || str[i]=='*' || str[i]=='+' )
				opr[x++] = str[i];
		}
		i++;
	}
	//cout << count;
	int step,y1,y2,t1,t2,z;
	#ifdef MyDebug11	
	cout << endl;
	for(int i=0;i<count;++i){//col
		for(int j=0;j<count;++j){//row
			//z = i+j;
			cout << mat[i][j] << " ";
		}
		cout << endl;
	}
	#endif
	int stepi;
	
	//cout << "\n*****************\n";
	for(int i=1;i<count;++i){//col
		for(int j=0;j<count-i;++j){//row
			step = 0;
			z = i+j;
			mat[j][z] = 0;
			for(int k=j;k<z;++k){
				stepi = 0;
				y1 = mat[j][k];
				y2 = mat[k+1][z];
				t1 = catalan[k-j];
				t2 = catalan[z-k-1];
				#ifdef MyDebug11
				cout << opr[k]<<" " << j << " " << k << " " << z << " y1 y2 t1 t2 " 
					<< y1 << " "  << y2 << " " << t1 << " " << t2 << " ";
				#endif
				switch(opr[k]){
					case '.' :
						stepi = y1*y2;//y2:y1;
						break;
					case '+':
						stepi = t1*y2+t2*y1 - y1*y2;
						break;
					case '*' :
						stepi = t2*y1+  t1*y2 - 2*y1*y2;
						break;
				}
				#ifdef MyDebug11
				cout << stepi << endl;
				#endif
				step += stepi;
			}
			//cout << step << endl;
			if(step > mat[j][z]){
					mat[j][z] = step;
			}
		}
	}
	#ifdef MyDebug11
	for(int i=1;i<count;++i){//col
		for(int j=0;j<count-i;++j){//row
			z = i+j;
			cout << mat[j][z] << " ";
		}
		cout << endl;
	}
	cout << "\n*****************\n";
	
	for(int i=0;i<count;++i){//col
		for(int j=0;j<count;++j){//row
			//z = i+j;
			cout << mat[i][j] << " ";
		}
		cout << endl;
	}
	#endif
	if(count>0)
	cout << mat[0][count-1];
	else
	cout << 0;
	cin >> count;
	return 0;
}
