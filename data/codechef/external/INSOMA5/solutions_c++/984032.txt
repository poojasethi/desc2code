#include<iostream>
#include<cstdio>
#include<string.h>
using namespace std;

int truecount[50][50];
int falsecount[50][50];


int main() {
	//memset(truecount, 0, sizeof(truecount));
	//memset(falsecount, 0, sizeof(falsecount));
	//string input;
	char input[50];
	scanf("%s", input);
	int input_length=strlen(input);
	cin >> input;
	for(int index=0; index<input_length; index+=2) {
		if(input[index]=='T') {
			truecount[index][index]=1;
			falsecount[index][index]=0;
		} else {
			truecount[index][index]=0;
			falsecount[index][index]=1;
		}
	}
	for(int substring_length=3; substring_length<=input_length; substring_length+=2) {
		for(int index=0; index+substring_length<=input_length; index+=2) {
			for(int subindex=index; subindex<=index+substring_length-2; subindex+=2) {
				int t_operand1=truecount[index][subindex];
				int t_operand2=truecount[subindex+2][index+substring_length-1];
				int f_operand1=falsecount[index][subindex];
				int f_operand2=falsecount[subindex+2][index+substring_length-1];
				//cout << t_operand1 << " " << t_operand2 << " " << f_operand1 << " " << f_operand2 << endl;
				if(input[subindex+1]=='+') {
					truecount[index][index+substring_length-1]+=(t_operand1*t_operand2+t_operand1*f_operand2+f_operand1*t_operand2);
					falsecount[index][index+substring_length-1]+=(f_operand1*f_operand2);
				} else if(input[subindex+1]=='.') {
					falsecount[index][index+substring_length-1]+=(f_operand1*f_operand2+t_operand1*f_operand2+f_operand1*t_operand2);
					truecount[index][index+substring_length-1]+=(t_operand1*t_operand2);						
				} else {
					truecount[index][index+substring_length-1]+=(f_operand1*t_operand2+t_operand1*f_operand2);
					falsecount[index][index+substring_length-1]+=(f_operand1*f_operand2+t_operand1*t_operand2);						
				}
			}
		}
	}
	printf("%d\n", truecount[0][input_length-1]);
	return 0;
}
