#include <stdio.h>
#include <string.h>
 
struct	table {
	int	T;
	int	F;
}M[15][15];
 
int main ()
{
	char	E[32], op;
	int	i, j, k, l, len, lit;
 
	scanf ("%s", E);
	len = strlen (E);
	lit = len/2;
 
	for (i=0; i<=lit; i++) {
		if (E[i*2] == 'T') {
			M[i][i].T = 1;
			M[i][i].F = 0;
		}
		else {
			M[i][i].T = 0;
			M[i][i].F = 1;
		}
	}
 
	for (l=2; l<=lit+1; l++) {
		for (i=0; i<=lit-l+1; i++) {
			j = i+l-1;
			for (k=i; k<j; k++) {
				op = E[2*k+1];
 
				if (op == '.') {
					M[i][j].T += M[i][k].T * M[k+1][j].T;
 
					M[i][j].F += M[i][k].T * M[k+1][j].F +
						     M[i][k].F * M[k+1][j].T +
						     M[i][k].F * M[k+1][j].F;
				}
 
				if (op == '+') {
					M[i][j].T += M[i][k].T * M[k+1][j].T +
						     M[i][k].T * M[k+1][j].F +
						     M[i][k].F * M[k+1][j].T;
 
					M[i][j].F += M[i][k].F * M[k+1][j].F;
				}
 
				if (op == '*') {
					M[i][j].T += M[i][k].T * M[k+1][j].F +
						     M[i][k].F * M[k+1][j].T;
 
					M[i][j].F += M[i][k].T * M[k+1][j].T +
						     M[i][k].F * M[k+1][j].F;
				}
			}
		}
	}
 
	printf ("%d", M[0][lit].T);
 
	return 0;
}