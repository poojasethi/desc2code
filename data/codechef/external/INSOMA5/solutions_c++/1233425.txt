#include <cstdio>

int main() {
  bool literals[100];
  char operators[100], in[2];
  int i = 0, t[100][100], f[100][100];

  while(true) {
    scanf("%c%c", &in[0], &in[1]);
    literals[i] = in[0]=='T';
    if(in[1]=='.' || in[1]=='*' || in[1] == '+') operators[i] = in[1];
    else break;
    i++;
  }

  i++;
  int N = i, s, e;

  for(s=N-1;s>=0;s--) {
    t[s][s] = 0; f[s][s] = 0;
    if(literals[s]) t[s][s]++;
    else f[s][s]++;

    for(e=s+1;e<N;e++) {
      for(i=s;i<=e;i++) {
        int t1 = t[s][i], t2 = t[i+1][e], f1 = f[s][i], f2 = f[i+1][e]; 
        if(operators[i] == '+') {
          t[s][e] += t1 * t2 + t1 * f2 + f1 * t2;
          f[s][e] += f1 * f2;
        }
        if(operators[i] == '.') {
          t[s][e] += t1 * t2;
          f[s][e] += t1 * f2 + f1 * t2 + f1 * f2;
        }
        if(operators[i] == '*') {
          t[s][e] += t1 * f2 + f1 * t2;
          f[s][e] += t1 * t2 + f1 * f2;
        }
      }
    }
  }

  printf("%d\n", t[0][N-1]);

  return 0;
}
