#include<iostream>
#include<string>

//#define MEM(a) memset(a, 0, sizeof(a)) 
using namespace std;
typedef struct {
  int t;
  int f;
} table;
int main() {
  table tab[15][15];
 
  string in;
  cin >> in;
  int le = in.length();
  int it = le >> 1;

  for(int i=0; i< 15 ; ++i) { 
    for(int j=0; j< 15; ++j)
      {      tab[i][j].t = 0;
	tab[i][j].f = 0;
      }
}
  for(int i=0; i<= it; ++i) {
    if(in[2*i] == 'T') {
      tab[i][i].t =1;
      tab[i][i].f = 0;
    }
    else {
      tab[i][i].t = 0;
      tab[i][i].f = 1;
    }
  }
  for(int len =2; len <= it+1; ++len) {
    for(int i=0; i <= it+1-len ; ++i) {
      int j = i+len-1;
      for(int k=i; k< j; ++k) {
	if(in[2*k +1] == '.') {
	  tab[i][j].t += tab[i][k].t * tab[k+1][j].t;
	  tab[i][j].f += tab[i][k].t * tab[k+1][j].f + tab[i][k].f * tab[k+1][j].t + tab[i][k].f * tab[k+1][j].f;
	}
	if(in[2*k + 1] == '+') {
	  tab[i][j].t += tab[i][k].t * tab[k+1][j].f + tab[i][k].f * tab[k+1][j].t + tab[i][k].t * tab[k+1][j].t;
	  tab[i][j].f += tab[i][k].f * tab[k+1][j].f;
	}
	if(in[2*k + 1] == '*') {
	  tab[i][j].f += tab[i][k].f * tab[k+1][j].f + tab[i][k].t * tab[k+1][j].t;
	  tab[i][j].t +=  tab[i][k].t * tab[k+1][j].f + tab[i][k].f * tab[k+1][j].t;
	}
      }
    }
  }

  cout << tab[0][it].t << endl;
  return 0;
}
