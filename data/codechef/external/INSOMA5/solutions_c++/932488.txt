#include<iostream>
#include<cstring>
using namespace std;

int main()
{
    string s1;
    cin>>s1;
    int n=s1.length();
    long long int ans[n][n][2];
  //  bool a[n][n];
    int j;
    for(int i=0;i<n;i++)
    {
            for(int j=0;j<n;j++)
            {
                    ans[i][j][0]=0;
                    ans[i][j][1]=0;
            }
    }
    for(int i=0;i<n;i++)
    {
            if(s1[i]=='T')
            {ans[i][i][1]=1;ans[i][i][0]=0;}
            else if(s1[i]=='F')
            {ans[i][i][1]=0;ans[i][i][0]=1;}
    }
    for(int s=3;s<=n;s=s+2)
    {
            for(int i=0;i<=n-s;i=i+2)
            {
                    j=i+s-1;
                    //if(!((s1[i]=='T' || s1[i]=='F') && (s1[j]=='T' || s1[j]=='F')))
                    //continue;
                    for(int k=i+1;k<=j-1;k=k+2)
                    {
                          //  if(s1[k]=='T' || s1[k]=='F')
                           // continue;
                            if(s1[k]=='+')
                            {ans[i][j][1]+=(ans[i][k-1][0]*ans[k+1][j][1]+ans[i][k-1][1]*ans[k+1][j][0]+ans[i][k-1][1]*ans[k+1][j][1]);
                            ans[i][j][0]+=(ans[i][k-1][0]*ans[k+1][j][0]);}
                            else if(s1[k]=='*')
                            {ans[i][j][1]+=(ans[i][k-1][0]*ans[k+1][j][1]+ans[i][k-1][1]*ans[k+1][j][0]);
                            ans[i][j][0]+=(ans[i][k-1][0]*ans[k+1][j][0]+ans[i][k-1][1]*ans[k+1][j][1]);}
                            else
                           {ans[i][j][1]+= (ans[i][k-1][1]*ans[k+1][j][1]);
                           ans[i][j][0]+=(ans[i][k-1][0]*ans[k+1][j][1]+ans[i][k-1][1]*ans[k+1][j][0]+ans[i][k-1][0]*ans[k+1][j][0]);
                           }
                           
                            //else
                            //ans[i][j][1]=ans[i][k-1][1]*ans[k+1][j][1];
                    }
                   // cout<<i<<" "<<j<<" "<<ans[i][j][0]<<" "<<ans[i][j][1]<<endl;
            }
    }
    
    printf("%lld\n",ans[0][n-1][1]);
  //  system("pause");
    return 0;
}
