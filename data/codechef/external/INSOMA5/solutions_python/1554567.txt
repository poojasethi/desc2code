#!/usr/bin/python

s=raw_input()
dp = [ [ 0 for j in xrange(20)] for i in xrange(20) ]
op = [ '_' for i in xrange(20) ]
n = len(s)
m = 0
f = [0, 1]
for i in xrange(2,20):
    f.append(0)
    for j in xrange(1,i):
        f[i] += f[j] * f[i-j]
for i in xrange(n):
    if i%2 == 0 and s[i] == 'T':
        dp[i/2][1] = 1
    else: op[i/2] = s[i]
n = (n+1)/2
for l in xrange(2,n+1):
    for i in xrange(n+1-l):
        for k in xrange(i,i+l-1):
            la,lb = k+1-i,l+i-k-1
            if op[k] == '.': dp[i][l] += dp[i][la] * dp[k+1][lb]
            if op[k] == '+':
                dp[i][l] += f[la] * f[lb]
                dp[i][l] -= (f[la] - dp[i][la]) * (f[lb] - dp[k+1][lb])
            if op[k] == '*':
                dp[i][l] += dp[i][la] * (f[lb] - dp[k+1][lb])
                dp[i][l] += (f[la] - dp[i][la]) * dp[k+1][lb]
print dp[0][n]
