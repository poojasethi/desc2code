#include <iostream>
#include <bits/stdc++.h>
#define rep(i,n) for(int i=0; i<n; i++)
#define reps(i,a,b) for(int i=a; i<=b; i++)
#define s(t) scanf("%d",&t)
#define p(t) printf("%d\n",t)
#define pb push_back
#define mp make_pair
#define ALL arr.begin(),arr.end()
using namespace std;
 
#define ull long long 
#define t9 1000000000
ull multiply(ull a,ull b,ull mod)
{
   ull prod=0;
   ull a1=a/t9,a0=a%t9;
   ull b1=b/t9,b0=b%t9;
 
   prod=(a0*b0)%mod;
   ull pOF=(a1*b1)%mod;
   ull p1=(a1*b0+a0*b1)%mod;
   for(int i=1;i<=9;i++)
        p1=(p1*10)%mod;
   for(int i=1;i<=18;i++)
        pOF=(pOF*10)%mod;
   prod=(prod+p1)%mod;
   prod=(prod+pOF)%mod;
   return prod;
}
 
long long power(long long a,long long b,long long mod)
{
  long long res=1;
  a%=mod;
 
  while(b>0)
  {
 	if(b%2==1)
 	 res=(multiply(res,a,mod));
 
 	a=multiply(a,a,mod);
 	b/=2;
  }
  return res;
}
 
long long x;
 
long long solve(long long n,long long m,long long rat)
{
 	if(n==1)
 	 return 1;
 
 	long long res=multiply((rat%m+1),solve(n/2,m,multiply(rat,rat,m)),m);
 	if(res>=m)
 	 res%=m;
 
 	if(n%2==1)
 	res=(res+power(rat%m,n-1,m));
 
	if(res>=m)
 	res%=m;
 	return res;
}
 
int main()
{
    int t;
    cin>>t;
 
    while(t--)
    {
      long long int n,m;
      scanf("%lld%lld%lld",&x,&m,&n);
 
      long long ans=solve(m+1,n,x);
      printf("%lld\n",ans%n);
    }
    
    return 0;
}