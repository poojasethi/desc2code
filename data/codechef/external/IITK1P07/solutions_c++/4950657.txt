#include <cassert>
#include <cctype>
#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <sstream>
#include <iomanip>
#include <string>
#include <vector>
#include <deque>
#include <list>
#include <set>
#include <map>
#include <bitset>
#include <stack>
#include <queue>
#include <algorithm>
#include <functional>
#include <iterator>
#include <numeric>
#include <utility>
#include<limits.h>
#define ll long long
using namespace std;



inline ll int  mulmod(ll int a,ll int  b,ll int  c)
{
    if(a==0||b==0)
        return 0;
    ll int hh=LLONG_MAX/a;
    if(hh>b)
        return (a*b)%c;
    ll int x=0,y=a%c;
    while(b>0)
    {
        if(b&1)
        {
            x=(x+y);
            if(x>=c) x-=c;
        }
        y=(y<<1);
        if(y>=c) y-=c;
        b=b>>1;
    }
    return x;
}
vector<ll int > powers;
long long int modpow(long long int  n,long long int  p,long long int  mod)
{
    long long int ret=1;
    int i=1;
    while(p>0)
    {
        if(p&1)
        {
            ret=mulmod(powers[i],ret,mod);
            if(ret>=mod)
                ret%=mod;
        }
        i++;
        p>>=1;
    }
    return ret;
}

pair<ll int, pair<ll int,ll int> > extendedEuclid(ll int a, ll int b) {
	if(a == 0) return make_pair(b, make_pair(0, 1));
	pair<ll int, pair<ll int,ll int> > p;
	p = extendedEuclid(b % a, a);
	return make_pair(p.first, make_pair(p.second.second - p.second.first*(b/a), p.second.first));
}

ll int modInverse(ll int a,ll int m) {
    return (extendedEuclid(a,m).second.first + m) % m;
}
ll int solve( ll int x,ll int m, ll int n)
{
          ll int temp;
          if(m==0)
          return (1%n);
          
          if(m==1)
          return (1+x)%n;
          
          if(m%2==0)
          {
               temp=solve(x,m-1,n);
               temp=mulmod(temp,x,n);
               temp+=1;
               temp%=n;
               return temp;
               }
               else
               {
                   temp=solve(mulmod(x,x,n),m/2,n);
                   temp=mulmod(temp,(1+x),n);
                   temp%=n;
                   return temp;
                   }
          }                 

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
           ll int x,m,n,p,r;
           scanf("%lld %lld %lld",&x,&m,&n);// cin>>x>>m>>n;
          // m++;
           powers.assign(70,0);
           powers[0]=1;
           powers[1]=x;
           for(ll int  i=2;i<70;i++)
            powers[i]=mulmod(powers[i-1],powers[i-1],n);
           
           cout<<solve(x,m,n)<<"\n";
           
           }
           return 0;
           }
              
