#include<bits/stdc++.h>
using namespace std;

long long multiply(long long A, long long B, long long &MOD)
{
	if(!B) return 0;
	long long ret = multiply(A, B/2, MOD);
	ret += ret;
	ret %= MOD;
	if(B%2) ret += A, ret %= MOD;
	return ret;
}

pair<long long, long long> GS(long long &X, long long N, long long &MOD)
{
	if(N == 1ll)return make_pair(1ll, X);
	
	pair<long long, long long> Half = GS(X, N/2, MOD);
	long long GSHalf = Half.first;
	long long powHalf = Half.second;
	pair<long long, long long> ret;
	ret.first = GSHalf;
	if(N%2)ret.first += multiply(GSHalf, multiply(powHalf, X, MOD), MOD);
	else ret.first += multiply(GSHalf, powHalf, MOD);//printf("%lld\n",ret.first);
	ret.first %= MOD;
	if(N%2) ret.first += powHalf, ret.first %= MOD;
	
	ret.second = multiply(powHalf, powHalf, MOD);
	if(N%2)ret.second = multiply(X, ret.second, MOD), ret.second %= MOD;
	
	//printf("%lld %lld %lld\n",N,ret.first, ret.second);
	return ret;
}

int main()
{
	int T;
	scanf("%d",&T);
	
	while(T--)
	{
		long long X,N,M;
		scanf("%lld %lld %lld",&X,&M,&N);
		
		printf("%lld\n",GS(X, M+1, N).first);
	}
}
