#include<bits/stdc++.h>
using namespace std;

long long mul(long long a,long long b,long long mod) {
    a%=mod;
    b%=mod;
    long double res=a;
    res*=b;
    long long c=(long long)(res/mod);
    a*=b;
    a=a-c*mod;
    a=a%mod;
    if(a<0)
        a+=mod;
    return a;
}

long long _pow(long long a,long long b,long long mod) {
    long long x=1,y=a;
    while(b) {
        if(b&1)
            x=mul(x,y,mod);
        y=mul(y,y,mod);
        b>>=1;
    }
    return x;
}

long long solve(long long x, long long m, long long mod) {
    if(m==0) {
        return 1;
    } else if(m==1) {
        return (1+x)%mod;
    } else {
        if(m%2==0) {
            long long a=(1+x)%mod;
            long long xx=mul(x, x, mod);
            long long b=solve(xx, (m-2)/2, mod);
            long long c=_pow(x, m, mod);
            a=mul(a, b, mod);
            return (a+c)%mod;
        } else {
            long long a=(1+x)%mod;
            long long xx=mul(x, x, mod);
            long long b=solve(xx, (m-1)/2, mod);
            a=mul(a, b, mod);
            return a;
        }
    }
}



int main() {
    int test;
    scanf("%d", &test);
    while(test--) {
        long long x, m, mod;
        scanf("%lld %lld %lld", &x, &m, &mod);
        long long ans=solve(x, m, mod);
        printf("%lld\n", ans);
    }
}
