#include <bits/stdc++.h>
typedef long long int ll;
using namespace std;
void PerformTest(int);
ll func(ll,ll,ll);
ll mul(ll,ll,ll);
ll fpower(ll,ll,ll);
int main()
{
    int tc,t;
    scanf("%d",&tc);
    for(t = 1 ; t<=tc ; t++)
    {
        PerformTest(t);
    }
    return 0;
}
void PerformTest(int TestCase)
{
    ll X,N,MOD;
    scanf("%lld %lld %lld",&X,&N,&MOD);
    ll ans = func(X,N+1,MOD);
    printf("%lld\n",ans);
}
ll func(ll X,ll N,ll MOD)
{
    if(N == 1) return 1;
    ll F = 0;
    if(N%2 != 0) F = fpower(X,N-1,MOD);
    ll Y = mul(X,X,MOD);
    ll TEMP = func(Y,N/2,MOD);
    ll Z = mul(1+X,TEMP,MOD);
    Z = (Z + F)%MOD;
    return Z;
}
ll fpower(ll x,ll p,ll MOD)
{
    ll res = 1;
    while(p>0)
    {
        if(p%2 != 0)
        {
            res = mul(res,x,MOD);
        }
        p = p/2;
        x = mul(x,x,MOD);
    }
    return res;
}
ll mul(ll a,ll b,ll m)
{
   ll mod = m;
   a %= m;
   b %= m;
   long double res = a;
   res *= b;
   ll c = ll(res / mod);
   a *= b;
   a -= c * mod;
   a %= mod;
   if (a < 0) a += mod;
   return a;
}