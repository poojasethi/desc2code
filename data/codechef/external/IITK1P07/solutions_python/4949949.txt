def getpow(x, n, mod) :
    if n == 0:
        return 1
    if n == 1 :
        return x
    z = getpow(x, n/2, mod)
    if n % 2 == 0 :
        return (z*z)%mod
    return (z*z*x)%mod


 
t = int(raw_input())
for i in xrange(t):
    s = raw_input()
    nums = [int(n) for n in s.split()]
    x = nums[0]
    m = nums[1]
    n = nums[2]
    if x == 1:
        z1 = (m+1)%n
        print z1
        continue
    mod =  n*(x-1)
    z1 = getpow(x, m+1,mod)
    z1 -= 1
    z1 += mod
    z1 %= mod
    z1 /= (x-1)
    print z1
