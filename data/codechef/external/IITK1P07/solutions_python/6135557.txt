
# your code goes here
def modexpo(x,m,n):
    if(m>1):
        ans=modexpo(x,m/2,n)
        ans=(ans*ans)%n
        if((m%2)== 1):
            ans=(ans*x)%n
        return ans
    else :
        return x


t=int(input())
while t>0 :
    t=t-1
    x,m,n = map(int, raw_input().split())
    if x==1 :
        answer=(m+1)%n
    else :
        n=n*(x-1)
        answer=modexpo(x%n,m+1,n)
        answer=(answer-1+n)%n
        answer=answer/(x-1)
    print answer
