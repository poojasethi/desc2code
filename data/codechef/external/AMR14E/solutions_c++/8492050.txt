#include<bits/stdc++.h>
#define LL long long 
using namespace std;

LL int primes[10000007];
static bool isprime[100000007],mark[100000007];
void markprime(LL int a,LL int b,LL int top)
{
	LL int i,val,j;
	for(i=a;i<=b;i++)
	isprime[i-a]=1;
	for(i=0;i<top;i++)
	{
		if(primes[i]>b)
		return ;
		if(primes[i]>=a)
		val=2*primes[i];
		else if(primes[i]<a)
		{
		val=a/primes[i];
		val=val*primes[i];
		if(a%primes[i]!=0)
		val=val+primes[i];
		}
		for(j=val;j<=b;j+=primes[i])
		isprime[j-a]=0;
	}
}

bool rootmarked(LL int n)
{
LL int rt;
rt=sqrt(n);
if(rt*rt == n)
return mark[rt];
else return 0;
}
int main()
{
	LL int n,i,top,j,thold,val,t,a,b,ans;
	//cout<<"h\n";
	n=sqrt(1000000000);
	//cout<<n<<"\n";
	for(i=0;i<=n;i++)
	isprime[i]=1;
	isprime[0]=isprime[1]=0;
	top=0;
	for(i=2;i<=n;i++)
	{
		if(isprime[i])
		{
			primes[top++]=i;
			for(j=2;i*j<=n;j++)
			{
				isprime[i*j]=0;
			}
		}
	}
	thold=100000000;
	/*for(i=0;i<10;i++)
	cout<<primes[i]<<" ";
	cout<<"\n";
	*/
	for(i=0;i<top;i++)
	{
		for(j=0;j<top;j++)
		{
			val=pow(primes[i],(primes[j])/2);
			if(val>n)
			break;
			mark[val]=1;
			//cout<<val<<"\n";
		}
	}
	cin>>t;
	while(t--)
	{
		cin>>a>>b;
		markprime(a,b,top);
		ans=0;
		for(i=a;i<=b;i++)
		{
			if(i!=1 && isprime[i-a] || rootmarked(i))
			ans++;
		}
		cout<<ans<<"\n";
	}
	return 0;
}