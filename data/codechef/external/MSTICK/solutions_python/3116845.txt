from math import log
import gc
gc.disable()

import sys
global mint
global maxt
global a

def maxquery(l,r,i,j,nd):
    if l == i and r == j:
        return maxt[nd]
    m = (l+r)/2
    if m >= j:
        return maxquery(l,m,i,j,2*nd + 1)
    elif m < i:
        return maxquery(m+1,r,i,j,2*nd + 2)
    else:
        return max(maxquery(l,m,i,m,2*nd + 1),maxquery(m+1,r,m+1,j,2*nd + 2))
    
def minquery(l,r,i,j,nd):
    if l == i and r == j:
        return mint[nd]
    m = (l+r)/2
    if m >= j:
        return minquery(l,m,i,j,2*nd + 1)
    elif m < i:
        return minquery(m+1,r,i,j,2*nd + 2)
    else:
        return min(minquery(l,m,i,m,2*nd + 1),minquery(m+1,r,m+1,j,2*nd + 2))
    


def setmax(l,r,i):
    if l == r:
        maxt[i] = a[l]
        return a[l]
    m = (l+r)/2
    lf = setmax(l,m,2*i + 1)
    rt = setmax(m+1,r,2*i + 2)
    
    maxt[i] = max(lf,rt)
    return maxt[i]

def setmin(l,r,i):
    if l == r:
        mint[i] = a[l]
        return a[l]
    m = (l+r)/2
    lf = setmin(l,m,2*i + 1)
    rt = setmin(m+1,r,2*i + 2)
    
    mint[i] = min(lf,rt)
    return mint[i]

n = int(raw_input())

a = map(int,sys.stdin.readline().split())

mint = []
maxt = []



hu = pow(2,int(log(n,2)+2))-1
mint = [0]*hu
maxt = [0]*hu

q = int(sys.stdin.readline())

u = setmax(0,n-1,0)
u = setmin(0,n-1,0)

for i in range(q):
    
    i,j = map(int,sys.stdin.readline().split())
    if i == 0:
        max1 = 0
    else:
        max1 = maxquery(0,n-1,0,i-1,0)
    max2 = maxquery(0,n-1,i,j,0)
    if j == n-1:
        max3 = 0
    else:
        max3 = maxquery(0,n-1,j+1,n-1,0)
        
    min2 = minquery(0,n-1,i,j,0)
   
    min2*=10
    max1*=10
    max2*=10
    max3*=10
    ans = min2 + max(max1,max3,(max2-min2)/2)

    print str(ans/10) + "." + str(ans%10)
