#include <bits/stdc++.h>

using namespace std;

void maketree(long long int arr[],long long int maxtree[],long long int mintree[],long int low,long int high,long int pos)
{
    if(low==high)
    {
        maxtree[pos]=arr[low];
        mintree[pos]=arr[low];
        return;
    }
    int mid=(low+high)/2;
    maketree(arr,maxtree,mintree,low,mid,2*pos+1);
    maketree(arr,maxtree,mintree,mid+1,high,2*pos+2);
    maxtree[pos]=max(maxtree[2*pos+1],maxtree[2*pos+2]);
    mintree[pos]=min(mintree[2*pos+1],mintree[2*pos+2]);
}

long long int rangemin(long long int mintree[],long int qlow,long int qhigh,long int low,long int high,long int pos)
{
    if(qlow<=low&&qhigh>=high)
        return mintree[pos];
    if(qlow>high||qhigh<low)
        return INT_MAX;
    long int mid=(high+low)/2;
    return min(rangemin(mintree,qlow,qhigh,low,mid,2*pos+1),rangemin(mintree,qlow,qhigh,mid+1,high,2*pos+2));
}

long long int rangemax(long long int maxtree[],long int qlow,long int qhigh,long int low,long int high,long int pos)
{
    if(qlow<=low&&qhigh>=high)
        return maxtree[pos];
    if(qlow>high||qhigh<low)
        return INT_MIN;
    long int mid=(high+low)/2;
    return max(rangemax(maxtree,qlow,qhigh,low,mid,2*pos+1),rangemax(maxtree,qlow,qhigh,mid+1,high,2*pos+2));
}

int main()
{
    int n,q;
    scanf("%d",&n);
    long long int arr[n];
    for(int i=0;i<n;i++)
        scanf("%lld",&arr[i]);
    long long int s=1;
    while(s<n)
        s<<=1;
    long long int minsegtree[2*s-1],maxsegtree[2*s-1];
    memset(minsegtree,INT_MAX,sizeof(minsegtree));
    memset(maxsegtree,INT_MIN,sizeof(maxsegtree));
    maketree(arr,maxsegtree,minsegtree,0,n-1,0);
    /*for(int i=0;i<n;i++)
        printf("%lld ",minsegtree[i]);
    for(int i=0;i<n;i++)
        printf("%lld ",maxsegtree[i]);*/
    scanf("%d",&q);
    while(q--)
    {
        int l,r;
        scanf("%d %d",&l,&r);
        long long int minnum=rangemin(minsegtree,l,r,0,n-1,0);
        long long int max1=rangemax(maxsegtree,0,l-1,0,n-1,0);
        double temp1=max1+minnum;
        long long int max2=rangemax(maxsegtree,l,r,0,n-1,0);
        double temp2=minnum+((double)max2-(double)minnum)/2;
        long long int max3=rangemax(maxsegtree,r+1,n-1,0,n-1,0);
        double temp3=max3+minnum;
        printf("%.1lf\n",max(temp1,max(temp2,temp3)));
    }
    return 0;
}
