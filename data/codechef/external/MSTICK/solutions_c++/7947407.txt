#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define INF 2000000000
int  arr[100005],STmin[400020],STmax[400020];
ll maxm(ll a,ll b)
{
      return (a>b)?a:b;
}
ll minm(ll a,ll b)
{
      return (a<b)?a:b;
}
void build(ll root,ll a,ll b)
{
      if(a==b)
      {
            STmin[root]=STmax[root]=arr[a];
         return;
      }
      ll mid=(a+b)>>1;
      ll p=root<<1;
      ll q=root<<1|1;
      build(p,a,mid);
      build(q,mid+1,b);
      STmax[root]=maxm(STmax[p],STmax[q]);
      STmin[root]=minm(STmin[p],STmin[q]);
      return;
}
ll querymin(ll root,ll a,ll b,ll i,ll j) //a i j b
{
      if(a>j||b<i)
            return INF;
      if(a>=i&&b<=j)
            return STmin[root];
      ll mid=(a+b)>>1;
      ll p=root<<1;
      ll q=root<<1|1;
      return minm(querymin(p,a,mid,i,j),querymin(q,mid+1,b,i,j));
}
ll querymax(ll root,ll a,ll b,ll i,ll j)
{
      if(a>j||b<i)
            return -INF;
      if(a>=i&&b<=j)
            return STmax[root];
      ll mid=(a+b)>>1;
      ll p=root<<1;
      ll q=root<<1|1;
      return maxm(querymax(p,a,mid,i,j),querymax(q,mid+1,b,i,j));
}
int main()
{
      int n,q;
      cin>>n;
      for(int i=0;i<n;i++)
            cin>>arr[i];
            build(1,0,n-1);
            cin>>q;
      while(q--)
      {
            ll a,b,m1,m2,mm;
            float ans;
            cin>>a>>b;
            ll mx=querymax(1,0,n-1,a,b);
            ll mn=querymin(1,0,n-1,a,b);
            m1=querymax(1,0,n-1,0,a-1);
            m2=querymax(1,0,n-1,b+1,n-1);
            mm=maxm(m1,m2);
            if(((float)mn+(float)(mx-mn)/(float)2)>((float)mn+mm))
                  ans=((float)mn+(float)(mx-mn)/(float)2);
            else
                  ans=((float)mn+mm);
            printf("%.1f\n",ans);
      }
      return 0;
}

