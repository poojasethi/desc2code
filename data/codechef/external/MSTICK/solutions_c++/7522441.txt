#include <bits/stdc++.h>
using namespace std;
 
typedef pair< int , int > pii;
typedef long long LL;
#define fr first
#define se second
#define EPS 1e-8
#define INF 10000*10000*10000LL
stringstream ss;
#define two(x) ( 1LL<<x )
LL mod = 1000000007LL;

/**************************Code****************************/

int a[17][1<<17], b[17][1<<17];
const int inf = 1000000000;

int Min( int l, int r )
{
	if( l+1 > r )
		return inf;
	int n = log2( r - l );
	return min( a[n][l], a[n][ r-two(n) ] );
}
int Max( int l, int r )
{
	if( l+1 > r )
		return -inf;
	int n = log2( r - l );
	return max( b[n][l], b[n][ r-two(n) ] );
}

int main()
{
	int n, q, l, r;
	scanf( "%d", &n );
	for( int i = 0 ; i < n ; i ++ )
		scanf( "%d", &a[0][i] ), b[0][i] = a[0][i];
	for( int i = 1 ; two(i) <= n ; i ++ )
		for( int j = 0 ; j+two(i) <= n ; j ++ )
		{
			a[i][j] = min( a[i-1][j], a[i-1][ j+two(i-1) ] );
			b[i][j] = max( b[i-1][j], b[i-1][ j+two(i-1) ] );
		}
	scanf( "%d", &q );
	while( q -- )
	{
		scanf( "%d%d", &l, &r );
		int mn = Min( l, r+1 );
		int mx = Max( l, r+1 );
		int in = mx + mn;
		int out = max( Max( 0, l ), Max( r+1, n ) ) + mn;
		if( 2*out > in )
			printf( "%d.0\n", out );
		else
			printf( "%d.%d\n", in/2,  ( in&1 ? 5 : 0 ) );
	}
	return 0;
}
