#include<bits/stdc++.h>
using namespace std;
int a[100001];
vector<pair<int,int> > st(400004);
void build(int ss,int se,int idx)
{
    if(ss==se)
    {
        st[idx].first=st[idx].second=a[ss];
        return;
    }
    int mid=(ss+se)/2;
    build(ss,mid,2*idx+1);
    build(mid+1,se,2*idx+2);
    st[idx].first=min(st[2*idx+1].first,st[2*idx+2].first);
    st[idx].second=max(st[2*idx+1].second,st[2*idx+2].second);
}
int minquery(int ss,int se,int qs,int qe,int idx)
{
    if(qs<=ss && qe>=se)
        return st[idx].first;
    if (qs>se || qe<ss || qs>qe)
        return INT_MAX;

        int mid=(ss+se)/2;
       return min(minquery(ss,mid,qs,qe,2*idx+1),minquery(mid+1,se,qs,qe,2*idx+2));

}
int maxquery(int ss,int se,int qs,int qe,int idx)
{
    if(qs<=ss && qe>=se)
        return st[idx].second;
    else if(qs>se || qe<ss || qs>qe)
        return INT_MIN;
    else
    {
        int mid=(ss+se)/2;
       return max(maxquery(ss,mid,qs,qe,2*idx+1),maxquery(mid+1,se,qs,qe,2*idx+2));
    }
}

int main()
{
    int t,n,i,l,r,q;
    double x,b,c,s,e,d;
    cin>>n;
    for(i=0;i<n;i++)
        cin>>a[i];
    cin>>q;
    build(0,n-1,0);

    while(q--)
    {
        cin>>l>>r;
        s=minquery(0,n-1,l,r,0);
        x=maxquery(0,n-1,0,l-1,0);
        b=maxquery(0,n-1,l,r,0);
        b=((b-s)*1.0)/2;
        c=maxquery(0,n-1,r+1,n-1,0);
        d=max(b,max(x,c));
        e=s+d;
        cout<<setprecision(1)<<fixed<<e<<endl;
    }
    return 0;
}
