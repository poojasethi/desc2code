#include<cstdio>
#include<iostream>
#include<cmath>
#include<climits>
using namespace std;
//temp = sqrt
//rn = elements in arr
int preprocess(int ** arr, int **arr2, int a[], int n)
{
      int rn = (int)sqrt(n)+2;
      int temp = rn-2;
      (*arr) = new int[rn];
      (*arr2) = new int[rn];
      for(int i=0; i<n; i+=temp)
      {
              int minn = INT_MAX;
              int maxx = INT_MIN;
              for(int j=0; j<temp && i+j<n; j++)
              {
                      if(a[i+j]<minn)
                                     minn = a[i+j];
                      if(maxx<a[i+j])
                                     maxx = a[i+j];
              }
              (*arr)[i/temp] = minn;
              (*arr2)[i/temp] = maxx;
      }
}
int getMin(int * minArr, int * a, int n, int temp, int l, int r)
{
    int sc = l/temp;//strating chunk
    int ei = r/temp;
    int ans = INT_MAX;
    for(int i=sc+1; i<ei; i++)
            if(minArr[i]<ans)
                   ans = minArr[i];
    while(l<=(sc+1)*temp && l<=r)
    {
            if(a[l]<ans)
                     ans =a[l];
            l++;
    }
    while(r>=ei*temp && r>=l)
    {
             if(a[r]<ans)
                     ans = a[r];
             r--;
    }
    return ans;
}
int getMax(int * minArr, int * a, int n, int temp, int l, int r)
{
    if(l>r)
           return 0;
    int sc = l/temp;//strating chunk
    int ei = r/temp;
    int ans = INT_MIN;
    for(int i=sc+1; i<ei; i++)
            if(minArr[i]>ans)
                   ans = minArr[i];
    while(l<=(sc+1)*temp && l<=r)
    {
            if(a[l]>ans)
                     ans =a[l];
            l++;
    }
    while(r>=ei*temp && r>=l)
    {
             if(a[r]>ans)
                     ans = a[r];
             r--;
    }
    return ans;
}
main()
{
      int n;
      scanf("%d", &n);
      int a[n];
      for(int i=0; i<n; i++)
      {
              scanf("%d", &a[i]);
              a[i] = a[i]*2;
      }
      int *minArr, *maxArr;
      preprocess(&minArr, &maxArr, a, n);

      
      int rn = (int)sqrt(n)+2;
      int temp = rn-2;      
      int q;
      scanf("%d", &q);
      while(q--)
      {
                int l, r;
                scanf("%d %d", &l, &r);
                int fb = getMin(minArr, a, n, temp, l, r);
                int fb2 = (getMax(maxArr, a, n, temp, l, r)-fb)/2;
                int fb3 = getMax(maxArr, a, n, temp, 0, l-1);
                int fb4 = getMax(maxArr, a, n, temp, r+1, n-1);
             //   cout<<fb<<" "<<fb2<<" "<<fb3<<" "<<fb4<<endl;
                int ans = (fb+max(fb2, max(fb3, fb4)));
                if(ans%2==0)
                            printf("%d.0\n", ans/2);
                //            cout<<ans/2<<".0"<<endl;
                else
                              printf("%d.5\n", ans/2);
                            //cout<<ans/2<<".5"<<endl;
      }
}
