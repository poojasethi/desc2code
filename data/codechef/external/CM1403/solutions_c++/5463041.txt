#include<iostream>
#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<cmath>
#include<map>
#include<algorithm>
#include<set>
#include<vector>
#include<limits.h>
#include<stack>
#include<queue>
using namespace std;
const double pi=acos(-1.0);
#define pb push_back
#define mk make_pair
#define eps 1e-9
#define ll long long
#define MOD 1000000007
#define scani(n) scanf("%d",&n);
#define rep(i,n) for(int i=0;i<n;i++)
#define repp(i,x,y) for(int i=x;i<y;i++)
#define drep(a) sort(a.begin(),a.end());a.erase(unique(a.begin(),a.end()),a.end());
#define print(v) rep(i,v.size())cout<<v[i]<<" ";cout<<endl;
#define printt(v) rep(i,v.size()){rep(j,v[0].size())cout<<v[i][j]<<" ";cout<<endl;}
#define scan(v,n)  rep(i,n)cin>>v[i];
#define scann(v,n,m) rep(i,n){rep(j,m)cin>>v[i][j];}
//vector < vector<int> > v(n,vector<int>(m,0));
int dp[1000005];
int twn[1000005];
int main()
{
 int t;
 scanf("%d",&t);
 while(t--)
 {
 	rep(i,1000005)
 	{
 		dp[i]=0;
 			
 	}
 	ll int h,m;
 	cin>>h>>m;
 	vector<int> house(h);
 	ll int src,dst;
 	rep(i,h)
 	{
 		cin>>house[i];
 	}
 	src=house[0];
 	dst=house[h-1];
 	ll int tn;
 	cin>>tn;
 	vector <ll int> town[tn+3];
 	ll int cn,idx,idy;
 	rep(k,tn)
 	{
 		cin>>idx>>idy;
 		for(int j=idx;j<=idy;j++)
 		{
 			town[k].pb(house[j]);
 			
 		}
 	
 	}
 	rep(i,town[0].size())
 		dp[town[0][i]]=1;
 /*rep(i,dst+1)
 	{
 		cout<<dp[i]<<" ";
 	}
 	cout<<endl;
 	*/
 	
 	
 for(ll int i=0;i<tn-1;i++)
 {
 	for(ll int j=0;j<town[i].size();j++)
 	{
 		for(ll int k=0;k<town[i+1].size();k++)
 		{
 			if(town[i+1][k] <= (town[i][j]+m))
 				dp[town[i+1][k]]+=dp[town[i][j]];
 		}
 	}
 }
 	ll int ans=0;
 	
 	rep(i,town[tn-1].size())
		ans+=dp[town[tn-1][i]];
		
		cout<<ans<<endl<<endl;
		
		/*	rep(i,dst+1)
 	{
 		cout<<dp[i]<<" ";
 	}*/
 	//cout<<endl;
 	
 }
 return 0;
}
