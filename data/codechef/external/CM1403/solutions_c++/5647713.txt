#include<iostream>
#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<cmath>
#include<queue>
#include<stack>
#include<map>
#include<algorithm>
#include<set>
#include<vector>
#include<limits.h>
using namespace std;
#define pb push_back
#define mk make_pair
#define scani(n) scanf("%d",&n);
#define ll long long
int dp[1004][1004],house[1004];
int main()
{
int t,a,m,n,i,st,j,en,k,kk,dest,src,ans,temp;
cin>>t;
while(t--)
{
cin>>a>>m;
for(i=0;i<a;i++)
{
cin>>house[i];
}
cin>>n;
memset(dp,-1,sizeof(dp));
vector<int> town[n+4];
for(i=0;i<n;i++)
{
cin>>st>>en;
for(k=st;k<=en;k++)
{
town[i].pb(house[k]);
}
}
for(k=0;k<town[0].size();k++)dp[0][k]=1;
/* for(i=0;i<n;i++)
{
for(k=0;k<town[i].size();k++)
{
cout<<town[i][k]<<" ";
}
cout<<endl;
}
*/	for(i=1;i<n;i++)
{
for(k=0;k<town[i].size();k++)
{
temp=0;
dest=town[i][k];
j=i-1;
for(kk=0;kk<town[j].size();kk++)
{
src=town[j][kk];
if(dest-src>m || dp[j][kk]==-1)
continue;
temp+=dp[j][kk];
}
if(temp==0)
temp=-1;
dp[i][k]=temp;
// cout<<dp[i][k]<<" ";
}
// cout<<endl;
}
i=n-1;
ans=0;
for(k=0;k<town[i].size();k++)
if(dp[i][k]!=-1)
ans+=dp[i][k];
cout<<ans<<endl;
}
 
return 0;
}