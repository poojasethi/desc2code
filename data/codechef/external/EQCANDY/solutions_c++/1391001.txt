#include<iostream>
#include<cstdio>
using namespace std;
typedef long long int LL;
int main()
{
  int t;
  LL a[100001];
scanf("%d",&t);
while(t--)
{
	int N;
	scanf("%d",&N);
	LL minn=1000000001,maxx=0;
   for(int i=1;i<=N;i++)
   {
         scanf("%lld",&a[i]);
         if(a[i]<minn) minn=a[i];
         if(a[i]>maxx) maxx=a[i];
   }
  LL result=0;
   while(minn<=maxx)
   {    
        LL mid=(minn+maxx)/2;
        LL curr=0; int flag=0;
        for(int i=1;i<=N;i++)
        {
            if(a[i]>=mid) curr+=a[i]-mid;
            else if(a[i]+curr>=mid) curr=a[i]+curr-mid;
            else
            {
                  maxx=mid-1;
                  flag=1;break;
            }
          //  cout<<mid<<" "<<curr<<" ";cout<<endl;
        }
         
        if(!flag)
        {
        result=mid;
        minn=mid+1;
        }
      //  cout<<"flag="<<flag<<"result="<<result<<endl;
   }
   printf("%lld\n",result);

}
  return 0;
}
