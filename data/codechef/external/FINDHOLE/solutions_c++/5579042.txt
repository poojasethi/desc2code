#include<bits/stdc++.h>
using namespace std;
 
#define LET(x, a)  __typeof(a) x(a)
#define TR(v, it) for(LET(it, v.begin()); it != v.end(); it++)
#define si(x) scanf("%d",&x)
#define F first
#define S second
#define PB push_back
#define MP make_pair
#define INF 1000000000
#define MOD 1000000007
#define SET(x,y) memset(x,y,sizeof(x));
#define LL long long int
#define ULL unsigned LL
#define PII pair<int, int>
 
LL req[103][203];
int vis[103];
int matched[203];
int n, m;
int iter = 3;
int dfs(LL lim, int cnode) {
    if (vis[cnode] == iter)
        return 0;
    vis[cnode] = iter;
    for (int i = 0; i < m + m; i++) {
        if (req[cnode][i] <= lim) {
            if (matched[i] == -1 || dfs(lim, matched[i])) {
                matched[i] = cnode;
                return 1;
            }
        }
    }
    return 0;
}
int match(LL lim) {
    int i;
    memset(matched, -1, sizeof(matched));
    int ret = 0;
    for (i = 0; i < n; i++) {
        iter++;
        ret += dfs(lim, i);
    }
    return ret;
}
int main() {
    LL c, k;
    int t, i, j;
    cin >> t;
    while (t--) {
        cin >> n >> m >> k >> c;
        for (i = 0; i < n; i++) {
            for (j = 0; j < m; j++)
                cin >> req[i][j];
            for (j = 0; j < m; j++) {
                req[i][j + m] = req[i][j] + c;
            }
        }
        LL lb = 0, ub = 1e18, mid, ans = -1;
        while (lb <= ub) {
            mid = (lb + ub) / 2;
            if (match(mid) >= k) {
                ans = mid;
                ub = mid - 1;
            } else {
                lb = mid + 1;
            }
        }
        cout << ans << endl;
    }
    return 0;
}

