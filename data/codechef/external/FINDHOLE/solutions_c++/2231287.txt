//Author: Aman Choudhary
#include <vector>
#include <list>
#include <map>
#include <set>
#include <queue>
#include <deque>
#include <stack>
#include <cmath>
#include <algorithm>
#include <functional>
#include <numeric>
#include <utility>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <cstring>
#include <climits>
#include <map>
#include <cassert>
#define mod  1000000007
#define PHI 1000000006
#define ull unsigned long long
#define ill long long int
#define pii pair<int,int>
#define pb(x) push_back(x)
#define F(i,a,n) for(i=(a);i<(n);++i)
#define FD(i,a,n) for(i=(a);i>=(n);--i)
#define FE(it,x) for(it=x.begin();it!=x.end();++it)
#define V(x) vector<x>
#define S(x) scanf("%d",&x)
#define S1(x) scanf("%llu",&x)
#define MaxN 201
using namespace std;

vector < vector <ill> > s;
vector <pair <int, int> > res;
ill n,m,k,xx;
bool kuhn (ill v, vector <bool> &used, vector <ill> &pair)
{
    if (used[v]) {
        return false;
    }
    ill i;
    used[v] = true;
    for (i = 0; i < s[v].size(); i++) {
        ill to = i;
        if (s[v][i] > xx) {
            continue;
        }
        if (pair[to] == -1 || kuhn (pair[to], used, pair)) {
            pair[to] = v;
            return true;
        }
    }
    return false;
}
ill check (ill n, ill k, ill x)
{
    xx = x;
    vector <ill> pair (k, -1);
    vector <bool> used (n, false);
    res.clear();
    ill i;
    for (i = 0; i < n; i++) {
        fill (used.begin(), used.end(), false);
        kuhn (i, used, pair);
    }
    ill sum=0;

    for (i = 0; i < k; i++) {
        if (pair[i] != -1) {
            res.push_back (make_pair (pair[i], i));
            sum++;
        }
    }
    return sum;
}

ill bin (ill l, ill r)
{
    if (r == l) {
        return l;
    }
    if (r-l == 1) {
        if (check (n, m, l) >= k) {
            return l;
        }
        return r;
    }

    ill s;
    s = (l+r)/2;
    s = check (n, m, s);
    if (s >= k) {
        return bin (l, (l+r)/2);
    }
    return bin ((l+r)/2 + 1, r);
}
int main()
{

  //  freopen ("input.txt", "r", stdin);
    ill t;
    S1 (t);

    while (t--) {
        ill c;
        S1 (n);
        S1 (m);
        S1 (k);
        S1 (c);
        ill i,j;


        s.clear();      s.resize (n);
        F (i, 0, n) {
            F (j, 0, m) {
                ill x;
                cin >> x;
                s[i].pb (x);
                x = x + c;
                s[i].pb (x);
            }
        }

        m = 2*m;
        ill rrr;
        rrr = 100000;

        cout << bin (1, rrr*rrr) << endl;
    }

    return 0;
}
