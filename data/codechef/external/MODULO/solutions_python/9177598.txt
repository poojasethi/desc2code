#include<bits/stdc++.h>
using namespace std;
#define lim 10000000+1
int ans(int n,int k)
{
	int r=0,p=k;
	while(k<=n)
	{
		r+=n/k;
		k*=p;
	}
	//cout<<n<<" "<<k<<" "<<r<<" opopo"<<endl;
	return r;
     
}
int an(int n,int h)
{
	int y=0;
	while(n%h==0)
	{
		n/=h;
		y++;
	}
	return y;
}
vector<int>v;
bool w[lim];
int main()
{   for(int i=2;i*i<lim;i++)
{
	if(w[i]==false)
	{
		for(int j=2*i;j<lim;j+=i)
		w[j]=true;
	}
}
for(int i=2;i<lim;i++)
{
	if(w[i]==false)
	v.push_back(i);
}
	int t;
	int n,k,res=1000000;
	cin>>t;
	while(t--)
	{ res=1000000;
	cin>>n>>k;
	for(int i=0;v[i]<=k;i++)
	
	{ //cout<<v[i]<<" pp"<<endl;
		if(k%v[i]==0)
		{
	           
	            res=min(res,ans(n,v[i])/an(k,v[i]));
	            
		}
}

	cout<<res<<endl;
	
}
}