t = int(raw_input())
for tt in range(t) :
    w = []
    n,m,k = [int(i) for i in raw_input().split()]
    for nn in range(n) :
        w.append([int(i) for i in raw_input().split()])
    p = w[n-1][0]
    j = n-2
    if m == 1 :
        j = n-2
        while j >= 0 :
            p += w[j][0]
            j = j-1
    else :
        r = 0
        while j>=0 :
            if r == 0 :
                if w[j][r] <= w[j][r+1] :
                    p += w[j][r]
                else :
                    p += w[j][r+1]
                    r = r + 1
            elif r == (m-1) :
                if w[j][r-1] <= w[j][r] :
                    p += w[j][r-1]
                    r = r - 1
                else :
                    p += w[j][r]
            else :
                x = min(w[j][r-1],w[j][r],w[j][r+1])
                p = p + x
                if w[j][r-1] == x :
                    r = r - 1
                elif w[j][r+1] == x :
                    r = r + 1
                     
            j -= 1 
    if p > k :
        print "No"
    else :
        print "Yes"