#include <iostream>
#include <cstdio>
#include <algorithm>
#include <vector>
#include <set>
#include <map>
#include <queue>
#include <stack>
#include <cmath>

using namespace std;

#define LL long long
#define ll long long
#define PB push_back
#define MP make_pair
#define sd(x) scanf("%d", &x)
#define sld(x) scanf("%lld", &x)
#define F first
#define S second
#define MAXN 500
#define INF 250000010
#define MOD 1000000007

LL powe(LL a, int b){
    if(b == 0)
        return 1;
    LL ans = powe(a, b / 2);
    ans *= ans;
    if(ans >= MOD){
        ans %= MOD;
    }
    if(b & 1) ans *= 2;
    return ans;
}

inline int solve();
int main(){
    int test = 1;
    //freopen("input.txt", "r", stdin);
    cin>>test;
    while(test--){
        solve();
    }
}
vector< pair<LL, LL> > v;
map<LL, LL> ma;
vector< pair<LL, LL> > v1;


inline int solve(){
    v.clear();
    ma.clear();
    v1.clear();
    int n, q;
    cin>>n>>q;
    LL x, y;
    for(int i = 1; i <= n;i++){
        cin>>x>>y;
        v.PB(MP(x, y)) ;
    }
    sort(v.begin(), v.end());
    for(int i = 0; i < v.size(); i++){

        int x = v1.size() - 1;
        if(x == -1) {
                v1.PB(v[i]);
                continue;
        }
            x = v1.size() - 1;
            if(v1[x].S >= v[i].F && v[i].S >= v1[x].S){
                v1[x].S = v[i].S;
            }
            else if(v[i].S <= v1[x].S){
                continue;
            }
            else{
                v1.PB(v[i]);
            }
    }
    for(int i = 0; i < v1.size(); i++){
        ma[v1[i].F] = v1[i].S;
    }
    map<LL, LL>::iterator it, it1, it2;
    for(int i = 1; i <= q; i ++){
        LL x;
        cin>>x;
        it = ma.lower_bound(x);
        if(it == ma.end()) it--;
        it1 = it;
        it2 = it;

        it1++;
        if(it1 == ma.end()) it1--;

        if(it2 != ma.begin()) it2--;
        bool bv = 1;
        if(x >= it->F && x <= it->S) bv = 0;
        if(x >= it1->F && x <= it1->S) bv = 0;
        if(x >= it2->F && x <= it2->S) bv = 0;
        if(bv) cout<<"YES"<<endl;
        else cout<<"NO"<<endl;
    }
}
