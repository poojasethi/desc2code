#include<bits/stdc++.h>
using namespace std;

bitset<1001> vis;
int ady[1001][1001];
bool use[2002];
int T,t,h,g,k,resp,match[1001];
pair<int,int > ch[1001],cg[1001];

void restart(){
    resp=0;
    vis.reset();
    for(int i=0;i<1001;i++){
        use[i]=use[1001+i]=false;
        match[i] = -1;

        for(int j=0;j<1001;j++)
            ady[i][j]=0;
    }
}
void graph(){
    for(int i=0;i<g;i++){
        for(int j=0;j<h;j++){
            if(abs(ch[j].first-cg[i].first)+abs(ch[j].second-cg[i].second)+abs(cg[i].first-k)+abs(cg[i].second-k) <= t)
                ady[i][j]=1;
        }
    }
}
bool path(int nd){
    for(int i=0;i<h;i++){
        if(ady[nd][i] != 1 || use[i])   continue;
        use[i] = true;

        if(match[i]==-1 || path(match[i])){
            match[i] = nd;
            return true;
        }
    }
    return false;
}
void matching(){
    for(int i=0;i<g;i++){
        for(int j=0;j<1001;j++) use[j] = false;

        if(path(i))  resp++;
    }
}

int main(){
    scanf("%d",&T);

    for(int z=1;z<=T;z++){
        restart();

        scanf("%d %d %d %d",&h,&g,&k,&t);
        for(int i=0;i<h;i++)    scanf("%d %d",&ch[i].first,&ch[i].second);
        for(int i=0;i<g;i++)    scanf("%d %d",&cg[i].first,&cg[i].second);

        graph();
        matching();
        printf("Case %d: %d\n",z,resp);
    }
}
