#include <bits/stdc++.h>

using namespace std;

#define lld long long
#define mod 1000000007
#define INF (int)1e9
#define s(n) scanf("%d", &n)
#define sc(n) scanf("%c", &n)
#define sl(n) scanf("%lld", &n)
#define sf(n) scanf("%f", &n)
#define ss(n) scanf("%s", n);
#define all(a) a.begin(), a.end()
#define pii pair<int, int>
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define sq(x) ((x)*(x))
#define mset(x,v) memset(x,v,sizeof(x))
#define PI 3.1415926535897932384626

vector<pii> host, guest;
vector<int> pr[500];
int matchl[500], matchr[500], vis[500];

int mbm(int u)
{
    if (vis[u] == 1)
        return 0;
    vis[u] = 1;
    for (int i = 0; i < pr[u].size(); i++) {
        if (matchr[pr[u][i]] < 0 || mbm(matchr[pr[u][i]])) {
            matchr[pr[u][i]] = u;
            matchl[u] = pr[u][i];
            return 1;
        }
    }

    return 0;
}

int main()
{
    int n, z = 1;
    s(n);

    while (n--) {

        int h, g, k, c, i, j, x, y;
        s(h), s(g), s(k), s(c);

        host.clear();
        guest.clear();

        for (i = 0; i < h; i++) {
            s(x), s(y);
            host.pb(mp(x, y));
        }

        for (i = 0; i < g; i++) {
            s(x), s(y);
            guest.pb(mp(x, y));
        }

        for (i = 0; i < h; i++) {
            pr[i].clear();
            for (j = 0; j < g; j++) {
                int tmp = abs(host[i].fi - guest[j].fi) + abs(host[i].se - guest[j].se) + (k - guest[j].fi + k - guest[j].se);
                if (tmp <= c)
                    pr[i].pb(j);
            }
        }

        mset(matchl, -1);
        mset(matchr, -1);
        int cnt = 0;
        for (i = 0; i < h; i++) {
            mset(vis, 0);
            if (mbm(i))
                cnt++;
        }

        printf("Case %d: %d\n", z++, cnt);
    }

    return 0;
}
