#include "bits/stdc++.h"
using namespace std;
#define v 100 
int a[v][v];

int mindistance( int dist[], bool sptset[])
{
	int min=INT_MAX, index;
	for (int i = 0; i < v; ++i)
	{
		if(sptset[i]==false && dist[i]<=min)
			min=dist[i], index=i;
	}
	return index;
}

int print( int dist[] )
{
	printf("Vertex Dist From Source\n");
	for (int i = 0; i < v; ++i)
	{
		printf("%d\t %d\n", i,dist[i]);
	}

}

void dij(int a[v][v], int src)
{
	int dist[v];
	bool sptset[v];

	for (int i = 0; i < v; ++i)
	{
		dist[i] = INT_MAX, sptset[i]=false;
	}
	dist[src]=0;
	for (int i = 0; i < v-1; ++i)
	{
		int u = mindistance(dist, sptset);
		sptset[u]=true ; 
		for (int j = 0; j < v; ++j)
		{
			if(!sptset[j] && a[u][j] && dist[u]!=INT_MAX 
				&& dist[u] + a[u][j] < dist[j])
				dist[j] = dist[u] + a[u][j];
		}
	}
	//print(dist);
	printf("%d\n", dist[99]);
}



int main()
{
	int a[100][100];
	cin.tie(0);
	int m,k,n,x,y;
	cin>>k;
	cin>>m>>n;
	for (int i = 0; i < 100; ++i)
	{
		for (int j = 0; j < 100; ++j)
		{
			a[i][j]=0;
		}
	}
	 for(int i=0;i<100;i++)
	 {
		for(int j=i+1;j<=k+i && j<100;j++)
			a[i][j]=1;
	 }
	for(int i=0 ; i<m+n; i++)
	{
		cin>>x>>y;
		a[x-1][y-1]=1;
	}
	
	dij(a,0);
	return 0;
}