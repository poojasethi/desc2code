#include<bits/stdc++.h>
#define INF 10000
#define max(a,b) ((a)>(b)?(a):(b))
#define s(a) scanf("%d",&a)
#define ss(a) scanf("%s",a);
using namespace std;
int t,n1,n2,k;
short dp[5005][5005][2][2];
char in1[5005];
char in2[5005];
int main()
{
	int i,j;
	s(t);
	while(t--)
	{
		s(n1);s(n2);s(k);
		ss(in1);ss(in2);
		if(k>min(n1,n2))
		{
			cout<<"-1\n";
			continue;
		}
		short f1,f2;			// 0 implies not used,1 used
		
		for(i=0;i<=n1;i++)
		for(j=0;j<=n2;j++)
		for(f1=0;f1<=1;f1++)
		for(f2=0;f2<=1;f2++)
		{
			if(i*j==0)
			{
				short ans = 0;
				if(i<k && f1==1 )ans=-INF;
				if(j<k && f2==1 )ans=-INF;
				dp[i][j][f1][f2]=ans;
				continue;
			}
			short ans=-INF;
			ans = max(ans,dp[i-1][j][f1][f2]);
			ans = max(ans,dp[i][j-1][f1][f2]);

			ans = max(dp[i-1][j][f1][f2],dp[i][j-1][f1][f2]);
			
			if(in1[i-1] == in2[j-1])
				ans = max(ans,dp[i-1][j-1][f1][f2]+1);
			if(f1==1 && i>=k)
			{
				ans = max(ans , dp[i-k][j][0][f2]);
			}
			if(f2==1 && j>=k)
			{
				ans = max(ans , dp[i][j-k][f1][0]);
			}
			dp[i][j][f1][f2]=ans;
		}
		cout<<dp[n1][n2][1][1]<<endl;
	}
	return 0;
}
