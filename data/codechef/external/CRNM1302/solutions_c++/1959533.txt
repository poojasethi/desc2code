#include<iostream>
#include<stdio.h>
#include<string.h>
#include<vector>
#include<algorithm>
#include<map>
#include<math.h>
#include<climits>
using namespace std;

int t, n, m, k;
long long c, arr[110][1100], temp;
long long pre[110][1100], dp[110][1100], lsum[1100], rsum[1100];

long long fun(int row, int left)
{
    if(left==0)
        return 0;
    if(((row+1)*m)<left)
        return INT_MAX;
    if((row==0)&&(left<=m))
        return pre[0][left];
    if(dp[row][left]==-1)
    {
        int temp3;
        temp3=min(m, left);
        temp3=min(temp3, k);
        long long temp4=INT_MAX;
        for(int i=0; i<=temp3; i++)
        {
            long long temp5=pre[row][i]+fun(row-1, left-i);
            temp4=min(temp4, temp5);
        }
        dp[row][left]=temp4;
    }
    return dp[row][left];
}

int main()
{
	scanf("%d",&t);
    while(t--)
    {
        c=0;
        scanf("%d%d%d",&n,&m,&k);
        for(int i=0; i<n; i++)
        {
            for(int j=0; j<m; j++)
            {
                scanf("%lld",&arr[i][j]);
            }
        }
        temp=(m<k)?m:k;
        for(int i=0; i<n; i++)
        {
            lsum[0]=0;
            rsum[0]=0;
            for(int j=0; j<m; j++)
                lsum[j+1]=arr[i][j]+lsum[j];
            for(int j=m-1; j>=0; j--)
                rsum[m-j]=arr[i][j]+rsum[m-j-1];
            pre[i][0]=0;
            for(int j=1; j<=temp; j++)
            {
                long long mini=INT_MAX;
                for(int k=0; k<=j; k++)
                {
                    long long temp2=lsum[k]+rsum[j-k];
                    if(temp2<mini)
                        mini=temp2;
                }
                pre[i][j]=mini;
            }
        }
//        for(int i=0; i<n; i++)
//        {
//            for(int j=0; j<=m; j++)
//                printf("%d  ",pre[i][j]);
//            printf("\n");
//        }
        int temp6=max(m,k);
        for(int i=0; i<=n; i++)
            for(int j=0; j<=temp6; j++)
                dp[i][j]=-1;
        long long ans=fun(n-1, k);
//        for(int i=0; i<n; i++)
//        {
//            for(int j=0; j<=m; j++)
//                printf("%d  ",dp[i][j]);
//            printf("\n");
//        }
        printf("%lld\n", ans);
    }
	return 0;
}
