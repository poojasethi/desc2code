#include<iostream>
#include<stdio.h>
#include<cstring>
using namespace std;
int main()
{
int tc;
scanf("%d",&tc);
for(int g=0;g<tc;g++)
{
int k;
scanf("%d",&k);
int a[k];
for(int h=0;h<k;h++)
{
scanf("%d",&a[h]);
}
string s;
cin>>s;
int protien;
scanf("%d",&protien);
string mat[protien+1][s.length()+1];
for(int j=0;j<=s.length();j++)
{
mat[0][j]="";
}
for(int j=0;j<=protien;j++)
{
mat[j][0]="";
}
//cout<<mat[protien][0]<<endl;

for(int i=1;i<=s.length();i++)
{
for(int w=1;w<=protien;w++)
{
string a1=mat[w][i-1];
//cout<<"w: "<<w<<" i: "<<i<<" a1: "<<a1;
int x=s[i-1]-'a';
int z=a[x];
//cout<<" w-z: "<<w-z;
if(w-z<0)
{
mat[w][i]=a1;//cout<<endl;
continue;
}
string a2=mat[w-z][i-1];
//cout<<" a2: "<<a2;
int temp=s[i-1]-'a';
if(a2=="" && (a[temp])!=w)
{
mat[w][i]=a1;//cout<<endl;
continue;
}
string a3=a2+s[i-1];
//cout<<" a3: "<<a3;
//cout<<endl;
if(a1=="" || a3<a1)
mat[w][i]=a3;
else
mat[w][i]=a1;
}
}
//cout<<mat[][0]<<endl;
/*for(int y=0;y<=s.length();y++)
{
for(int x=0;x<=protien;x++)
{
cout<<mat[x][y]<<" : ";
}cout<<endl;
}*/
if(mat[protien][s.length()]=="")
printf("IMPOSSIBLE\n");
else
cout<<mat[protien][s.length()]<<endl;
}
return 0;
}
