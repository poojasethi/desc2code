    #include<iostream>
    #include<cstdio>
    using namespace std;
     
    int main()
    {string dp[501];
    int n;
    scanf("%d",&n);
    for(int o=0;o<n;o++)
    {
    int k;
    scanf("%d",&k);
     
    int a[k];
    for(int i=0;i<k;i++)
    scanf("%d",&a[i]);
     
    string t;
    cin>>t;//scanf("%s",t);
     
    int req;
    scanf("%d",&req);
     
    for(int i=0;i<=req;i++)
    dp[i]="";
     
    dp[a[t[0]-'a']]+=t[0];
     
    for(int i=1;i<t.size();i++)
    {
    int val=a[t[i]-'a'];
    for(int j=req-val;j>=0;j--)
    {
    if(dp[j]!=""||j==0)
    {
    string A=dp[j]+t[i];
    if(dp[val+j]==""||A<dp[val+j])
    dp[val+j]=A;
    }
    }
    }
     
    if(dp[req]!="")
    cout<<dp[req]<<"\n";
    else
    printf("IMPOSSIBLE\n");
     
     
    }
    return 0;
    } 