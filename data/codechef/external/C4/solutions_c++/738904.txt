#include <stdio.h>
#include <string>
#include <string.h>
using namespace std;

/*
 * MAY 09 : Healthy dinner party - C4
 */
int main()
{
	int t,i;
	scanf("%d", &t);
	for(i=0; i<t; i++)
	{
		int k, s, index, a[26];
		char input[1001];
		string D[501], str;
		int j, l;
		scanf("%d", &k);
		for(j=0; j<k; j++)
			scanf("%d", &a[j]);
		scanf("%s",input);

		for(j=0; j<strlen(input); j++)
		{
			for(l=500;l>=0;l--)
			{
				if(l==0 || D[l].size())
				{
					index = a[input[j]-'a']+l;
					if(index>500)
						continue;
					str = D[l]+input[j];
					if(D[index].empty() || D[index]>str)
						D[index] = str;
				}
			}
		}
		
		scanf("%d", &s);
		if(D[s].empty())
			printf("IMPOSSIBLE\n");
		else
			printf("%s\n", D[s].c_str());
	}
	return 0;
}
