#include <cstdio>
#include <cstring>
#include <string>
#include <vector>

using namespace std;

const int MAX=1001;
int vals[26];
char buffer[MAX];
vector<string > dp(501);

int main()
{
    int T, G, K, i, j, v;
    vector<string>::iterator itr;
    scanf("%d\n", &T);
    while(T-->0)
    {
        memset(vals, 0, sizeof(int) * 26);
        for(itr=dp.begin(); itr!=dp.end(); itr++)
            (*itr).clear();

        scanf("%d", &K);
        for(i=0; i<K; i++)
            scanf("%d", &vals[i]);
        scanf("%s", buffer);
        for(i=0; buffer[i]; i++)
            for(j=500; j>=1; j--)
            {
                if ((v=(j-vals[buffer[i]-'a'])) == 0 || (v > 0 && dp[v] != dp[0]))
                {
                    string tmp = dp[v];
                    tmp.push_back(buffer[i]);
                    if ((dp[j] == dp[0]) || tmp < dp[j])
                        dp[j] = tmp;
                }
            }

        scanf("%d", &G);
        if (dp[G] != dp[0])
            printf("%s\n", dp[G].c_str());
        else
            printf("IMPOSSIBLE\n");
    }
    return 0;
}
