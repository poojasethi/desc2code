#include <stdio.h>
#include <iostream>
#include <map>
#include <string>

#define minS(s1, s2) (s1<s2)?s1:s2

using namespace std;

map<char, int> protein;

string dp[1004][504];

string ingredients;
int total;
int n;

string findSeq(int i, int c )
{
    //cout<<"i, c "<<i <<", "<<c<<endl;
    if( c == 0)
    {
        dp[i][c] = "";
        return dp[i][c];
    }

    if(  i >= n )
    {
		//cout<<"IN"<<endl;
        dp[i][c] = "|";
        return dp[i][c];
		//cout<<"OUT"<<endl;
    }


	//cout<<"protein "<<protein[ingredients[i]]<<endl;
    if( protein[ingredients[i]] > c )
    {
		//cout<<"IN P"<<endl;
        if(  dp[i][c] == "" )
        {
            dp[i+1][c] = findSeq(i+1, c);
            
        }
        return dp[i+1][c];
        
    }
    else
    {
        int value = c - protein[ingredients[i]];

        
        if( dp[i+1][c]  == "")
        {	
            dp[i+1][c] = findSeq(i+1, c);
            
        }
        if( dp[i+1][ value]  == "" )
        {
			
            dp[i+1][value] = findSeq(i+1, value );
		}
		
        if(dp[i+1][value] == "|")
            return dp[i+1][c];
        else
            return minS(dp[i+1][c], ingredients[i] + dp[i+1][value]);

        


    }






}








int main()
{
    int notest,  val;

    string s1 = "bbc", s2 = "a";
    string s3 = minS(s1, s2);
    //cout<<s3<<endl;

    //cout<<"------------"<<endl;
    scanf("%d", &notest);
    for(int test=0; test<notest; test++)
    {
		
		
        scanf("%d", &n);
        char ingr = 'a';
        for(int i =0; i<n; i++)
        {
            scanf("%d", &val);
            protein[ingr] = val;
            ingr++;
        }
        cin>>ingredients;
        scanf("%d", &total);

        n = ingredients.length();

		for(int i=0; i<=n+5; i++)
			for(int j=0; j<=total+5; j++)
				dp[i][j] = "";
				
        string res = findSeq(0, total);
		
		if(res == "|")
			cout<<"IMPOSSIBLE"<<endl;
		else
			cout<<res<<endl;
			
			




    }




}
