#include<cstdio>
#include<cstring>
#include<iostream>
using namespace std;
#define MAXN 1001
int t,n,i,j,protein[27],pos[MAXN],need,len_seq;
char ing_seq[MAXN];  string ans[MAXN],tmp_str;
void get()
{
    for(i=0;i<n;i++)scanf("%d",&protein[i]);
	scanf("%s",ing_seq); len_seq=strlen(ing_seq);
    scanf("%d\n",&need);

    for(i=0;i<=need;i++)pos[i]=0;    pos[0]=1;     ans[0]="";
}
int main()
{
	scanf("%d",&t);
	while(t--)
	{
	scanf("%d",&n);
	get();
    for(i=0;i<len_seq;i++)
    {
       int val=protein[ing_seq[i]-'a'];
       for(j=need-val;j>=0;j--)
       {
          if(pos[j])
          {
            tmp_str=ans[j]+ing_seq[i];
            if(!pos[j+val]||ans[j+val]>tmp_str)ans[j+val]=tmp_str;
            pos[j+val]=1;
          }
       }
    }
   if(!pos[need])  printf("IMPOSSIBLE\n");
    else           cout<<ans[need]<<endl;
    }
return 0;
}
