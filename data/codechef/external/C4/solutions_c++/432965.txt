#include<iostream>
#include<stdio.h>
#include<string.h>
#include<math.h>
#include<stdlib.h>
#include<malloc.h>
#include<vector>
#include<algorithm>
#include<stack>
#include<queue>
#include<list>
#include<string>


#define min(a,b) (a>b?b:a)
#define max(a,b) (a>b?a:b)
typedef long long LL;
using namespace std;

vector<int> val;


int main()
{
    //freopen("input.txt","r",stdin);
    int t;
    cin>>t;
    while(t--){
        int k;
        cin>>k;
        val.clear();
        for(int i=0;i<k;i++){
            int x;
            cin>>x;
            val.push_back(x);
        }
        string inp;
        cin>>inp;
        int S;
        cin>>S;
        k=0;
        string dp[500];
        for(int i=0;i<inp.length();i++){
            int size=val[inp[i]-'a'];
            for(int j=S-size;j>=0;j--){
                if(j!=0 && dp[j].length()==0)
                    continue;
                string temp=dp[j]+inp[i];
                if(dp[j+size].length()==0)
                    dp[j+size]=temp;
                else
                    dp[j+size]=min(dp[j+size],temp);
            }
        }
        if(dp[S].length()!=0)
            cout<<dp[S]<<endl;
        else
            cout<<"IMPOSSIBLE\n";
    }

}
