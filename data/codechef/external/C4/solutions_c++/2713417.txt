// THIS TEMPLATE BELONGS TO
//  CODERSAN(SKS)
//  www.codechef.com/users/codersan
//  www.facebook.com/sks.kira
//  CODERSAN(SKS)


#include<iostream>
#include<map>
#include<functional>
#include<string>
#include<cstring>
#include<bitset>
#include<cstdlib>
#include<queue>
#include<utility>
#include<fstream>
#include<sstream>
#include<stack>
#include<cstdio>
#include<ctime>
#include <vector>
#include <algorithm>
#include <cmath>

using namespace std;
#define gc getchar_unlocked
#define MEM(a,b) memset(a,(b),sizeof(a))
#define FOR(i,n) for(int i=(0);i<(n);i++)
#define CLEAR(a) memset((a),0,sizeof(a))
#define pb push_back
#define ll long long int
#define md 1000000007
#define swap(a,b) Swap(&a,&b)
#define bigger(a,b) {a>b?a:b}
#define smaller(a,b) {a<b?a:b}
#define S(N) scanf("%d",&N);
#define P(N) printf("%d",N);



// FAST IO
//--------------------------------------------------------------------------------------------------------


#define GETCHAR getchar_unlocked
#define PUTCHAR putchar_unlocked

inline int fastRead_int()
{
        int noRead=0;
        char p=getchar_unlocked();
        for(; p<33;) {
                p=getchar_unlocked();
        };
        while(p>32) {
                noRead = (noRead << 3) + (noRead << 1) + (p - '0');
                p=getchar_unlocked();
        }
        return noRead;
};


inline void fastRead_string(char *str)
{
    register char c = 0;
    register int i = 0;
    while (c < 33)
        c = getchar_unlocked();
    while (c != '\n') {
        str[i] = c;
        c = getchar_unlocked();
        i = i + 1;
    }
}


    inline void fastLongInput(long int &x) {
    register int c = getchar();
    x = 0;
    int neg = 0;
    for(; ((c<48 || c>57) && c != '-'); c = getchar());
    if(c=='-') {
        neg = 1;
        c = getchar();
    }
    for(; c>47 && c<58 ; c = getchar()) {
        x = (x<<1) + (x<<3) + c - 48;
    }
 if(neg)
        x = -x;
        }




inline void writeInt(int x)
{
     if(x==-1)
     {
              PUTCHAR('-');
              PUTCHAR('1');
              PUTCHAR('\n');
     }
     else
     {
       int i = 10;
       char buf[11];
      // buf[10] = 0;
      buf[10] = '\n';

     do
     {
        buf[--i] = x % 10 + '0';
        x/= 10;
     }while(x);
     do
     {
        PUTCHAR(buf[i]);
     } while (buf[i++] != '\n');
     }
}



//--------------------------------------------------------------------------------------------------------


//--------------------------------------------------------------------------------------------------------

// CODE BEGINS HERE:


char seq[10005];
int a[50];
int dp[600];
int main()
{
   int i, j, len, T, t, num, maxval,p;
   //scanf("%d",&T);
   T=fastRead_int();
   while(T--)
   {
      //scanf("%d",&num);
      num=fastRead_int();
      for(i=0;i<num;i++)
        a[i]=fastRead_int();//scanf("%d",&a[i]);
      cin>>seq;
      //scanf("%d",&maxval);
      maxval=fastRead_int();
      len = strlen(seq);
      vector<string> v(maxval+1);
      memset(dp,0,sizeof(dp));
      dp[0] = 1;
      string answer = "";
      for(i=0;i<len;i++)
      {
         p = a[seq[i]-'a'];
         for(j=maxval-p;j>=0;j--)
           {
            if(dp[j])
            {
               dp[j+p] = 1;
               if(v[j+p]=="" || v[j+p]>v[j]+seq[i])
                  v[j+p]=v[j]+seq[i] ;
            }
           }
            if(v[maxval]!="" && (answer== "" || v[maxval]<answer))
             {
                answer = v[maxval];
             }
      }
      if(answer!="")
         cout<<answer<<endl;
      else
         puts("IMPOSSIBLE");


   }
   return 0;
}
