#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <cstring>
#define min(a,b) (a>b?b:a)
using namespace std;
const char fi[] = "C4.INP";

char s[1005];
int S;
int ctn[26];
int k;
string dp[505];

int main()
{
    int T;
    int i,j;
    int len;
    int vi;
    string temp;
    //freopen(fi, "r", stdin);
    scanf("%d",&T);
    while (T--)
    {
        scanf("%d", &k);
        for (i=0;i<k;i++) scanf("%d", &ctn[i]);
        scanf("%s", s);
        scanf("%d", &S);
        for (i=0;i<=S;i++) dp[i].clear();

        len = strlen(s);
        //memset(dp, 0, sizeof(dp));
        for (i=0;i<len;i++)
        {
            vi = ctn[s[i]-'a'];
            for (j=S-vi;j>=0;j--)
            {
                if (j!=0 && dp[j].length() == 0) continue;
                temp = dp[j]+s[i];
                if (dp[j+vi].length() == 0) dp[j+vi] = temp;
                else dp[j+vi] = min(dp[j+vi], temp);
            }
        }
        if (dp[S].length() != 0) printf("%s\n", dp[S].c_str());
        else printf("IMPOSSIBLE\n");
    }
    return 0;
}
