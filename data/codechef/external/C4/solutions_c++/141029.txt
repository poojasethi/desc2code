#include <cstdio>
#include <cstring>
#include <string>
using namespace std;

int dp[501][1001];
string sol[501][1001];
int vals[26];

char seq[1005];
int N, L;

int numIngredientes;

int main()
{
    for(int i=0; i<501; i++) dp[i][0]=0;
    for(int j=0; j<1001; j++) dp[0][j]=0;
    
    int T;
    scanf("%d",&T);
    
    for(int tt=0; tt<T; tt++) 
    {
        scanf("%d",&numIngredientes);
        for(int i=0;i<numIngredientes;i++)
            scanf("%d",&vals[i]);
        
        scanf("%s",seq+1);
        L=strlen(seq+1);
        
        for(int i=1; i<=L; i++)
            seq[i]-='a';    
        
        scanf("%d",&N);
        
        
        for(int i=1; i<=N; i++) {
            for(int j=1; j<=L;j++) {
                dp[i][j]=0;
                if(vals[seq[j]]<=i) {
                    int op1 = dp[i][j-1];
                    int op2 = dp[i-vals[seq[j]]][j-1]+vals[seq[j]];
                    if(op1 > op2) {
                        dp[i][j]=op1;
                        sol[i][j]=sol[i][j-1];
                    }
                    else if(op2 > op1) {
                        dp[i][j]=op2;
                        sol[i][j]=sol[i-vals[seq[j]]][j-1] + char(seq[j]+'a');
                    }
                    else {
                        dp[i][j]=op1;
                        sol[i][j] = min(sol[i][j-1], sol[i-vals[seq[j]]][j-1] + char(seq[j]+'a'));
                    }
                }
                else {
                    dp[i][j] = dp[i][j-1];
                    sol[i][j]=sol[i][j-1];
                }
            }
        }
        if(dp[N][L]<N) {
            printf("IMPOSSIBLE\n");
        } 
        else {
            printf("%s\n",sol[N][L].c_str());
        }
    } 
}
