#include<iostream>
#include<string>
#include<cstring>
#include<cstdio>
#include<map>
#include<algorithm>
using namespace std;

#define FOR(i,a,b) for(int i=a; i<=b; ++i)
#define REP(i,n) for(int i=0; i<n; ++i)

string ans[501];
char str[1001];
int cost[26];

int main() {
    int test,n;
    scanf("%d",&test);

    while(test--) {
        scanf("%d",&n);
        REP(i,n)
            scanf("%d",&cost[i]);

        scanf("%s", str);

        int tot;
        scanf("%d",&tot);

        FOR(i,0,tot){
            ans[i] = "";
        }

        for(int j = 0; str[j]; j++){
            int c = cost[str[j]-'a'];
            for(int i = tot-c; i >= 0; --i){
                if(i != 0 && ans[i].empty()) continue;
                if(ans[i+c].empty()){
                    ans[i+c] = ans[i] + str[j];
                }
                else{
                    string thisStr = ans[i] + str[j];
                    if(thisStr < ans[i+c]){
                        ans[i+c] = thisStr;
                    }
                }
            }

        }

        if(ans[tot].empty()){
            printf("IMPOSSIBLE\n");
            continue;
        }

        printf("%s\n", ans[tot].c_str());
    }
    return 0;
}

