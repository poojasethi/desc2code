#include <iostream>
#include <stdio.h>
#include <fstream>
#include <math.h>
#include <string.h>
#include <algorithm>
#include <vector>
#include <set>
using namespace std;
 
#define bit(n) (1<<(n))
#define inf 1000000000
#define eps 1e-9
#define pb push_back
#define sz size()
#define mp make_pair
#define cl clear()
#define all(a) a.begin(),a.end()
#define fill(ar,val) memset(ar,val,sizeof ar)
#define MIN(a,b) if(a>b) a=b
#define MAX(a,b) if(a<b) a=b
#define sqr(x) ((x)*(x))
#define min(a,b) (((a)<(b))?(a):(b))
#define max(a,b) (((a)>(b))?(a):(b))
 
typedef vector<long> VL;
typedef pair<long,long> PLL;
//typedef __int64 long long;

#define L 1011
char s[L];
long n;
long w[26];
char f[L][L/2];//0 - not visited, 1 - impossible, 2 - sum=0
 
char F(long i,long sum)
{
	if(sum<0) return 1;
	if(f[i][sum]) return f[i][sum];
	if(sum==0) return f[i][sum]=2;
	if(i==n) return 1;
	char ans=1;
	if(F(i+1,sum-w[s[i]-'a'])>1) ans=s[i];
	char c=F(i+1,sum);
	if(c>1 && (ans==1 || c<ans)) ans=c;
	return f[i][sum]=ans;
}
 
int main()
{
	#ifndef ONLINE_JUDGE
	freopen("in.txt","r",stdin);
	#endif
	long T;
	for(scanf("%d",&T);T>0;T--)
	{
		long k,i;
		scanf("%d",&k);
		for(i=0;i<k;i++) scanf("%d",&w[i]);
		scanf("%s",s);
		n=strlen(s);
		long sum;
		scanf("%d",&sum);
		fill(f,0);
		char c=F(0,sum);
		if(c==1) printf("IMPOSSIBLE\n"); else
		{
			for(i=0;c>2;)
			{
				printf("%c",c);
				for(;i<n && s[i]!=c;i++);
				sum-=w[s[i]-'a'];
				i++;
				c=F(i,sum);
			}
			printf("\n");
		}
	}
	return 0;
}