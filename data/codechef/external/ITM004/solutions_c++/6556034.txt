#include<bits/stdc++.h>
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define p(n) printf("%d\n",n)
#define mod 1000000007LL
#define ll long long
#define pb push_back
#define mp make_pair
#define N 100011
#define LN 21
using namespace std;
int bit[2*N],maxval,bit1[2*N],maxval1,bit2[2*N],bit3[2*N];
ll powmod(ll a,ll b,ll c)
{
 ll res=1LL;
 while(b>0)
 {
  if(b&1)
  res=(res*a)%c;
  a=(a*a)%c;
  b/=2;
 }
 return res;
}
ll inverse(ll a,ll MOD)
{
if(a==0)
return 1LL;
else
return powmod(a,MOD-2,MOD);
}
void update(int idx,int val)
{
 while(idx<=maxval)
 {
  bit[idx]+=val;
  idx+=(idx & -idx);
 }
}
int query(int idx)
{
 int sum=0;
 while(idx>0)
 {
   sum+=bit[idx];
   idx-=(idx & -idx);
 }
 return sum;
}
ll fact[400005];
int lc[400005],lc1[400005];

ll ncr(int n,int r)
{
 ll num=fact[n];
 ll den=(fact[r]*fact[n-r])%mod;
 ll ans=(num*inverse(den,mod))%mod;
 return ans;
}
int main()
{
int i,t,n;
fact[0]=fact[1]=1;
for(i=2;i<=400000;++i)
fact[i]=(fact[i-1]*i)%mod;
cin>>t;
while(t--)
{
 string s1;
 cin>>s1>>n;
 if(n==1)
 {
  int an=0;
  for(i=0;i<s1.length();++i)
  if(s1[i]=='o')
  an++;
  cout<<an<<endl;
 }
 else
 {
  int l=n/2;
  if(s1[0]=='l')
  lc[0]=1;
  else
  lc[0]=0;
  for(i=1;i<s1.length();++i)
  {
   lc[i]=lc[i-1];
   if(s1[i]=='l')
   lc[i]++;
  }
  int len=s1.length();
  assert(len<=400000);
  if(s1[len-1]=='l')
  lc1[len-1]=1;
  else
  lc1[len-1]=0;
  for(i=len-2;i>=0;--i)
  if(s1[i]=='l')
  lc1[i]=lc1[i+1]+1;
  else
  lc1[i]=lc1[i+1];
  ll ans=0;
  for(i=0;i<len;++i)
  {
   if(s1[i]=='u')
   {
    if((lc[i]>=l) && (lc1[i]>=l))
    ans+=(ncr(lc[i],l)*ncr(lc1[i],l));
    assert(ans>=0);
    ans%=mod;
   }
  }
  cout<<ans<<endl;
 }
}
return 0;
}
