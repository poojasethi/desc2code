#include <bits/stdc++.h>
using namespace std;
 
#define ll long long
#define mod 1000000007
#define m 10005
ll p,q;
ll powr(ll a,ll b)
{
	ll x =1,y=a;
	while(b)
	{
		if(b&1)
		{
			x=(x*y)%mod;
		}
		y=(y*y)%mod;
		b/=2;
	}
	return x;
}
ll inv(ll a)
{
	return powr(a,mod-2);
}
 
ll sum1(ll a,ll n,ll k)
{
	return ((((powr(10,n-k-1)*((9*((powr(10,k)*(n%mod))%mod)	+9*((k-n)%mod) +10-powr(10,k+1))%mod))%mod+mod)%mod)*p)%mod;
}
ll sum2(ll a,ll n,ll k)
{	if(k==1)
	{
		return 0;
	}
	return ((((powr(10,n-k)*((((powr(10,k)-(9*k)%mod-1)%mod)+mod)%mod))%mod+mod)%mod)*p)%mod;
	
}
ll ssum(ll a,ll b,ll k)
{	if(b!=k)
	{
		return ((k%mod)*a+(((a*(a-1))/2 )*((((powr(10,b-k)*(powr(10,k)-1))%mod)*q)%mod))%mod+45*a*sum1(a,b,k)+a*a*sum2(a,b,k))%mod;
	}
	else
	{
		return (ssum(a,b,k-1) + (a*(a+1))/2 + a*a*((b-1)%mod))%mod;
	}
}
ll ans(ll A[m][2],int M,ll len)
{	ll sum=0,SUM=0;
	ll l = len;
	for(int i = 0;i<M;i++)
	{
		SUM=(SUM + ssum(A[i][1],len,A[i][0]))%mod;
 
		
		ll z =(((sum*(A[i][1]*(((powr(10,A[i][0])-1)*q)%mod+mod)%mod)%mod)%mod)*(powr(10,len-A[i][0])))%mod;
		len-=A[i][0];
		SUM+=z;
		SUM%=mod;
		sum+=((A[i][0])%mod*A[i][1])%mod;
		sum%=mod;
		
	}
	return SUM;
}
int main()
{	p = inv(81);
	q=inv(9);
	ll A[m][2];
	int t;
	
	cin>>t;

	while(t--)	
	{
		int M ;
		cin>>M;
		
		ll len = 0;
		for(int i = 0;i<M;i++)
		{
			scanf("%lld%lld",&A[i][0],&A[i][1]);

			len+=A[i][0];
		}
		
		printf("%lld\n",ans(A,M,len));
	}
	return 0;
} 