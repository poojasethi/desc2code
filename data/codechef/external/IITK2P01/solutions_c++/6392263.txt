//Md. Ahsan Kabir Shohagh
#include<bits/stdc++.h>
using namespace std;
#define sz 10005
#define pb(a) push_back(a)
#define ll long long
#define ull unsigned long long
#define fread freopen("input.txt","r",stdin)
#define fwrite freopen("output.txt","w",stdout)
#define inf (1<<29)
#define mem(abc,z) memset(abc,z,sizeof(abc))
#define PI acos(-1)

int main(){
   int t;
   ll n,k,ans,coin[sz];
   cin>>t;
   while(t--){
     cin>>n>>k;
     if(k==1LL) ans=n;
     else {
        coin[0]=1LL;
        ans=0LL;
        int i=1;
        for(i=1;coin[i-1]*k<=n;i++){
           coin[i]=coin[i-1]*k;
           //cout<<coin[i]<<endl;
        }
        //cout<<i<<endl;
        for(int j=i-1;j>=0 && n>0LL;j--){
           if(n>=coin[j]){
              ans+=(n/coin[j]);
              n-=((n/coin[j])*coin[j]);
           }
           if(n==1LL) ans++,n=0LL;
        }
     }
     cout<<ans<<endl;
   }
   return 0;
}
