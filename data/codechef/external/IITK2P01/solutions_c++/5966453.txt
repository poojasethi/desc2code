#include<stdio.h>
#include<iostream>
#include<math.h>
#include<algorithm>
#include<string.h>
#include<vector>

using namespace std;
typedef long long ll;

#define S(x) scanf("%lld",&x)
#define P(x) printf("%lld\n",x)
#define SARR(_A,_N) for(ll _Z=0; _Z<_N; _Z++) \
scanf("%lld",&_A[_Z])
#define PARR(_A,_N) for(ll _Z=0; _Z<_N; _Z++) \
printf("%lld ",_A[_Z]); \
printf("\n")
long long po(long long n,long long l)
{

    if(l==0) return 1;
    if(l==1) return n;
    long long p;
    if(l%2==0)
    {
        p=po(n,l/2);
        p=(p*p);
        return p;
    }
    else
    {
       p=po(n,l/2);
        p=(p*p);
        p=(p*n);
        return p;
    }

}

int main()
{
ll t;
S(t);
while(t--)
{
ll n,k,s,count=0,p,d;
S(n);
S(k);
while(n!=0)
{
s=(ll)ceil(log(n)/log(k));
if((ll)po(k,s)==n)
{
n=0;
count++;
}
else
{
s--;
p=(ll)po(k,s);
d=n/p;
n=n-d*p;
count+=d;
}
}
P(count);
}
return 0;
}
