#include <bits/stdc++.h>
using namespace std;

#define INF 1000000007

typedef long long ll;
typedef unsigned long long ull;
typedef vector<int> vi;
typedef vector<ll> vll;
typedef vector<vector<int> > vvi;
typedef pair<int,int> ii;
typedef vector<pair<int,int> > vii;
typedef vector<vector<pair<int,int> > > vvii;

#define all(x) x.begin(), x.end()
#define tr(x,it) for(auto it = x.begin();it!=x.end();++it)
#define ntr(x,it) for(auto it = x.rbegin();it!=x.rend();++it)
#define sz(a) int((a).size()) 
#define pb push_back 
#define PB pop_back
#define pf push_front
#define PF pop_front
#define MP make_pair
#define fpresent(c,x) ((c).find(x) != (c).end())  // set,map
#define present(c,x) (find(all(c),x) != (c).end())  //vector
#define F first
#define S second
#define FOR(i,a,b) for(int i=a;i<=b;++i)
#define NFOR(i,a,b) for(int i=a;i>=b;--i)
#define TCASE int __T;cin>>__T;while(__T--)
#define rz resize
#define endl "\n"
#define clr clear
#define boost ios_base::sync_with_stdio(false);cin.tie(0);cout.tie(0)
#define rep(i,a) FOR(i,0,a-1)
#define mod 10000007
vvi matmul(vvi x, vvi y, int k)
{
    vvi temp;
    temp.rz(k);
    rep(i,k)temp[i].rz(k);
    rep(i,k)
    {
        rep(j,k)
        {
            rep(a,k)
            {
            	temp[i][j]+= ((ll)(x[i][a])*(ll)(y[a][j]))%mod ;
            	if(temp[i][j]>=mod)temp[i][j]-=mod;
            }
        }
    }
    return temp;
}
vvi po(vvi x, ll a,int k)
{
	if(a==1)return x;
	vvi temp;
	temp.rz(k);
	rep(i,k)temp[i].rz(k);
	temp=po(x,a/2,k);
	if(!(a&1))return matmul(temp,temp,k);
    else
        return matmul(matmul(temp,temp,k),x,k);
}

int main()
{
    boost;
    TCASE{
    int k;
    ll n;
    cin>>n>>k;
    
    if(k==0)
    {
    	if(n==1)
    	{
    		cout<<1<<"\n";
    		continue;
    	}
    	vvi a(2);
    	a[0].rz(2);a[1].rz(2);
    	
    	a[0][0]=1,a[0][1]=1,a[1][0]=1,a[1][1]=0;
    	vvi mt=po(a,n+1,2);
    	
    	cout<<mt[0][0]<<"\n";
    	continue;
    	
    }
    
    vvi a(2*k);
    FOR(i,0,2*k-1)a[i].rz(2*k);
    
    FOR(i,0,2*k-1)
    {
    	
    	if(i<k) a[i][i+k]++;
    	else a[i][i]++; 
    	
    	a[i][k+(i+1)%k]++;
    	
    	if(i>=k)	a[i][i-k]++;
    	
    }
    
    vvi mt1=po(a,n,2*k);
   
   
    
    ll ans=0;
    FOR(i,0,2*k-1)	{if(i%k==0)ans+=mt1[k][i];	if(ans>=mod)ans-=mod;}
    
     FOR(i,0,2*k-1){a[i].clear();a[i].rz(2*k);}

    
    FOR(i,0,2*k-1)
    {
    	
    	
    	a[i][k+(i+1)%k]++;
    	
    	if(i>=k)	a[i][i-k]++;
    	
    }
    vvi mt2=po(a,n,2*k);
    
    
     
    FOR(i,0,2*k-1)	{if(i%k==0)ans-=mt2[k][i];	if(ans<0)ans+=mod;}
    
    cout<<ans<<"\n";
    
    }
	return 0;
}
