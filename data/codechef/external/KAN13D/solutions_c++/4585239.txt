#include<iostream>
#define MOD 1000000007
using namespace std;
long long int mat[101][101];
long long int res[101][101];
long long int f[101];
long long int delta[101];
void mul(long long int a[101][101],long long int b[101][101],int m)
{
int i,j,k;
long long int temp[101][101];
   for(i=0;i<m;i++)
   {
 for(j=0;j<m;j++)
  {
  temp[i][j] = 0;
    for(k=0;k<m;k++)
   {
     temp[i][j] = (temp[i][j] + (a[i][k]*b[k][j]))%MOD;
     if(temp[i][j]<0)
     temp[i][j]+=MOD;
    }
   }
   }
   for(i=0;i<m;i++)
  {
   for(j=0;j<m;j++)
  {
   a[i][j] = temp[i][j];
   }
  }
  }
long long int fn(long long int m,long long int n)
{
 		long long int i,j,k;
 		for(i=0;i<m;i++)
 		{
		 	for(j=0;j<m;j++)
		 	{
		 	if(i==j)
		 	res[i][j]=1;
		 	else
		 	res[i][j]=0;
		 	}
		 }
		 for(i=0;i<m;i++)
		 {
 			for(j=0;j<m;j++)
 			{
 				if(i==0)
 				{
				 mat[i][j]=delta[m-1-j];	
				 }
				 else
				 {
			 	if(i-1==j)
			 	mat[i][j]=1;
			 	else
			 	mat[i][j]=0;
				 }
			 }
 		}
 		n=n-(m-1);
 		while(n)
 		{
		 if(n&1)
        {
            mul(res,mat,m);
        }
        mul(mat,mat,m);
        n=n>>1;	
 		}
		 long long int ans=0;
         for(i=0;i<m;i++)
         {
         	ans=(ans+(res[0][i]*f[m-1-i]))%MOD;
         }
 		return (ans+MOD)%MOD;
}
int main()
{
	long long int t,n,m,i;
	cin>>t;
	while(t--)
	{
	cin>>m>>n;
	 for(i=0;i<m;i++)
	 {
	 	cin>>f[i];
	 	f[i]=(f[i]+MOD)%MOD;
	 }
	 for(i=0;i<m;i++)
	 {
 		cin>>delta[i];
 	}
 	 if(n<m)
 	 cout<<(f[n]+MOD)%MOD<<endl;
 	 else
 	  cout<<fn(m,n)<<endl; 
	}
	return 0;
	
}