#include <iostream>
#include <vector>
#include <cstdio>
using namespace std;
long long int MOD=1000000007;
long long int mod(long long int a)
{
//	if (a<0) 
//	{
//		cout<<a<<endl;
//		return a+(long long)MOD;
//	}
	return (a%MOD+MOD)%MOD;
}

long long int a[101][101],re[101][101],b[101],te[101][101];
int m;
void print(long long int a[101][101])
{
	int i,j;
	for (i=0;i<m;i++)
	{
		for (j=0;j<m;j++)
		{
			cout<<a[i][j]<<" ";
		}
		cout<<endl;
	}
	cout<<endl;
}
void matrixmult()
{
	int i,j,k;
	long long int t;
	for (i=0;i<m;i++)
	{
		for (j=0;j<m;j++)
		{
			t=0;
			for (k=0;k<m;k++)
			{
				t+=(re[i][k]*a[k][j]);
				t=mod(t);
			}
			te[i][j]=t;
		}
	}
	for (i=0;i<m;i++)for (j=0;j<m;j++) re[i][j]=te[i][j];
}

void matrixsq()
{
	int i,j,k;
	long long int t;
//	print(a);
//	cout<<endl;
	for (i=0;i<m;i++)
	{
		for (j=0;j<m;j++)
		{
			t=0;
			for (k=0;k<m;k++)
			{
//				if (i==0&&j==2) cout<<t<<endl;
				t+=(a[i][k]*a[k][j]);
				t=mod(t);
			}
			te[i][j]=t;
		}
	}	
	for (i=0;i<m;i++)for (j=0;j<m;j++) a[i][j]=te[i][j];
//	cout<<endl;
}
void pow(long long int ex)
{
	int i,j;
	for (i=0;i<m;i++)
	{
		for (j=0;j<m;j++)
		{
			re[i][j]=0;
		}
		re[i][i]=1;
	}

	while (ex)
	{
//		print(re);
//		print(a);

		if (ex%2)
		{
			matrixmult();
		}
		matrixsq();
//		print(a);
		ex/=2;
	}
//	print(re);
//		print(a);
}
inline void read(int &a)
{
    register int c;
    a = 0;
    do c = getchar_unlocked(); while(c < '0');
    do{
    a = (a << 1) + (a << 3) + c - '0';
    c = getchar_unlocked();
    }while(c >= '0');
}

inline void readint(long long int &a)
{
    register long long int c;
    a = 0;
    do c = getchar_unlocked(); while(c < '0');
    do{
    a = (a << 1) + (a << 3) + c - '0';
    c = getchar_unlocked();
    }while(c >= '0');
}
     
inline void printint(long long int a)
{
    char s[21];
    int t = -1;
    do{
    s[++t] = a % 10 + '0';
    a /= 10;
    }while(a > 0);
    while(t >= 0)putchar_unlocked(s[t--]);
    putchar_unlocked('\n');
}

int main()
{
	long long int n,x,y;
	int i,t,j;
	scanf("%d",&t);
	while (t--)
	{
//		cin>>m;
//		m=2;
		read(m);
		readint(n);
		for (i=0;i<m;i++)
		{
//			readint(b[i]);
			scanf("%lld",&b[i]);
		}
//		b[0]=1;
//		b[1]=2;
		for (i=0;i<m-1;i++)
		{
			for (j=0;j<m;j++)
			{
				a[i][j]=0;
				if (j==i+1) a[i][j]=1;
			}
		}
		for (j=0;j<m;j++)
		{
			readint(a[m-1][j]);
//			scanf("%lld",&a[m-1][m-1-j]);
		}
//		a[1][0]=1;
//		a[1][1]=1;
	//	cin>>n;
	//	readint(n);
	//	n--;
		if (n==0)
		{
//			cout<<b[i]<<endl;
//			printf("%lld\n",mod(b[n]));
			printint(mod(b[n]));
		}
		else
		{
			pow(n);
			long long int ans=0;
			for (i=0;i<m;i++)
			{
				ans+=re[0][i]*b[i];
				ans=mod(ans);
			}
		//	printf("%lld\n",ans);
			printint(ans);
		}
	}
}