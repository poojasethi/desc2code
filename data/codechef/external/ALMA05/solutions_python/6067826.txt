/**
	Author: Shuvojit
	Time:2015-02-02-15.16
	Comment:
**/
#include<bits/stdc++.h>
#include<stack>
#include<queue>
#include<vector>
#include<set>
#include<map>
#define ll long long
using namespace std;
ll n,m;
ll a[33][33];
ll H[33][33];
ll V[33][33];
ll DP[33][33][33][33];
inline ll rec(int tr,int br,int lc,int rc,int d)
{
    //cout<<"tr :"<<tr<<" br: "<<br<<"lc: "<<lc<<" rc: "<<rc<<endl;

    if(tr>br || lc>rc)
        return 0;
    else if(DP[tr][br][lc][rc]!=-1)
    {
        return DP[tr][br][lc][rc];
    }
    else
    {
        ll tr_sum,br_sum,lc_sum,rc_sum;
        tr_sum=br_sum=lc_sum=rc_sum=0;

        if(tr+1<=br)
        {
            tr_sum=(H[tr][rc]-((lc==0)?0:H[tr][lc-1]))*d+rec(tr+1,br,lc,rc,d+1);
        }
        else tr_sum=(H[tr][rc]-((lc==0)?0:H[tr][lc-1]))*d;
        //cout<<"tr_sum: "<<tr_sum<<endl;

        if(br-1>=tr)
        {
           br_sum=(H[br][rc]-((lc==0)?0:H[br][lc-1]))*d+rec(tr,br-1,lc,rc,d+1);
        }
        else br_sum=(H[br][rc]-((lc==0)?0:H[br][lc-1]))*d;
          //cout<<"br_sum: "<<br_sum<<endl;

        if(lc+1<=rc)
        {
            lc_sum=(V[br][lc]-((tr==0)?0:V[tr-1][lc]))*d+rec(tr,br,lc+1,rc,d+1);
        }
        else lc_sum=(V[br][lc]-((tr==0)?0:V[tr-1][lc]))*d;
        //cout<<"lc_sum: "<<lc_sum<<endl;

        if(rc-1>=lc)
        {
            rc_sum=(V[br][rc]-((tr==0)?0:V[tr-1][rc]))*d+rec(tr,br,lc,rc-1,d+1);
        }
        else rc_sum=(V[br][rc]-((tr==0)?0:V[tr-1][rc]))*d;
          //cout<<"rc_sum: "<<rc_sum<<endl;

        
        //cout<<"trsum"<<tr_sum<<" brsum "<<br_sum<<"lcsum "<<lc_sum<<"rc_sum "<<lc_sum<<endl;
        DP[tr][br][lc][rc]=max(tr_sum,max(br_sum,max(lc_sum,rc_sum)));
        return  DP[tr][br][lc][rc];
    }
}
int main()
{
	ll T;
	scanf("%lld",&T);
	while(T--)
	{
        scanf("%lld%lld",&n,&m);
        for(int i=0;i<n;i++)
        {
            ll sum=0;
            for(int j=0;j<m;j++)
            {
                  scanf("%lld",&a[i][j]);
                  sum+=a[i][j];
                  H[i][j]=sum;
            }
        }

        for(int i=0;i<m;i++)
        {
            ll sum=0;
            for(int j=0;j<n;j++)
            {
                  sum+=a[j][i];
                  V[j][i]=sum;
            }
        }

        memset(DP,-1,sizeof DP);


        /*cout<<endl;
        for(int i=0;i<n;i++)
        {
            for(int j=0;j<m;j++)
                cout<<H[i][j]<<"   ";
            cout<<endl;
        }
        for(int i=0;i<n;i++)
        {
            for(int j=0;j<m;j++)
                cout<<V[i][j]<<"   ";
            cout<<endl;
        }*/

        printf("%lld\n",rec(0,n-1,0,m-1,1));
	}
	return 0;
}
