// waMachine
#include <bits/stdc++.h>
using namespace std;
typedef long long int ll;
const int mod = 1e9+7;
ll dp[33][33][33][33];
int arr[33][33];
ll E[33][33],F[33][33];
inline ll solve_top(int pos,int l,int r,int d){
  return d*(E[pos][r]-E[pos][l-1]);
}
inline ll solve_bot(int pos,int l,int r,int d){
  return d*(E[pos][r]-E[pos][l-1]);
}
inline ll solve_lft(int pos,int l,int r,int d){
 return d*(F[r][pos]-F[l-1][pos]);
}
inline ll solve_rgt(int pos,int l,int r,int d){
 return d*(F[r][pos]-F[l-1][pos]);
}
ll solve(int rt,int rb,int cl,int cr,int d){
  //cout << rt << " " << rb << " " << cl << " " << cr << endl;
  if(rt>rb || cl>cr) return 0;
  if(dp[rt][rb][cl][cr] != -1) return dp[rt][rb][cl][cr];
  ll a = solve_top(rt,cl,cr,d) + solve(rt+1,rb,cl,cr,d+1);
  ll b = solve_bot(rb,cl,cr,d) + solve(rt,rb-1,cl,cr,d+1);
  ll c = solve_lft(cl,rt,rb,d) + solve(rt,rb,cl+1,cr,d+1);
  ll e = solve_rgt(cr,rt,rb,d) + solve(rt,rb,cl,cr-1,d+1);
  ll res = max(max(max(a,b),c),e);
  dp[rt][rb][cl][cr] = res;
  return res;
}
int main(){
  //freopen("qns.txt","r",stdin);
  //freopen("ans.txt","w",stdout);
  int t,n,m;
  scanf("%d",&t);
  while(t--){
   memset(dp,-1,sizeof dp);
   scanf("%d %d",&n,&m);
   for(int i=1;i<=n;i++){
    for(int j=1;j<=m;j++){
      scanf("%d",&arr[i][j]);
    }
   }
   for(int i=1;i<=n;i++){
    for(int j=1;j<=m;j++){
      E[i][j] = E[i][j-1] + arr[i][j];
      F[i][j] = F[i-1][j] + arr[i][j];
    }
   }
   ll ans = solve(1,n,1,m,1);
   printf("%lld\n",ans);
  }
  return 0;
} 