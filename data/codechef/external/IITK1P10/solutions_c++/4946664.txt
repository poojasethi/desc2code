#include<iostream>
#include<stdio.h>
#include<stdlib.h>
#include<string>
#include<string.h>
#include<vector>
#include<map>
#include<algorithm>
#include<limits.h>
#include<set>
#include<stack>
#include<list>
#include<queue>
#include<math.h>
 
using namespace std;
#define lli long long int
#define ulli unsigned long long int
#define in(t) scanf("%d",&t)
#define inlf(t) scanf("%lf",&t)
#define inl(t) scanf("%ld",&t)
#define inll(t) scanf("%lld",&t)
#define inlu(t) scanf("%llu",&t)
#define MOD 1000000007
 
int visited[100001];
lli dp[100001],ans;
vector<vector<int> > v(100001);
 
void bfs(int start)
{
    int i,j,temp;
    visited[start]=1;
    deque<int> q;
    q.push_back(start);
    if(dp[start]==0)
    ans++;
    while(!q.empty())
    {
    //cout<<"Enter\n";
    j=q.front();
    q.pop_front();
    //cout<<"front queue ka "<<j<<"\n";
    
    
    for(i=0;i<v[j].size();i++)
    {   
    temp=v[j][i];
    //cout<<"temp="<<temp<<"\n";
    //cout<<temp<<" ";
    if(visited[temp]==0)
    {
    if(dp[temp]==0)
    ans++;
    q.push_back(temp);
    visited[temp]=1;
    }
    }
    //cout<<"\n";
    }
}
 
 
int main()
{
    int n,q,x,y,z,i;
    char ch;
    lli num,val;
    in(n);
    in(q);
    for(i=0;i<n-1;i++)
    {
    in(x);
    in(y);
    x--;
    y--;
    v[x].push_back(y);
    //v[y].push_back(x);
    }
    
    for(i=0;i<n;i++)
    {
    in(num);
    dp[i]=num;
    }
    
    while(q--)
    {
    getchar();
    scanf("%c",&ch);
    if(ch=='U')
    {
    in(z);
    z--;
    inll(val);
    dp[z]=val;
    }
    
    else if(ch=='Q')
    {
    ans=0;
    in(z);
    z--;
    bfs(z);
    printf("%lld\n",ans);
    //system("pause");
    }
    
    }
    
    return 0;
}