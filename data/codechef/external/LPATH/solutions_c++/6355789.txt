#include<iostream>
#include<cstdio>
#include<cmath>
#include<cstring>
#include<stdlib.h>
#include<algorithm>
#define getcx getchar_unlocked
#define pc(x) putchar_unlocked(x);
#ifndef ONLINE_JUDGE
    #define getcx getchar
#endif
using namespace std;
#define ull unsigned long long int
#define lli long long int
#define li long int
#define ii int
#define mod 1000000007
ii A[201][201];
ii b[201][201];
ii mark[201][201];
ii d[] = {-1,0,1};
ii n,m;

inline ii dfs ( ii i, ii j, ii k )
{
	ii val=0;
	for ( ii p=0;p<3;p++ )
	{
		for ( ii q=0;q<3;q++ )
		{
			if ( i+d[p]>=0 && i+d[p]<n && j+d[q]>=0 && j+d[q]<m )
			{
				if ( A[i+d[p]][j+d[q]]==k+1 )
					val = max(val,dfs(i+d[p],j+d[q],k+1));
			}
		}
	}

	return val+1;

}

ii main() {
	//your code goes here
	ii t,i,j,ans;

	cin>>t;
	while(t--)
	{
		cin>>n>>m;
		for ( i=0;i<n;i++ )
			for ( j=0;j<m;j++ )
				cin>>A[i][j];

		ans=0;
		for ( i=0;i<n;i++ )
		{
			for ( j=0;j<m;j++ )
			{
				if ( A[i][j]==0 )
				{
					ans = max(ans,dfs(i,j,0));
					//memset(mark,0,sizeof(mark));
				}
			}
		}
		printf("%d\n",ans);

	}
	return 0;
}
