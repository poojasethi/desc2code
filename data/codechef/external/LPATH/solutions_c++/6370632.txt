#include<bits/stdc++.h>
using namespace std;
#define l 405
int r,c,maxi=-1;
int v[l][l];
int a[l][l];
int f[8][2]={{1,0},{0,1},{-1,0},{0,-1},{1,1},{-1,1},{-1,-1},{1,-1}};
void find(int q,int x,int y)
{
	int j;
	v[x][y]=1;
	if(q>maxi)
	maxi=q;
	for(j=0;j<8;j++)
		{
			 int X=x+f[j][0];
			int Y=y+f[j][1];
			
			if(X>=0&&Y>=0&&X<r&&Y<c&&a[X][Y]==q+1&&v[X][Y]==0)
			{
				
				
				find(q+1,X,Y);
				
			}
		}
		return;
}
int main()
{
	int t,i,j,x,y;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%d %d",&r,&c);
		for(i=0;i<r;i++)
		{
			for(j=0;j<c;j++)
			{
				scanf("%d",&a[i][j]);
				
				v[i][j]=0;
			}
		}
			for(i=0;i<r;i++)
			{
				for(j=0;j<c;j++)
				{
					if(a[i][j]==0)
					find(0,i,j);
				}
		}
		printf("%d\n",maxi+1);
		maxi=-1;
		//hello
	}

}