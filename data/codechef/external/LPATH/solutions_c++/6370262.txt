#include<stdio.h>
#define max(a,b) a>b?a:b
//vector<int>adj[];
int ma;
int a[205][205];
int n,m;
void dfs(int i,int j,int ans)
{
    ans++;
    ma=max(ma,ans);
    if(i>=1&&j>=1&&(a[i-1][j-1]==a[i][j]+1))
    {
        dfs(i-1,j-1,ans);
    }
    if((i>=1)&&(a[i-1][j]==a[i][j]+1))
    {
        dfs(i-1,j,ans);
    }
    if((i>=1)&&(j+1<n)&&(a[i-1][j+1]==a[i][j]+1))
    {
        dfs(i-1,j+1,ans);
    }
    if((j+1<n)&&(a[i][j+1]==a[i][j]+1))
    {
        dfs(i,j+1,ans);
    }
    if((i+1<m)&&(j+1<n)&&(a[i+1][j+1]==a[i][j]+1))
    {
        dfs(i+1,j+1,ans);
    }
    if((i+1<m)&&(a[i+1][j]==a[i][j]+1))
    {
        dfs(i+1,j,ans);
    }
    if((i+1<m)&&(j-1>=0)&&(a[i+1][j-1]==a[i][j]+1))
    {
        dfs(i+1,j-1,ans);
    }
    if((j-1>=0)&&(a[i][j-1]==a[i][j]+1))
    {
        dfs(i,j-1,ans);
    }
}
int main()
{
int t;
scanf("%d",&t);
while(t--)
{
scanf("%d",&m);
scanf("%d",&n);
ma=0;
 for(int i=0;i<m;i++)
 {
     for(int j=0;j<n;j++)
     {
         scanf("%d",&a[i][j]);
     }
 }
 int ans;
for(int i=0;i<m;i++)
{
    for(int j=0;j<n;j++)
    {
        ans=0;
        if(a[i][j]==0)
        {
            dfs(i,j,ans);
        }
    }
}
printf("%d\n",ma);
}
return 0;
}
