#include<bits/stdc++.h>
using namespace std;
 
#define fOr(i,n) for(int i=0;i<n;i++)
#define For(i,n) for(int i=1;i<=n;i++)
#define ss(a) scanf("%s",a)
#define si(a) scanf("%d",&a)
#define sl(a) scanf("%lld",&a)
#define pi(a) printf("%d",a)
#define pl(a) printf("%lld ",a)
#define ps(a) printf("%s ",a)
#define nl printf("\n")
#define ll long long int
#define ull unsigned long long int
#define MOD 1000000007
#define INF INT_MAX
#define two(X) (1<<(X))
#define twoL(X) (((int64)(1))<<(X))
#define contain(S,X) (((S)&two(X))!=0)
#define containL(S,X) (((S)&twoL(X))!=0)
#define imax numeric_limits<int>::max()
#define imin numeric_limits<int>::min()
#define lmax numeric_limits<ll>::max()
#define lmin numeric_limits<ll>::min()
const double eps=1e-9;
const double PI=2*acos(0.0);
#define pb(a) push_back(a)
#define mp(a,b) make_pair(a,b)

int dp[250][250] , arr[250][250];int R , C ;

int dx[8] = { 0 , 1 ,-1 , 1 ,  0 , -1 , 1 , -1 };
int dy[8] = { 1 , 0 , 0 ,-1 , -1 ,  1 , 1  ,-1 };

int inside(int r , int c)
{
	if( r >= 0 && r < R && c >= 0 && c < C )
	return 1;
	return 0 ;
}

int f(int r , int c )
{   
	int &ret = dp[r][c] ;
	if( ret == -1 )
	{
		ret = 1 ;
		for(int i = 0 ; i < 8 ; i++ )
		{
			int x = r + dx[i] ;
			int y = c + dy[i] ;
			if( inside( x, y ) && ( arr[x][y] == ( arr[r][c] + 1 ) ))
			{  
			   ret = max( ret , f( x , y )  + 1 ) ;
			}
		}
	}
	return ret ;
}

int main()
{
	int t;
	si(t);
	while(t--)
	{
		cin >> R >> C ;
		for(int i = 0 ; i < R ; i++ )
		{
			for(int j = 0 ; j < C ; j++ )
			{
				cin >> arr[i][j] ;
			}
		}
		int ans ;
		memset(dp , -1 , sizeof(dp));int ma = 0 ;
		for(int i = 0 ; i < R ; i++ )
		{
			for(int j = 0 ; j < C ; j++ )
			{
				if( arr[i][j] == 0 )
				{
					ma = max( ma , f(i , j) ) ;
				}
			}
		}
		pi(ma);nl;
	}
	return 0 ; 
}
