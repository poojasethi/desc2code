#include <bits/stdc++.h>
using namespace std;
#define lli long long int
static lli A[10000000];
lli func(lli n,lli p)
{
	if(n==0) return 1;
	lli num=n/p;
	lli val=p*num;
	lli ans=A[n-val];
	/*for(lli i=val+1;i<=n;i++)
		ans=(ans*(i%p))%p;*/
	if(num%2!=0) ans=0-ans;
	while(ans<p) ans+=p;
	ans=ans%p;
	return (ans*func(num,p))%p;
}
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		lli n,p;
		scanf("%lld%lld",&n,&p);
		lli ans=1;
		for(int i=1;i<p;i++)
		{
			ans=(ans*i);
			ans%=p;
			A[i]=ans;
		}
		cout<<func(n,p)<<"\n";
	}
	return 0;
}