#include <cstdio>

using namespace std;
typedef long long LONG;

int main()
{
	int t;
	scanf("%d", &t);

	while (t--)
	{
		LONG n, p;
		scanf("%lld%lld", &n, &p);
		LONG res = 1;
		while (n > 0)
		{
			LONG q = n / p;
			if (q % 2 == 1)
				res *= p - 1;
			LONG rem = n % p;

			for (int i = 1; i <= rem; i++)
			{
				res *= i;
				res %= p;
			}
			n = q;
		}
		printf("%lld\n", res);
	}
	return 0;
}