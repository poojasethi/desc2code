#include <bits/stdc++.h>
using namespace std;
#define ll unsigned long long
ll powm(ll a, ll b, ll m) {
	ll i = a, k=1ll;
	while(b) {
		if(b&1) k = (k*i) % m;
		i = (i*i) % m;
		b >>= 1;
	}
	return k;
}

ll fac(ll n, ll p)
{
	ll ret = 1;
	for(int i = 1;i<=n;i++)
	{
		ret=(ret*i)%p;
	}
	return ret;
}
ll fact(ll n, ll p)
{
	if(n<=p/2)
	{
		return fac(n,p);
	}
	ll x = p-1-n;
	ll ret = fac(x,p);
	if(x&1)
	{
		ret=p-ret;
	}
	return ((p-1)*powm(ret,p-2,p))%p;
}
ll ans(ll n, ll p)
{	ll ret = 1;
	ll a = n/p,b=n%p;
	ret = fact(b,p);
		if(a==0)
	{
		return ret;
	}
	if(a&1)
	{
		ret = (p-ret);
	}
	return (ret*ans(a,p))%p;
}
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		ll n,p;
		cin>>n>>p;
		cout<<ans(n,p)<<endl;
	}
	return 0;
}