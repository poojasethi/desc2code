#include <iostream>
using namespace std;

typedef long long int ll;

ll arr[10000007],p;

ll power(ll a,ll b)
{
	if(b==0)	return 1;
	ll ans=power(a,b>>1);
	ans=(ans*ans)%p;
	if(b&1)
		ans=(ans*a)%p;
	return ans;
}

ll work(ll n,ll p)
{
	ll ans,x,y,z;
	if(n<p)	return arr[n];
	x=power(arr[p-1],n/p);
	y=arr[n%p];
	z=work(n/p,p);
	ans=(x*y)%p;
	ans=(ans*z)%p;
	return ans;
}

int main() {
	int test,i;
	ll n;
	arr[0]=1;
	scanf("%d",&test);
	while(test--)
	{
		scanf("%lld%lld",&n,&p);
		if(p==1)
		{
			cout<<1<<endl;
			continue;
		}
		arr[1]=1;
		for(i=2;i<p;i++)
			arr[i]=(arr[i-1]*i)%p;
		cout<<work(n,p)<<endl;
	}
	return 0;
}