#include<cstdio>
using namespace std;
#define MAX 10000010
long long fact[MAX],p;
long long mypow(long long base,long long exp)
{
	if(exp==0)
		return 1;
	if(exp==1)
		return base;
	if(base==1)
		return 1;
	long long temp=mypow(base,exp/2);
	temp=(temp*temp)%p;
	if(exp & 1)
		temp=(temp*base)%p;
	return temp;
}

long long call(long long n)
{
	long long chunks=n/p,ans,rem=n%p;
	ans=mypow(fact[p-1],chunks);
	ans=(ans*fact[rem])%p;
	if(chunks<p)
		return (fact[chunks]*ans)%p;
	else
		return (call(chunks)*ans)%p;
}
int main()
{
	long long n;
	int t;
	scanf("%d",&t);
	while(t--)
	{
		fact[0]=1;
		scanf("%lld%lld",&n,&p);
		for(int i=1;i<p;i++)
			fact[i]=(fact[i-1]*i)%p;
		printf("%lld\n",call(n));
	}
	return 0;
}