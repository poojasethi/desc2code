#include<stdio.h>
#include<math.h>
#include<stdlib.h>
#include<string.h>
#include<ctype.h>
#include<stack>
#include<queue>
#include<vector>
#include<algorithm>
#define MOD 1000000007
typedef long long LL ;
int fact[10000005] ;

int main(){
    int t,p,i,j;
    LL rem,n,quo,ans;
    fact[1] = 1;
    scanf("%d",&t);
    for(i=1;i<=t;i++){
        scanf("%lld %d",&n,&p);
        for(j=2;j<=p;j++) fact[j] = LL(fact[j-1])*j%p ;
        ans = 1;
        while(n > 0){
           quo =  n/p ;
           rem = n%p ;
           ans = LL(ans)*(quo%2==0?1:-1)*fact[rem]%p ;
           n = quo ;
        }
        if(ans < 0) ans+= p ;
        printf("%d\n",ans);
    }
return 0;
}
