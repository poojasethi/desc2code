#include<bits/stdc++.h>
#define s(a) scanf("%d",&a)
#define sl(a) scanf("%lld",&a)
#define ss(a) scanf("%s",a)
using namespace std;
typedef long long int ll;
ll modexp(ll a,ll b, ll c)
{
      if(b==0)return 1;
      if(b==1)return a%c;
      ll temp = modexp(a,b/2,c);
      temp = (temp*temp)%c;
      if(b&1)temp = (temp*a)%c;
      return temp;
}
int precomp[10000009];
int main()
{
      ll n,temp,ans,times;
      int p,i,t,rem;
      s(t);
      while(t--)
      {
            sl(n);
            s(p);
            ans = 1;
            int up = min(p,10000009);
            if(n<up)up = n;
            precomp[1] = 1;
            for(i=2;i<up;i++)
                  precomp[i] = (1ULL*precomp[i-1]*i)%p;
            while(n)
            {
                  rem = n%p;
                  if(rem)
                        ans = (ans*precomp[rem])%p;
                  times = n/p; 
                  temp = modexp(p-1,times,p);
                  ans = (ans*temp)%p;
                  n = n/p;
            }
            printf("%lld\n",ans);
      }
      return 0;
}
