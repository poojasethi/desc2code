#include <bits/stdc++.h>
using namespace std;

#define ll long long

struct node
{
    ll x,y,z;
};


int main()
{
    ll t;
    cin>>t;
    while(t--)
    {
        ll n,d,i,j,k,m,tmp,sum;
        cin>>n>>d;
        node nd[n];
        vector<int> v[n];
        int visited[n];
        stack<int> s;
        sum=0;
        for(i=0;i<n;i++) visited[i]=0;
        for(m=0;m<n;m++)
        {
            cin>>nd[m].x>>nd[m].y>>nd[m].z;
        }

        for(i=0;i<n-1;i++)
        {
            for(j=i+1;j<n;j++)
            {
                tmp=(nd[i].x-nd[j].x)*(nd[i].x-nd[j].x)+(nd[i].y-nd[j].y)*(nd[i].y-nd[j].y)+(nd[i].z-nd[j].z)*(nd[i].z-nd[j].z);
                if(tmp<=(d*d)) {v[i].push_back(j); v[j].push_back(i);}
            }
        }

        for(i=0;i<n;i++)
        {
            if(!visited[i])
            {
                sum++;
                visited[i]=1;
                s.push(i);
                while(!s.empty())
                {
                    j=s.top();
                    s.pop();
                    for(k=0;k<v[j].size();k++)
                    {
                        if(!visited[v[j][k]])
                        {
                            visited[v[j][k]]=1;
                            s.push(v[j][k]);
                        }
                    }
                }
            }
        }
        cout<<sum<<endl;
    }
    return 0;
}
