#include<iostream>
#include<cstring>
typedef long long int ll;
using namespace std;
ll mod = 1000000007;
void mul(ll a[4][4],ll b[4][4])
{
	ll temp[4][4] = {0};
	int i,j,k;
	/*for(i=0;i<4;i++)
		for(j=0;j<4;j++)
			temp[i][j] = (i=1;*/
	for(i=0;i<4;i++)
		for(j=0;j<4;j++)
			for(k=0;k<4;k++)
			{
				temp[i][j]+= ((a[i][k]%mod) * (b[k][j]%mod))%mod;
				temp[i][j]%=mod;
			}
	for(i=0;i<4;i++)
		for(j=0;j<4;j++)
			a[i][j] = temp[i][j];
	//memcpy(a,temp,sizeof(temp));
}
long long int cal(ll m[4][4],ll arr[4],ll n)
{
	ll temp[4][4];
	int i,j;
	for(i=0;i<4;i++)
		for(j=0;j<4;j++)
			temp[i][j] = (i==j);
	while(n>0)
	{
		if(n%2)
			mul(temp,m);
		mul(m,m);
		n>>=1;
	}
	ll ans=0;
	for(i=0;i<4;i++)
	{
		ans+= ((temp[0][i]%mod)*(arr[i]%mod))%mod;
		ans%=mod;
	}
	return ans;
}
int main()
{
	int t;
	ll a,b,c,d,t1,t2,t3,n;
	cin>>t;
	while(t--)
	{
		cin>>a>>b>>c>>d>>t1>>t2>>t3>>n;
		if(n==1)
			cout<<t1<<endl;
		if(n==2)
			cout<<t2<<endl;
		if(n==3)
			cout<<t3<<endl;
		if(n<4)
			continue;
		ll m[4][4] = {0},arr[4];
		m[1][0]=m[2][1]=m[3][3]=1;
		m[0][0]=a;
		m[0][1]=b;
		m[0][2]=c;
		m[0][3]=d;
		arr[0]=t3;
		arr[1]=t2;
		arr[2]=t1;
		arr[3]=1;
		cout<<cal(m,arr,n-3)<<endl;
	}
	return 0;
}















