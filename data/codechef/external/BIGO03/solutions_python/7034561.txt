#include <bits/stdc++.h>
#include <inttypes.h>
#include <stdlib.h>
#include <stdio.h>
#define TOKEN -1
#define MOD 1000000007
using namespace std;

uint64_t mat[4][4];

void matrix_mul(uint64_t m1[4][4], uint64_t m2[4][4]){
    uint64_t result[4][4];
    for(int i=0;i<4;i++){
        for(int j=0;j<4;j++){
            uint64_t sum=0;
            for(int k=0;k<4;k++){
                sum = (sum + m1[i][k]*m2[k][j])%MOD;
            }
            result[i][j]=sum;
        }
    }
    for(int i=0;i<4;i++)
        for(int j=0;j<4;j++)
            mat[i][j]=result[i][j];
}

void compute(int pow){
;
    if(pow==1)
        return;
    uint64_t temp_mat[4][4];
    for(int i=0;i<4;i++)
        for(int j=0;j<4;j++)
            temp_mat[i][j]=mat[i][j];
    compute(pow/2);
    if(pow%2==0)
        matrix_mul(mat,mat);
    else{
        matrix_mul(mat,mat);
        matrix_mul(mat,temp_mat);
    }


}

int main() {
    int tc;
    scanf("%d",&tc);
    while(tc--){
        uint64_t a,b,c,d,t1,t2,t3,n;
        cin>>a>>b>>c>>d>>t1>>t2>>t3>>n;
        int result;
        if(n==1)
            result=t1;
        else if(n==2)
            result=t2;
        else if(n==3)
            result=t3;
        else {
            mat[0][0]=a;mat[0][1]=b;mat[0][2]=c;mat[0][3]=1;
            mat[1][0]=1;mat[1][1]=0;mat[1][2]=0;mat[1][3]=0;
            mat[2][0]=0;mat[2][1]=1;mat[2][2]=0;mat[2][3]=0;
            mat[3][0]=0;mat[3][1]=0;mat[3][2]=0;mat[3][3]=1;
            compute(n-3);
            result=(mat[0][0]*t3+mat[0][1]*t2+mat[0][2]*t1+d*mat[0][3])%MOD;
        }
        cout<<result<<endl;
    }
    return 0;
}
