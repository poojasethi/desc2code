import java.util.Scanner;

public class Main {
    static long mod = 1000000007;

    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        int T = input.nextInt();
        for (int t=0; t<T; t++) {
            long a = input.nextInt();
            long b = input.nextInt();
            long c = input.nextInt();
            long d = input.nextInt();
            long T1 = input.nextInt();
            long T2 = input.nextInt();
            long T3 = input.nextInt();
            long T4 = (a*T3+b*T2+c*T1+d)%mod;
            int N = input.nextInt();
            long[][] M = new long[][] {
                {1+a, b-a, c-b, -c},
                {1, 0, 0, 0},
                {0, 1, 0, 0},
                {0, 0, 1, 0}
            };
            M = modPow(M, N-1);
            long result = M[3][0]*T4+M[3][1]*T3+M[3][2]*T2+M[3][3]*T1;
            result %= mod;
            if (result < 0) {
                result += mod;
            }
            System.out.println(result);
        }
    }

    static long[][] modPow(long[][] M, int exp) {
        long[][] result = new long[][] {
            {1, 0, 0, 0},
            {0, 1, 0, 0},
            {0, 0, 1, 0},
            {0, 0, 0, 1}
        };
        long[][] pow = M;
        while (exp != 0) {
            if ((exp&1) == 1) {
                result = multiply(result, pow);
            }
            exp >>>= 1;
            pow = multiply(pow, pow);
        }
        return result;
    }

    static long[][] multiply(long[][] A, long[][] B) {
        long[][] C = new long[4][4];
        for (int i=0; i<4; i++) {
            for (int j=0; j<4; j++) {
                long value = 0;
                for (int k=0; k<4; k++) {
                    value += A[i][k]*B[k][j];
                }
                C[i][j] = value%mod;
            }
        }
        return C;
    }

}
