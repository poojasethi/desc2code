#include <stdio.h>
#define ll long long
#define mod 1000000007

ll mypow(ll power,ll a,ll b,ll c,ll d,ll e,ll f,ll g)
{
    ll sum=0;
    int i,j,k,cnt=0;
    ll M[4][4]={{a,b,c,d},{1,0,0,0},{0,1,0,0},{0,0,0,1}};
    ll temp1[4][4]={{1,0,0,0},{0,1,0,0},{0,0,1,0},{0,0,0,1}};
    ll temp[4][4];
    while(power>0)
    {
        if(power%2!=0)
        {
            for(i=0;i<4;i++)
            {
                for(j=0;j<4;j++)
                {
                    sum=0;
                    for(k=0;k<4;k++)
                    {
                        sum=(sum+(temp1[i][k]*M[k][j])%mod)%mod;
                    }
                    temp[i][j]=sum;
                }
            }
            for(i=0;i<4;i++)
            {
                for(j=0;j<4;j++)
                    temp1[i][j]=temp[i][j];
            }
        }
        power/=2;
        if(power>0)
        {
            for(i=0;i<4;i++)
            {
                for(j=0;j<4;j++)
                {
                    sum=0;
                    for(k=0;k<4;k++)
                    {
                        sum=(sum+(M[i][k]*M[k][j])%mod)%mod;
                    }
                    temp[i][j]=sum;
                }
            }
            for(i=0;i<4;i++)
            {
                for(j=0;j<4;j++)
                M[i][j]=temp[i][j];
            }
        }
    }
    ll f1,f2,f3,f4,ans;
    f1=(temp1[0][0]*g)%mod;
    f2=(temp1[0][1]*f)%mod;
    f3=(temp1[0][2]*e)%mod;
    ans=(((f1+f2)%mod+f3)%mod+temp1[0][3])%mod;
    return ans;
}
int main()
{
    int T;
    ll a,b,c,d,e,f,g,N;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%lld %lld %lld %lld %lld %lld %lld %lld",&a,&b,&c,&d,&e,&f,&g,&N);
        if(N==1)
            printf("%lld\n",e);
        else if(N==2)
            printf("%lld\n",f);
        else if(N==3)
            printf("%lld\n",g);
        else
            printf("%lld\n",mypow(N-3,a,b,c,d,e,f,g));
    }
    return 0;
}