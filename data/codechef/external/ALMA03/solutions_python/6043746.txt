#include <bits/stdc++.h>
using namespace std;
typedef long long int ll;
typedef pair<int,int> ii;
typedef vector<ii> vii;
#define TRvii(c, it) for(vii::iterator it = (c).begin(); it != (c).end(); it++)
#define F(i,a,b) for(int i = (int)(a); i <= (int)(b); i++)
#define RF(i,a,b) for(int i = (int)(a); i >= (int)(b); i--)
#define MOD 1000000007
#define pb push_back
#define mp make_pair
vii AdjList[205];
int visited[205];
ll A[205];
ll dfs(int i)
{
    visited[i] = 1;
    ll M = A[i];
    TRvii(AdjList[i],_j)
    {
        if(!visited[_j->first])
        {
            M = max(M,dfs(_j->first));
        }
    }
    return M;
}
int main()
{
    #ifndef ONLINE_JUDGE
        freopen("input.txt","r",stdin);
        freopen("output.txt","w",stdout);
    #endif
    int T,N;
    ll ans;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%d",&N);
        F(i,0,N-1) scanf("%lld",&A[i]);
        F(i,0,N-1) AdjList[i].clear();
        F(i,0,N-1)
        {
            F(j,0,i)
            {
                if(__gcd(A[i],A[j]) > 1)
                {
                    AdjList[i].pb(mp(j,0));
                    AdjList[j].pb(mp(i,0));
                }
            }
        }
        memset(visited, 0, sizeof(visited));
        ans = 1LL;
        F(i,0,N-1)
        {
            if(!visited[i])
            {
                ans = (ans*dfs(i))%MOD;
            }
        }
        printf("%lld\n",ans);
    }
    return 0;
}
