#include<bits/stdc++.h>
using namespace std;


#define FORI(i,b,e) for(int i=b; i<=e; i++)
#define FORD(i,b,e) for(int i=b; i>=e; i--)
#define FILL(a, v) memset(a, v, sizeof(a))
#define FOREACH(it,c) for(__typeof((c).begin()) it=((c).begin());it!=(c).end();++it)
#define mod 1000000007
#define INF 1000000001
#define sz 211

typedef long long LL;
typedef vector<int> VI;
typedef vector<LL> VLL;
typedef pair<int, int> PII;

//******************************************* global variable ******************************

int n;
VLL adj[202], a(202, 0);
int mark[202];


//******************************************* main code ************************************
template<class T>
T gcd(T a,T b)
{
    T temp;
    while(b!=0)
    {
        temp=a;
        a=b;
        b=temp%a;
    }
    return a;
}

LL dfs(int s)
{
    LL maxm=a[s];
    mark[s]=1;
    FOREACH(it, adj[s])
    {
        if(!mark[*it])
        {
            maxm=max(maxm, dfs(*it));
        }
    }
    return maxm;
}
void read()
{
    scanf("%d", &n);
    FORI(i, 1, n)
        scanf("%lld", &a[i]);
    FORI(i, 1, n)
    {
        FORI(j, i+1, n)
        {
            if(gcd(a[i], a[j])>1)
            {
                adj[i].push_back(j);
                adj[j].push_back(i);
            }
        }
    }
}
void solve()
{
    LL ans=1;
    FORI(i, 1, n)
    {
        if(!mark[i])
            ans=(ans*dfs(i))%mod;
    }
    printf("%d\n", ans);
    FORI(i, 1, n)
    {
        adj[i].clear();
    }
    FILL(mark, 0);
}
int main()
{
    int tc=1;
    scanf("%d", &tc);
    while(tc--)
    {
        read();
        solve();
    }
}
