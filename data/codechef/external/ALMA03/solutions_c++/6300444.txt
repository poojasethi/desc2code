#include<stdio.h>
#include<vector>
#include<string.h>
#define mod 1000000007
using namespace std;
vector<long long int> ve[300];
long long int pro;
long long int t,n,a[203],mx;
long long int vi[203]={0};
long long int gc(long long int a,long long int b)
{
	long long int te;
	if(b>a)
	{
		te=a;
		a=b;
		b=te;
	}
	if(b==0)
	return a;
	return gc(b,a%b);
}
void df(long long int u)
{
	long long int i,j;
	if(a[u]>mx)
	mx=a[u];
	vi[u]=1;
	long long int si=ve[u].size();
	for(i=0;i<si;i++)
	{
		if(vi[ve[u][i]]==0)
		{
			df(ve[u][i]);
		}
	}
}
void dfs()
{
	long long int i,j;
	for(i=0;i<n;i++)
	{
		mx=-1;
		if(!(vi[i]))
		{
			df(i);
			pro=(pro*mx)%mod;
		}
	}
}
int main()
{
	long long int i,j;
	//freopen("cook.txt","r",stdin);
	scanf("%lld",&t);
	while(t--)
	{
		for(i=0;i<300;i++)
		ve[i].clear();
		mx=-1;
		pro=1;
		memset(vi,0,sizeof(vi));
		scanf("%lld",&n);
		for(i=0;i<n;i++)
		{
			scanf("%lld",(a+i));
		}
		if(n>1)
		{
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
			{
				if(i!=j&&gc(a[i],a[j])>1)
				{
					ve[i].push_back(j);
				}
			}
		}
		dfs();
	    }
	    else
	    pro=a[0]%mod;
		printf("%lld\n",pro);
	}
	return 0;
}
