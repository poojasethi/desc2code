#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<cmath>
#include<vector>
#define mod 1000000007
using namespace std;
vector<int> v[201];
vector<int> vtmp;
int cnt;
int gcd(int a,int b)
{
	if(b==0)
	return a;
	else
	return gcd(b,a%b);
}
void pre(int tmp)
{
	vtmp.clear();
	for(int i=0;i<cnt;i++)
	{
		for(int j=0;j<v[i].size();j++)
		{
			if(gcd(tmp,v[i][j])>1)
			{
				vtmp.push_back(i); break;	
			}
		}
	}
}
int longest_vector()
{
	int mx=v[vtmp[0]].size(),mxid=vtmp[0];
	for(int i=1;i<vtmp.size();i++)
	{
		if(v[vtmp[i]].size()>mx)
		{
			mx=v[vtmp[i]].size();
			mxid=vtmp[i];
		}
	}
	return mxid;
}
int maxi(int x)
{
	int mx=v[x][0];
	for(int i=1;i<v[x].size();i++)
	{
		if(v[x][i]>mx)
		mx=v[x][i];
	}
	return mx;
}
int main()
{
  std:ios_base::sync_with_stdio(false);
  int t,tmp,n,i,l,ttmp,j;
  long long ans;
  cin>>t;
  while(t--)
  { cnt=0; ans=1;
  	for(i=0;i<201;i++)
  	v[i].clear();
  	cin>>n;
  	for(i=0;i<n;i++)
  	{
  		cin>>tmp;
  		pre(tmp);
  		if(vtmp.size()==0)
  		{	
  		  v[cnt].push_back(tmp);
  		  cnt++;
  		}
		else
		{
			l=longest_vector();
			v[l].push_back(tmp);
			for(int i=0;i<vtmp.size();i++)
			{
				if(vtmp[i]==l) continue;
				ttmp=vtmp[i];
				for(j=0;j<v[ttmp].size();j++)
				{
					v[l].push_back(v[ttmp][j]);
				}
				v[ttmp].clear();
			}
		}  
  	}
  	for(i=0;i<cnt;i++)
  	{
  	  if(v[i].size()>0)
  	  {
  	  	ans=(ans*maxi(i))%mod;
  	  }
  	}
  	printf("%lld\n",ans);
  }  
  return 0;
}
