#include<cstring>
#include<cstdio>
#include<vector>
#include<algorithm>     
using namespace std;
int scan()
{
    int n=0;
    char ch=getchar_unlocked();
    while(ch<'0'||ch>'9')
        ch=getchar_unlocked();
    while(ch>='0'&&ch<='9')
    {
        n=(n<<3)+(n<<1)+ch-'0';
        ch=getchar_unlocked();
    }
    return n;
}
int main()
{
    int t;
    t=scan();
    while(t--)
    {
        int n,i,j,x;
        char input[202];
        vector<int>grid[201];
        int paths[201][201]={{0}};      //stores the length of path
        n=scan();
        for(i=0;i<n;i++)        //take input and store in vector
        {
            scanf("%s",input);
            for(j=0;j<n;j++)
                if(input[j]=='Y')
                    grid[i].push_back(j);
        }
        for(i=0;i<n;i++)
        {
            int visited[201]={0};
            int queue[201]={0};
            int total=1;
            int front,rear;
            front=rear=-1;
            visited[i]=1;
            paths[i][i]=0;
            for(j=0;j<grid[i].size();j++)       //for all the directly connected vertices length of path is 1
            {
                visited[grid[i][j]]=1;
                queue[++rear]=grid[i][j];
                paths[i][grid[i][j]]=1;
                total++;
            }
            while(total<n)
            {
                x=queue[++front];
                int sum=paths[i][x];
                for(j=0;total<n&&j<grid[x].size();j++)      //for the indirectly connected paths length of path
                {                                       //will be length of path till the 'via' edge +1
                    if(!visited[grid[x][j]])            //if 2 is connected to 3 and 3 is connected to 1 then 
                    {                                   //length of path from 2 to 1 will be 2
                        queue[++rear]=grid[x][j];
                        paths[i][grid[x][j]]=sum+1;
                        visited[grid[x][j]]=1;
                        total++;
                    }
                }
            }
        }
        int q;
        q=scan();
        for(i=1;i<=q;i++)
            printf("%d\n",paths[scan()][scan()]);
    }
    return 0;
}