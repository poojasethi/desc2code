#include<iostream>
#include<vector>
using namespace std;
int main()
{
	int t,n,i,j,d,c,u,q,x,y,k;
	string s;
	int dist[205][205];
	char data[205][205];
	int visited[205][205];
	vector<int> a[205];
	cin >>t;
	while(t--)
	{
		for(i=0;i<205;i++)
			a[i].clear();
		cin >> n;
		for(i=0;i<n;i++)
		{
			cin >> s;
			for(j=0;j<s.size();j++)
				data[i][j]=s[j];
		}
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
			{
				if(data[i][j]=='Y')
				{
					a[i].push_back(j);
					a[j].push_back(i);
				}
			}
		}
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
			{
				if(i==j)
					dist[i][j]=0;
				else
					dist[i][j]=100000;
			}
		}
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
				visited[i][j]=0;
		}
		for(i=0;i<n;i++)
		{
			d=1000000;
			c=0;
			while(c<n)
			{
				d=1000000;
				for(j=0;j<n;j++)
				{
					if(visited[i][j]==0 && dist[i][j]<d)
					{
						u=j;
						d=dist[i][j];
					}
				}
				for(k=0;k<a[u].size();k++)
				{
					dist[i][a[u][k]]=min(dist[i][a[u][k]],dist[i][u]+1);
				}
				visited[i][u]=1;
				c++;
			}
		}
		cin >> q;
		while(q--)
		{
			cin >> x >> y;
			cout << dist[x][y] << "\n";
		}
	}
	return 0;
}