# cook your code here
n,m,t=map(int,raw_input().split())
a=[[0 for i in range(m)]for i in range(n)]
b=[[0 for i in range(m)]for i in range(n)] 
q=[]
m_max=0
f_max=0
for i in range(n):
    q.append(raw_input())
    for j in range(m):
        if i==0 or j==0:
            if q[i][j]=='M':
                a[i][j]=1
                m_max=1
            else:
                b[i][j]=1
                f_max=1
for i in range(1,n):
    for j in range(1,m):
        if q[i][j]=='M':
            a[i][j]=min(min(a[i-1][j],a[i][j-1]),a[i-1][j-1])+1
        else:
            b[i][j]=min(min(b[i-1][j],b[i][j-1]),b[i-1][j-1])+1
        m_max=max(m_max,a[i][j])
        f_max=max(f_max,b[i][j])
for _ in range(t):
    k,s=map(str,raw_input().split())
    if(s=='M'):
        if(int(k)>m_max):
            print 'no'
        else:
            print 'yes'
    else:
        if(int(k)>f_max):
            print 'no'
        else:
            print 'yes'