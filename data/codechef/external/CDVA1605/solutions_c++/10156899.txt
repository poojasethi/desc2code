#include<stdio.h>
int min(int a,int b,int c)
{
    int temp=a;

    if(temp>b)
    temp=b;

    if(temp>c)
    temp=c;

    return temp;
}
char arr[1005][1005];
int a[1005][1005]={0},b[1005][1005]={0};
int main()
{

    int n,m,l,r,k,q,maxm,maxf;
    char g;

    scanf("%d %d %d",&l,&r,&q);

    for(int i=0;i<l;i++)
    {
        scanf("%s",arr[i]);
    }

    for(int i=0;i<l;i++)
    {
        if(arr[0][i]=='M')
        {
            a[0][i]=1;
            b[0][i]=0;
        }

        else
        {
            a[0][i]=0;
            b[0][i]=1;
        }
    }

    for(int i=0;i<l;i++)
    {
        if(arr[i][0]=='M')
        {
            a[i][0]=1;
            b[i][0]=0;
        }

        else
        {
            a[i][0]=0;
            b[i][0]=1;
        }
    }

    maxm=a[0][0];
    maxf=b[0][0];

    for(int i=1;i<l;i++)
    {
        for(int j=1;j<r;j++)
        {
            if(arr[i][j]=='M')
            {
                b[i][j]=0;
                a[i][j]=min(a[i][j-1],a[i-1][j],a[i-1][j-1])+1;
            }

            else
            {
                a[i][j]=0;
                b[i][j]=min(b[i][j-1],b[i-1][j],b[i-1][j-1])+1;
            }

            if(a[i][j]>maxm)
            maxm=a[i][j];

            if(b[i][j]>maxf)
            maxf=b[i][j];
        }
    }

    /*for(int i=0;i<l;i++)
    {
        for(int j=0;j<r;j++)
        {
            printf("%d ",a[i][j]);
        }
        printf("\n");
    }

    for(int i=0;i<l;i++)
    {
        for(int j=0;j<r;j++)
        {
            printf("%d ",b[i][j]);
        }
        printf("\n");
    }*/

    for(int i=0;i<q;i++)
    {
        scanf("%d %c",&k,&g);

        if(g=='M')
        {
            if(k>maxm)
            printf("no\n");

            else
            printf("yes\n");
        }

        else
        {
            if(k>maxf)
            printf("no\n");

            else
            printf("yes\n");
        }
    }
    return 0;
}
