#include <iostream>
#include <cstdio>
#include <vector>
#include <set>
#include <cstring>
// #include <multiset>
 
using namespace std;
 
#define s(n) scanf("%d", &n)
 
 
char in[1000005];
typedef pair<int,int> PII;
 
int main()
{
  int T; s(T);
  while(T--)
  {
    
    scanf("%s", in);
    vector<PII> all;
    int x = 0, y = 0;
    all.push_back(PII(0,0));
    int N = strlen(in);
    
    for(int i = 0; i < N; i++)
    {
      char c = in[i];
      int j = i;
      while(i + 1 < N && in[j] == in[i+1])
	i++;
      int d = i - j + 1;      
      switch(c)
      {
	case 'E' : x += d; break;
	case 'N' : y += d; break;
	case 'W' : x -= d; break;
	case 'S' : y -= d; break;
      }
      all.push_back(PII(x,y));
    }
    
    long long ans = 0;
    for(int i = 0; i < all.size() - 1; i++)
    {
      int j = (i+1) % N;
      int its = ( all[i].first * all[j].second - all[i].second * all[j].first);
      ans += its;
    }
    
    ans = ans < 0 ? -ans : ans;	
    printf("%lld\n", ans/2);
  }
  
} 