#include <stdio.h>
#include <stdlib.h>

int main(){
	long long t,p,i,j;
	long long a,b,c,x,y;
	
	scanf("%lld", &t);
	
	while(t--){
		scanf("%lld", &a);
		scanf("%lld", &b);
		scanf("%lld", &p);
		
		char *s;
		s=(char*)calloc(p,sizeof(char));
		
		for(i=0;i<p;i++){
			c=i*i*i;
			if(c%p==1)
				s[i]='1';
			else;
		}
				
		c=(a-1)/p;
		
		a=(a-1)%p;
			
		for(i=0,x=0;i<a+1;i++)
			if(s[i]=='1')
				x=x+c+1;
			else;
			
		for(;i<p;i++)
			if(s[i]=='1')
				x=x+c;
			else;
		
		y=x;
		
		c=b/p;
		
		a=b%p;
			
		for(i=0,x=0;i<a+1;i++)
			if(s[i]=='1')
				x=x+c+1;
			else;
			
		for(;i<p;i++)
			if(s[i]=='1')
				x=x+c;
			else;
				
		printf("%lld\n", x-y);
		
		free(s);		
	}
	
	return 0;
	
}
