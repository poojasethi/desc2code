#include<bits/stdc++.h>
int rem[100005];
int main()
{
	//memset(rem,0,100005);
	int t;
	scanf("%d",&t);
	while(t--)
	{
	int i;
	long long a,b;
	int p;
	scanf("%lld %lld %d",&a,&b,&p);
	long long cub;
	int count=0,j=1;
	for(i=1,j=1;i<=p-1;i++)
	{
		cub=1LL*i*i*i;
		if(cub%p==1)
		{
			//printf("%d\n",i );
			rem[j]=i;
			//printf("rem%d\n",rem[j] );
			count++;
			j++;
		}
	}
	//printf("%d\n",count );
	long long countn=0;
	//if(count>0)
	int mod1=a%p,mod2=b%p;
	j=1;
	a=a-mod1+p;
	while(rem[j]<mod1 && j<=count)
		j++;
	countn=count-j+1;
	j=1;
	//printf("countn=%lld\n",countn );
	while(rem[j]<=mod2 && j<=count)
		j++;
	//printf(" %d j=%d\n",rem[3],j );
	countn+=j-1;
	//printf("countn=%lld\n",countn );
	b=b-mod2;
	//printf("b%lld\n",b );
	long long num=(b-a)/p;
	countn+=num*count;
	printf("%lld\n",countn );
	}
	return 0;
}