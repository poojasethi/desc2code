#include<stdio.h>
#include<iostream>
#include<vector>
#include<math.h>
#include<algorithm>
#include<assert.h>
#define pii pair<int,int>
#define IN(A, B, C)  ((B) <= (A) && (A) <= (C))
#define AIN(A, B, C) assert(IN(A, B, C))

using namespace std;
int main(){
     long long int a,b,p;
    int t;
    scanf("%d",&t);
    while(t--){
             long long int st=0;
        scanf("%lld %lld %lld",&a,&b,&p);
        if(a>b) swap(a,b);
        for(long long i=1;i<p;i++){
            long long ans1,ans2,ans3;
            ans1=(i*i*i)%p;
            if(ans1==1)
                {
                    ans2=ans3=0;
                     if(a-1-i>=0)ans2=(a-1-i)/p+1;
                     if(b>=i)ans3=(b-i)/p+1;
                   // cout<<ans2<<" "<<ans3<<endl;
                    st+=ans3-ans2;
                }
        }
        /*for(int i=0;i<v.size();i++){
                //cout<<v[i]<<" ";
            long long lim=(b-v[i])/p;
            st+=lim+1;
        }*/
        printf("%lld\n",st);
    }
return 0;
}
