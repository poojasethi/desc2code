#include<iostream>
#include<cstdio>
#include<algorithm>
using namespace std;
#define ll long long
int main()
{
int t;
cin>>t;
while(t--)
{
ll a,b,d,p;
cin>>a>>b>>p;
d=b-a;
if(a>b)
swap(a,b);
ll count1=0,count2=0,count3=0,count=0;
a=a-(a/p)*p;
b=d+a;
//cout<<"a="<<a<<endl;
//cout<<"b="<<b<<endl;
if(b<=p)
{
for(ll i=a;i<=b;i++)
{
if(((i%p)*(i%p)*(i%p))%p==1)
        count++;
}
cout<<count<<endl;
}
else
{
for(ll i=1;i<=p;i++)
{if(((i%p)*(i%p)*(i%p))%p==1)
count1++;
}
for(ll i=a;i<p;i++)
{
if(((i%p)*(i%p)*(i%p))%p==1)
        count2++;
}
for(ll i=((b/p)*p);i<=b;i++)
{
if(((i%p)*(i%p)*(i%p))%p==1)
count3++;
}
cout<<(count2+count3+((b-p)/p)*count1)<<endl;
}
}
return 0;
}
