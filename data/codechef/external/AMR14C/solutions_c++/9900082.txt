#include <stdio.h>
#include <memory.h>

#define min(a, b) (a < b ? a : b)
#define max(a, b) (a > b ? a : b)
typedef long long ll;
const int MAX = 1e5;
int test, n, m, x, a[MAX];
ll cnt[MAX], res;

int getCnt(const int& u, const int& v){
    if (u > v)
        return 0;
    return cnt[v] - (u > 0 ? cnt[u - 1] : 0);
}

int main(){
    //freopen("in.txt", "r", stdin);
    scanf("%d", &test);
    while (test--){
        scanf("%d %d %d", &n, &m, &x);

        memset(cnt, 0, m * sizeof(ll));
        for (int i = 0; i < n; ++i){
            scanf("%d", a + i);
            ++cnt[a[i] %= m];
        }

        for (int i = 1; i < m; ++i)
            cnt[i] += cnt[i - 1];
        res = 0;

        for (int i = 0; i < n; ++i){
            if (a[i] <= x)
                res += cnt[x - a[i]];
            res += getCnt(m - a[i], min(m - a[i] + x, m - 1));
        }
        printf("%lld\n", res);
    }
    return 0;
}
