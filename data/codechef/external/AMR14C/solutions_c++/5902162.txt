#include <iostream>

using namespace std;

int main()
{
    int t;
    long long int n,m,x,a[100005],num,l,h,ans;
    cin>>t;
    while(t--)
    {
        cin>>n>>m>>x;
        for(int i=0;i<m;i++) a[i]=0;
        for(int i=1;i<=n;i++)
        {
            cin>>num;
            a[num%m]++;
        }
        for(int i=1;i<m;i++) a[i]+=a[i-1];
        ans= a[0]*(a[m-1]-a[x]) ;
        for(int i=1;i<m;i++)
        {
            l=x-i+1;h=m-i-1;
            if(l>0)
            ans+=( (a[i]-a[i-1])*(a[h]-a[l-1]) ) ;
            else
            ans+=( (a[i]-a[i-1])*(a[h]+a[m-1]-a[m+l-1] ) ) ;
        }
        ans=(n*n)-ans;
        cout<<ans<<'\n';
    }
    return 0;
}
