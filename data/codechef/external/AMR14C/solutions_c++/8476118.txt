#include<bits/stdc++.h>
#define LL long long
using namespace std;
LL int a[1000007];
LL int justsmaller(LL int a[],LL int n,LL int x)
{
	LL int beg,last,mid;
	beg=0;last=n-1;
	if(a[0]>=x)
	return -1;
	while(beg<=last)
	{
		mid=(beg+last)/2;
		if((mid==0 || a[mid-1]<x) && a[mid]>=x)
		return mid-1;
		else if((mid+1==n || a[mid+1]>=x) && a[mid]<x)
		return mid;
		else if(a[mid]>=x)
		last=mid-1;
		else beg=mid+1;
	}
	return -1;
}

LL int nextgreater(LL int a[],LL int n,LL int x)
{
	LL int beg,last,mid;
	beg=0;last=n-1;
	if(a[n-1]<=x)
	return n;
	while(beg<=last)
	{
		mid=(beg+last)/2;
		if((mid==0 || a[mid-1]<=x) && a[mid]>x)
		return mid;
		else if((mid+1==n || a[mid+1]>x) && a[mid]<=x)
		return mid+1;
		else if(a[mid]<=x)
		beg=mid+1;
		else last=mid-1;
	}
	return n;
}

LL int eleinrange(LL int first,LL int last,LL int a[],LL int n)
{
	LL int beg,end;
	beg=justsmaller(a,n,first);
	end=nextgreater(a,n,last);
	//cout<<"\nbeg="<<beg<<" last="<<end<<"\n";
	return (end-beg-1);
}
int main()
{
	LL int t,n,m,x,i,ans,first,last,temp;
	cin>>t;
	while(t--)
	{
		cin>>n>>m>>x;
		for(i=0;i<n;i++)
		{
			cin>>a[i];
			a[i]=a[i]%m;
		}
		sort(a,a+n);
		ans=0;
		for(i=0;i<n;i++)
		{
			temp=ans;
			if(a[i]<=x)
			{
				first=0;last=x-a[i];
				ans+=eleinrange(first,last,a,n);
				//cout<<ans-temp<<"\n";
				first=m-a[i];last=m-1;
				ans+=eleinrange(first,last,a,n);
			}
			else
			{
				first=m-a[i];last=m+x-a[i];
				ans+=eleinrange(first,last,a,n);
			}
			//cout<<ans-temp<<"\n";
		}
		cout<<ans<<"\n";
	}
	return 0;
}