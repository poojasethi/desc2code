#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cmath>
#include <cstring>
#include <cassert>
using namespace std;
#define p(x) cout<<#x<<":"<<x<<"\n"
#define mod 10000000000283ll
#define ll long long

ll cs,n,k,p,q,i,x;

ll bm(ll b,ll e)
{
  ll x;

  if(!e)
    return 0;
  x=bm(b,e/2);
  x+=x;
  if(e&1)
    x+=b;
  return x%mod;
}
ll be(ll b,ll e)
{
  ll x;

  if(!e)
    return 1;
  x=be(b,e/2);
  x=bm(x,x);
  if(e&1)
    x=bm(x,b);
  return x;
}
int main()
{
  cin>>cs;
  while(cs--)
  {
    cin>>n>>k;
	if(n==1)
	{
	  cout<<k<<"\n";
	  continue;
	}
	for(i=2,x=n,p=q=1;i*i<=x;i++)
	  if(!(x%i))
	  {
	    while(!(x%i))
		  x/=i;
		p=bm(p,i-1);
		q=bm(q,i);
	  }
	if(x>1)
	{
	  p=bm(p,x-1);
	  q=bm(q,x);
	}
	cout<<bm(bm((bm((be(n,k+1)+mod-1)%mod,be(n-1,mod-2))+mod-1)%mod,p),be(q,mod-2))<<"\n";
  }
  return 0;
}
