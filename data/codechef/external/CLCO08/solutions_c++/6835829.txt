#include <cstdio> 
#include <algorithm>
#include <iostream>
 
using  namespace std;
 
char gar [1000001];
int pow2 [1000001];
 
int main ()
{
	int n, m;
	
	scanf("%d%d", &n, &m);
	scanf("%s", gar);
	
	pow2[0] = 1 ;
	for ( int i = 1 ; i <= n; i++) pow2[i] = (2 * pow2[i - 1])% m;
	
	int ans = 0 , k = n;
	 int nowdx = 0 , mindx = 0 , maxdx = 0 ;
	 for ( int i = 0 ; gar[i]; i++) {
		k--;
		if (gar[i] == 'P' ) {
			 int ndx = nowdx + 1 ;
			 if (max(ndx, maxdx) - mindx == 1 ) ans = (ans + pow2[k / 2 ] + pow2[(k + 1 ) / 2 ] + m - 1 )% m;
			 else  if (max (ndx, maxdx) - mindx == 2 ) ans = (ans + pow2[(k + (mindx + 1 == ndx)) / 2 ])% m;
			nowdx--;
			mindx = min(mindx, nowdx);
		}
		else {
			nowdx ++;
			maxdx = max (maxdx, nowdx);
		}
	}
	
	printf("%d\n" , (ans + 1 )% m);
	
	return 0;
} 