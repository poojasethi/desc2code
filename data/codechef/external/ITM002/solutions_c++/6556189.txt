#include<bits/stdc++.h>
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define p(n) printf("%d\n",n)
#define mod 1000000007LL
#define ll long long
#define pb push_back
#define mp make_pair
#define N 100011
#define LN 21
using namespace std;
int bit[2*N],maxval,bit1[2*N],maxval1,bit2[2*N],bit3[2*N];
ll powmod(ll a,ll b,ll c)
{
 ll res=1LL;
 while(b>0)
 {
  if(b&1)
  res=(res*a)%c;
  a=(a*a)%c;
  b/=2;
 }
 return res;
}
ll inverse(ll a,ll MOD)
{
if(a==0)
return 1LL;
else
return powmod(a,MOD-2,MOD);
}
void update(int idx,int val)
{
 while(idx<=maxval)
 {
  bit[idx]+=val;
  idx+=(idx & -idx);
 }
}
int query(int idx)
{
 int sum=0;
 while(idx>0)
 {
   sum+=bit[idx];
   idx-=(idx & -idx);
 }
 return sum;
}
ll fact[400005];
int lc[400005],lc1[400005];

ll ncr(int n,int r)
{
 ll num=fact[n];
 ll den=(fact[r]*fact[n-r])%mod;
 ll ans=(num*inverse(den,mod))%mod;
 return ans;
}
int main()
{
 int t,n,l,k,i;
 int a[50002];
 s(t);
 while(t--)
 {
  s(l);s(n);s(k);
  for(i=0;i<n;++i)
  s(a[i]);
  sort(a,a+n);
  ll ans=0;
  for(i=0;i<n;++i)
  {
   if(a[i]>k)
   ans+=(n-i-1);
   else
   {
    int ri=n-1-i;
    int lo=i+1;
    int hi=n-1;
    int id1,id2;
    id1=id2=-1;
    while(lo<=hi)
    {
     int mid=(lo+hi)/2;
     if(a[mid]-a[i]>k)
     {
      id1=mid;
      hi=mid-1;
     }
     else
     lo=mid+1;
    }
    if(id1!=-1)
    id1=n-id1;
    lo=i+1;
    hi=n-1;

    while(lo<=hi)
    {
     int mid=(lo+hi)/2;
     if(l-a[mid]>k)
     {
      id2=mid;
      lo=mid+1;
     }
     else
     hi=mid-1;
    }
    if(id2!=-1)
    id2=id2-i;
    //cout<<id1<<" "<<id2<<" "<<i<<endl;
    id1=max(0,id1);
    id2=max(id2,0);
    ans+=min(ri,id1+id2);
   }
  }
  cout<<ans<<endl;
 }
}
