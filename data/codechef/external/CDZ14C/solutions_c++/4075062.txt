// C header files
#include<cstdio>
#include<cmath>

// C++ header files
#include<iostream>
#include<vector>
#include<string>
#include<queue>


//Macro
#define TEST int tjsf;scanf("%d",&tjsf);while(tjsf--)
#define S scanf
#define P printf
#define mp make_pair

using namespace std;

int main()
{
	int arr[1002][1002],dp[1002][1002],m,n,i,j;
	string s;
	TEST
	{
		S("%d %d",&n,&m);
		for(i=0;i<=n+1;i++)
		{
			for(j=0;j<=m+1;j++)
			{
				dp[i][j]=0;
				arr[i][j]=2;
				}
			}
		for(i=1;i<=n;i++)
		{
			cin >> s;
			for(j=1;j<=m;j++)
				arr[i][j]=s[j-1]-48;
			}
		queue< pair<int,int> > q1;
		q1.push(mp(1,1));
		dp[1][1]=1;
		pair<int,int> top;
		int num,x,y,temp;
		while(!q1.empty())
		{
			top=q1.front();
			q1.pop();
			x=top.first;
			y=top.second;
			num=dp[x][y];
			++num;
			temp=1-arr[x][y];
			x--;
			if(arr[x][y]==temp && dp[x][y]==0)
			{
				dp[x][y]=num;
				q1.push(mp(x,y));
				}
			x+=2;
			if(arr[x][y]==temp && dp[x][y]==0)
			{
				dp[x][y]=num;
				q1.push(mp(x,y));
				}
			x--;
			++y;
			if(arr[x][y]==temp && dp[x][y]==0)
			{
				dp[x][y]=num;
				q1.push(mp(x,y));
				}
			y-=2;
			if(arr[x][y]==temp && dp[x][y]==0)
			{
				dp[x][y]=num;
				q1.push(mp(x,y));
				}
			}
		if(dp[n][m]>0)
				P("%d\n",dp[n][m]);
		else
				P("-1\n");
		}
	return 0;
	}
