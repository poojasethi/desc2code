#include <iostream>
#include<string.h>
#include<stdio.h>
#include<stdlib.h>
#include<vector>
#include<map>
#include<queue>
#include<stack>
#include<iomanip>
#include<utility>
#include<bitset>
#include<ctype.h>
#define ll long long
#define mod 1000000007
using namespace std;

int main() {
	int dx[]={0,0,1,-1};
	int dy[]={-1,1,0,0};
	int t;
	scanf("%d",&t);
	while(t--)
	{    int n,m;
		scanf("%d %d",&n,&m);
		vector<string>v;
		for(int i=0;i<n;i++)
		{
			string s;
			cin>>s;
			v.push_back(s);
		//	cout<<v[i]<<endl;
		}
		int dp[n][m];
		memset(dp,-1,sizeof(dp));
		queue<pair<int,int> >q;
		q.push(make_pair(0,0));
		dp[0][0]=1;
		while(!q.empty())
		{
			int x=q.front().first;
			int y=q.front().second;
			q.pop();
			for(int i=0;i<4;i++)
			{
				int x1=x+dx[i];
				int y1=y+dy[i];
				if(x1>=0 and x1<n and y1>=0 and y1<m)
				{
				     if(v[x][y]!=v[x1][y1])
			        	{
				        	if(dp[x1][y1]==-1)
				                	{
				          		dp[x1][y1]=dp[x][y]+1;
				           		q.push(make_pair(x1,y1));
				                         	}
				            }
		           	}
			
			}
		}
		cout<<dp[n-1][m-1]<<endl;
		
	}
	
	
	// your code goes here
	return 0;
}