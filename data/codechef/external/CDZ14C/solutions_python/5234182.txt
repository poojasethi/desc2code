#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define pb push_back
#define mp make_pair
#define fast(){cin.sync_with_stdio(false); cin.tie(false);cout.tie(false);}
#define INF 1000005
#define MAX 1005
#define mod 1000000007
string s[MAX];
int dp[MAX][MAX];
int dx[] = { 1,0,-1,0};
int dy[] = { 0,1 ,0,-1}; 
int solve(int n , int m)
{
	queue< pair<int,int > >q;
	q.push(mp(0,0));
	while(!q.empty())
	{
		pair<int,int>temp = q.front();
		int x= temp.first;
		int y= temp.second;
		q.pop();
		for(int i=0;i<4;i++)
		{
			int xx= x + dx[i];
			int yy= y + dy[i];
			if(xx>=0 && yy>=0 && xx<n && yy<m)
			{
				if(s[x][y]!=s[xx][yy])
				if(dp[x][y]+1<dp[xx][yy])
				{
					dp[xx][yy]= dp[x][y]+1;
					q.push(mp(xx,yy));
				}
			} 
		}
	}
}
int main()
{
	fast();
	int t;
	cin>>t;
	while(t--)
	{
	  int n,m;
	  cin>>n>>m;
	  for(int i=0;i<=n;i++)
	   for(int j=0;j<=m;j++)
	    dp[i][j]=INF;
	  dp[0][0]=1;  
	  for(int i=0;i<n;i++)
	   cin>>s[i];
	   solve(n,m);
	   if(dp[n-1][m-1]!=INF)
	   cout<<dp[n-1][m-1]<<endl;
	   else
	   cout<<"-1"<<endl;
	}
}