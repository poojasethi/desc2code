#include<bits/stdc++.h>
#define long long int
#define pb push_back
using namespace std;

struct ver
{
	int first;
	int second;
	int dist;	
};

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int flag=-1;
		int n,m;
		scanf("%d%d",&n,&m);
		int a[n][m];
		for(int i=0;i<n;++i)
		{
			string s;
			cin>>s;
			for(int j=0;j<m;++j)
			{
				a[i][j]=s[j]-48;
				
			}
		}
		bool vst[n][m];
		for(int i=0;i<n;++i)
		{
			for(int j=0;j<m;++j)
			vst[i][j]=false;
		}
		ver v;
		v.first=0;
		v.second=0;
		v.dist=0;
		queue<ver> q;
	    vst[0][0] = true;
    	q.push(v);
   		while(!q.empty())
    	{
    	    ver temp = q.front();
        	q.pop();
        	int i=temp.first;
        	int j=temp.second;
        	if(i==n-1&&j==m-1)
        	{
        		flag=temp.dist+1;
        		break;
			}
        	if(i-1>=0)
        	{
        		if(a[i][j]!=a[i-1][j])
        		{
        			if(vst[i-1][j]==false)
        			{
        				vst[i-1][j]=true;
        				ver tt;
        				tt.first=i-1;
        				tt.second=j;
        				tt.dist=temp.dist+1;
        				q.push(tt);
					}
				}
			}
			if(i+1<n)
        	{
        		if(a[i][j]!=a[i+1][j])
        		{
        			if(vst[i+1][j]==false)
        			{
        				vst[i+1][j]=true;
        				ver tt;
        				tt.first=i+1;
        				tt.second=j;
        				tt.dist=temp.dist+1;
        				q.push(tt);
					}
				}
			}
			if(j-1>=0)
        	{
        		if(a[i][j]!=a[i][j-1])
        		{
        			if(vst[i][j-1]==false)
        			{
        				vst[i][j-1]=true;
        				ver tt;
        				tt.first=i;
        				tt.second=j-1;
        				tt.dist=temp.dist+1;
        				q.push(tt);
					}
				}
			}
			if(j+1<m)
        	{
        		if(a[i][j]!=a[i][j+1])
        		{
        			if(vst[i][j+1]==false)
        			{
        				vst[i][j+1]=true;
        				ver tt;
        				tt.first=i;
        				tt.second=j+1;
        				tt.dist=temp.dist+1;
        				q.push(tt);
					}
				}
			}
    	}
    	cout<<flag<<endl;
	}
	return 0;
}