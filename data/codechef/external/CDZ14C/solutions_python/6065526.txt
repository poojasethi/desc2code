#include<iostream>
#include<queue>
#define mp make_pair
using namespace std;
int arr[1001][1001];
int d[1001][1001];
int n,m;

queue<pair<int,int> > q1;
pair<int,int> top;
void bfs(int i,int j)
{
    d[i][j]=1;int x,y,temp,num=0;
    q1.push(mp(i,j));
    while(!q1.empty())
    {
        top=q1.front();
        q1.pop();
        x=top.first;
        y=top.second;
        temp=arr[x][y];
        num=d[x][y];
        num++;
        if(x+1<=n)
        if(arr[x+1][y]!=temp&&d[x+1][y]==0)
            {
                q1.push(mp(x+1,y));
                d[x+1][y]=num;
            }
        if(y+1<=m)
        if(arr[x][y+1]!=temp&&d[x][y+1]==0)
            {
                q1.push(mp(x,y+1));
                d[x][y+1]=num;
            }
        if(x-1>=1)
        if(arr[x-1][y]!=temp&&d[x-1][y]==0)
            {
                q1.push(mp(x-1,y));
                d[x-1][y]=num;
            }
        if(y-1>=1)
        if(arr[x][y-1]!=temp&&d[x][y-1]==0)
            {
                q1.push(mp(x,y-1));
                d[x][y-1]=num;
            }

    }
}
int main()
{
int t,i,j;
cin>>t;
while(t--)
{
cin>>n>>m;
char str;
for(i=1;i<=n;i++)
  for(j=1;j<=m;j++)
     {
    cin>>str;arr[i][j]=str-48;

     }


   bfs(1,1);
      //cout<<"Dp\n";

 if(!d[n][m])
cout<<"-1";
else
cout<<d[n][m];
 cout<<"\n";
  for(i=1;i<=n;i++)
     {
      for(j=1;j<=m;j++)
      d[i][j]=0;
     }
}
return 0;
}
