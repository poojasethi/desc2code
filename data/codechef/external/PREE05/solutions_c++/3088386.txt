#include<iostream>
#define LL long long int
#define M 1000000007

using namespace std;
int main()
{
    int t;
    LL n,*v,large_ind,large=-1,rest_incre,m,k,*incre,tot_incre;
    cin>>t;
    while(t--)
    {
        tot_incre=rest_incre=0;
        large=-1;
        cin>>n>>m>>k;
        v=new LL [n];
        incre=new LL[n];
        for(LL i=0;i<n;i++)
        {
            cin>>v[i];
            incre[i]=((m-v[i])/k)+1;
            if(large<incre[i])
                {
                    large_ind=i;
                    large=incre[i];
                }
         //   cout<<large<<" "<<incre[i]<<endl;

            tot_incre+=incre[i];
        }
        rest_incre=tot_incre-large;
    //cout<<tot_incre<<"  "<<rest_incre<<"  "<<large<<endl;
        LL temp=((large-(rest_incre%2))/2)%M;
        cout<<temp+1<<"\n";
    }
}
