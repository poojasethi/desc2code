#include<iostream>
 
using namespace std;
 
 
int a[52][52];
int v[52],gb;
int ans[52],fire;
 
int solve(int term,int ans[],int index)
{
int i,j;
if(term == fire)
{
gb++;
for(i=0;i<index;i++)
printf("%d ",ans[i]);
printf("\n");
return 0;
}
for(i=0;i<52;i++)
{
if(a[term][i]==1 && v[i]==0 && i!=term)
{
v[i] = 1;
ans[index] = i;
solve(i,ans,index+1);
v[i] = 0;
}
}
return 0;
}
 
int main()
{
int t,i,j,k,l,m,n,x,y,count=1,ans[52];
scanf("%d",&t);
while(t--)
{
gb=0;
for(i=0;i<52;i++)
{
v[i]=0;
for(j=0;j<52;j++)
{
a[i][j]=0;
}
}
scanf("%d",&fire);
while(1)
{
scanf("%d %d",&x,&y);
if(x==y&&y==0)
break;
a[x][y]=1;
a[y][x]=1;
}
printf("CASE %d:\n",count++);
v[1] = 1;
ans[0] = 1;
solve(1,ans,1);
printf("There are %d routes from the firestation to streetcorner %d.\n",gb,fire);
}
return 0;
}