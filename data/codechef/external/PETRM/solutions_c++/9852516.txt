#include <bits/stdc++.h>
#define ll long long int
#define s(a) scanf("%lld",&a)
#define f first
#define sc second
#define pb push_back
#define mp make_pair
#define inf 10e16

using namespace std;

ll factor[100001];
ll value[100001];
ll ans[20][100001];
ll a[100001];
vector<ll>v[21];
ll dp[1<<20];
ll n;

void sieve()
{
    bitset<100001>b;
    ll i,j;
    for(i=2;i<=100000;i++) {
        if(b[i]==1) continue;
        for(j=i;j<=100000;j+=i) {
            b[j]=1;
            factor[j]=i;
        }
    }
    value[1]=0;
    for(i=2;i<=100000;i++) {
        value[i]=value[i/factor[i]]+1;
    }
}

ll recur(ll ind,ll mask)
{
    if(ind == n+1) {
        return 0;
    }
    if(dp[mask]>=0) return dp[mask];
    ll i,w=0;
    for(i=0;i<20;i++) {
        if(v[i].size()==0) continue;
        if(mask & (1<<i)) continue;
        w = max(w,ans[i][ind]+recur(ind+v[i].size(),mask|(1<<i)));
    }
    dp[mask]=w;
    return w;
}

int main()
{
    sieve();
    ll i,j,k,l,w,ww,x,y,z,sum,val,cur;

    for(i=0;i<(1<<20);i++) {
        dp[i]=-1;
    }

    s(n);
    for(i=1;i<=n;i++) {
        s(x);s(y);
        a[x]=y;
    }
    for(i=1;i<=n;i++) {
        v[value[i]].pb(a[i]);
    }
    for(i=0;i<20;i++) {
        sort(v[i].begin(),v[i].end());
        sum = 0;
        val = 0;
        cur = 0;
        for(j=0;j<v[i].size();j++) {
            sum = sum + v[i][j];
            val = val + (3 + 2*j)*v[i][j];
            cur = cur + (j+1)*(j+1)*v[i][j];
        }
        ans[i][1] = cur;
        for(j=2;j<=100000;j++) {
            cur = cur + val;
            val = val + 2*sum;
            ans[i][j] = cur;
        }
    }
    cout<<recur(1,0)<<endl;
    return 0;
}


/*
10
1 21
2 133
3 123
4 234
5 273
6 926
7 913
8 421
9 466
10 1

*/
