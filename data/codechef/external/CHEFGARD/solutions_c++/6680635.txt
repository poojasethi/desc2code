#include <iostream>
#include <cstdlib>

using namespace std;

#define INF 100000000000000

long long cost[100010][3];
long long minDif[100010], minDif2[100010], mix1[100010], mix2[100010];

int main()
{
    int t;
    cin>>t;
    for (int i=0; i<t; i++)
    {
        int n;
        string word;
        cin>>n>>word;
        for (int j=1; j<=n; j++)
        {
            long long val;
            cin>>val;
            cost[j][0] = cost[j-1][0] + (word[j-1]=='R'?0:val);
            cost[j][1] = cost[j-1][1] + (word[j-1]=='G'?0:val);
            cost[j][2] = cost[j-1][2] + (word[j-1]=='B'?0:val);
        }
        long long total = INF;
        for (int j=0; j<3; j++)
        {
            for (int k=0; k<3; k++)
            {
                if (j==k)
                   continue;
                for (int m=0; m<3; m++)
                {
                    if (m==j || m==k)
                       continue;
                    minDif[0] = minDif2[0] = INF;
                    for (int p=1; p<=n; p++)
                    {
                        long long dif = cost[p][j] - cost[p][k];
                        minDif[p] = min(minDif[p-1], dif);
                        mix1[p] = cost[p][k] + minDif[p];
                        dif = mix1[p] - cost[p][m];
                        minDif2[p] = min(minDif2[p-1], dif);
                        mix2[p] = cost[p][m] + minDif2[p];
                    }
                    total = min(total, mix2[n]);
                }
            }
        }
        cout<<total<<endl;
    }
    //system("pause");
    return 0;
}
