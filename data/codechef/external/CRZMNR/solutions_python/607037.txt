#include <stdio.h>
#include <string.h>
#define N 111

int n, L, l[N], m[N], d[N], f[N][N], a[N][N], b[N][N];

void proc(int u)
{
int i, j, k=0, v, c;
for(m[u]=1; k<=L; f[u][k++]=d[u]);
for(i=0; i<l[u]; i++)
	if((!!(c=b[u][i])||!c)&&!m[v=a[u][i]])
		for(k=L,proc(v); k>=0; k--)
			for(j=0; j<=k-c; f[u][k]=(f[u][k]<(f[u][j]+f[v][k-c-j]))?(f[u][j]+f[v][k-c-j]):f[u][k],j++);
}

main()
{
int fall, q=0, i, u, v, r;
for(scanf("%d",&fall); fall--; memset(m,0,sizeof(m)),proc(0),printf("Case #%d: %d\n",++q,f[0][L]))
	{
	for(i=-!!scanf("%d %d",&n,&L),L/=2; ++i<n; l[i]=!scanf("%d",d+i));
	for(i=0; ++i<n; scanf("%d %d %d",&u,&v,&r),a[u][l[u]]=v,b[u][l[u]++]=r,a[v][l[v]]=u,b[v][l[v]++]=r);
	}
return 0;
}
