#include <iostream>
#include <set>
#include <stdio.h>
#include <vector>
#include <algorithm>
#include <string.h>

using namespace std;

char str[1000010];

int main() {
	// your code goes here
   
    int test;
    cin>>test;
    while(test--)
     {
         scanf("%s",str+1);
         int len = strlen(str+1);
         int k,l;
         cin>>k>>l;
         
         
         // find the longest subsequence which can be formed where length of V = LCS
         
         char c = str[1];
         int count = 1;
         int minlen = 0;
         
         vector<int> vec,extra;
         
         for(int i=2;i<=len;i++)
          {
             if(str[i] == c)
              {
                 count++; 
              }
              else
              {
                 vec.push_back(count);
                 c = str[i];
                 count = 1;
              }
          }
          
          vec.push_back(count);
          
          for(int i=0;i<vec.size();i++)
           {
               int x = vec[i];
               if(x<=k)
                {
                   minlen += x;               
                }
                else
                {
                   x -= k;
                   minlen += k;
                   while(x>0)    
                    {
                       extra.push_back(min(x,k));
                       x -=k;
                    }
                }
           }
           
          
           
        if(minlen >= l)
         {
             cout<<l<<endl;
             continue;
         }
         
         sort(extra.begin(),extra.end());
         
         int lcs = minlen;
         
         for(int i=extra.size()-1;i>=0;i--)
          {
               lcs += extra[i];
               minlen = minlen + extra[i] + 1;
               if(lcs >= l)
                break;
               
          }
         cout<<minlen+l-lcs<<endl;
         
     }
   
	return 0;
}
