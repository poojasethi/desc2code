#include<stdio.h>
#include<stdlib.h>
#include<math.h>
#include<string.h>
#include<iostream>
#include<algorithm>
#include<vector>
#include<string>
 
using namespace std;
 
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define sc(n) scanf("%c",&n);
#define f(i,a,b) for(i=a;i<b;i++)
#define pb push_back
#define mod 1000000007
 
typedef unsigned long long int ull;
typedef long long int ll;
 

char c[1000005];
int rep[1000005];
vector<int> counter;

int main(){
	ll t,i,j;
	scanf("%lld",&t);
	ll l,k;
	ll len=0;
	while(t--){
		counter.clear();
		scanf("%s",&c);
		len=strlen(c);
		scanf("%lld%lld",&k,&l);
		ll index=0;
		rep[0]=1;
		for(i=1;i<len;i++){
			if(c[i]==c[i-1])
				rep[index]++;
			else{
				index++;
				rep[index]=1;
			}
		}
		ll availLength=0;
		for(i=0;i<=index;i++){
			if(rep[i]>k){
				availLength+=k;
				rep[i]-=k;
			}
			else{
				availLength+=rep[i];
				rep[i]=0;
			}
		}
		ll remain=0;
		if(availLength>=l)
			printf("%lld\n",l);
		else{
			remain=l-availLength;
			for(i=0;i<=index;i++){
				if(rep[i]==0)
					continue;
				else{
					while(rep[i]>k){
						counter.push_back(k+1);
						rep[i]-=k;
					}
					counter.push_back(rep[i]+1);
				}
			}
			sort(counter.rbegin(),counter.rend());
			j=0;
			while((remain)>=(counter.at(j)-1)){
				availLength+=counter.at(j);
				remain-=counter.at(j)-1;
				j++;
				if(remain==0)
					break;
			}
			if(remain!=0){
				availLength+=(remain+1);
			}
			printf("%lld\n",availLength);
		}
	}
	return 0;
}   