#include <bits/stdc++.h>

using namespace std;

int Find (string S, int L, int K)
{
	priority_queue < int > Q;
	int n = S.length ();
	int curr = 0, temp = 1;
	for (int i = 0; i < n - 1; i++)
	{
		if (S[i] == S[i + 1])
			temp++;
		else
		{
			curr += min (K, temp);
			temp -= min (K, temp);
			if (temp)
				Q.push (temp);
			temp = 1;
		}
	}
	curr += min (K, temp);
	temp -= min (K, temp);
	if (temp)
		Q.push (temp);
	if (curr >= L)
		return L;
	int res = L;
	while (curr < L)
	{
		temp = Q.top ();
		Q.pop ();
		curr += min (temp, K);
		temp -= min (temp, K);
		if (temp)
			Q.push (temp);
		res++;
	}
	return res;
}

int main ()
{
	int T, L, K;
	string S;
	cin >> T;
	while (T--)
	{
		cin >> S;
		cin >> K >> L;
		cout << Find (S, L, K) << endl;
	}
	return 0;
}
