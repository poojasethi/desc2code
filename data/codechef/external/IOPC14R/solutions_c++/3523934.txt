#include <iostream>
#include <cstdio>
#include <queue>
#include <cstring>

using namespace std;

char str[1000010];

int main()
{
	
	priority_queue<int> q;
	int t,k,l,cost,lcs,count,n,i,temp;
	char cur;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%s %d %d",str,&k,&l);
		n=strlen(str);
		while(!q.empty()) q.pop();
		
		cost=0;
		lcs=0;
		
		cur=str[0];
		count=1;
		for(i=1;i<=n;i++)
		{
			if(str[i]==cur) count++;
			else
			{
				if(count>k)
				{
					cost+=k;
					lcs+=k;
					q.push(count-k);
				}
				else
				{
					cost+=count;
					lcs+=count;
				}
				cur=str[i];
				count =1;
			}
		}
		
		if(lcs>=l) printf("%d\n",l);
		else
		{
			while(q.top()>=k && lcs+k<l)
			{
				lcs+=k;
				cost+=k+1;
				temp=q.top();
				temp-=k;
				q.pop();
				q.push(temp);
			}
			if(lcs+q.top()>=l) printf("%d\n",cost+l-lcs+1);
			else
			{
				while(lcs+q.top()<l)
				{
					lcs+=q.top();
					cost+=q.top()+1;
					q.pop();
				}
				printf("%d\n",cost+l-lcs+1);
			}
		}
	}
	return 0;
}