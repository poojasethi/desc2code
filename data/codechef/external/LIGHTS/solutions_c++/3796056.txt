#include <iostream>
#include <algorithm>
#include<stdio.h>
#include<math.h>
#define ll long long
using namespace std;
 
int n,t,i=0,j=0,k,m,sum=0,r;
/*long long  getn()
{long long  i=0;
 char ch=getchar_unlocked();
 while(ch>'9'||ch<'0')
ch=getchar_unlocked();
 while(ch<='9'&&ch>='0')
 {i=(i<<1)+(i<<3)+ch-'0';
 ch=getchar_unlocked();
 }
return i;
}
*/
 
int main(){
char a[101][101];
cin>>t;
for(i=0;i<t;i++){
cin>>m>>n>>k;
int c[101]={0};
for(j=0;j<m;j++){
scanf("%s",a[j]);
}
for(j=0;j<m;j++){
for(r=0;r<n;r++){
if(a[j][r]=='*')
c[j]++;
}
}
sort(c,c+m);
for(j=0;j<m;j++){
if((c[j]<=n/2)&&k>0){
k--;
c[j]=n-c[j];
}
}
int d=1000000;
for(j=0;j<m;j++){
d=min(d,c[j]);
}
 
 
if(k%2==0){
for(j=0;j<m;j++){
sum=sum+c[j];
}
}
if(k%2!=0){
for(j=0;j<m;j++){
sum=sum+c[j];
}
sum=sum+n-2*d;
}
cout<<sum<<endl;
sum=0;
 
}
return 0;
}