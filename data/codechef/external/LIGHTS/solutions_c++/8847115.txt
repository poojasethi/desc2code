#include <bits/stdc++.h>
using namespace std;
#define maxn 55
int main()
{
	int t;
	cin>>t;
	char c;
	while(t--)
	{	int x[55],z[55];
		int n,m,k,total = 0;
		cin>>n>>m>>k;
		for(int i = 0;i<n;i++)
		{
			int y  = 0;
			for(int j = 0;j<m;j++)
			{
				cin>>c;
				if(c=='*')
				{
					y++;
				}
			}
			x[i] = y;
			
		}
		sort(x,x+n);
		
		int done = 0;
		int i = 0;
		while(i<n && done<k)
		{
			if(m-2*x[i]>=1)
			{
				
				x[i] = m - x[i];
				i++;
				done++;
			}
			else
			{
				break;
			}
			
		}
		int rem = k-done;
		sort(x,x+n);
		
		if(rem&1)
		{
		 	x[0]=m-x[0];
		}
		for(int i =  0;i<n;i++)
		{
			total+=x[i];
		}
		cout<<total<<endl;
	
	}
	return 0;
}