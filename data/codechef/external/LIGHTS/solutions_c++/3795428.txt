#include<iostream>
#include<algorithm>
 
using namespace std;
 
main()
{
 int t,count,i,j,sum,m,n,k,min;
 char s[100][100];
 
 scanf("%d",&t);
 while(t--)
      {
       scanf("%d %d %d",&n,&m,&k);
       sum=0;
 
        	
        for(i=0;i<n;i++)
	    scanf ("%s",&s[i]);
		
        int a[100]={0};
	
    	for(i=0;i<n;i++)
          {
	   count=0;
	   for(j=0;j<m;j++)
	       {
                if(s[i][j]=='*')
                count++;
                } 
           a[i]=count;
	  }
		
        sort (a,a+n);
        
        
		
        for(i=0;i<n;i++)
            {
	     if(a[i]<=m/2&&k>0)
		{
		 sum=sum+(m-a[i]);
		 a[i]=(m-a[i]);
		 k--;
		}
			
            else
             sum=sum+a[i];
	   }
	   
	 
 
		if(k%2==1)
		  {
                   min=a[0];       
		   for(i=1;i<n;i++)
               {    
                if(a[i]<=min)
                   min=a[i];
               }
           
           sum=sum+m-(2*min);
          }
          
    printf("%d\n",sum);
         }
 
    return 0;
 
}  