#include<iostream>
#include<vector>
#include<algorithm>
using namespace std;

bool myf(int a,int b)
{
  return b>a;
}

int main()
{
  int t;
  cin>>t;
  char mat[100][100];

  while(t--)
    {
      int n,m,k;
      
      cin>>n>>m>>k;
      vector<int> lights(n);

      for(int i = 0;i<n;i++)
	for(int j = 0;j<m;j++)
	  cin>>mat[i][j];

      /*      cout<<"Got : \n";
      for(int i = 0;i<n;i++)
	for(int j = 0;j<m;j++)
	  cout<<mat[i][j]<<" ";
      */

      for(int i = 0;i<n;i++)
	{
	  int cno = 0;
	  for(int j = 0;j<m;j++)
	    if(mat[i][j]=='*')
	      cno++;
	  lights[i] = cno;
	}
      
      sort(lights.begin(),lights.end(),myf);

      int mby2 = m/2;

      //      for(int jj = 0;jj<lights.size();cout<<lights[jj]<<" ",jj++);

      int i;

      if(m%2==0)
	for(i = 0;i<n;i++)
	  {
	    if(k==0)
	      break;
	    
	    if(lights[i]<mby2)
	      {
		k--;
		lights[i] = m - lights[i];
		//		cout<<endl;
		//		for(int jj = 0;jj<lights.size();cout<<lights[jj]<<" ",jj++);
	      }
	    else
	      break;
	  }
      else
	for(i = 0;i<n;i++)
	  {
	    if(k==0)
	      break;
	    
	    if(lights[i]<=mby2)
	      {
		k--;
		lights[i] = m - lights[i];
		//		cout<<endl;
		//		for(int jj = 0;jj<lights.size();cout<<lights[jj]<<" ",jj++);		
	      }
	    else
	      break;
	  }
	
      //      cout<<"Broke out\n";

      k = k%2;

      if(k==1)
	{
	  sort(lights.begin(),lights.end());
	  lights[0] = m - lights[0];
	  //	  cout<<endl;
	  //	  for(int jj = 0;jj<lights.size();cout<<lights[jj]<<" ",jj++);			
	}
      //      cout<<endl;
      //      for(int jj = 0;jj<lights.size();cout<<lights[jj]<<" ",jj++);

      int ans = 0;

      for(int i = 0;i<n;i++)
	{
	  ans +=lights[i];
	}
      cout<<ans<<endl;
    }
      
  
  return 0;
}
