#include<cstdio>
#include<iostream>
#include<algorithm>
using namespace std;
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int n,m,k;
		scanf("%d%d%d",&n,&m,&k);
		//	getchar();
		//	scanf("%d",&m);
		//	getchar();
		//	scanf("%d",&k);
		char c;
		char a;
		int array[n];
		int sum;
		int original=0;
		int i,j;
		for(i=0;i<n;i++)
		{
			getchar();
			for(j=0,sum=0;j<m;j++)
			{
				c=getchar();
				if(c=='.')
					sum++;
				else
				{
					sum--;
					original++;
				}
			}
			array[i]=-sum;
		}
		sort(array,array+n);
		sum=0;
		for(i=0;i<n && i<k && array[i]<=0;i++)
			sum=sum-array[i];
		if((k-i)%2==0)
			printf("%d\n",sum+original);
		else
		{
			if(i!=0)
			{
				if(i==n)
					printf("%d\n",sum+original+array[i-1]);
				else
				{
					if(-array[i-1]<array[i])
						printf("%d\n",sum+original+array[i-1]);
					else
						printf("%d\n",sum+original-array[i]);
				}
			}
			else
			{
				printf("%d\n",sum+original-array[0]);
			}

		}
	}
	return 0;
}



