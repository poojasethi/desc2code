#include<bits/stdc++.h>
using namespace std;
vector< int> v,vi;
char st[1005];
int main()
{
	int t,n,m,q,k,s,lp,o,f,i,j;
	cin>>t;
	while(t--)
	{
		lp=0;
		v.clear();vi.clear();
		cin>>n>>m>>k;
		for(i=0;i<n;i++)
		{
			o=f=0;
				scanf("%s",st);
				//l=strlen(st);
				for(q=0;q<m;q++)
					if(st[q]=='.') f++;
					else o++;
				lp+=o;
				if(f-o>0)
				v.push_back(f-o);
				else
				vi.push_back(f-o);
		}
		sort(v.begin(),v.end());
		reverse(v.begin(),v.end());
		sort(vi.begin(),vi.end());
		if(k<=v.size())
		{
			s=0;
			for(i=0;i<k;i++) s+=v[i];
			cout<<lp+s<<"\n";
		//cout<<"sdhbf"<<k<<"\n";
		}
		else
		{
			s=0;
			int y=v.size();
			for(i=0;i<y;i++) s+=v[i];
			if(vi.size()==0)
			{
				k-=v.size();
				//cout<<"sdhbf"<<k<<"\n";
				k=k%2;
				if(k==1)
					s-=v[v.size()-1];
			}
			else if(v.size()==0)
			{
				k=k%2;
				if(k==1)
					s+=vi[vi.size()-1];
			}
			else if(abs(vi[vi.size()-1])<=v[v.size()-1])
			{
				k-=v.size();
				//cout<<"sdhbf"<<k<<"\n";
				k=k%2;
				if(k==1)
					s+=vi[vi.size()-1];
			}
			else if(abs(vi[vi.size()-1])>v[v.size()-1])
			{
				k-=v.size();
				//cout<<"sdhbf"<<k<<"\n";
				k=k%2;
				if(k==1)
					s-=v[v.size()-1];
			}
			cout<<lp+s<<"\n";
		}
	}
	return 0;
}