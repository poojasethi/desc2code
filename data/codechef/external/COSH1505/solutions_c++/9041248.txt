#include <cstdio>
#include <iostream>
#include <map>
#include <climits>
#include <set>
#include <cmath>
#include <cstdlib>
using namespace std;
int getDistance(int x1, int y1, int x3, int y3)
{
	return abs(x1-x3) + abs(y1-y3);
}
int main()
{
	int t;
	scanf("%d",&t);

	while(t--)
	{
		set<pair<int, int> > mp1;
		set<pair<int, int> > mp3;
		int m;
		scanf("%d",&m);
		int** arr = new int*[m];
		for(int i=0;i<m;i++)
			arr[i] = new int[m];

		for(int i=0;i<m;i++)
			for(int j=0;j<m;j++)
			{	
				scanf("%d",&arr[i][j]);
				if(arr[i][j] == 1)
					mp1.insert(make_pair(i,j));
				if(arr[i][j] == 3)
					mp3.insert(make_pair(i,j));
			}

		int ans = -INT_MAX;
		for(set<pair<int, int> >::iterator it1 = mp1.begin();it1 != mp1.end();it1++)		
		{
			int best = INT_MAX;
			for(set<pair<int, int> >::iterator it3 = mp3.begin();it3 != mp3.end();it3++)
			{
				int min = getDistance(it1->first,it1->second,it3->first,it3->second);
				if(min < best)
					best = min;
			}
			if(best > ans)
				ans = best;
		}
		cout<<ans<<endl;
	}
}