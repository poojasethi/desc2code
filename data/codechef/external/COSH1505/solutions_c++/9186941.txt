#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <string.h>
#include <algorithm>
#include <math.h>
#include <vector>
#include <queue>
#include <set>
#include <stack>
#include <map>
#define INF_MAX 2147483647
#define INF_MIN -2147483647
#define INF_LL 9223372036854775807LL
#define INF 2000000000
#define PI acos(-1.0)
#define inf INT_MAX
using namespace std;
typedef long long int LL;
std::vector< pair<int , int > > one , three;
int main(){
int test , M , temp;
scanf("%d",&test);
for(int i=0;i<test;i++)
{
	one.clear();
	three.clear();
	scanf("%d",&M);
	for(int i=1;i<=M;i++)
	{
		for(int j=1;j<=M;j++)
		{
			scanf("%d",&temp);
			if(temp==1)
				one.push_back(make_pair(i,j));
			if(temp==3)
				three.push_back(make_pair(i,j));
		}
	}
	int dist = 0 , min_dist;
	for(int i=0;i<one.size();i++)
	{
		min_dist = 1000000;
		for(int j=0;j<three.size();j++)
		{
			if(abs(three[j].first - one[i].first) + abs(three[j].second - one[i].second) < min_dist)
				min_dist = abs(three[j].first - one[i].first) + abs(three[j].second - one[i].second);
		}
		if(min_dist>dist)
			dist = min_dist;
	}
	cout << dist << endl;
}
return 0;
}



