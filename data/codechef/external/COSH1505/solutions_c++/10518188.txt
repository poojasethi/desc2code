#include<bits/stdc++.h>
using namespace std;
int main()
{
    ios_base::sync_with_stdio(false);
    int t,m,a[100][100],i,j,x,k,l,x1,r2;
cin>>t;
while(t--)
{cin>>m;x=0;x1=0;r2=200;l=0;
int c[100],r[100],c1[100],r1[100];
for(i=0;i<m;i++)
{
for(j=0;j<m;j++)
{
cin>>a[i][j];
if(a[i][j]==1)
{
c[x]=i;
r[x]=j;
x++;}
if(a[i][j]==3)
{
c1[x1]=i;
r1[x1]=j;
x1++;}}}
for(i=0;i<x;i++)
{
for(j=0;j<x1;j++)
{
k=abs(c[i]-c1[j])+abs(r[j]-r1[j]);
if(k<r2)
r2=k;}
if(r2>l)
l=r2;}
cout<<l<<"\n";

}
}