#include<bits/stdc++.h>
using namespace std;
int main()
{
	int i,j,m,num,n1,n3,x1,y1,diff1,diff2,t;
	scanf("%d",&t);
	while(t--)
	{
	scanf("%d",&m);
	vector<pair<int,int> > v1,v3;
	for(i=0;i<m;i++)
	{
		for(j=0;j<m;j++)
		{
			scanf("%d",&num);
			if(num==1)
			{
				v1.push_back(make_pair(i,j));
			}
			else if(num==3)
			{
				v3.push_back(make_pair(i,j));
			}
		}
	}
	n1=v1.size();
	n3=v3.size();
	int maxi=0,mini;
	for(i=0;i<n1;i++)
	{
		x1=v1[i].first;
		y1=v1[i].second;
		mini=1e9;
		for(j=0;j<n3;j++)
		{
			diff1=x1-v3[j].first;
			diff2=y1-v3[j].second;
			if(diff1<0)
				diff1=-diff1;
			if(diff2<0)
				diff2=-diff2;
			mini=min(mini,diff1+diff2);
		}
		maxi=max(maxi,mini);
	}
	printf("%d\n",maxi);
}
	return 0;
}