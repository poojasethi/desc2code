#include <stdio.h>
#define mo 1000000007

int b[50][50];
long long x[70000], y[50], z[50][50];

long long losen(int n)
{
int i, j, k, t;
char c;
for(i=-1; ++i<n;)
	for(j=-1; ++j<n; b[i][j]=scanf(" %c",&c)&&(c=='Y'));
for(x[i=0]=1; ++i<(1<<n); x[i]=0);
for(i=-1; ++i<(1<<n);)
	for(j=-1; ++j<n;)
		if(!(i&(1<<j)))
			{
			for(k=0; k<n&&!(i&(1<<k)&&(b[j][k]==1)); k++);
			if(k==n)
				if((x[t=i^(1<<j)]+=x[i])>=mo) x[t]-=mo;
			}
return x[(1<<n)-1];
}

main()
{
int fall, a, v, w, i, j;
for(y[i=0]=1; ++i<50; y[i]=(i*y[i-1])%mo);
for(i=-1; ++i<50;)
	for(j=!(z[i][i]=z[i][0]=1); ++j<i; z[i][j]=(z[i-1][j]+z[i-1][j-1])%mo);
for(scanf("%d",&fall); fall--; scanf("%d %d %d",&a,&v,&w),printf("%lld\n",((((((((losen(a)%mo)*losen(v)%mo)*losen(w))%mo)*z[a+v+w][a+v])%mo)*z[a+v][a])%mo)));
return 0;
}
