#include <iostream>
#include <string.h>
#include <vector>
#include <set>
#include <cstdio>
 
#define LL long long
#define PII pair<int,int>
#define N 111
#define _T for(i=0; i<n; i++)for(j=0; j<n; j++)
 
using namespace std;
 
main()
{
int fall, n, i, j, h, cnt, x, y;
int mark[N][N], dx[4]={1,-1,0,0}, dy[4]={0,0,1,-1};
LL k, m, ans, dif, val, d;
LL a[N][N];
set<pair<LL,PII> > live;
 
for(scanf("%d",&fall); fall--;)
	{
	scanf("%d %lld %lld",&n,&k,&m);
	live.clear();
	cnt=0;
	memset(mark,0,sizeof(mark));
		_T{
			scanf("%lld",&a[i][j]);
			m-=a[i][j];
			if(a[i][j]>=k)
				{
				mark[i][j]=1;
				cnt++;
				}
			}
		_T if(a[i][j]<k)
			{
			for(h=0; h<4; h++)
				{
				x=i+dx[h];
				y=j+dy[h];
				if(0<=x&&x<n&&0<=y&&y<n&&a[x][y]>=k) break;
				}
			if(h<4)
				{
				mark[i][j]=1;
				cnt++;
				live.insert(make_pair(-a[i][j],make_pair(i,j)));
				}
			};
		if(m<=0) 
			{
			puts("0");
			continue;
			}
		if(cnt==0)
			{
			puts("Not possible");
			continue;
			}
		for(ans=dif=0;;)
			{
			if(live.empty())
				{
				ans+=(m+cnt-1)/cnt;
				break;
				}
			pair<LL,PII> p=*live.begin();
			val=-p.first+dif;
			i=p.second.first;
			j=p.second.second;
			d=k-val;
			if(m<=d*cnt)
				{
				ans+=(m+cnt-1)/cnt;
				break;
			}
		ans+=d;
		m-=cnt*d;
		dif+=d;
		live.erase(live.begin());
		for(h=0; h<4; h++)
			{
			x=i+dx[h];
			y=j+dy[h];
			if(0<=x&&x<n&&0<=y&&y<n&&!mark[x][y])
				{
				mark[x][y]=1;
				cnt++;
				live.insert(make_pair(-a[x][y]+dif,make_pair(x,y)));
				}
			}
		}
	printf("%lld\n",ans);
	}
return 0;
}