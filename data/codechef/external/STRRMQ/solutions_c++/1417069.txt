#include <cstdio>
#include <cstring>
 
#define N 1111 // >2^10
char S[N][N];
char *s[N];
int a[2*N];
 
int getmin(int i,int j)
{
        int cmp=strcmp(s[i],s[j]);
        if(cmp<0 || cmp==0 && i<j) return i;
        return j;
}
 
int main()
{
        int T;
        for(scanf("%d",&T);T--;)
        {
                int n,m,i,j;
                scanf("%d%d\n",&n,&m);
                for(i=0;i<n;i++)
                {
                        gets(S[i]);
                        s[i]=S[i];
                }
                S[n][0]='z'+1;
                S[n][1]=0;
                s[n]=S[n];
                int d=1;
                for(;d<n;d*=2);
                for(i=0;i<d;i++) a[d+i]=i<n?i:n;
                for(i=d-1;i>0;i--) a[i]=getmin(a[2*i],a[2*i+1]);
                int q;
                for(scanf("%d",&q);q--;)
                {
                        int t;
                        scanf("%d",&t);
                        if(t==1) {
                                scanf("%d",&i);
                                if(s[i]==0) continue;
                                s[i]++;
                                for(j=(i+d)/2;j>0;j/=2)
                                        a[j]=getmin(a[2*j],a[2*j+1]);
                        } else {
                                scanf("%d%d",&i,&j);
                                int ans=n;
                                for(i+=d,j+=d;i<=j;i/=2,j/=2)
                                {
                                        if(i%2) ans=getmin(ans,a[i++]);
                                        if(j%2==0) ans=getmin(ans,a[j--]);
                                }
                                printf("%d\n",ans);
                        }
                }
        }
        return 0;
}