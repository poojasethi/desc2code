#include <iostream>
#include <cstdio>
#include <cstring>

using namespace std;

const int N = 1111;

int n, m, q, t, x, y;
char a[N][N];
char *s[N];

void solve(int testNumber) {
    scanf("%d %d", &n, &m);
    for (int i = 0; i < n; ++i) {
        scanf("%s", a[i]);
        s[i] = a[i];
    }
    scanf("%d", &q);
    for (int i = 0; i < q; ++i) {
        scanf("%d", &t);
        if (t == 0) {
            scanf("%d %d", &x, &y);
            int res = x;
            for (int j = x + 1; j <= y; ++j) {
                if (strcmp(s[res], s[j]) > 0) {
                    res = j;
                }
            }
            printf("%d\n", res);
        }
        else {
            scanf("%d", &x);
            if (s[x] == 0) continue;
            ++s[x];
        }
    }
}

int main() {
    int testCount;
    scanf("%d", &testCount);
    for (int testNumber = 1; testNumber <= testCount; ++testNumber) {
        solve(testNumber);
    }
    return 0;
}

