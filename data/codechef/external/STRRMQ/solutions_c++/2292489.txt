#include<iostream>
#include<stdio.h>
#include<cstring>
#include<limits.h>
#define For(i,a,b) for(i=a;i<b;i++)
using namespace std;
char A[1005][1005];
char *s[1005];
int main()
{
int T,N,M,Q,i,temp,x,y,min;
scanf("%d",&T);
while(T--)
{
scanf("%d%d",&N,&M);
For(i,0,N)
{
scanf("%s",A[i]);
s[i]=A[i];
}
scanf("%d",&Q);
For(i,0,Q)
{
scanf("%d",&temp);
if(temp==1)
{
scanf("%d",&x);
if(A[x]==0)
continue;
s[x]++;
}
else
{
scanf("%d%d",&x,&y);
min=x;
For(x,x+1,y+1)
if(strcmp(s[min],s[x])>0)
min=x;
printf("%d\n",min);
}
}
}
return 0;
}