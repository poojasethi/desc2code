#include <bits/stdc++.h>
using namespace std;
inline int scan(){
    char c = getchar_unlocked();
    int x = 0;
    while(c < '0' || c > '9'){
        c = getchar_unlocked();
    }
    while(c >= '0' && c <= '9'){
        x = (x<<1) + (x<<3) + c - '0';
        c = getchar_unlocked();
    }
    return x;
}
const int N = 101;
int main(){
    int t = scan();
    while(t--){
        int graph[N][N];
        int n = scan() + scan();
        for(int i = 1 ; i < N ; ++i){
            for(int j = 1 ; j < N ; ++j){
                graph[i][j] = 9999;
            }
            graph[i][i] = 0;
            for(int j = i + 1 ; j <= i + 6 && j < N ; ++j){
                graph[i][j] = 1;
            }
        }
        while(n--){
            int a = scan() , b = scan();
            graph[a][b] = 0;
        }
        for(int k = 1 ; k < N ; ++k){
            for(int i = 1 ; i < N ; ++i){
                for(int j = 1 ; j < N ; ++j){
                    graph[i][j] = min(graph[i][j] , graph[i][k] + graph[k][j]);
                }
            }
        }
        printf("%d\n",graph[1][100]);
    }
}