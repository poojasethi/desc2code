#include <iostream>
#include <map>
#include <string.h>

	using namespace std;

	int main() 
	{int n,q,l,i;

	cin>>n;
	string s[n],o;
	long long int max,v[n],r;
	
	for(i=0;i<n;i++)
	{cin>>s[i]>>v[i];}
	
	cin>>q;
	string queries[q];
	
	for(i=0;i<q;i++)
	{
	    cin>>queries[i];
	
	/*
	for(r=0;r!=m.rend();r++)
	{
	if(rit->second->substr(0,l)=s)
	{
	cout<<rit->second<<endl;
	break;
	}
	}
	if(rit==M.rend())
	cout<<"NO"<<endl;*/
	l=queries[i].length();
	o='0';max=-1000000001;
	
	for(r=0;r<n;r++)
	{
	 if(v[r]>max && queries[i]==s[r].substr(0,l))
	  {o=s[r];max=v[r];}
	 if(o=="0" && r==(n-1))
	  {cout<<"NO"<<endl;
	   goto label;}
	
	}
	cout<<o<<endl;
	label:;
	}
	return 0;
	}
