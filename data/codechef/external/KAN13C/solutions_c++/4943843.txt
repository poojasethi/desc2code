#include<bits/stdc++.h>
using namespace std;
int arr[5000001];
void pre(string a){
	long long int i,j,q,k=0;
	arr[0]=0;
	for(i=1;i<a.length();i++){
		while(k>0 && a[k]!=a[i])
		     k=arr[k-1];
		if(a[k]==a[i])
		   k=k+1;
		arr[i]=k;
	}
	for(i=0;i<a.length();i++)
	    printf("%d ",arr[i]);
	printf("\n");
}
void KMP(string a,string b){
	pre(a);
	long long int i,j,q,k=0,count=0,flag=0,ans=0,temp=0;
	set<string>s;
	set<string>::iterator it;
	for(i=0;i<b.length();i++){
		while(k>0 && a[k]!=b[i]){
			s.insert(a.substr(i-k,i+1));
		    k=arr[k-1];
	    }
		if(a[k]==b[i]){
			k+=1;
			if(k==a.length()){
			   k=0;
			}
		}
	}
	for(it=s.begin();it!=s.end();it++)
	    cout<<*it<<endl;
	printf("%lld\n",s.size());
}
int main(){
	
	string a,b;
	while(1){
	cin>>a;
	if(a.compare("End")==0)
	   break;
	pre(a);
    }
	return 0;
}