//#include<utility> 
#include <iostream>
#include <cmath>
#include <vector>
#include <queue>
#include <algorithm>
#include <list>
#include <stack>
#include <string.h>
#include <sstream>
#include <stdio.h>
//#define mod 1000000007
using namespace std;
typedef  long long int ll;

int a[31][31][31][31];

int main()
{
    int t,n,i,j,k,l;
    char s1[32],s2[32],s3[33],s4[33];
    cin>>t;
    while(t--)
    {
        cin>>n;
        getchar();
        for(i=1;i<=n;i++)
            cin>>s1[i];
        getchar();
        for(i=1;i<=n;i++)
            cin>>s2[i];
        getchar();
        for(i=1;i<=n;i++)
            cin>>s3[i];
        getchar();
        for(i=1;i<=n;i++)
            cin>>s4[i];
        getchar();
        for(i=0;i<=n;i++)
            for(j=0;j<=n;j++)
                for(k=0;k<=n;k++)
                    for(l=0;l<=n;l++)
                    {

                        if(i==0||j==0||k==0||l==0)
                            a[i][j][k][l]=0;
                        else if (s1[i]==s2[j] && s2[j]==s3[k] && s3[k]==s4[l])
                            a[i][j][k][l]=a[i-1][j-1][k-1][l-1]+1;
                        else a[i][j][k][l]=max(max(a[i-1][j][k][l],a[i][j-1][k][l]),max(a[i][j][k-1][l],a[i][j][k][l-1]));
                    }
        cout<<a[n][n][n][n]<<endl;
    }
}