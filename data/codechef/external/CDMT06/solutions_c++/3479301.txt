#include <cstdio>
#include <cmath>
#include <iostream>
#include <algorithm>
#include <vector>
#include <map>
#include <set>
#include <stack>
#include <queue>
#include <utility> //pair
#include <cstdlib>
#include <cstring>
#include <string>
#include <climits>
#include <unistd.h>
#include <sys/types.h>
#define MOD 1000000007
#define MAX 102
typedef long long int ll;
using namespace std;

int man_list[MAX][MAX],woman_list[MAX][MAX],preference[MAX][MAX],n;
int man_hasto_propose[MAX];
int man_engaged_to[MAX],woman_engaged_to[MAX];

void stable_matching()
{
stack<int> free;
int m1,m,w,h=0,c=0,index;
   for(int i=1;i<=n;i++)
     {
       free.push(i);
       man_hasto_propose[i]=1;
       woman_engaged_to[i]=man_engaged_to[i]=0;
     }
       while(!free.empty())
        {
          m=free.top();
          index =man_hasto_propose[m];
          man_hasto_propose[m]+=1;
          w=man_list[m][index];
           if(woman_engaged_to[w]==0)
           {
              woman_engaged_to[w]=m;
              man_engaged_to[m]=w;
              free.pop();
              continue;
           }
             else
             {
               m1=woman_engaged_to[w];
               if(preference[w][m]>preference[w][m1])
               {
                 free.pop();
                 woman_engaged_to[w]=m;
                 man_engaged_to[m]=w;
                 free.push(m1);
               }
             }
        }
        for(int i=1;i<=n;i++)
        {
            if(man_list[i][1]==man_engaged_to[i])
                h++;
            if(woman_list[man_engaged_to[i]][1]==i)
                c++;
        }
        printf("%d %d\n",c,h);
}

int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
      scanf("%d",&n);
      for(int i=1;i<=n;i++)
      {
          int priority = 200;
          for(int j=1;j<=n;j++)
          {
             scanf("%d",&woman_list[i][j]);
             preference[i][woman_list[i][j]]= priority;
             priority--;
          }
      }
      for(int i=1;i<=n;i++)
          for(int j=1;j<=n;j++)
             scanf("%d",&man_list[i][j]);

      stable_matching();
    }
    return 0;
}
