#include<stdio.h>
#include<string.h>
#define MOD 1000000007

int main()
{
	char f[502];
	char op[502];
	int corr[500], i, j;
	long long res;
	
	while(1)
	{
		scanf("%s",f);
		
		if(f[0]=='0')
		break;
		
		i=j=0;
		
		while(f[i])
		{
			if(f[i]=='+' || f[i]=='-' || f[i] == '*' || f[i] == '/')
			op[j++]=f[i];
			
			i++;
		}
		op[j]='\0';
		
		for(i=0; i<=j; i++)
		scanf("%d",&corr[i]);
		
		res=corr[0];
		j=1;
		i=0;
		
		while(op[i])
		{
			if(op[i]=='/')
			res=(res/corr[j])%MOD;
			else if(op[i]=='*')
			res=(res*corr[j])%MOD;
			else if(op[i]=='+')
			res=(res+corr[j])%MOD;
			else if(op[i]=='-')
			res=(res-corr[j])%MOD;
			
			i++;
			j++;
		}
		
		printf("%lld\n",res);
	}
	
	return 0;
}