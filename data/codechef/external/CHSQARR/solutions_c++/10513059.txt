#include<bits/stdc++.h>
#define ll long long int
#define mp make_pair
#define pb push_back
#define si(x) scanf("%d",&x)
#define pi(x) printf("%d\n",x)
#define s(x) scanf("%lld",&x)
#define p(x) printf("%lld\n",x)

using namespace std;

ll ar[1002][1002],sum[1002][1002],maxx[1002][1002];
int main(){
ll n,m,i,j,q;
s(n);s(m);
memset(sum,0,sizeof(sum));
for(i=1;i<=n;i++){
        ll val=0;
    for(j=1;j<=m;j++){
        s(ar[i][j]);
        val+=ar[i][j];
        sum[i][j]=sum[i-1][j]+val;
    }
}

s(q);
while(q--){
    ll a,b;
    s(a);s(b);
    for(i=1;i<=n;i++){
        deque<ll>Q;
        for(j=1;j<=b;j++){
          while(!Q.empty() && ar[i][j]>=ar[i][Q.back()])  Q.pop_back();
          Q.pb(j);
        }
        for(j=b+1;j<=m;j++){
            maxx[i][j-1]=ar[i][Q.front()];
            while(!Q.empty() && ar[i][j]>=ar[i][Q.back()]) Q.pop_back();
            while(!Q.empty() && Q.front()<=j-b) Q.pop_front();
            Q.pb(j);
        }
        maxx[i][m]=ar[i][Q.front()];
    }
    ll ans=INT_MAX;
    for(i=b;i<=m;i++){
        deque<ll>Q;
        for(j=1;j<=a;j++){
            while(!Q.empty() && maxx[j][i]>=maxx[Q.back()][i]) Q.pop_back();
            Q.pb(j);
        }
        for(j=a+1;j<=n;j++){
            ll val=maxx[Q.front()][i];
            ll temp=sum[j-1][i]-sum[j-1-a][i]-sum[j-1][i-b]+sum[j-1-a][i-b];
            ans=min(ans,val*a*b-temp);
            while(!Q.empty() && maxx[j][i]>= maxx[Q.back()][i]) Q.pop_back();
            while(!Q.empty() && Q.front()<=j-a) Q.pop_front();
            Q.pb(j);
        }
        ll val=maxx[Q.front()][i];
        ll temp=sum[n][i]-sum[n-a][i]-sum[n][i-b]+sum[n-a][i-b];
        ans=min(ans,val*a*b-temp);
    }
    p(ans);
}
return 0;
}
