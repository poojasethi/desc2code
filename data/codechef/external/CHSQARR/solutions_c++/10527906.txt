#include<bits/stdc++.h>
using namespace std;
#define lli long long int
#define f(i,a,b) for(i=a;i<b;i++)
#define si(a) scanf("%d",&a);
#define slli(a) scanf("%lld",&a);
#define INF 1000000007
#define MAX 100005
#define pb(a) push_back(a)
#define sn struct node
lli tmp1[1005][1005],tmp[1005][1005],mat[1005][1005],A[1005][1005],B[1005][1005];
void fun2(lli arr[],lli n,lli k,lli index)
{
	lli size=0;
	deque<lli>deq;
	lli i,j,m;
    f(i,0,k)
    {
    	while(!deq.empty() && (arr[i] > arr[deq.back()]))
    		deq.pop_back();

    	deq.push_back(i);
    }
    
    f(j,i,n+1)
    {
    	B[size++][index]=arr[deq.front()];
    	
    	if(j==n)
    		break;

    	while(!deq.empty() && deq.front() < j-k+1)
    		deq.pop_front();

    	while(!deq.empty() && (arr[j] > arr[deq.back()]))
    		deq.pop_back();

    	deq.push_back(j);
    }
}
void fun1(lli arr[],lli n,lli k,lli index)
{
	lli i,j,m;
	lli size=0;
	deque<lli>deq;
	
    f(i,0,k)
    {
    	while(!deq.empty() && (arr[i] > arr[deq.back()]))
    		deq.pop_back();

    	deq.push_back(i);
    }
    
    f(j,i,n+1)
    {
    	A[size++][index]=arr[deq.front()];
    	
    	if(j==n)
    		break;

    	while(!deq.empty() && deq.front() < j-k+1)
    		deq.pop_front();

    	while(!deq.empty() && (arr[j] > arr[deq.back()]))
    		deq.pop_back();

    	deq.push_back(j);
    }
}
void fun3(lli n,lli m,lli a,lli b)
{
	lli i,row,col,cur,j;
	f(row,0,n)
	{
		cur=0;
		col=0;
		f(j,0,b)
		cur+=mat[row][j];

		tmp[col++][row]=cur;

		for(i=b;i<m;i++)
		{
			cur=cur-mat[row][i-b]+mat[row][i];
			tmp[col++][row]=cur;
		}
	}
}
void fun4(lli n,lli m,lli a,lli b)
{
lli i,row,col,cur,j;
	f(row,0,n)
	{
		cur=0;
		col=0;
		f(j,0,a)
		cur+=tmp[row][j];

		tmp1[col++][row]=cur;

		for(i=a;i<m;i++)
		{
			cur=cur-tmp[row][i-a]+tmp[row][i];
			tmp1[col++][row]=cur;
		}
	}	
}
int main()
{
	lli q,i,j,k,m,n,t,a,b,diff,Min;
    slli(n);
    slli(m);
    f(i,0,n)
    f(j,0,m)
    slli(mat[i][j]);

    slli(q);
    while(q--)
    {
    	slli(a);
    	slli(b);
    	f(i,0,n)
    	{
    		f(j,0,m)
    		{
    			A[i][j]=0;
    			B[i][j]=0;
    			tmp[i][j]=0;
    			tmp1[i][j]=0;
    		}
    	}

    	f(i,0,n)
    	{
    		fun1(mat[i],m,b,i);
    	}

    	f(i,0,m)
    	{
    		fun2(A[i],n,a,i);
    	}
    	
    	fun3(n,m,a,b);
    	fun4(m-b+1,n,a,b);
    	Min=INF;
    	for(i=0;i<n-a+1;i++)
    	{
    		for(j=0;j<m-b+1;j++)
    		{
    			
    			diff=(B[i][j]*a*b)-tmp1[i][j];
    			if(diff < Min)
    				Min=diff;
    		}
    	}
    	if(Min < 0)
    		Min=0;
    	printf("%lld\n",Min);
    }

}