#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define lim 1000
#define pb push_back
#define mp make_pair
#define INF 10000000
#define mod 1000000007
#define epsilon 1e-5
#define sd(n) scanf("%lld",&n)
ll arr[1001][1001];
ll a,b,n,m;
ll t1[1001][1001],mx[1001][1001],sum[1001][1001];
deque<ll>mq;
void sssum()
{
    for(ll j=1;j<=m-b+1;j++)
    {
        ll temp=0;
        for(ll i=1;i<=a;i++)
        {
            temp+=t1[i][j];
        }
        sum[1][j]=temp;
        ll i=2;
        while(i<=n+1-a)
        {
            temp-=t1[i-1][j];
            temp+=t1[i+a-1][j];
            sum[i][j]=temp;
            i++;
        }
    }
    // for(ll i=1;i<=n;i++)
    // {
    //     for(ll j=1;j<=m;j++)
    //         cout<<sum[i][j]<<" ";
    //     cout<<endl;
    // }
    return;
}
void ssum()
{ 
    for(ll i=1;i<=n;i++)
    {  ll temp=0;
        for(ll j=1;j<=b;j++)
        {
            temp+=arr[i][j];
        }
        t1[i][1]=temp;
        ll j=2;
        while(j<=m-b+1)
        {
            temp-=arr[i][j-1];
            temp+=arr[i][j+b-1];
            t1[i][j]=temp;
            j++;
        }
    }
    
    return sssum();
}
void make2()
{
    
    for(ll j=1;j<=m+b-1;j++)
    {   mq.clear();
        for(ll i=1;i<=a;i++)
        {
            while(!mq.empty()&&t1[mq.back()][j]<=t1[i][j])
                mq.pop_back();
            mq.push_back(i);
        }
        mx[1][j]=t1[mq.front()][j];
        ll i=2;
        while(i<=n-a+1)
        {
            while(!mq.empty()&&mq.front()<i)
                mq.pop_front();
             while(!mq.empty()&&t1[mq.back()][j]<=t1[i+a-1][j])
                mq.pop_back();
            mq.push_back(i+a-1);
            mx[i][j]=t1[mq.front()][j];
            i++;
        }

    }
     
    return;
}
void make()
{
    
    for(ll i=1;i<=n;i++)
    {    
          mq.clear();
        for(ll j=1;j<=b;j++)
        {
            while(!mq.empty()&&arr[i][mq.back()]<=arr[i][j])
                mq.pop_back();
            mq.push_back(j);
            
        }
        t1[i][1]=arr[i][mq.front()];
        //cout<<t1[i][1]<<" yy ";
        ll j=2;
        while(j<=m-b+1)
        {
            while(!mq.empty()&&mq.front()<j)
                mq.pop_front();
             while(!mq.empty()&&arr[i][mq.back()]<=arr[i][j+b-1])
                mq.pop_back();

            mq.push_back(j+b-1);
            t1[i][j]=arr[i][mq.front()];
            //cout<<mq.front()<<" tt ";
            j++;
        }
        

    }

    return make2() ;
}

int main()
{
    
    //freopen("input.txt","r",stdin);

    sd(n);
    sd(m);
    for(ll i=1;i<=n;i++)
        for(ll j=1;j<=m;j++)
            sd(arr[i][j]);
        ll q;
        sd(q);
        while(q--)
        {
            sd(a);
            sd(b);
            make();
            ssum();
            ll fans=1e18;
            //cout<<"kjk "<<mx[1][1]<<sum[1][1]<<endl;
            for(ll i=1;i<=n-a+1;i++)
            {   
                for(ll j=1;j<=m-b+1;j++)
                    {  fans=min(fans,a*b*mx[i][j]-sum[i][j]);
                        
                    }
                
            }               

            
            cout<<fans<<endl;

        }

}