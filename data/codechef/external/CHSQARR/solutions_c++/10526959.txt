#include<bits/stdc++.h>
using namespace std;
int arr[1002][1002],sum[1002][1002],mm[1002][1002];
deque <int> dq;
int dqq[1002][1002];
int main()
{
    int n,m,q,i,j,a,b,s;
    cin>>n>>m;
    for(i=0;i<n;i++)
    {
        for(j=0;j<m;j++)
        {
            cin>>arr[i][j];
        }
    }

    sum[0][0]=arr[0][0];
    for(i=1;i<n;i++)
    {
        sum[i][0]=sum[i-1][0]+arr[i][0];
    }
    for(j=1;j<m;j++)
    {
        sum[0][j]=sum[0][j-1]+arr[0][j];
    }

    for(i=1;i<n;i++)
    {
        for(j=1;j<m;j++)
        {
            sum[i][j]=arr[i][j]+sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1];
        }
    }
    /*
    for(int i=0;i<n;i++)
    {
        for(int j=0;j<m;j++)
            cout<<sum[i][j]<<" ";
        cout<<endl;
    }
    */
    cin>>q;
    while(q--)
    {
        cin>>a>>b;
        /*
        for(int i=0;i<n;i++)
        {
            while(!dq.empty())
            {
                cout<<arr[i][dq.front()]<<" ";
                dq.pop_front();
            }
            cout<<endl;
        }
        */
        for(i=0;i<n;i++)
        {   dq.push_back(0);
            for(j=1;j<b;j++)
            {
                while(!dq.empty() && arr[i][dq.back()]<=arr[i][j])
                {
                    dq.pop_back();
                }
                dq.push_back(j);
            }
            for(j=b;j<m;j++)
            {   int mx=arr[i][dq.front()];
                mm[i][j-b]=mx;
                //cout<<i<<" "<<j-b<<"__"<<mm[i][j-b]<<"    ";
                while(!dq.empty() && dq.front()<=(j-b))
                    dq.pop_front();
                while(!dq.empty() && arr[i][dq.back()]<arr[i][j])
                    dq.pop_back();
                dq.push_back(j);
            }
            mm[i][j-b]=arr[i][dq.front()];
            while(!dq.empty())
                dq.pop_front();
        }
        /*
        for(i=0;i<n;i++)
        {
            for( j=0;j<m-b+1;j++)
                cout<<mm[i][j]<<" ";
            cout<<endl;
        }
        */
        while(!dq.empty())
                dq.pop_front();

        /*
        for(int j=0;j<m-b+1;j++)
        {
            while(!dq.empty())
            {
                cout<<mm[dq.front()][j]<<" ";
                dq.pop_front();
            }
            cout<<endl;
        }
        */
        for(j=0;j<(m-b+1);j++)
        {   dq.push_back(0);
            for(i=1;i<a;i++)
            {
                while(!dq.empty() && mm[dq.back()][j]<=mm[i][j])
                    dq.pop_back();
                dq.push_back(i);
            }
            for(i=a;i<n;i++)
            {
                int mx=mm[dq.front()][j];
                dqq[i-a][j]=mx;
                while(!dq.empty() && dq.front()<=i-a)
                    dq.pop_front();
                while(!dq.empty() && mm[dq.back()][j]<mm[i][j])
                    dq.pop_back();
                dq.push_back(i);
            }
            dqq[i-a][j]=mm[dq.front()][j];
            while(!dq.empty())
                dq.pop_front();
        }

        int temp=INT_MAX;
        /*for(int i=0;i<((n-a)+1);i++)
        {
            for(int j=0;j<((m-b)+1);j++)
            {   cout<<dqq[i][j]<<" ";
                //if(mm[i][j]*a*b-(sum[i][j]-sum[i-a][j-b]+arr[i-a][j-b])<temp)
                //    temp=mm[i][j]*a*b-(sum[i][j]-sum[i-a][j-b]+arr[i-a][j-b]);
            }
            cout<<endl;
        }
        */
        //cout<<temp<<endl;

        for(i=0;i<(n-a+1);i++)
        {
            for(j=0;j<(m-b+1);j++)
            {   s=0;
                if(j>0 && i>0)
                s=(dqq[i][j]*a*b)-(sum[i+a-1][j+b-1]-(sum[i+a-1][j-1]+sum[i-1][j+b-1])+sum[i-1][j-1]);
                else if(i>0 && j<=0)
                s=(dqq[i][j]*a*b)-(sum[i+a-1][j+b-1]-(sum[i-1][j+b-1]));
                else if(j>0 && i<=0)
                s=(dqq[i][j]*a*b)-(sum[i+a-1][j+b-1]-(sum[i+a-1][j-1]));
                else
                s=(dqq[i][j]*a*b)-(sum[i+a-1][j+b-1]);

                //cout<<i<<" "<<j<<"__"<<s<<endl;
                //cout<<((sum[i+a-1][j+b-1]+arr[0][0])-(sum[i+a-1][j-1]+sum[i-1][j+b-1]))<<endl;
                if(s<temp)
                    temp=s;
            }
        }
        cout<<temp<<endl;

    }
    return 0;
}
