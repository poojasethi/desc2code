#include <bits/stdc++.h>
using namespace std;
long long arr[1005][1005],ver[1005][1005],karr[1005][1005],karr2[1005][1005];
int main() {
	long long a,b,q,m,n,i,j,s,p,min,ans,k;
	cin>>n>>m;
	for(i=1;i<=n;i++)
	{
		s=0;
		for(j=1;j<=m;j++)
		{
			cin>>arr[i][j];
			//s=s+arr[i][j];
		//	hor[i][j]=s;
		//	cout<<hor[i][j]<<" ";
		}
	//	cout<<endl;
	}
	for(i=1;i<=n;i++)
		ver[i][0]=0;
	for(j=1;j<=m;j++)
		ver[0][j]=0;
		//cout<<endl<<"vartical"<<endl;
	for(i=1;i<=m;i++)
	{
		s=0;
		for(j=1;j<=n;j++)
		{
			s+=arr[j][i];
			ver[j][i]=s;
		//	cout<<ver[j][i]<<" ";
		}
		//cout<<endl;
	}
/*	for(i=1;i<=n;i++)
	{
		for(j=1;j<=m;j++)
			cout<<ver[i][j]<<" ";
		cout<<endl;
	}
	*/
 
	cin>>q;
	while(q--)
	{
		min=1000000009;
		scanf("%lld %lld",&a,&b);
		deque<long long> Q1(1005);
		//deque<long long> Q2(b);\
		//cout<<"ab"<<a<<" "<<b<<endl;
		k=b;
	//	cout<<"a b "<<a<<" "<<b<<endl;
		for(j=1;j<=n;j++)
		{
			p=1;
		//	cout<<"k="<<k<<endl;
			for(i=1;i<=k;i++)
			{
				while(!Q1.empty() && arr[j][i]>=arr[j][Q1.back()])
				{
					Q1.pop_back();
				}
			//	cout<<"inside"<<endl;
				Q1.push_back(i);
			}
		//	cout<<"back "<<Q1.back()<<" "<<"front= "<<Q1.front()<<endl;
		//	cout<<endl;
			for(;i<=m;i++)
			{
				karr[j][p]=arr[j][Q1.front()];p++;
			//	cout<<"j="<<j<<" "<<"p="<<p-1<<" "<<karr[j][p-1]<<endl;
				if(Q1.front()==p-1)
					Q1.pop_front();
				while(!Q1.empty() && arr[j][i]>=arr[j][Q1.back()])
				{
					Q1.pop_back();
				}
				Q1.push_back(i);	
 
 
			}
			karr[j][p]=arr[j][Q1.front()];
			while(!Q1.empty())
			{
				Q1.pop_back();
			}
		}
	/*	cout<<endl<<"karr1"<<endl;
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
				cout<<karr[i][j]<<" ";
			cout<<endl;
		}*/
		p=1;k=a;
		for(i=1;i<=m-b+1;i++)
		{
			p=1;
			for(j=1;j<=k;j++)
			{
				while(!Q1.empty() && karr[j][i]>=karr[Q1.back()][i])
				{
					Q1.pop_back();
				}
				Q1.push_back(j);
			}
			for(;j<=n;j++)
			{
				karr2[p++][i]=karr[Q1.front()][i];
			//	cout<<" j="<<j<<" "<<"p="<<p-1<<" "<<"i="<<i<<" "<<" front= "<<Q1.front()<<" "<<karr[Q1.front()][i]<<endl;
				if(Q1.front()==p-1)
					Q1.pop_front();
				//	cout<<"karr[j][i] "<<karr[j][i]<<endl;
				while(!Q1.empty() && karr[j][i]>=karr[Q1.back()][i])
				{
 
					Q1.pop_back();
				}
				Q1.push_back(j);	
 
 
			}
			karr2[p][i]=karr[Q1.front()][i];
			while(!Q1.empty())
			{
				Q1.pop_back();
			}
		}
	/*	cout<<"karr2"<<endl;
		for(i=1;i<=n;i++)
		{
			for(j=1;j<=m;j++)
				cout<<karr2[i][j]<<" ";
			cout<<endl;
		}*/
		long long temp;k=a;
		for(i=1;i<=n-a+1;i++)
		{
			s=0;
			for(j=1;j<=b;j++)
			{
			//	cout<<"ver "<<" i= "<<i<<" k= "<<k<<" "<<ver[i+a-1][j]<<" "<<ver[i-1][j]<<endl;
				s+=(ver[i+a-1][j]-ver[i-1][j]);
			}
			for(;j<=m+1;j++)
			{
				temp=a*b*karr2[i][j-b];
			//	cout<<"i="<<i<<" "<<"j="<<j-1<<" "<<temp<<" s= "<<s<<endl;
				ans=temp-s;
 
				if(ans<min)
					min=ans;
			//	cout<<"ver[i+a-1][j-b] "<<ver[i+a-1][j-b]<<" ver[i-1][j-b] "<<ver[i-1][j-b]<<endl;
				s-=(ver[i+a-1][j-b]-ver[i-1][j-b]);
			//	cout<<"ver[i+a-1][j] "<<ver[i+a-1][j]<<" ver[i-1][j] "<<ver[i-1][j]<<endl;
				s+=(ver[i+a-1][j]-ver[i-1][j]);
			}
		}
		cout<<min<<endl;
	}
	// your code goes here
	return 0;
}
 