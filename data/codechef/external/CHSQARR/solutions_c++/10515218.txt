#include <bits/stdc++.h>
using namespace std;

#define fs first
#define se second
#define mp make_pair
#define Inf (1 << 30)
#define MAXN 1005

typedef long long ll;
typedef pair< int, int > pii;
const int N = 100005;

int inp[MAXN][MAXN];
int cum[MAXN][MAXN];
int help[MAXN][MAXN];

int n,m;

pii DQ[MAXN];

int P(int x,int y){
    int st,cnt;
    for(int j=1;j<=m;j++){
        cnt = 0; st = 1;
        for(int i=1;i<=n;i++){
            DQ[++cnt] = mp(inp[i][j] , i);
            while(DQ[st].se <= (i - x)) st++;
            while(cnt > st && DQ[cnt].fs >= DQ[cnt - 1].fs){
                DQ[cnt - 1] = DQ[cnt];
                cnt--;
            }
            help[i][j] = DQ[st].fs;
        }
    }

    int ans = INT_MAX;
    for(int i=x;i<=n;i++){
        cnt = 0; st = 1;
        for(int j=1;j<=m;j++){
            DQ[++cnt] = mp(help[i][j], j);
            while(DQ[st].se <= (j - y)) st++;
            while(cnt > st && DQ[cnt].fs >= DQ[cnt - 1].fs){
                DQ[cnt - 1] = DQ[cnt];
                cnt--;
            }
            if(j >= y){
                int sum = cum[i][j] - cum[i][j - y] - cum[i - x][j] + cum[i - x][j - y];
                int mx = DQ[st].fs;
                ans = min (ans , x * y * mx - sum);
            }
        }
    }
    return ans;
}

int main(){
    scanf("%d %d", &n, &m);
    memset(cum,0,sizeof cum);
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            scanf("%d",&inp[i][j]);
            cum[i][j] = cum[i - 1][j] + inp[i][j];
        }
    }

    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            cum[i][j] += cum[i][j - 1];
        }
    }

    int q; scanf("%d",&q);
    for(int i=1;i<=q;i++){
        int x,y; scanf("%d %d",&x,&y);
        printf("%d\n",P(x,y));
    }
    return 0;
}
