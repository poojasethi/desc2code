#include <iostream>
#include<cstdio>
#include<map>
#include<vector>

using namespace std;

vector<int> mp[100001];
int dis[100001];
bool dead[100001];

void dfs(int u, int d)
{
    dis[u]=d;
    if(dead[u]==1)
        d++;

    for(int i=0;i<mp[u].size();i++)
    {
        int v = mp[u][i];
        if(dis[v]==-1)
            dfs(v,d);
    }
}

int main()
{
    int t,n,m,a,b,i;
    double ans;

    scanf("%d",&t);
    while(t--)
    {
        ans = 0;
        scanf("%d",&n);

        for(i=1;i<=n;i++)
        {
            dis[i]=-1;
            dead[i]=0;
            mp[i].clear();
        }

        for(i=1;i<n;i++)
        {
            scanf("%d%d",&a,&b);
            mp[b].push_back(a);
            mp[a].push_back(b);
        }

        scanf("%d",&m);
        for(i=0;i<m;i++)
        {
            scanf("%d",&a);
            dead[a] = 1;
        }

        dfs(1,0);

        for(i=1;i<=n;i++)
            ans+=(double)dis[i]/(double)(dis[i]+1);
        printf("%lf\n",ans);
    }
    return 0;
}
