#include<cstdio>
#include<iostream>
#include<vector>
using namespace std;
double sum=0;
vector <int> graph[1000001];

void dfs(int val,int anc,int visit[],int dead[])
{
	visit[val]=1;
	sum=sum+double(anc)/double(anc+1);
	for(int i=0;i<graph[val].size();i++)
		if(visit[graph[val][i]]==0)
			dfs(graph[val][i],anc+dead[val],visit,dead);

}


int main()
{
	int t;
	scanf("%d",&t);
	int i,u,v;
	while(t--)
	{
		int n;
		scanf("%d",&n);
		for(i=0;i<n-1;i++)
		{
			scanf("%d%d",&u,&v);
			graph[u].push_back(v);
			graph[v].push_back(u);
		}
		int dead[n+1];
		for(i=0;i<=n;i++)
			dead[i]=0;
		int m;
		scanf("%d",&m);
		for(i=0;i<m;i++)
		{
			scanf("%d",&u);
			dead[u]=1;
		}
		int visit[n+1];
		for(i=0;i<=n;i++)
			visit[i]=0;
		dfs(1,0,visit,dead);
		printf("%.8lf\n",sum);
		for(i=1;i<=n;i++)
			graph[i].clear();
		sum=0;
	}
	return 0;
}

