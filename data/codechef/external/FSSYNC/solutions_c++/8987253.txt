#include <iostream>
#include <cstdio>
#include <cstring>
#include <vector>


using namespace std;

vector<int> arr[100000];
bool isDead[100000]; 


double dfs(int x, int p, int d){
  double ret = d / (d+1.); 
  for(int i=0; i<arr[x].size(); i++){
    int j = arr[x][i];
    if(j != p){
      ret += dfs(j, x, d+isDead[x]);
    }
  }
  return ret;
}


void solve(){
  int n;
  cin >> n;
  for(int i=0;i<n;i++) arr[i].clear(); 
  int u, v;
  for(int i=0;i<n-1;i++){
    cin >> u >> v;
    u --, v--; 
    arr[u].push_back(v);     arr[v].push_back(u); 
  }
  int m;
  cin >> m;
  memset(isDead, 0, sizeof isDead); 
  while(m--){
    cin >> u;
    u --; 
    isDead[u] = true;
  }
  printf("%0.9f\n", dfs(0, -1, 0)); 
}

int main(){
  int t;
  cin >> t;
  while(t--){
    solve();
  }
}
