#include <iostream>
#include <cstdio>
#include <vector>
using namespace std;

vector<int> arr[100000];
int color[100000];
long long arr1[100000],arr2[100000],mod=1000000007LL;

void dfs(int v,bool* checked){
    checked[v]=true;
    arr1[v]=1LL;
    for(int i=0;i<arr[v].size();i++){
        if(!checked[arr[v][i]]){
            dfs(arr[v][i],checked);
            arr1[v]+=arr1[arr[v][i]];
            if(arr1[v]>=mod)
                arr1[v]-=mod;
            if(color[arr[v][i]]+color[v]==1){
                arr1[v]+=arr2[arr[v][i]]+1;
                if(arr1[v]>=mod)
                    arr1[v]-=mod;
                arr1[v]+=(arr2[v]*(arr2[arr[v][i]]+1))%mod;
                if(arr1[v]>=mod)
                    arr1[v]-=mod;
                arr2[v]+=arr2[arr[v][i]]+1;
                if(arr2[v]>=mod)
                    arr2[v]-=mod;
            }
        }
    }
}

int main(){
    int n,a,b;
    char c;
    scanf("%d",&n);
    for(int i=0;i<n-1;i++){
        scanf("%d%d",&a,&b);
        a--;b--;
        arr[a].push_back(b);
        arr[b].push_back(a);
    }
    for(int i=0;i<n;i++){
        scanf(" %c",&c);
        if(c=='W')
            color[i]=0;
        else
            color[i]=1;
    }
    bool checked[n];
    for(int i=0;i<n;i++)
        checked[i]=false;
    dfs(0,checked);
    printf("%lld\n",arr1[0]);
}



