#include <bits/stdc++.h>
using namespace   std;


      
#define mod 1000000007
#define si 100001
#define f first
#define s second
#define rep(i,n) for(i=1;i<=n;i++)
#define rep0(i,n) for(i=0;i<n;i++)
#define rep1(i,a,b) for(i=a;i<=b;i++)
#define rep2(i,a,b) for(i=a;i>=b;i--)
#define pb push_back
#define mp make_pair
#define endl '\n'
#define ll long long
#define ull unsigned long long
#define v2(x) vector< vector <int> > x
#define pi(x) printf("%d ",x)
#define pll(x) printf("%lld ",x)
#define pie(x) printf("%d\n",x)
#define plle(x) printf("%lld\n",x)

#ifdef ONLINE_JUDGE
#define gc getchar_unlocked
#else
#define gc getchar
#endif

inline int scan(){
  char c = gc();
  int x = 0;
  bool b=0;
  while(c<'0'||c>'9'){
    {
      if(c=='-')
	b=1;
      c=gc();

    }
  }
  while(c>='0'&&c<='9'){
    x=(x<<1)+(x<<3)+c-'0';
    c=gc();
  }
  if(b==1)
    x*=-1;
  return x;
}
v2(g);
bool vi[si]={0},c[si]={0};
ll dp[si]={0},ans=0;

int dfs(int u)
{
  vi[u]=1;
  ll i,v,p=0;
  rep0(i,g[u].size())
    {
      v=g[u][i];
      if(vi[v])continue;
      vi[v]=1;
      dfs(v);

      if(c[u]!=c[v])
	{
	  dp[u]=(dp[u]+dp[v])%mod;
	  ans=(ans+(dp[v]*p)%mod)%mod;
	       p=(p+dp[v])%mod;

	  

	       }
	}
      dp[u]++;

      ans=(ans+dp[u])%mod;


    }

  int main() {
 
    int n,u,v,i,j;

    cin>>n;
    g.resize(n+1);
    char x;
    rep(i,n-1)
      {
	cin>>u>>v;
	g[u].pb(v);
	g[v].pb(u);
      }
    rep(i,n)
      {
	cin>>x;
	if(x=='W')
	  c[i]=1;
      }

    dfs(1);
    plle(ans);

  }
