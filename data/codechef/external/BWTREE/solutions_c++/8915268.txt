#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
#define mod 1000000007
vector<ll> v[100010];
ll c[100010];
ll ans=0;
ll dfs(ll cur,ll par)
{
	
	
	ll  temp=0;
	for(ll i=0;i<v[cur].size();i++)
	{
		if(v[cur][i]==par)
		continue;
		if(c[cur]^c[v[cur][i]])
		{
			ll z=dfs(v[cur][i],cur);
			ans=ans+(temp*z)%mod;
			if(ans>=mod)
			ans%=mod;
			temp+=z;
			if(temp>=mod)
			temp%=mod;
		}
		else
		{
			ll z=dfs(v[cur][i],cur);
		}
	}
	temp=(temp+1)%mod;
	ans+=temp;
	if(ans>=mod)
	ans%=mod;
	return temp;
	
}
int main()
{
	ll n,i,a,b;
	cin>>n;
	
	memset(c,0,sizeof(c));
	for(i=1;i<n;i++)
	{
		cin>>a>>b;
		v[a].push_back(b);
		v[b].push_back(a);
	}
	char ch;
	for(i=0;i<n;i++)
	{
		cin>>ch;
		if(ch=='W')
		c[i+1]=1;
	}
	ll xx=dfs(1,0);
	cout<<ans<<endl;
}