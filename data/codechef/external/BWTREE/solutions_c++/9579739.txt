#include <bits/stdc++.h>
#define ll long long
#define mod 1000000007
#define sc(a) scanf("%lld", &a)
#define pr(a) printf("%lld\n", a)
#define sz 500005

using namespace std;

vector<ll> grp[100005];
ll col[100005], vis[100005], tot[100005], end[100005], tmp[100005], ans[100005];

ll opp(ll l)
{
	if (l == 0) return 1;
	else return 0;
}

void dfs(ll cur, ll par) 
{
	vis[cur] = 1;
	ll ct,nxt,i,j,k=grp[cur].size();
	if (k == 1 && grp[cur][0] == par) {
		tot[cur] = end[cur] = 1;
	}
	else {
		for (i = 0; i < k; i++) {
			nxt = grp[cur][i];
			if (!vis[nxt]) {
				dfs(nxt, par);
			}
		}
		tot[cur] = 1;
		end[cur] = 1;
		ct = 0;
		for (i = 0; i < k; i++) {
			nxt = grp[cur][i];
			if (nxt != par) {
				tot[cur] = (tot[cur] + tot[nxt])%mod;
				if (col[nxt] == opp(col[cur])) {
					ans[ct++] = end[nxt];
					end[cur] = (end[cur] + end[nxt])%mod;
					tot[cur] = (tot[cur] + end[nxt])%mod;
				}
			}
		}
		k = ct;
		if (k > 0) {
			tmp[k-1] = ans[k-1];
			for (i = k-2; i >= 0; i--) {
				tmp[i] = (ans[i]+tmp[i+1])%mod;
			}
			for (i = k-2; i >= 0; i--) {
				tot[cur] = (tot[cur] + (ans[i]*tmp[i+1])%mod)%mod;
			}
		}
	}
}

int main()
{
	ll a,b,i,j,k,l,m,n;
	char ch;
	sc(n);
	for (i = 0; i < n-1; i++) {
		sc(a);
		sc(b);
		grp[a].push_back(b);
		grp[b].push_back(a);
	}
	for (i = 1; i <= n; i++) {
		cin >> ch;
		if (ch == 'W') {
			col[i] = 1;
		}
		else {
			col[i] = 0;
		}
		vis[i] = tot[i] = end[i] = 0;
	}
//	for (i = 1; i <= n; i++)
//		cout << col[i] << " ";
//	cout << endl;
	if (n == 1) 
		cout << "1\n";
	else {
		dfs(1, -1);
		cout << tot[1] << endl;
	}
 	return 0;
}
