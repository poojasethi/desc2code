#include<iostream>
#include<cstdio>
#include<algorithm>
#include<cstring>

using namespace std;

int room[5];
char s[5][100];


bool is_valid()
{
     int i,j,len;
     
     for(i=0;i<5;i++)
     {
         len = strlen(s[i]);
         
         for(j=0;j<len;j++)
         {
            char ch = s[i][j];
            
            if(ch==' ')
            continue;
            
            if(ch>='1' && ch<='5')
            {
               if(room[i] != ch - '0')
               return false;
            }
            else if(ch=='N')
            {
                 j++;
                 if(s[i][j]>='1' && s[i][j]<='5')
                 {
                      if(room[i] == s[i][j]-'0')
                      return false;
                 }
                 else
                 {
                     int NA = s[i][j]-'A';
                     
                     if(room[i] == room[NA]+1 || room[i] == room[NA]-1)
                     return false;
                 }
            }
            else if(ch == '+')
            {
                 j++;
                 int NA = s[i][j] - 'A';
                 
                 if(room[i] < room[NA])
                 return false;
            }
            else if(ch == '-')
            {
                 j++;
                 int NA = s[i][j] - 'A';
                 
                 if(room[i] > room[NA])
                 return false;
            }
            else
            {
                 int NA = s[i][j]-'A';
                 
                 if((room[i] != room[NA]+1)&&(room[i] != room[NA]-1))
                 {
                      return false;
                 }
            }
         }
     }
     return true;
}

int main()
{
    int t,i;
    scanf("%d",&t);
    getchar();
    while(t--)
    {
              for(i=0;i<5;i++)
              { 
                 gets(s[i]);
                 room[i] = i+1;     
              }
              
              while(1)
              {
                      if(is_valid())
                      {
                          break;
                      }
                      
                      if(!next_permutation(room,room+5))
                      break;
              }
              
              char a[] = "12345";
              
              for(i=0;i<5;i++)
              {
                 a[room[i]-1] = 'A' + i;
              }
              
              printf("%s\n",a);
    }
    return 0;
}
