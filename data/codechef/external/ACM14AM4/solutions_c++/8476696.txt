#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define maxn 109

ll rect[maxn][maxn];
ll lu[maxn][maxn];
ll ld[maxn][maxn];
ll ru[maxn][maxn];
ll rd[maxn][maxn];


int main(){
	ll t;
	cin>>t;
	while(t--){
		ll n,m;
		cin>>m>>n;
		for(ll i=1;i<=m;i++){
			for(ll j=1;j<=n;j++){
				cin>>rect[i][j];
			}
		}
		for(ll i=0;i<=m+1;i++){lu[i][0] = ld[i][0] = 0;ru[i][n+1] = rd[i][n+1] = 0;}
		for(ll i=0;i<=n+1;i++){ld[0][i] = rd[0][i] = 0;}
		for(ll i=1;i<=m;i++){
			for(ll j=1;j<=n;j++){
				ld[i][j] = ld[i-1][j-1] + rect[i][j];
				rd[i][j] = rd[i-1][j+1] + rect[i][j];
			}
		}
		for(ll i=0;i<=n+1;i++){ru[m+1][i] = lu[m+1][i] = 0;}
		for(ll i=m;i>0;i--){
			for(ll j=n;j>0;j--){
				lu[i][j] = lu[i+1][j-1] + rect[i][j];
				ru[i][j] = ru[i+1][j+1] + rect[i][j];
			}
		}

		ll ans = rect[1][1] + rect[1][2] + rect[2][1] + rect[2][2];

		for(ll i=1;i<=m;i++){
			for(ll j=1;j<=n;j++){
				for(ll k=j+1;k<=n;k++){
					if(i+k-j<=m){
					ll sc = lu[i][k] - lu[k-j+i+1][j-1]  + ru[i][j] - ru[k-j+i+1][k+1] ;
					if(((k-j)&1)==0){sc -= rect[i + (k-j)/2][j + (k-j)/2];}
					ans = max(ans,sc);}
				}
			}
		}

		cout<<ans<<endl;











	}
}
