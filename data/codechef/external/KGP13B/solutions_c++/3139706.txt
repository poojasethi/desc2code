/*
 KGP13B codechef
 Saurav Shekhar
*/

 #include <iostream>
 #include <cstdio>
 #include <algorithm>
 #include <vector>
 #include <set>
 #include <map>
 #include <utility>

 using namespace std;
 
 typedef vector<int> vi;
 typedef pair<int,int> ii;
 typedef vector< ii > vii;
 typedef vector< pair< ii , int> > viii;

 bool comp(ii a, ii b)	//return if a < b
 {
 	if(a.first < b.first) {
 		return true;
 	} else if(a.first ==  b.first) {
 		return (a.second > b.second);
 	} else {
 		return false;
 	}
 }

 int main()
 {
 	int N,K,M,D,st,et;
	int i,num;
	viii rangelist;
 	vii ptlist;
 	cin >> N;
 	for(int cno=1; cno<=N; cno++) {
 		cin >> K >> M;
 		rangelist.clear();
 		ptlist.clear();
 		rangelist.push_back(make_pair(make_pair(0,0),0));
 		ptlist.push_back(make_pair(0,0));
 		for(int j=0; j<K; j++) {
 			cin >> st >> et;
 			rangelist.push_back(make_pair(make_pair(st,et),0));
 		}
		for(int j=0; j<M; j++) {
			cin >> D;
			for(int l=0; l<D; l++) {
				cin >> i >> num;
				rangelist[i].second += num;
			}
		}
		for(int j=1; j<=K; j++) {
			ptlist.push_back(make_pair(rangelist[j].first.first, rangelist[j].second));
			ptlist.push_back(make_pair(rangelist[j].first.second, -rangelist[j].second));
		}

		sort(ptlist.begin(), ptlist.end(), comp);

		int curr=0,maxcurr=0;

		for(int i=0; i<ptlist.size(); i++) {
			if(ptlist[i].second >= 0) {
				curr = curr + ptlist[i].second;
				if(curr > maxcurr)
					maxcurr = curr;
			} else {
				//if(curr > maxcurr) maxcurr = curr;

				curr = curr + ptlist[i].second; 
			}
		}
		printf("Case %d: %d\n",cno,maxcurr);
 	}
 	return 0;
 }
