#include <stdio.h>
#include <iostream>
#include<vector>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<queue>
using namespace std;

  struct no{int x;
           int y;
           int in;
          };
bool sort_by_x( const no & lhs, const no & rhs )
{
   return (lhs.x<rhs.x);// || (lhs.p==rhs.p && lhs.s<rhs.s));
}


int main()
{
	
	int m,n,k,i,j,d,p,f,tm,in[30],ca,cs,o;

	//vector<int>v[30],t;
	//int v[31][31];
	
	scanf("%d",&n);

	for(o=1;o<=n;o++)
	{
	int b[31]={0};
	vector< vector<int> > v(31,vector<int>(31));
	scanf("%d%d",&k,&m);
	vector <no> a(k);
	for(i=0;i<k;i++)
		{

			scanf("%d%d",&a[i].x,&a[i].y);
			a[i].in=i+1;
			//v[i][0]=0;
			
		}
//		v[i][0]=0;
		//scanf("%d%d",&a[i][0],&a[i][1]);
		//sort(a,a+k);
		for(i=0;i<m;i++)
		{
			scanf("%d",&p);
			f=0;
			for(j=0;j<2*p;j++)
			{
				scanf("%d",&d);
				if(f==0)
				{tm=d;
					f=1;
					}
				else{
					f=0;
					b[tm]+=d;
				}

			}
		}
			//input ends

			sort(a.begin(),a.end(),sort_by_x);
			
/*			for(i=0;i<k;i++)
			{
				printf("%d %d %d\n",a[i].x,a[i].y,a[i].in);
			}*/

			for(i=0;i<k;i++)
			{
				for(j=i+1;j<k;j++)
				{
					if(a[i].y<a[j].x)
					{
						v[a[i].in][v[a[i].in][0]+1]=a[j].in;
						v[a[i].in][0]++;

						v[a[j].in][v[a[j].in][0]+1]=a[i].in;
						v[a[j].in][0]++;
					}
						
				}
			}

/*			for(i=0;i<=k;i++)
			{
				for(j=0;j<=k;j++)
				{
					printf("%d ",v[i][j]);
				}
				printf("\n");
			}*/

			int fl[31]={0};
			ca=0;
			for(i=0;i<k;i++)
			{
				cs=b[a[i].in];
			
				for(j=1;j<=v[a[i].in][0];j++)
				{
				//	printf("%d  %d\n",v[a[i].in][j],fl[v[a[i].in][j]]);
					if(fl[v[a[i].in][j]]>0&&cs!=0)
					{
						if(cs>fl[v[a[i].in][j]])
							{cs=cs-fl[v[a[i].in][j]];
								fl[v[a[i].in][j]]=0;
				//	printf("%d ",cs);
							}
						else if(cs<=fl[v[a[i].in][j]])
						{
							fl[v[a[i].in][j]]=fl[v[a[i].in][j]]-cs;
							cs=0;
				//	printf("%d ",cs);
						}

					}


				}


				fl[a[i].in]=b[a[i].in];
				//printf("%d_%d\n",	fl[a[i].in],a[i].in);
				ca=ca+cs;
			}


			printf("Case %d: %d\n",o,ca);
	}
	return(0);
}