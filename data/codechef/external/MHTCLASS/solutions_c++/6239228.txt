#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#define ll long long
#define MOD 1000000007
#define min(a,b) ((a<b)?a:b)
#define max(a,b) ((a>b)?a:b) 
ll dp[27][100010]={0};
int main()
{
	int test;scanf("%d",&test);
	while(test--)
	{
		char junk;scanf("%c",&junk);
		int d;char st[100010];
		scanf("%s",st);
		scanf("%d",&d);
		memset(dp,0,sizeof(dp));
		int len=strlen(st);
		d=min(d,25);
		if(st[0]=='.')
			for(int i=0;i<26;i++)
				dp[i][0]=1;
		else
			dp[st[0]-'a'][0]=1;
		for(int i=1;i<len;i++)
		{
			if(st[i]!='.')
			{
				int pres=st[i]-'a';
				for(int j=0;j<26;j++)
				{
					if(abs(pres-j)<=d)
						dp[pres][i]=(dp[pres][i]+dp[j][i-1])%MOD;
				}
			}
			else
			{
				if(st[i-1]=='.')
				{
					for(int j=0;j<26;j++)
					{
						// for dp[j][i]
						for(int k=0;k<26;k++)
						{
							if(abs(j-k)<=d)
								dp[j][i]=(dp[j][i]+dp[k][i-1])%MOD;
						}
					}
				}
				else
				{
					int prev=st[i-1]-'a';
					for(int j=0;j<26;j++)
					{
						if(abs(j-prev)<=d)
							dp[j][i]=(dp[j][i]+dp[prev][i-1])%MOD;
					}
				}
			}
		}
		ll ans=0;
		for(int i=0;i<26;i++)
			ans=(ans+dp[i][len-1])%MOD;
		printf("%lld\n",(ans+MOD)%MOD);
	}
	return 0;
}