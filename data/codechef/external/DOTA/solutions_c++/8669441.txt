#include <stdio.h>
#include <memory.h>
#include <vector>
using namespace std;
char b[41][41];
vector<int> con[1000];
int mx[1000];
bool vis[1000];
int x[41][41];
bool bpm(int v){
	for(int i=0; i<con[v].size(); i++){
		int j=con[v][i];
		if(vis[j]) continue;
		vis[j]=1;
		if(mx[j]==-1 || bpm(mx[j])){
			mx[j]=v;
			return 1;
		}
	}
	return 0;
}
int main(){
    //freopen("in.txt", "r", stdin);
    int T;
    scanf("%d", &T);
    int n, m, i, j;
    while(T--){
    	memset(b, 0, sizeof(b));
    	for(i=0; i<1000; i++) con[i].clear();
    	memset(x, -1, sizeof(x));
        scanf("%d %d", &n, &m);
        for(i=0; i<n; i++) scanf("%s", b[i]);
        int cl=0;
        for(i=0; i<n; i++){
            for(j=0; j<m; j++){
                if(b[i][j]=='.'){
					if(b[i][j+1]=='*') ++cl;
                }else{
                	x[i][j]=cl;
                }
            }
            ++cl;
        }
        int cm=0;
        for(i=0; i<m; i++){
            for(j=0; j<n; j++){
                if(b[j][i]=='.'){
                	if(b[j+1][i]=='*') ++cm;
                }else if(x[j][i]>=0){
                	con[cm].push_back(x[j][i]);
                }
            }
            ++cm;
        }
        memset(mx, -1, sizeof(mx));
        int res=0;
        for(i=0; i<cm; i++){
        	memset(vis, 0, sizeof(vis));
        	res+=bpm(i);
        }
        printf("%d\n", res);
    }
}