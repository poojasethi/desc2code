#include <bits/stdtr1c++.h>

using namespace std;

typedef long double ld;

struct pt {
	ld x, y;
	bool operator<(const pt& o) const {
		if (y == o.y) return x < o.x;
		return y < o.y;
	}
} p[100005];

bool sort_by_x(const pt& l, const pt& r) {
	return l.x < r.x;
}

ld dist(const pt& x, const pt& y) {
	return sqrt(pow(x.x-y.x, 2) + pow(x.y-y.y,2));
}

int main() {
	ios_base::sync_with_stdio(0);
	cin.tie(0);
	
	int t; cin >> t;
	for (int c = 1; c <= t; c++) {
		int n; cin >> n;
		for (int i = 0; i < n; i++) {
			cin >> p[i].x >> p[i].y;
		}
		sort(p, p+n, sort_by_x);
		
		set<pt> s;
		int l = 0;
		const ld inf = 1e7;
		ld ans = inf;
		for (int i = 0; i < n; i++) {
		
			// brute force points within a [ans, 2ans] box
			auto lit = s.lower_bound({-inf,p[i].y-ans});
			auto uit = s.lower_bound({inf,p[i].y+ans});
			if (distance(lit, uit) >= 2) {
				for (auto it = lit; it != uit; it++) {
					for (auto nit = it; nit != uit; nit++) {
						if (nit == it) continue;
						ans = min(ans, dist(p[i], *it) + dist(p[i], *nit) + dist(*it, *nit));
					}
				}
			}
			
			s.insert(p[i]);
			//move sweep line
			while (p[i].x-p[l].x > ans) s.erase(p[l++]);
		}
		
		cout << "Case " << c << ": " << fixed << setprecision(10) << ans << endl;
	}
	return 0;
}