#include<stdio.h>
#include<string.h>
#include<stdlib.h>
#define gc getchar()
inline void read(int *i)
{
	*i=0;
	char ch=gc;
	int sign=1;
	while(ch<'0' || ch>'9')
	{
		if(ch=='-')
			sign=-1;
		ch=gc;
	}
	while(ch>='0' && ch<='9')
	{
		*i=(*i)*10+ch-'0';
		ch=gc;
	}
	(*i)*=sign;	
}
int main()
{
	//char *a;
	int t;
	read(&t);
	while(t--)
	{
		int i,j,count=0,m,len;
		char a[100009];
		gets(a);
		len=strlen(a);
		read(&m);
		j=0;
		for(i=0;i<m;i++){
			if(a[i]=='A'||a[i]=='a') j++;
		}
		count=j;
		if(count==m)
		{
			printf("0\n");
			continue;
		}
		for(i=m;i<len;i++){
			if(a[i]=='A'||a[i]=='a') j++;
			if(a[i-m]=='A'||a[i-m]=='a') j--;
			if(j>count) count=j;
		}
		printf("%d\n",m-count);
	}
	return 0;
}