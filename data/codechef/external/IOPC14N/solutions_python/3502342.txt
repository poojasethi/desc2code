#include<stdio.h>
#include<stdlib.h>
#include<string.h>

int main(){
	char arr[100009];
	int a,ta,T,i,j,k,l,L;
	scanf("%d",&T);
	while(T--){
		i=k=a=ta=0;
		scanf("%s",arr);
		L=strlen(arr);
		scanf("%d",&l);
		for(j=0;j<l;j++){
			if(*(arr+j)=='A'||*(arr+j)=='a') ta++;
		}
		a=ta;
		if(a==l){printf("0\n");continue;}
		for(i=l;i<L;i++){
			if(arr[i]=='A'||arr[i]=='a') ta++;
			if(arr[i-l]=='A'||arr[i-l]=='a') ta--;
			if(ta>a) a=ta;
		}
		printf("%d\n",l-a);
	}
	return 0;
}