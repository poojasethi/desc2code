#include <bits/stdc++.h>
#include <iostream>

int main(){
	int T,l,i;
	scanf("%d", &T);
	char S[101];
	long int P,Q,N,SUM;
	bool flag;
	while(T--){
		scanf("%s", &S);
		l=strlen(S);
		scanf("%ld%ld",&P,&Q);
		long int alpha[26]={0};
		for(i=0; i<l; i++)
			alpha[S[i]-97]+=P;
		while(Q--){
			scanf("%ld", &N);
			SUM=0;
			flag=true;
			for(i=0;i<26; i++){
				SUM+=alpha[i];
				if(N<=SUM){
					printf("%c\n", i+97);
					flag=false;
					break;
				}
			}
			if(flag)
				printf("-1\n");

		}
		




	}//end of testcases

	return 0;
}//end of main