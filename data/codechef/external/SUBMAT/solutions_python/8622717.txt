t = int(raw_input())

for x in range(t):
	inputs = raw_input()
	inputs = inputs.split(" ")
	m = int(inputs[0])
	n = int(inputs[1])

	city_array = []
	for x in range(m):
		temp = raw_input()
		temp = temp.split(" ")
		city_array.append(temp)


	for x in range(m):
		for y in range(n):
			if city_array[x][y] == '1':
				city_array[x][y] = 1
			else:
				city_array[x][y] = 0

	for x in range(1,m):
		for y in range(1,n):
			if city_array[x][y] == 1:
				city_array[x][y] = min(city_array[x-1][y],city_array[x][y-1],city_array[x-1][y-1]) + 1
			else:
				city_array[x][y] = 0

	max_length = 0
	for x in range(m):
		for y in range(n):
			if city_array[x][y] > max_length:
				max_length = city_array[x][y]

	print(max_length)
