#include<iostream>
using namespace std;
int main()
{
    int arr[100][100],up[100][100],l[100][100],t,n,m,ans,i,j,k;
    cin>>t;
    while(t--)
    {
        cin>>n>>m;
        int max=0;
        for(i=0;i!=n;i++)
            for(j=0;j!=m;j++)
                {
                    cin>>arr[i][j];
                    if(i==0 || arr[i][j]==0)
                    {
                        up[i][j]=arr[i][j];
                    }
                    else
                        up[i][j]=arr[i][j]+arr[i-1][j];

                    if(j==0 || arr[i][j]==0)
                        l[i][j]=arr[i][j];

                    else
                        l[i][j]=l[i][j-1]+arr[i][j];
                }

		/*for(i=0;i!=n;i++){
		
		for(j=0;j!=m;j++)
		cout<<up[i][j]<<" ";
		cout<<endl;}
		
		cout<<endl<<endl;
		
			for(i=0;i!=n;i++){
		for(j=0;j!=m;j++)
		
		cout<<l[i][j]<<" ";
		cout<<endl;}
		
		cout<<endl<<endl;*/
		
        for(i=1;i!=n;i++)
            for(j=1;j!=m;j++)
            {
                int ch = arr[i-1][j-1];
                int ch2 = arr[i][j];
                if(ch2>max)
                    max=ch2;

                if(ch==0 || ch2==0)
                    continue;
                else
                {
                    if(up[i][j]>ch && l[i][j]>ch)
                        {
                            arr[i][j]=ch+1;
                            if(ch+1>max)
                                max=ch+1;
                        }



                }


            }

            cout<<max<<endl;


    }

}