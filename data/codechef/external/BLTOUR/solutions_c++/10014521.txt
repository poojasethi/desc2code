//Amit Kumar Gupta              
#include<bits/stdc++.h>
using namespace std;
typedef long long LL;
typedef pair<int,int> II;
#define REP(i,i1,n) for(int i=i1;i<n;i++)
#define REPB(i,i1,n) for(int i=i1;i>=n;i--)
#define PB push_back
#define MP make_pair
#define ALL(c) (c).begin(),(c).end()
#define F first
#define S second
#define SZ(a) (LL)a.size()
#define EPS 1e-12
#define MOD 1000000007
#define TR1(x) cerr<<#x<<" : "<<x<<endl
#define TR2(x,y) cerr<<#x<<" : "<<x<<" | "<<#y<<" : "<<y<<endl
#define FAST_IO ios_base::sync_with_stdio(false);cin.tie(NULL)
#define SI(c) scanf("%d",&c)
#define SII(c,d) scanf("%d%d",&c,&d)
#define SLL(c) scanf("%lld",&c)
#define PIN(c) printf("%d\n",c)
#define PLLN(c) printf("%lld\n",c)
#define N 100010
#define LOGN 21
#define INIT1(array,ST,END,val) for(int i=ST;i<END;i++)array[i]=val
#define INIT2(array,nn,mm,val) for(int i=0;i<nn;i++)for(j=0;j<mm;j++)array[i][j]=val
//------------------------------------------------------MAIN CODE STARTS HERE---------------------------------------
vector<int> g[N];
int st;
LL val[N];
void fact()
{
	val[0]=1;
	val[1]=1;
	REP(i,2,N)
	{
		val[i]=(val[i-1]*i)%MOD;
	}
}
LL ans;
void dfs(int z,int p)
{
	REP(i,0,g[z].size())
	{
		if(p!=g[z][i])
		{
			dfs(g[z][i],z);
		}
	}
	if(p!=-1)
		ans=(ans*val[g[z].size()-1])%MOD;
	else
		ans=(ans*val[g[z].size()])%MOD;
}

int main()
{
	int t;
	SI(t);
	fact();
	while(t--)
	{
		int n;
		SI(n);
		ans=1;
		REP(i,0,n-1)
		{
			int x,y;
			SII(x,y);
			g[x].PB(y);
			g[y].PB(x);
		}
		SI(st);
		dfs(st,-1);
		PLLN(ans);
		REP(i,0,n+1)
		g[i].clear();
	}
	return 0;
}
