//dfs-graph
//mapped wrong code
#include<stdio.h>
#include<iostream>
#include<list>
#define ll long long
using namespace std;
ll ch[100005];
ll f[100005];
#define gc getchar_unlocked
    inline void read(ll &x)
     {

        x=0;
        register char c=gc();
        for(;c<'0' || c>'9';c=gc());
         for(;c>='0' && c<='9';c=gc())
          x=(x<<3)+(x<<1)+(c-'0');
      }
void fact()
{
	f[0]=1;
	for(ll i=1;i<100002;i++)
	{
		f[i]=i*(f[i-1]);
		f[i]%=1000000007;
	}
}
int main()
{
	fact();
	ll t,n,A,visited_node,parentNode,childNode;//n-number of node,m-number of edge 
	read(t);
	//cin>>t;
	for(ll i=0;i<t;i++)
	{
		read(n);
		//scanf("%lld",&n);
		for(ll j=1;j<=n;j++)
		{
            ch[j]=0;
		}
		for(ll j=0;j<n-1;j++)
		{
			read(parentNode);
			read(childNode);
			//scanf("%lld %lld",&parentNode,&childNode);
            ch[parentNode]++;
            ch[childNode]++;
		}
		read(A);
		//cin>>A;
		ll ans=1;
		for(ll j=1;j<=n;j++)
		{
            if(j==A)
            {
            	ans*=f[ch[j]];
			}
			else
			{
				ans*=f[ch[j]-1];
			}
			ans%=1000000007;
			//cout<<j<<" "<<ans<<" "<<ch[j]<<" "<<f[ch[j]-1]<<endl;
		}
		cout<<ans<<endl;	
	}
}