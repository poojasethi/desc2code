#include<cstdio>
#include<iostream>
#include<cstring>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<sstream>
#include<iomanip>
#include<cmath>
using namespace std;
#define ll long long
#define inf 1000000007
#define mod 1000000007
//const ll inf = 1000000000007LL;
#define pii pair<int,int>
#define vi vector<int>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 4000010
double a[105][105],f[105][105];
double sqr(double a){return a*a;}
double dis(int p,int q,int c,int d)
{
	if(a[p][q]>a[c][d])return 0.5+0.5*(sqrt(1+sqr(a[c][d]-a[p][q])));
	else return -0.5+1.5*(sqrt(1+sqr(a[c][d]-a[p][q])));
}
int main()
{
	int T,i,j,k,t,ca=0,n,m;
	scanf("%d",&T);
	while(T--)
	{
		printf("Case %d:\n",++ca);
		scanf("%d%d",&n,&m);
		for(i=1;i<=n;i++)
		for(j=1;j<=m;j++)scanf("%lf",&a[i][j]);
		scanf("%d",&t);
		while(t--)
		{
			int a,b,c,d;
			scanf("%d%d%d%d",&a,&b,&c,&d);
			int v=a<c?1:-1,h=b<d?1:-1;
			f[a][b]=0;
			for(i=a+v;i!=c+v;i+=v)f[i][b]=f[i-v][b]+dis(i-v,b,i,b);
			for(i=b+h;i!=d+h;i+=h)f[a][i]=f[a][i-h]+dis(a,i-h,a,i);
			for(i=a+v;i!=c+v;i+=v)
			for(j=b+h;j!=d+h;j+=h)
			f[i][j]=min(f[i-v][j]+dis(i-v,j,i,j),f[i][j-h]+dis(i,j-h,i,j));
			printf("%.6lf\n",f[c][d]);
		}
	}
} 