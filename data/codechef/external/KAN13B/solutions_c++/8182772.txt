#include <bits/stdc++.h>
using namespace std;
double hs[102][102]; 
double f[102][102]; 
 
double dis(int a,int b,int c,int d){
	if(hs[a][b] > hs[c][d]){
		return 0.5 + 0.5 * sqrt(1 + (hs[a][b] - hs[c][d]) * (hs[a][b] - hs[c][d]));
	} else{
		return -0.5 + 1.5 * sqrt(1 + (hs[a][b] - hs[c][d]) * (hs[a][b] - hs[c][d]));
	}
}
int R,C,a,b,c,d,q,v,h;
int main() {
	int t;
	cin >> t; 
	for(int cs =1; cs <= t;cs++){
		cout << "Case " << cs << ":\n"; 
		cin >> R >> C; 
		for(int i=1;i<=R;i++)
			for(int j=1;j<=C;j++)
				cin >> hs[i][j]; 
		
		cin >> q;
		while (q--) {
			cin >> a >> b >> c >> d; 
			v = (a < c ? 1 : -1); 
			h = (b < d ? 1 : -1); 
			f[a][b] = 0;
			for(int i = a+v; i != c+v; i+=v){
				f[i][b] = f[i-v][b] + dis(i-v,b,i,b); 
			} 
			for(int i = b+h; i != d+h; i+=h){
				f[a][i] = f[a][i-h] + dis(a,i-h,a,i); 
			}
			for(int i = a+v; i != c+v; i+=v){
				for(int j = b+h; j != d+h; j+=h){
					f[i][j] = min(f[i-v][j] + dis(i-v,j,i,j), f[i][j-h] + dis(i,j-h,i,j)); 
				}
			}
			printf("%0.6f\n",f[c][d]);  
 		}
	}
} 