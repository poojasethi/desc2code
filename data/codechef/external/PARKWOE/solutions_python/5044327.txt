#include <iostream>
#include<stdio.h>
#include<algorithm>
#define k 2147483647
using namespace std;
long long int t,a[3000][3000],i,j,m,n,h;
long long int mpath(long long int i,long long int j)
{
    if((i==n-1&&j==m-1))
    return 0;
    long long int q,r;
    if(i+1<n&&j+1<m)
        {
            h=min(a[i+1][j],a[i][j+1]);
             if(h==a[i+1][j])
       { q=i+1;r=j;}
             else
       { q=i;r=j+1;}


        }
    else if(i+1<n&&j+1>=m)
   {
        h=a[i+1][j];

        q=i+1;r=j;
   }
    else if(i+1>=n&&j+1<m)
    {
        h=a[i][j+1];
        q=i;r=j+1;
    }
    if(a[q][r]==k)
    return 0;
    return 1+mpath(q,r);

}
int main()
{
    scanf("%lld",&t);
    while(t--)
    {
        scanf("%lld %lld",&n,&m);
        for(i=0;i<n;i++)
        {
            for(j=0;j<m;j++)
            scanf("%lld",&a[i][j]);
        }
        printf("%lld\n",mpath(0,0));
    }
    return 0;
}
