#include <iostream>
#include <cstdio>
#include <string>
#include <algorithm>
#define empty 2147483647
using namespace std;

int min(int a, int b){
    return a<b?a:b;
}

int solve(long long lot[][200], int m, int n, int row, int col){
    int i,j;
    for(i=row+1;i<m;i++)
        if(lot[i][col]!=empty)
            break;
    for(j=col+1;j<n;j++)
        if(lot[row][j]!=empty)
            break;
    if(i==m&&j==n)
        return 0;
    if(col+1<n&&row+1<m){
        if(lot[row+1][col]==lot[row][col+1])
            return 1+min(solve(lot,m,n,row+1,col),solve(lot,m,n,row,col+1));
        else if(lot[row+1][col]<lot[row][col+1])
            return 1+solve(lot,m,n,row+1,col);
        else
            return 1+solve(lot,m,n,row,col+1);
        }    
    if(col+1<n)
        return 1+solve(lot,m,n,row,col+1);    
    if(row+1<m)
        return 1+solve(lot,m,n,row+1,col);
    return 0;
}

int main() {
    int tc,i,j,m,n,min;
    cin>>tc;
    while(tc--){
        cin>>m>>n;
        long long lot[m][200];
        for(i=0;i<m;i++)
            for(j=0;j<n;j++)
                cin>>lot[i][j];
        lot[0][0] = empty;
        min = solve(lot,m,n,0,0);
        cout<<min<<"\n";
    }
	return 0;
}
