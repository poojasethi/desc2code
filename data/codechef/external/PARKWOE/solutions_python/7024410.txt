 
#include "bits/stdc++.h"
using namespace std;
 
int main(int argc, char const *argv[])
{
int t;
cin >> t;
//east for -1 and south for 1
 
while(t--)
{
int n , m;
 
cin >> n >> m;
 
int a[n+1][m+1];
int visited[n][m];
int c =0 ;
for(int i = 0; i < n; i++)
{
for(int j = 0; j < m; j++)
{
cin >> a[i][j];
visited[i][j] = 0;
}
}
// a[0][0] = -4;
int i = 0, j =0;
while(1)
{
	if(i == n - 1 && j == m - 1)
break;
if(i == n - 1 && a[i][j + 1] == 2147483647)
break;
if(j == m - 1 && a[i + 1][j] == 2147483647)
break;
if(a[i + 1][j] == 2147483647 && a[i][j + 1] == 2147483647)
break;

if(a[i][j + 1] < a[i + 1][j] && i + 1 < n && j + 1 < m )
{
visited[i][j] = -1;c++;
j = j + 1;
}
else if(a[i + 1][j] < a[i][j + 1] && i + 1 < n && j + 1 < m )
{
visited[i][j] = 1;c++;
i = i + 1;
}
else if(i + 1 >= n && j + 1 < m )
{
visited[i][j] = -1;c++;
j = j + 1;
}
else if(j + 1 >= m && i + 1 < n )
{
visited[i][j] = 1;c++;
i = i + 1;
}

 
}
 
// for(int i = 0; i < n; i++)
// {
// for(int j = 0; j < m; j++)
// {if(visited[i][j] != 0)c++;
// }}
cout << c << endl;
}
return 0;
} 