#include<bits/stdc++.h>
using namespace std;
#define blank 2147483647
int n,m;
int A[5000][5000]={0};
int dp[5000][5000];
int doit(int x,int y)
{
	if (A[x][y]==blank)
		return 0;
	if (x>=n||y>=m)
		return INT_MAX-2;
	if (dp[x][y]!=-1)
		return dp[x][y];
	int mini=INT_MAX;
	if (A[x+1][y]!=blank&&A[x+1][y]<A[x][y+1])
	{
		int z=doit(x+1,y);
		mini=min(mini,z+1);
	}
	if (A[x][y+1]!=blank&&A[x][y+1]<A[x+1][y])
	{
		int z=doit(x,y+1);
		mini=min(mini,z+1);
	}
	if (mini==INT_MAX)
		return dp[x][y]=0;
	return dp[x][y]=mini;
	
}
	
int main()
{
	int t;
	scanf("%d",&t);
	while (t--)
	{

		scanf("%d%d",&n,&m);
		int i,j;
		for (i=0;i<n;i++)
			for (j=0;j<m;j++)
			{
				scanf("%d",&A[i][j]);
				dp[i][j]=-1;
			}
		
		for (i=0;i<n;i++)
		{
			A[i][m]=INT_MAX;
			dp[i][m]=-1;
		}
		for (i=0;i<m;i++)
		{
			A[n][i]=INT_MAX;	
			dp[n][i]=-1;
		}
		int ans=doit(0,0);
		printf("%d\n",ans);
	}
	return 0;
}