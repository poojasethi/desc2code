#include <bits/stdc++.h>

using namespace std;


int solve(std::vector< vector <long> > arr,int i,int j,int m,int n){
	if (i==m-1 && j==n-1) return 0;
	else if ((i == m-1 && arr[i][j+1] == 2147483647) || (j==n-1 && arr[i+1][j] == 2147483647))
		return 0;
	else if (i==m-1)
		return 1 + solve(arr,i,j+1,m,n);
	else if (j==n-1)
		return 1 + solve(arr,i+1,j,m,n);
	else if (arr[i+1][j] == 2147483647 && arr[i][j+1] == 2147483647)
		return 0;
	else if (arr[i+1][j] == 2147483647)
		return 1 + solve(arr,i,j+1,m,n);
	else if (arr[i][j+1] == 2147483647)
		return 1 + solve(arr,i+1,j,m,n);

	else {
		if (arr[i+1][j] < arr[i][j+1])
			return 1 + solve(arr,i+1,j,m,n);
		else if (arr[i+1][j] > arr[i][j+1])
			return 1 + solve(arr,i,j+1,m,n);
		else {
			int first = solve(arr,i+1,j,m,n);
			int second = solve(arr,i,j+1,m,n);
			return first < second ? first+1:second+1;
		}
	}
}

int main(){
	int t;
	cin>>t;
	for (int i=0;i<t;i++){
		int m,n;
		cin>>m>>n;
		std::vector< std::vector<long> > arr(m,vector <long>(n));
		for (int i=0;i<m;i++){
			for (int j=0;j<n;j++){
				cin>>arr[i][j];
			}
		}
		int ans = solve(arr,0,0,m,n);
		cout <<ans<<endl;


	}



}