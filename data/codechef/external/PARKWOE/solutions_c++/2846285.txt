#include<stdio.h>
#define EMPTY 2147483647

int arr[300][300];

int trav(int i,int j,int lim_i,int lim_j,int val)
{
    if(i==(lim_i-1) && j==(lim_j-1) && arr[i][j]!=EMPTY)
    {
                        return val;
    }
    
    if(arr[i][j]==EMPTY)
    {
                        return val-1;
    }
    
    if(i+1<lim_i && j+1<lim_j)
    {
                 if(arr[i+1][j]<arr[i][j+1])
                  return trav(i+1,j,lim_i,lim_j,val+1);
                 
                 else
                  return trav(i,j+1,lim_i,lim_j,val+1);
    }
    
    if(i+1<lim_i)
    {
                 return trav(i+1,j,lim_i,lim_j,val+1);
    }
    
    return trav(i,j+1,lim_i,lim_j,val+1);
}

int main()
{
    int t,n,m,i,j,ans,f=0;
    
    scanf("%d",&t);
    
    while(t--)
    {
              scanf("%d %d",&n,&m);
              f=0;
              
              for(i=0;i<n;i++)
              {
                              for(j=0;j<m;j++)
                               scanf("%d",&arr[i][j]);
                              
              }
              
              /*if(arr[0][0]==EMPTY)
              {
                                  ans=0;
                                  f=1;
              }
              else if(n>=2 && m>=2)
              {
                   if(arr[0][1]==EMPTY && arr[1][0]==EMPTY)
                   {
                                       ans=0;
                                       f=1;
                   }
              }
              else if(n>=2)
              {
                   if(arr[1][0]==EMPTY)
                   {
                                       ans=0;
                                       f=1;
                   }
              }
              else if(m>=2)
              {
                   if(arr[0][1]==EMPTY)
                   {
                                       ans=0;
                                       f=1;
                   }
              }*/
              
              if(!f)
               ans=trav(0,0,n,m,0);
              
              if(ans==-1)
               ans=0;
              
               
              printf("%d\n",ans);
    }
    
    return 0;
}
    
    
