#include <bits/stdc++.h>

using namespace std;

const long long mod = 1e9 + 7;

bool isSquare(int x) {
    int root = sqrt(x);
    if (x == root*root)
        return true;
    return false;
}

int main() {

    int t;
    scanf("%d",&t);

    while (t--) {
        int n;
        scanf("%d",&n);
        int ar[n];
        int k = 0;
        for (int i = 0; i < n; ++i) {
            scanf("%d",&ar[i]);
            int x = __gcd(ar[i],i+1);
            if (x != 1 && isSquare(x))
                ++k;
        }

        long long num = 1;
        if (k) {
            stable_sort(ar,ar+n,greater<int>());
            for (int i = 0; i < k; ++i)
                num = (num*ar[i])%mod;
        }
        printf("%lld\n",num);
    }


    return 0;
}
