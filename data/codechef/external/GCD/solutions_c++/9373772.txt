    #include<bits/stdc++.h>
    #define pL(i) printf("%lld\n",i)
    #define pI(i) printf("%d\n",i)
    #define TC(t) while(t--)
    #define all(a,b) for(int i=a;i<=b;i++)
    #define rep(i,a,b) for(int i=a;i<=b;i++)
    #define GC getchar_unlocked
    #define PC putchar_unlocked
    #define PB push_back
    #define MOD 1000000007

    using namespace std;
    typedef unsigned long long int ll;

    template<typename T>
    inline void IN(T &p)
    {
        register T x=0,a = GC(),sign=1;
        while((a<'0')||(a>'9'))
        {
            if(a=='-')
            {
                sign=-1;
                a=GC();
                break;
            }
            a=GC();
        }
        for(;a>='0' && a<='9';a = GC()) {x = (x<<1) + (x<<3) + a - '0';}
        p=x*sign;
    }

    template<typename T>
    inline void OUT(T n)
    {
        register char d[25];
        register int i=0;
        if(n<0)
        {
            PC('-');
            n=-n;
        }
        do
        {
            d[i++]=n%10+'0';
            n/=10;
        }while(n);

        while(i)
            PC(d[--i]);
        PC('\n');
    }

    ll gcd(ll a,ll b)
    {
        return b==0?a:gcd(b,a%b);
    }

    void f()
    {
        ll n,temp,coun=0,ans=1,temp2;
        IN(n);
        vector<ll>v(1000000);

        all(0,n-1)
        {
            IN(v[i]);
            temp=gcd(v[i],i+1);
            if(temp!=1)
            {
                temp2=sqrt(temp);
                if(temp==temp2*temp2)
                coun++;
            }
        }

        if(coun)
        {
            sort(v.begin(),v.begin()+n);
            temp=0;
            temp2=n-1;
            while(temp!=coun)
            {
                ans=(ans*v[temp2])%MOD;
                temp++;
                temp2--;
            }
        }
        OUT(ans);
    }

    int main()
    {
        int t;
        IN(t);

        TC(t)
        f();
    }
