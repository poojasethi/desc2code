#include<bits/stdc++.h>
#include <math.h>
using namespace std;

#define MOD 1000000007
#define MAX 2010
#define ll long long
#define slld(t) scanf("%lld",&t)
#define sd(t) scanf("%d",&t)
#define sld(t) scanf("%ld",&t)
#define pd(t) printf("%d\n",t)
#define plld(t) printf("%lld\n",t)
#define pcc pair<char,char>
#define pp pair<int,int>
#define pll pair<ll,ll>
#define tr(container,it) for(typeof(container.begin()) it=container.begin();it!=container.end();it++)
#define mp(a,b) make_pair(a,b)
#define F first
#define S second
#define pb(x) push_back(x)

int A[1000007];

bool f(int x)
{
	if(x==1) return false;
	int m = sqrt(x);
	if(m*m==x){
		return true;
	}
	return false;
}
int main()
{
	int t;
	sd(t);
	while(t--)
	{
		int n;
		sd(n);
		int count = 0;
		for( int i=1; i<=n; i++)
		{
			sd(A[i]);
			int k = __gcd(i,A[i]);
			if(f(k))
			{
				count++;
			}
		}
		sort(A+1,A+n+1);
		ll ans = 1;
		for( int i=n; i>n-count; i--)
		{
			ans = ans*A[i];
			ans%=MOD;
		}
		plld(ans);
	}
}