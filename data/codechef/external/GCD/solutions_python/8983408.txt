#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define mod 1000000007
int main()
{
	vector<int> v(1000000);
	int i,j,t,c,cal,temp,n;
	ll ans;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%d",&n);
		ans=1;
		c=0;
		for(i=0;i<n;i++)
		{
			scanf("%d",&(v[i]));
			cal=__gcd(i+1,v[i]);
			if(cal!=1)
			{
				temp=sqrt(cal);
				if(temp*temp==cal)
					c++;
			}
		}
		if(c)
		{
			
			sort(v.begin(),v.begin()+n);
			cal=0;
			i=n-1;
			while(cal!=c)
			{
				ans=(ans*v[i])%mod;
				cal++;
				i--;
			}
		}
		printf("%lld\n",ans);
	}
	return 0;
}