//
//  main.cpp
//  chef_and_array_and_K
//
//  Created by IIT Indore on 6/14/16.
//  Copyright Â© 2016 kalyan0510. All rights reserved.
//

#include <iostream>
#include <ctime>
#include <cstdio>
#include <algorithm>
#include <cstring>
#define pi(a) printf("%d",a)
#define pll(a) printf("%lld ",a)
#define ps(a) printf("%s ",a)
#define pc(a) printf("%c ",a)
#define pln() printf("\n")
#define pia(a,n) for(int i=0;i<n;i++)pi(a[i]);pln();
#define plla(a,n) for(int i=0;i<n;i++)pll(a[i]);pln();
#define pir(a,r,c) for(int i=0;i<r;i++){for(int j=0;j<c;j++)pi(a[i][j]);pln();}
#define gi(a) scanf("%d",a)
#define gll(a) scanf("%lld",a)
#define gc(a) scanf("%c",a)
#define gs(a) scanf("%s",a)
#define gia(a,n) for(int i=0;i<n;i++)gi(a+i);
#define ll long long
#define min3(a,b,c) ((a>b)?((b>c)?(c):(b)):((a>c)?(c):(a)))
#define min2(a,b) ((a>b)?b:a)
#define max3(a,b,c) ((a<b)?((b<c)?(c):(b)):((a<c)?(c):(a)))
#define max2(a,b) ((a<b)?b:a)
#define oddNolessthaneq(n) ((n%2==0)?n-1:n)
#define evenNolessthaneq(n) ((n%2==0)?n:n-1)
#define ten9v1 1000000001
#define nten9v1 -1000000001
#define ten6 1000000
#define ten9v7 1000000007
#define MOD 1000000007
#include<vector>
ll Ck(ll n, ll k)
{
    ll C[k+1];
    memset(C, 0, sizeof(C));
    
    C[0] = 1;  // nC0 is 1
    
    for (ll i = 1; i <= n; i++)
    {
        // Compute next row of pascal triangle using
        // the previous row
        for (ll j = min2(i, k); j > 0; j--)
            C[j] = (C[j] + C[j-1])%ten9v7;
    }
    return C[k]%ten9v7;
}


/* This function calculates (a^b)%MOD */
long long pow(ll a, ll b){
    long long x=1,y=a;
    while(b > 0){
        if(b%2 == 1){
            x=(x*y);
            if(x>MOD) x%=MOD;
        }
        y = (y*y);
        if(y>MOD) y%=MOD;
        b /= 2;
    }
    return x;
}

long long InverseEuler(ll n){
    return pow(n,MOD-2);
}

long long Ckt(ll n, ll r){
    long long f[n+1];
    f[0]=f[1]=1;
    for (int i=2; i<=n;i++)
        f[i]= (f[i-1]*i) % MOD;
    return (f[n]*((InverseEuler(f[r]) * InverseEuler(f[n-r])) % MOD)) % MOD;
}
long long sumUpToK(ll n,ll k){
    ll tmp=1;
    ll nck = 1;
    for(int i=1;i<=k;i++){
        nck = ((nck*(n-i+1))%MOD)*(InverseEuler(i)) % MOD;
        //ps("nck for n:");pll(n);ps(" k:");pi(i);ps(" -> ");pll(nck);pln();
        //ps("euler inverse of ");pi(i+1);ps(" : "); pll(InverseEuler(i+1));pln();
        tmp+=nck;
        tmp%=MOD;
    }
    return tmp;
}
long long sumUpToK2(ll n,ll k){
    ll nck=1;
    int tgl=!(k%2);
    //ps("\nsum2\n");
    ll tmp = tgl?1:0;
    for(int i=1;i<=k;i++){
        nck = ((nck*(n-i+1))%MOD)*(InverseEuler(i)) % MOD;
        //ps("nck for n:");pll(n);ps(" k:");pi(i);ps(" -> ");pll(nck);pln();
        //ps("euler inverse of ");pi(i+1);ps(" : "); pll(InverseEuler(i+1));pln();
        tmp+=(tgl?0:nck);
        tmp%=MOD;
        tgl = !tgl;
    }
    return tmp;
}
int main(int argc, const char * argv[]) {
    int T;
    gi(&T);
    while(T--){
       // ps("T:");pi(T);pln();
        ll N,K,z=0,x,n;
        ll s=0;
        gll(&N);gll(&K);
        
        for(int i=0;i<N;i++){
            gll(&x);
            if(!x)
                z++;
        }
        n=N-z;
        if(K>=n){
            if(!z){
                //K = (K%2==0)?evenNolessthaneq(n):oddNolessthaneq(n);
                ll u=1;
                for(ll i=0;i<n-1;i++){
                    u *= 2;
                    u %= ten9v7;
                }
                pll(u);pln();
                continue;
            }
            else{
                //K=n;
                ll u=1;
                for(ll i=0;i<n;i++){
                    u *= 2;
                    u %= ten9v7;
                }
                pll(u);pln();
                continue;
            }
        }
    //    ps("n-> "); pll(n); ps(" k-> "); pll(K);pln();
        if(!z){
            /*for(ll i=K;i>=0;i-=2){
                s+=Ckt(n,i);
                s%=ten9v7;
                
            }*/
            s =sumUpToK2(n, K);
            //ps("\nsumuptok: \n");pll(sumUpToK2(n, K));ps("  Calc: "); pll(s);pln();
        }else{
            /*for(ll i=K;i>=0;i--){
                s+=Ckt(n,i);
                s%=ten9v7;
            }*/
            s =sumUpToK(n, K);
            
        }
        pll(s);pln();
    }
}
