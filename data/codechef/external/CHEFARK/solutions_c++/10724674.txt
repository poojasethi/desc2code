#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define mod	1000000007
ll inverse(ll number)
{	ll pow=mod-2;
	unsigned long long int  ans=1;
	unsigned long long int  y=number;
	while(pow)
	{	if(pow&1)
		{	ans*=y;
			ans%=mod;
	}
	y*=y;
	y%=mod;
	pow>>=1;
	}
	return ans;
}


int main()
{	ll fact[100000+2];
	fact[0]=1;
	for(int i=1;i<100000+2;i++)fact[i]=(i*fact[i-1])%mod;
		int  t;
	scanf("%d",&t);
	while(t--)
	{	ll n,k;
		scanf("%lld%lld",&n,&k);
		ll z=0;
		ll temp;
		for(ll i=0;i<n;i++)
		{	scanf("%lld",&temp);
			if(temp==0)z++;
		}
		n-=z;

		ll res=0;
		for(int i=0;i<=min(k,n);i++)
		{	if(z||(k+i)%2==0)
			{	ll temp=fact[n];
				temp*=inverse(fact[i]);
				temp%=mod;
				temp*=inverse(fact[n-i]);
				temp%=mod;
				res+=temp;
			}
		}
		res%=mod;
		printf("%lld\n",res);
	}
}
	









 