#include<stdio.h>
//#include<conio.h>
#include<math.h>
int bsearchsmallerside(int *a,int low ,int high,int item)
{
    if(high==low)
    {
        return low;    
    }
    else
    {
        int   mid=(low+high)/2;
        if(item==a[mid])
        return mid;
        else if(item>a[mid])
        {
        low=mid+1;
        return(bsearchsmallerside(a,low,high,item));
        }
        else
        {
        high=mid; 
        return(bsearchsmallerside(a,low,high,item));
        }   
    }
}


int main()
{
int N,p,q,count,T,reverse,a[100000],i,j,i1,count1,loop,x,y,c;
a[0]=2;
a[1]=3;
count=2;
for(i=5,j,loop=1;i<=100001;loop++)
		{
			 i1=sqrt(i);
			for(j=0;(j<count)&&(a[j]<=i1);j++)
			{
				if(i%a[j]==0)
				break;
			}
			if(a[j]>i1)
			{
			a[count]=i;
			count++;
			}
			if(loop%2!=0)
			i+=2;
			else
			i+=4;			
		}  
		
		//printf("%d %d %d",count,a[count],a[count-1]);
		scanf("%d",&T);
		while(T--)
		{
        reverse=0;
        scanf("%d %d",&p,&q);
        if(p>q)
        {
        c=q;
        q=p;    
        p=c;
        reverse=1;    
        }
        //printf("enter N");
        scanf("%d",&N);
        x=bsearchsmallerside(a,0,9591,p+1);
        y=bsearchsmallerside(a,0,9591,q-1);
        if(a[y]>=q)
        y=y-1;
        if(a[x]<=p)
        x=x+1;
        //printf("\n%d %d\n",a[x],a[y]);
        if(a[x]>a[y] || a[x]>=q || a[y]<=p)
        printf("-1\n");
        else
        {
        count1=(y-x)+1;
        N=N%count1;
        if(N==0)  N=count1;
        //if(reverse==1) N=count1-N+1;
        printf("%d\n",a[x+(N-1)]);    
        }
        }
        //getch();
        return 0;
}
