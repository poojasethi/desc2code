#include <iostream>
#include <cstdio>
#include <map>
#include <cstring>
#include <string>
#include <cmath>
#include <cassert>
#include <cstdlib>
#include <vector>
#include <utility>
#include <algorithm>

#define MOD 1000000007
#define INF 99999999
#define ONLINE_JUDGE
#define FOR(i,a,b) for(int i=(a);(i)<(b);i++)
#define MAX(a,b) ((a)>(b)?(a):(b))
#define MIN(a,b) ((a)<(b)?(a):(b))

typedef unsigned long long ULL;
typedef long long LL;

using namespace std;

int main()
{
    #ifndef ONLINE_JUDGE
    freopen("in.txt","r",stdin);
    //freopen("out.txt","w",stdout);
    #endif
    int N;
    int temp[105][105];
    char s[105][105];
    scanf("%d%*c",&N);
    FOR(i,0,N)
    {
        scanf("%s",s[i]);
    }
    int M=strlen(s[1]);
    FOR(i,0,N)
    {
        FOR(j,0,M)
        {
            if(s[i][j] == '0' ) temp[i][j]=0;
            else temp[i][j]=INF;
        }
    }
    temp[0][0]=1;
    bool check=true;
    while(check)
    {
        check=false;
        FOR(i,0,N)
        {
            FOR(j,0,M)
            {
                if(i==0 && j==0) continue;
                if(s[i][j] == '1') continue;
                int min=INF;
                bool flag=false;
                for(int m=i-1;m<=i+1;m++)
                {
                    if(m<0 || m>=N) continue;
                    for(int n=j-1;n<=j+1;n++)
                    {
                        if(s[m][n] == '1' || n<0 || n>=M) continue;
                        if(temp[m][n]==0) continue;
                        if(n==j && m==i) continue;
                        flag=true;
                        min=MIN(min,temp[m][n]);
                    }
                }
                if(min+1< temp[i][j] || temp[i][j]==0)
                {
                    check=true;
                    if(min==INF) temp[i][j]=min;
                    else temp[i][j]=min+1;
                }
            }
        }
    }
    printf("%d\n",temp[N-1][M-1]);
    return 0;
}
