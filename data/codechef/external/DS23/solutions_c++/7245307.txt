#include <cstdlib>
#include <iostream>
#include <climits>
#include <string>

using namespace std;
string s[80];
int sum = 1;
int minimum = INT_MAX;
void solve(int i, int j,int n,int m)
{
     if(i<0 || i>=n || j<0 || j>=m || s[i][j] == '1' )
        return;
     if(i == n-1 && j == m-1){
          if(sum< minimum) minimum = sum;
          return;
     }
     
     s[i][j] = '1';
     ++sum;
     solve(i+1,j+1,n,m);
     solve(i-1,j+1,n,m);
     solve(i+1,j-1,n,m);
     solve(i-1,j-1,n,m);
     solve(i+1,j,n,m);
     solve(i-1,j,n,m);
     solve(i,j+1,n,m);
     solve(i,j-1,n,m);
     s[i][j] = '0';
     --sum;
 }
int main()
{
    int n;
    scanf("%d",&n);
    for(int i = 0;i<n;++i){
        cin >> s[i];
    }    
    int m = s[0].length();
    solve(0,0,n,m);
    printf("%d\n",minimum);        
    
    return 0;
}
