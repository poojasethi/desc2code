#include<bits/stdc++.h>
using namespace std;
#define s(x) scanf("%d",&x)
#define ii pair<int,int>
#define db(x) cerr << #x << ": " << x << endl;
#define db2(x, y) cerr << #x << ": " << x << " | " << #y << ": " << y << endl;
#define db3(x, y, z) cerr << #x << ": " << x << " | " << #y << ": " << y << " | " << #z << ": " << z << endl;
#define db4(a, b, c, d) cerr << #a << ": " << a << " | " << #b << ": " << b << " | " << #c << ": " << c << " | " << #d << ": " << d << endl;
#define db5(a, b, c, d, e) cerr << #a << ": " << a << " | " << #b << ": " << b << " | " << #c << ": " << c << " | " << #d << ": " << d << " | " << #e << ": " << e << endl;
#define db6(a, b, c, d, e, f) cerr << #a << ": " << a << " | " << #b << ": " << b << " | " << #c << ": " << c << " | " << #d << ": " << d << " | " << #e << ": " << e << " | " << #f << ": " << f << endl;
void gentests()
{
    ofstream file;
    file.open("in");
    int test=1;
    file<<test<<endl;
    while(test--)
    {
        int n=rand();
        int x=1;
        int m=10;
        file<<n<<" "<<x<<" "<<m<<endl;
        for(int i=0;i<m;i++)
        {
            int a=rand();
            int b=rand();
            if(a>b)
                swap(a,b);
            file<<a<<" "<<b<<endl;

        }
        file<<endl;
        file.close();
    }
}
vector<int> factorize(int x)
{
    vector<int> ret;
    for(int i=2;i*i<=x;i++)
    {
        int cnt=0;
        while(x%i==0)
        {
            x/=i;
            cnt++;
        }
        while(cnt--)
            ret.push_back(i);
    }
    if(x>1)
        ret.push_back(x);
    sort(ret.begin(),ret.end());
    ret.erase(unique(ret.begin(),ret.end()),ret.end());
    return ret;
}
int main()
{
    //gentests();
    //freopen("in","r",stdin);
    int test;s(test);
    while(test--)
    {
        int n;s(n);
        int m,x;s(x);s(m);
        vector<int> f=factorize(n/x);
        while(m--)
        {
            int l,r;s(l);s(r);
            if(n%x==0)
            {
                int nx=n/x;
                int ll=ceil(double(l)/double(x));
                int rr=r/x;
                int cnt=0;
                for(int i=1;i<(1<<f.size());i++)
                {
                    int c=0;
                    int mul=1;
                    for(int j=0;j<f.size();j++)
                    {
                        if((1<<j)&i)
                        {
                            mul*=f[j];
                            c++;
                        }
                    }
                    if(c&1)
                    {
                        cnt+=(rr/mul - (ll-1)/mul);
                    }
                    else
                    {
                        cnt-=(rr/mul - (ll-1)/mul);
                    }
                }
                printf("%d\n",(rr-ll+1)-cnt);
            }
            else
            {
                puts("0");
            }
        }
    }
    return 0;
}

