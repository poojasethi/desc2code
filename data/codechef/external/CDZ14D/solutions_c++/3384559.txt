#include <iostream>
#include <vector>
#include <cstdio>
#include <cmath>
#include <vector>
using namespace std;
#define lli long long int

long long func(long long a, long long b,long long n)
{
     long long i,t,sum,j,p1=0,p2=0,c;
     vector <long long> v;
     if ( n%2 == 0  ) {
        v.push_back(2);
        while ( n%2 == 0 ) n = n/2;
     }
     t = (long long)(sqrtl(n));
     for ( i = 3; i <= t; i += 2 ) {
         if ( n%i == 0 ) {
            v.push_back(i);
            while ( n%i == 0 ) n = n/i;
         }
         if ( n == 1 ) break;
     }
     if ( n != 1 ) {
        v.push_back(n);
     }
     t = (long long)(v.size());     
     
     for ( i = 0; i < 1 << t; i++ ) {
         sum = 1;
         c = 0;
         for ( j = 0; j < t; j++ ) {
              if ( i & (1<<j) ) {
                 c++;
                 sum *= v[j];
              }
         }
         if ( c&1 ) {
            p1 += a/sum;
            p2 += b/sum;
         }
         else {
              if ( sum != 1 ) {
                 p1 -= a/sum;
                 p2 -= b/sum;
              }
         }
     }
     p2 = b - p2;
     p1 = a - p1;
     return p2-p1;
}



int main()
{
    int t;
    cin>>t;
    while(t--)
    {
              int fl=0;
              lli n,x,m;
              cin>>n>>x>>m;
              if(n%x!=0) fl=1;
              n=n/x;    
              while(m--)
              {
                        lli l,r;
                        cin>>l>>r;
                        if(fl==1)
                        {
                                 cout<<"0\n";
                                 continue;
                        }    
                        if(l%x==0) l=l/x;
                        else l=(l/x+1);
                        r=r/x;
                        cout<<func(l-1,r,n)<<"\n";                        
              }
    }
    return 0;
}
                        
                        
