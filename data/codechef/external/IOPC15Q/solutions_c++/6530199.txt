#include<iostream>
#include<cstdio>
using namespace std;

#define MXN 100010

bool poss=1;
int par[MXN]={0},n,a[MXN],c[MXN]={0};

void resolve(int l,int r)
{
    if(!poss) return;
    int i,j;
    for(i=l+1;i<=r;++i)
    {
           par[a[i]]=a[l];
           if(c[i]>0)
           {

                          if(c[i]>r)
                          {
                                   poss=0;
                                   return;
                          }
                     resolve(i,c[i]);
                     i=c[i];
           }
    }
}

/*
10
3
3 3 7
4 4 7
8 8 9
*/

int main()
{
    int q,i,nd,l,r;
    scanf("%d",&n);
    for(i=1;i<=n;++i)
    {
         a[i]=i;
         scanf("%d",&a[i]);
    }
    scanf("%d",&q);
    //q=0;
    if(a[1]!=1) poss=0;
    while(q--)
    {
              scanf("%d%d%d",&nd,&l,&r);
              if(a[l]!=nd) poss=0;
              if(l==1 && r<n) poss=0;
              if(c[l]>0 && c[l]!=r) poss=0;
              c[l]=r;
    }
    resolve(1,n);
    if(!poss) printf("0\n");
    else
    {
        printf("1\n");
        for(i=1;i<=n;++i)
        {
              if(i==a[1]) continue;
              printf("%d %d\n",i,par[i]);
        }
    }
    //system("pause");
}
