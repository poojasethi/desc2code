#include<iostream>
#include<cstdio>
#include<algorithm>
using namespace std;
int c;
long long int solve(long long int a,long long int b)
{
  if(a%b==0)
  { c++;
    solve(a/b,b);
  }
  else
  return a;
  }
int main()
{
   int t;
   long long int n,k,m,ans;
   scanf("%d",&t);
   while(t--)
   {
      c=0;
     scanf("%lld%lld%lld",&n,&k,&m);
     if(k==1)
     {
       printf("%lld\n",n);
       continue;
     }
     ans=solve(n,k);
     if(c>=m)
     printf("%lld\n",ans);
     else
     {
       if((m-c)%2==0)
       printf("%lld\n",ans);
       else
       printf("%lld\n",ans*k);
     }
   }
  return 0;
}