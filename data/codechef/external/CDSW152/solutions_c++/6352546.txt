#include<iostream>
using namespace std;
long long int expo(long long int base,long long int power);
long long int a[1000000];
int main()
{
    long long int i,t,n,ans;
    a[0]=0;a[1]=0;a[2]=0;
    for(i=3;i<100005;i++)
        a[i]=(((a[i-1]*3)%1000000007)+expo(3,i-3)%1000000007-a[i-3]%1000000007+1000000007)%1000000007;
    cin>>t;
    while(t)
    {
        cin>>n;
        ans=((expo(3,n)%1000000007-a[n]%1000000007)+1000000007)%1000000007;
        cout<<ans<<endl;
        t--;
    }

}


long long int expo(long long int base,long long int power)
{long long int ans=1,raise=power;

    if((base==0)&&(power==0))return 1;
   // if((base==0)&&(power%mod==0))return 0;
    if((base==0)&&(power!=0))return 0;
    //if(base%mod==0)return 0;
//cout<<base<<"                 "<<power<<endl;
    while (power > 0)
	{
		if (power%2==1)
			{ans =(((ans)%1000000007)*(base%1000000007))%1000000007;}
		base =((base%1000000007)*(base%1000000007))%1000000007;
		power=power/2;//cout<<ans<<endl<<base<<endl<<power;
	}
    return ans%1000000007;
}
