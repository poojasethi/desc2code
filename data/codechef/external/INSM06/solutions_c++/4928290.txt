#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<iostream>
#include<cmath>
#include<algorithm>
using namespace std;
int n,m,a[102][102];
void init()
{
	scanf("%d%d",&n,&m);
	int i,j;
	for(i=1;i<=n;i++) 
	for(j=1;j<=n;j++)
	   scanf("%d",&a[i][j]);
}
void pt0()
{
	int i,j;
	for(i=1;i<=n;i++)
	for(j=1;j<=n;j++)
	   {printf("%d",a[i][j]);
		if(j!=n) printf(" ");
		else printf("\n");
	   }
	printf("\n");
}
void pt1()
{
	int i,j;
	for(j=1;j<=n;j++)
	for(i=n;i>0;i--)
	   {printf("%d",a[i][j]);
		if(i!=1) printf(" ");
		else printf("\n");
	   }
	printf("\n");
}
void pt2()
{
	int i,j;
	for(i=n;i>0;i--)
	for(j=n;j>0;j--)
	   {printf("%d",a[i][j]);
		if(j!=1) printf(" ");
		else printf("\n");
	   }
	printf("\n");
}
void pt3()
{
	int i,j;
	for(j=n;j>0;j--)
	for(i=1;i<=n;i++)
	   {printf("%d",a[i][j]);
		if(i!=n) printf(" ");
		else printf("\n");
	   }
	printf("\n");
}
void work()
{
	int i,x;
	for(i=1;i<=m;i++)
	   {scanf("%d",&x);
	    x=x/90; x=x%4;
		if(x==0) pt0();
		else if(x==1) pt1();
		else if(x==2) pt2();
		else if(x==3) pt3();
	   }
}
int main()
{
	init(); work();
	return 0;
}