#include<bits/stdc++.h>
#define FOR(i,a,b) for(i=(a);i<(b);i++)
#define pnt pair<int,int>
#define pb(x) push_back(x)
#define mp(x,y) make_pair((x),(y))
#define mset(m,v) memset(m,v,sizeof(m))
#define INF 0x3f3f3f3f
#define gc getchar_unlocked
 
typedef long long ll;
typedef unsigned long long ull;
 
const ll MOD=1000000007;
 
using namespace std;
 
inline int inp(){
	int n=0,sign=1;
	char c;
	c=gc();
	while(c<'0' || c>'9'){
		if(c=='-')	sign=-sign;
		c=gc();
	}
	while(c>='0' && c<='9'){
		n=(n<<3)+(n<<1)+c-'0';
		c=gc();
	}
	n=n*sign;
	return n;
}
 
 
ll power(ll a,ll b,ll mod){
      if(b==0)
            return 1;
      ll temp=power(a,b/2,mod);
      temp=(temp*temp)%mod;
      if(b&1)
            temp=(temp*a)%mod;
      return temp;
}
 
int pwr(int a,int b){
      if(b==0)
            return 1;
      int temp=pwr(a,b/2);
      temp=(temp*temp);
      if(b&1)
            temp=(temp*a);
      return temp;
}
 
ll gcd(ll a,ll b){
      return b==0?a:gcd(b,a%b);
}
 
ll lcm(ll a,ll b){      
      return (a/gcd(a,b))*b;
}
 
ll modularInverse(ll a,ll m){
      return power(a,m-2,m);
}
 
int ceill(int a,int b){
	return (a+b-1)/b;
}
 
int main(){
	int n,k,m,i,j,p,q,a[101][101];
	#ifndef ONLINE_JUDGE
		freopen("inpu.txt","r",stdin);
	#endif
	cin>>n>>m;
	FOR(i,0,n){
		FOR(j,0,n){
			cin>>a[i][j];
		}
	}
	FOR(k,0,m){
		cin>>q;
		q=q/90;
		p=q%4;
		if(p==0){
			FOR(i,0,n){
				FOR(j,0,n){
					cout<<a[i][j]<<" ";
				}
				cout<<endl;
			}
		}
		else if(p==1){
			FOR(j,0,n){
				for(i=n-1;i>=0;i--){
					cout<<a[i][j]<<" ";
				}
				cout<<endl;
			}
		}
		else if(p==2){
			for(i=n-1;i>=0;i--){
				for(j=n-1;j>=0;j--){
					cout<<a[i][j]<<" ";
				}
				cout<<endl;
			}
		}
		else if(p==3){
			for(j=n-1;j>=0;j--){
				FOR(i,0,n){
					cout<<a[i][j]<<" ";
				}
				cout<<endl;
			}
		}
		cout<<endl;
	}	
	return 0;
}   