#include<stdio.h>
#define for_loop(i,n) for(int i=0;i<n;i++)


using namespace std;

int arr[110][110];
int mat[110][110];

void rotMatrix(int rot,int n){

	//int mat[][]=new int[n][n];

	for_loop(i,n){

		for_loop(j,n){

			if(rot==0){

				mat[i][j]=arr[i][j];				
			}			
			if(rot==1){

				mat[j][n-i-1]=arr[i][j];				
			}
			if(rot==2){

				mat[n-1-i][n-1-j]=arr[i][j];
			}
			if(rot==3){

				mat[n-j-1][i]=arr[i][j];
			}
		}
	}
	//return mat;
}
void printMat(int n){

	for_loop(i,n){

		for_loop(j,n){

			printf("%d ",mat[i][j]);
		}
		printf("\n");
	}
	printf("\n");
}

void rotMat(){

	int n,m;

	scanf("%d %d",&n,&m);

	for_loop(i,n)
		for_loop(j,n)
			scanf("%d",&arr[i][j]);

	for_loop(i,m){

		int temp;
		scanf("%d",&temp);
		temp/=90;
		if(temp%4==0){

			rotMatrix(0,n);

			printMat(n);
			continue;
		}
		if(temp%4==1){

			rotMatrix(1,n);

			printMat(n);
			continue;
		}
		if(temp%4==2){

			rotMatrix(2,n);

			printMat(n);
			continue;
		}
		if(temp%4==3){

			rotMatrix(3,n);

			printMat(n);
			continue;
			//continue;
		}

	}
		
}

int main(){

	rotMat();
	return 0;
}