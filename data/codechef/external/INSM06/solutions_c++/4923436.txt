#include <iostream>
using namespace std;
#include <vector>
#include <map>
int arr[4][100][100];
int n,m;
void ratat(int source,int target){
	int temp1,temp2,temp3,temp4;
	for(int i=0;i<n;i++){
		for(int j=i;j<n-i;j++){
			temp1=arr[source][i][j];
			temp2=arr[source][j][n-1-i];
			temp3=arr[source][n-1-i][n-1-j];
			temp4=arr[source][n-1-j][i];
			arr[target][i][j]=temp4;
			arr[target][j][n-1-i]=temp1;
			arr[target][n-1-i][n-1-j]=temp2;
			arr[target][n-1-j][i]=temp3;
		}
	}/*cout<<"target : "<<endl;
	for(int i=0;i<n;i++){
		for(int j=0;j<n;j++){
			cout<<arr[target][i][j]<<" ";
		}cout<<endl;
	}*/
}
void Print(int angle){
	int f=angle/90;
	f= f%4;
	for(int i=0;i<n;i++){
		for(int j=0;j<n;j++){
			cout<<arr[f][i][j]<<" ";
		}cout<<endl;
	}
}
int main(){
	
	cin>>n>>m;
	for(int i=0;i<n;i++){
		for(int j=0;j<n;j++){
			cin>>arr[0][i][j];
		}
	}
	//cout<<"agnel 0 : "<<endl;
	//Print(0);	
	ratat(0,1);
	//cout<<"agnel 1 : "<<endl;
	//Print(90);
	ratat(1,2);
	ratat(2,3);/*
	cout<<"0 \n";Print(0);
	cout<<"1 \n";Print(90);
	cout<<"2 \n";Print(180);
	cout<<"3 \n";Print(270);*/	
	int angle;
	while(m--){
		cin>>angle;
		Print(angle);
		cout<<endl;
	}
return 0;	
}