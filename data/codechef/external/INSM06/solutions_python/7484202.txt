n,m=map(int, raw_input().split())
a=[ raw_input().split() for j in xrange(n) ]
while m>0:
	m-=1
	ang=input()
	ang/=90
	ang%=4
	if(ang==1):
		for j in xrange(0,n):
			for i in xrange(n-1,-1,-1):
				print a[i][j],
			print 
	elif(ang==2):
		for i in xrange(n-1,-1,-1):
			for j in xrange(n-1,-1,-1):
				print a[i][j],
			print 
	elif(ang==3):
		for i in xrange(n-1,-1,-1):
			for j in xrange(0,n):
				print a[j][i],
			print 
	else:
		for row in a:
			print " ".join(map(str,row))