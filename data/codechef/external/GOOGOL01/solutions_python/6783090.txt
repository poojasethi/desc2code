#include<stdio.h>
#include<stdlib.h>

int main()
{
       long int a,d,x,n,i;
       long long int sum,pow[100005],prod;
       for(i=0;i<100005;i++)
           pow[i]=0;
       int T;
       scanf("%d",&T);
       while(T>0)
       {
               scanf("%ld%ld%ld%ld",&a,&d,&n,&x);
               pow[0]=1;
               for(i=1;i<n+1;i++)
               {
                     pow[i]=(pow[i-1]*x)%215372682525;
               }
               sum=0;
               prod=0;
               for(i=0;i<n+1;i++)
               {
                   sum=(sum+a*pow[n-i])%215372682525;
                   prod=(prod+i*pow[n-i])%215372682525;
               }
               sum=(sum+d*prod)%215372682525;
               printf("%lld\n",sum);
               --T;
       }
       return 0;
}
