#include<stdio.h>
#define MAX 100010
#define sf(n) scanf("%d",&n)
#define lli int
#define ll long long int
#define MOD 215372682525LL
ll mul(ll a,ll b){
  ll x=0,y=a;
  while(b>0)
  {
      if(b%2==1)
        x=(x+y)%MOD;
      y=(y+y)%MOD;
      b/=2;
  }
  return x%MOD;
}

//ll inv(int n){return power(n,MOD-2);}

int main(){
 lli t,n,j,a,d,x;
 ll i,ans,temp,tmp,lans,rans,bx,cx;
 sf(t);
 while(t--)
 {ans=0;
     sf(a);sf(d);sf(n);sf(x);
     lans=1;bx=1;
     for(i=1;i<=n;i++)
     {
         bx=(bx*x);if(bx>=MOD) bx%=MOD;
         lans=(lans+bx);if(lans>=MOD) lans%=MOD;
     }
     lans=(lans*a)%MOD;
     //printf("%lld ",lans);
     rans=n;bx=1;
     for(i=n-1;i>=1;i--)
     {
         bx=(bx*x);if(bx>=MOD) bx%=MOD;
         cx=(bx*i);if(bx>=MOD) bx%=MOD;
         rans=(rans+cx);if(rans>=MOD) rans%=MOD;
     }
     //printf("%ldl ",rans);
     rans=(d*rans)%MOD;
     ans=(lans+rans)%MOD;
     printf("%lld\n",ans);
 }
 return 0;
}