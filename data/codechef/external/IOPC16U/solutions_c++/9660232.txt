#include <iostream>
#include <cstring>
#include <cstdio>
#include <algorithm>
#include <cmath>
#include <map>
using namespace std;

int answer=0,con,n;

string str[10010];
int arr[10010];
int len[10010];
int ans[10010];
int bit1[10010];
int bit2[10010];
int cnt[10010];
map<string,int> mp;

struct node{
    int num,l,r;
}query[10010];

bool cmp(node a,node b){
    if((a.l/con)==(b.l/con))
        return a.r<b.r;
    return a.l<b.l;
}

void update1(int in,int val){
    while(in<=n){
        bit1[in]+=val;
        in+=(in&(-in));
    }
}

void update2(int in,int val){
    while(in<=n){
        bit2[in]+=val;
        in+=(in&(-in));
    }
}

int query1(int in){
    int an=0;
    while(in>0){
        an+=bit1[in];
        in-=(in&(-in));
    }
    return an;
}

int query2(int in){
    int an=0;
    while(in>0){
        an+=bit2[in];
        in-=(in&(-in));
    }
    return an;
}

void add(int in){
    cnt[arr[in]]++;
    if(cnt[arr[in]]>1)
        return;
    answer+=query2(n)-query2(arr[in]);
    answer+=(query1(arr[in]-1)+1)*len[in];
    update1(arr[in],1);
    update2(arr[in],len[in]);
}

void remove(int in){
    cnt[arr[in]]--;
    if(cnt[arr[in]]!=0)
        return;
    answer-=query2(n)-query2(arr[in]);
    answer-=(query1(arr[in]-1)+1)*len[in];
    update1(arr[in],-1);
    update2(arr[in],-len[in]);
}

int main(){
    int t;
    scanf("%d",&t);
    while(t--){
        int m;
        scanf("%d%d",&n,&m);
        mp.clear();
        for(int i=0;i<=n;i++)
            bit1[i]=bit2[i]=cnt[i]=0;
        for(int i=1;i<=n;i++){
            cin>>str[i];
            mp[str[i]];
        }
        for(int i=1;i<=m;i++){
            query[i].num=i;
            scanf("%d%d",&query[i].l,&query[i].r);
        }
        int cnti=1;
        con=(int)sqrt(n);
        for(map<string,int>::iterator it=mp.begin(); it!=mp.end(); ++it)
            mp[it->first]=cnti++;
        for(int i=1;i<=n;i++){
            arr[i]=mp[str[i]];
            len[i]=str[i].length();
        }
        sort(query+1,query+m+1,cmp);
        int lt=1,rt=1;
        answer=len[1];
        update1(arr[1],1);
        update2(arr[1],len[1]);
        cnt[arr[1]]++;
        for(int i=1;i<=m;i++){
            if(rt!=query[i].r){
                if(rt<query[i].r){
                    rt++;
                    while(rt<=query[i].r){
                        add(rt);
                        rt++;
                    }
                    rt--;
                }else{
                    while(rt>query[i].r){
                        remove(rt);
                        rt--;
                    }
                }
            }
            if(lt!=query[i].l){
                if(lt<query[i].l){
                    while(lt<query[i].l){
                        remove(lt);
                        lt++;
                    }
                }else{
                    lt--;
                    while(lt>=query[i].l){
                        add(lt);
                        lt--;
                    }
                    lt++;
                }
            }
            ans[query[i].num]=answer;
        }
        for(int i=1;i<=m;i++)
            printf("%d\n",ans[i]);
    }
}
