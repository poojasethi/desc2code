#include <cstdio>
# include <algorithm>
using namespace std;
 
int visited[1001];
int cost[1001];
int graph[1001][1001];
 
int dfs( int u ,int n) {
 
	if ( visited[u] == 1) 
		return cost[u];
 
	visited[u] = 1;
	int ans = 1;
	for ( int i = 0; i < n; i++) {
		
		if(graph[u][i] == 1){
		
		int d = dfs(i,n);
		if ( ans < (1 + d))
			ans = 1 + d;
		}
	}      
	
 
	 cost[u] =  ans;
	 return ans;
}	
 

 
 
 
int main()
{
 
	int t,n,m,a,b,i,j;
	scanf("%d",&t);
	while( t-- ) {
 
		scanf("%d%d",&n,&m);
		
 
		  for (i = 0; i < n; i++) {
                        cost[i] = 1;
                        visited[i] = 0;
                        
              for(j=0;j<n;j++)graph[i][j]=0;          
                        
			
          }
 
 
 
		for ( i = 0; i < m; i++) {
			scanf( "%d%d",&a,&b);
			graph[a][b] = 1;
		}
		
		
		int ans = 0;
		
		for (i = 0; i < n ; i++) {
	
			ans = max ( dfs(i,n), ans);
		}
		printf("%d\n",ans);
			
	}	
	return 0;
}
 