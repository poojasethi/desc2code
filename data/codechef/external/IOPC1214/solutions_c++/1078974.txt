#include<iostream>
#include<cstdio>
#include<vector>
#include <algorithm>
#include<cstring>
using namespace std;

vector<vector<int> > adjlist(1005 , vector<int> () );

int visited[1005];
int memo[1005];

int dp(int u) {
	if(memo[u] != -1)
		return memo[u];
	int ans = 1;
	for (int i = 0; i < adjlist[u].size(); i++) 
			ans = max(ans , dp(adjlist[u][i]) + 1);
	return memo[u] = ans;
}

int main() {
	int T;
	scanf("%d",&T);
	while (T--) {
		memset(visited , 0 , sizeof(visited));
		int n , m;
		scanf("%d%d",&n,&m);
		for (int i = 0; i < m; i++) {
			int t1 , t2;
			scanf("%d%d",&t1,&t2);
			adjlist[t1].push_back(t2);
		}
		int ans = 0;
		for (int i = 0; i < n; i++) {
			memset(memo , -1, sizeof(memo) );
			ans = max (ans , dp(i));
			memset(visited , 0 , sizeof(visited));
		}		
		printf("%d\n",ans);
		for (int i = 0; i < 1005; i++) 
			adjlist[i].resize(0);
	}
	return 0;
}