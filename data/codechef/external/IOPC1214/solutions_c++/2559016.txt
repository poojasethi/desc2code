#include <iostream>
#include <cstdio>
#include <vector>
#include <queue>


using namespace std;

int outdeg[1001];
vector<int> G[1001];

int main(){
	#ifndef ONLINE_JUDGE
		freopen("in.txt","r",stdin);
	#endif
	int t,N,M,a,b;
	scanf("%d",&t);
	while(t--){
		scanf("%d%d",&N,&M);
		for(int i = 0 ; i < N ; ++i) G[i].clear(),outdeg[i] = 0;
		for(int i = 0 ; i < M ; ++i){
			scanf("%d%d",&a,&b);
			G[b].push_back(a);
			outdeg[a]++;
		}
		queue<int> curr;
		for(int i = 0 ; i < N ; ++i) if(outdeg[i]==0) curr.push(i);
		int res = 0;
		while(!curr.empty()){
			res++;
			queue<int> next;
			while(!curr.empty()){
				int top = curr.front();
				curr.pop();
				outdeg[top] = -1;
				for(int i=0 ; i < G[top].size() ; ++i){
					outdeg[G[top][i]]--;
					if(outdeg[G[top][i]]==0) next.push(G[top][i]);
				}
			}
			curr = next;
		} 
		printf("%d\n",res);
	}
}