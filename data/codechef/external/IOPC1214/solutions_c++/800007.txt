#include<cstdio>
#include<map>
#include<vector>
#include<queue>
#include<algorithm>

using namespace std;

int main()
{
	int t;
	scanf("%d",&t);
	vector<int> v;
	queue<int> zero;
	int arr[1100][1100];
	int indegree1[1100];
	int indegree2[1100];
	while(t--)
	{
		int n,m;
		scanf("%d %d",&n,&m);
		int i,j;
		for(i=0;i<n;i++)
		{
			for(j=0;j<n;j++)
				arr[i][j] = 0;
			indegree1[i] = 0;
			indegree2[i] = -1;
		}
		while(m--)
		{
			int a,b;
			scanf("%d %d",&a,&b);
			arr[a][b] = 1;
			indegree1[b]++;
		}
		for(i=0;i<n;i++)
		{
			if(indegree1[i] == 0)
			{
				zero.push(i);
				indegree1[i] = -1;
				indegree2[i] = 1;
			}
		}
		while(!zero.empty())
		{
			int val = zero.front();
			zero.pop();
			v.push_back(val);
			for(i=0;i<n;i++)
			{
				if(arr[val][i] == 1)
				{
					indegree1[i]--;
					indegree2[i] = max(indegree2[i],indegree2[val]+1);
				}
				if(indegree1[i] == 0)
				{
					zero.push(i);
					indegree1[i] = -1;
				}
			}
			int max = 0;
		}	
		int max = indegree2[0];
		for(i=0;i<n;i++)
		{
			if(max < indegree2[i])
				max = indegree2[i];
		}
//		for(i=0;i<n;i++)
//			printf("%d ",indegree2[i]);
		printf("%d\n",max);
	}
	return 0;
}