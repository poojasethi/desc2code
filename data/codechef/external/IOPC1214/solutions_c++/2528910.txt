#include <stdio.h>
#include <vector>
#include <algorithm>
#define MAX 1001

using namespace std;

inline int readInt(){
	int number = 0;
	char c = getchar_unlocked();
	while(c<'0')
		c = getchar_unlocked();
	while(c>='0' && c<='9'){
		number = (number<<3)+(number<<1)+c-'0';
		c = getchar_unlocked();
	}
	return number;
}

int dp[MAX];
vector<int> s[MAX];

int cal(int i,int n){
	if(dp[i] != -1)
		return dp[i];
	dp[i] = 0;

	int j,temp,max = 0;
	for(j = 0;j<s[i].size();j++){
		temp = cal(s[i][j],n);
		if(max < temp)
			max = temp;
	}

	dp[i] += (max +1);
	return dp[i];
}

int main(){
	int t,n,m,i,j,temp,ans;

	t = readInt();
	while(t--){
		n = readInt(); m = readInt();
		for(i = 0;i<=n;i++){
			dp[i] = -1;
			s[i].clear();
		}

		for(i = 0;i<m;i++){
			temp = readInt();
			s[temp].push_back(readInt());
		}

		ans = 0;
		for(i = 0;i<n;i++){
			temp = cal(i,n);
			if(ans < temp)
				ans = temp;
		}


		printf("%d\n",ans);

	}
	return 0;
}