#include <vector>
#include <queue>
#include <iostream>
#include <cstdio>

using namespace std;
#define mp make_pair
#define pb push_back
typedef pair<int, int> ii;

int main()
{
	int t;
	scanf("%d", &t);
	while(t--)
	{
		int n, m;
		scanf("%d%d", &n, &m);
		vector<int> edges[n];
		int deg[n], ans[n],result=0,siz;
		for(int i=0; i<n; i++)
			deg[i]=0, ans[i]=0;

		for(int i=0; i<m; i++)
		{
			int a, b;
			scanf("%d%d", &a, &b);
			edges[a].pb(b);
			deg[b]++;
		}
		vector<int> v;
		for(int i=0; i<n; i++)
			if(deg[i]==0)
				v.pb(i);
		siz=v.size();
		queue<ii> q;
		for(int j=0; j<siz; j++)
		{
			q.push(mp(v[j], v[j]));
			while(!q.empty())
			{
				ii u=q.front();
				q.pop();
				int siz1=edges[u.first].size();
				for(int i=0; i<siz1; i++)
				{
					int v=edges[u.first][i];
					if(v==u.second)
						continue;
					if(ans[u.first]+1>ans[v]){
						ans[v]=ans[u.first]+1;
						q.push(mp(v,u.first));
					}
					result=max(result,ans[v]);
				}
			}
		}
		printf("%d\n", result+1);
	}
	return 0;
}
