#include <cstdio>
#include <iostream>
#include <cstring>
#include <algorithm>
#include <vector>
using namespace std;
#define MAX(a,b) ((a)>(b)?(a):(b))
#define MIN(a,b) ((a)<(b)?(a):(b))
#define mp make_pair
#define ABS(a) ((a)>=0?(a):(-(a)))
#define s(d) scanf("%d", &(d))
#define sl(d) scanf("%lld", &(d))
#define pb push_back
#define debug(arr) cout<<"arr: ";for(int i=0; i<sizeof(arr)/sizeof(arr[0]); i++) cout<<arr[i]<<" ";cout<<endl;



typedef pair<int,int> pii;
typedef vector<int> vi;
typedef long long int ll;

bool vis[1001];
int ret[1001];
vi al[1001];

int dfsv(int e){
	vis[e]=true;

	int rv=0;
	int tt;
	for (vi::iterator i = al[e].begin(); i!=al[e].end(); ++i){
		if (!vis[*i]){
			tt = dfsv(*i);
		} else {
			tt = ret[*i];
		}
		rv = MAX(rv, tt);
	}

	return ret[e]=rv+1;
}

int main(){
	int tc;
	cin>>tc;
	while (tc--){
		fill(vis, vis+1001, false);
		for (int i=0; i<1001; i++) al[i].clear();
		int n,m, x, y;
		cin>>n>>m;
		for (int i=0; i<m; i++){
			cin>>x>>y;
			al[x].push_back(y);
		}
		int ans=-1; int tt;
		for (int i=0; i<n; i++){
			if (!vis[i]){
				tt = dfsv(i);
				ans = MAX(tt, ans);
			}
		}
		cout<<ans<<"\n";
	}
	return 0;
}