#include<stdio.h>
#include<stack>
#include<vector>

using  namespace std ;

int col[1000] ;
vector<int> adj[1000] ;
int dist[1000] ;

void dfs(int src){

	col[src] = 1 ;

	for(int i = 0 ; i<adj[src].size() ; i++)
		if(!col[adj[src][i]])
			dfs(adj[src][i]) ;
		else ;
	
	int max = 0 ;
	for(int i = 0 ; i<adj[src].size() ; i++)
		if(max < dist[adj[src][i]])
			max = dist[adj[src][i]] ;
		else ;
	if(dist[src] < max+1)
		dist[src] = max+1 ;

	col[src] = 2 ;
}

int main(){

	int T , N , M , i ;

	int frm , to ;

	scanf("%d",&T) ;

	while(T--){
	
		scanf("%d %d",&N , &M) ;

		for(int i = 0 ; i<N ; i++){
		
			adj[i].clear() ;
			col[i] = 0 ;
			dist[i] = 0 ;
		}
		for(i=0 ; i<M ; i++){
		
			scanf("%d %d", &frm , &to) ;
			adj[frm].push_back(to) ;
		}

		for(i=0 ; i<N ; i++){
			if(!col[i])
				dfs(i) ;
		}
		int max = 0 ;
		for(i=0 ; i<N ; i++)
			if(max < dist[i]) 
				max = dist[i] ;
			else ;

		printf("%d\n",max) ;

	}
	return 0 ;
}
