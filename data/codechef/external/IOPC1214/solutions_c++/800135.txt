// Program question at: http://www.codechef.com/IOPC2012/problems/IOPC1214
#include <cstdio>
#include <cstdlib>
#include <vector>
using namespace std;

int find(vector<int> *ar, int n);
int cache[1000];

int find(vector<int> *ar, int n)
{
	int *t = &cache[n];
	if(*t) return *t;
	*t = 1;
	for(vector<int>::iterator it = ar[n].begin(); it != ar[n].end(); it++)
	{
		*t = max(*t, find(ar,*it)+1);
	}
	return *t;
}

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		for(int a=0;a<1000;a++) cache[a] = 0;

		int m,n;
		scanf("%d %d",&m,&n);
		vector<int> ar[m];
		for(int a=0;a<n;a++)
		{
			int i,j;
			scanf("%d %d",&i,&j);
			ar[i].push_back(j);
		}
		int mx = 0;
		for(int a=0;a<m;a++)
			mx = max(mx,find(ar,a));
		printf("%d\n",mx);
	}
	return 0;
}
