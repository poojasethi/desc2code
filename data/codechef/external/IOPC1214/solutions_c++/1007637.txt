#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<cctype>

#include<iostream>
#include<algorithm>
#include<vector>
#include<map>

using namespace std;

#define ll long long
#define pb push_back
#define SZ(a) ((int)a.size())
#define Max_N 1100
#define Set(a, b) memset(a, b, sizeof(a))

ll dp[Max_N];
vector<ll>V[Max_N];

ll process(ll cur);

int main()
{
    ll t, i, j, n, m, a, b;
    scanf(" %lld", &t);
        for(j=1;j<=t;j++)
        {
            scanf(" %lld %lld", &n, &m);
            for(i=0;i<m;i++)
            {
                scanf(" %lld %lld", &a, &b);
                V[a].pb(b);
            }
            ll Max=0;
            Set(dp, 0);
            for(i=0;i<n;i++)
            {
                Max=max(Max, process(i));
            }
            for(i=0;i<n;i++) V[i].clear();
            printf("%lld\n", Max);
        }
    return 0;
}

ll process(ll cur)
{
    ll Max=1;
    ll i, j;
    if(dp[cur]!=0) return dp[cur];
    for(i=0;i<SZ(V[cur]);i++)
        Max=max(Max, process(V[cur][i])+1);
    dp[cur]=Max;
    return Max;
}
