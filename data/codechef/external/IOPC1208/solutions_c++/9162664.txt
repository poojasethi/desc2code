#include<cstdio>
 
#define rep(i,n) for(int i=0;i<(n);i++)
 
using namespace std;
 
typedef long long ll;
 
const ll M=100000007;
 
ll gcd(ll a,ll b){ return b?gcd(b,a%b):a; }
 
int main(){
	int T; scanf("%d",&T);
	while(T--){
		ll N,Q; scanf("%lld%lld",&N,&Q);
		printf("%lld\n",Q*(1+((Q-1)/2)/(Q/gcd(N,Q)))%M);
	}
	return 0;
}
 