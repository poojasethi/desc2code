#include <algorithm>
#include <iostream>
#include <sstream>
#include <string>
#include <vector>
#include <queue>
#include <stack>
#include <set>
#include <map>
#include <list>
#include <bitset>
#include <deque>
#include <numeric>
#include <cassert>
#include <iterator>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cctype>
#include <cmath>
#include <climits>
using namespace std;

typedef vector<int> VI;
typedef vector<VI> VVI;
typedef pair<int,int> PII;
string A;
int mem[5010][5010][2][4];
short cat[5010][5010][2][4];
short tc;
int DP(int id,int M,int on,int cnt)
{
	if(id == A.size())return M == 0 && cnt == 0;
	if(cat[id][M][on][cnt] == tc)return mem[id][M][on][cnt];
	int w = 0;
	if(on)
	{
		//turn off
		w += DP(id,M,0,cnt);
		
		//continue
		w += DP(id+1,max(0,M-(A[id]=='a')),1,cnt);
	}
	else
	{
		//turn on
		if(cnt)
		w += DP(id+1,max(0,M-(A[id]=='a')),1,cnt-1);
		
		//continue off
		w += DP(id+1,M,0,cnt);
	}
	cat[id][M][on][cnt] = tc;
	return mem[id][M][on][cnt] = w % 1000000007;
}

int main()
{
	int TC;
	cin >> TC;
	for(tc = 1 ; tc<=TC ; ++tc)
	{
		cin >> A;
		int N = A.size();
		int M; cin >> M;
		cout << DP(0,M,0,3) << endl;
	}
}



/*
 * 


 */

