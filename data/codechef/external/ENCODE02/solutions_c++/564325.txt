#include <iostream>
#include <fstream>
#include <string>
#include <set>
#include <algorithm>
#include <vector>
#include <cstdio>
#include <queue>
 
using namespace std;
int arr[222222];
int s1[222222];
int s2[222222];
int main() {
	/*freopen("t.in", "r", stdin);
	freopen("t.out", "w", stdout);*/

	int t,n,i;

	scanf("%d", &n);

	for(i = 0;  i < n; ++i)
		scanf("%d", &arr[i]);

	s1[0] = arr[0];
	s2[0] = arr[n-1];
	for(int i = 1 ; i <= n; ++i)
	{
		s1[i] = max(s1[i-1], arr[i]);
		s2[i] = max(s2[i-1], arr[n-1-i]);
	}

	
	int k;
	scanf("%d", &k);
	for(i = 0 ; i < k; ++i)
	{
		int a,b;
		scanf("%d %d", &a, &b);
		int res;
		if(a == 1 && b == n)
			res = 0;
		else if(a == 1)
			res = s2[n-1-b];
		else if(b == n)
			res = s1[a-2];
		else
		{
			res = max(s1[a-2], s2[n-1-b]);
		}

		printf("%d\n", res);
	}
    return 0;
}