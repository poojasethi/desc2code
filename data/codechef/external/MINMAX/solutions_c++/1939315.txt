#include <stdio.h>
#include <string.h>
#define LMax 120

int Tes,p,Len;
int L[LMax];
double P[LMax][LMax],Rez;
char s[LMax];

int go(),m(),M(),val();

int go(){
	if (s[p]=='m'){
		++p;
		return m();
	}
	if (s[p]=='M'){
		++p;
		return M();
	}
	if (s[p]=='x'){
		return val();
	}
	return -1;
}

void inm(int x,int y){

	int i,j;
	static double c[LMax],l;
	memset(c,0,sizeof(c));
	l=L[x]+L[y];
	for (i=0;i<=L[x];++i)
		for (j=0;j<=L[y];++j)
			c[i+j]+=P[x][i]*P[y][j];
	memcpy(P[x],c,sizeof(c));
	L[x]=l;
}

int m(){
	int a=go();
	int b=go();
	int i;

	for (i=0;i<=L[a];++i) P[a][i]=-P[a][i];
	++P[a][0];
	for (i=0;i<=L[b];++i) P[b][i]=-P[b][i];
	++P[b][0];
	inm(a,b);

	for (i=0;i<=L[a];++i) P[a][i]=-P[a][i];
	++P[a][0];
	return a;
}

int M(){
	int a=go();
	int b=go();
	inm(a,b);
	return a;
}

int val(){
	++p;++Len;
	memset(P[Len],0,sizeof(P[Len]));
	P[Len][1]=1;
	L[Len]=1;
	return Len;
}

int main()
{
	int v,i;
	//freopen("in","r",stdin);freopen("out","w",stdout);
	scanf("%d",&Tes);
	while (Tes--)
	{
		scanf("%s",s);p=0;Len=0;
		v=go();

		Rez=1;
		for (i=0;i<=L[v];++i) Rez-=P[v][i]/(double)(i+1);
		printf("%.9lf\n",Rez);
	}
	return 0;
}
