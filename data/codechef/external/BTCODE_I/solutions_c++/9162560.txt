#include<cstdio>
 
const int maxn=500+10;
const int mod=1000000007;
 
int inv[maxn];
int C1[maxn][maxn];
int C2[maxn][maxn];
int pow10[maxn];
int ONE[maxn];
int a[10],Q;
char s1[maxn],s2[maxn];
int n;
 
int dalc(int &r1,int &r2,int &ss)
{
	r1=r2=1;ss=0;
	int s=0,sum=0;
	for (int i=1;i<10;i++)
	{
		r1=(long long)r1*C1[s+a[i]][a[i]]%mod;
		r2=(long long)r2*C2[s+a[i]][a[i]]%(mod-1);
		s+=a[i];sum+=i*a[i];
	}
	ss=(long long)sum*r1%mod*inv[s]%mod*ONE[s]%mod;
}
 
void calc(char s[],int &A,int &B)
{
	A=0,B=0;
	for (int i=1,sum=0;i<=n;i++)
	{
		for (int j=1;j<s[i]-'0';j++)
		{
			a[j]--;
			int o,oo,ss;
			dalc(o,oo,ss);
			a[j]++;
			int svm=((long long)sum*10+j)%mod;
			B+=((long long)svm*pow10[n-i]%mod*o%mod+ss)%mod;
			if (B>=mod) B-=mod;
			A=(A+oo)%(mod-1);
		}
		a[s[i]-'0']--;sum=((long long)sum*10+s[i]-'0')%mod;
	}
	for (int i=1;i<=n;i++) a[s[i]-'0']++;
}
 
int main()
{
	//freopen("input.txt","r",stdin);
 
	for (int i=1;i<10;i++) {scanf("%d",&a[i]);n+=a[i];}
	for (int i=0;i<=n;i++)
	{
		C1[i][0]=C2[i][0]=1;
		for (int j=1;j<=i;j++)
		{
			C1[i][j]=C1[i-1][j]+C1[i-1][j-1];
			C2[i][j]=C2[i-1][j]+C2[i-1][j-1];
			if (C1[i][j]>=mod) C1[i][j]-=mod;
			if (C2[i][j]>=mod-1) C2[i][j]-=mod-1;
		}
	}
	inv[1]=1;
	for (int i=2;i<=n;i++) inv[i]=(-(long long)mod/i*inv[mod%i]%mod+mod)%mod;
	pow10[0]=1;
	for (int i=1;i<=n;i++) 
		pow10[i]=(long long)pow10[i-1]*10%mod,
		ONE[i]=((long long)ONE[i-1]*10+1)%mod;
	for (scanf("%d",&Q);Q--;)
	{
		scanf("%s%s",s2+1,s1+1);
		bool ok=0;
		for (int i=1;i<=n;i++)
		if (s1[i]>s2[i]) break;else
		if (s1[i]<s2[i]) {ok=1;break;}
		if (!ok) for(;;);//{printf("0 0\n");continue;for(;;);}
 
		int b[10],r1=0,r2=0,sum1=0,sum2=0;
		int o1=0,o2=0;
		for (int i=1;i<=n;i++) 
			o1=((long long)o1*10+s1[i]-'0')%mod,
			o2=((long long)o2*10+s2[i]-'0')%mod;
 
		calc(s1,r1,sum1);
		calc(s2,r2,sum2);
		sum2=(sum2-sum1+mod)%mod;
		sum2=(sum2+o2)%mod;
		r2=(r2-r1-1+mod-1)%(mod-1);
		if (r2<0) r2+=mod-1;
 
		int TWO=1;
		for (int i=2;r2;r2/=2)
		{
			if (r2&1) TWO=(long long)TWO*i%mod;
			i=(long long)i*i%mod;
		}
		sum2=(long long)sum2*TWO%mod;
		printf("%d %d\n",TWO,sum2);
	}
}
