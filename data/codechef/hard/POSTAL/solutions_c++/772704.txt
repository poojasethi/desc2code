#include <cstdio>
using namespace std;

const long long linf = 20000000000LL;

int T,n,d[505],m,x,z;
long long p[505];

void solve() {
	scanf("%d%d",&x,&z);
	x++;
	long long P=p[x];
	int D=d[x], cnt=0;
	for (int t=0,i=x-1,j=x+1; ; ) {
		if (D==1) {
			while (d[j]==1) j++;
			long long temp = (p[j]-t) - P;
			if (t+((temp+1)>>1)>z) {
				printf("%lld %d\n",P+(z-t),cnt);
				return ;
			}
			t+=(temp+1)>>1;
			P+=temp>>1;
			j++;
		}
		else {
			while (d[i]==0) i--;
			long long temp = P - (p[i]+t);
			if (t+((temp+1)>>1)>z) {
				printf("%lld %d\n",P-(z-t),cnt);
				return ;
			}
			t+=(temp+1)>>1;
			P-=temp>>1;
			i--;
		}
		D^=1;
		cnt++;
	}
}

int main() {
	scanf("%d",&T);
	while (T--) {
		scanf("%d",&n);
		p[0]=-linf;
		d[0]=1;
		for (int i=1; i<=n; i++)
			scanf("%lld",&p[i]);
		for (int i=1; i<=n; i++) 	
			scanf("%d",&d[i]);
		p[n+1]=linf;
		d[n+1]=0;
		scanf("%d",&m);
		while (m--)
			solve();
	}
	return 0;
}