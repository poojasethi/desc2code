#include <iostream>
#include <cstdlib>
#include <algorithm>

using namespace std;

int m, n, k;
int *P, *T;
inline int compare (int num)
{
	int a[m], i;
	long long sum = 0;
	for(i =0; i<m; i++)
	{
		a[i] = 0;
		if(num >= T[i])
			a[i] = 1 + (num - T[i])/P[i];
	}
	sort(a, a+m);
	reverse(a, a+m);
	for(i=0; i<n; i++)
		sum += a[i];
	if(sum >= k)
		return 1;
	else
		return 0;	
}

int main()
{
	int i, j, l;
	int t;
	cin>>t;
	
	while(t--)
	{
		cin>>m;
		cin>>n;
		cin>>k;
		
		T = (int*)malloc(m*sizeof(int));
		P = (int*)malloc(m*sizeof(int));
		for(i=0; i<m; i++)
			cin>>*(T + i);
		for(i=0; i<m; i++)
			cin>>*(P + i);
		
		n = min(n, m);
		int low = 0;
		int mid = 0;
		int high = 1000000000;
		while(high>low)
		{
			mid = (high + low)/2;
			if(compare(mid) == 1)
				high = mid;
			else
				low = mid + 1;
		}
		
		cout<<high<<endl;
	}
	return 0;
}