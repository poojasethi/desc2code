#include<iostream>
#include<algorithm>
using namespace std;

long comp(long m,long n,long k,long *T,long *P)
{
     long  low=0,high=1000000005,mid;
     long long res;
     long  time=1000000005;
     long *cnt=new long [m];
     while(low<high)
     {
                    res=0;
                    mid=(low+high)/2;
                    
                    for(long i=0;i<m;i++)
                    if(T[i]<=mid)
                    cnt[i]=(mid-T[i])/P[i]+1;
                    else
                    cnt[i]=0;
                    /*printf("%d %d:\n",low,high);
                    printf("%d: ",mid);
                    for(int i=0;i<m;i++)
                    printf("%d ",cnt[i]);
                    printf("\n");*/
                    sort(cnt,cnt+m);
                    
                    for(long j=0;j<m && j<n;j++)
                    res+=cnt[m-1-j];
                    
      //              printf("%d %d %d %d %d %d\n",time,res,k,mid,low,high);
                    
                    if(res>=k && time>=mid)
                    time=mid;
                    
                    if(res<k)
                    low=mid+1;
                    else
                    high=mid;
                    
     }
     return time;
     
}
                    
                    

int main()
{
//    freopen("in.txt","r",stdin);
//    freopen("out.txt","w",stdout);
    long t,m,n;
    long k;
    long T[10005],P[10005];
    scanf("%ld",&t);
    while(t--)
    {
              scanf("%ld%ld%ld",&m,&n,&k);
              for(long i=0;i<m;i++)
              scanf("%ld",&T[i]);
              for(long i=0;i<m;i++)
              scanf("%ld",&P[i]);
              long res=comp(m,n,k,T,P);
              printf("%ld\n",res);
    }
    return 0;
}
