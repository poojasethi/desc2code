//Data Structure includes
#include<vector>
#include<stack>
#include<set>
#include<map>
#include<queue>
#include<deque>
 
 
//Other Includes
#include<iostream>
#include<algorithm>
#include<cstring>
#include<cassert>
#include<cstdlib>
#include<cstdio>
#include<cmath>
 
using namespace std;
/**************************fast input***************************/
inline int inp()
    {
    int noRead=0;
    char p=getchar_unlocked();
    for(;p<33;){p=getchar_unlocked();};
    while(p>32)
    {
    noRead = (noRead << 3) + (noRead << 1) + (p - '0');
    p=getchar_unlocked();
    }
    return noRead;
    };
/************************fast input end***************************/
/**
BEGIN
FAST I/O
**/
#define BUFSIZE 6000000
char inbuf[BUFSIZE],outbuf[BUFSIZE],c,*in,*out;
int nbuf[10],nbs,bi;
int neg,num;
 
void io_init(){
    fread_unlocked(inbuf,1,BUFSIZE,stdin);
    in = inbuf;
    out = outbuf;
}
 
int ni(){
    c = *in++;neg = num = 0;
    while(!(c >= '0' && c <= '9' || c == '-') ) c = *in++;
    if(c == '-') neg = 1, c = *in++;
    while(c >= '0' && c <= '9'){
        num = (num << 3) + (num << 1) + c - '0';
        c = *in++;
    }
    return neg ? -num : num;
}
 
void oi(int num){
    if(num < 0) *out++ = '-' , num = -num;
    nbs = bi = 0;
    if(num == 0) nbuf[nbs++] = 0;
    while(num) nbuf[nbs++] = num%10 , num /= 10;
    bi = nbs - 1;
    while(bi >= 0) *out++ = nbuf[bi--] + '0';
    *out++ = '\n';
}
 
void io_end(){
    *out = '\0';
    assert(out  - outbuf <= BUFSIZE && out - outbuf >= 0);
    fwrite_unlocked(outbuf,1,out - outbuf,stdout);
}
/**
END
FAST I/O
**/
 
#define FOR(i,a,b)                              for(int i=a;i<b;i++)
#define REP(i,n)                                        FOR(i,0,n)
#define pb                                                      push_back
#define s(n)                                            scanf("%d",&n)
#define sl(n)                                           scanf("%lld",&n)
#define sf(n)                                           scanf("%lf",&n)
#define fill(a,v)                                       memset(a, v, sizeof a)
#define sz                                                      size()
#define INF                                                     (int)1e9
#define EPS                                                     1e-9
#define bitcount                                        __builtin_popcount
#define all(x)                                          x.begin(), x.end()
#define gcd                                                     __gcd
#define maX(a,b)                                        (a>b?a:b)
#define miN(a,b)                                        (a<b?a:b)
 
typedef vector<int> VI;
typedef vector<vector<int> > VVI;
typedef long long ll;
typedef pair<int, int > PII;
 
/*....main code begins now....*/
//#define INF 999999
int st[10005];
int p[10005];

ll f(int t,int m,int n){
    ll sums[m];
    fill(sums,0);
    int T=t;
    ll ret=0;
    REP(i,m){
        t=T;
        t-=st[i];
        if(t<0) sums[i]=0;
        else sums[i]=(1+t/p[i]);
    }
    sort(sums,sums+m);
    int i=m-1;
    while(n--){
        if(i<0) break;
        ret+=sums[i];
        --i;
    }

    return ret;
}       

int main(){
    io_init();
    int t,m,n,k;
    //scanf("%d",&t);
    t=ni();
    while(t--){
        //scanf("%d%d%d",&m,&n,&k);
        m=ni();
        n=ni();
        k=ni();
        fill(st,0);
        fill(p,0);
        REP(i,m) //scanf("%d",&st[i]);
            st[i]=ni();
        REP(i,m) //scanf("%d",&p[i]);
            p[i]=ni();
        ll lo=1,hi=INF;
        int ans;
        while(lo<=hi){
            //cout<<lo<<"  "<<hi<<'\n';
            int mid=(lo+hi)/2;
            if(f(mid,m,n)<k) lo=mid+1;
            else {hi=mid-1;ans=mid;}
        }
        //printf("%d\n",lo);
        oi(ans);
    
    }
    io_end();
    return 0;
} 