#include <iostream>
#include <vector>
#include <algorithm>

int bus[100005][4];
std::vector<int> busp;
std::vector<int> stations[50005];
std::vector<int>::iterator it;

int N, T, B;

bool comp(int l, int r)
{
  if (bus[l][3] != bus[r][3])
    return bus[l][3] < bus[r][3];
  return bus[l][2] < bus[r][2];
}

bool pos(int w)
{
  for(int i = 0; i<=N; i++) stations[i].clear();

  stations[1].push_back(0);

  for (int i =0; i < B; ++i)
    {
      int b = busp[i];

      it = std::lower_bound(stations[bus[b][0]].begin(), 
			    stations[bus[b][0]].end(),
			    bus[b][2] - w);
      if (it != stations[bus[b][0]].end() && *it<= bus[b][2])
	{
	  stations[bus[b][1]].push_back(bus[b][3]);
	  if( bus[b][1] == N) return true;
	}
    }

  return false;
}

int main()
{

  std::cin >> N >> T >> B;

  while(B--)
    {
      std::cin >> bus[B][0] >> bus[B][1] >> bus[B][2] >> bus[B][3];
      if(bus[B][3] > T || bus[B][2] > T) continue;
      busp.push_back(B);

    }
  B = busp.size();
  std::sort(busp.begin(), busp.end(), comp);
  int l = 0; int r = T;
  int m,ans=-1;
  while(l<=r)
    {
      m = (l+r)/2;
      if(pos(m))
	{
	  ans = m ;
	  r = m - 1;
	}
      else
	l = m + 1;

    }
  std::cout << ans;
  return 0;
}
