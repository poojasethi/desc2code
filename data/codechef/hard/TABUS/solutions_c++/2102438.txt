#include <cstdio>
#include <algorithm>
#include <vector>
using namespace std;

/*
*	DISCLAIMER : SHAHIN RAM KRISHNA (Casper666)
*	This program is not written by me. 
*	I am executing this to understand the functionality
*/
const int maxM = 300000;

struct bus
{
	int u,v;
	int s,e;
	void read() {
		scanf("%d%d%d%d",&u,&v,&s,&e);
	}
	bool operator<(const bus &b) const {
		return e < b.e;
	}
} b[maxM];

int main()
{
	int N, T, M;
	scanf("%d%d%d",&N,&T,&M);

	for(int i=0;i<M;i++)
		b[i].read();
	sort(b,b+M);
	int L = -1;
	int R = T + 1;
	while(L+1<R)
	{
		int mid = (L+R)/2;
		vector<vector<int> > d(N+1);
		d[1].push_back(0); 
		for(int i=0;i<M;i++)
		{
			int u = b[i].u;
			int v = b[i].v;
			int s = b[i].s;
			int e = b[i].e;
			int j = upper_bound(d[u].begin(), d[u].end(), s) - d[u].begin() - 1;
			if (j<0 || d[u][j]+mid<s) continue;
			d[v].push_back(e);
			
		}
		if(d[N].size() && d[N][0]<=T)
			R = mid;
		else
			L = mid;
	}
	if(R > T) R = -1;
	printf("%d\n",R);
	return 0;
}
