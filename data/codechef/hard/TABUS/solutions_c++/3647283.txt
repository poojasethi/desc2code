#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<sstream>
#include<cmath>
#include<assert.h>
using namespace std;
#define ll long long
#define ull unsigned long long
#define pi acos(-1)
#define inf 1000000007
#define mod 1000000007
//const ll inf = 1000000000005LL;
#define pii pair<int,int>
#define vi vector<int>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 50010

#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(typeof(t.begin()) i=t.begin();i!=t.end();i++)

struct bus
{
	int u,v,s,e;
}b[N<<1];
bool cmp(bus a,bus b)
{
	return a.e<b.e;
}
vector<int>g[N];
int n,m,T;
bool check(int t)
{
	for(int i=0;i<n;i++)g[i].clear();
	g[0].pb(0);
	for(int i=0;i<m;i++)
	{
		int u=b[i].u,v=b[i].v,s=b[i].s,e=b[i].e;
		if(g[u].empty())continue;
		if(g[u][0]>s)continue;
		int z=g[u].size()-1;
		if(g[u][z]>s)
		{
			z=lower_bound(all(g[u]),s)-g[u].begin();
			if(g[u][z]>=s)z--;
		}
		if(s-g[u][z]<=t)g[v].pb(e);
	}
	return (!g[n-1].empty())&&(g[n-1][0]<=T);
}
int main()
{
	int i,j,k;
	while(~scanf("%d%d%d",&n,&T,&m))
	{
		for(i=0;i<m;i++)
		{
			scanf("%d%d%d%d",&b[i].u,&b[i].v,&b[i].s,&b[i].e);
			b[i].u--,b[i].v--;
		}
		sort(b,b+m,cmp);
		int l=0,r=T+1,res=-1;
		while(l<=r)
		{
			int x=(l+r)>>1;
			if(check(x))r=x-1,res=x;
			else l=x+1;
		}
		printf("%d\n",res);
	}
	return 0;
}