#include<cstdio>
#include<iostream>
#include<cstring>
#include<vector>
#include<memory.h>
#include<cstdlib>
#include<cmath>
#include<cassert>
#include<memory.h>
#include<algorithm>
#include<queue>
#include<map>
using namespace std;


#define NN 51
#define KK 51
#define pb push_back
#define fi first
#define se second


typedef long long LL;


vector<LL>f47[NN][KK];
map<LL, int>::iterator it;


int N, K;
char word47[NN];


void print47(LL a, int s)
{
    LL c;
    for(int i=s-1; i>-1; i--)
    {
      c = ((a&(1LL<<i))>>i);
      if(c)cout<<"7";
      else cout<<"4";
    }
    cout<<endl;
}

void gen47(LL a, int s, int c, map<LL, int>sub[NN])
{
    map<LL, int>sub4[NN];
    map<LL, int>sub7[NN];
    for(int i=0; i<NN; i++)
    {
       it = sub[i].begin();
       while(it!= sub[i].end())
       {
           sub4[i][it->fi] = 1;
           sub7[i][it->fi] = 1;
           it++;
       }

    }

    int cnt4 = c+1+s, cnt7 = c+1+s;
    LL t4, t7, t;

    for(int i=0; i<s+1; i++)
    {
        t=0;
        for(int j=i; j<s; j++)
        {
            t+= ((((1LL<<j)&a)>>j)<<(j-i));
        }
        t7 = t +(1LL<<(s-i));

        if(sub7[s-i+1].find(t7) != sub7[s-i+1].end())
        {
            cnt7--;
        }
        else
        {
            sub7[s-i+1][t7] = 1;
        }

        t4 = t;

        if(sub4[s-i+1].find(t4) != sub4[s-i+1].end())
        {
            cnt4--;
        }
        else
        {
            sub4[s-i+1][t4] = 1;
        }
       // cout<<"q7 "<<i<<" "<<q7.size()<<" ";print47(a, s);
       // cout<<"q4 "<<i<<" "<<q4.size()<<" ";print47(a, s);
    }
       if(cnt7 <KK)
        {

            LL f = a + (1LL<<s);
            //cout<<s+1<<" "<<cnt7<<" ";
            // print47(f, s+1);
            f47[s+1][cnt7].pb(f );

           if(s+2<NN) gen47(f, s+1, cnt7, sub7);
        }



        if(cnt4 <KK)
        {
            LL f = a;
          //  cout<<s+1<<" "<<cnt4<<" ";
          //   print47(f, s+1);
            f47[s+1][cnt4].pb(f);
            if(s+2 <NN)gen47(f, s+1, cnt4, sub4);
        }

       // cout<<"q7 "<<q7.size()<<" ";print47(a, s);
       // cout<<"q4 "<<q4.size()<<" ";print47(a, s);
}

void precompute()
{
    map<LL, int>m[NN];
    gen47(0,0,0,m);
    /*for(int i=1; i<NN; i++)
    {
        int cnt = 0;
        for(int k=0; k<KK; k++)
        {
              for(int j=0; j<f47[i][k].size(); j++)cnt++;
        }
        cout<<cnt<<" "<<i<<endl;

    }*/

}

void solve()
{
   LL a = 0, q=0;
   int ans = 0;
   scanf("%d%d", &N, &K);
   scanf("%s", word47);
   for(int i=0; i<N; i++)
   {
       if(word47[N-1-i]== '?')
       {
          q+= (1LL<<i);
       }
       if(word47[N-1-i] == '7')
       {
           a+= (1LL<<i);
       }
   }
   for(int j=1; j<=K; j++)
   {
       for(int k=0; k<f47[N][j].size(); k++)
       {
           if(f47[N][j][k] ==(a + (q&f47[N][j][k])))ans++;
       }
   }
   printf("%d\n", ans);

}




int main()
{
   #ifndef ONLINE_JUDGE
   freopen("input.txt","r",stdin);
  freopen("output.txt","w",stdout);
   #endif
   precompute();

   int t;
   scanf("%d", &t);

   while(t--)
   {
       solve();
   }


}

