#include <vector>
#include <list>
#include <map>
#include <set>
#include <deque>
#include <stack>
#include <queue>
#include <algorithm>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <memory.h>

#define ABS(a) ((a>0)?a:-(a))
#define MIN(a,b) ((a<b)?(a):(b))
#define MAX(a,b) ((a<b)?(b):(a))
#define FOR(i,a,n) for (int i=(a);i<(n);++i)
#define FI(i,n) for (int i=0; i<(n); ++i)
#define pnt pair <int, int>
#define mp make_pair
#define PI 3.14159265358979
#define MEMS(a,b) memset(a,b,sizeof(a))
#define LL long long
#define U unsigned

using namespace std;
vector<vector<pair<LL,int> > > g;
set<LL> cur;
char s1[53];
void gen(string s)
{
	if (s.size()>50)
		return;
	cur.clear();
	FOR(i,0,s.size())
	{
		LL h=0,p=1;
		FOR(j,i,s.size())
		{
			int v=1;
			if (s[j]=='7')
				v=2;
			h+=v*p;
			p*=3;
			cur.insert(h);
			if (cur.size()>50)
				return;
		}
	}
	//cout<<s<<endl;
	LL mask=0;
	FOR(i,0,s.size())
		if (s[i]=='7')
			mask|=(1ll<<i);
	g[s.size()].push_back(mp(mask,cur.size()));
	gen(s+'4');
	gen(s+'7');
}
int main()
{
#ifdef Fcdkbear
	freopen("in.txt","r",stdin);
	//freopen("out.txt","w",stdout);
#endif
	double beg=clock();
	g.resize(51);
	gen("");
	int t;
	scanf("%d",&t);
	while (t--)
	{
		int n,k;
		int res=0;
		scanf("%d%d",&n,&k);
		scanf("%s",&s1);
		LL mask1=0,mask2=((1ll<<62)-1);
		FOR(i,0,n)
			if (s1[i]=='7')
				mask1|=(1ll<<i);
			else
				if (s1[i]=='?')
					mask2^=(1ll<<i);
		FOR(i,0,g[n].size())
		{
			LL mask3=g[n][i].first;
			LL mask4=(mask2&mask3);
			if ((mask4==mask1) && (g[n][i].second<=k))
				res++;
		}
		printf("%d\n",res);
	}
	double end=clock();
	fprintf(stderr,"%.3lf\n",(end-beg)/CLOCKS_PER_SEC);
	return 0;
}