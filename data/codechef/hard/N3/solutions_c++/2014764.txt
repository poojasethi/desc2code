#include <iostream>
#include <stdio.h>
#include <string.h>
#include <algorithm>
#include<sstream>
#include <vector>
#include <cmath>
#include <set>
#include <map>
using namespace std;
#define ll long long
#define mp make_pair
#define pb push_back
#define fi first
#define se second
#define rep(i,n) for(int i=0;i<n;i++)
#define all(a)  a.begin(),a.end()
#define ESP (1e-9)
#define N 5005
#define M 1000000007
#define sz(a) int(a.size())
#define pii pair<int,int>
#define vi vector<int>
#define pi acos(-1)
char s[155][305];
int l,n,next[305],g[155][155],dp[505][155];
void build(char *s)
{
 int i,j;
 next[0]=-1;j=-1;
 for(i=1;i<l;i++)
 {
  while(j>-1&&s[i]!=s[j])j=next[j];
  j++;
  next[i]=j;
 }
}
void find(char *ss,int k)
{
 int i,j,r;
 for(i=0;i<n;i++)
 if(i!=k)
 {
  r=-1;
  for(j=0;j<l;j++)
  {
  	while(r>=0&&s[i][j]!=ss[r])r=next[r];
  	r++;
  }
  g[i][k]=r;
 }
 g[k][k]=next[l-1];
}
pii a[505];int f[505][155];
void print(int len,int i,int k)
{
 a[k].fi=i,a[k].se=len-l;
 if(len==l)
 {
 	printf("%s",s[i]);
 	return;
 }
 int j=f[k][i];
 print(len-(l-g[j][i]),j,k-1);
 for(int r=g[j][i];r<l;r++)
 printf("%c",s[i][r]);
}
int main()
{
   // freopen("in.txt","r",stdin);
    int T,i,j,k;
    scanf("%d",&T);
    while(T--)
    {
     scanf("%d%d%d",&n,&l,&k);
     for(i=0;i<n;i++)
     {
      scanf("%s",s[i]);
	 }
	 //memset(g,0,sizeof(g));
	 for(i=0;i<n;i++)
	 {
	  build(s[i]);
	  find(s[i],i);dp[0][i]=l;
	 }
	 for(i=1;i<k;i++)
	 for(j=0;j<n;j++)
	 dp[i][j]=k*l,f[i][j]=j;
	 for(i=0;i<k-1;i++)
	 for(j=0;j<n;j++)
	 {
	  for(int r=0;r<n;r++)
	  if(dp[i+1][r]>dp[i][j]+l-g[j][r])
	  {
	   dp[i+1][r]=dp[i][j]+l-g[j][r];
	   f[i+1][r]=j;
	  }
	 }
	 int ans=l*k,cur=-1;
	 for(i=0;i<n;i++)
	 if(ans>=dp[k-1][i])
	 {ans=dp[k-1][i];cur=i;}
	 printf("%d\n",ans);
	 print(ans,cur,k-1);
	 puts("");
	 for(i=0;i<k;i++)
	 printf("%d %d\n",a[i].fi,a[i].se);
	}
    return 0;
}
