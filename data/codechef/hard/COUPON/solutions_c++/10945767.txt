#include <bits/stdc++.h>
#define maxn 1111111
#define oo ll(1.0e18)

using namespace std;
typedef long long ll;

int n, m;
int a[maxn], b[maxn];
ll f[maxn];

inline int idx(int i,int j) {return (i-1)*m+j;}

void read_in() {
    cin >> n >> m;
    for(int i=1;i<=n*m;i++) cin >> a[i];
    for(int i=1;i<=n*m;i++) cin >> b[i];
}

void solve() {
    ll min1=oo, min2=oo;
    for(int j=1;j<=m;j++) {
        f[idx(1,j)]=a[idx(1,j)];
        if (a[idx(1,j)]<min1) min2=min1, min1=a[idx(1,j)]; else
            if (a[idx(1,j)]<min2) min2=a[idx(1,j)];
    }
    for(int i=2;i<=n;i++) {
        ll mina1=oo,mina2=oo;
        for(int j=1;j<=m;j++) {
            f[idx(i,j)]=f[idx(i-1,j)]+((a[idx(i,j)]>b[idx(i-1,j)]) ? a[idx(i,j)]-b[idx(i-1,j)] : 0);
            if (f[idx(i-1,j)]==min1) f[idx(i,j)]=min(f[idx(i,j)],min2+a[idx(i,j)]);
            else f[idx(i,j)]=min(f[idx(i,j)],min1+a[idx(i,j)]);
            if (f[idx(i,j)]<mina1) mina2=mina1, mina1=f[idx(i,j)];
            else if (f[idx(i,j)]<mina2) mina2=f[idx(i,j)];
        }
        min1=mina1, min2=mina2;
    }
    ll ans=oo;
    for(int j=1;j<=m;j++) ans=min(ans,f[idx(n,j)]);
    cout << ans << endl;
}

int main() {
    #ifndef ONLINE_JUDGE
    freopen("inp.txt","r",stdin);
    freopen("out.txt","w",stdout);
    #endif // ONLINE_JUDGE
    ios::sync_with_stdio(false);
    int T; cin >> T;
    while (T--) {
        read_in();
        solve();
    }
}
