#include<bits/stdc++.h>
 
using namespace std;
long long mod=1000000007;
long long arr[1000000],sum[1000000];
 
long long a(long long i,long long m)
{
    if(m==0)
        return arr[i];
        if(i==0)
            return arr[0];
    if(i&1)
    {
        long long temp=(i+1)/2;
        return((a(temp,m-1)+a(temp-1,m-1))%mod);
    }
    else
         return(a(i/2,m-1)%mod);
}
 
 
long long s(long long i,long long m)
{
 
if(m==0)
    return sum[i];
    if(i==0) return sum[0];
    if(i%2==1)
    {
        long long temp=(i+1)/2;
        return((3*s(temp,m-1)-arr[0]-2*a(temp,m-1))%mod);
    }
    else
    {
        return((3*s(i/2,m-1)-arr[0]-a(i/2,m-1))%mod);
    }
}
 
 
 
 
 
int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        long long n,m,x,y,answer;
        cin>>n>>m>>x>>y;
        cin>>arr[0];
        sum[0]=arr[0];
        for(int i=1;i<n;i++)
        {
            cin>>arr[i];
            sum[i]=sum[i-1]+arr[i];
        }
        
   x=x-1;
   y=y-1;
   x=x-1;
   
   if(x<0)
     answer=s(y,m);
   else answer=s(y,m)-s(x,m);
   if(answer<0)
    answer+=mod;
   cout<<answer<<"\n";
    }
} 