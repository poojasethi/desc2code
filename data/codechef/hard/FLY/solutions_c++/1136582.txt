#include <stdio.h>
#include <string.h>

#define BASE 1000000000

int main()
{
	int T, M, i, j, len, a[2], b[2];
	long long N, A, C1, C2, B1, B2, D1, D2, X, temp;
	char C[25];
	bool flag;

	scanf("%d", &T);
	while (T--)
	{
		scanf("%lld %s %d", &N, C, &M);

		C1 = C2 = 0;
		len = strlen(C);
		for (i=0; i<strlen(C); i++)
		{
			if (C[i] == '.')
				break;
			C1 *= 10;
			C1 += C[i] - '0';
		}
		i++;

		for (j=0; i<len; i++, j++)
		{
			C2 *= 10;
			C2 += C[i] - '0';
		}
		for (; j<9; j++)
			C2 *= 10;
		

		for (i=0; i<M; i++)
			scanf("%d %d", &a[i], &b[i]);

		if (M == 2 and (a[0] == a[1] or a[0] == b[1] or b[0] == a[1] or b[0] == b[1]))
			flag = true;
		else
			flag = false;
		
		if (N == 1)
		{
			A = temp = 0;
		}

		else if (N == 2)
		{
			A = 2;
			if (M == 1)
				temp = 0;
			else		// M = 0
				temp = 1;
		}

		else if (C1 <= 1)
		{
			A = N*(N-1);
			temp = A/2 - M;
		}

		else if (M < 2 or flag)
		{
			A = 2*(N-1)*(N-1);
			temp = N - 1 - M;
		}

		else if (C1 <= 2*(N-2)-1)
		{
			A = 2*N*(N-2);
			temp = N - M;
		}

		else
		{
			A = 2*(N-2)*(N+1);
			temp = N - 1 - M;
		}

		B1 = temp/BASE, B2 = temp - B1*BASE;
		temp = B2*C2;
		D1 = temp/BASE, D2 = temp - D1*BASE;
		X = A + B1*C1*BASE + B1*C2 + B2*C1 + D1;

		printf("%lld.%09lld\n", X, D2);
	}

	return 0;
}

