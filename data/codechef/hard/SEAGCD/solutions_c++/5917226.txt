#include<cstdio>
#include<cstring>
#include<algorithm>
#define LL long long 
#define MX 11111111
const int MOD=1e9+7;
using namespace std;
int T,N,M,L,R;
int A[MX],B[MX];
int mypow(int a,int b){
	LL r=1;
	while(b){
		if(b&1)r=(r*(LL)a)%MOD;
		b>>=1;
		a=(LL)a*a%MOD;
	}
	return r%MOD;
}
int main(){
	scanf("%d",&T);
	while(T--){
		scanf("%d%d%d%d",&N,&M,&L,&R);
		int answer = 0,last = -1,power;
		for(int d = M; d >= 1; --d){
			int div = M / d;
			if(div != last){
				power = mypow(div, N);
				last = div;
			}
			A[d] = power;
			int S = 0;
			int k = 2 * d;
			while(k <= M){
				S += B[k];
				if(S >= MOD) S %= MOD;
				k += d;
			}
			B[d] = A[d] - S;
			if(B[d] < 0) B[d] += MOD;
			if(B[d] >= MOD) B[d] %= MOD;
			if(d >= L && d <= R){
				answer += B[d];
				if(answer >= MOD) answer %= MOD;
			}
		}
		printf("%d\n",answer);
	}
}
