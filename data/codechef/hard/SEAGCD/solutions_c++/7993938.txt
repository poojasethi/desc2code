#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
typedef long long ll;
int arr[10000001],brr[10000001],n,m,l,r;
int modular_pow(ll a,int b) 
{
	ll res=1;
	if(a>=mod)
		a%=mod;
	for(;b;b>>=1)
	{
		if(b&1)
			res=res*a;
		if(res>=mod)
			res%=mod;
		a=a*a;
		if(a>=mod)
			a%=mod;
	}
	return res;
}
int main()
{
	//ios_base::sync_with_stdio(false);cin.tie(0);
	int rt,o,t,i,j;
	ll ans,sum,value,temp;
	cin>>t;
	while(t--)
	{
		cin>>n>>m>>l>>r;
		arr[1]=modular_pow(m,n);
		for(i=2;i<=m;i++)
		{
			if(m/i==m/(i-1))
				arr[i]=arr[i-1];
			else
			{
				arr[i]=modular_pow(m/i,n);
			}
		}
		ans=0;
		brr[m]=1;
		if(m<=r && m>=l)	ans=1;
		for(i=m-1;i>=1;i--)
		{
			sum=0;
			for(j=2;j*i<=m;j++)
			{
				sum+=brr[i*j];
			}
			if(sum>=mod)
				sum=sum%mod;
			brr[i]=arr[i]-sum;
			if(brr[i]<0)
				brr[i]+=mod;
			
			if(i>=l && i<=r)
				ans+=brr[i];
		}
		cout<<ans%mod<<endl;
	}
	
}
