#include<bits/stdc++.h>
using namespace std;
#define sd(x) scanf("%d",&x)
#define slld(x) scanf("%lld",&x)
#define ss(x) scanf("%s",x)
#define ll long long
#define mod 1000000007
#define bitcount    __builtin_popcountll
#define pb push_back
int a[10000007];
int p(int x,int y)
{
	if(y==0)
		return 1;
	if(y==1)
		return x;
	int z=p(x,y/2);
	return (1ll*((1ll*z*z)%mod)*p(x,y%2))%mod;
}
int main()
{
    //freopen("in.txt","r",stdin);
    //freopen("out.txt","w",stdout);
    int t,n,m,l,r,i,j,k,x;
    sd(t);
    while(t--)
    {
    	sd(n);
    	sd(m);
    	sd(l);
    	sd(r);
    	for(i=m;i>=l;i--)
    	{
    		k=0;
    		for(j=2*i;j<=m;j+=i)
    		{
    			k+=a[j];
    			if(k>=mod)
    				k-=mod;
    		}
    		if(i!=m&& m/i == m/(i+1))
    			a[i]=x;
    		else
    		{
    			a[i]=p(m/i,n);
    			x=a[i];
    		}
    		a[i]-=k;
    		if(a[i]<0)
    			a[i]+=mod;
    	}
    	k=0;
    	for(i=l;i<=r;i++)
    	{
    		k+=a[i];
    		if(k>=mod)
    			k-=mod;
    	}
    	printf("%d\n",k);
    }
    return 0;
}