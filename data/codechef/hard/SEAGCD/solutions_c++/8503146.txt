#include <bits/stdc++.h>
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define mp make_pair
#define f first
#define s second
#define N 10000005
#define NN 10000000
#define ln 1e10+1
#define BIT(i, j) ((j >> i) & 1)
#define ll long long
#define oo 1000000007
#define ln 1e13

using namespace std;

int A[N], ans, T, n, m, l, r, Tr;

int Pow(int x, int y)
{
    ll r = 1;
    ll q = x;
    while(y)
    {
        if(y % 2 == 1)
            r = r * q % oo;
        q = q * q % oo;
        y /= 2;
    }
    return r;
}

int Plus(int x, int y)
{
    if(x + y <= -oo) return x + y + oo;
    if(x + y >= oo) return x + y - oo;
    return x + y;
}

int main()
{
   // filein("inp.txt");  fileout("out.txt");
    cin >> T;
    //srand(time(0));
    //T = 10;
    while(T--)
    {
        ans = 0;
        cin >> n >> m >> l >> r;
      //  n = rand() * rand() % NN + 1;
       // m = 10000000;
       // l = rand() * rand() % NN + 1;   while(l >= m)   l = m = rand() * rand() % NN + 1;
       // r = rand() * rand() % NN + 1;   while(r >= m)   r = m = rand() * rand() % NN + 1;
        if(l > r) swap(l, r);
        for(int i=m; i>=l; i--)
        {
            if(m/i == m/(i+1))  A[i] = Tr;
            else    Tr = A[i] = Pow(m/i, n);
            for(int j=i+i; j<=m; j+=i)
                A[i] = Plus(A[i], -A[j]);
        }
        for(int i=l; i<=r; i++)
            ans = Plus(ans, A[i]);
        ans = Plus(ans, oo);
        cout << ans << endl;
    }
}
