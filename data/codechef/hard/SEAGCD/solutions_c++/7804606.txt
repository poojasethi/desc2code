#include <bits/stdc++.h>
 
using namespace std;
 
#define pb push_back
#define ull unsigned long long
#define ll long long
#define VI vector <int>
#define VVI vector < 	vi >
#define PII pair <int,int>
#define VPII vector < pii >
#define mp make_pair
#define MI map < int, int >
#define SI set< int >
#define clr(x) x.clear()
#define sz(x) ((int) x.size())
#define F first
#define S second
#define abs(a) ((a<0)?(-1*a):a)
#define max(a,b) ((a>b)?a:b)
#define min(a,b) ((a<b)?a:b)
#define mem1(a,c,b) (memset(a, c, sizeof(a[0]) * b))
#define mem2(a,d,b,c) (memset(a, d, sizeof(a[0][0])*b*c))
#define MOD 1000000007
#define iofast (ios_base::sync_with_stdio(0))
 
ll powm(ll a, ll b, ll m)
{
	ll i = a, k=1ll;
	while(b)
	{
		if(b&1) k = (k*i) % m;
		i = (i*i) % m;
		b >>= 1;
	}
	return k;
}
 
int A[10000010];
 
void init(ll i, ll n)
{
	ll present = 0;
	for(ll j=i, k=0, l=0; j>1; j=l)
	{
		k = i/j; 
		l = i/(k+1);
		present = (present +  (((j-l) * A[k]) % MOD)) % MOD;
	}
	A[i] = (powm(i, n, MOD) - present + MOD) % MOD;
}
 
void precompute(ll m, ll n)
{
	ll target, i;
	for(i=2; i*i<=m; i++)
		init(i, n);
 
	for(; i>0; i--)
	{
		target = m/i;
		init(target, n);
	}
}
 
int main()
{
	iofast;
	ll n, m, l, r, i, j, k, ans;
	stringstream ss;
	int t;
	A[1] = 1;
	cin>>t;
	while(t--)
	{
		cin>>n>>m>>l>>r;
		precompute(m, n);
		for(i=r, ans=0; i>=l; i=k)
		{
			j = m/i;
			k = m/(j+1);
 
			if(k < l-1)
				k=l-1;
			ans = (ans + (((i-k)* A[j]) % MOD) ) % MOD;
		}
		ss<<ans<<"\n";
	}
	cout<<ss.str();
} 