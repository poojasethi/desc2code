#include<bits/stdc++.h>
#define MOD 1000000007
#define MAX 10000009

typedef unsigned long long ull;

using namespace std;

int n,m,l,r,d;
int A[MAX],B[MAX];

ull exp_mod(ull a, ull b) {
	ull res = 1;
	while(b) {
		if(b&1) 
			res = res*a%MOD;
		a = a*a%MOD;
		b >>= 1;
	}
	return res;
}

ull solve() {
	int d,div,j,last = -1;	
	int res=0,temp=0,pw;

	for(d=m; d>=1; d--) {
		div = m/d;	
		if(div != last) {
			pw = exp_mod(div,n);
			last = div;
		}

		A[d] = pw;
		j = d<<1;
		temp = 0;

		while(j <= m) {
			temp += B[j]; 	
			if(temp >= MOD) temp %= MOD;
			j += d;
		}

		B[d] = A[d] - temp;
		
		if(B[d] < 0) B[d] += MOD;
		if(B[d] >= MOD) B[d] %= MOD;

		if(d >= l && d <= r) {
			res += B[d];
			if(res >= MOD)
				res %= MOD;
		}
	}

	return res;
}

int main() {
	int t;	
	scanf("%d",&t);
	while(t--) {
		scanf("%d%d%d%d",&n,&m,&l,&r);	
		memset(A,0,sizeof(int)*MAX);
		memset(B,0,sizeof(int)*MAX);

		printf("%llu\n",solve());
	}
	return 0;
}
