#include <bits/stdc++.h>
#define ll long long int
#define s(a) scanf("%lld",&a)

using namespace std;

ll mod=1000000007;

ll a[10000001]={0};

ll power(ll a,ll b)
{
    if(b==0) return 1;
    if(b==1) return a;
    ll k=power(a,b/2);
    if(b%2==0) return (k*k)%mod;
    return (((k*k)%mod)*a)%mod;
}

int main()
{
    ll t,n,m,l,r,i,j,w,num,ans;
    s(t);
    while(t--) {
        ans=0;
        s(n);s(m);s(l);s(r);
        if(l==1 && r==m) {
            w=power(m,n);
            printf("%lld\n",w);
            continue;
        }
        for(i=m;i>=l;i--) {
            if(m/i==m/(i+1) && i<m) a[i]=a[i+1];
            else {
                w=m/i;
                w=power(w,n);

                num=i*2;
                while(1) {
                    if(num>m) break;
                    w=w-a[num];
                    if(w<0) w+=mod;
                    num=num+i;
                }
                a[i]=w;
            }
            if(i>=l && i<=r) {
                    ans=ans+a[i];
                    if(ans>=mod) ans%=mod;
            }
        }
        printf("%lld\n",ans);
    }
    return 0;
}
