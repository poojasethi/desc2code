#include <bits/stdc++.h>
#define mod 1000000007
using namespace std;
typedef long long int lli;
int a[10000001];

int modpow(int a, int b)
{
	int res=1;
	while(b>0)
	{
		if(b%2==1) res=(lli)res*a%mod;
		//if(res>=mod) res%=mod;
		a=(lli)a*a%mod;
		//if(a>=mod) a%=mod;
		b=b/2;
	}
	return res;
}

int main()
{
	int t,n,m,l,r,i,j;
	scanf("%d",&t);
	int d,k,last=-1;
	while(t--)
	{
		scanf("%d%d%d%d",&n,&m,&l,&r);
		a[m]=1;
		for(d=m-1;d>=l;d--)
		{
			int div1=m/d;
			if(m/d!=m/(d+1)) 
			{
				a[d]=modpow(div1,n);
			}
			else
			{
				a[d]=a[d+1];
				continue;
			}
			k=d+d;
			while(k<=m)
			{
				a[d]=(a[d]-a[k])%mod;
				if(a[d]<0) a[d]+=mod;
				k+=d;
			}
		}
		int ans=0;
		for(i=l;i<=r;i++)
			ans=((lli)ans+a[i])%mod;		
		printf("%d\n",ans);
	}
}
