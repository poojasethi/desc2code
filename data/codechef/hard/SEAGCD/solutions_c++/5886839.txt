#include<iostream>
#include<stdio.h>
#include<vector>
#include<algorithm>
using namespace std;
#define M 1000000007
#define ll long long int 
int  dp[10000010];
int pw(int a,int b)
{
	if(b==0)
	return 1;
	else if(b==1)
	return a;
	else
	{
		ll r=pw(a,b/2);
		if(b%2)
		return ((r*r)%M*a)%M;
		else
		return (r*r)%M;
	}
}
 
int main(){
	int t;
	cin>>t; 
	while(t--){
		int n,m,l,r;
		cin>>n>>m>>l>>r;
		/*if(l==1 && r==m){
			int ans=pw(m,n);
			cout<<ans<<"\n";
			continue;
		}*/
		dp[m]=1;
		for(int i=m-1;i>=l;i--){
			if(m/i==m/(i+1)){
				dp[i]=dp[i+1];
				continue;
			} 
			dp[i]=pw(m/i,n);
			for(int j=i+i;j<=m;j+=i)
				dp[i]=(dp[i]-dp[j])%M;
			if(dp[i]<0) dp[i]+=M;	
		}
		int sum=0;
		for(int i=l;i<=r;i++) sum=(sum+dp[i])%M;
		cout<<sum<<"\n";
	}
	return 0;
}
 