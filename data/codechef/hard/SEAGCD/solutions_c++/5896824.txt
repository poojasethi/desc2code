#include <stdio.h>
#include <vector>

using namespace std;

#define ill long long int
#define LL long long
#define MOD 1000000007

int ipow(int base,int exp){
	int ans=1;
	while(exp){
		if(exp%2) ans=(LL)ans*base%MOD;
		base=(LL)base*base%MOD;
		exp/=2;
	}
	if(ans<0) ans+=MOD;
	return ans;
}

int ipow9(int base, int exp)
{
    int result = 1;
    while (exp)
    {
        if (exp & 1)
            result = ((result%MOD) * (base%MOD)) % MOD;
            
        exp >>= 1;
        base = ((base%MOD) * (base%MOD)) % MOD;
    }

    return result;
}

int main(){
	int n,m,d,l,r,i,t,j,k,c;
	scanf("%d", &t);
    vector< int > arr(10000010);
	while(t--){
		scanf("%d%d%d%d", &n, &m, &l, &r);
		int sum = 0;
		c = 1;
		arr[m] = 1;
		for(d = m-1; d >= 1; d--){
			if(m/d == c){
				arr[d] = arr[d+1];
				continue;
			}
			c = m/d;
			arr[d] = ipow(c, n)%MOD;
			k = 2;
			while(k*d <= m){
				arr[d] = (arr[d] - arr[k*d])%MOD;
				k++;
			}
			if(arr[d] < 0)arr[d]+= MOD;
		}
		for(i = l; i <= r; i++)sum = (sum%MOD + arr[i]%MOD)%MOD;
		printf("%d\n", sum);
	}
	return 0;
}
