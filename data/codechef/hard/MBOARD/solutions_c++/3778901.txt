#include<iostream>
#include<stdio.h>
#include<string.h>
#define MX 500005
using namespace std;

int RS0[MX],RS1[MX],CS0[MX],CS1[MX];
int RTS0[MX], CTS0[MX],RTS1[MX],CTS1[MX],n,q;

void update(int arr[], int ind, int num)
{
    while(ind<MX)
    {
        arr[ind] += num;
        ind += (ind&(-ind));
//        cout << "wkejd " << endl;
    }
}

int sum(int arr[], int ind)
{
    int sum1 = 0;

    while(ind>0)
    {
        sum1 += arr[ind];
        ind -= (ind & (-ind));
//        cout << "sum " << endl;
    }
return sum1;
}

int main()
{
    int i,x;
    scanf("%d %d",&n,&q);
    
    for(i=1;i<=n;i++)
    {
        RTS0[i] = 1;
        RTS1[i] = -1;
        CTS0[i] = 1;
        CTS1[i] = -1;
    }
    
    update(RS0,1,1);
    update(CS0,1,1);
    
    for(int t=2;t<=q+1;t++)
    {
        char str[10];
        scanf("%s",str);

        if(!strcmp(str,"RowSet"))
        {
//            cout << 1 << endl;
            scanf("%d %d",&i,&x);
            if(RTS0[i]>RTS1[i])
                update(RS0,RTS0[i],-1);
            else
                update(RS1,RTS1[i],-1);
            if(x==0)
            {
                update(RS0,t,1);
                RTS0[i] = t;
            }
            else
            {
                update(RS1,t,1);
                RTS1[i] = t;
            }
        
        }
        
        else if(!strcmp(str,"ColSet"))
        {
            scanf("%d %d",&i,&x);
            if(CTS0[i]>CTS1[i])
                update(CS0,CTS0[i],-1);
            else
                update(CS1,CTS1[i],-1);
            if(x==0)
            {
                update(CS0,t,1);
                CTS0[i] = t;
            }
            else
            {
                update(CS1,t,1);
                CTS1[i] = t;
            }
//            for(int i=1;i<=n;i++)
//                cout << RS0[i] << " ";
//            cout << endl;
        }

        else if(!strcmp(str,"RowQuery"))
        {
            scanf("%d",&i);
            
            int ans = 0;
            if(RTS0[i]>RTS1[i])
            {
                int tmp = sum(CS1,MX-1) - sum(CS1,RTS0[i]-1);
                ans = n-tmp;
            }

            else
            {
                int tmp = sum(CS0,MX-1) - sum(CS0,RTS1[i]-1);
                ans = tmp;
            }
            printf("%d\n",ans);
        }

        else
        {
            scanf("%d",&i);
            int ans = 0;
            if(CTS0[i]>CTS1[i])
            {
                int tmp = sum(RS1,MX-1) - sum(RS1,CTS0[i]-1);
                ans = n-tmp;
            }
            else
            {
                int tmp1 = sum(RS0,MX-1);
                int tmp2 = sum(RS0,CTS1[i]-1);
                int tmp = tmp1-tmp2;
//                cout << "tmp " << tmp1 << " " << tmp2 << endl;
                ans = tmp;
            }
            printf("%d\n",ans);
        }
    }

return 0;
}
