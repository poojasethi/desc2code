#include<iostream>
#include<algorithm>
#include<stdio.h>
#include<math.h>
#define mod 1000000007
using namespace std;
int a[1000001],p,p1;
long long c[100000],d[100000];
long long b[100];
void insert(long long x,int val)
{
  int i;
  for(i=0;i<p;i++)
    {
      if(c[i]==x)
	{
	  d[i]+=val;
	  return;
	}
    }
  c[p]=x;
  d[p]+=val;
  p++;
}
int main()
{
  int i,k,t,n,flag;
  long long m,g,ki;
  for(k=0;k<=1000000;k++)
    a[k]=1;
  p1=0;
  for(k=2;k<=1000000;k++)
    {
      if(a[k]!=0)
	{
	  d[p1]=0;
	  c[p1++]=k;
	}
      else continue;
      for(i=2;i*k<=1000000;i++)
        a[i*k]=0;
    }
  scanf("%d",&t);
  while(t--)
    {
      p=p1;
      for(i=0;i<p;i++)
	d[i]=0;
      scanf("%d",&n);
      for(k=0;k<n;k++)
        {
          scanf("%lld",&m);
	  for(i=0;i<p;i++)
            {
	      while(m%c[i]==0)
                {
                  d[i]++;
		  m/=c[i];
                }
            }
          if(m>1)
	    {
              b[k]=m;
            }
	  else
	    b[k]=0;
        }
      for(i=0;i<n;i++)
        {
	  if(b[i]==0)continue;
          flag=1;
          for(k=0;k<n;k++)
            {
              g=__gcd(b[i],b[k]);
              if(g>1 && g!=b[i])
                {
		  
                  insert(g,1);insert(b[i]/g,1);
                  flag=0;
                  break;
                }
 
            }
          if(flag==1)
            {
              ki=sqrt(b[i]);
              if(ki*ki==b[i] && ki!=-1)
                insert(ki,2);
              else
                insert(b[i],1);
            }
        }
      long long ans=1;
      for(i=0;i<p;i++)
        {
	  if(d[i]%3==1)
	    {
	      ans=(ans*(c[i]%mod))%mod;
	      ans=(ans*(c[i]%mod))%mod;
	    }
	  if(d[i]%3==2)
	    {
	      ans=(ans*(c[i]%mod))%mod;
	    }
	  while(d[i]>0)
	    {
	      ans=(ans*(c[i]%mod))%mod;
	      d[i]--;
	    }
	  
	}
      printf("%lld\n",ans);
    }
  return 0;
}
 