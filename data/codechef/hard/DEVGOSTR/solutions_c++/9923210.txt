#include <bits/stdc++.h>

using namespace std;
long long int mod = 1000000007;
vector<string> myset1,myset2;
void fun1(string s,int curr){
    if(curr == 50){
        return;
    }
    else{
        string temp1 = s + string(1,'a'),temp2 = s + string(1,'b');
        int flag1 = 0,flag2 = 0;
        int pos1 = temp1.size() - 1;
        int pos = pos1;
        for(int i = 1;i <= temp1.size()/2;i++){
            if(temp1[pos1] == temp1[pos1 - i] && temp1[pos1 - i] == temp1[pos - 2*i]){
                flag1 = 1;
                break;
            }
        }
        if(flag1 == 0){
            myset1.push_back(temp1);
            fun1(temp1,curr + 1);
        }
        for(int i = 1;i <= temp1.size()/2;i++){
            if(temp2[pos1] == temp2[pos1 - i] && temp2[pos1 - i] == temp2[pos - 2*i]){
                flag2 = 1;
                break;
            }
        }
        if(flag2 == 0){
            myset1.push_back(temp2);
            fun1(temp2,curr + 1);
        }

    }
}
void fun2(string s,int curr){
    if(curr == 50){
    return;
    }
    else{
        string temp1 = s + string(1,'a'),temp2 = s + string(1,'b'),temp3 = s + string(1,'c');
         int flag1 = 0,flag2 = 0,flag3 = 0;
        int pos1 = temp1.size() - 1;
        int pos = pos1;
        for(int i = 1;i <= temp1.size()/2;i++){
            if(temp1[pos1] == temp1[pos1 - i] && temp1[pos1 - i] == temp1[pos - 2*i]){
                flag1 = 1;
                break;
            }
        }
        if(flag1 == 0){
            myset2.push_back(temp1);
            fun2(temp1,curr + 1);
        }
         for(int i = 1;i <= temp1.size()/2;i++){
            if(temp2[pos1] == temp2[pos1 - i] && temp2[pos1 - i] == temp2[pos - 2*i]){
                flag2 = 1;
                break;
            }
        }
        if(flag2 == 0){
            myset2.push_back(temp2);
            fun2(temp2,curr + 1);
        }
         for(int i = 1;i <= temp1.size()/2;i++){
            if(temp3[pos1] == temp3[pos1 - i] && temp3[pos1 - i] == temp3[pos - 2*i]){
                flag3 = 1;
                break;
            }
        }
        if(flag3 == 0){
            myset2.push_back(temp3);
            fun2(temp3,curr + 1);
        }
    }
}
int main()
{
    fun1("",0);
    fun2("",0);
    int t;
    cin>>t;
    while(t--){
        int a,k;
        cin>>a>>k;
        string s;
        cin>>s;
        if(a == 1){
            if(s.size() > 2){
                cout<<0<<endl;
            }else{
                cout<<1<<endl;
            }
        }else if(a == 2){
            long long int count = 0;
            for(int it = 0;it < myset1.size();it++){
                string temp = myset1[it];
                if(temp.size() == s.size()){
                    int c = 0;
                    for(int i = 0;i < s.size();i++){
                        if(s[i] != temp[i]){
                            c++;
                        }
                    }
                    if(c <= k){
                       // cout<<temp<<endl;
                        count++;
                        count %= mod;
                    }
                }
            }
            cout<<count<<endl;
        }else{
            long long int count = 0;
            for(int it = 0;it < myset2.size();it++){
                string temp = myset2[it];
                if(temp.size() == s.size()){
                    int c = 0;
                    for(int i = 0;i < s.size();i++){
                        if(s[i] != temp[i]){
                            c++;
                        }
                    }
                    if(c <= k){
                       // cout<<temp<<endl;
                        count++;
                        count %= mod;
                    }
                }
            }
            cout<<count<<endl;
        }

    }
    return 0;
}
