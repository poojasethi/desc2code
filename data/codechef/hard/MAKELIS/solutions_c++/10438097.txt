#include<iostream>
#include <list>
using namespace std;
int main()
{
	int T,K;
	cin>>T;
	while(T--)
	{
		cin>>K;
		if(K<=100)
		{
			cout<<K<<endl;
			for(int i=K;i>=1;i--)
				cout<<i<<" ";
			cout<<endl;
			continue;
		}
		list<int> remainders;
		list<int> ans;
		remainders.clear();
		ans.clear();
		while(K>0)
		{
			remainders.push_front(K%3);
			K=K/3;
		}
		int tot_length=0,sub_length=0,remain;
		remain = remainders.front();
		remainders.pop_front();
		if(remain==2)
		{	ans.push_back(2);ans.push_back(1);tot_length = 2;sub_length ++;}
		while(!remainders.empty())
		{
			ans.push_back(tot_length + 3);
			ans.push_back(tot_length + 2);
			ans.push_back(tot_length + 1);
			tot_length += 3;
			sub_length += 1;
			remain = remainders.front();
			remainders.pop_front();
			if(remain==0)
				continue;
			if(remain==1)
			{
				for(int i=sub_length;i>=1;i--)
					ans.push_front(i+tot_length);
				tot_length += sub_length;
			}
			if(remain==2)
			{
				for(int i=sub_length+1;i>=3;i--)
					ans.push_front(i+tot_length);
				ans.push_front(1+tot_length);
				ans.push_front(2+tot_length);
				tot_length += sub_length + 1;
			}
		}
		cout<<tot_length<<endl;
		while(!ans.empty())
		{
			cout<<ans.front()<<' ';
			ans.pop_front();
		}
		cout<<endl;
	}
	return 0;
} 