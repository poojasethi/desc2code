#include <iostream>
#include <cstdio>
#define sl(x) scanf("%lld",&x)

typedef long long ll;
int M = 1000000007;

int main(){
	int t;
	ll P[200],Q[200],A0,B0,C0,M0,A1,B1,C1,M1,N,V;
	scanf("%d",&t);
	while(t--){
		bool flag = false;
		sl(V); sl(N);
		sl(P[0]);sl(P[1]),sl(A0),sl(B0),sl(C0),sl(M0);
		sl(Q[0]);sl(Q[1]); sl(A1),sl(B1),sl(C1),sl(M1);
		for(int i = 2 ; i < N ; i++){
			P[i] = (A0*A0)%M0;
			P[i] = (P[i]*P[i-1])%M0;
			P[i] = (P[i] + B0*P[i-2] + C0)%M0;
			Q[i] = (A1*A1)%M1;
			Q[i] = (Q[i]*Q[i-1])%M1;
			Q[i] = (Q[i] + B1*Q[i-2] + C1)%M1;

		}
		ll up = 1;
		for(int i = 0 ; i < N ; i++){
			ll L = (P[i]*M1 + Q[i] + 1);
			up *= (L-1)%(M-1);
			up %= (M-1);
			if(L == 1  ) {
				flag = true;
				break;
			}
		}
		
		
		ll res = 1;
		ll base = V%M;
		for( ll ex = up ; ex>0; ex>>=1){
			if(ex%2!=0)
				res = ((res%M )* (base%M))%M;
			base = ((base%M)*(base%M))%M;
		}

		if(!flag){
			if(V%M == 0 and up==0){
				printf("0\n");
				continue;
			}
		}
		else{
			res = 1;
		}
		printf("%lld\n",res);
	}
}