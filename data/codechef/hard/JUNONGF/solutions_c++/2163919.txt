#include <stdio.h>
#define ull unsigned long long
#define MOD 1000000007
#define MODm 1000000006
#define get getchar_unlocked
inline ull inp( )
{
    long long n=0,s=1;
    char p=get();
    if(p=='-')
    s=-1;
    while((p<'0'||p>'9')&&p!=EOF)
    p=get();
    while(p>='0'&&p<='9')
    {
    n = (n<< 3) + (n<< 1) + (p - '0');
    p=get();
    };
    return n*s;
}

ull power(ull a,ull b)
{
ull r=1,x=a;
if(a==0)
return 0;
while(b>0)
{
if(b&1)r=(r*x)%MOD;
x=(x*x)%MOD;
b>>=1;
}
return r%MOD;
}
int main()
{
    ull t;
    t=inp();
    while(t--)
    {
        ull exp=1,v,n,i,a0,a1,b0,b1,c0,c1,m0,m1,p[101],q[101],l[101],ans;
        int e=0;
        v=inp();n=inp();
        p[0]=inp();p[1]=inp();a0=inp();b0=inp();c0=inp();m0=inp();
        q[0]=inp();q[1]=inp();a1=inp();b1=inp();c1=inp();m1=inp();
            a0=(a0*a0)%m0;
            a1=(a1*a1)%m1;
        for(i=0;i<n;i++)
        {
            if(i<2)
            {l[i]=(p[i]*m1+q[i])%MODm;}
            else
            {p[i]=((a0*p[i-1])%m0+(b0*p[i-2])%m0+c0)%m0;
            q[i]=((a1*q[i-1])%m1+(b1*q[i-2])%m1+c1)%m1;}
            l[i]=(p[i]*m1+q[i]);
            if(l[i]==0)
            {
                e=1;
                break;
            }
            l[i]%=MODm;
            exp=(exp*l[i])%MODm;
        }

        if(e)
        {
            printf("1\n");
            continue;
        }
        v=v%MOD;
        printf("%lld\n",power(v,exp));
    }
    return 0;
}
