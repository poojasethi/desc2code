#include <cstring>
#include <iostream>
#include <stdio.h>
#include <cstdlib>
#include <cctype>
#include <algorithm>
#include <map>
#include <vector>
#include <list>
#include <set>
#include <queue>
#include <deque>
#include <stack>
#include <string>
#include <cmath>
using namespace std;
#define pb push_back
#define mp make_pair
#define mod 1000000007
#define N 105
#define ff first
#define ss second
#define get getchar//_unlocked
inline long long inp()
{
    long long n=0,s=1;
    char p=get();
    if(p=='-')
    s=-1;
    while((p<'0'||p>'9')&&p!=EOF)
    p=get();
    while(p>='0'&&p<='9')
    {
    n = (n<< 3) + (n<< 1) + (p - '0');
    p=get();
    };
    return n*s;
}
long long a[N],p[N],q[N],L[N];
long long power(long long a,long long b)
{
    long long r=1,x=a;
    if(a==0)return 0;
    while(b>0)
    {
        if(b&1)r=(r*x)%mod;
        x=(x*x)%mod;
        b>>=1;
    }
    return r;
}
int main()
{
    long long i,n,j,k,l,m,t,c=0,v,s;
    long long a0,b0,c0,m0,a1,b1,c1,m1;
    scanf("%lld",&t);
    while(t--)
    {
     scanf("%lld%lld",&v,&n);
     scanf("%lld%lld%lld%lld%lld%lld",&p[0],&p[1],&a0,&b0,&c0,&m0);
     scanf("%lld%lld%lld%lld%lld%lld",&q[0],&q[1],&a1,&b1,&c1,&m1);
     s=1;
     for(i=0,c=0;i<n;i++)
     {
         if(i>=2)
         {
         p[i]=(((a0*a0)%m0*(p[i-1]%m0))%m0+((b0%m0)*p[i-2])%m0+c0%m0)%m0;
         q[i]=(((a1*a1)%m1*(q[i-1]%m1))%m1+((b1%m1)*q[i-2])%m1+c1%m1)%m1;
         }
         L[i]=((p[i]*m1)+q[i]);
         if(L[i]!=0)
         s=(s*(L[i]%(mod-1)))%(mod-1);
         else c++;
     }
     if(c==0)
     printf("%lld\n",power(v%mod,s)%mod);
     else printf("1\n");
    }
    return 0;
}
