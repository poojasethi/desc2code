#include <iostream>
#include <cstdio>
using namespace std;
typedef  long long ll;
long long m=1000000007;
ll modulo(ll a, ll b)
{
	if(b==0) return 1;
	ll ans=modulo(a,b/2);
	ans=ans*ans;
	ans%=m;
	if(b%2) ans*=a;
	ans%=m;
	return ans;
}
long long pp[101],qq[101];
int main()
{
    int t;
    long long dim,v,power,a0,a1,b0,b1,c0,c1,m0,m1;
    int n;
	cin>>t;
	while(t--)
	{
		cin>>v>>n;
		cin>>pp[0]>>pp[1]>>a0>>b0>>c0>>m0;
        cin>>qq[0]>>qq[1]>>a1>>b1>>c1>>m1;
		power=1;
		a0=(a0*a0)%m0;
		a1=(a1*a1)%m1;
		b0%=m0;
		b1%=m1;
		c0%=m0;
		c1%=m1;
		for(int i=0;i<n;i++)
		{
            if(i>1)
            {
                pp[i]=(((a0*pp[i-1])%m0+(b0*pp[i-2])%m0)%m0+c0)%m0;
                qq[i]=(((a1*qq[i-1])%m1+(b1*qq[i-2])%m1)%m1+c1)%m1;
            }
            dim=pp[i]*m1+qq[i]+1;
            dim-=1;
            if(v%m)
            {
                dim%=(m-1);
                power=(power*dim)%(m-1);
            }
            else if(dim==0) power=0;
		}
		if(power==0) printf("1\n");
		else if(v%m==0) printf("0\n");
		else printf("%lld\n",modulo(v%m,power));
	}
	return 0;
}