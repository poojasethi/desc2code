#include<iostream>
#include<cstdio>
#define mod 1000000007
using namespace std;
long long  modular(long long  a, long long  b)
{
    if(a==0)
	return 0;
	
	long long  result=1;
	while(b>0)
	{
		if(b % 2==1)
		result=(result*a)%mod;
		
		b=b/2;
		a=(a*a)%mod;
		
	}
	return result;
}
int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		long long v;
		int n;
		scanf("%llu %d",&v,&n);
	    long long  p[n],q[n],a0,b0,c0,m0,a1,b1,c1,m1;
	    long long l[n];
		
		scanf("%lld%lld%lld%lld%lld%lld",&p[0],&p[1],&a0,&b0,&c0,&m0);
		scanf("%lld%lld%lld%lld%lld%lld",&q[0],&q[1],&a1,&b1,&c1,&m1);
		a0=(a0*a0)%m0;
		a1=(a1*a1)%m1;
		for(int i=2;i<n;i++)
		{
			p[i] = ((a0*p[i-1])%m0 +(b0*p[i-2])%m0+c0)%m0;
			
			q[i] = ((a1*q[i-1])%m1 +(b1*q[i-2])%m1+c1)%m1;
		}
		long long  w=1;
		int flag=0;
		for(int i=0;i<n;i++)
		{
			l[i]=((p[i]*m1)+q[i]);
			if(l[i]==0)
			{
				flag=1;
				
			}
			l[i]=l[i]%(mod-1);

		}
		if(flag==1)
		cout<<"1"<<endl;
		else
		{
 
		for(int i = 0;i < n; ++i)
		{
 
		w = (w * l[i]) % (mod - 1);
 
		}
	     
		v=modular(v%mod,w)%mod;
		long long ans=v;
		cout<<ans<<endl;
		}
		
	}
}