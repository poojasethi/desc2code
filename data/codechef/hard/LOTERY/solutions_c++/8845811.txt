#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#define p 1000000007
using namespace std;

int T,N,K,A,B,M,i,j,k,an,aim,ans,ll,rr,Mult,u,v;
int p_[100005],a[100005],c[1000005],d[1000005];

struct node
{
	int l,r,mult;
}t[10000005];
int root[100005],tot;

void C(int &x,int l,int r)
{
	t[++tot]=t[x];x=tot;
	if(l==r)
	{
		t[x].mult=a[l];
		return;
	}
	int mid=(l+r)>>1;
	if(aim<=mid)C(t[x].l,l,mid);
	else C(t[x].r,mid+1,r);
	t[x].mult=(long long)t[t[x].l].mult*t[t[x].r].mult%p;
}

void Q(int x,int l,int r)
{
	if(l>=ll&&r<=rr)
	{
		Mult=(long long)Mult*t[x].mult%p;
		return;
	}
	int mid=(l+r)>>1;
	if(rr<=mid)Q(t[x].l,l,mid);
	else if(ll>mid)Q(t[x].r,mid+1,r);
		else Q(t[x].l,l,mid),Q(t[x].r,mid+1,r);
}

int calc(int N,int K)
{
	int i,j,k;
	Mult=1;
	ll=N-K+1;rr=N;
	Q(root[N],1,100000);
	return Mult;
}

char ch;
void read(int &x)
{
	for(ch=getchar();ch<'0'||ch>'9';ch=getchar());
	for(x=0;ch>='0'&&ch<='9';ch=getchar())x=x*10+ch-'0';
}

int main()
{
	for(i=2;i<=100000;++i)
	if(!p_[i])
	{
		p_[i]=i;
		for(j=i+i;j<=100000;j+=i)if(!p_[j])p_[j]=i;
	}
	for(i=1;i<=100000;++i)
	{
		root[i]=root[i-1];
		a[i]=1;
		for(k=i;k>1;)
		{
			u=p_[k];v=1;
			for(;k%u==0;k/=u,v*=u);
			for(;v>1;v/=u)
			{
				a[aim=(i-v)]/=u;
				if(aim!=0)C(root[i],1,100000);
				a[i]*=u;
			}
		}
		aim=i;C(root[i],1,100000);
	}
	scanf("%d",&T);
	scanf("%d%d",&N,&K);
	ans=calc(N,K);
	printf("%d\n",ans);
	scanf("%d%d%d",&A,&B,&M);
	for(i=2;i<=T;++i)read(c[i]);
	for(i=2;i<=T;++i)read(d[i]);
	for(i=2;i<=T;++i)
	{
		N=((long long)A*ans+c[i])%M+1;
		K=((long long)B*ans+d[i])%N+1;
		ans=calc(N,K);
		printf("%d\n",ans);
	}
}