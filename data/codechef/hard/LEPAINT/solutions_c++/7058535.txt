#include<bits/stdc++.h>

using namespace std;

pair<int,int> indices[1000];
double prob[110][110][110];
double ans;

int main(){
    int T,N,K,C;
    int i,j,k,l;
    cin>>T;
    while(T--){
        cin>>N>>C>>K;
        for(i=1;i<=K;i++){
            cin>>indices[i].first>>indices[i].second;
        }
        for(i=0;i<110;i++){
            for(j=0;j<110;j++){
                for(k=0;k<110;k++){
                    prob[i][j][k]=0;
                }
            }
        }
        for(i=0;i<110;i++){
            prob[0][i][1]=1;
        }
        for(i=1;i<=K;i++){
            for(j=1;j<=N;j++){
                for(k=0;k<=(C-1);k++){
                    if(!(j>=indices[i].first&&j<=indices[i].second)){
                        prob[i][j][k]+=prob[i-1][j][k];
                    }
                    else if(j>=indices[i].first&&j<=indices[i].second){
                        prob[i][j][k]+=(prob[i-1][j][k])/((double)2.0);
                        for(l=0;l<=(C-1);l++){
                            prob[i][j][(k*l)%C]+=(prob[i-1][j][k])/((double)2.0*C);
                        }
                    }
                }
            }
        }
        ans=0;
        for(i=1;i<=N;i++){
            for(k=0;k<=C-1;k++){
                ans+=(k*(prob[K][i][k]));
            }
        }
        printf("%.6lf\n",ans);
    }
return 0;
}
