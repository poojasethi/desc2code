#include<stdio.h>
#include<iostream>
#include<cstdlib>
#include<algorithm>
using namespace std;
double dp[52][52][104];
int main()
{
	int test;scanf("%d",&test);
	while(test--)
	{
		int n,c,k;
		scanf("%d%d%d",&n,&c,&k);
		for(int i=0;i<52;i++)
			for(int j=0;j<52;j++)
				for(int u=0;u<101;u++)
					dp[i][j][u]=0.0;
		for(int i=1;i<=n;i++)
				dp[0][i][1]=1;
		for(int i=1;i<=k;i++)				// ith step
		{
			int l,r;scanf("%d%d",&l,&r);
			for(int j=1;j<=n;j++)			// jth index
			{
				for(int u=0;u<c;u++)		// uth color already present
				{
					if(j<=r && j>=l)
					{
						for(int v=0;v<c;v++)	// if it is painted with vth color..
						{
							dp[i][j][(u*v)%c]+=dp[i-1][j][u]/(2.0*c);
						}
						dp[i][j][u]+=dp[i-1][j][u]/2.0;  // if it is not chosen in the subset..
					}
					else
						dp[i][j][u]+=dp[i-1][j][u];	
				}
			}
		}
		double ans=0;
		for(int i=1;i<=n;i++)
		{
			for(int j=0;j<c;j++)
				ans+=(j*dp[k][i][j]);
		}
		printf("%.12lf\n",ans);
	}
	return 0;
}