#include <bits/stdc++.h>

using namespace std;

int n, c, m;
double dp[51][51][101];

void solve() {
    scanf("%d%d%d",&n,&c,&m);
    memset(dp,0,sizeof(dp));
    for(int j=1;j<=n;j++) dp[0][j][1]=1;
    for(int i=1;i<=m;i++) {
        int L, R; scanf("%d%d",&L,&R);
        for(int j=1;j<=n;j++)
        for(int k=0;k<c;k++)
        if (L<=j && j<=R) {
            dp[i][j][k]+=dp[i-1][j][k]*0.5;
            for(int kk=0;kk<c;kk++) dp[i][j][(kk*k)%c]+=dp[i-1][j][k]/(2*c);

        } else dp[i][j][k]+=dp[i-1][j][k];
    }
    double ans=0;
    for(int i=1;i<=n;i++)
        for(int j=0;j<c;j++) ans+=j*dp[m][i][j];
    printf("%0.6lf\n",ans);
}

int main() {
    #ifndef ONLINE_JUDGE
    freopen("inp.txt","r",stdin);
    freopen("out.txt","w",stdout);
    #endif // ONLINE_JUDGE
    int T; scanf("%d",&T);
    while (T--) solve();
}
