#include <map>
#include <set>
#include <queue>
#include <vector>
#include <cstdio>
#include <cmath>
#include <bitset>
#include <climits>
#include <cstring>
#include <utility>
#include <iterator>
#include <iostream>
#include <algorithm>
using namespace std;
#define MX 2000100
#define INF 1000000000
#define ff first
#define ss second
#define LL long long
#define MOD 1000000007
#define pii pair<int,int>
#define pi2 pair<pii,int>
int dx[4]={0,0,1,-1};
int dy[4]={1,-1,0,0};
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,c,k,L,R;
		cin>>n>>c>>k;
		double dp[k+10][n+10][c+10];
		memset(dp,0,sizeof dp);
		for(int i=1;i<=n;i++)dp[0][i][1]=1.0;
		for(int i=1;i<=k;i++)
		{
			cin>>L>>R;
			for(int j=1;j<=n;j++)
			{
				for(int l=0;l<c;l++)
				{
					if(j>=L and j<=R)
					{
						for(int m=0;m<c;m++)
						{
							dp[i][j][(l*m)%c]+=dp[i-1][j][l]/(2*c);
						}
						dp[i][j][l]+=(dp[i-1][j][l]*0.5);
					}
					else
						dp[i][j][l]+=dp[i-1][j][l];
				}
			}
		}
		double ans=0.0;
		for(int i=1;i<=n;i++)
		{
			for(int j=0;j<c;j++)
				ans+=j*dp[k][i][j];
		}
		printf("%.9lf\n",ans );
	}
	return 0;
}
