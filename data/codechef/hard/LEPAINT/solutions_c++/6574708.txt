#include <bits/stdc++.h>
using namespace std;

typedef	long long ll;
typedef vector<int> vi;
typedef vector<ll> vll;
typedef pair<int, int> pii;
#define pb push_back
#define mp make_pair
#define rep(i,n) for(int i = 0; i < n; i++)
#define sc(n) scanf("%d",&n)
#define scll(n) scanf("%I64d",&n)
#define mod 1000000007
#define ll long long
template<class T>inline T gcd(T a,T b){return b?gcd(b,a%b):a;}
int main()
{
	int test;
	sc(test);
	while(test--){
		int n,k,c;
		sc(n);
		sc(c);
		sc(k);
		double dp[k+1][n+1][c+1];
		memset(dp,0,sizeof dp);
		for(int j = 0;j<n;j++){
			dp[0][j][1] = 1;
		}
		for(int turn = 1;turn<=k;turn++){
			int l,r;
			sc(l);
			sc(r);
			l--;
			r--;
			for(int i = 0;i<n;i++){
				for(int j = 0;j<c;j++){
					if(i>=l&&i<=r){
						for(int m = 0;m<c;m++){
							dp[turn][i][(j*m)%c] += dp[turn-1][i][j]/(2*(double)c);
						}
						dp[turn][i][j] += dp[turn-1][i][j]*0.5;
					}
					else {
						dp[turn][i][j] += dp[turn-1][i][j];
					}
				}
			}
		}
		double ans = 0;
		for(int i = 0;i<n;i++){
			for(int j = 0;j<c;j++){
				ans = ans+j*dp[k][i][j];
			}
		}
		printf("%lf\n",ans);
	}
}
