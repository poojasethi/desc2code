#include<bits/stdc++.h>
using namespace std;
int n,k,c,f[55];
long double dp[110][55];
long double doit(int clr,int s){
  if(s==0) return clr;
  if(dp[clr][s]!=-1) return dp[clr][s];
  dp[clr][s]=0;
  for(int i=0;i<c;i++) dp[clr][s]+=doit((clr*i)%c,s-1);
  dp[clr][s]/=(long double)c;
  dp[clr][s]+=doit(clr,s-1);
  dp[clr][s]/=(long double)2;
  return dp[clr][s];
}
int main(){
  int t,l,r;  long double res;
  cin>>t;
  while(t--){
    res=0;    cin>>n>>c>>k;
    memset(f,0,sizeof f);
    for(int i=0;i<110;i++) for(int j=0;j<55;j++) dp[i][j]=-1;
    for(int i=0;i<k;i++){
      cin>>l>>r;
      for(int j=l-1;j<r;j++)  f[j]++;
    }
    for(int i=0;i<n;i++) res+=doit(1,f[i]);
    printf("%.7Lf\n",res);
  }
}