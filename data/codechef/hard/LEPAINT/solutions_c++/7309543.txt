#include <bits/stdc++.h>
using namespace std;

double dp[51][51][101];
int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        int n,c,k,l,r,i,j,color=0,p,q;
        cin>>n>>c>>k;

		for(i=0;i<=k;i++)
			for(j=0;j<=n;j++)
				for(p=0;p<=c;p++)
					dp[i][j][p]=0;
		
        for(i=0;i<=n;i++)
            dp[0][i][1]=1.000;
		

        for(i=1;i<=k;i++)
        {
            cin>>l>>r;

            for(j=1;j<=n;j++)
            {
                for(p=0;p<c;p++)
                {
                    if(j>=l && j<=r)
                    {
                        for(q=0;q<c;q++)
                            dp[i][j][(p*q)%c]+=(dp[i-1][j][p]/(2*c));
                        dp[i][j][p]+=dp[i-1][j][p]*0.5;
                    }
                    else
                    {
                        dp[i][j][p]+=dp[i-1][j][p];
                    }
                }
            }
        }

        double ans=0;

        for(i=1;i<=n;i++)
            for(j=0;j<c;j++)
                ans+=(j*dp[k][i][j]);

        cout<<setprecision(10)<<ans<<"\n";
    }
    return 0;
}
