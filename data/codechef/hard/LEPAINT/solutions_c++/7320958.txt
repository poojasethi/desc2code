#include<iostream>
#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<vector>
#include<algorithm>
#include<numeric>
#include<stack>
#include<queue>
#include<deque>
#include<bitset>
#include<cmath>
#include<list>
#include<set>
#include<map>
#define vi vector<int>
#define vvi vector< vi >
#define pii pair<int,int>
#define pb push_back
#define mp make_pair
#define all(c) c.begin(),c.end() 
#define sz(c) c.size()
#define tr(c,it)  for(typeof(c.begin()) it=c.begin();it!=c.end();it++)  
#define max(a,b) (a>b?a:b)
#define min(a,b) (a<b?a:b)
#define abs(a)  (a>=0?a:-a)
#define present(c,x) find(all(c),x)!=c.end()
#define cpresent(c,x) c.find(x)!=c.end()  
#define permute(c) next_permutation(all(c))
using namespace std;
int main(){
    int T,N,K,C,i,j,k,L,R,m;
	double dp[55][55][105],answer;
	scanf("%d",&T);
	while(T--){
		answer=0.0;
		scanf("%d%d%d",&N,&C,&K);    
		for(i=0;i<=K;i++)
		   for(j=1;j<=N;j++)
		      for(k=0;k<C;k++)
		         dp[i][j][k]=0.0;
		for(i=1;i<=N;i++)
		  dp[0][i][1]=1.0;
		for(i=1;i<=K;i++){
			scanf("%d%d",&L,&R);
			for(j=1;j<=N;j++){
				for(k=0;k<C;k++){
					if(j>=L&&j<=R){
						for(m=0;m<=C;m++)
						  dp[i][j][(m*k)%C]+=dp[i-1][j][k]/(2.0*(double)(C));
						dp[i][j][k]+=dp[i-1][j][k]*(0.5);  
					}
					else
					  dp[i][j][k]+=dp[i-1][j][k];
				}
			}
		}      
		for(i=1;i<=N;i++){
			for(j=0;j<C;j++){
				answer+=j*dp[K][i][j];
			}
		}     
		printf("%0.7lf\n",answer);
	} 
	return 0;
}