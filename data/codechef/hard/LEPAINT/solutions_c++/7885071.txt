#include <bits/stdc++.h>
#define sz 110
#define debug 1
using namespace std;

double dp[sz][sz][sz];
vector<pair<int, int> > arr;
int n, c, k;

double solve() {
	double ret = 0;
	for(int i=1;i<=n;i++) {
		dp[0][i][1] = 1;
	}
	for(int i=0;i<k;i++) {
		for(int j=1;j<=n;j++) {
			if(j < arr[i].first || j > arr[i].second) {
				for(int kk=0;kk<c;kk++) {
					dp[i+1][j][kk] = dp[i][j][kk];
				}
			}
		}
		for(int j=arr[i].first; j <= arr[i].second; j++) {
			double pro_seg = 0.5, pro_color = (1.0/c);
			//if(debug) cout<<" pro_seg "<<pro_seg<<endl;
			//if(debug) cout<<" pro_color "<<pro_color<<endl;
			for(int kk=0;kk<c;kk++) {
				for(int l=0;l<c;l++) {
					int col = (kk*l)%c;
					dp[i+1][j][col] += pro_seg*pro_color*dp[i][j][l];
					//if(debug) cout<<" dp "<<dp[i+1][j][col]<<endl;
				}
				dp[i+1][j][kk] += dp[i][j][kk]*0.5;
			}
		}
	}
	for(int i=1;i<=n;i++) {
		for(int j=0;j<c;j++) {
			ret += dp[k][i][j]*j;
		}
	}
	return ret;
}

int main() {
	int t;
	cin>>t;
	while(t--) {
		memset(dp, 0, sizeof dp);
		arr.clear();
		scanf("%d%d%d", &n, &c, &k);
		for(int i=0;i<k;i++) {
			int a, b;
			scanf("%d%d", &a, &b);
			arr.push_back(make_pair(a, b));
		}
		printf("%.8lf\n", solve());
	}
	return 0;
}