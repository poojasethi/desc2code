// codechef LEPAINT

#include<iostream>
#include<cstring>
#include<iomanip>
using namespace std;

int main(){
	int t,n,c,K,l,r;
	cin>>t;
	while(t--){
		cin>>n>>c>>K;

		double table[K+1][n][c];
		memset(table,0,sizeof(table));
			
		for(int i=0;i<n;i++)
			table[0][i][1]=1;

		for(int k=1;k<=K;k++){
			cin>>l>>r;
			for(int i=0;i<n;i++){
				for(int j=0;j<c;j++){
					if(i>=l-1 && i<r){
						table[k][i][j]+=table[k-1][i][j]/2;
						
						for(int m=0;m<c;m++){
							table[k][i][(j*m)%c]+=table[k-1][i][j]/(2*c);
						}
					}
					else
						table[k][i][j]=table[k-1][i][j];
				}
			}

			
		}
		double ans=0;		
		for(int i=0;i<n;i++)
			for(int j=0;j<c;j++)
				ans+=table[K][i][j]*j;
		cout<<setprecision(15)<<ans<<endl;				
	
	}
	return 0;
}


					

					


