#include <iostream>
#include <stdio.h>
#include <string.h>
#include <math.h>
#include <vector>
#include <string>
#include <map>
#include <set>
#include <queue>
#include <algorithm>
#define lli long long int
#define pb push_back
#define mod 1000000007
#define pii pair<int,int>

using namespace std;
double dp[52][52][102];
int main()
{
    int t,n,i,j,k,m,c,l,lft,rt;
    cin>>t;
    while(t--)
    {
        cin>>n>>c>>m;
        //dp[i][j][k]-->prob of Kth colour at Jth index at after Ith turn

        memset(dp,0,sizeof(dp));

        for(i=0; i<n; i++)dp[0][i][1]=1.0;

        for(i=1; i<=m; i++)
        {
            cin>>lft>>rt;
            lft--;
            rt--;
            for(j=0; j<n; j++)
            {
                for(k=0; k<c; k++)
                {
                    if(j>=lft && j<=rt) //if in range
                    {
                        for(l=0; l<c; l++)
                        {
                            dp[i][j][(k*l)%c]+= ((dp[i-1][j][k])/(2.0*c)); //chosen and coloured
                        }

                        dp[i][j][k]+= (dp[i-1][j][k] *0.5); //not chosen
                    }
                    else dp[i][j][k]+=dp[i-1][j][k]; //not in range
                }
            }
        }

        double ans=0;
        for(i=0; i<n; i++)
        {
            for(j=0; j<c; j++)
            {
                ans=ans + double(j*dp[m][i][j]);
            }
        }
        printf("%.8lf\n",ans);
    }




    return 0;
}
