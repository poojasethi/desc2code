#include <bits/stdc++.h>
using namespace std;
#define pb push_back
//#define mp make_pair
#define line() printf("\n")
#define space() printf(" ")
typedef long long int lli;
void sc(int& a){scanf("%d",&a);}
void sc(lli& a){scanf("%lld",&a);}
void sc(int& a, int& b){sc(a);sc(b);}
void sc(int& a,int& b,int& c){sc(a);sc(b);sc(c);}
void sc(lli& a,lli& b){sc(a);sc(b);}
void sc(lli& a,lli& b,lli& c){sc(a,b);sc(c);}
void write(int a){printf("%d",a);}
void write(lli a){printf("%lld",a);}
lli mod =1000000007;
lli modpow(lli a, lli b, lli mod){lli res=1;while(b>0){if(b&1)res=(res*a)%mod;a=(a*a)%mod;b=b/2;}return res%mod;} 
double dp[51][51][101];
int main()
{
    int t,n,c,k,i,j,l,r,m,turn;
    sc(t);
    while(t--)
    {
        sc(n,c,turn);
        memset(dp,0,sizeof dp);
        for(j=1;j<=n;j++)
            dp[0][j][1]=1.0;
        for(i=1;i<=turn;i++)
        {
            sc(l,r);
            for(j=1;j<=n;j++)     
                for(k=0;k<c;k++)
                {
                    if(j>=l and j<=r)
                    {
                        for(m=0;m<c;m++)
                            dp[i][j][(m*k)%c]+=0.5*dp[i-1][j][k]/c;
                        dp[i][j][k]+=0.5*dp[i-1][j][k];
                    }
                    else dp[i][j][k]+=dp[i-1][j][k];
                }
        }
        double ans=0;
        for(j=1;j<=n;j++)
            for(k=0;k<c;k++)
                ans+=dp[turn][j][k]*k;
        printf("%.9lf\n", ans);
    }
}