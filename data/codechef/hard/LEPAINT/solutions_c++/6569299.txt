#include<bits/stdc++.h>
using namespace std;
double dp[100][100][100];

int main() {
	int t;
	int L, R;

	cin>>t;
	int N, C, K;
	while(t--) {
		cin>>N>>C>>K;
		memset(dp, 0 ,sizeof(dp));
		for(int j = 0; j < 100; j++) {
			dp[0][j][1] = (double)1;
		}
		for(int i = 1; i <= K; i++) {
			cin>>L>>R;
			for(int j = 1; j <= N; j++) {
				
				for(int k = 0; k < C; k++) {
					
					if( j >= L && j <= R ) {
						
						for(int m = 0; m < C; m++) {
							dp[i][j][(m * k)%C] += (double)(dp[i - 1][j][k]) / (double)(2*C); 
						}
						
						dp[i][j][k] += dp[i-1][j][k] * 0.5;
					} 
					else {
						dp[i][j][k] += dp[i-1][j][k];
					}
				}
			}
		}
		double ans = 0;
		for(int i = 1; i <= N; i++) {
			for(int j = 0; j < C; j++) {
				ans += dp[K][i][j] * (double)j;
			}
		}
		printf("%lf\n",ans);
	}
	return 0;
}
