#include<bits/stdc++.h>
using namespace std;
double d[51][51][101];

int main()
{
int n,k,c,i,t,l,r;
double ans;
scanf("%d",&t);


while(t--)
{
   ans=0;



   scanf("%d%d%d",&n,&c,&k);

   for(i=0;i<=k;i++)
   for(int j=0;j<=n;j++)
   for(int p=0;p<c;p++)
   d[i][j][p]=0;

     for(i=1;i<=n;i++)
   d[0][i][1]=1;
   for(int j=1;j<=k;j++)
   {
   scanf("%d%d",&l,&r);
       for(int f=0;f<c;f++)
      {

        for(i=1;i<=n;i++)
        {
           if(i>=l && i<=r)
           {
                for(int p=0;p<c;p++)
                {
                   d[j][i][(p*f)%c]+=(d[j-1][i][f]/(double)(2*c));

                }

                d[j][i][f]+=d[j-1][i][f]*0.5;

           }
           else d[j][i][f]+=d[j-1][i][f];

               //cout<<d[j][i][f]<<endl;
        }
      }
   }

   for(i=1;i<=n;i++)
   for(int j=0;j<c;j++)
   {//cout<<d[k][i][j]<<endl;
   ans+=((double)j)*d[k][i][j];
  }
   printf("%6f\n",ans);

}

return 0;
}
