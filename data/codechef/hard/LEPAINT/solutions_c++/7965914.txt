#include<bits/stdc++.h>
using namespace std;

double dp[55][55][105];
int n,c,k,K,t,i,j,m,l,r;
int main()
{
    scanf("%d",&t);
    while(t--)
    {
        scanf("%d %d %d",&n,&c,&K);

        for(i=0; i<=K+1; i++)
            for(j=0; j<=n+1; j++)
                for(k=0; k<c+1; k++)
                    dp[i][j][k]=0.0;

        for(j=1; j<=n; j++)
            dp[0][j][1]=1.0;

        for(i=1; i<=K; i++)
        {
            scanf("%d %d",&l,&r);
            for(j=1; j<=n; j++)
            {
                for(k=0; k<c; k++)
                {
                    if(j>=l && j<=r)
                    {
                        // if jth location is selected
                        for(m=0; m<c; m++)
                            {
                               // printf("%lf\t",dp[i][j][(k*m)%c]);
                                dp[i][j][(k*m)%c]=  dp[i][j][(k*m)%c] + (dp[i-1][j][k])/(2*c);
                               // printf("%lf\t",dp[i][j][(k*m)%c]);
                            }

                        // if not selected
                        dp[i][j][k]=dp[i][j][k] + dp[i-1][j][k]/2;

                    }
                    else
                        {
                            dp[i][j][k]=dp[i][j][k] + dp[i-1][j][k];
                        }
                }
            }
        }


        double ans=0.0;
        for(i=1; i<=n; i++)
        {
            for(j=0; j<c; j++)
            {
                //printf("%lf %d %lf\n",dp[K][i][j],j,j*dp[K][i][j]);
                ans= ans+ j*dp[K][i][j];
            }
        }
        printf("%.9lf\n",ans);
    }
    return 0;
}
