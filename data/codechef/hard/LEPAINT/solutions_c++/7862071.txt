#include <bits/stdc++.h>
using namespace std;

int main(){
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);
	cout.tie(NULL);
	int t; cin >> t;
	for(int i=0; i<t; i++){
		int n, c, k; cin >> n >> c >> k;
		vector< vector<double> > vec(n, vector<double> (c, 0.0));
		for(int j=0; j<n; j++)vec[j][1]=1.0;
		for(int j=0; j<k; j++){
			vector<double> temp(c);
			int a, b; cin >> a >> b;
			a--; b--;
			for(int k=a; k<=b; k++){
				for(int l=0; l<c; l++){
					temp[l] = vec[k][l]/2.0;
				}
				for(int l=0; l<c; l++){
					for(int x=0; x<c; x++){
						int y = (l*x)%c;
						temp[y] += (0.5*vec[k][x])/(c*1.0);
					}
				}
				for(int l=0; l<c; l++){
					vec[k][l] = temp[l];
				}
			}
		}
		double sum = 0.0;
		for(int j=0; j<n; j++){
			double tempsum =0.0;
			for(int l=0; l<c; l++){
				tempsum += (l*vec[j][l]);
			}
			sum += tempsum;
		}
		cout << std::setprecision(10) << sum << endl;
	}
}
