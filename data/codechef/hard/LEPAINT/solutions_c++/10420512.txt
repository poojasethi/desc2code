#include <bits/stdc++.h>
using namespace std;

int main() {
	int t;
	cin >> t;
	while(t--)  {
		int n,c,k;
		cin >> n >> c >> k;
		double dp[101][101][101];
		memset(dp,0,sizeof(dp));
		for(int i=1;i<=n;i++) 
		  dp[0][i][1]=1;
		for(int i=1;i<=k;i++) {
			int x,y;
			cin >> x >> y;
			for(int j=1;j<=n;j++)  {
				for(int k=0;k<c;k++) {
					if(j >= x && j <= y)  {
						for(int m = 0;m<c;m++)
                             dp[i][j][(m*k)%c] += dp[i-1][j][k]/(2*c);
                        dp[i][j][k] += dp[i-1][j][k]*0.5;
					}
					else
					  dp[i][j][k] += dp[i-1][j][k];
				}
			}
		}
		double ans = 0.0;
		for(int i=1;i<=n;i++)  {
			for(int j=0;j<c;j++) {
				ans = ans + j*dp[k][i][j];
			}
		}
		printf("%.9f\n",ans);
	}
	return 0;
}