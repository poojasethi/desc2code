#include <bits/stdc++.h>

#define st first
#define nd second
#define mp make_pair
#define pb push_back
#define lli long long int
#define all( gg )	gg.begin(),gg.end()
#define foreach( gg,itit )	for( typeof(gg.begin()) itit=gg.begin();itit!=gg.end();itit++ )
#define FP( ii,aa,bb ) for( int ii=aa;ii<=bb;ii++ )
#define FM( ii,aa,bb ) for( int ii=aa;ii>=bb;ii-- )

using namespace std;

typedef pair<int,int> pii;

int n,m,arr[200000];
set< pii > S;
set< pii >::iterator it;

priority_queue< pair< int,pii > >	Q;

pii f(int x){
	pii res;
	it = S.upper_bound( mp(x+1,0) );
	it--;
	res = *it;
	S.erase( it );
	return res;
}

void add( pii a ){
	S.insert( a );
	Q.push( mp( a.nd-a.st,a ) );
}

void find(){
	while( S.find( Q.top().nd )==S.end() )	Q.pop();
	printf("%d\n",Q.top().st+1);
}

int main(){
	cin >> n >> m;
	FP( i,1,n )
		scanf("%d",arr+i);
	int j;
	FP( i,1,n ){
		j = i;
		while( j<n and arr[j+1]==arr[j]+1 )	j++;
		add( mp(i,j) );
		i = j;
	}
	int x,y;
	pii a,b,c;
	find();
	while( m-- ){
		scanf("%d %d",&x,&y);
		arr[x] = y;
		c = f( x );
		if( c.st<x )	add( mp( c.st,x-1 ) );
		if( x<c.nd )	add( mp( x+1,c.nd ) );
		add( mp( x,x ) );
		if( x>1 and arr[x]==arr[x-1]+1 ){
			a = f( x-1 );
			b = f( x );
			add( mp( a.st,b.nd ) );
		}
		if( x<n and arr[x]+1==arr[x+1] ){
			a = f( x );
			b = f( x+1 );
			add( mp( a.st,b.nd ) );
		}
		find();
	}
}