# your code goes here
t=int(raw_input())
while t:
	t-=1
	n=int(raw_input())
	arr=raw_input().split(' ')
	arr=map(int, arr)
	a,b,c=(raw_input().split(' '))
	a=int(a)
	b=int(b)
	c=int(c)
	bo=True
	mul=1
	add=0
	i=0
	j=n-1
	str=raw_input()
	for o in str:
		if (o=='R'):
			bo=not bo
		elif (o=='A'):
			add=(add+a)%c
		else:
			add=(add*b)%c
			mul=(mul*b)%c
		if(bo):
			print ((arr[i]*mul)%c+add)%c,
			i+=1
		else:
			print ((arr[j]*mul)%c+add)%c,
			j-=1
	print ''
	
