import sys
t=input()
for j in xrange(0,t):
	n=input()
	l = map(long,sys.stdin.readline().split())
	r = map(long,sys.stdin.readline().split())
	s=raw_input()
	x=1
	y=0
	u=0
	v=n-1
	temp=0
	for i in xrange(0,n):
		if(s[i]=='A'):
			y=(y+r[0])%r[2]
		elif(s[i]=='M'):
			x=(x*r[1])%r[2]
			y=(y*r[1])%r[2]
		elif(s[i]=='R'):
			u,v=v,u
		l[u] = l[u]*x + y
		print l[u]%r[2],
		if(u>v):
			u=u-1
		else:
			u=u+1
	print "" 