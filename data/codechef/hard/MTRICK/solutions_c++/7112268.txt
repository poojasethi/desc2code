#include<map>
#include<vector>
#include<cmath>
#include<stack>
#include<cstdio>
#include<queue>	
#include<cstring>
#include<cstdlib>
#include<utility>
#include<iostream>
#include<algorithm>
using namespace std;
#define MOD 1000000007
#define pi(x) printf("%d",x)
#define pl(x) printf("%lld",x)
#define pn    printf("\n");
#define si(x) scanf("%d",&x)
#define sl(x) scanf("%lld",&x)
#define max(a,b) a>b?a:b
#define min(a,b) a>b?b:a
#define PII pair<long long,long long>
#define PI2 pair<PII,long long>
#define x first
#define y second
long long fast_mul(long long a,long long b,long long c)
{
	long long res=0;
	while(b)
	{
		if(b&1)
		res=(res+a)%c;
		a=(a<<1)%c;
		b>>=1;
	}
	return res;
}
int main()
{
	long long t;
	sl(t);
	while(t--)
	{
		long long n,k,a,b,c;
		string s;
		sl(n);
		long long A[n];
		for(long long i=0;i<n;i++)
		{
		sl(A[i]);
		}
		sl(a),sl(b),sl(c);
		cin>>s;
		a%=c,b%=c;
		long long dir=1,add=0,mul=1,ans=0,l=0,r=n-1,ind=0;
		for(long long i=0;i<n;i++)
		{
			if(s[i]=='R')
			{
				dir=!dir;	
			}
			else if(s[i]=='A')
			{
				add=(add+a)%c;
			}
			else
			{	
				mul=fast_mul(mul,b,c)%c;
				add=fast_mul(add,b,c)%c;
			}
			if(dir)
			{
				ind=l;
			 	ans=((fast_mul(A[ind],mul,c)%c)+add)%c;
				cout<<ans<<" ";
				l++;
			}
			else
			{
				ind=r;
				ans=((fast_mul(A[ind],mul,c)%c)+add)%c;
				cout<<ans<<" ";
				r--;
			}
			
		}
		cout<<endl;
		
	}
}