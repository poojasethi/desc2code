#include <iostream>
#include <cstring>
#include <cmath>
#include <cstdio>
#include <climits>
#include <ctime>
#include <cassert>
#include <cctype>
#include <algorithm>
#include <numeric>
#include <map>
#include <set>
#include <queue>
#include <string>
#include <vector>
#include <bitset>

#define X first
#define Y second
#define pb push_back
#define bit(x) (1 << (x))
#define bnum(x) (__builtin_popcount(x))
#define sqr(x) ((x) * (x))
#define sz(x) ((int)(x.size()))
#define PQ priority_queue

using namespace std;
typedef long long LL;
typedef pair<int, int> pii;
typedef vector<int> vi;

template <class T> inline void chkmin(T &a, T b) {
	if (b < a) a = b;
}
template <class T> inline void chkmax(T &a, T b) {
	if (a < b) a = b;
}

#define MX 1005
LL a[MX], A, B, C;
LL modMul(LL x, LL y) {
	LL rlt = 0;
	while (y) {
		if (y & 1) rlt = (rlt + x) % C;
		y /= 2, x = 2 * x % C;
	}
	return rlt;
}

char s[MX];
int main() {
	#ifndef ONLINE_JUDGE
	freopen("in.txt", "r", stdin);
	freopen("out.txt", "w", stdout);
	#endif
	
	int T, n;
	int i;
	
	for (scanf("%d", &T); T--; ) {
		scanf("%d", &n);
		for (i = 1; i <= n; i++) scanf("%lld", a + i);
		cin >> A >> B >> C;
		scanf("%s", s);
		
		LL add = 0, mul = 1;
		int st = 1, en = n;
		for (i = 1; i <= n; i++) {
			if (s[i - 1] == 'R') {
				swap(st, en);
			} else if (s[i - 1] == 'A') {
				(add += A) %= C;
			} else {
				add = modMul(add, B);
				mul = modMul(mul, B);
			}
			LL rlt = (modMul(mul, a[st]) + add) % C;
			if (i > 1) printf(" ");
			printf("%lld", rlt);
			if (st < en) st++;
			else st--;
		}
		puts("");
	}
	
	return 0;
}