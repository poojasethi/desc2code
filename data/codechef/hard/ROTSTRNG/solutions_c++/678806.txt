#include <iostream>
#include <cstring>
#include <cstdio>
#define MAXN 500001

using namespace std;

char s[MAXN];
char m[MAXN << 1];

bool used[MAXN+1];
int p[MAXN], n;

void precmp()
{
int i, f;
p[0] = 0;
for(i=1; i<n; i++)     
{
f = p[i - 1];
while(f > 0 && s[f] != s[i]) f = p[f - 1];
if(s[f] == s[i]) p[i] = f + 1;
}
}

void calc()
{
int i, f = 0;
for(i=0; i<2*n; i++)     
{
while(f > 0 && s[f] != m[i]) f = p[f - 1];
if(s[f] == m[i]) ++f;
if(f == n) used[i - n + 1] = 1; 
}     
}

void search()
{
int s1, s2;
scanf("%d%d", &s1, &s2);

int i, start = 0;
for(i=0; i<2*n; i++)
{
if(i % 2) start = (start - s2 + n) % n;
else start = (start - s1 + n) % n; 
if(used[start]) { printf("%d\n", i+1); return; }
}
printf("-1\n");
}

void solve()
{
memset(used, 0, sizeof(used));
memset(p, 0, sizeof(p));
int i;

scanf("%s", &s);
n = strlen(s);
for(i=0; i<n; i++) m[i] = m[i + n] = s[i];

precmp();
calc();
search();
}

int main()
{
int t;
scanf("%d", &t);
for(; t; t--) solve();

//system("pause");
return 0;
}
