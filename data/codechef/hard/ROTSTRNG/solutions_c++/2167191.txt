#include<iostream>
#include<cstdio>
#include<cstring>
#include<string>
#include<cstdlib>
#include<vector>
#include<map>
#include<set>
#include<queue>
#include<stack>
#include<cmath>
#include<cctype>
#include<algorithm>
using namespace std;
#define pb push_back
#define mp make_pair
#define cin(n) scanint(n)
#define gc getchar_unlocked
void scanint(int &x){register int c = gc();x = 0;for(;(c<48 || c>57);c = gc());for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}}
char P[600001];
int T[600005];
void table(int n)
{	
  //for(int i=0;i<=n;i++)T[i]=-1;
  int cnd=0;
  int i=2;
  T[0]=-1;T[1]=0;
  for(;i<=n;)
  {
    if(P[i-1]==P[cnd])T[i++]=++cnd;
    else if (cnd>0) cnd=T[cnd];
    else T[i++]=0;
  }
}
int recur(int n)
{
  if(n==1)return 1;
  int x=T[n];
  if(x+x==n)return x;
  int y=n-x;
  if(y>x)return n;
  if(x%y!=0)return n;
	return y; 
// int temp=recur(x);
  //if(n%temp==0)return temp;
  //return n;
}
int main()
{
  int t,n,a,b,x,y,m;cin(t);
  while(t--){
    scanf("%s",P);
    n=strlen(P);
    //table(n);

  //for(int i=0;i<=n;i++)T[i]=-1;
  int cnd=0;
  int i=2;
  T[0]=-1;T[1]=0;
  for(;i<=n;)
  {
    if(P[i-1]==P[cnd])T[i++]=++cnd;
    else if (cnd>0) cnd=T[cnd];
    else T[i++]=0;
  }
int r; 	
if(n==1)r= 1;
  	else{
		int x=T[n];
  		if(x+x==n)r= x;
  		else{
			int y=n-x;
  			if(y>x||x%y!=0) r = n;
			else r =  y;
			}
		}

    cin(a);cin(b);
    int ans=0;
    for(i=1;i<=2*n;i++)
    {
      ans+=(i&1)?a:b;
      ans%=n;
      if(ans%r==0){printf("%d\n",i);goto mom;}
    }
	printf("-1\n");
	mom:;
  }
  return 0;
} 