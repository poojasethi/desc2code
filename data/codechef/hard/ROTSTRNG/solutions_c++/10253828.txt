#include<bits/stdc++.h>
 using namespace std;
#include<stdio.h>
#ifndef ONLINE_JUDGE
#define get getchar
#else
#define get getchar_unlocked
#endif
inline int f()
{
	int n=0,s=1;
	char p=get();
	if(p=='-')
		s=-1;
	while((p<'0' || p>'9') && p!=EOF && p!='-')
		p=get();
	if(p=='-')
		s=-1,p=get();
	while(p>='0' && p<='9' )
	{
		n=(n<<3)+(n<<1)+(p-'0');
		p=get();
	}
	return (n*s);
} 
int k,n,l,c,z,i,j;
char str[500005];
int rotate(int d)
	{
	i=d;
	if(i==0)
	return 0;
 
	if(str[d-1]!=str[l-1])
	return 1;
 
	for(k=i,j=0;k<l;k++,j++)
	if(!(str[k]==str[j]))
	 return 1;
	  if(i!=0)
	   for(k=0;k<=d-1;k++,j++)
		if(!(str[k]==str[j]))
		return 1;
	return 0;
	}
 
int main()
{
int t,m,p,v;
scanf("%d",&t);
 
while(t--)
{

scanf("%s%d%d",str,&m,&p);
l=strlen(str);
c=1;
z=1;
v=(0-m)%l;
if(v<0)
v=(l+v)%l;

while(rotate(v))
	{
	c++;
	if(z%2==1)
	{
	v=(v-p)%l;
	if(v<0)
    v=(l+v)%l;
	z++;
	}
	else
	{
	v=(v-m)%l;
	if(v<0)
    v=(l+v)%l;
    z++;
	}
	}
	printf("%d\n",c);
	}

} 