#include<iostream>
#include<cstring>
#include<map>
#include<vector>
#include<stack>
#include<cstdio>
#include<algorithm>


using namespace std;

int main()
{

  int t;
  scanf("%d",&t);
  for(int tt=0;tt<t;tt++)
    {
      //      string a;
      char a[511111];
      scanf("%s",a);

      int s1,s2;
      scanf("%d %d",&s1,&s2);

      int n=strlen(a);  // size/length of a: 

      int f[n];
      int x;  // temp var

      f[0]=-1;
      for(int i=1;i<n;i++)
	{
	  x=f[i-1];
	  while(x>=0&&a[x+1]!=a[i])
	    x=f[x];

	  if(a[i]==a[x+1])
	    f[i]=x+1;
	  else
	    f[i]=-1;
	}

      int now=(n-1-f[n-1]);

      if(n%now)
	now=n;


      int res=0;
      int cnt=0;
 
      for(int i=0;i<n;i++)
	{
	  cnt+=s1;
	  res++;
	  cnt%=now;
	  if(!cnt)
	    break;


	  cnt+=s2;
	  res++;
	  cnt%=now;
	  if(!cnt)
	    break;
	}

      if(cnt)
	printf("-1\n");
      else
      printf("%d\n",res);
    }

  return 0;
}
