#include <iostream>
#include <stdio.h>
#include <string.h>

#define MAXLEN 500001 
using namespace std;
char S[2*MAXLEN];
int FF[2*MAXLEN],len,idx;
bool got_it[MAXLEN];
int T,M,P;
int N;


/* run this program using the console pauser or add your own getch, system("pause") or input loop */


int main(int argc, char *argv[]) {
	scanf("%d",&T);
	while(T>0){
		scanf("%s %d %d",S,&M,&P);
		N = strlen(S);
		for(int i=0;i<N;i++){
			S[i+N] = S[i];
		}
		len = 0;
		idx = 1;
		got_it[0] = true;
		for(int i=1;i<N;i++){
			got_it[i] = false; 
		}
		FF[0] = 0;
		int idx_max = 2*N; 
		while( idx < idx_max ){
			while(len > 0 && S[len]!=S[idx])
				len = FF[len-1];
			if(S[len]==S[idx])
				++len;
			FF[idx] = len ;
			if(len==N){
				got_it[idx-N+1]=true;
				len = FF[len-1];
			}
			++idx;		
	    }
		
		int ans = 0, ind = 0, k;
		
		for(k=0;k<N;k++)
		{
			ind-=M; ans++; if(ind<0) ind+=N; if(got_it[ind]) break;
			ind-=P; ans++; if(ind<0) ind+=N; if(got_it[ind]) break;
		}

		if(k==N) ans= -1; // not reached !?!
		printf("%d\n",ans);
		--T;
	}
	return 0;
}
