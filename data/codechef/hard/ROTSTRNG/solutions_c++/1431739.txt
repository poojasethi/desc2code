    #include<stdio.h>
    #include<string.h>
    int start,end,len,answer,turn,i,j;
    char str[500001];
    int rotate(int a)
    {
     if((end-a)<0)
     end=end-a+len;
     else end=end-a;
     if(end+1==len)
     start=0;
     else start=end+1;
     //printf("%d\t%d\n",start,end);
     if(start==0)
     return 0;
     if(str[end]!=str[len-1])
     return 1;
     for(i=start,j=0;i<len;i++,j++)
     if(!(str[i]==str[j]))
     return 1;
     if(start!=0)
     for(i=0;i<=end;i++,j++)
     if(!(str[i]==str[j]))
     return 1;
     return 0;
    }
    
    int main()
    {
      int t,m,p,val;
      scanf("%d",&t);
      while(t--)
      {
        scanf("%s%d%d",str,&m,&p);
        answer=1;
        len=strlen(str);
        start=0;
        end=len-1;
        turn=1;
       // strcpy(buff,str);
        val=m;
        while(rotate(val))
        {
        answer++;
        if(turn==1)
        {
        turn=2;
        val=p;
        }
        else
        {
        turn=1;
        val=m;
        }
        }
        printf("%d\n",answer);
      }
      return 0;
    }
