#include<iostream>
#include<math.h>
#include<stdio.h>
#include<string.h>
#include<map>
using namespace std;
char a[500000]="";

int main(){
int m,n,p,t=0,i,r;
scanf("%d\n",&t);
while(t--){
i=1;
r=1;
gets(a);
scanf("%d",&m);scanf("%d\n",&p);
n=strlen(a);
int flag=0;

while(i+r<=n)
{
	if(strncmp(a,a+i,r)==0)
	{
		i=i+r;
		flag=1;
	}	
	else 
	{
		if(flag)
		{
			r=i+1;
			i++;
			flag=0;
		}
		else
		{	
			i++;
			r++;
		}	
	}
}
if(!(flag) || ((i)!=n) || (r>n/2))
r=n;
int count=0,j=0,k=0,l=0;
while(1){
count++;
if(k==0){ j=(j+m)%n;k=1;}
else {j=(j+p)%n;k=0;}
if(j%r==0) break;
}

printf("%d\n",count);
}
return 0;
}
