#include<bits/stdc++.h>
using namespace std;

//  GC

#define in(a) scanf("%d",&a)
#define inll(a) scanf("%lld",&a)
#define ins(a) scanf("%s",a)
#define out(a) printf("%d\n",a)
#define fo(i,n) for(i=0;i<n;i++)
#define mem(a,x) memset(a,x,sizeof(a))

char str[1000001];
bool check[1000001];
int lps[1000001];
	

int main()
{
	int t,m,p,i;
	
	in(t);
	
	while(t--)
	{
		ins(str);
		
		in(m);		in(p);

	
	int n=strlen(str);   int z=2*n;
	
	fo(i,n)
		str[n+i]=str[i];

	
	mem(check,false);		check[0]=1;
	
			
	int i=0,plen=0;
	
	lps[0]=0;		i=1;
	
	while(i<z)
	{
		if(str[i]==str[plen])
		{
			plen++;
			lps[i]=plen;

		}
		
		else
		{
			if(plen==0)
					lps[i]=0;   
			else
			{
				plen=lps[plen-1];
				continue;
			}
		}
		
		if(plen==n && (i+1)>n )
			check[(i+1)-n]=true;
		
		if(plen==n) plen=lps[plen-1];
		
		i++;
	}
	
	
		int idx=0,ans=0,l=n;
	
		for(i=0;i<l;i++)
		{
			idx-=m;	if(idx<0) idx+=l;	ans++;    if(check[idx])   break;
			idx-=p;	if(idx<0) idx+=l;	ans++;    if(check[idx])   break;
		}
		
		if(i==l)   ans=-1;
		
		out(ans);
		
	
	}
	
	return 0;
}
