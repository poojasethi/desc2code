#include<iostream>
#include<cstdio>
#include<cstring>
#include<string>
using namespace std;

bool visited[500001][2];
char inp[500001];
void prefixFunction(string s,bool req[]){
    int l=s.length();
    string P=s+s;
    int x[2*l],k=-1;
    x[0]=-1;
    for(int i=1;i<2*l;i++){
        while(k>=0 && P[k+1]!=P[i])
            k=x[k];
        if(P[k+1]==P[i]) k=k+1;
        x[i]=k;
        if(k==l-1){
            req[i-l+1]=true;
            k=x[k];
        }
    }
    //for(int i=0;i<2*l;i++) cout<<i<<" "<<x[i]<<endl;
}

int main(){
    int T,a,b;
    scanf("%d",&T);
    string str;
    while(T--){
        scanf("%s%d%d",inp,&a,&b);
        str=string(inp);
        int l=str.length();
        bool req[l+1];
        memset(req,false,sizeof(req));
        memset(visited,false,sizeof(visited));
        req[0]=true;
        prefixFunction(str,req);
        //for(int i=0;i<l;i++) cout<<i<<" "<<req[i]<<endl;
        int pos=0,cnt=0;
        while(true){
            cnt++;
            pos=(pos+l-a)%l;
            if(visited[pos][0]){
                printf("-1\n");
                break;
            }
            else visited[pos][0]=true;
            if(req[pos]){
                printf("%d\n",cnt);
                break;
            }
            cnt++;
            pos=(pos+l-b)%l;
            if(visited[pos][1]){
                printf("-1\n");
                break;
            }
            else visited[pos][1]=true;
            if(req[pos]){
                printf("%d\n",cnt);
                break;
            }
        }
    }
    return 0;
}
