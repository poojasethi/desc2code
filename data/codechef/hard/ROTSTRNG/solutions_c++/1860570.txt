#include <cmath>
#include <iostream>
#include <algorithm>
#include <cstring>
#include <map>
using namespace std;
 
char buf[500005];
int p[500005];
 
int kmp(){
	p[0] = -1;
	int cur = -1;
	for (int i=1; buf[i]; i++){
		while (cur != -1 && buf[cur+1] != buf[i]){
			cur = p[cur];
		}
		if (buf[cur+1] == buf[i]){
			cur++;
		}
		p[i] = cur;
	}
	return cur+1;
}
 
int main(){
	int T;
	scanf("%d", &T);
	for (int I=0; I<T; I++){
		scanf("%s", buf);
		int m, p;
		scanf("%d%d", &m, &p);
		int n = strlen(buf);
		int v = kmp();
		if (n % (n - v) == 0){
			n = n-v;
		}
		p %= n;
		m %= n;
		int ret = 1, q = m, it = 1;
		while (q != 0){
			if (it & 1){
				q += p;
			} else {
				q += m;
			}
			it ^= 1;
			ret++;
			if (q >= n){
				q -= n;
			}
		}
		printf("%d\n", ret);
	}
	return 0;
}