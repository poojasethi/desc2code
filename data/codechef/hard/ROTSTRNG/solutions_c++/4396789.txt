#include <iostream>
#include <stdio.h>
#include <string.h>
#include <algorithm>
#include <utility>
#include <vector>
#include <queue>

#define sz 500009

using namespace std;

typedef long long ll;

char ch[2*sz];
int len;
int M,P;
int fail[2*sz];
bool flag[2*sz];

int main() {
	int t; scanf("%d",&t);
	while(t--) {
		scanf("%s%d%d",ch,&M,&P);
		int len = strlen(ch);
		for(int i=0;i<=len;i++) ch[len+i] = ch[i];
		int N = 2*len;
		for(int i=1;i<N;i++) flag[i] = false;
		flag[0] = true;
		fail[0] = -1; fail[1] = 0;
		int pos = 2;
		int c = 0;
		while(pos < N) {
			if(ch[pos-1] == ch[c]) {
				c++;
				fail[pos] = c;
				if(pos > len && c == len) {
					flag[pos-len] = true;
				}
				pos++;
			} else if(c > 0) c = fail[c];
			else {
				fail[pos] = 0; pos++;
			}
			if(c == len) {
				c = fail[c];
			}
		}
		int ind=0;
		int ans = 0;
		while(true) {
			ans++;
			ind -= M; if(ind < 0) ind += len; if(flag[ind]) break;
			ans++;
			ind -= P; if(ind < 0) ind += len; if(flag[ind]) break;
		}
		printf("%d\n",ans);
	}
	return 0;
}