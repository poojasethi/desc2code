#include<bits/stdc++.h>
using namespace std ;
typedef long long ll ;
 
set< int > my_set1 , my_set2 ;
vector< pair<int,int> > mp ;
int main() {
 
	cin.sync_with_stdio(false) ;
    ll q , x , y , n ;
    ll ans = 0 ;
 
    cin >> q ;
    char ch ;
    while( q-- ) {
        cin >> ch  ;
        if( ch == '+') {
            cin >> x >> y ;
            x = x^ans ;
            y = y^ans ;
            mp.push_back( make_pair(x,y) ) ;
            my_set1.insert( x+y ) ;
            my_set2.insert( x-y ) ;
        }
        else if( ch == '-') {
            cin >> n ;
            n = n^ans ;
            my_set1.erase(mp[n-1].first+mp[n-1].second) ;
            my_set2.erase(mp[n-1].first-mp[n-1].second) ;
        }
        else {
            cin >> x >> y ;
            x ^= ans ;
            y ^= ans ;
	    int a = x+y , b = x-y , c1 = my_set1.size() , c2 = my_set2.size() ; 
	    int dist = max( max( abs(*(my_set1.begin())-a) , abs(*(my_set1.rbegin())-a) )  , max( abs(*(my_set2.begin())-b) , abs(*(my_set2.rbegin())-b) ) )  ;
            ans = dist ;
            cout << ans << endl ;
            
        }
 
    }
 
    return 0 ;
}