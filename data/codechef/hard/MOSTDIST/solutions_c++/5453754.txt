#include <map>
#include <set>
#include <list>
#include <cmath>
#include <ctime>
#include <deque>
#include <queue>
#include <stack>
#include <bitset>
#include <cstdio>
#include <locale>
#include <vector>
#include <cassert>
#include <climits>
#include <complex>
#include <cstdlib>
#include <cstring>
#include <fstream>
#include <iomanip>
#include <numeric>
#include <sstream>
#include <utility>
#include <iostream>
#include <iterator>
#include <typeinfo>
#include <valarray>
#include <algorithm>
#include <functional>

#define xx first
#define yy second
#define LL long long
#define inf 100000000
#define pb push_back
#define all(v) v.begin(),v.end()
#define pi acos(-1)
#define clr(a,b) memset(a,b,sizeof a)
#define bclr(a) memset(a,false,sizeof a)
#define pii pair<int,int>
#define MOD 1000000007
#define EPS 1e-16
#define MP make_pair
#define MX 500005

using namespace std;
set<pii>S[5];
bool chk[MX];
pii P[MX];
char s[5];

int main(){
    int n,id=1,ans=0;
    scanf("%d",&n);
    for(int i=0;i<n;i++){
        scanf("%s",s);
        if(s[0]=='+'){
            int x,y;
            scanf("%d%d",&x,&y);
            x^=ans,y^=ans;
            P[id]=MP(x,y);
            S[0].insert(MP(x+y,id));
            S[1].insert(MP(x-y,id));
            S[2].insert(MP(-x+y,id));
            S[3].insert(MP(-x-y,id));
            id++;
        }
        else if(s[0]=='-'){
            int d;
            scanf("%d",&d);
            d^=ans;
            if(d>=1 && d<id && !chk[d]){
                chk[d]=true;
                int x=P[d].xx,y=P[d].yy;
                S[0].erase(MP(x+y,d));
                S[1].erase(MP(x-y,d));
                S[2].erase(MP(-x+y,d));
                S[3].erase(MP(-x-y,d));
            }
        }
        else{
            int x,y;
            scanf("%d%d",&x,&y);
            x^=ans,y^=ans;
            int res=0;
            set<pii>::iterator it;
            it=S[0].begin();
            res=max(res,abs((*it).xx-(x+y)));
            it=S[1].begin();
            res=max(res,abs((*it).xx-(x-y)));
            it=S[2].begin();
            res=max(res,abs((*it).xx-(-x+y)));
            it=S[3].begin();
            res=max(res,abs((*it).xx-(-x-y)));
            printf("%d\n",res);
            ans=res;
        }
    }
    return 0;
}
