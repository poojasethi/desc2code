//Mostdist.c
#include <stdio.h>
#include <vector>
#include <iostream>
#include <queue>
#include <set>
#include <algorithm>
#include <math.h>
#include <string>
#include <cstring>
#include <functional>
using namespace std;
//Input macros
#define si(n) scanf("%d",&n)
#define sc(n) scanf("%c",&n);
#define sl(n) scanf("%lld",&n)
#define sf(n) scanf("%lf",&n)
#define ss(n) scanf("%s",n)
#define mem(a,b) memset(a,b,sizeof(a))
#define f(i,a,b) for(ll i=a;i<=b;i++)
#define frev(i,a,b) for(ll i=a;i>=b;i--)
#define maX(a,b) ((a)>(b)?a:b)
#define miN(a,b) ((a)<(b)?a:b)
#define ll long long
#define pb push_back

typedef pair<ll,ll> ii;
typedef pair<ll,ii> iii;
vector<ii> v;
set<ii> s;
priority_queue<iii,vector<iii>,greater<iii> >  h1,h2,h3,h4;
int main()
{
	ll q,ans=0,m;
	ll x,y,n,xn,yn,nn,px,py,f1,f2,f3,f4;
	char c;
	sl(q);
	sc(c);
	while(q--)
	{
		sc(c);
		if(c=='+')
		{
			sl(xn);sl(yn);
			sc(c);
			//printf("x=%lld y=%lld\n",xn,yn);
			x=xn^ans;
			y=yn^ans;
			//printf("x=%lld y=%lld\n",x,y);
			v.pb(ii(x,y));
			s.insert(ii(x,y));
			h1.push(iii(x+y,ii(x,y)));
			//printf("h=%lld\n",h1.top().first);
			h2.push(iii(-x+y,ii(x,y)));
			//printf("h=%lld\n",h2.top().first);
			h3.push(iii(x-y,ii(x,y)));
			//printf("h=%lld\n",h3.top().first);
			h4.push(iii(-x-y,ii(x,y)));
			//printf("h=%lld\n",h4.top().first);
		}
		else if(c=='-'){
			sl(nn);sc(c);
			n=nn^ans;
			//printf("n=%lld\n",n);
			ii k=v[n-1];
			s.erase(ii(k.first,k.second));
		}
		else
		{
			sl(xn);sl(yn);
			sc(c);
			px=xn^ans;
			py=yn^ans;
			f1=px+py;
			f2=-px+py;
			f3=px-py;
			f4=-px-py;
			m=0;
			iii u=h1.top();
			while(s.find(ii(u.second.first,u.second.second))==s.end()){
				h1.pop();
				u=h1.top();
			}
			m=max(m,f1-u.first);
			u=h2.top();
			while(s.find(ii(u.second.first,u.second.second))==s.end()){
				h2.pop();
				u=h2.top();
			}
			m=max(m,f2-u.first);
			u=h3.top();
			while(s.find(ii(u.second.first,u.second.second))==s.end()){
				h3.pop();
				u=h3.top();
			}
			m=max(m,f3-u.first);
			u=h4.top();
			while(s.find(ii(u.second.first,u.second.second))==s.end()){
				h4.pop();
				u=h4.top();
			}
			m=max(m,f4-u.first);
			ans=m;
			printf("%lld\n",m);
		}
	}
	return 0;
}