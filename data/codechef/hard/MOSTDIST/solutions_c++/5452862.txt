#include <bits/stdc++.h>
#define LL long long
using namespace std;

bool mark[500001];
int main()
{
    int q,n,m=1;
    scanf("%d",&q);
    priority_queue<pair<int,int> > p1,p2,p3,p4;
    char qr[5];
    LL ans=0,x,y,d1,d2,d3,d4;
    while(q--)
    {
        scanf("%s",qr);
        if(qr[0]=='+')
        {
            scanf("%lld %lld",&x,&y);
            x=x^ans;
            y=y^ans;
            p1.push(make_pair(x+y,m));
            p2.push(make_pair(x-y,m));
            p3.push(make_pair(-x+y,m));
            p4.push(make_pair(-x-y,m));
            m++;
        }
        else if(qr[0]=='-')
        {
            scanf("%d",&n);
            n=n^ans;
            mark[n]=1;
        }
        else if(qr[0]=='?')
        {
            scanf("%d %d",&x,&y);
            x=x^ans;
            y=y^ans;
            while(!p1.empty() && mark[p1.top().second]) p1.pop();
            d1=p1.top().first;
            d1=d1-x-y;
            while(!p2.empty() && mark[p2.top().second]) p2.pop();
            d2=p2.top().first;
            d2=d2-x+y;
            while(!p3.empty() && mark[p3.top().second]) p3.pop();
            d3=p3.top().first;
            d3=d3+x-y;
            while(!p4.empty() && mark[p4.top().second]) p4.pop();
            d4=p4.top().first;
            d4=d4+x+y;
            ans=max(max(d1,d2),max(d3,d4));
            printf("%lld\n",ans);
        }
    }
    return 0;
}
