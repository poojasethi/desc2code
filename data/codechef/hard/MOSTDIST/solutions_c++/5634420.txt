#include <bits/stdc++.h>
using namespace std;
#define REP(a, b, c) for(int a = b; a < c; a++)
#define asd(x)              cout<<__LINE__<<" :: "<<#x<< ": "<<x<<endl;
#define asdf(x, y)          cout<<__LINE__<<" :: "<<#x<< ": "<<x<<" | "<<#y<< ": "<<y<<endl;
typedef long long LL;
typedef pair<int, int> ii;

set<ii> A, B;
ii ff[500005];
int main(){

    int q, x, y, ans = 0, cnt = 1; char c;
    scanf("%d\n", &q);
    REP(i, 1, q+1){
        scanf("%c", &c);
        if(c == '+'){
            scanf("%d %d\n", &x, &y);
            x ^= ans, y ^= ans;
            A.insert(ii(x + y, cnt));
            B.insert(ii(x - y, cnt));
            ff[cnt++] = ii(x, y);
        }
        else if(c == '-'){
            scanf("%d\n", &x);
            x ^= ans, y ^= ans;
            A.erase(ii(ff[x].first + ff[x].second, x));
            B.erase(ii(ff[x].first - ff[x].second, x));
        }
        else{
            scanf("%d %d\n", &x, &y);
            x ^= ans, y ^= ans;
            int here = 0;
            here = max(here, x + y - (*A.begin()).first);
            here = max(here, x - y - (*B.begin()).first);
            here = max(here, y - x + (*--B.end()).first);
            here = max(here,-(y+x) + (*--A.end()).first);
            ans = here;
            printf("%d\n", ans);
        }
    }

    return 0;
}
