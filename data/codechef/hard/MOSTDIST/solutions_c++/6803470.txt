
#include<bits/stdc++.h>
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define pl(n) printf("%lld\n",n)
#define p(n) printf("%d\n",n)
#define pb push_back
#define mp make_pair
#define N 100005
#define LN 25
#define ll  long long
using namespace std;
ll minvalue=-(ll)1e15;
 pair<ll,ll>query[5*N];
 multiset<ll>m1,m2,m3,m4;
 multiset<ll>::iterator it1,it2,it3,it4;
int main()
{
int q,i,j;
 ll xx,yy;
 ll ans=0;
 s(q);
 char op;
 int add=1;
 for(i=1;i<=q;++i)
 {
  scanf(" %c",&op);
  if(op=='+')
  {
   sl(xx);sl(yy);
   xx=xx^ans;
   yy=yy^ans;
   query[add++]=make_pair(xx,yy);
   m1.insert(xx+yy);
   m2.insert(xx-yy);
   m3.insert(-xx-yy);
   m4.insert(-xx+yy);
  }
  else if(op=='-')
  {
    sl(xx);
    xx=xx^ans;
    ll qx=query[xx].first;
    ll qy=query[xx].second;
    m1.erase(qx+qy);
    m2.erase(qx-qy);
    m3.erase(-qx-qy);
    m4.erase(-qx+qy);
  }
  else
  {
   sl(xx);sl(yy);
   xx=xx^ans;
   yy=yy^ans;
   ll qx=xx+yy;
   ll qy=xx-yy;
   it1=m1.begin();
   it2=m2.begin();
   it3=m3.begin();
   it4=m4.begin();
   ll minx=*it1;
   ll miny=*it2;
   ll maxx=*it3;
   maxx=maxx*-1;
   ll maxy=*it4;
   maxy=maxy*-1;
   //cout<<minx<<" "<<miny<<" "<<maxx<<" "<<maxy<<endl;
   ans=max(max(abs(qx-minx),abs(qx-maxx)),max(abs(qy-maxy),abs(qy-miny)));
   printf("%lld\n",ans);
  }
 }
 return 0;
}
