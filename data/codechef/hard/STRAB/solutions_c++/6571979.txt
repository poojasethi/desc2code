#include<bits/stdc++.h>
using namespace std;
  int n,m,low,high,t,mask,j,prev,i,c;  int mod=1000000007; string s1,s2;
  int dp[22];
int cal()
{    dp[0]=1; 
     for(i=1;i<=n;i++)
     {  
      c=0;  dp[i]=0; 
         if(i<m)
           {  dp[i]=1<<i; continue;}
         
         for(mask=0;mask<(1<<i);mask++) 
         {   c=1;
            for(j=0;j<=i-m;j++)
            {
                  int cur=(mask>>j)%(1<<m);
                  if(cur>=low&&cur<=high)
                   {  c=0;  break;}
                     
            }
            dp[i]+=c; dp[i]%=mod;  
         } 
              
     }
         // for(i=1;i<=n;i++)
        //    cout<<dp[i]<<"\n";
         long long ans2=0,ans; 
     for(mask=0;mask<(1<<n);mask++)
     {  c=0;   prev=-1;  ans=1;
        for(i=0;i<n;i++)
        {
            if((mask & (1 << i)) != 0)
            {
                c++;
                
                ans=ans*dp[i-prev-1];
                ans%=mod;
                prev=i;
            }
        }
                ans=ans*dp[n-prev-1];
                ans%=mod;  
           for(i=1;i<=c;i++)  { ans=ans*24; ans%=mod;}
             ans2+=ans; ans2%=mod;
     }
       return ans2;
}

int main()
{
   scanf("%d",&t);
   while(t--)
   {
     scanf("%d%d",&n,&m);
      cin>>s1;
      cin>>s2;
      low=0;
      for(i=m-1;i>=0;i--)
       low=low|((s1[i]=='B')<<m-i-1);
       
       high=0;
      for(i=m-1;i>=0;i--)
       high=high|((s2[i]=='B')<<m-i-1);
       printf("%d\n",cal());
   }
       
}//798982915