#include<bits/stdtr1c++.h>

using namespace std;


typedef long long LL;

const LL mod=(1e9 + 7);
LL POW(LL b,LL p)
{
	LL ret=1;
	for(int i=0;i<p;i++)
	{
		ret*=b;
		ret%=mod;
	}
	return ret;
}

LL conv(string s)
{
	LL ret=0;
	reverse(s.begin(),s.end());
	for(int i=0;i<s.size();i++)
	{
		if(s[i]=='B')
			ret|=(1ll<<i);
	}
	return ret;
}

int siz[(1<<20) +10];

void init()
{
	for(int i=0;i<(1<<20);i++)
	{
		for(int j=0;j<=20;j++)
		{
			if(i&(1<<j))
				siz[i]=j;
		}
	}
}
int n,m;
LL a,b;
LL dp[20][(1<<20)];
LL solve(int ind,int mask)
{
	if(ind==n)
		return 0;
	LL &ret=dp[ind][mask];
	if(ret!=-1)
		return ret;
	ret=0;

	ret=(24ll*solve(ind+1,0)%mod)%mod;
	for(int i=0;i<2;i++)
	{
		int t=mask;
		int c;
		int sz=siz[t];
		if(sz!=m)
			sz++;

		t=mask%(1<<m);
		t<<=1;
		t%=(1<<m);
		t|=i;
		c=t;
		t|=(1<<(sz));

		if(c>=a && c<=b && sz==m){
			ret+=POW(26,n-ind-1);
			ret%=mod;
			continue;
		}
		ret+=solve(ind+1,t)%mod;
		ret%=mod;
	}
	return ret;
}
int main()
{
    #ifndef ONLINE_JUDGE
        freopen("2.in","r",stdin);
		//freopen("2.out","w",stdout);
    #endif // ONLINE_JUDGE
    
    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

    int tc;
    cin>> tc;
    init();
    string s;
    while(tc--)
    {
    	cin>>n>>m>>s;
    	a=0,b=0;
    	a=conv(s);
    	cin>>s;
    	b=conv(s);

    	LL ret=POW(26,n);
    	memset(dp,-1,sizeof dp);
    	cout<<((ret-solve(0,0))%mod+mod)%mod<<endl;
    }
    return 0;
    
}
