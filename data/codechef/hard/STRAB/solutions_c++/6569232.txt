#include<bits/stdtr1c++.h>

using namespace std;


typedef long long LL;

const LL mod=(1e9 + 7);
LL POW(LL b,LL p)
{
	LL ret=1;
	for(int i=0;i<p;i++)
	{
		ret*=b;
		ret%=mod;
	}
	return ret;
}

LL conv(string s)
{
	LL ret=0;
	reverse(s.begin(),s.end());
	for(int i=0;i<s.size();i++)
	{
		if(s[i]=='B')
			ret|=(1ll<<i);
	}
	return ret;
}


int n,m;
LL a,b;
int dp[19*20*(1<<19)];
LL solve(int ind,int last,int mask)
{
	if(ind==n)
		return 0;
	LL state=ind*(20ll*(1ll<<19))+ last*(1ll<<19)+ mask;
	if(dp[state]!=-1)
		return dp[state];
	LL ret=0;

	ret=(24ll*solve(ind+1,ind+1,0)%mod)%mod;
	for(int i=0;i<2;i++)
	{
		int h=last;

		int t=mask;
		t<<=1;
		t%=(1<<(m));
		t|=i;
		int k=0;
		if(t>=a && t<=b && (ind+1-last)==m){
			ret+=POW(26,n-ind-1);
			ret%=mod;
			continue;
		}
		if((ind+1-last)==m)
			h++;
		ret+=solve(ind+1,h,t)%mod;
		ret%=mod;
	}
	return dp[state]=ret;
}
int main()
{
    #ifndef ONLINE_JUDGE
        freopen("2.in","r",stdin);
		//freopen("2.out","w",stdout);
    #endif // ONLINE_JUDGE
    
    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

    int tc;
    cin>> tc;

    string s;
    while(tc--)
    {
    	cin>>n>>m>>s;
    	a=0,b=0;
    	a=conv(s);
    	cin>>s;
    	b=conv(s);

    	LL ret=POW(26,n);
    	memset(dp,-1,sizeof dp);
    	cout<<((ret-solve(0,0,0))%mod+mod)%mod<<endl;
    }
    return 0;
    
}
