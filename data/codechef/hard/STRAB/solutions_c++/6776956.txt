#include <bits/stdc++.h>
#define mod 1000000007
using namespace std;

long long int dp[25][1<<20],dp1[25][25];
int main()
{
    int test,n,m,i,j,x,y;
    long long int t;
    string a,b;
    scanf("%d",&test);
    while(test--)
    {
        memset(dp,0,sizeof(dp));
        memset(dp1,0,sizeof(dp1));
        scanf("%d%d",&n,&m);
        cin>>a>>b;
        x=0;y=0;
        for(i=m-1,j=0;i>=0;i--,j++)
        {
            if(a[i]=='B')
                x=x+(1<<j);
            if(b[i]=='B')
                y=y+(1<<j);
        }
        dp1[0][0]=1;
        if(0>=m-1)
            dp[0][0]=dp1[0][0];
        for(i=1;i<=n;i++)
        {
            for(j=0;j<m-1;j++)
            {
                dp1[i][0]=(dp1[i][0]+dp1[i-1][j]*24)%mod;
                dp1[i][j+1]=(dp1[i][j+1]+dp1[i-1][j]*2)%mod;
            }
            for(j=0;j<(1<<(m-1));j++)
            {
                dp1[i][0]=(dp1[i][0]+dp[i-1][j]*24)%mod;
                t=j;
                t=t<<1;
                if(t<x||t>y)
                {
                    t=t&~(1<<(m-1));
                    dp[i][t]=(dp[i][t]+dp[i-1][j])%mod;
                }
                t=j;
                t=2*t+1;
                if(t<x||t>y)
                {
                    t=t&~(1<<(m-1));
                    dp[i][t]=(dp[i][t]+dp[i-1][j])%mod;
                }
                if(i>=m-1)
                    dp[i][j]=(dp[i][j]+dp1[i-(m-1)][0])%mod;
            }
        }
        long long int ans;
        ans=0;
        for(j=0;j<(1<<(m-1));j++)
            ans=(ans+dp[n][j])%mod;
        for(j=0;j<m-1;j++)
            ans=(ans+dp1[n][j])%mod;
        printf("%lld\n",ans);
    }
    return 0;
}
