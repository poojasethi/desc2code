#include <bits/stdc++.h>
using namespace std;
#define h 1000000007
#define l long long int
char S[20];
int n,m,i,j,x,y,t,b;
l mem[20],ans[20],tt;
void ax(int s,int a)
{
    b=a&((1<<m)-1);
    if(s>=m && b>=x && b<=y)return;
    mem[s]++;
    if(mem[s]>h) mem[s]-=h;
    if(s>=n)return;
    a<<=1;
    ax(s+1,a);
    ax(s+1,a+1);
}
int main()
{
 scanf("%d",&t);
 while(t--)
 {
  scanf("%d%d%s",&n,&m,&S);
  for(x=y=i=0;i<=n;)mem[i]=ans[i++]=0;
  for(i=0;i<m;x=x+S[i++]-'A')x<<=1;
  scanf("%s",&S);
  for(i=0;i<m;y=y+S[i++]-'A')y<<=1;
  ax(0,0);
  for(ans[0]=i=1;i<=n;++i)
  {
   ans[i]=ans[i-1]*24+mem[i];
   if(ans[i]>h) ans[i]-=h;
   for(j=1;j<i;ans[i]%=h,++j)
   {
    tt=mem[j]*24%h;
    tt*=ans[i-1-j];
    ans[i]=(ans[i]+tt)%h;
   }
  }
  printf("%lld\n",ans[n]);
 }
}