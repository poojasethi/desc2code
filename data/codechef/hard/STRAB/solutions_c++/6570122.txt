#include<bits/stdc++.h>
#define s(n) scanf("%d",&n)
#define sl(n) scanf("%lld",&n)
#define p(n) printf("%d\n",n)
#define mod 1000000007LL
#define ll long long
#define pb push_back
#define mp make_pair
#define N 100011
#define LN 21
using namespace std;
/*int bit[2*N],maxval,bit1[2*N],maxval1,bit2[2*N],bit3[2*N];*/
ll powmod(ll a,ll b,ll c)
{
 ll res=1LL;
 while(b>0)
 {
  if(b&1)
  res=(res*a)%c;
  a=(a*a)%c;
  b/=2;
 }
 return res;
}
/*ll inverse(ll a,ll MOD)
{
if(a==0)
return 1LL;
else
return powmod(a,MOD-2,MOD);
}
void update(int idx,int val)
{
 while(idx<=maxval)
 {
  bit[idx]+=val;
  idx+=(idx & -idx);
 }
}
int query(int idx)
{
 int sum=0;
 while(idx>0)
 {
   sum+=bit[idx];
   idx-=(idx & -idx);
 }
 return sum;
}
ll fact[400005];


ll ncr(int n,int r)
{
 ll num=fact[n];
 ll den=(fact[r]*fact[n-r])%mod;
 ll ans=(num*inverse(den,mod))%mod;
 return ans;
}*/
int m;
ll m1,m2;
ll dp[20][1<<20];
ll ways(int id,int mask,int n)
{
 //cout<<id<<" "<<mask<<endl;
 if((mask>=m2) && (mask<=m1) && (id>=m))
 return 0;
 if(id==n)
 return 1;
 else
 {
 if(id>=m)
 if(mask&(1<<(m-1)))
 mask-=(1<<(m-1));
 ll ans=ways(id+1,mask*2+1,n)+ways(id+1,mask*2,n);
 ans%=mod;
 return ans;
 }
}
int main()
{
 int t,i,j,n,k;
 string s1,s2;
 cin>>t;
 while(t--)
 {
 s(n);s(m);
 cin>>s1>>s2;
  if(n<m)
  cout<<powmod(26LL,n*1LL,mod)<<endl;
  else
  {
   m1=m2=0;
  for(i=m-1;i>=0;--i)
  {
   if(s1[i]=='A')
   m1+=(1<<(m-i-1));
   if(s2[i]=='A')
   m2+=(1<<(m-i-1));
  }
  ll dp2[27];
   memset(dp2,0,sizeof(dp2));
  //cout<<m1<<" "<<m2<<endl;
     dp2[0]=1;
     for(k=1;k<=n;++k)
     dp2[k]=ways(0,0,k);

   //cout<<ans<<endl;


   /*for(i=1;i<=n;++i)
   cout<<dp2[i]<<endl;*/
   ll dp1[27];
   dp1[0]=24;
   ll ans=dp2[n];
   for(i=1;i<n;++i)
   {
    dp1[i]=24*dp2[i];
    for(j=0;j<i;++j)
    {
     int mid=(i-j-1);
     dp1[i]+=dp1[j]*dp2[mid]*24;
     dp1[i]%=mod;
     //cout<<i<<" "<<dp1[i]<<endl;
    }
   }
   for(i=0;i<n;++i)
   {
    int mid=(n-i-1);
    ans+=dp1[i]*(dp2[mid]);
    ans%=mod;
   }
   cout<<ans<<endl;
  }
 }
 return 0;
}
