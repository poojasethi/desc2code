#include <bits/stdc++.h>
using namespace std;
#define h 1000000007
#define l long long int
char S[20];
int n,m,i,j,x,y,t,b;
l mem[20],ans[20];
void ax(int s,int a)
{
    b=a&((1<<m)-1);
    if(b>=x && b<=y && s>=m)return;
    mem[s]=(mem[s]+1)%h;
    if(s>=n)return;
    a<<=1;
    ax(s+1,a);
    ax(s+1,a+1);
}
int main()
{
 scanf("%d",&t);
 while(t--)
 {
  scanf("%d%d%s",&n,&m,&S);
  for(x=y=i=0;i<=n;)mem[i]=ans[i++]=0;
  for(i=0;i<m;x+=(S[i++]-'A'))x<<=1;
  scanf("%s",&S);
  for(i=0;i<m;y+=(S[i++]-'A'))y<<=1;
  ax(0,0);
  for(ans[0]=i=1;i<=n;++i)
   for(ans[i]=ans[i-1]*24%h+mem[i],ans[i]%=h,j=1;j<i;ans[i]%=h,++j)
    ans[i]=ans[i]+mem[j]*24%h*ans[i-1-j]%h;
  printf("%lld\n",ans[n]);
 }
}