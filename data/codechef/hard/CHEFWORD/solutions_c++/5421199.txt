#include<iostream>
#include<cstdio>
#include<cmath>
#include<cstring>
#include<cstdlib>
#include<iomanip>
#include <limits>
#include<set>
typedef std::numeric_limits< double > dbl;
using namespace std;
double **mul(double **a,double **b);
double **pw(double **a,long long b,double **p)
{
int i;    
if(b==0)
return p;
double **c;
c=pw(a,b/2,p);
if(b&1)
return mul(mul(c,c),a);
else
return mul(c,c);
}
double **mul(double *a[26],double *b[26])
{
int i,j,k;
double **c;
c=(double **)malloc(26*sizeof(double *));
for(i=0;i<26;i++)
c[i]=(double *)malloc(26*sizeof(double));
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
c[i][j]=0;    
for(k=0;k<26;k++)
{
c[i][j]+=(a[i][k]*b[k][j]);    
}
}
}
return c;
}
int main()
{
int i,j,t,n;
long long k;
cin>>t;
while(t--)
{
char str[4];
cin>>n;
cin>>k;
cin>>str;
double **matrix;
matrix=(double **)malloc(26*sizeof(double *));
for(i=0;i<26;i++)
matrix[i]=(double *)malloc(26*sizeof(double));
double **p;
p=(double **)malloc(26*sizeof(double *));
for(i=0;i<26;i++)
p[i]=(double *)malloc(26*sizeof(double));
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
cin>>matrix[i][j];
}
double **ans;
ans=(double **)malloc(26*sizeof(double *));
for(i=0;i<26;i++)
ans[i]=(double *)malloc(26*sizeof(double));
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
if(i==j)
p[i][j]=1.0;
else
p[i][j]=0.0;
}//cout<<endl;
}
ans=pw(matrix,k,p);
/*for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
cout<<ans[i][j]<<" ";
cout<<endl;
}*/
double answer=0.0;
set<string>s1;
while(n--)
{
char temp[4];
double tem=1.0000000000000;
scanf("%s\n",temp);
if(strlen(temp)!=strlen(str))
continue;
if(s1.find(temp)!=s1.end())
continue;
s1.insert(temp);
for(i=0;i<strlen(str);i++)
{
tem=tem*ans[str[i]-'a'][temp[i]-'a'];
}
answer+=tem;
}
printf("%0.12f\n",answer);
}
return 0;
}  