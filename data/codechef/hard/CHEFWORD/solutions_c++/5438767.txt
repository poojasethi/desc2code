#include<cstdio>
#include<iostream>
#include<cstring>
#include<algorithm>
#include<map>
#include<string>
using namespace std;
 int mi(int a,int b)
{
return (a<b)?a:b;
}

int main()
{
int t,i,j,p;
char s[4],f[4];
map<string,int>w;
long long int n,k;
scanf("%d",&t);
double a[26][26],c[26][26],ma,sum;
/*double a[26][26]={{0.25,0.25,0.25,0.25,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0.50,0.50,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{0.1,0.9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},{1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0}};*/
while(t--)
{
double b[26][26]={0};
w.clear();
scanf("%lld%lld",&n,&k);
cin>>s;
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
scanf("%lf",&a[i][j]);
}
for(i=0;i<26;i++)
{
b[i][i]=1.0;
}

while(k>0)
{
if(k%2==0)
{
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
c[i][j]=0;
for(p=0;p<26;p++)
{
c[i][j]=c[i][j]+(a[i][p]*a[p][j]);
}
}
}
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
a[i][j]=c[i][j];
}
}
k=k/2;
}
else
{
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
c[i][j]=0;
for(p=0;p<26;p++)
{
c[i][j]=c[i][j]+(a[i][p]*b[p][j]);
}
}
}
for(i=0;i<26;i++)
{
for(j=0;j<26;j++)
{
b[i][j]=c[i][j];
}
}

k=k-1;
}
}
ma=0.0;
while(n--)
{
   sum=1.0;
   cin>>f;
   if(strlen(s)==strlen(f)&&!w[f])
    {
        w[f]=1;
   for(i=0;i<strlen(s);i++)
    {
        sum=sum*b[s[i]-'a'][f[i]-'a'];
     }
   ma=ma+sum;
     }
}
printf("%lf\n",ma);
}
return 0;
}

