/* HellGeek */
/* Shiva Bhalla */
/* iit2012077 */
 
#include<stdio.h>
#include<vector>
#include<map>
#include<utility>
#include<algorithm>
#include<set>
#include<string>
#include<string.h>
#include<time.h>
#include<iostream>
#include<queue>
#include<stack>
#include<math.h>

#define LL long long
#define FIT(i,t) for(i=0;i<t;i++)
#define FIN(i,n) for(i=0;i<n;i++)
#define FJT(j,t) for(j=0;j<t;j++)
#define FJN(j,n) for(j=0;j<n;j++)
#define MAX2(a,b) a>b?a:b
#define MIN2(a,b) a>b?b:a
#define REP(i,a,b) for(i=a;i<=b;i++)

using namespace std;

double prob[27][27];
int k;
char str[5];
char mat[100005][5];
string ar[100005];
bool ma[20000];

void mat_mult(double M1[27][27], double M2[27][27]) {
     
     double M3[27][27];
     
     int i,j,l,m,n;
     
     for(i=0;i<26;i++) {
                       for(j=0;j<26;j++) {
                                         M3[i][j] = 0;
                                         for(l=0;l<26;l++) {
                                                           M3[i][j] = M3[i][j] + M1[i][l]*M2[l][j];
                                         }
                       }
     }
     
     for(i=0;i<26;i++)
     for(j=0;j<26;j++)
     M1[i][j] = M3[i][j];
}

/*void mat_exp ( double F[27][27] , int n) {
     if(n==0 || n==1)
     return ;
     mat_exp(F,n/2);
     mat_mult(F,F);
     if(n%2==1)
     mat_mult(F,prob);
}*/

void mat_exp(double F[27][27], int n) {
     int i,j,l;
     
     while(n>0) {
                if(n%2!=0) {
                           mat_mult(F,prob);
                }
                n=n/2;
                mat_mult(prob,prob);
     }
}
     
     

int main()
{
    int i,j,l,n,m,t;
    scanf("%d",&t);
    double F[27][27];
    while(t--) {
               scanf("%d%d%s",&n,&k,str);
               memset(ma,0,sizeof ma);
               for(i=0;i<26;i++) {
                                 for(j=0;j<26;j++) {
                                                   scanf("%lf",&prob[i][j]);
                                                   F[i][j] = (i==j?1.0:0.0);
                                 }
                                 
               }
               for(i=0;i<n;i++)
               scanf("%s",mat[i]);
               
               mat_exp(F,k);
               
               double p = 0;
               
               for(i=0;i<n;i++) {
                                if(strlen(str) != strlen(mat[i]))
                                continue;
                                int w = 0;
                                for(j=0;j<strlen(str);j++) {
                                                           w = w*26 + mat[i][j]-97;
                                }
                                if(ma[w])
                                continue;
                                ma[w] = 1;
                               // p += F[str[0]-97][mat[i][0]-97]*F[str[1]-97][mat[i][1]-97]*F[str[2]-97][mat[i][2]-97];
                               double x = 1;
                               for(j=0;j<strlen(str);j++)
                               x = x*F[str[j]-97][mat[i][j]-97];
                               p += x;
               }
               
               printf("%.9lf\n",p);
    }
    
    return 0;
}
