#include <iostream>
#include <cstdio>
#include <map>
using namespace std;
 
double base[26][26],ans[26][26];
 
void mat_mul(double A[26][26],double B[26][26])
{
	int i,j,k;
	double temp[26][26],sum=0;
	
	for(i=0;i<26;i++)
	{   
		for(j=0;j<26;j++)
		{   sum=0;
			for(k=0;k<26;k++)
			 sum+=A[i][k]*B[k][j];
		    temp[i][j]=sum;
	    }
	}
   for(i=0;i<26;i++)
   for(j=0;j<26;j++)
   A[i][j]=temp[i][j];
}
 
void mat_pow(int exp)
{
	while(exp)
	{
		if(exp & 1)
		 mat_mul(ans,base);
		mat_mul(base,base);
		exp>>=1;
	}
}
 
int main() {
	
    int i,j,t,n,k,length;
    string S,word;
    map<string, bool> mp;
    double probSum=0,temp;
    cin>>t;
    
    while(t--)
    {
    	cin>>n>>k;
    	cin>>S;
    	length=S.length();
    	for(i=0;i<26;i++)
        for(j=0;j<26;j++)
        {
         cin>>base[i][j];
         if(i==j) ans[i][j]=1;
         else ans[i][j]=0;
        }
        
        mat_pow(k);
 
        probSum=0;
        
        for(i=0;i<n;i++)
        {
        	cin>>word;
        	temp=1;
        	if(word.length()==length && !mp[word])
        	{
        		mp[word]=1;
        		for(j=0;j<length;j++)
        			temp*=ans[S[j]-'a'][word[j]-'a'];
        	}
        	else temp=0;
        	probSum+=temp;
        	
        }
        if(probSum>1) probSum=1;
        printf("%.9lf\n",probSum);
        mp.clear();
    }
    
	return 0;
} 