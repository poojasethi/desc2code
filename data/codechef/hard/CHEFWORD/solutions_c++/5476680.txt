#include<bits/stdc++.h>
#define MAX 100002
#define gc getchar_unlocked
#define ll long long
#define d double
inline void inp(ll *n )
{
*n=0;
ll ch=gc();int sign=1;
while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=gc();}
while( ch >= '0' && ch <= '9' )
*n = (*n<<3)+(*n<<1) + ch-'0', ch=gc();
*n=*n*sign;
}
using namespace std;
void mul(d a[26][26], d b[26][26])
{
    int i, j, k;
    d res[26][26];
    for(i=0;i<26;i++)
    {
        for(j=0;j<26;j++)
        {
            res[i][j] = 0;
            for(k=0;k<26;k++) res[i][j] += a[i][k]*b[k][j];
        }
    }
    for(i=0;i<26;i++)
    {
        for(j=0;j<26;j++) a[i][j] = res[i][j];
    }
}
void mat_sq(d a[26][26], d b[26][26],int p)
{
	while(p)
    {
        if (p%2 == 1) mul(b, a);
        p /= 2;
        mul(a, a);
    }
}
int main()
{
    ll t,n,i,j,k,len,len1,mark[20000];
    string s,s1;
    d a[26][26],b[26][26],ans;
    //freopen("x.txt","r",stdin);
    inp(&t);
    while(t--)
    {
        inp(&n); inp(&k); ans=0.0;
        cin>>s;
        len=s.length();
        for(i=0;i<26;i++)
        {
            for(j=0;j<26;j++)
            {
                cin>>a[i][j];
                b[i][j] = i == j ? 1.0 : 0.0;
            }
        }
        mat_sq(a,b,k);
        memset(mark,0,sizeof(mark));
        for(i=0;i<n;i++)
        {
            cin>>s1;
            len1=s1.length();
            if(len!=len1) continue;
            int was=0;
            for(j=0;j<len1;j++) was = was*26+s1[j]-'a';
            if (mark[was]) continue;
            mark[was] = 1;
            d ans1=1.0;
            for(j=0;j<len;j++)
            {
                ans1*=b[s[j]-'a'][s1[j]-'a'];
            }
            ans+=ans1;
        }
        printf("%.10lf\n",ans);
    }
 return 0;
}
