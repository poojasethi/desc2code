/*
jai shree ram _/\_
A hacker from NITP
*/

#include<bits/stdc++.h>
using namespace std;

#define mod 1000000007
typedef set<string> ss;
typedef vector<vector< double> > vs;
typedef map<int,char> msi;
typedef pair<int,int> pa;

vs mul(vs a,vs b)
{
	vs c(26,vector<double>(26));
	for(int i=0;i<26;i++)
	{
		for(int j=0;j<26;j++)
		{
			for(int k=0;k<26;k++)
			{
				c[i][j]=c[i][j]+a[i][k]*b[k][j];
			}
		}
	}
	return c;
}
vs power(vs a,long long int k)
{
	if(k==1)
	return a;
	if(k&1)
	return mul(a,power(a,k-1));
	vs ret=power(a,k/2);
	return mul(ret,ret);
}
long long int n,k,i,j,l1,l2,l,r;
double x,ans,pro;
string str,s;
int main()
{
	//freopen("i.in", "r", stdin);
  	//freopen("o.out", "w", stdout);
  	int t;
	cin>>t;
	while(t--)
	{
		cin>>n>>k>>str;
		l1=str.length();
		vs a(26,vector<double>(26));
		for(i=0;i<26;i++)
		{
			for(j=0;j<26;j++)
			{
				cin>>a[i][j];			
			}		
		}
		a=power(a,k);
		ss sa;
		ans=0;
		while(n--)
		{
			cin>>s;
			l2=s.length();
			if(l1!=l2)
			continue;
			l=sa.size();
			sa.insert(s);
			r=sa.size();
			if(l!=r)
			{
				pro=1;
				for(i=0;i<l1;i++)
				pro*=a[str[i]-97][s[i]-97];
				ans+=pro;
			}
		}
		printf("%.7f\n",ans);
	}
	return 0;
}
