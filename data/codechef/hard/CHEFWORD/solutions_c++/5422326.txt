#include<iostream>
#include<iomanip>
#include<cstdio>
#include<cstdlib>
#include<cmath>
#include<cstring>
#include<vector>
#include<queue>
#include<stack>
#include<map>
#include<set>
#include<algorithm>
using namespace std;
string st;
set <string>words;
double transf[27][27][28];
double tempTransf[27][27][2];
void doSwap(){
  for(int i=0;i<26;i++){
    for(int j=0;j<26;j++){
      tempTransf[i][j][0]=tempTransf[i][j][1];
    }
  }
}
int main(){
  int t,n,kk;
  double ans,cur;
  char a,b;
  scanf("%d",&t);
  while(t--){
    scanf("%d %d",&n,&kk);
    ans=0;
    words.clear();
    cin>>st;
    for(int i=0;i<26;i++){
      for(int k=0;k<26;k++){
        scanf("%lf",&transf[i][k][0]);
      }
    }
    for(int i=1;i<28;i++){
      for(int j=0;j<26;j++){
        for(int k=0;k<26;k++){
          //solve for transf[j][k][i]
          cur=0;
          for(int l=0;l<26;l++){
            if(i<2){
              //cout<<j<<" to "<<k<<" via "<<l<<" "<<transf[j][l][i-1]<<" "<<transf[l][k][i-1]<<endl;
            }
            cur+=transf[j][l][i-1]*transf[l][k][i-1];
          }
          transf[j][k][i]=cur;
          //if(i<2)
          //cout<<(char)'a'+j<<" "<<(char)'a'+k<<" "<<i<<" "<<cur<<endl;
        }
      }
    }
    int curLen=0;
    while(curLen!=kk){
      //cout<<curLen<<endl;
      for(int i=27;i>=0;i--){
        if((1<<i)+curLen<=kk){
          if(curLen==0){
            for(int j=0;j<26;j++){
              for(int k=0;k<26;k++){
                tempTransf[j][k][1]=transf[j][k][i];
                //cout<<j<<" "<<k<<" "<<transf[j][k][i]<<endl;
              }
            } 
          }else {
            for(int j=0;j<26;j++){
              for(int k=0;k<26;k++){
                //solve for [j][k] prev next stop at 1<<i
                cur=0;
                for(int l=0;l<26;l++){
                  cur+=tempTransf[j][l][0]*transf[l][k][i];
                }
                tempTransf[j][k][1]=cur;
              }
            }
          }
          doSwap();
          curLen+=(1<<i);
        }
      }
    }
    double curAlpha,curWord;
    string wrd;
    for(int i=0;i<n;i++){
      cin>>wrd; 
      words.insert(wrd);
    }
    for(set<string>::iterator it=words.begin();it!=words.end();it++){
      if((*it).size()!=st.size())continue;
      curWord=1;
      for(int k=0;k<st.size();k++){
        //cout<<tempTransf[st[k]-'a'][words[i][k]-'a'][0]<<" ";
        curWord*=tempTransf[st[k]-'a'][(*it)[k]-'a'][0];
      }
      //cout<<endl<<words[i]<<" "<<curWord<<endl;
      ans+=curWord;
    }
    cout<<fixed<<setprecision(25)<<ans<<endl;
  }
  return 0;
}
