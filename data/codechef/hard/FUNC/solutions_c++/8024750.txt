//kunalprince548
#include<iostream>
#include<cmath>
#include<cstdio>
#include<algorithm>
#include<vector>
#include<map>
#include<set>
#include<list>
#include<stack>
#include<queue>
using namespace std;
#define ll long long
ll mod=1000000007;
ll store[10001];
ll ar[10001];
ll roots[500];
ll f(ll x,ll n)
{
	double y=pow(x,(double)1/n);
	ll lo=y;
	ll hi=y+0.5;
	if(hi==lo)
	{
		return lo;
	} 
	if(pow(hi,n)<=x)
	{
		return hi;
	} 
	else 
	{
		return lo;
	}
}
 
int main()
{
	ll t,n,q,x,j,co,i,size,v;
	scanf("%lld",&t);
	while(t--)
	{
		scanf("%lld%lld",&n,&q);
		for(i=0;i<n;i++)
		{
			scanf("%lld",&ar[i]);
		} 
		store[n-1] = ar[n-1];
		for(i=n-2; i>=0; i--)
		{
			store[i]=store[i+1]+ar[i];
			if(store[i]<0)
			{
				store[i]=(store[i]%mod+mod)%mod;
			}	
			else 
			if(store[i]>=mod) 
			{
				store[i]=store[i]%mod;
			}
		}
		/*
		for(i=0;i<n;i++)
		{
		  cout<<ar[i]<<" ";
	    }
	    for(i=0;i<n;i++)
		{
		  cout<<store[i]<<" ";
	    }
		*/	
		for(i=0;i<q;i++)
		{
			scanf("%lld",&x);
			j=2;
			co=0;
			roots[co++]=x;
			while(1)
			{
				v=f(x,j);
				roots[co++]=v;
				if(v<=1) 
				{
					//cout<<"here ";
					break;
				}
				j++;
			}
			ll ans = 0;
			/*
			for(i=0;i<size;i++)
			{
				cout<<roots[i]<<" ";
			}
			cout<<"\n";
			*/
			size=min(co,n);
			//cout<<size<<"\n";
			/*
			for(i=0;i<size;i++)
			{
				cout<<roots[i]<<" ";
			}
			cout<<"\n";
			*/
			for(j=0;j<size;j++)
			{
				roots[j]=roots[j]%mod;
				ll temp=(ar[j]*roots[j]);
				ans=(ans+temp);
				if(ans<0)
				{
					ans=(ans%mod+mod)%mod;
				}	
				else 
				if(ans>=mod) 
				{
					ans=ans%mod;
				}
				//cout<<"ans="<ans<<"\n";
			}
			
			if(j<n)
			{
				ans=(ans+store[j]);
				if(ans<0)
				{
					ans=(ans%mod + mod)%mod;
				}	
				else 
				if(ans>=mod) 
				{
					ans=ans%mod;
				}
			}
			printf("%lld ",ans);
			
		}
		printf("\n");
	}
	return 0;
} 