#include <iostream>
#include <vector>
#include <stdio.h>
#include <math.h>
using namespace std;
#define ll long long
 
long long mulmod(long long a,long long b,long long c){
    long long x = 0,y=a%c;
    while(b > 0){
        if(b%2 == 1){
            x = (x+y)%c;
        }
        y = (y*2)%c;
        b /= 2;
    }
    return x%c;
}
ll fpow(ll x, ll n) {
	double y = pow(x,(double)1/n);
	ll lo = y;
	ll hi = y+0.5;
	
	if(hi == lo) return lo;
	
	if(pow(hi,n) <= x) return hi;
	else return lo;
}


int main() {
	int t,Q,N,i,j;
	ll ans,mod=1000000007,x;
	cin>>t;
	while(t--)
	{cin>>N>>Q;
	int A[N+1];
	vector<ll> sum(N+1,0);
	
	for( i = 1;i<=N;i++)
	{scanf("%lld",&A[i]);
	sum[i]=(sum[i-1]+A[i])%mod;}
	while(Q--)
	{scanf("%lld",&x);
	ans=0;
	j=ceil(log2((double)(x+0.01)))+1;
 
	for(i=1;i<=min(N,j);i++)
	{
		ll p =fpow(x,i)%mod;
		if(i==1)
		{p=x%mod;}
	
	
		ans=(ans+A[i]*p)%mod;}
	if(j<N){
	ans=((ans+sum[N]-sum[j])%mod+mod)%mod;}
	printf("%lld ",ans);}
	cout<<endl;
	}
	return 0;
} 