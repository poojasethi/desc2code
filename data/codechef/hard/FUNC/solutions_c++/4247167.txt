#include<iostream>
#include<cstdio>
#include<cmath>
#define min(a,b) a<b?a:b
#define mod 1000000007
#define getcx getchar_unlocked
using namespace std;
typedef long long int ll;
inline void inp(long long int &n)//fast input function
{
   n=0;
   int ch=getcx();int sign=1;
   while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getcx();}
   while( ch >= '0' && ch <= '9' )
           n = (n<<3)+(n<<1) + ch-'0', ch=getcx();
   n=n*sign;
}
int main()
{
    ll n,i,q,t;
    inp(t);
    while(t--)
    {
        inp(n);inp(q);
        ll a[n],s=0,ans,x;
        for(i=0;i<n;i++)
            inp(a[i]);
        for(i=60;i<n;i++)
            s=(s+a[i])%mod;
        ll lim=min(n,60);
        double lg;
        while(q--)
        {
            inp(x);
            ans=(a[0]*(x%mod))%mod;
            lg=log10(x);
            for(i=1;i<lim;i++)
                ans=(ans+(a[i]*((ll)(floor(pow(10,lg/(i+1))))%mod))%mod)%mod;
            ans=(ans+s)%mod;
            ans=(ans+mod)%mod;
            printf("%lld ",ans);
        }
        printf("\n");
    }
    return 0;
}
