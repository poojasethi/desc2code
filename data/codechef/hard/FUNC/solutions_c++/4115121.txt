#include<cstdio>
#include<cmath>
#define c 1000000007
#define eps 1e-7
using namespace std;
long long int sum=0,a[100000],root,x,sum1,root1;
double y;

int main()
{  int i,n,q,j,t;
    scanf("%d",&t);

    while(t--)
    {

        scanf("%d %d",&n,&q);
        for(i=1;i<=n;i++)
            {scanf("%lld",&a[i]);}
            sum1=a[n];
            for(i=n-1;i>=1;i--)
            {sum1+=a[i];
            sum1+=c;
            sum1=sum1%c;
            }


      for(i=0;i<q;i++)
            {scanf("%lld",&x);
                sum=sum1;
                sum+=(((x-1)%c)*a[1])%c;
                sum=sum+c;
                sum=sum%c;
            for(j=2; j<=60&& j<=n;j++)
            {
                root=(long long int)(pow(x,(double)(1.0/(double)j)));

                root1=root+1;
                if(pow((root1),j)<=x)
                    root=root1;
                sum=((sum+(((root-1)%c)*a[j])%c))%c;
                sum=sum+c;
                sum=sum%c;
            }


        printf("%lld ",sum);
        }

    printf("\n");
    }

return 0;
}
