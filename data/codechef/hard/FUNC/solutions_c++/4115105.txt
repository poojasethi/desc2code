#include<cstdio>
#include<cmath>
#define c 1000000007
#define eps 1e-7
using namespace std;
long long int sum=0,a[100000],root,x,sum1[100000],root1;
double y;

int main()
{  int i,n,q,j,t;
    scanf("%d",&t);

    while(t--)
    {

        scanf("%d %d",&n,&q);
        for(i=1;i<=n;i++)
            {scanf("%lld",&a[i]);}
            sum1[n]=a[n];
            for(i=n-1;i>=1;i--)
            {sum1[i]=sum1[i+1]+a[i];
            sum1[i]+=c;
            sum1[i]=sum1[i]%c;
            }


      for(i=0;i<q;i++)
            {scanf("%lld",&x);

                sum=((x%c)*a[1])%c;
                sum=sum+c;
                sum=sum%c;
            for(j=2; j<=60&& j<=n;j++)
            {
                y=(pow(x,(double)(1.0/(double)j)));
                root=y;
                root1=y+0.5;
                if(pow((root1),j)<=x)
                    root=root1;
                sum=(sum+(((root%c)*a[j])%c))%c;
                sum=sum+c;
                sum=sum%c;
            }
            if(j<n)
            {
                sum=(sum+sum1[j]);
                sum+=c;
                sum=sum%c;

            }

        printf("%lld ",sum);
        }

    printf("\n");
    }

return 0;
}
