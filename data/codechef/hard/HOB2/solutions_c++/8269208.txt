#include<bits/stdc++.h>
using namespace std;
struct _r
{
	int vis,pref,stay,incv; // vis contains visitor index and stay time 
};
_r dude[3141590];
int room[3141590]; // room takees the index number of dude
int main()
{
	int t;
	scanf("%d",&t);
	while (t--)
	{
		int r,n;
		scanf("%d%d",&r,&n);
		int i,j,k;
		int filled=0;// to be filled ! 
		for (i=0;i<n;i++)
		{
			scanf("%d%d",&dude[i].vis,&dude[i].incv);
			dude[i].stay=-1;
			if (dude[i].incv>=r)
			{
				dude[i].pref=0;
				continue;
			}
			if (i<r)
			{

				room[filled]=i;
				dude[i].pref=(filled-dude[i].incv);
				filled++;
			}
			else
			{
				dude[room[r-1]].stay=dude[i].vis;//
				room[r-1]=i;
				dude[i].pref=(r-1-dude[i].incv);
			}
				
		}
		for (i=0;i<n;i++)
		{
			if (dude[i].stay==-1)
			{
				dude[i].stay=dude[n-1].vis+1;
			}
			dude[i].stay-=dude[i].vis;
		}
		for (i=0;i<n;i++)
		{
			printf("%d %d\n",dude[i].pref,dude[i].stay);
		}
	}
	return 0;
}
		