#include <cstdio>
#include <cstring>
#include <cassert>
#include <utility>

typedef std::pair<int, int> pii;

const int MAX = 333333;
const int MAXT = 31415926;
int R, N;
int tm[MAX], inc[MAX];
pii ans[MAX];


int main() {
    int T;
    scanf("%d", &T);
    for(int t = 0; t < T; ++t) {
        scanf("%d %d", &R, &N);

        for(int i = 0; i < N; ++i)
            scanf("%d %d", &tm[i], &inc[i]);

        for(int i = 0; i < R; ++i) {
            ans[i].first = i - inc[i];
            ans[i].second = MAXT;
        }
        int prev = R - 1;
        for(int i = R; i < N; ++i) {
            if(inc[i] == R) ans[i].first = 0;
            else {
                ans[i].first = R - 1 - inc[i];
                ans[prev].second = tm[i] - tm[prev];
                ans[i].second = MAXT;
                prev = i;
            }
            ans[i].second = MAXT;
        }

        for(int i = 0; i < N; ++i) 
            printf("%d %d\n", ans[i].first, ans[i].second);
    }
}
