#include <iostream>
#include <vector>

using namespace std;

struct gosc
{
    int pocz, czas, nr, pomi;
};

const int INF = 31415926;

int main()
{
    ios_base::sync_with_stdio(0);
    int t;
    cin >> t;
    for (int i = 0; i < t; ++i)
    {
        int r, n;
        cin >> r >> n;
        vector<gosc> G(n);
        for (int j = 0; j < n; ++j) cin >> G[j].pocz >> G[j].pomi;
        int pop = -1;
        for (int j = 0; j < n; ++j)
        {
            if (G[j].pomi == r)
            {
                G[j].nr = 0;
                G[j].czas = INF;
            }
            else
            {
                if (j < r)
                {
                    G[j].nr = j - G[j].pomi;
                    G[j].czas = INF;
                }
                else
                {
                    G[j].nr = r - 1 - G[j].pomi;
                    G[pop].czas = G[j].pocz - G[pop].pocz;
                    G[j].czas = INF;
                }
                pop = j;
            }
        }
        for (int j = 0; j < n; ++j) cout << G[j].nr << " " << G[j].czas << endl;
    }
    return 0;
}
