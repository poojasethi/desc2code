#include<cstdio>
#define LIM 31415926
using namespace std;
int time[314162];
        int room[314162];
        int occupant[314162];
        int time_arrival[314162];
int main()
{
    int T,R,N,t,incnv;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%d%d",&R,&N);

        for(int i=0;i<N;i++)
        {
            scanf("%d%d",&t,&incnv);
            time_arrival[i]=t;
            if(i<R)
            {

                room[i]=i-incnv;
                time[i]=LIM;
                occupant[i]=i;
            }
            else
            {


                    room[i]=0;
                    time[i]=LIM;

                    if(incnv<R)
                   {

                    time[occupant[incnv]]=t-time_arrival[occupant[incnv]];
                    occupant[incnv]=i;
                   }

            }

        }
        for(int i=0;i<N;i++)
        printf("%d %d\n",room[i],time[i]);
    }
}
