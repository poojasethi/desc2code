#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <limits>
#include <bitset>
#include <time.h>
#include <cmath>
#include <vector>
#include <string>
#include <set>
#include <iostream>
#include <sstream>

using namespace std;

#define MOD 1000000007LL
#define LL long long
#define LD long double
#define MAX(a,b) ((a)>(b)?(a):(b))
#define MIN(a,b) ((a)<(b)?(a):(b))
#define ABS(x) ((x)<0?-(x):(x))

#define REP(i,n) for(int i=0;i<(n);i++)
#define FOR(i,a,b) for(int i=(a);i<(b);i++)
#define FORR(i,n) for(int i=(n);i>=0;i--)

const double PI=3.14159265358979323846264338327950288419716939937510582097494459230;

#define MAXR 314159

int room[MAXR],stay[MAXR];
int t[MAXR];

int main()
{
	int cases,r,n;
	scanf("%d",&cases);
	REP(i,cases)
	{
		scanf("%d %d",&r,&n);
		int last = r - 1;

		REP(j,n)
		{
			int conv;
			scanf("%d%d", &t[j], &conv);
			room[j] = 0;
			stay[j] = 31415926;
			if(conv < r)
			{
				room[j]=MIN(j,r-1)-conv;
				if(j>=r)
				{
					stay[last]=t[j]-t[last];
					last=j;
				}
			}
		}
		REP(j, n)
		{
			printf("%d %d\n", room[j], stay[j]);
		}
	}
	
	return 0;
}
