/*===============*\
|  ID: TMANDZU    |
|    LANG: C++    |
\*===============*/
//Tornike Mandzulashvili
//#pragma comment(linker,"/STACK:256000000")
#include <stdio.h>
#include <stdlib.h>
#include <algorithm>
#include <stack>
#include <math.h>
#include <vector>
#include <string>
#include <map>
#include <queue>
#include <iostream>
#include <set>

#define EPS 0.000000001
#define Pi 3.1415926535897932384626433832795028841971
#define hash1 1000003
#define hash2 1000033
#define md 1000000007
#define INF 1000000000
#define mp make_pair
#define pb push_back
#define S size()
#define MX(aa,bb) (aa>bb?aa:bb)
#define MN(aa,bb) (aa<bb?aa:bb)
#define fi first
#define se second
#define PI pair < int,int >
#define REP(i,a,n) for(i=a;i<n;i++)
#define sc scanf
#define pt printf
#define big long long
#define VI vector <int>

using namespace std;

int raod,T,i,j,R,N,pos,t;
int fix[400000],enter[400000],A[400000],Time[400000],room[400000];


main()
{
  //  freopen("text.in","r",stdin);   freopen("text.out","w",stdout);

    scanf("%d",&T);
    while (T--)
    {
        scanf("%d %d",&R,&N);
        pos=0;

        for (i=1;i<=N;i++)
        Time[i]=room[i]=fix[i]=0;

        for (i=0;i<R;i++)
        A[i]=0;

        for (i=1;i<=N;i++)
        {
            scanf("%d %d",&t,&raod);

            if (raod==R)
            {
                fix[i]=1;
                continue;
            }

            enter[i]=t;

            if (A[pos]>0)
            Time[A[pos]]=t;

            A[pos]=i;

            room[i]=(pos-raod+R)%R;

            pos=(pos+1)%R;
        }

        for (i=0;i<R;i++)
        if (A[i]>0)
        Time[A[i]]=t+1;

        for (i=1;i<=N;i++)
        if (fix[i]) {room[i]=0;Time[i]=enter[i]+3;}

        for (i=1;i<=N;i++)
        printf("%d %d\n",room[i],Time[i]-enter[i]);
    }

}
