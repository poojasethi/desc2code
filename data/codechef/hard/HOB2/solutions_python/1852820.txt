#include<cstdio>
#include<iostream>
#include<cstring>
#include<string>
#include<cmath>
#include<algorithm>
#include<queue>
#include<stack>
#include<list>
#include<vector>
#include<map>

#define ul unsigned long
#define ull unsigned long long

#define sd(n) scanf("%d",&n)
#define sl(n) scanf("%l",&n)
#define slu(n) scanf("%lu",&n)
#define sll(n) scanf("%ll",&n)
#define sllu(n) scanf("%llu",&n)

#define REP(i,a,b) for(int i=a;i<b;i++)
#define MODULO	1000000007
#define fill(a,v) memset(a,v,sizeof(a))
#define MOD(a) ((a >= 0) ? (a) : (-a))
#define max(a, b) ((a > b) ? (a) : (b))
#define min(a, b) ((a > b) ? (b) : (a))

#define MAX 31415926

using namespace std;

int main() {
    ul T, R, N;
    slu(T);
    while (T--) {
        slu(R); slu(N);
        ul r_room[N], r_stay[N];
        ul count = 0;
        ul last = R-1;
        ul last_time = 0;
        ul old_N = N;
        while (N--) {
            ul time, incon;
            slu(time); slu(incon);
            if (count < R) {
                r_stay[count] = MAX;
                r_room[count] = count - incon;
                if (count == R-1)
                    last_time = time;
            } else {
                if (incon == R)
                    r_room[count] = 0;
                else {
                    r_room[count] = R-1-incon;
                    r_stay[last] = time-last_time;
                    last = count;
                    last_time = time;
                }
                r_stay[count] = MAX;
            }
            count++;
        }
        REP(i,0,old_N)  printf("%lu %lu\n", r_room[i], r_stay[i]);
    }
}
