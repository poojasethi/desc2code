#include<cstdio>
#include<iostream>
#include<vector>
#include<cstring>
#include<algorithm>
#include<set>
#include<cmath>
#include<bitset>
#include<map>
#include<queue>
#define test(t) while(t--)
#define cin(n) scanf("%d",&n)
#define cout(n) printf("%d\n",n)
#define rep(i,a,n) for(i=a;i<n;i++)
#define vi vector<int>
#define vii vector< pair<int,int> >
#define mii map<int,int>
#define pb push_back
#define mp make_pair
#define imax 31415926
#define ill long long
using namespace std;
int t,n,r,i,stay_time[314159],room[314159],last,tim[314159],inc;
int main()
{
    cin(t);
    test(t)
    {
        cin(r);cin(n);
        last=r-1;
        for(i=0;i<n;i++)
        {
            cin(tim[i]);cin(inc);
            if(i<r)
            {
                room[i]=i-inc;
            }
            else
            {
                if(inc==r) room[i]=0;
                else
                {
                    room[i]=r-1-inc;
                    stay_time[last]=tim[i]-tim[last];
                    last=i;
                }
            }
            stay_time[i]=imax;
        }
        for(i=0;i<n;i++) printf("%d %d\n",room[i],stay_time[i]);
    }
    return 0;
}
