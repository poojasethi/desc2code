#include<stdio.h>

#define MAX 314160

int main()
{
	int t , r, n , i ;
	int timeOfComing[MAX] , inconv[MAX] , stay_time[MAX] , room[MAX] ; 
	scanf("%d",&t);
	while(t--)
	{
		scanf("%d %d",&r,&n);
		for(i=0;i<n;i++)
			scanf("%d %d",&timeOfComing[i],&inconv[i]);
		for(i=0;i<r;i++)
		{
			room[i] = i - inconv[i] ;
    			stay_time[i] = 31415926 ;
		}
		int last_guest = r-1 ;
		for (i = r; i < n ; i++)
		{
    			if (inconv[i] == r)
        			room[i] = 0 ;
    			else
			{
        			room[i] = r - 1 - inconv[i] ;
        			stay_time[last_guest] = timeOfComing[i] - timeOfComing[last_guest] ;
        			last_guest = i ;
			}
    			stay_time[i] = 31415926 ;
		}
		for(i=0;i<n;i++)
			printf("%d %d\n",room[i],stay_time[i]);
	}
	return 0 ;
}