#include<iostream>
#include<stdio.h>
#define maxn 31415926
using namespace std;
int main()
{
    int T,R,N,i,time,inconvenience,last_guest;
    scanf("%d",&T);
    while(T--)
    {
        scanf("%d%d",&R,&N);
        int Stay_time[N],Room[N],time[N];
        for(i=0;i<R && i<N;i++)
        {
            scanf("%d%d",&time[i],&inconvenience);
            Room[i]=i-inconvenience;
            Stay_time[i]=maxn;
        }
        last_guest=R-1;
        for(i=R;i<N;i++)
        {
            scanf("%d%d",&time[i],&inconvenience);
            if(inconvenience==R)
                Room[i]=0;
            else
            {
                Room[i]=R-1-inconvenience;
                Stay_time[last_guest]=time[i]-time[last_guest];
                last_guest=i;
            }
            Stay_time[i]=maxn;
        }
        for(i=0;i<N;i++)
            printf("%d %d\n",Room[i],Stay_time[i]);
    }
    return 0;
}
