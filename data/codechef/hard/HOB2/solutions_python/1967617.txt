//
// hotel.cpp -- http://www.codechef.com/COOK31/problems/HOB2
//
// Siwakorn Sriakaokul - ping128
// Written on Wednesday, 27 March 2013.
//

#include <cstdio>
#include <iostream>
#include <sstream>
#include <cstdlib>
#include <string>
#include <vector>
#include <set>
#include <queue>
#include <stack>
#include <list>
#include <cmath>
#include <algorithm>
#include <map>
#include <ctype.h>

#define MAXN 314159
#define MAXT 31415926

using namespace std;

int ans[MAXN + 5][2]; // room, stay time

int main()
{
	int Test;
	int N, R;
	int t, inconv;
	scanf("%d", &Test);
	for(int tt = 0; tt < Test; tt++ ){
		scanf("%d %d", &R, &N);
		int t_last_guest;
		for(int i = 0; i < min(N, R); i++ ){
			scanf("%d %d", &t, &inconv);
			ans[i][1] = MAXT;
			ans[i][0] = i - inconv;
			if(i == R - 1)
				t_last_guest = t;
		}

		int last_guest = R - 1; // the last guest in the room R - 1
		for(int i = R; i < N; i++ ){
			scanf("%d %d", &t, &inconv);
			if(inconv == R){
				ans[i][0] = 0;
			} else {
				ans[i][0] = R - inconv - 1;
				ans[last_guest][1] = t - t_last_guest;
				last_guest = i;
				t_last_guest = t;
			}
			ans[i][1] = MAXT;
		}

		for(int i = 0; i < N; i++ )
			printf("%d %d\n", ans[i][0], ans[i][1]);
	}

	return 0;	
}
