#include<iostream>
using namespace std;
typedef long long int l;
#include<cstdio>
template<typename X> inline void inp(X &n ) {
     int ch=getchar();int sign=1;n=0;
     while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getchar();}
     while(  ch >= '0' && ch <= '9' ) n = (n<<3)+(n<<1) + ch-'0', ch=getchar();
     n=n*sign;
}const int fact=1e6;
int time1[314159+47];
int staytime1[314159+47];
int room[314159+47];
int conv[314159+47];
//#include<bits/stdc++.h>
int main()
{
    int t;
    inp(t);
    while(t--)
    {

        int n,r;
        inp(r);
        inp(n);
        for(int i=0;i<n;i++)
        {

            inp(time1[i]);
            inp(conv[i]);
        }
        for(int i=0;i<r;i++)
        {
            room[i]=i-conv[i];
            staytime1[i]=31415926;


        }
        int last_guest = r-1;
for (int i = r; i <=n-1; i++)
    {if(conv[i] ==r)
        room[i]= 0;
    else
{room[i] = r-1-conv[i];
        staytime1[last_guest] = time1[i] - time1[last_guest];
        last_guest= i;}
    staytime1[i]= 31415926;
    }


    for(int i=0;i<n;i++)
    {

    printf("%d %d\n",room[i],staytime1[i]);
    }
    }

}
