#include<cstdio>
using namespace std;
struct nwala
{
	int vtime, proom, stime, inconv;
	nwala()
	{
		stime=-1;
	}
};
main()
{
	int t;
	scanf("%d", &t);
	while(t--)
	{
		int r, n;
		scanf("%d %d", &r, &n);
		nwala a[n];
		for(int i=0; i<n; i++)
			scanf("%d %d", &a[i].vtime, &a[i].inconv);
                int lastguest=r-1;
		for(int i=0; i<n; i++)
		{
			if(i<r)
			{
				a[i].proom=(i-a[i].inconv);
				
			}
			else
			{
                if(a[i].inconv==r)
                {
                                  a[i].proom=0;
                                  a[i].stime=31415926;
                }
                else
                {
				                  a[i].proom=(r-1-a[i].inconv);
                                  a[lastguest].stime=a[i].vtime-a[lastguest].vtime;
                                  lastguest=i;
                }
			}
			a[i].stime=31415926;
		}				

		for(int i=0; i<n; i++)
			printf("%d %d\n", a[i].proom, a[i].stime);
	}
}
