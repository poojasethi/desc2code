#include <bits/stdc++.h>
#define LIM 31415926
using namespace std;

struct entry
{
    int visit_time;
    int pref_room;
    int room_no;
    int stay_time;
    int inconv;

    entry()
    {
        room_no = visit_time = pref_room  = inconv = 0;
        stay_time = 1;
    }
};

static entry a[400000];
static int room[400000];

int main()
{
    int t;
    cin>>t;
    while(t--)
    {
        int r,n,i,id;
        scanf("%d %d", &r,&n);
        for(i=0; i<n; i++)
            scanf("%d %d",&a[i].visit_time,&a[i].inconv);
        memset(room,-1,(r+1)*sizeof(int));
        room[0] = 0;
        a[0].pref_room = 0;
        a[0].room_no = 0;
		a[0].stay_time = LIM - a[0].visit_time;
        for(i=1; i<n; i++)
        {
            int ind = i%r;
            if(a[i].inconv==r)
            {
            	a[i].pref_room = 0;
            	a[i].stay_time = 1;
            	continue;
            }
            if(room[ind]>=0)
            {
                id = room[ind];
                a[id].stay_time = a[i].visit_time - a[id].visit_time;
            }
                a[i].room_no = ind;
				room[ind] = i;
                a[i].pref_room = ind - a[i].inconv;
                if(a[i].pref_room < 0)
                    a[i].pref_room += r;
                else
                    a[i].pref_room %= r;
                a[i].stay_time = LIM ;
        }

        for(i=0; i<n; i++)
        {
            printf("%d %d\n",a[i].pref_room, a[i].stay_time);
        }
    }
    return 0;
}
