#include<stdio.h>


using namespace std;

int main()
{
    int T,R,N;
    int time[314160],inconv[314160],room[314160],stay_time[314160];
    scanf("%d",&T);
    const int max_stay_time=31415926;
    while(T--)
    {
        scanf("%d%d",&R,&N);

        for(int i=0;i<N;++i)
        {
            scanf("%d%d", &time[i],&inconv[i]);
        }

        for(int i=0;i<=R-1;++i)
        {
            room[i]=i-inconv[i];
            stay_time[i]=max_stay_time;
        }

        int last_guest=R-1;

        for(int i=R; i<=N-1;++i)
        {
            if(inconv[i]==R)
            {
                room[i]=0;
                stay_time[i]=max_stay_time;
            }

            else
            {
                room[i]=R-1-inconv[i];
                stay_time[last_guest]=time[i]-time[last_guest];
                last_guest=i;
                stay_time[i]=max_stay_time;
            }


        }

        for(int i=0;i<N;++i)
        {
            printf("%d %d\n",room[i],stay_time[i]);
        }
    }
}
