#include<iostream>
#include<stdio.h>

using namespace std;
int time1[314159],inconv[314159];
int room[314159],stay[314159];
int main()
{
    int t;

    cin>>t;

    while(t--)
    {
        int r,n,i,last_guest;

        scanf("%d%d", &r, &n);

        last_guest = r-1;
        for(i=0;i<=n-1;i++){

        scanf("%d%d", &time1[i], &inconv[i]);

         room[i] = 0;
         stay[i] = 31415926;

         if(inconv[i]<r)
         {
             room[i] = min(i,r-1)-inconv[i];
             if(i>r-1)
             {
                 stay[last_guest] = time1[i] - time1[last_guest];
                 last_guest = i;
             }

         }
        }

        for(i=0;i<n;i++)
        {
           printf("%d %d\n", room[i], stay[i]);
        }

    }
    return 0;
}

