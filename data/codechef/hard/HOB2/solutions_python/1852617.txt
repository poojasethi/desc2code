/*
author:jxy
lang:C/C++
university:China,Xidian University
**If you need to reprint,please indicate the source**
*/
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#define Maxn 314160
using namespace std;
inline void inp( int &n )//fast input function
{
	n=0;
	int ch=getchar(),sign=1;
	while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getchar();}
	while( ch >= '0' && ch <= '9' )
 		n=(n<<3)+(n<<1)+ ch-'0', ch=getchar();
	n=n*sign;
	return;
}
char s[100];
int k=0;
inline void out(int &a)
{
    if(a==0){putchar('0');return;}
    while(a)
        s[k++]=a%10+'0',a/=10;
    while(k)
        putchar(s[--k]);
    return;
}
int R[Maxn];//房间客人
int room[Maxn],start[Maxn];
int n,m;
int main()
{
    int T,i;
    scanf("%d",&T);
    while(T--)
    {
        inp(n);inp(m);
        memset(R,0,n*sizeof(R[0]));
        int time,inc,now=0,ll=n-1;
        for(i=1;i<=m;i++)
        {
            inp(time);
            inp(inc);
            start[i]=time;
            if(n!=now)//没住满，依次安排
            {
                room[i]=now-inc;
                R[now++]=i;
            }
            else//已住满，赶走之前的人
            {
                if(inc==n){room[i]=0;continue;}//没房间
                room[i]=ll-inc;
                start[R[ll]]=time-start[R[ll]];
                R[ll]=i;
            }
        }
        ++time;
        for(i=0;i<n;i++)
            start[R[i]]=time-start[R[i]];
        for(i=1;i<=m;i++)
        {
            out(room[i]);
            putchar(' ');
            out(start[i]);
            putchar('\n');
        }
    }
}
