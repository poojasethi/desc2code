#include<bits/stdc++.h>
#define ll long long int
#define ld long double
#define ite iterator
#define mp make_pair
#define ff first
#define ss second
#define pb push_back
#define ioS ios::sync_with_stdio(false);
#define fr(i,x,n) for(int i=x;i<n;i++)
#define re0 return 0 ;
#define mod 1000000007
using namespace std ;

ll vt[314169],incon[314169];
ll room[314169],stayt[314169];
ll  n,i,j,md,hi,lo,m,mx,h,flag,sum,x,t,y,w,ans,q,hsh,r,k  ;
vector<ll> v[200300];

vector<ll> u ;



int main(){
ioS
mx = 31415926 ;
cin >> t ;
while(t--){

cin >> r >> n ;
ll last = r-1;

for(i=0;i<n;i++){
        cin >> vt[i] >> incon[i] ;  room[i]=0 ; stayt[i] =0 ; }
k = 0 ;

    for(i=0;i<n;i++){

room[i] = 0 ; stayt[i] = mx ;

 if(incon[i] < r) {

				room[i] = min(i, r - 1) - incon[i];
				if (i >= r) {

					stayt[last] = vt[i] - vt[last];
					last = i;
				}
			}

}

for(i=0;i<n;i++){
    cout << room[i] << " " << stayt[i] << endl ;
}

}

re0;
}
