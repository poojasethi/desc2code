#include<iostream>
#include<algorithm>
using namespace std;
int dp[510][510],diag_sum[510];
int main()
{	
	int t,i,j,ans,n,D;
	scanf("%d",&t);
	while(t--)
	{	scanf("%d",&n);
		for(i=0;i<=n+2;i++)
			for(j=0;j<=i+2;j++)
				dp[i][j]=0;
		for(i=1;i<=n;i++)
			for(j=1;j<=i;j++)
				scanf("%d",&dp[i][j]);
		diag_sum[0]=0;
		for(i=n,j=1;i>=j;i--,j++)
			diag_sum[j]=diag_sum[j-1]+dp[i][j];
		for(i=2;i<n;i++)
			for(j=1;j<=min(i,n-i);j++)
				dp[i][j]+=max(dp[i-1][j],max(dp[i-1][j-1],dp[i-1][j+1]));
		for(j=n-1;j>1;j--)
			for(i=n;i>=max(j,n+2-j);i--)
				dp[i][j]+=max(dp[i][j+1],max(dp[i+1][j+1],dp[i-1][j+1]));
		ans=0;D=(n+1)/2;
		for(i=1;i<=D;i++)
			for(j=1;j<=D;j++)
				ans=max(ans,max(dp[n-i][i],dp[n-i][i-1])+max(dp[n+1-j][j+1],dp[n+2-j][j+1])+diag_sum[max(i,j)]);
		printf("%d\n",ans);									
	}
	return 0;
}
