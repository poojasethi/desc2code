#include<cstdio>
#include<cstring>
#include<algorithm>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

typedef long long ll;

int main(){
	int T; scanf("%d",&T);
	while(T--){
		int n; scanf("%d",&n);
		static int chip[500][500];
		rep(i,n) rep(j,i+1) scanf("%d",chip[i]+j);

		ll ans[4];
		int i_ans=0;
		static ll dp[500][500];
		rep(t,4){
			memset(dp,0,sizeof dp);
			dp[0][0]=chip[0][0];
			rep(i,n-1) rep(j,i+1) {
				for(int d=-1;d<=1;d++) if(0<=j+d && j+d<=min(i+1,n-1-(i+1))) {
					dp[i+1][j+d]=max(dp[i+1][j+d],dp[i][j]+chip[i+1][j+d]);
				}
			}
			ans[i_ans++]=dp[n-1][0];

			static int buf[500][500];
			memcpy(buf,chip,sizeof buf);
			rep(i,n) rep(j,i+1) chip[i][j]=buf[n-j-1][n-i-1];

			if(t==1) rep(i,n) chip[i][n-1-i]=0;
		}

		printf("%lld\n",max(ans[0]+ans[3],ans[1]+ans[2]));
	}

	return 0;
}
