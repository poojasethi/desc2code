#include <iostream>
#include <cstdio>
#include <cstdlib>

using namespace std;

int chips[555][555];
long long dp1[555][555], dp2[555][555], dsum[555];

int main()
{
    //freopen("tkchocs.in", "r", stdin);

    int T = 0;
    scanf("%d", &T);

    for(int t = 0; t < T; t++)
    {
        int N;
        scanf("%d", &N);

        for(int i = 1; i <= N; i++)
            for(int j = 1; j <= i; j++)
                scanf("%d", &chips[i][j]);

        dsum[N + 1] = 0;
        for(int i = N; i >= 1; i--)
            dsum[i] = dsum[i + 1] + chips[i][N - i + 1];

        for(int i = 1; i <= N + 5; i++)
            for(int j = 1; j <= N + 5; j++)
                dp1[i][j] = dp2[i][j] = 0;

        for(int i = 1; i <= N; i++)
            for(int j = 1; j <= i; j++)
            {
                dp1[i][j] = 0;
                for(int a = -1; a <= 1; a++)
                    dp1[i][j] = max(dp1[i][j], dp1[i - 1][j + a]);
                if(j < N - i + 1)
                    dp1[i][j] += chips[i][j];
            }
        for(int j = N; j >= 1; j--)
            for(int i = 1; i <= N; i++)
            {
                dp2[i][j] = 0;
                for(int a = -1; a <= 1; a++)
                    dp2[i][j] = max(dp2[i][j], dp2[i + a][j + 1]);
                if(j > N - i + 1)
                    dp2[i][j] += chips[i][j];
            }

        long long ans = 0;
        for(int i = 1; i <= N; i++)
            for(int j = 1; j <= N; j++)
                ans = max(ans, dp1[i][N - i + 1] + dp2[j][N - j + 1] + dsum[min(i, j)]);
        printf("%lld\n", ans);
    }
}