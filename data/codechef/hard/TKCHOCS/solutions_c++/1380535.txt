#include<stdio.h>
int main()
{
    int i,j,k,n,s,t,x,c,u,v;
    
    scanf("%d",&i);
    while(i--)
    {
		int a[505][505]={0},p[505]={0};
         scanf("%d",&n);
         for(j=1;j<=n;j++)
         {
         for(k=1;k<=j;k++)
            {
             scanf("%d",&a[j][k]);
             }
             }
             s=(n+1)/2;
             for(j=1;j<=s;j++)
			{
			p[n-j+1]=p[n-j+2]+a[n-j+1][j];
		    }
                   for(j=2;j<n;j++)
                   {          
						if(j<n-j)
						t=j;
						else
						t=n-j;     
                    for(k=1;k<=t;k++)
					{
						x=0;
						if(a[j-1][k]>x)
						x=a[j-1][k];
						if(a[j-1][k+1]>x)
						x=a[j-1][k+1];
						if(a[j-1][k-1]>x)
						x=a[j-1][k-1];
						a[j][k]=a[j][k]+x;
					}
				}
			for(j=2;j<n;j++)
			{
				if(j<n-j)
				t=j;
				else
				t=n-j;
				for(k=1;k<=t;k++)
				{
					x=0;
					if(a[n-k+1][n-j+2]>x)
					x=a[n-k+1][n-j+2];
					if(a[n-k][n-j+2]>x)
					x=a[n-k][n-j+2];
					if(a[n-k+2][n-j+2]>x)
					x=a[n-k+2][n-j+2];
					a[n-k+1][n-j+1]=a[n-k+1][n-j+1]+x;
				}
			}
			x=0;
			
			
		    for(j=1;j<=s;j++)
		    {
				if(a[n-j][j-1]>a[n-j][j])
					u=a[n-j][j-1];
					else
					u=a[n-j][j];
				for(k=1;k<=s;k++)
				{
					if(n-j+1>n-k+1)
					t=n-k+1;
					else
					t=n-j+1;
					if(a[n-k+1][k+1]>a[n-k+2][k+1])
					v=a[n-k+1][k+1];
					else
					v=a[n-k+2][k+1];
		
				c=u+v+p[t];
				if(c>=x)
				x=c;
			}
		}
		    printf("%d\n",x);	
		}
		return(0);
	}
				     