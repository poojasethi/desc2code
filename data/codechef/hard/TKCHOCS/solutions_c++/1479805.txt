#include<stdio.h>
//#include<conio.h>
int main()
{
long int t,n,i,j,sum;
//long int a[502][502];
long int b,c,d,e,z,r,k,m;
scanf("%ld",&t);
while(t--)
{
long int a[502][502]={0};
scanf("%ld",&n);
for(i=1;i<=n;i++)
{

for(j=1;j<=i;j++)
scanf("%ld",&a[i][j]);
}



for(i=1;i<=n;i++)
{
for(j=1;j<=i;j++)
{
r=0;
if(i+j<n+1)
{
if(a[i-1][j-1]>r)
r=a[i-1][j-1];

if(a[i-1][j]>r)
r=a[i-1][j];

if(a[i-1][j+1]>r)
r=a[i-1][j+1];

a[i][j]=a[i][j]+r;
}
}
}

for(j=n;j>0;j--)
{
for(i=n;i>=j;i--)
{
r=0;
if(i+j>n+1)
{
if(a[i-1][j+1]>r)
r=a[i-1][j+1];

if(a[i][j+1]>r)
r=a[i][j+1];

if(a[i+1][j+1]>r)
r=a[i+1][j+1];

a[i][j]=a[i][j]+r;
}
}
}


for(i=n;i>0;i--)
{
for(j=1;j<=i;j++)
if(i+j==n+1)
{
a[i][j]=a[i][j]+a[i+1][j-1];
}
}
sum=0;r=0;
for(i=n;i>0;i--)
{
for(j=1;j<=i;j++)
{
if(i+j==n+1)
{
sum=a[i-1][j]+a[i][j];
if(sum>r)
{
r=sum;
b=a[i-1][j];
c=a[i][j];
}

sum=a[i-1][j-1]+a[i][j];

if(sum>r)
{
r=sum;
b=a[i-1][j-1];
c=a[i][j];
}

}
}
}
sum=0;r=0;
for(i=n;i>0;i--)
{
for(j=1;j<=i;j++)
{
if(i+j==n+1)
{
sum=a[i][j+1];
if(sum>r)
{
r=sum;
e=a[i][j+1];
d=a[i][j];
}

sum=a[i+1][j+1];

if(sum>r)
{
r=sum;
e=a[i+1][j+1];
d=a[i][j];
}

}
}
}
if(c<d)
c=d;
k=b+c+e;

sum=0;r=0;
for(i=n;i>0;i--)
{
for(j=1;j<=i;j++)
{
if(i+j==n+1)
{
sum=a[i-1][j];
if(sum>r)
{
r=sum;
b=a[i-1][j];
c=a[i][j];
}

sum=a[i-1][j-1];

if(sum>r)
{
r=sum;
b=a[i-1][j-1];
c=a[i][j];
}

}
}
}
sum=0;r=0;
for(i=n;i>0;i--)
{
for(j=1;j<=i;j++)
{
if(i+j==n+1)
{
sum=a[i][j+1]+a[i][j];
if(sum>r)
{
r=sum;
e=a[i][j+1];
d=a[i][j];
}

sum=a[i+1][j+1]+a[i][j];

if(sum>r)
{
r=sum;
e=a[i+1][j+1];
d=a[i][j];
}

}
}
}
if(c<d)
c=d;
m=b+c+e;

if(k>m)
printf("%ld\n",k);
else
printf("%ld\n",m);

}
//getch();
return 0;
	}