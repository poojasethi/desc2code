#include<stdio.h>
int t,n;
long long int po1,po2,ma1,ma2;
int st[501][501][3];
int r,m;
long long int tmp;
long long int a[502][502];
inline int find_max(int x,int y,int z,int &set)
{
if(x>=y)
{
if(x>=z)
{set=-1;return x;}
{set=1;return z;}
}
else
{
if(y>=z)
{set=0;return y;}
{set=1;return z;}
}
}
inline void init_arr()
{
for(int i=0;i<=n+1;i++)
{
for(int j=0;j<=n+1;j++)
{
a[i][j]=0;
}
}
}
inline long long int po(int k,bool tr)
{
init_arr();
for(int i=1;i<=n;i++)
{
tmp=-1;
for(int j=1;j<=n-i+1 && j<=i;j++)
{
a[i][j]=st[i][j][k]+find_max(a[i-1][j-1],a[i-1][j],a[i-1][j+1],r);
if(tr && st[i-1][j+r][0]>tmp)
{tmp=st[i-1][j+r][0];m=j+r;}
}
if(tr)
{st[i-1][m][2]=0;}
}
st[n][1][2]=0;
return a[n][1];
}
inline long long int ma(int k,bool tr)
{
init_arr();
for(int i=n;i>=1;i--)
{
tmp=-1;
for(int j=n;j>=n-i+1 && j>=i;j--)
{
//printf("%d %d\n",j,i);
a[j][i]=st[j][i][k]+find_max(a[j-1][i+1],a[j][i+1],a[j+1][i+1],r);
if(tr && st[j+r][i+1][0]>tmp)
{tmp=st[j+r][i+1][0];m=j+r;}
}
if(tr)
{st[m][i+1][1]=0;}
}
st[n][1][1]=0;
return a[n][1];
}
int main()
{
scanf("%d",&t);
for(int i=0;i<t;i++)
{
scanf("%d",&n);
for(int i=1;i<=n;i++)
{
for(int j=1;j<=i;j++)
{
scanf("%d",&st[i][j][0]);
st[i][j][1]=st[i][j][0];
st[i][j][2]=st[i][j][0];
}
}
po1=po(0,true);
ma1=ma(0,true);
/*for(int i=1;i<=n;i++)
{
for(int j=1;j<=n-i+1 && j<=i;j++)
{
printf("%d ",st[i][j][1]);
}
printf("\n");
}*/
po2=po(1,false);
ma2=ma(2,false);
//printf("%lld %lld %lld %lld\n",po1,po2,ma1,ma2);
if(po1+ma2>po2+ma1)
printf("%lld\n",po1+ma2);
else
printf("%lld\n",po2+ma1);
}
return 0;
}