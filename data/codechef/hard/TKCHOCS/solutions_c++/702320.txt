#include<iostream>
#include<cstdlib>
#include<cstring>
using namespace std;
int n,d[512][512],dia[512];
int main()
{
 int i,j,t,lim,ans;
 scanf("%d",&t);
 while(t--)
 {
  scanf("%d",&n);
  for(i=n;i>0;i--)
  {
	for(j=1;j<=n-i+1;j++)
	 scanf("%d",&d[i][j]);
	d[i][j]=d[i][j+1]=0;
  }

  for(j=1;j<=n+2;j++)
	d[0][j]=0;
  lim=(n+1)/2;

  for(i=1;i<=lim;i++)
	dia[i]=dia[i-1]+d[i][i];

  for(i=n-1;i>1;i--)
	for(j=1;j<=min(i-1,n-i+1);j++)
	 d[i][j]+=max(d[i+1][j-1],max(d[i+1][j],d[i+1][j+1]));

  for(j=n-1;j>1;j--)
	for(i=1;i<=min(j-1,n-j+1);i++)
	 d[i][j]+=max(d[i-1][j+1],max(d[i][j+1],d[i+1][j+1]));

  ans=0;
  for(i=1;i<=lim;i++)
	for(j=1;j<=lim;j++)
	 ans=max(ans,max(d[i+1][i-1],d[i+1][i])+max(d[j][j+1],d[j-1][j+1])+dia[max(i,j)]);
  printf("%d\n",ans);
 }
 return 0;
}
