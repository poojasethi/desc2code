#include <iostream>
#include <algorithm>
#include <cmath>
#include <string>
#include <vector>

#define ll long long

using namespace std;

int i,j,k,l,m,n,r1,r2,t,ans,p;
long long a[600][600],b[600][600],c[600][600];
ll max(ll a , ll b){
	if (a>b) return a; else return b;
}

int main(){
	cin>>t;
	for (int jj=0;jj<t;jj++){
		cin>>n;
		for (i=0;i<n;i++)
			for (j=0;j<=i;j++)
				scanf("%d",&a[i][j]);
		b[0][0]=a[0][0];
		b[n-1][n-1]=a[n-1][n-1];
		c[0][0]=a[0][0];
		c[n-1][n-1]=a[n-1][n-1];
		for (i=1;i<n;i++)
			for (j=0;(i+j<n);j++){
				long long mx=-1000000000;
				mx*=1000000000ll;
				if (j>0)
				mx=max(mx,a[i][j]+b[i-1][j-1]);
				mx=max(mx,a[i][j]+b[i-1][j]);
				mx=max(mx,a[i][j]+b[i-1][j+1]);
				b[i][j]=mx;
			}
		for (j=n-2;j>=1;j--)
			for (i=n-1;(i+j>=n);i--){
				long long mx=-1000000000;
				mx*=1000000000ll;
				if (i<n-1)
				mx=max(mx,a[i][j]+b[i+1][j+1]);
				mx=max(mx,a[i][j]+b[i-1][j+1]);
				mx=max(mx,a[i][j]+b[i][j+1]);
				b[i][j]=mx;
			}
		for (i=1;i<n;i++)
			for (j=0;(i+j<n-1);j++){
				long long mx=-1000000000;
				mx*=1000000000ll;
				if (j>0)
				mx=max(mx,a[i][j]+c[i-1][j-1]);
				mx=max(mx,a[i][j]+c[i-1][j]);
				mx=max(mx,a[i][j]+c[i-1][j+1]);
				c[i][j]=mx;
			}
		for (j=n-2;j>=0;j--)
			for (i=n-1;(i+j>=n-1);i--){
				long long mx=-1000000000;
				mx*=1000000000ll;
				if (i<n-1)
				mx=max(mx,a[i][j]+c[i+1][j+1]);
				mx=max(mx,a[i][j]+c[i-1][j+1]);
				mx=max(mx,a[i][j]+c[i][j+1]);
				c[i][j]=mx;
			}
		cout<<max(b[n-1][0]+b[n-1][1],c[n-1][0]+c[n-2][0])<<endl;
		for (i=0;i<n;i++)
			for (j=0;j<=i;j++){
				a[i][j]=0;
				b[i][j]=0;
				c[i][j]=0;
			}
	}
	return 0;
}