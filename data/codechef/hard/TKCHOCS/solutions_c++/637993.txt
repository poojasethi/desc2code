#include <cstdio>
#include <cstring>
#include <algorithm>
#include <iostream>
#define MAX 510
#define Mset(x,y) memset(x,y,sizeof(x))
using namespace std;

int T,ret,n;
int v[MAX][MAX],f[MAX][MAX],g[MAX][MAX];

inline int Tmax(int a,int b,int c)
{
	if (a<b) a=b;
	return (a>c?a:c);
}

int main()
{
	scanf("%d",&T);
	while (T--)
	{
		Mset(f,0); Mset(g,0);
		Mset(v,0); ret=0;
		scanf("%d",&n);
		for (int i=1;i<=n;++i)
			for (int j=1;j<=i;++j)
				scanf("%d",&v[i][j]);
		for (int i=1;i<=n;++i)
			for (int j=1;j<=n;++j)
				f[i][j]=Tmax(f[i-1][j-1],f[i-1][j],f[i-1][j+1])+v[i][j];
		for (int j=n;j>=1;--j)
			for (int i=j;i<=n;++i)
				g[i][j]=Tmax(g[i-1][j+1],g[i][j+1],g[i+1][j+1])+v[i][j];
		for (int r=n,c=1,tmp;c<=r;c++,r--)
			ret=max(ret,max(g[r][c]+f[n-1][1],f[r][c]+g[n][2]));
		printf("%d\n",ret);
	}
	return 0;
}
