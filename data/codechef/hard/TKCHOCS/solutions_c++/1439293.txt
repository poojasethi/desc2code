#include<stdio.h>
#define min(x,y) ((x<y)?x:y)
#define max(x,y) ((x<y)?y:x)
#define max3(x,y,z) ((x<y)?(y<z)?z:y:(x<z)?z:x)
#define min3(x,y,z) ((x>y)?(y>z)?z:y:(x>z)?z:x)
int chips[503][503],sum[260];
int n,i,j,t,temp,answer,mid;
int main()
{
    scanf("%d",&t);
    while(t--)
    {
      answer=0;
      scanf("%d",&n);
      mid=(n+1)/2;
      for(i=n;i>0;i--)
      {
      for(j=1;j<=n-i+1;j++)
      scanf("%d",&chips[i][j]);
      chips[i][0]=chips[0][i]=chips[i][j]=chips[i][j+1]=0;
      }
      chips[0][n+1]=chips[0][n+2]=chips[0][0]=chips[n+1][0]=chips[n+1][1]=chips[n+1][2]=0;
      sum[1]=chips[1][1];
      for(i=2;i<=mid;i++)
      sum[i]=sum[i-1]+chips[i][i];
      
      
      for(i=n-1;i>1;i--)
      for(j=1;j<=min(i-1,n-i+1);j++)
      chips[i][j]+=max3(chips[i+1][j-1],chips[i+1][j],chips[i+1][j+1]);
      
      for(j=n-1;j>1;j--)
      for(i=1;i<=min(j-1,n-j+1);i++)
      chips[i][j]+=max3(chips[i-1][j+1],chips[i][j+1],chips[i+1][j+1]);
      
      
      
      
      for(i=1;i<=mid;i++)
      for(j=1;j<=mid;j++)
      answer=max(answer, max(chips[i+1][i-1],chips[i+1][i])+ max(chips[j][j+1],chips[j-1][j+1])+ sum[max(i,j)]);
      printf("%d\n",answer);
      
    }
    return 0;
}
