#include <cstdio>
using namespace std;
const int mod=1000000007;
int cnt[100100],maxcnt,sumcnt,i,n,Q,s1[100100],s2[100100];
long long inv[100100],fac[100100],ifac[100100],f1[100100],f2[100100],ans[100100];
void calc(int x) {
	s1[1]+=(x+1)&1;s2[1]+=x+1;f1[1]=f1[1]*ifac[x+1]%mod;f2[1]=f2[1]*ifac[(x+1)/2]%mod;
	int las=x+1,S=0;
	for (int i=2;;i=S+1) {
		s1[i]-=las&1;s2[i]-=las;f1[i]=f1[i]*fac[las]%mod;f2[i]=f2[i]*fac[las/2]%mod;
		las=x/i+1;
		s1[i]+=las&1;s2[i]+=las;f1[i]=f1[i]*ifac[las]%mod;f2[i]=f2[i]*ifac[las/2]%mod;
		if (x/i==0) break; else S=x/(x/i);
	}
}
int main() {
	scanf("%d",&n);
	for (i=0;i<n;i++) {
		scanf("%d",&cnt[i]);
		if (cnt[i]>maxcnt) maxcnt=cnt[i];
		sumcnt+=cnt[i];
	}
	for (inv[1]=1,i=2;i<=sumcnt;i++) inv[i]=inv[mod%i]*(mod-mod/i)%mod;
	for (fac[0]=ifac[0]=i=1;i<=sumcnt;i++) fac[i]=fac[i-1]*i%mod,ifac[i]=ifac[i-1]*inv[i]%mod;
	for (i=0;i<=maxcnt;i++) f1[i]=f2[i]=1;
	for (i=0;i<n;i++) calc(cnt[i]-1);
	for (i=1;i<=maxcnt;i++) s1[i]=(s1[i]+s1[i-1])%mod,s2[i]=(s2[i]+s2[i-1])%mod,
		f1[i]=f1[i]*f1[i-1]%mod,f2[i]=f2[i]*f2[i-1]%mod;
	for (i=1;i<=maxcnt;i++)
		if (s1[i]<=1) ans[i]=(fac[s2[i]]*f1[i]+fac[s2[i]/2]*f2[i])%mod*inv[2]%mod;
		else ans[i]=fac[s2[i]]*f1[i]%mod*inv[2]%mod;
	for (scanf("%d",&Q);Q;Q--) {
		scanf("%d",&n);if (n>maxcnt) n=maxcnt;
		printf("%lld\n",ans[n]);
	}
}