#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
bool cmp(int a,int b)
{
    return abs(a)<abs(b);
}
long long show(long long array[],int num,int k)
{
    long long ans=1;
    int i;
    for(i=num-k;i<num;++i)
    ans=(ans*array[i])%mod;
    return ans;
}
int main()
{   int i,num=6,k=3,t;

cin>>t;
while(t--)
{
        int count=0,sign,j,i1,i2,j1,j2;
        bool flag1,flag2;
    scanf("%d%d",&num,&k);
    //long long ans,array[7]={-200000000,300000000,400000000,500000000,-600000000,700000000},ans1=INT_MIN,ans2=INT_MIN;
    long long ans,array[num+10],ans1=INT_MIN,ans2=INT_MIN;
    for(i=0;i<num;++i)
    {
        scanf("%lld",&array[i]);
        if(array[i]<=0)++count;
    }
    sort(array,array+num,cmp);
//for(i=0;i<num;++i)printf("%lld ",array[i]);
    ans=1,sign=1;
    for(i=num-k;i<num;++i)
    {
        ans=(ans*array[i])%mod;
        if(array[i]<0)sign*=-1;
    }

    if(sign>0 || num==k)
    printf("%lld\n",(ans+mod)%mod);
    else if(num==count)
        {   ans=1;
            for(i=0;i<k;++i)
            ans=(ans*array[i])%mod;
            printf("%lld\n",(ans+mod)%mod);
        }
    else
    {   flag1=false,flag2=false;
        for(j=num-k;j<num;++j)
        if(array[j]>0)
        {
            for(i=num-k-1;i>=0;--i)
            {   if(array[i]<=0)
                {
                swap(array[i],array[j]);
                i1=j,i2=i;
                flag1=true;
                break;
                }
            }
            break;
        }
        if(flag1)
        {
            ans1=show(array,num,k);
            swap(array[i],array[j]);
        }
        for(j=num-k;j<num;++j)
        if(array[j]<0)
        {
            for(i=num-k-1;i>=0;--i)
            {
                if(array[i]>0)
                {
                swap(array[i],array[j]);
                j1=j,j2=i;
                flag2=true;
                break;
                }
            }
            break;
        }
        if(flag2)
        {
            ans2=show(array,num,k);
            swap(array[i],array[j]);
        }
        if(flag1&&flag2)
          { if(array[i1]*array[j2]>array[i2]*array[j1])
            printf("%lld\n",ans2);
            else
            printf("%lld\n",ans1);
          }
        /*else if(!flag1 && !flag2)
        {   ans=1;printf("EXEcute\n");
            //while(true);
            for(i=0;i<k;++i)
            ans=(ans*array[i])%mod;
            printf("%lld\n",ans);
        }*/
        else
        {//printf("Last");
            printf("%lld\n",(max(ans1,ans2)+mod)%mod);
        }

    }


}
    return 0;
}
