#include <bits/stdc++.h>
using namespace std;
 
#define sd(x) scanf("%d", &x)
#define PB push_back
#define LL long long int 
 
#define N 2123456
 
LL p[N];
LL dp[N];
 
inline void solve(){
	int n, m, q, i, r;
	sd(n); sd(m); sd(q);
	n--;
	if(n & 1){
		p[n / 2 + 1] = n / 2 + 1 + 1;
	}
	else{
		p[n / 2 + 1] = 1;
	}
	for(i = n / 2; i >= 1; i--){
		p[i] = p[i + 1] * (i + 1);
		p[i] %= m;
		p[i] *= (n - i + 2);
		p[i] %= m;
	}
	//cout<<p[1]<<endl;
	dp[0] = 1;
	for(i = 1; i <= (n + 1) / 2; i++){
		dp[i] = dp[i - 1] * p[i];
		dp[i] %= m;
	}
	n++;
	while(q--){
		sd(r);
		if(r > n / 2){
			r = n - r;
		}
		printf("%lld\n", dp[r]);
	}
}
 
int main() {
	int t;
	sd(t);
	while(t--){
		solve();
	}
	return 0;
} 