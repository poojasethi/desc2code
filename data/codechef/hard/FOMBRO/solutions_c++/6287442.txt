#include<iostream>
#include<vector>
#define mod 1000000007
#include<cstdio>
using namespace std;
long long vec[500001];
long long fac[500001];
long long f(long long v,long long m){
long long ans=1;
for(long long i=2;i<=v;i++){ans*=i;ans%=m;}
return ans;

}
int main(){
int t;
long long ans,n,m,q,r;
int six,four,zero,w;
scanf("%d",&t);
while(t--){
    scanf("%lld %lld %lld",&n,&m,&q);
    //vec.resize(n+1);
    vec[0]=1;
    vec[1]=f(n,m);
    //cout<<vec[1]<<endl;
    if(n%2==0){
    fac[n/2-1]=((n/2+1))%m;
    }
    else{
        fac[n/2]=1;
          fac[n/2-1]=((((n/2+1)*(n/2+2))%m))%m;
    }

    for(int i=n/2-2;i>=0;i--){

        fac[i]=(((fac[i+1]*(i+2))%m)*(n-i))%m;

    }
    for(int i=1;i<(n/2);i++){
        vec[i+1]=((fac[i]*vec[i]))%m;
    }

    while(q--){
        scanf("%lld",&r);
        if(r>(n/2))r=n-r;
        printf("%lld\n",vec[r]);
    }

}
return 0;
}
