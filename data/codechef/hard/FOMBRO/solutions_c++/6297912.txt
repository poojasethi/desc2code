#include <bits/stdc++.h>

using namespace std;

#define PB push_back
#define F first
#define S second
#define PB push_back
#define MP make_pair
#define LL long long
#define sd(x) scanf("%d", &x)
#define sld(x) scanf("%lld", &x)
#define SQ 2000
#define N 2123456
#define SZ(X) ((int)(X).size())
#define ALL(X) (X).begin(), (X).end()
#define REP(I, A, B) for (int I = A; I <= B; ++I)
#define MS0(X) memset((X), 0, sizeof((X)))
#define MS1(X) memset((X), -1, sizeof((X)))
#define PII pair<int,int>
LL p[N], dp[N];
int solve(){
    LL i, n, m, q, r;
    cin>>n>>m>>q;
    LL MOD = m;
    if(n & 1){
        p[n / 2] = (n / 2 + 1) * (n / 2 + 2);
    }
    else{
        p[n / 2] = n / 2 + 1;
    }

    for(i = n / 2 - 1; i >= 1; i--){
        p[i] = p[i + 1] * (i + 1);
        p[i] %= MOD;
        p[i] *= (n - i + 1);
        p[i] %= MOD;
    }
    dp[1] = p[1];
    for(i = 2; i <= n / 2; i++){
        dp[i] = p[i] * dp[i - 1];
        dp[i] %= MOD;
    }
    while(q--){
        sld(r);
        if(r > (n / 2)){
            r = n - r;
        }
        printf("%lld\n", dp[r]);
    }
}

int main(){
    //freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);
    LL t = 1, o = 1, x, i;
    cin>>t;
    while(t--){
        solve();
    }
    return 0;
}
