#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<string>
#include<cstring>
#include<algorithm>
#include<vector>
#include<bitset>



#define f first
#define s second
#define pb push_back
#define MOD 1000000007

using namespace std;


typedef long long int ll;
typedef pair<int,int> pr;
long long int dp[33][33][130];

int countbit(int val)
{	int cnt,i;
	int z = 1;
	cnt = 0;
	for(i = 1;i <= 32;i++)
	{
		if(z&val)
			cnt++;
		z = z*2;
	}
	return cnt;
}

int main()
{	
	unsigned int i,j,k,l,t,d,sz,b,prev_bit,current_bit,m,newmask,max,n,y,prev,cont;

	cin>>t;
	
	while(t--)
	{
		cin>>n>>sz>>b;
		max = 1<<sz;
		d  = 1<<31;
		dp[0][0][0] = 1;
		for(i = 1; i <= 32;i++)
		{
			for(j = 0;j <= b;j++)
			{
				for(k = 0;k < max;k++)
				{

					for(l = 0;l < max;l++)
					{
						y = __builtin_popcount(l);
						newmask = 0;
						prev = 1;
						prev_bit = (d&(n))?1:0;
						cont = 0;
						for(m = 0;m < sz;m++)
						{
							current_bit = (l&prev)?1:0;
							
							if(k&(1<<m))
							{
								newmask += prev;
							}
							else
							{	
								if(prev_bit < current_bit)
								{
									cont = 1;
									break;
								}
								if(prev_bit > current_bit)
								{
									newmask += prev;		
								}
								
							}
							if(cont == 1)
							    break;
							prev = prev*2;
							prev_bit = current_bit;
						}
						if(cont == 1)
							continue;
						/*if(i == 32)
						{
							cout<<l<<" "<<dp[i-1][j][k]<<endl;
						}*/

						dp[i][j + (y%2)][newmask] = (dp[i][j + (y%2)][newmask] + dp[i-1][j][k])%MOD;
					}
				}				
			}
			d = d/2;
		}
		cout<<(dp[32][b][max-1] + dp[32][b][max-2])%MOD<<endl;
		memset(dp,0,sizeof(dp));
	}
	return 0;
}





