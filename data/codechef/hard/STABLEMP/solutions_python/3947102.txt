from sets import Set 
a = int(raw_input())
for k in range(a):
    women_list= []
    men_list = []
    
    women_propsed = []
    men_rejected = Set()  # set of unique rejected 
    
    
    noofpair = int(raw_input())
    for one in range(noofpair):
        women_list.append([])
        men_list.append([])
        women_propsed.append([])
        
    for one in range(noofpair):
        men_order=str(raw_input())
        order_m =men_order.split(" ")
        indice = order_m.pop(0)
        interlist = map(int,order_m)
        intlist = [x-1 for x in interlist]
        women_list[int(indice)-1] =intlist 
    for one in range(noofpair):
        women_order=str(raw_input())
        order_wm = women_order.split(" ")
        indicew = order_wm.pop(0)
        interlist = map(int,order_wm)
        intlist = [x-1 for x in interlist]
        men_list[int(indicew)-1] =intlist 
    
    #print women_list
    #print men_list

    #
    # ALL MEN PROPOSES 
    #
    for ss in range(len(men_list)):
            temp = men_list[ss].pop(0)
            women_propsed[temp].append(ss)
            #print ss
            #print women_propsed
    
    while True : 
        #
        # WOMEN REJECT LOWER ONE'S
        #
        for dd in range(len(women_propsed)):
            if (len(women_propsed[dd])>1):
                templis= women_propsed[dd][:]
                rank = []
                
                for ii in templis :
                    rank.append(women_list[dd].index(ii))
                
                minrank = min(rank)
                indexrank = rank.index(minrank)
                
                prefer_man =templis.pop(indexrank)
                
                women_propsed[dd] = [prefer_man]
                
                for aass in templis :
                    men_rejected.add(aass)
                #print men_rejected
        #
        # MEN REJECTED PROPOSES AGAIN
        #
        if len(men_rejected)==0:
            break 
        else :
            while(len(men_rejected)>0):
                men = men_rejected.pop()
                temp = men_list[men].pop(0)
                women_propsed[temp].append(men)
    woman_pair = []
    for ss in range(len(women_propsed)):
        woman_pair.append(women_propsed[ss][0])
    for tty in range(len(woman_pair)):
        print str(tty+1)+" "+str(woman_pair.index(tty)+1)
