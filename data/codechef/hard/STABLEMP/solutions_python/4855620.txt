import sys 
import copy

def getStableMatching(womenPrefs, menPrefs):
	freeMen = menPrefs.keys()
	freeWomen = womenPrefs.keys()
	engagement = {}
	marriage = {}
	for wmn in freeWomen:
		engagement[wmn] = None
	for mn in freeMen:
		marriage[mn]= None
	while freeMen:
		man = freeMen.pop(0)
		woman = menPrefs[man].pop(0)
		fiance = engagement[woman]
		if woman in freeWomen:
			freeWomen.remove(woman)
			engagement[woman] = man
			marriage[man] = woman
		else:
			if womenPrefs[woman].index(man)< womenPrefs[woman].index(fiance): #lower index higher rank
				engagement[woman] = man
				marriage[man] = woman
				if fiance not in freeMen:
					freeMen.append(fiance)
			else:
				freeMen.append(man)
	return marriage

lines = sys.stdin.readlines()
numTestCases = int(lines.pop(0))
for cases in range(numTestCases):
	n = int(lines.pop(0))
	womenPrefs = {}
	menPrefs = {}
	for women in range(n):
		lst = [int(x) for x in lines.pop(0).split(' ')]
		lst.pop(0)
		womenPrefs[women+1] = lst
	for men in range(n):
		lst = [int(x) for x in lines.pop(0).split(' ')]
		lst.pop(0)
		menPrefs[men+1] = lst
	matching = getStableMatching(womenPrefs,menPrefs)
	for k in matching:
		print '{0} {1}'.format(k,matching[k])