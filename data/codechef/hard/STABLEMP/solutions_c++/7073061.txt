#include <iostream>
#include <set>
using namespace std;
int main()
{
	int i, n, t, m, w, a, j;
	set <int> freemen, engmen;
	cin >> t;
	while (t)
	{
		cin >> n;
		bool* engaged = new bool[n + 1];
		int* wpartner = new int[n + 1];
		int* mpartner = new int[n + 1];
		int mrank[501][501], wrank[501][501], points[501][501];
		for (i = 1; i < n + 1; i++)
		{
			freemen.insert(i);
		}
		for (i = 1; i < n + 1; i++)
			engaged[i] = 0;
		engmen.clear();
		for (i = 0; i < n; i++)
		{
			cin >> w;
			for (j = 0; j < n; j++)
			{
				cin >> wrank[w][j];
				points[w][wrank[w][j]] = n - j;
			}
		}
		for (i = 0; i < n; i++)
		{
			cin >> m;
			for (j = 0; j < n; j++)
			{
				cin >> mrank[m][j];
			}
		}
		while (freemen.size())
		{
			m = *(freemen.begin());
			for (i = 0; i < n; i++)
			{
				w = mrank[m][i];
				if (engaged[w])
				{
					if (points[w][m] > points[w][wpartner[w]])
					{
						freemen.insert(wpartner[w]);
						engmen.erase(wpartner[w]);
						break;
					}
				}
				else
					break;
			}	
 
			freemen.erase(m);
			engmen.insert(m);
			wpartner[w] = m;
			engaged[w] = 1;
			mpartner[m] = w;
 
			
		}
		for (i = 1; i < n + 1; i++)
			cout << i << " " << mpartner[i] << endl;
		t--;
	}
	return 0;
}