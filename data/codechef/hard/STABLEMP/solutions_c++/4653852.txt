#include <stdio.h>



int main(int argc, char const *argv[])
{
	int n,i,k,j,t,temp,temp2,s,b;
	scanf("%d",&n);
	for(i=0;i<n;i++)
	{
		scanf("%d",&k);
		int m[k][k+2],w[k][k+2];
		for(j=0;j<k;j++)
		{
			for(t=0;t<k+1;t++)
				scanf("%d",&m[j][t+1]);
			m[j][0]=0;
		}
		for(j=0;j<k;j++)
		{
			for(t=0;t<k+1;t++)
				scanf("%d",&w[j][t+1]);
			w[j][0]=0;
		}
		
		for(j=0;j<k;j++)
		{
			if(w[j][0]!=0)
				continue;
			for(t=0;t<k;t++)
			{
				if(w[j][t+2]==0)
					continue;
				temp=w[j][t+2];
				w[j][t+2]=0;
				if(m[temp-1][0]==0)
				{
					m[temp-1][0]=j+1;
					w[j][0]=temp;
					break;
					
				}
				temp2=m[temp-1][0];
				b=1;
				s=2;
				while(m[temp-1][s]!=temp2)
				{
					
					if(m[temp-1][s]==j+1)
					{
						m[temp-1][0]=j+1;
						w[j][0]=temp;
						w[temp2-1][0]=0;
						b=0;
						j=temp2-2;
						break;
					}
					s++;

				}
				if(b==0)
				{
					
					break;
				}
							
			}
				
		}
		
		
		
		for(j=0;j<k;j++)
		{
			printf("%d %d",w[j][1],w[j][0]);
			printf("\n");
			
		}			
		
	}
	return 0;
}