#include<bits/stdc++.h>
using namespace std ;

int t , n , u , m[501][501] , w[501][501] ;

void stableMP()
{ 
   int ptr[501] , pri[501][501] , curw[501] ;
   queue<int> Q ;   
   for(int i=1 ; i<=n ; i++) {
      Q.push(i) ; ptr[i]=1 , curw[i]=0 ;
      for(int j=1 ; j<=n ; j++) pri[i][w[i][j]]=j ;
   }
   
   while(!Q.empty())
   {
      int x=Q.front() ; 
      Q.pop() ;

      while(ptr[x]<=n) {
	    int y=m[x][ptr[x]++] ;  
	    if(!curw[y])  { curw[y]=x ; break ; } 
	    else {
		    int z=curw[y] ;
			if(pri[y][z] > pri[y][x]) {
			   curw[y]=x ; Q.push(z) ;
			   break ; 			    
			} 
		}
	 }  	  
   }
   
   for(int i=1 ; i<=n ; i++) printf("%d %d\n",curw[i],i) ;     
}

int main()
{
   scanf("%d",&t) ; 
   while(t--)  {
      scanf("%d",&n) ; 
      for(int i=1 ; i<=n && scanf("%d",&u) ; i++) for(int j=1 ; j<=n ; j++) scanf("%d",&w[u][j]) ; 
	  for(int i=1 ; i<=n && scanf("%d",&u) ; i++) for(int j=1 ; j<=n ; j++) scanf("%d",&m[u][j]) ;  
      stableMP() ; 
   }
   return 0 ;
}