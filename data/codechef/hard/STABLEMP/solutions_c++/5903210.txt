#include <cstdio>
using namespace std;

int* gale_shapley(int n, int **men, int **women) {

    int *free_men = new int[n],
        cnt = 0,
        *proposed = new int[n],
        *engaged = new int[n],
        **index = new int*[n];

    for (int i = 0; i < n; i++) {
        free_men[cnt++] = i;
        proposed[i] = 0;
        engaged[i] = n;

        index[i] = new int[n];
        for (int j = 0; j < n; j++) {
            index[i][women[i][j]] = j;
        }
    }

    while (cnt > 0) {
        int man = free_men[cnt - 1];
        int woman = men[man][proposed[man]++];

        if (index[woman][man] < engaged[woman]) {
            int old_man = engaged[woman];
            if (old_man < n) {
                free_men[cnt - 1] = women[woman][old_man];
            } else {
                cnt--;
            }

            engaged[woman] = index[woman][man];
        }
    }

    for (int i = 0; i < n; i++) {
        delete[] index[i];
    }

    delete[] free_men;
    delete[] proposed;
    delete[] index;

    return engaged;
}

void readn( register int *n ) {
    register char c;
    *n = 0;
    while((c = getc_unlocked(stdin)) != '\n') {
        switch(c) {
            case ' ': return;
            case '\n': return;
            default: (*n) *= 10; (*n) += (c - '0'); break;
        }
    }
}

int main() {

    int tests;
    readn(&tests);
    // scanf("%d\n", &tests);

    for (int test = 0; test < tests; test++) {

        int n;
        readn(&n);
        // scanf("%d\n", &n);

        int **men = new int*[n],
            **women = new int*[n];

        for (int i = 0; i < n; i++) {
            int x;
            readn(&x);
            // scanf("%d", &x);
            x--;
            men[x] = new int[n];
            for (int j = 0; j < n; j++) {
                // scanf("%d", &men[x][j]);
                readn(&men[x][j]);
                men[x][j]--;
            }
        }

        for (int i = 0; i < n; i++) {
            int x;
            // scanf("%d", &x);
            readn(&x);
            x--;
            women[x] = new int[n];
            for (int j = 0; j < n; j++) {
                // scanf("%d", &women[x][j]);
                readn(&women[x][j]);
                women[x][j]--;
            }
        }

        int *engaged = gale_shapley(n, men, women);
        for (int i = 0; i < n; i++) {
            printf("%d %d\n", i+1, women[i][engaged[i]]+1);
        }

        for (int i = 0; i < n; i++) {
            delete[] men[i];
            delete[] women[i];
        }

        delete[] men;
        delete[] women;
        delete[] engaged;
    }

    return 0;
}

