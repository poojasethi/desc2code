#include <bits/stdc++.h>
using namespace std;
#define N 500
int prop[N + 1][N + 1];
int prp[N + 1];
int ptr[N + 1];

int act[N + 1];
int ranka[N + 1][N + 1];
int main()
{
    int tc,t;
    scanf("%d",&tc);
    for(t = 1 ; t<=tc ; t++)
    {
        int i,j,n;
        scanf("%d",&n);
        for(i = 1 ; i<=n ; i++)
        {
            int x;
            scanf("%d",&x);
            for(j = 1 ; j<=n ; j++)
            {
                int m;
                scanf("%d",&m);
                ranka[x][m] = j;
            }
            ranka[x][0] = n+1;
            act[i] = 0;
        }
        for(i = 1 ; i<=n ; i++)
        {
            int x;
            scanf("%d",&x);
            for(j = 1 ; j<=n ; j++)
            {
                scanf("%d",&prop[x][j]);
            }
            prp[i] = 0;
            ptr[i] = 1;
        }
        while(1)
        {
            for(i = 1 ; i<=n ; i++)
            {
                if(prp[i] == 0) break;
            }
            if(i == n+1) break;


            for(j = ptr[i] ; j<=n ; j++)
            {
                int w = prop[i][j];
                int m = act[w];
                if(ranka[w][m] > ranka[w][i])
                {
                    act[w] = i;
                    ptr[i] = j+1;
                    prp[i] = w;
                    prp[m] = 0;
                    break;
                }
            }
        }
        for(i = 1 ; i<=n ; i++) printf("%d %d\n",i,prp[i]);
    }
    return 0;
}
