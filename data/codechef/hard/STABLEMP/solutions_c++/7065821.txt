/*
Author : lifecodemohit
Problem : http://www.codechef.com/problems/STABLEMP
*/

#include <bits/stdc++.h>
using namespace std;
 
#define ll 					long long int
#define MOD 				1000000007
#define sn(n) 				scanf("%lld",&n)
#define pn(n) 				printf("%lld\n",n)
#define ss(str) 			scanf("%s",str)
#define ps(str) 			printf("%s\n",str)
#define rep(i,s,e) 			for(i=s;i<=e;i++)
#define reprev(i,s,e) 		for(i=s;i>=e;i--)
#define reps(b,e,g,str) 	for(b=str,e=&str[g-1];b<=e;b++) 
#define mem(arr,val) 		memset(arr,val,sizeof(arr))
#define dis(arr,s,e) 		for(i=s;i<=e;i++) printf("%lld ",arr[i]); printf("\n"); 
#define pb(i)				push_back(i)
#define mp(i,j)				make_pair(i,j)

struct position {
	ll x;
	ll cur;
};

struct by_cur {
	bool operator()(const position& a,const position& b)
	{
		return a.cur<b.cur;
	}
};

int main()
{
	ll t;
	sn(t);
	while(t--)
	{
		ll i,j,y,z,top,top1,list[510],list1[510],mmark[510],w[510][510],m[510][510],cur[510],end,n;
		sn(n);
		rep(i,0,n-1)
		{
			sn(y);
			cur[y]=0;
			w[y][0]=-1;
			rep(j,0,n-1)
			{
				sn(z);
				w[y][z]=n-j;
			}
		}
		rep(i,0,n-1)
		{
			sn(y);
			mmark[y]=0;
			list[i]=y;
			rep(j,0,n-1)
			{
				sn(z);
				m[y][j]=z;
			}
		}
		top=n-1;
		while(top>-1)
		{
			end=top;
			top1=-1;
			rep(i,0,end)
			{
				y=list[i];
				z=m[y][mmark[y]];
				if(w[z][y]>w[z][cur[z]])
				{
					if(cur[z]!=0)
					{
						top1++;
						list1[top1]=cur[z];
					}
					cur[z]=y;
				}
				else
				{
					top1++;
					list1[top1]=y;
				}
				mmark[y]++;
			}
			rep(i,0,top1)
			{
				list[i]=list1[i];
			}
			top=top1;
		}
		vector<position> v1;
		rep(i,1,n)
		{
			position P;
			P.x=i;P.cur=cur[i];
			v1.pb(P);
		}
		sort(v1.begin(),v1.end(),by_cur());
		rep(i,0,n-1)
			printf("%lld %lld\n",v1[i].cur,v1[i].x);
	}
	return 0;
}
