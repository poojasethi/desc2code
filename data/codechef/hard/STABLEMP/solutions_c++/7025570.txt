#include <stdio.h>
#include <queue>

using namespace std;

int womens_preference[500][500], mens_preference[500][500], women_married_to[500], not_proposed_by_men[500];

int main()
{
    int t;
    scanf("%d", &t);
    while(t--)
    {
		int n;
        scanf("%d", &n);
        int temp1, temp2;
        for(int i=0; i<n; i++)
        {
			women_married_to[i] = -1;
            scanf("%d", &temp1);
            for(int j=n-1; j>=0; j--)
            {
                scanf("%d", &temp2);
                womens_preference[temp1-1][temp2-1] = j;
            }
        }
        queue<int> single_men;
        for(int i=0; i<n; i++)
        {
            scanf("%d", &temp1);
            not_proposed_by_men[i] = 0;
            single_men.push(temp1-1);
            for(int j=0; j<n; j++)
            {
                scanf("%d", &temp2);
                mens_preference[temp1-1][j] = temp2-1;
            }
        }
        int banda, bandi;
        while(!single_men.empty())
        {
			banda = single_men.front();
			bandi = mens_preference[banda][not_proposed_by_men[banda]];
			not_proposed_by_men[banda]++;
			if(women_married_to[bandi] == -1)
			{
				women_married_to[bandi] = banda;
				single_men.pop();
			}
			else if(womens_preference[bandi][banda] > womens_preference[bandi][women_married_to[bandi]])
			{
				single_men.push(women_married_to[bandi]);
				women_married_to[bandi] = banda;
				single_men.pop();
			}
		}
        for(int i=0;i<n;i++)
        {
            printf("%d %d\n", women_married_to[i]+1, i+1);
        }
    }
    return 0;
}
