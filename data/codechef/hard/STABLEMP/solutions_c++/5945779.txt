#include <stdio.h>
#include <iostream>
#include <queue>
#include <vector>
using namespace std;

int main()
{
	int t;
	int n;
	scanf("%d",&t);
	while(t > 0)
	{
	scanf("%d",&n);
	int men[501][501];
	int women[501][501];
	int husband[501] ;
	int wife[501] ;
	int next_pref[501] ;
	husband[0] = 0;
	wife[0] = 0;
	next_pref[0] = 0;
	int row;
	queue<int> single_men;
	int pref;
	for (int i = 1; i <= n; ++i)
	{
		scanf("%d",&row);
		for (int j = 1; j <= n; ++j)
		{
			scanf("%d",&pref);
			women[row][pref] = j;
		}
		
	}
	for (int i = 1; i <= n; ++i)
	{
		single_men.push(i);
		husband[i] = 0;
		wife[i] = 0;
		next_pref[i] = 1;
		scanf("%d",&row);
		for (int j = 1; j <= n; ++j)
		{
			scanf("%d",&men[row][j]);
		}
		
	}
	
	int removed_men;
	int current_women;
	int current_men;
	while(!single_men.empty())
	{
		current_men = single_men.front();
		single_men.pop();
		
		while(1)
		{
			current_women = men[current_men][next_pref[current_men]];
			if (husband[current_women] == 0)
			{
				husband[current_women] = current_men;
				wife[current_men] = current_women;
				next_pref[current_men] = next_pref[current_men] + 1;
				break;
			}
			else if(women[current_women][current_men] < women[current_women][husband[current_women]])
			{
				removed_men = husband[current_women];
				wife[removed_men] = 0;
				single_men.push(removed_men);
				husband[current_women] = current_men;
				wife[current_men] = current_women;
				next_pref[current_men] = next_pref[current_men] + 1;
				break;
			}
			else
			{
				next_pref[current_men]++;
			}
		}
		
	}
	for (int i = 1; i <=n; ++i)
	{
		printf("%d %d\n",i,wife[i]);
	}
	t--;
    }

	return 0;
}