#include <bits/stdc++.h>
using namespace std;
#define si(t) scanf("%d", &t)
#define MAX 505
int men[MAX][MAX], women[MAX][MAX], menflag[MAX], mmatch[MAX], wmatch[MAX];
int n;

bool preferMoverM1(int w, int m, int m1)
{
    for(int i = 1; i <= n; i++) {
        if(women[w][i] == m) {
            return true;
        }
        else if(women[w][i] == m1) {
            return false;
        }
    }
}

void stable_marriage()
{
    int free_men = n;

    //initially all men are free
    for(int i = 0; i <= n; i++) {
        menflag[i] = 0;
        wmatch[i] = -1;
    }

    while(free_men > 0) {
        int m;
        //finding men who is free
        for(m = 1; m <= n; m++) {
            if(menflag[m] == 0) {
                break;
            }
        }

        for(int i = 1; i <= n && menflag[m] == 0; i++) {
            int w = men[m][i];

            //if woman is free
            if(wmatch[w] == -1) {
                menflag[m] = 1;
                wmatch[w] = m;
                free_men--;
            }
            //if m prefer over m1 ..... then update
            else {
                int m1 = wmatch[w];
                if(preferMoverM1(w, m, m1)) {
                    wmatch[w] = m;
                    menflag[m1] = 0;
                    menflag[m] = 1;
                }
            }
        }
    }
}

void input()
{
    si(n);
    for(int i = 1; i <= n; i++) {
        for(int j = 0; j <= n; j++) {
              si(women[i][j]);
        }
    }

    for(int i = 1; i <= n; i++) {
        for(int j = 0; j <= n; j++) {
            si(men[i][j]);
        }
    }
}

void print()
{
    for(int i = 1; i <= n; i++) {
        mmatch[wmatch[i]] = i;
    }
    for(int i = 1; i <= n; i++) {
        printf("%d %d\n", i, mmatch[i]);
    }
}

int main()
{
    int t; si(t);
    while(t--) {
        input();
        stable_marriage();
        print();
    }
    return 0;
}
