//
// Bhumik Shah
//    IIIT Hyderabad
//
#include <bits/stdc++.h>

#define mod 1000000007
#define f(i,a,b) for(i=a;i<b;i++)
#define ll long long
#define clr(a) memset(a,0,sizeof(a))
#define out(n) cout<<n<<"\n";
#define in(n) cin>>n;

using namespace std;

inline void sins(int &x)
{
register int c = getchar_unlocked();
x = 0;
int neg = 0;
for(; ((c<48 || c>57) && c != '-'); c = getchar_unlocked());
if(c=='-') {
neg = 1;
c = getchar_unlocked();
}
for(; c>47 && c<58 ; c = getchar_unlocked()) {
x = (x<<1) + (x<<3) + c - 48;
}
if(neg)
x = -x;
}


int main()
{
	int test=0;
	sins(test);
	while(test>0)
	{
		vector<vector<int> > women;
		vector<vector<int> > men;
		map<int,int> m;
		int men_free[505]={0},women_free[505]={0};
		queue<int> free_men;
		int num=0;
		sins(num);
		int i=0,k=0,j=0,w=0;
		vector<int> temp;
		for(i=0;i<num;i++)
		{
			sins(w);
			w--;
			for(j=0;j<num;j++)
			{
				sins(k);
				k--;
				temp.push_back(k);
			}
			women.push_back(temp);
			temp.clear();
		}
		for(i=0;i<num;i++)
		{
			sins(w);
			w--;
			for(j=0;j<num;j++)
			{
				sins(k);
				k--;
				temp.push_back(k);
			}
			men.push_back(temp);
			temp.clear();
		}
		for(i=0;i<num;i++)
		{
			//if(men_free[i]==0)
			//{
				free_men.push(i);
			//}
		}
		int temp1=0,temp2=0,w1=0,flag=0;
		while(!free_men.empty())
		{
			temp1=free_men.front();
			free_men.pop();
			for(i=0;i<num;i++)
			{
				flag=0;
				if(women_free[men[temp1][i]]==0)
				{
					m[men[temp1][i]]=temp1;
					men_free[temp1]=1;
					women_free[men[temp1][i]]=1;
					break;
				}
				else
				{
					temp2=m[men[temp1][i]];
					w1=men[temp1][i];
					for(j=0;j<num;j++)
					{
						if(women[w1][j]==temp1)
						{
							flag=1;
							break;
						}
						if(women[w1][j]==temp2)
						{
							flag=2;
							break;
						}
					}
					if(flag==1)
					{
						m.erase(m.find(w1));
						men_free[temp2]=0;
						men_free[temp1]=1;
						m[w1]=temp1;
						free_men.push(temp2);
						break;
					}
					else
					{
						continue;
					}
				}
			}
			if(men_free[temp1]==0)
			{
				free_men.push(temp1);
			}
		}
		map<int,int>::iterator it1;
		map<int,int> ans;
		for(it1=m.begin();it1!=m.end();it1++)
		{
			ans[(*it1).second+1]=(*it1).first+1;
		}
		for(it1=ans.begin();it1!=ans.end();it1++)
		{
			cout<<(*it1).first<<" "<<(*it1).second<<"\n";
		}
		test--;
	}
	return 0;
}














