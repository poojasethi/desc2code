#include<bits/stdc++.h>
using namespace std;

inline void inp( int &n )
{
n=0;
int ch=getchar();int sign=1;
while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getchar();}

while(  ch >= '0' && ch <= '9' )
n = (n<<3)+(n<<1) + ch-'0', ch=getchar();
n=n*sign;
}

int wprefth[504][504],mprefth[504][504],w[504],m[504],wpref[504][504],mpref[504][504];
int T,N;
int garbag;
int main()
{
    inp(T);
    while(T--)
    {
        inp(N);
        for(int i=0;i<N;i++){inp(garbag);for(int j=0;j<N;j++){inp(garbag);wprefth[i][j]=--garbag;wpref[i][garbag]=j;}}
        for(int i=0;i<N;i++){inp(garbag);for(int j=0;j<N;j++){inp(garbag);mprefth[i][j]=--garbag;mpref[i][garbag]=j;}}

        for(int i=0;i<N;i++){w[i]=-1;m[i]=-1;}
        int freecnt=N;//of Man
        int i=0;
        while(freecnt)
        {
            for(;;i=(i+1)%N)
                if(m[i]==-1)break;

            for(int j=0;j<N;j++)
            {

                if(w[mprefth[i][j]]==-1)
                {
                    w[mprefth[i][j]]=i;
                    m[i]=mprefth[i][j];
                    freecnt--;
                    break;
                }
                else if(wpref[mprefth[i][j]][i]<wpref[mprefth[i][j]][w[mprefth[i][j]]])
                {
                    m[w[mprefth[i][j]]]=-1;
                    w[mprefth[i][j]]=i;
                    m[i]=mprefth[i][j];
                    break;
                }
            }
        }

        for(int i=0;i<N;i++)
        {
            cout<<i+1<<" "<<m[i]+1<<endl;
        }


    }

}
