        #include<stdio.h>

        unsigned int a[501][501];
        int m,n;
        unsigned int maxcnt;
        unsigned int count[501][501];

        void readMatrix(unsigned m,unsigned n)
        {
            register unsigned i,j,temp;
        	char c;

        	for(i = 0; i < m; i++)
        	{
        		for(j = 0; j < n; j++)
        		{

        			int temp;
        			scanf("%u",&temp);
        			a[i][j] = temp;
        		}
        	}
        }

        void jump(int i,int j)
        {
            count[i][j] = 1;
        	int p,q;
        	int min = 1000001;
        	int max = 0;

        	for(q=j+1;q<n;q++)
        	{
        		if( (a[i][q]>=a[i][j]) && (a[i][q] < min) )
        		{
        			min = a[i][q];

        			if( count[i][j] < (1 + count[i][q]) )count[i][j] = count[i][q] + 1;
        			if(a[i][j] == min)break;
        		}
        	}
        	for(p=i+1;p<m;p++)
        	{
        		if( (a[p][j]<=a[i][j]) && a[p][j] > max )
        		{
        			max = a[p][j];

        			if( count[i][j] < (count[p][j] + 1) )count[i][j] = count[p][j] + 1;
        			if(a[i][j] == max)break;
        		}
        	}
        	if(count[i][j]>maxcnt)maxcnt=count[i][j];
        }

        int main()
        {

        	unsigned int t;
        	int i,j;

        	scanf("%u",&t);

        	while(t--)
        	{
        		maxcnt=0;
        		scanf("%u%u",&m,&n);

        		readMatrix(m,n);

        		for(i=m-1;i>=0;i--)
        			for(j=n-1;j>=0;j--)
        				jump(i,j);
        		printf("%u\n",maxcnt);
        	}
        	return 0;
        }
