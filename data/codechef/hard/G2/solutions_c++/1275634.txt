#include <iostream>
#include <set>
#include <vector>
using namespace std;
 
 
char input[50000000];
int numcharsin;
int inpos = 0;
int map[500][500];
int m,n;
 
int getint() {
	while (input[inpos]<'0' || input[inpos]>'9') inpos++;
	int ret = 0;
	while (inpos<numcharsin && input[inpos]>='0' && input[inpos]<='9') 
          ret = 10*ret+input[inpos++]-'0';
	return ret;
}

int find_longest(int m, int n) {
  int max = 0;
  int score[500][500];
  for (int i = 0; i < m; i ++)
    for (int j = 0; j < n; j ++) {
      score[i][j] = 1;
      // jump right
	  int colLeader=-1;
      for (int k = j -1; k >= 0; k --) {
        if (map[i][k] <= map[i][j] && map[i][k] > colLeader) {
			if( score[i][k] >= score[i][j])
				score[i][j] = score[i][k] + 1;
			colLeader=map[i][k];
			if(colLeader==map[i][j]) break;
        }
	  }
      // jump down
	  int rowLeader=99999999;
	  for (int k = i-1; k >= 0; k --) {
        if (map[k][j] >= map[i][j]&& map[k][j] < rowLeader) {
			if( score[k][j] >= score[i][j])
				score[i][j] = score[k][j] + 1;
			rowLeader=map[k][j];
			if(rowLeader==map[i][j]) break;
        }
	  }

      // record max score
      if (score[i][j] > max) max = score[i][j];
    }
	return max;
}
 

 
int main() {
	cin.read(input,50000000);
	numcharsin = cin.gcount();
	int T = getint(); 
    while (T--) {
		m=getint();
		n=getint();
		for (int i=0; i<m; i++)
			for (int j=0; j<n; j++) 
				map[i][j]=getint();
		int ret = find_longest(m,n);
		printf("%d\n",ret);
	}
}

