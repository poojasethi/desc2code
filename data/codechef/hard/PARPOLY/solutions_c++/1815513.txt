#include<cstdio>
const int d=15,n=805,m=405,oo=1000000007;
int i,j,k,N,M,X,D,T;
int C[d],g[n],f[n],h[n];
int p(int x)
{
	int i,res=0,y=1;
	for(i=0;i<=D;++i)
	{
		res=((long long)C[i]*y+res)%oo;
		y=(long long)y*x%oo;
	}
	return res;
}
int main()
{
	for(scanf("%d",&T);T--;)
	{
		scanf("%d%d%d",&M,&N,&X);
		scanf("%d",&D);
		for(i=0;i<=D;++i) scanf("%d",&C[i]);
		for(i=0;i<=N;++i) g[i]=p((long long)X*i%oo);
		for(i=0;i<=N;++i) f[i]=0;
		f[0]=1;
		for(;M;M>>=1)
		{
			if(M&1)
			{
				for(j=0;j<=N;++j) h[j]=0;
				for(j=0;j<=N;++j)
					for(k=0;j+k<=N;++k)
						h[j+k]=((long long)f[j]*g[k]+h[j+k])%oo;
				for(j=0;j<=N;++j) f[j]=h[j];
			}
			for(j=0;j<=N;++j) h[j]=0;
			for(j=0;j<=N;++j)
				for(k=0;j+k<=N;++k)
					h[j+k]=((long long)g[j]*g[k]+h[j+k])%oo;
			for(j=0;j<=N;++j) g[j]=h[j];
		}
		printf("%d\n",f[N]);
	}
	return 0;
}
