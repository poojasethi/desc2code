#include<stdio.h>
long long int a[4][1000][500]={0},c[11]={0},d,par[4][801]={0},x,r[4][801][401]={0};
long long int p(long long int k,long long int t)
{
     if(par[t][k])
     return par[t][k];
     long long int i;
     long long int s=c[0],m=k;
     for(i=1;i<=d;i++)
     {
                  s+=(c[i]*m)%1000000007;
                  m*=k;
                  m%=1000000007;
                  s%=1000000007;
                  }
                  return par[t][k]=s;
}
long long int f(long long int n,long long int m,long long int t)
{
     if(r[t][n][m])
     return a[t][n][m];
     if(m==1)
     {
     r[t][n][m]=1;
     return a[t][n][m]=p(n,t);
     }
     long long int i;
     long long int s=1;
     if(n==0)
     {
             for(i=0;i<m;i++)
             {
             s*=c[0];
             s%=1000000007;
             }
             r[t][n][m]=1;
             return a[t][n][m]=s;
             }
             s=0;
     for(i=0;i<=n;i++)
     {
     s+=(f(i,m/2,t)*f(n-i,(m+1)/2,t))%1000000007;
     s%=1000000007;
     }
     r[t][n][m]=1;
     return a[t][n][m]=s;
 } 
int main()
{
    long long int t;
    scanf("%lld",&t);
    while(t--)
    {
    long long int m,n,i,j,b=1;
    scanf("%lld %lld %lld",&m,&n,&x);
    x%=1000000007;
    scanf("%lld",&d);
    for(i=0;i<=d;i++)
    {
    scanf("%lld",&c[i]);
    c[i]*=b;
    c[i]%=1000000007;
    b*=x;
    b%=1000000007;
    }
    if((x==1000000007||x==0)&&(c[0]==0||c[0]==1000000007))
    {
                                                       printf("0\n");  
                                                       continue;                         
                                                       }
    printf("%lld\n",f(n,m,t));
}
    return 0;
}