#include<stdio.h>

#define LL long long
#define R 1000000007
#define FOR(i,s,n) for(i=s;i<n;i++)

LL p[900],q[900],ans[900];
LL n,m,x;

void mult(LL *a,LL *b)
{
	int i,j;
	LL c[900]={0};
	FOR(i,0,n+1)
	{
		FOR(j,0,n-i+1)
		{
			c[i+j]+= (a[i]*b[j]) %R;
			c[i+j] %=R;
		}
	}
	FOR(i,0,n+1)
		a[i]=c[i];
}

void poly()
{
	int i,j;
	ans[0]=1;
	while(m)
	{
		if(m%2==1)
			mult(ans,p);
		mult(p,p);
		m/=2;
	}
}

int main()
{
	int N;
	scanf("%d",&N);
	while(N--)
	{
		scanf("%lld%lld%lld",&m,&n,&x);
		int d;
		scanf("%d",&d);
		int i,j;
		LL t=1;
		for(i=0;i<=n;i++)
		{
			q[i]=1;
			p[i]=ans[i]=0;
		}
		FOR(j,0,d+1)
		{
			LL y;
			scanf("%lld",&y);
//			scanf("%lld",&p[j]);
			
			FOR(i,0,n+1)
			{
				p[i]+=(y*q[i])% R;
				p[i]%= R;
				q[i]*=(i*x) %R;
				q[i] %= R;
			}
			
		}
		poly();
		printf("%lld\n",ans[n]);
	}
	return 0;
}
