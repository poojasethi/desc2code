#include <bits/stdc++.h>
using namespace std;
 
const int mod=1000000007;
 
int n,m,q;
long long g;

int c[5611255]={0};
long long int a[5611255];
long long int cc[5611255];
 
int main(){
    scanf("%d %d %d",&n,&m,&q);
    n++,m++;
    int h[n][m],hor[n][m],ver[n][m],d1[n][m],d2[n][m+1];
    for(int i=1;i<n;i++) for(int j=1;j<m;j++) scanf("%d",&h[i][j]);
    for(int i=0;i<n;i++) hor[i][0] = ver[i][0] = d1[i][0] = d2[i][0] = d2[i][m] = 0;
    for(int j=0;j<m;j++) hor[0][j] = ver[0][j] = d1[0][j] = d2[0][j] = 0;
    for(int i=1;i<n;i++) for(int j=1;j<m;j++) hor[i][j] = h[i][j] + hor[i][j-1],ver[i][j] = h[i][j] + ver[i-1][j],d1[i][j] = h[i][j] + d1[i-1][j-1],d2[i][j] = h[i][j] + d2[i-1][j+1];
    
    for(int i=1;i<n;i++){
	for(int j=1;j<m;j++){
	    int t1,t2,t3,t4,t5,t6,t7,t8;
	    t1 = t2 = t3 = t4 = t5 = t6 = t7 = t8 = h[i][j];
	    for(int k=1;k<335;k++){
		if(j+k<m && i>k) c[t1 += d1[i][j+k] - d1[i-k-1][j-1]]++;
		if(i+k<n && j+k < m) c[t2 += d2[i+k][j] - d2[i-1][j+k+1]]++;
		if(i+k<n && j>k)c[t3 += d1[i+k][j] - d1[i-1][j-k-1]]++;
		if(j>k && i>k) c[t4 += d2[i][j-k] - d2[i-k-1][j+1]]++;
		if(i+k < n && j+k < m && j>k) c[t5 += hor[i+k][j+k] - hor[i+k][j-k-1]]++;
		if(i>k && j+k < m && j>k)c[ t6 += hor[i-k][j+k] - hor[i-k][j-k-1]]++;
		if(i+k<n && j+k<m && i>k) c[t7 += ver[i+k][j+k] - ver[i-k-1][j+k]]++;
		if(i+k<n && j>k && i>k) c[t8 += ver[i+k][j-k] - ver[i-k-1][j-k]]++;
	    }
	}
    }
    a[0]= cc[0] = 0;
    for(int i=1;i<5611255;i++) {
    	a[i] = a[i-1] + c[i]*i;
	cc[i] = cc[i-1] + c[i];
    }
    n = 5611255;
    for(int i=0;i<q;i++){
    	scanf("%d",& g);
	if(g == 0) printf("0\n");
	else if(g >= a[n-1]) cout << cc[n-1] << endl;
	else{
	    long long *p = lower_bound(a,a+n,g);
	    cout << cc[p-a-1] + (g-a[p-a-1])/(p-a) << endl;
	}
    }
    
    return 0;
}
