#include<bits/stdc++.h>
using namespace std;
#define SF(x)	scanf("%d", &x)
#define PF(x)	printf("%d", x)
#define psp     printf(" ")
#define pnl     printf("\n")
#define charint(c) ((c)-'0')
#define pii pair< int, int >
#define pb(x) push_back(x)
#define test int t; scanf("%d",&t);while(t--)
#define forall(a,b) for(long long i=a;i<=b;i++)
#define abs(a) ((a)>(0)?(a):(-a))
#define bit(x,i)          (x&(1<<i))  //select the bit of position i of x
#define lowbit(x)         ((x)&((x)^((x)-1))) 
#define higbit(x)         (1 << ( int) log2(x) )
#define countleadzero(x)  __builtin_ctz(x) //in its binary representation ex. when x=8 answer is 3
#define countsetbits(x)   ____builtin_popcount(x) //count no of setbits
#define gcd(a,b)   __gcd(a,b)
#define bss binary_search
#define esort(x)        (sort((x).begin(), (x).end()))
#define ersort(x)       (sort((x).rbegin(), (x).rend()))
#define MAX		100050
#define MOD     1000000007
#define fi first
#define se second
#define INF 1111111111
int ck[6001111];
typedef long long 		ll;
typedef unsigned long long	ull;
int main(){
int n,m,q;
cin>>n>>m>>q;
int a[n][m];
for(int i=0;i<n;i++){
	for(int j=0;j<m;j++){
		cin>>a[i][j];
	}
}
ll row[n+1][m+1],col[n+1][m+1];
vector<ll > v,v1;
for(int i=0;i<=n;i++){
	row[i][0]=0;
}
for(int i=0;i<=m;i++){
	col[0][i]=0;
}

for(int i=1;i<=n;i++){
	for(int j=1;j<=m;j++){
		row[i][j]=a[i-1][j-1]+row[i][j-1];
	}
}
for(int i=1;i<=m;i++){
	for(int j=1;j<=n;j++){
		col[j][i]=a[j-1][i-1]+col[j-1][i];
	}
}
/*for(int i=1;i<=n;i++){
	for(int j=1;j<=m;j++){
		cout<<row[i][j]<<" ";
	}
	pnl;
}pnl;
for(int i=1;i<=n;i++){
	for(int j=1;j<=m;j++){
		cout<<col[i][j]<<" ";
	}
	pnl;
}*/
ll s;
for(int i=0;i<n;i++){
	for(int j=0;j<m;j++){
		for(int k=1,s=a[i][j];i-k>=0&&j+k<m;k++){
			s+=row[i-k+1][j+k+1]-row[i-k+1][j];
			ck[s]++;//cout<<"@1"<<endl;
		}
		for(int k=1,s=a[i][j];i+k<n&&j+k<m;k++){
			s+=row[i+k+1][j+k+1]-row[i+k+1][j];
			ck[s]++;//cout<<"@2"<<endl;
		}
		for(int k=1, s=a[i][j];i-k>=0&&j-k>=0;k++){
			s+=row[i-k+1][j+1]-row[i-k+1][j-k];
			ck[s]++;//cout<<"@3"<<endl;
		}
		for(int k=1, s=a[i][j];i+k<n&&j-k>=0;k++){
			s+=row[i+k+1][j+1]-row[i+k+1][j-k];
			ck[s]++;//cout<<"@4"<<endl;
		}
		for(int k=1, s=a[i][j];i-k>=0&&j+k<m&&j-k>=0;k++){
			s+=row[i-k+1][j+k+1]-row[i-k+1][j-k];
			ck[s]++;//cout<<"@5"<<endl;
		}
		for(int k=1, s=a[i][j];i+k<n&&j+k<m&&j-k>=0;k++){
			s+=row[i+k+1][j+k+1]-row[i+k+1][j-k];
			ck[s]++;//cout<<"@6"<<endl;
		}
		for(int k=1, s=a[i][j];i-k>=0&&i+k<n&&j-k>=0;k++){
			s+=col[i+k+1][j-k+1]-col[i-k][j-k+1];
			ck[s]++;
		}
		for(int k=1, s=a[i][j];i-k>=0&&i+k<n&&j+k<m;k++){
			s+=col[i+k+1][j+k+1]-col[i-k][j+k+1];
			ck[s]++;
		}
	}
}

/*for(vector<ll> ::iterator it=v.begin();it!=v.end();it++){
	cout<<*it<<" ";
}pnl;*/v1.pb(0);
forall(1,6001110){
    while(ck[i]--){
        int cz=v1.back()+i;
        v1.pb(v1.back()+i);
        if (cz >= INF) break;
    }
    if (v1.back() >= INF) break;
}

while(q--){
	ll g;
	cin>>g;
	int l=0,nn=v1.size();
	while(nn-l>1){
	   // cout<<l<<" # "<<nn<<endl;
		int m=(l+nn)/2;
		if(v1[m]<=g)
		l=m;
		else
		nn=m;
	}
	cout<<l<<endl;
}
}