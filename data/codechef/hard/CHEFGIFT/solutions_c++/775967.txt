#include<iostream>
#include<cstdio>
#include<cstring>

using namespace std;
#define MIN(a,b) (a > b)? b : a
#define INIT(a) memset(a,0,sizeof(a))
#define LIM 100
#define INF 1000000007
int toll[LIM][LIM],cost[LIM][LIM],dp[LIM][LIM];

int main(){
    int T;
    scanf("%d",&T);
    while(T-- > 0){
        int  D,n,m,temp,ans;
        scanf("%d %d %d",&D,&n,&m);
		INIT(toll);
		INIT(cost);
		INIT(dp);
        for(int i=0;i<m;i++)
            for(int j=0;j<n;j++){
                scanf("%d",&toll[i][j]);
                if(j == 0)
                    dp[i][j] = toll[i][j];
            }
        for(int i=0;i<m;i++)
            for(int j=0;j<m;j++)
                scanf("%d",&cost[i][j]);
		 for(int k=0;k<m;k++)
            for(int i=0;i<m;i++)
                for(int j=0;j<m;j++)
					cost[i][j] = MIN(cost[i][j],cost[i][k] + cost[k][j]);
        for(int j=1;j<n;j++){
            for(int i=0;i<m;i++){
				int x = INF;
                for(int k=0;k<m;k++)
                    x = MIN(x,dp[k][j-1] + cost[k][i] + toll[i][j]);
				dp[i][j] = x;
                }
            }
        temp = dp[0][n-1];
        for(int i=1;i<m;i++)
                temp = MIN(temp,dp[i][n-1]);
        if(temp > D)
            printf("%d\n",-1);
        else
			printf("%d\n",D - temp);
        }
    }
