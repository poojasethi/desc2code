#include<iostream>
#include<algorithm>
#include<cstdio>
using namespace std;

#define MAX 1000000000

int t,n,m,d,c[100][100],a[100][100],dp[100][101];



int main(){
	
	int i,j,k,ans;
	cin>>t;
	while(t--)
	{
		ans=MAX;
		scanf("%d%d%d",&d,&n,&m);
		for(i=0;i<m;i++)
			for(j=0;j<n;j++)
			{
				scanf("%d",&a[i][j]);
				dp[i][j]=1000000000;
			}
		for(i=0;i<m;i++)
			for(j=0;j<m;j++)
				scanf("%d",&c[i][j]);

		for(k=0;k<m;k++)
			for(i=0;i<m;i++)
				for(j=0;j<m;j++)
					c[i][j]=min(c[i][j],c[i][k]+c[k][j]);

		for(i=0;i<m;i++)
			dp[i][n]=0;

		for(j=n-1;j>=0;j--)
			for(i=0;i<m;i++)
				for(k=0;k<m;k++)
					dp[i][j]=min(dp[i][j],a[i][j] + c[i][k] + dp[k][j+1]);


		for(i=0;i<m;i++)
			ans=min(ans,dp[i][0]);
		//cout<<d-ans<<"                ";
		printf("%d\n",max(d-ans,-1));
	}


	return 0;

}