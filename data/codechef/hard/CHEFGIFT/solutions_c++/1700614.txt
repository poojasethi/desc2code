#include <cstdio>

#define min(a, b) (a<b ? a: b)

int main()
{
    int t;
    scanf("%d", &t);
    while(t--) {
        int money, tolls, roads;
        int tollCost[100][100], mechCost[100][100];
        scanf("%d %d %d", &money, &tolls, &roads);

        for(int i=0; i<roads; i++) for(int j=0; j<tolls; j++) scanf("%d", &tollCost[i][j]);
        for(int i=0; i<roads; i++) for(int j=0; j<roads; j++) scanf("%d", &mechCost[i][j]);

        //minimise mechCost using all pair shortest path
        for(int k=0; k<roads; k++) 
            for(int i=0; i<roads; i++)
                for(int j=0; j<roads; j++) 
                    mechCost[i][j] = min(mechCost[i][j], mechCost[i][k]+mechCost[k][j]);

        int minCost[100][100];
        //min cost from last toll on road
        for(int i=0; i<roads; i++) minCost[i][0] = tollCost[i][0];

        for(int j=1; j<tolls; j++) for(int i=0; i<roads; i++) {
            minCost[i][j] = minCost[i][j-1];
            for(int k=0; k<roads; k++)
                minCost[i][j] = min(minCost[i][j], minCost[k][j-1]+mechCost[k][i]);
            minCost[i][j] += tollCost[i][j];
        }

        int ans = minCost[0][tolls-1];
        for(int i=1; i<roads; i++) ans = min(ans, minCost[i][tolls-1]);

        if(money>=ans)
            printf("%d\n", money-ans);
        else
            puts("-1");
    }
}
