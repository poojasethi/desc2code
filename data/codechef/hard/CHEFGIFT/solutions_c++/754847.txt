#include<stdio.h>
#include<stdlib.h>

using namespace std;

typedef int ll;

int main(){
	
	ll cases;
	scanf("%d",&cases);
	ll **nm;
	ll **c;// =new ll*[200];
	ll **c1;//=new ll*[200];
	ll *first;//=new ll[200];
	ll *second;//=new ll[200];
	nm=(ll **)malloc(200*sizeof(ll *));
	c=(ll **)malloc(200*sizeof(ll *));
	c1=(ll **)malloc(200*sizeof(ll *));
	first=(ll *)malloc(200*sizeof(ll));
	second=(ll *)malloc(200*sizeof(ll));
	ll ww,d,n,m,i,j,k,min,flag;

	for(i=0;i<200;i++){
		nm[i]=(ll *)malloc(200*sizeof(ll));//=new ll[200];
		c[i]=(ll *)malloc(200*sizeof(ll));//=new ll[200];
		c1[i]=(ll *)malloc(200*sizeof(ll));//=new ll[200];
	}	

	for(ww=0;ww<cases;ww++){

		scanf("%d",&d);
		scanf("%d",&n);
		scanf("%d",&m);
		for(i=0;i<m;i++){
			for(j=0;j<n;j++){
				scanf("%d",&nm[i][j]);
			}
		}
		
		for(i=0;i<m;i++){
			for(j=0;j<m;j++){
				scanf("%d",&c[i][j]);
			}
		}
				
		///*while(1){
		
			for(i=0;i<m;i++){
				for(j=0;j<m;j++){
					c[i][j]=c[i][j];
				}
			}
			flag=0;
			for(i=0;i<m;i++){
				for(j=0;j<m;j++){
					for(k=0;k<m;k++){
						if(c[j][i]+c[i][k]<c[j][k]){
							flag=1;
							c[j][k]=c[j][i]+c[i][k];
						}
					}
				}
			}
		//	if(flag==0)break;
		
		//}*/
		
			
		for(i=0;i<m;i++){
			first[i]=0;
		}
			
		for(i=0;i<n;i++){
			for(j=0;j<m;j++){
				first[j]=first[j]+nm[j][i];
			}
			for(j=0;j<m;j++){
				second[j]=first[j]+c[j][j];
				for(k=0;k<m;k++){
					if(second[j]>first[k]+c[k][j]){
						second[j]=first[k]+c[k][j];
					}
				}
			}
			for(j=0;j<m;j++){
				first[j]=second[j];
			}
		}
		
		min=200000;
		for(j=0;j<m;j++){
			if(first[j]<min){
				min=first[j];
			}
		}
		
		if(min>d){ min=-1;printf("-1\n");}
		else printf("%d\n",d-min);
	
	}

	return 0;
}