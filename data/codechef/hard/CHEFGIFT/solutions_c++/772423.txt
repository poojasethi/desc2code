#include <cstdio>
#include <algorithm>
using namespace std;
 
int main(){
	int T, D, N, M, toll[100][100], C[100][100], dp[2][100];
	scanf("%d", &T);
	while(T--){
		scanf("%d %d %d", &D, &N, &M);
		for(int i=0; i<M; i++)
		for(int j=0; j<N; j++)
			scanf("%d", &toll[i][j]);
		for(int i=0; i<M; i++)
		for(int j=0; j<M; j++)
			scanf("%d", &C[i][j]);
		for(int k=0; k<M; k++)
		for(int i=0; i<M; i++)
		for(int j=0; j<M; j++)
			C[i][j]=min(C[i][j], C[i][k]+C[k][j]);
		int *cur=dp[0], *next=dp[1];
		for(int i=0; i<M; i++)
			cur[i]=0;
		for(int i=0; i<N; i++){
			for(int j=0; j<M; j++)
				next[j]=cur[j]+toll[j][i];
			for(int j=0; j<M; j++)
			for(int k=0; k<M; k++)
				next[j]=min(next[j], next[k]+C[k][j]);
			swap(cur, next);
		}
		int res=*min_element(cur, cur+M);
		printf("%d\n", res>D ? -1 : D-res);
	}
	return 0;
}