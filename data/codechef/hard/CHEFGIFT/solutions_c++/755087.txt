#include <stdio.h>
#include <stdlib.h>
#include<limits.h>
#include<fcntl.h>
#include<sys/stat.h>

#define MAX 107
#define KB 1024

#define INF 99999999


int d[MAX][MAX];

int c[MAX][MAX],g[MAX][MAX];
int n,m,D;






int main()
{
  int t;

  register int i,j,k;
   int ans,min,temp;


  scanf("%d",&t);
//fs(t);

  while (   t> 0 )
    {

      scanf("%d %d %d",&D,&n,&m);
   //  fs(D);
     //fs(n);
     //fs(m);


      for ( i=1;i<=m;i++ )
        {
          for (j=1;j<=n;j++)
            {
              scanf("%d",&g[i][j]);
     //         fs(g[i][j]);
            }
        }

      for (i=1;i<=m;i++)
        {
          for (j=1;j<=m;j++)
            {
              scanf("%d",&c[i][j]) ;
              //fs(c[i][j]);
            }
        }


  for( k=1;k<=m;k++ )
  {
    for( i=1;i<=m;i++ )
    {
      for( j=1;j<=m;j++ )
      {
        if( c[i][j] > ( c[i][k]+c[k][j] ) )
        c[i][j] =c[i][k]+c[k][j];
        else
        c[i][j]= c[i][j];

      }
    }

  }



      for ( i=1  ;  i<=n  ;  i++ )
        {
          for ( j=1 ;  j<=m ; j++ )
            {
                min=INT_MAX;
              for ( k=1;k<=m;k++ )
                {
                  temp = d[k][i-1]+c[k][j];

                  if ( min >= temp )
                    {
                      min=temp;
                    }
                }

              d[j][i] = min  + g[j][i];

            }
        }

min=INT_MAX;
for(i=1;i<=m;i++)
{
    temp = d[i][n];

    if( min>=temp )
    {
      min=temp;
    }

}

if(  (D-min) >= 0 )
ans=D-min;
else
ans=-1;



printf("%d\n",ans);


      t--;
    }


  return 0;
}
