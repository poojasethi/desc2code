#include<iostream>
#define rep(a,b,c) for(a=b;a<c;a++)

#define getcx                   getchar_unlocked
inline void inp( int &n )
{
       n = 0;
       int ch=getcx(); int sign = 1;
       while( ch < '0' || ch > '9' )  { if ( ch == '-' ) sign = -1; ch=getcx(); }
       while( ch >= '0' && ch <= '9' ) n=(n<<3)+(n<<1)+ch-'0', ch=getcx();
       n = n*sign;
}
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
              int i,j,k,D,n,m,min;
            //  scanf("%d %d %d",&D,&n,&m);
              inp(D);inp(n);inp(m);
              int t[m][n],c[m][m],f[m][n];
              rep(i,0,m)
              rep(j,0,n)
       //       scanf("%d",&t[i][j]);
                inp(t[i][j]);
              rep(i,0,m)
              rep(j,0,m)
          //    scanf("%d",&c[i][j]);
                inp(c[i][j]);
              
              for (k = 0; k < m; ++k) {
	//	printDist();
		for (i = 0; i < m; ++i)
			for (j = 0; j < m; ++j)
					if ((c[i][k] + c[k][j] < c[i][j]))
						c[i][j] = c[i][k] + c[k][j];
	}
              
              rep(i,0,m)
              f[i][0]=t[i][0];
              rep(j,1,n)
              rep(i,0,m)
              {
                        min=c[0][i]+f[0][j-1];
                        rep(k,1,m)
                        if(min>c[k][i]+f[k][j-1])
                        min=c[k][i]+f[k][j-1];
                        f[i][j]=t[i][j]+min;
              }
              min=f[0][n-1];
              rep(i,1,m)
              if(min>f[i][n-1])
              min=f[i][n-1];
              if(D<min)printf("-1\n");
              else printf("%d\n",D-min);
    }
         //     system("pause");
              return 0;
}
              
                                     
              
    
    
