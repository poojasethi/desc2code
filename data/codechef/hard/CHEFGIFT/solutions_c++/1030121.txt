#include<iostream>
int min(int a,int b)
{
    return a<b?a:b;
}
#ifdef ONLINE_JUDGE
#	define gc getchar_unlocked
#else
#	define gc getchar
#endif
inline void fps(int &x)
{
    register int c = gc();
	x = 0;
    for(;((c<48 || c>57));c = gc());
    for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
}
main()
{
      int t,n,m,i,j,k,d,map[101][101],cost[101][101],dp[101][101],mini;
      fps(t);
      while(t--)
      {
            mini=1000000;    
            fps(d);fps(n);fps(m);
            for(i=1;i<=m;i++)
            for(j=1;j<=n;j++)
            {fps(map[i][j]);dp[i][j]=1000000;}
            for(i=1;i<=m;i++)
            for(j=1;j<=m;j++)
            fps(cost[i][j]);
            for(k=1;k<=m;k++)
            for(i=1;i<=m;i++)
            for(j=1;j<=m;j++)
            cost[i][j]=min(cost[i][j],cost[i][k]+cost[k][j]);
            for(i=1;i<=m;i++)
            dp[i][1]=map[i][1];
            for(j=2;j<=n;j++)
            for(i=1;i<=m;i++)
            for(k=1;k<=m;k++)
            dp[i][j]=min(dp[i][j],dp[k][j-1]+cost[k][i]+map[i][j]);
            for(i=1;i<=m;i++)
            if(dp[i][n]<mini)
            mini=dp[i][n];
            mini=d-mini;
            if(mini<0)
            printf("-1\n");
            else
            printf("%d\n",mini);
      }
      //system("pause");
}                                          
