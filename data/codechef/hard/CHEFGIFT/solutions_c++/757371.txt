#include <iostream>
#include <cstdio>
#include <algorithm>
#include <cstring>
#include <queue>
#include <vector>
using namespace std;
const int MAX = 105;
int n , d, m, c[MAX][MAX], road[MAX][MAX],opt[MAX][MAX];
int main(){
	int t;
	scanf("%d", &t);
	while(t--){
	    scanf("%d%d%d", &d, &n, &m);
	    for( int i = 0; i < m; i++)
	    	for( int j = 0; j < n; j++)
	    		scanf("%d", &road[i][j]);
	    for( int i = 0; i < m; i++)
	    	for( int j = 0; j < m; j++)
	    		scanf("%d", &c[i][j]);
	    for( int k = 0; k < m; k++)
	    	for( int i = 0; i < m; i++)
	    		for( int j = 0; j < m; j++)
	    			c[i][j] = min( c[i][j] , c[i][k] + c[k][j]);
	    int r = 1<<30;
	    for( int i = 0; i < n; i++)
	    	for( int j = 0; j < m; j++)
	    		opt[i][j] = 1<<30;
	    for( int i = 0; i < m; i++)
	    	opt[0][i] = road[i][0];
	    for( int i = 1; i < n; i++)
	    	for( int j = 0; j < m; j++)
	    		for( int k = 0; k < m; k++)
	    			opt[i][j] = min (opt[i][j], opt[i-1][k] + c[k][j] + road[j][i]);
	    for( int i = 0; i < m; i++)
	    	r = min ( r, opt[n - 1][i]);
	    if( r <= d && r != -1)
	    	printf("%d\n", d - r);
	    else
            printf("-1\n");
    }
	return 0;
}
