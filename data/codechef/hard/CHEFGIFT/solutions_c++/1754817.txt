#include<iostream>
#include<cstdio>
#include<cstring>
#include<string>
#include<cstdlib>
#include<vector>
#include<map>
#include<set>
#include<queue>
#include<stack>
#include<cmath>
#include<cctype>
#include<algorithm>
using namespace std;
#define pb push_back
#define mp make_pair
#define cin(n) scanf("%d",&n)
#define gc getchar_unlocked
typedef vector<int> VI;
int fcin(){register int c = gc();int x = 0;for(;(c<48 || c>57);c = gc());for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}return x;}
int arr[101][101];
int C[101][101];
int dis[101][101];
typedef pair<int,pair<int,int> > PIP; 
set<PIP> s;
int D,n,m;
void dijkstra(){
	PIP x;
	int a,b,c;
	while(!s.empty()){
		x = *s.begin(); 
		s.erase(s.begin());
		a=x.second.first; 
		b=x.second.second;
		c=x.first;
		for(int i=0;i<m;i++){
			if(dis[i][b]>c+C[a][i]){
				dis[i][b]=c+C[a][i]; 
				s.insert(mp(dis[i][b],mp(i,b)));
			}
		}
		if(b<n && dis[a][b+1] > c + arr[a][b]){
			dis[a][b+1]=c+arr[a][b];
			s.insert(mp(dis[a][b+1],mp(a,b+1)));
		}
	}
}
int main(){
	int tests=fcin();
	while(tests--){
		D=fcin();n=fcin();m=fcin();
		for(int i=0;i<m;i++){
			for(int j=0;j<n;j++)arr[i][j]=fcin(),dis[i][j]=(int)1e9;
			dis[i][n]=(int)1e9;
		}
		for(int i=0;i<m;i++)for(int j=0;j<m;j++)C[i][j]=fcin(); 
		for(int i=0;i<m;i++)dis[i][0]=0,s.insert(mp(0,mp(i,0))); 
		dijkstra();
		int ans = (int)1e9 ;
		
		for(int i=0;i<m;i++)ans=min(ans,dis[i][n]);
		if(ans>D)printf("-1\n");
		else printf("%d\n",D-ans); 
	}
}