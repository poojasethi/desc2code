//http://www.codechef.com/problems/CHEFGIFT
 
#include <stdio.h>
 
using namespace std;
 
int move[200][200];
int toll[200][200];
int d, n, m;
 
int main()
{
	int tests;
	scanf("%d", &tests);
	while(tests--)
	{
		scanf("%d %d %d", &d, &n, &m);
		int i = 0;
		while(i<m)
		{
			int j = 0;
			while(j<n)
			{
				scanf("%d", &toll[i][j]);
				j++;
			}
			i++;
		}
		i = 0;
		while(i<m)
		{
			int j = 0;
			while(j<m)
				scanf("%d", &move[i][j++]);
			i++;
		}

		//Floyd-warshall to find least costs to switch roads, directly or indirectly via other roads
		for(int k=0; k<m; k++)
		{
			for(int i=0; i<m; i++)
			{
				for(int j=0; j<m; j++)
				{
					if(move[i][j] > move[i][k]+move[k][j])
						move[i][j] = move[i][k]+move[k][j];
				}
			}
		}

		for(int j = 1; j<n; j++)
		{
			for(int i = 0; i<m; i++)
			{
				int j2 = j-1;
				int min = toll[i][j2];
				for(int i2 = 0; i2<m; i2++)
				{
					int temp = toll[i2][j2]+move[i2][i];
					if(min>temp)
						min = temp;
				}
				toll[i][j] += min;
			}
		}

		int min = toll[0][n-1];
		for(int i = 1; i<m; i++)
		{
			if(min>toll[i][n-1])
				min = toll[i][n-1];
		}
		
		int res = d-min;
 
		if(res<0)
			printf("-1\n");
		else
			printf("%d\n", res);
	}
	return 0;
} 