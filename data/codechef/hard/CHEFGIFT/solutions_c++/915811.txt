#include<stdio.h>

#define max 100

int min(int a, int b)
{
	if(a<b)
		return a;
	return b;
}

int main()
{
	int i, j, k, l, n, m, ans, D, t;
	int c[max][max];
	int toll[max][max];
	scanf("%d", &t);
	while(t--)
	{
		scanf("%d %d %d", &D, &n, &m);
		for(i=0;i<m;i++)
			for(j=0;j<n;j++)
				scanf("%d", &toll[i][j]);
		for(i=0;i<m;i++)
			for(j=0;j<m;j++)
				scanf("%d", &c[i][j]);
		for(i=0;i<m;i++)
			for(j=0;j<m;j++)
				for(l=0;l<m;l++)
					c[j][l] = min(c[j][l], c[j][i]+c[i][l]);
		for(i=1;i<n;i++)
			for(j=0;j<m;j++)
			{
				l = toll[j][i-1];
				for(k=0;k<m;k++)
					l = min(l, toll[k][i-1]+c[k][j]);
				//printf("%d %d\t", toll[j][j], toll[j][i]);
				toll[j][i] +=l;
				//printf("toll[%d][%d]: %d\n", i, j, toll[j][i]);
			}
		l=toll[0][n-1];	
		for(i=0;i<m;i++)
		{
			//printf("toll[%d][%d]: %d\n", n-1, i, toll[n-1][i]);
			l = min(l, toll[i][n-1]);
		}
		//printf("L: %d\n", l);
		if(l>D)
			printf("-1\n");
		else
			printf("%d\n", D-l);
	}
	return 0;
}
