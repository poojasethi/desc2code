#include<bits/stdc++.h>
using namespace std;
int dp[101][101];
int cst[101][101];
int toll[101][101];

int main() {
	int t,n,m,i,j,k,u,v,d;
	scanf("%d",&t);
	while (t--) {
		scanf("%d %d %d",&d,&n,&m);
		for (i=0;i<m;i++) {
			for (j=0;j<n;j++) {
				scanf("%d",&toll[i][j]);
			}
		}
		for (i=0;i<m;i++) {
			for (j=0;j<m;j++) {
				scanf("%d",&cst[i][j]);
			}
		}
		memset(dp,-1,sizeof(dp));
		for (i=0;i<m;i++) {
			dp[i][0]=toll[i][0];
		}
		for (k=0;k<m;k++) {
			for (i=0;i<m;i++) {
				for (j=0;j<m;j++) {
					cst[i][j]=min(cst[i][k]+cst[k][j],cst[i][j]);
				}
			}
		}
		for (j=1;j<n;j++) {
			for (i=0;i<m;i++) {
				for (k=0;k<m;k++) {
					if (dp[i][j]==-1) dp[i][j]=dp[k][j-1]+toll[i][j]+cst[k][i];
					else dp[i][j]=min(dp[i][j],dp[k][j-1]+toll[i][j]+cst[k][i]);
				}
			}
		}
		int ans=dp[0][n-1];
		for (i=1;i<m;i++) {
			ans=min(ans,dp[i][n-1]);
		}
		if (ans>d) printf("%d\n",-1);
		else printf("%d\n",d-ans);
	}
	return 0;
}



