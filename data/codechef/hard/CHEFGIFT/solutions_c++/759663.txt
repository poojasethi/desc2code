#include<cstdio>
#define LIM 100

bool solve(int D,int n,int m)
{
    int toll[LIM][LIM],move[LIM][LIM],cost[LIM][LIM];
    int min,c;
    bool possible;

    for(int i=0; i<m; i++)
        for(int j=0; j<n; j++)
            scanf("%d",&toll[i][j]);
    for(int i=0; i<m; i++)
        for(int j=0; j<m; j++)
            scanf("%d",&move[i][j]);

    for(int k=0; k<m; k++)
        for(int i=0; i<m; i++)
            for(int j=0; j<m; j++)
            {
                min = move[i][k]+move[k][j];
                move[i][j] = (move[i][j]<min ? move[i][j] : min);
            }

    possible=false;
    for(int i=0; i<m; i++)
    {
        cost[i][0]=toll[i][0];
        if(cost[i][0]<=D)
            possible=true;
    }

    if(!possible)
    {
        printf("-1\n");
        return false;
    }

    for(int t=1; t<n; t++)
    {
        possible=false;
        for(int i=0; i<m; i++)
        {
            min=cost[i][t-1];

            for(int k=0; k<m; k++)
            {
                if(k==i)
                    continue;
                c=cost[k][t-1]+move[k][i];
                if(c < min)
                    min=c;
            }
            cost[i][t]=min+toll[i][t];

            if(cost[i][t]<=D)
                possible=true;
        }
        if(!possible)
        {
            printf("-1\n");
            return false;
        }
    }
    min=cost[0][n-1];
    for(int i=1; i<m; i++)
        if(cost[i][n-1]<min)
            min=cost[i][n-1];

    printf("%d\n",D-min);
    return true;
}

int main()
{
    //freopen("caravan.txt","r",stdin);
    int cases,D,n,m;

    scanf("%d",&cases);
    while(cases--)
    {
        scanf("%d%d%d",&D,&n,&m);
        solve(D,n,m);
    }
    return 0;
}
