#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#define N 300005
#define mo 998244353
#define Long long long
#define For(i,l,r) for(int i=l;i<=r;i++)
using namespace std;
int n,rev[N],W[N][2],a[N],b[N],ans[N];
int power(int a,int b){
	int c=1;
	while(b){
		if(b&1) c=(Long)c*a%mo;
		b>>=1; a=(Long)a*a%mo;
	}
	return c;
}
void Init(int m){
	for(n=1;n<=m;n<<=1); n<<=1;
	for(int i=0;i<n;i++){
		int x=i,y=0;
		for(int k=1;k<n;k<<=1,x>>=1) y<<=1,y|=x&1;
		rev[i]=y;
	}
	int P,Ret;
	P=power(3,(mo-1)/n); Ret=1;
	for(int i=0;i<n;i++) W[i][0]=Ret,Ret=(Long)Ret*P%mo;
	P=power(P,mo-2); Ret=1;
	for(int i=0;i<n;i++) W[i][1]=Ret,Ret=(Long)Ret*P%mo;
}
void FWT(int a[],int f){
	for(int i=0;i<n;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);
	for(int i=1;i<n;i<<=1)
	for(int j=0,t=n/(i<<1);j<n;j+=(i<<1))
	for(int k=0,l=0;k<i;k++,l+=t){
		int x=a[k+j],y=(Long)a[k+j+i]*W[l][f]%mo;
		a[k+j]=(x+y)%mo;
		a[k+j+i]=(x-y+mo)%mo;
	}
	int Rev=power(n,mo-2);
	if(f) for(int i=0;i<n;i++) a[i]=(Long)a[i]*Rev%mo;
}
int na,nb,tmp[N];
void FFT(int a[],int b[]){
	FWT(a,0); FWT(b,0);
	for(int i=0;i<n;i++) a[i]=(Long)a[i]*b[i]%mo;
	FWT(a,1);
	
	for(int i=nb-1;i<n;i++) ans[i-nb+1]=a[i];
	
	for(int i=0;i<n;i++) a[i]=tmp[i],b[i]=0;
	
}
char s[N];
void readln(int a[],int &n){
	scanf("%s",s); n=strlen(s);
	For(i,0,n-1) a[i]=(s[i]-'0');
}
int orz[233],fix[N],val[N];
int main(){
	readln(a,na);
	Init(na);
	
	For(i,0,na-1) tmp[i]=a[i];
	For(i,0,na-1) fix[i]=fix[i-1]+a[i];
	int T; scanf("%d",&T);
	while(T--){
		readln(b,nb);
		int Ret=0;
		For(i,0,n-1) Ret+=b[i];
		For(i,0,n-1) if(i<nb-i) swap(b[i],b[nb-i-1]);
		int Ans=0;
		FFT(a,b);
		For(i,0,na-nb) val[i]=fix[i+nb-1]-fix[i-1]+Ret-2*ans[i];
		For(i,0,na-nb) Ans=(Ans*100001LL+val[i])%1000000007;
		printf("%d\n",Ans);
	}
}