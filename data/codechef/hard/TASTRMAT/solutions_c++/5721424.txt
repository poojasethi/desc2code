/*
*
* FileName: 
* Created By: ptk23
* Description: 
*
*/
#include <bits/stdc++.h>


 
#define ull unsigned long long
#define ll long long
#define ini(x) scanf("%d", &x)
#define inl(x) scanf("%ld", &x)
#define inll(x) scanf("%lld", &x)
 
 
using namespace std;
typedef complex <double> base;

const ll P=1000000007;
vector <int> A,B,res;
int rev(int num,int lg_n)
{
	int res=0;
	for(int i=0;i<lg_n;i++)
	{
		if(num&(1<<i))
		res|=(1<<lg_n-1-i);
	}
	return res;
}
void fft(vector <base> &a,bool invert)
{
	int n=(int)a.size();
	int lg_n=0;
	while((1<<lg_n)<n)
	++lg_n;
	for(int i=0;i<n;i++)
	{
		//int tp=rev(i,lg_n);
		if(i<rev(i,lg_n))
		swap(a[i],a[rev(i,lg_n)]);
	}
	for(int len=2;len<=n;len<<=1)
	{
		double ang=2*M_PI/len*(invert?-1:1);
		base wlen(cos(ang),sin(ang));
		for(int i=0;i<n;i+=len)
		{
			base w(1);
			for(int j=0;j<len/2;j++)
			{
				base u=a[i+j],v=a[i+j+len/2]*w;
				a[i+j]=u+v;
				a[i+j+len/2]=u-v;
				w*=wlen;
			}
		}
	}
	if(invert)
	for(int i=0;i<n;i++)
	a[i]/=n;
}
void multiply(const vector <int> &a,const vector <int> &b)
{
	//fa.clear();fb.clear();
	vector<base>	fa(a.begin(),a.end()),fb(b.begin(),b.end());
	size_t n=1;
	while(n<max(a.size(),b.size()))
	n=n<<1;
	n=n<<1;
	fa.resize(n),fb.resize(n);
	fft(fa,false);
	fft(fb,false);
	for(size_t i=0;i<n;i++)
	fa[i]*=fb[i];
	fft(fa,true);
	res.resize(n);
	for(size_t i=0;i<n;i++)
	{
		if(fa[i].real()<0)
		res[i]=int(fa[i].real()-0.5);
		else
		res[i]=int(fa[i].real()+0.5);
	}
}
int main()
{
	//freopen("i.txt","r",stdin);
	string st1;
	cin>>st1;
	
	for(int i=0;i<st1.length();i++)
	{
		A.push_back((st1[i]=='1'?1:-1));
	}
	int k;
	cin>>k;
	string st;
	for(int i=0;i<k;i++)
	{
		cin>>st;
		B.clear();
		int len=st.length();
		for(int j=len-1;j>=0;j--)
		{
			B.push_back((st[j]=='1'?1:-1)) ;;
		}
		ll ans=0;
		res.clear();
		//cout<<":P"<<endl;
		multiply(A,B);
		for(int p=len-1;p<st1.length();p++)
		{
			ans=(ans*100001 + (len-res[p])/2)%P;
		}
		if(ans<0)
		ans+=P;
		cout<<ans<<endl;
	}
	return 0;
}
