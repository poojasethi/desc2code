#include <cstring>
#include <iostream>
#include <string>
#define BB 100001LL
#define MOD 1000000007LL
#define SIZE 100005
 
using namespace std;
typedef long long int ll;
 
char A[SIZE],B[SIZE];
ll vl[SIZE];
ll inv[BB+5];
 
void make()
{
inv[1]=1;
for(int i=2;i<=BB;i++)
{
inv[i]=MOD-inv[MOD%i]*(MOD/i)%MOD;
}
}
int main()
{
make();
scanf("%s",&A);
int n=strlen(A);
for(int i=0;i<n;i++)
{
if(i==0) vl[i]=1;
else vl[i]=vl[i-1]*inv[BB]%MOD;
}
int T;
scanf("%d",&T);
while(T--)
{
scanf("%s",&B);
int m=strlen(B);
ll ret=0,sum=0,now=1;
int l=0,r=0;
for(int i=0;i<m;i++)
{
if(B[i]=='1')
{
while(r<=n-(m-i))
{
if(A[r]=='0')
{
sum+=vl[r];
sum%=MOD;
}
r++;
}
while(l<r&&l<i)
{
if(A[l]=='0')
{
sum+=MOD-vl[l];
sum%=MOD;
}
l++;
}
ret+=sum*now%MOD;
ret%=MOD;
}
now*=BB;
now%=MOD;
}
sum=0;
now=1;
l=0,r=0;
for(int i=0;i<m;i++)
{
if(B[i]=='0')
{
while(r<=n-(m-i))
{
if(A[r]=='1')
{
sum+=vl[r];
sum%=MOD;
}
r++;
}
while(l<r&&l<i)
{
if(A[l]=='1')
{
sum+=MOD-vl[l];
sum%=MOD;
}
l++;
}
ret+=sum*now%MOD;
ret%=MOD;
}
now*=BB;
now%=MOD;
}
for(int i=0;i<n-m;i++) ret=ret*BB%MOD;
printf("%lld\n",ret);
}
return 0;
}

