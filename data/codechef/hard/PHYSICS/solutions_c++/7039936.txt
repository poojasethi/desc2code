#include<bits/stdc++.h>

#define s(x) scanf("%d",&x)
#define pb(x) push_back(x)
#define vi vector<int> 

using namespace std;


int n,f;

int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		vi v;
		s(n),s(f);
		for(int i=0;i<n;i++)
		{
			int x;
			s(x);
			v.pb(x);
		}
		sort(v.begin(),v.end());
		vi :: iterator it1,it2;
		it1 = v.begin();
		pair<vi:: iterator,vi::iterator >count;
		int ans=0,h;
		for(int i=0;i<n;i++)
		{
			h=v[i];
			count = equal_range(v.begin(),it1+1,h);
			ans += abs(count.second-count.first);
			ans--;
			while(h%f==0)
			{
				h/=f;
				count = equal_range(v.begin(),it1+1,h);
				ans += abs(count.second-count.first);
				//cout<<ans<<" ";
				//if(h==v[i])
				//	ans-=1;		//double counting
				
			}
			it1++;
		}
		printf("%d\n",ans);
	}
}