#include<bits/stdc++.h>
#define bug(x) cout<<#x<<" => "<<x<<"\n"
#define pr(x)  cout<<x<<"\n"
#define sc(x)	scanf("%d",&x)
#define scl(x) scanf("%lld",&x)

using namespace std;


int main()
{
	//freopen("input.txt","r",stdin);
	//freopen("output.txt","w",stdout);
	int cases=0;
	int t;
	cin>>t;
	while(t--)
	{
		int n,f;
		map<int,int> st;
		map<int,int>::iterator it,it2;
		cin>>n>>f;
		int x;
		for(int i=0;i<n;i++)
		{
			cin>>x;
			while(x%f==0)
				x/=f;
			st[x]++;
		}
		long long ans=0;
		for(it=st.begin();it!=st.end();it++)
		{
			long long num =(long long ) it->second;
			ans+=(num*(num-1))/2;
		}
		cout<<ans<<"\n";
	}
}