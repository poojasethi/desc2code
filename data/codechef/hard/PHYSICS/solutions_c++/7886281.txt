#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
int main()
{
	ll t;
	cin>>t;
	
	while(t--)
	{
		map<ll,ll> p;
		ll n,f;
		cin>>n>>f;
		ll a[n];
		ll m=0;
		for(ll i=0;i<n;i++)
		{
		cin>>a[i];
		m=max(m,a[i]);
		p[a[i]]=0;
		}
		ll c=0;
		sort(a,a+n);
		for(ll i=0;i<n;i++)
		{
			c+=p[a[i]];
			for(ll j=1;j*a[i]<=m;j*=f)
			{
				p[j*a[i]]=1+p[j*a[i]];
			}
		}
		cout<<c<<endl;
		
	}
	return 0;
}