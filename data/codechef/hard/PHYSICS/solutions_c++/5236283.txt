#include<algorithm>
#include<cstdio>
#include<cmath>
#include<iostream>
#include<string.h>
#include<set>
#include<map>
#include<vector>
using namespace std;
int main()
{

	int aa,bb,t,e,d,i,a,c,b,j,n,m,f,test,z,ans,temp;
	int h[10002];
	pair<int,int> p1,p2,p3,p4;
	//vector< pair<int,int> > myv;
	vector<int> hi;
	//vector< pair<int,int> >::iterator it;
	map<int,int > mymp1;
	map<int,int >::iterator it1;
	map< pair<int,int>,int > mymp;
	map< pair<int,int>,int> ::iterator it;
	map< pair<int,int>,int> ::iterator it2;

    scanf("%d",&test);
    while(test)
    {
        ans =0;
        mymp1.clear();
        scanf("%d %d",&n,&f);
        for(i=0;i<n;i++)
        {
        scanf("%d",&h[i]);

        }
        sort(h+0,h+n);
        mymp1[h[0]]++;
        for(i=1;i<n;i++)
        {
            a = h[i];
             b=a;

            while(b)
            {

                if(mymp1[b]!=0)
                {
                    ans = ans + mymp1[b];
                }
                if(b%f==0)
                {
                    b = b/f;
                }
                else
                    break;

            }
            mymp1[a]++;
        }
        printf("%d\n",ans);
    test-- ;
    }
}
