#include<iostream>
#include<bits/stdc++.h>
#include <cmath>
#include <cstdio>
#include<algorithm>
#define vi vector<int>
#define vvi vector<vector<int> >
#define vpi vector<pair<int,int> >
#define all(c) c.begin(), c.end() 
#define fr(type,i,n) for(type i=0;i<n;i++)
#define sz(a) int((a).size()) 
#define ll long long int
#define ull unsigned long long
#define tr(c,it) for(typeof((c).begin()) (it) = (c).begin();(it)!=(c).end();(it)++)
#define pb push_back
#define mp make_pair
#define MOD 1000000007
#define pi 3.1415926535897932384626433832795
#define endl "\n"
using namespace std;

int main()
{
	ios_base::sync_with_stdio(0);
	int t;
	cin>>t;
	while(t--)
	{
			int n;
			ull f;
			cin>>n>>f;
			//ull arr[n];
			vector<ull> vec;
			ull temp;
			
			fr(int,i,n)
			{
					cin>>temp;
					vec.pb(temp);
			}
			
			sort(all(vec));
			
			
			ull count=0;
			for(int i=1;i<n;i++)
			{
				ull f1=1;	
				//ull ht = vec[i];		
				
				while(vec[i]%f1==0)
				{
					
					pair<vector<ull>::iterator,vector<ull>::iterator> bounds;
					
					
					bounds = equal_range(vec.begin(),vec.begin()+i,vec[i]/f1);
					
					count+= bounds.second-bounds.first;//second will be next to last
					
					
					
					f1*=f;
					
					//ht = ht/f1;
				}
				//cout<<endl;
			}
			
			cout<<count<<"\n";
	}
		
	
	return 0;
}

