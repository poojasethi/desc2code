#include <cstdio>
#include <cstdlib>
#include <vector>
#include <algorithm>

using namespace std;

int main() {
    int t, n, f, value;
    vector<int> height;
    pair< vector<int> :: iterator, vector<int> :: iterator> bounds;
    scanf("%d", &t);
    while(t --) {
        scanf("%d%d", &n, &f);
        height.clear();
        for(int i = 0; i < n; i ++) {
            scanf("%d", &value);
            height.push_back(value);
        }
        sort(height.begin(), height.end());
        long long count = 0;
        for(int i = n - 1; i >= 0; i --) {
            int element = height[i];
            do {
                bounds = equal_range(height.begin(), height.begin() + i, element);
                count += (bounds.second - bounds.first);
                if(element % f == 0) {
                    element /= f;
                } else {
                    break;
                }
            } while(element);
        }
        printf("%lld\n", count);
    }
    return 0;
}
