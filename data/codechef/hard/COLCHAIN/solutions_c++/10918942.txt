#include <stdio.h>

const int md = (int)(1e9+7);

int ans, t, n, m, i;
int f[1111111],s[1111111];

int main() {
  scanf("%d",&t);
  while (t--) {
    scanf("%d %d",&n,&m);
    for (i=1;i<=m+1;i++) f[i] = 1, s[i] = i;
    for (i=m+2;i<=n;i++) {
      f[i] = (s[i-1]-s[i-m-1]+md) % md;
      s[i] = (s[i-1]+f[i]) % md;
    }
    ans = 0;
    for (i=1;i<=m;i++) ans = (ans+(long long)f[n-m+i]*i) % md;
    for (i=1;i<=m;i++) ans = (long long)ans*i % md;
    printf("%d\n",ans);
  }
  return 0;
}