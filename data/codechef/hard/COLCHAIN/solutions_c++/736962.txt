#include <cstdio>

typedef long long ll;

const ll MOD = (ll)1e9+7;

int main() {

  ll fact[100001] = {1};
  for (ll i = 1; i <= 100000; ++i) {
    fact[i] = i*fact[i-1] % MOD;
  }

  int T;
  scanf("%d", &T);
  while (T--) {
    ll N, M;
    scanf("%lld%lld", &N, &M);
    ll a[100001];
    for (int i = 0; i < N; ++i) {
      if (i < M) {
        a[i] = fact[M];
      }
      else if (i == M) {
        a[i] = M*fact[M] % MOD;
      }
      else {
        a[i] = ((a[i-1]<<1) - a[i-M-1])%MOD;
      }
    }
    ll ans = 0;
    for (int i = 0; i < M; ++i) {
      ans += (M - i)*a[N-i-2];
      ans %= MOD;
    }
    printf("%lld\n", ans<0 ? ans+MOD : ans);
  }

  return 0;

}
