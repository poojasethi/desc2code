#include<iostream>
#include<algorithm>
#include<vector>
#include<cmath>
#include<cstdio>
#include<iostream>

using namespace std;

#define FOR(i,a,b) for(long long i = a ; i < b ; ++i)
#define MOD 1000000007
#define MAX 100010

long long tests, N, M, dp[MAX], fact[MAX];

int main(){
  
  scanf("%lld\n", &tests);
  fact[0] = 1;
  FOR(i,1,MAX)
    fact[i] = (i*fact[i-1])%MOD;
  FOR(testcases,0,tests){
    cin>>N>>M;
    FOR(i,1,M+1)
      dp[i] = 1;
    dp[M+1] = M;
    FOR(i,M+2,N+1)
      dp[i] = (dp[i-1]+dp[i-1]-dp[i-M-1]+MOD)%MOD;
    long long ans = 0;
    FOR(i,1,M+1)
      ans = (ans+((M+1-i)*dp[N-i])%MOD)%MOD;
    cout<<(ans*fact[M])%MOD<<endl;
  }

  return 0;

}