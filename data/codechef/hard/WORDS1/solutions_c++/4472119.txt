#include <iostream>
#include <stack>
#include <cstdio>
#include <cstring>
using namespace std;
#define scan(n) scanf("%ld\n", &n)
#define print(n) printf("%ld\n", n)

int main() {
	long t;
	scan(t);
	for(long i = 0; i < t; ++i){
		long matrix[26][26], alpha[26], st, en, len;
		long sp;
		for(long in = 0; in < 26; in++)
			alpha[in] = 0;
		for(long in = 0; in < 26; in++){
			for(long inn = 0; inn < 26; inn++){
				matrix[in][inn] = 0;
			}
		}

		long number;
		scan(number);
		char start, end;
		for(long j = 0; j < number; ++j){
			char array[1001];
			gets(array);
			len = strlen(array);
			start = array[0], end = array[len-1];
			st = start-'a', en = end-'a';
			// if(st != en){
				alpha[st]++; alpha[en]--;
				matrix[st][en] = 1;	matrix[en][st] = 1;	
				sp = st;
			// }			
		}

		bool valid = true, p = true, m = true;
		for(long in = 0; in < 26; in++){
			if(alpha[in] > 0 && p){
				if(alpha[in] > 1){
					valid = false;
					break;
				}
				p = false;
			}
			else if(alpha[in] > 0 && !p){
				valid = false;
				break;
			}
			else if(alpha[in] < 0 && m){
				if(alpha[in] < -1){
					valid = false;
					break;
				}
				m = false;
			}
			else if(alpha[in] < 0 && !m){
				valid = false;
				break;
			}
		}
		if(!valid)
			printf("The door cannot be opened.\n");
		else if(valid){

			long count = 0;
			for(long in = 0; in < 26; in++){
				for(long inn = 0; inn < 26; inn++){
					if(matrix[in][inn] == 1){
						count++;
						break;
					}
				}
			}
			// cout<<count<<endl;

			long top;
			stack<int> myStack;
			bool visited[26], over;
			for(int j = 0; j < 26; ++j)
				visited[j] = false;
			visited[sp] = true;
			count--;
			myStack.push(sp);
			while(!myStack.empty()){
				over = false;
				top = myStack.top();
				for(long i = 0; i < 26; ++i){
					if(matrix[top][i] == 1 && !visited[i] && i != top){
						myStack.push(i);
						over = true;	
						visited[i] = true;
						count--;
						break;			
					}
				}
				if(!over)
					myStack.pop();
			}

			if(count == 0)
				printf("Ordering is possible.\n");
			else
				printf("The door cannot be opened.\n");
		}
	}
	return 0;
}











/*
			for(long in = 0; in < 26; in++){
				for(long inn = 0; inn < 26; inn++){
					cout<<matrix[in][inn]<<" ";
				}
				printf("\n");
			}
*/
