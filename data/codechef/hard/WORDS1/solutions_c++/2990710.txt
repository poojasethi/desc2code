#include<stdio.h>
#include<string.h>
using namespace std;

int n;
char s[100005][2];
char s1[1005];
int cb[26],ce[26];
bool ed[26][26];

bool check()
{
    int b=0,e=0;
    for(int i=0;i<26;i++)
        switch(cb[i]-ce[i])
    {
        case 0 : break;
        case 1 :  if(b) return 0; b=1;break;
        case -1 : if(e) return 0; e=1; break;
        default : return 0;
    }
    return 1;
}

bool vis[26];

void ch(int p)
{
    vis[p]=1;
    for(int i=0;i<26;i++)
        if(ed[i][p]&&!vis[i])
            ch(i);
}

bool func()
{
    if(!check()) return 0;
    int i,z1=0,z2=0;
    for(i=0;i<26;i++)
        vis[i]=0;
    for(i=0;i<26;i++)
        if(cb[i]||ce[i])
          break;
    //vis[i]=1;
    ch(i);
    for(i=0;i<26;i++)
        if(vis[i])
          z1++;
    for(i=0;i<26;i++)
        if(cb[i]||ce[i])
            z2++;
    if(z1==z2) return 1;
    return 0;



}
int main()
{
    int t,i,j;
    scanf("%d\n",&t);
    while(t--)
    {
        scanf("%d\n",&n);
        for(i=0;i<26;i++)
            cb[i]=ce[i]=0;
        for(i=0;i<26;i++)
            for(j=0;j<26;j++)
              ed[i][j]=0;
        for(i=0;i<n;i++)
        {
            gets(s1);
            s[i][0]=s1[0];
            cb[s[i][0]-'a']++;
            s[i][1]=s1[strlen(s1)-1];
            ce[s[i][1]-'a']++;
            ed[s[i][0]-'a'][s[i][1]-'a']=ed[s[i][1]-'a'][s[i][0]-'a']=1;
        }
        if(func())
            printf("Ordering is possible.\n");
        else printf("The door cannot be opened.\n");

    }

}
