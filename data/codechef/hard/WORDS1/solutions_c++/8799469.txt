#include <bits/stdc++.h>

using namespace std;

int n, a[30][30], deg[30];
int q[30], cl[30], dd[30];

void BFS(int xp) {
    int L=0, R=1;
    for(int i=1;i<=26;i++) cl[i]=0;
    cl[xp]=1; q[++R]=xp;
    while (L<=R) {
        int u=q[L++];
        for(int v=1;v<=26;v++) if (a[u][v]==1 && cl[v]==0) {
            cl[v]=1;
            q[++R]=v;
        }
    }
}

void inp() {
    for(int i=1;i<=26;i++)
        for(int j=1;j<=26;j++) a[i][j]=0;
    for(int i=1;i<=26;i++) deg[i]=dd[i]=0;
    scanf("%d\n",&n);
    for(int i=1;i<=n;i++) {
        char s[1005]; gets(s);
        int u=s[0]-96, v=s[strlen(s)-1]-96;
        a[u][v]=a[v][u]=1;
        dd[u]=dd[v]=1;
        deg[u]--; deg[v]++;
    }
}

void solve() {
    int d1=0, d2=0;
    bool ok=true;
    for(int i=1;i<=26;i++) {
        if (deg[i]>1 || deg[i]<-1) {ok=false; break;}
        if (deg[i]==1) d1++;
        if (deg[i]==-1) d2++;
        if (d1>1 || d2>1) {ok=false; break;}
    }
    if (ok) {
        for(int xp=1;xp<=26;xp++) if (dd[xp]==1) {
            BFS(xp);
            for(int i=xp;i<=26;i++) if (cl[i]==0 && dd[i]==1) {ok=false; break;}
            break;
        }
    }
    if (ok) printf("Ordering is possible.\n"); else
    printf("The door cannot be opened.\n");
}

int main() {
    #ifndef ONLINE_JUDGE
    freopen("inp.txt","r",stdin);
    freopen("out.txt","w",stdout);
    #endif // ONLINE_JUDGE
    int T; scanf("%d\n",&T);
    while (T--) {
        inp();
        solve();
    }
}
