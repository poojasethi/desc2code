#include<iostream>
#include<algorithm>
#include<stdio.h>
#include<string.h>
#include<map>
using namespace std;
map<char,int> M,N;
int links[26][26];
int visited[26];
void visit (int entry1)
{
int i;
visited[entry1]=1;
for (i = 0; i < 26; i++) {
if (links[entry1][i] && visited[i] == 0)
{
visit(i);
}
}
}
int iscycle(int entry1) {
int i;
for (i = 0; i < 26; i++) {
visited[i] = 0;
}
visit(entry1);
for (i = 0; i < 26; i++) {
if (visited[i] == 0 && M['a'+i] > 0)
return 0;
}
return 1;
}
int main(){
char a[1000];int n,t,i;
 
cin>>t;
while(t--){
	i=0;	
	scanf("%d\n",&n);
	for(i=0;i<26;i++){
		M['a'+i]=0;
		N['a'+i]=0;
		for(int j=0;j<26;j++)
		links[i][j]=0;
	}
	i=0;
	while(i<n){
		int len;
		gets(a);
		len=strlen(a);
		M[a[0]]++;
		N[a[len-1]]++;
		links[a[0]-'a'][a[len-1]-'a']=1;
		i++;
		}
	i=0;
	int flag=1;
	int start,end;start=end='a';
	while(i<26){
		if(M['a'+i]==N['a'+i]){
		i++;continue;}
		else if(M['a'+i]==N['a'+i]+1){
			if(start=='a') start='a'+i;
			else {flag=0; break;}
		}
		else if(M['a'+i]==N['a'+i]-1){
			if(end=='a') end='a'+i;
			else {flag=0; break;}
		}
		else {flag=0; break;}i++;
	}
	if(flag && iscycle(start-'a')) cout<<"Ordering is possible.\n";
	else cout<<"The door cannot be opened.\n";
}
}
	
 
	