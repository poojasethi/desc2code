def prejdi_strom(linky, presiel, zoznam):
    cache = {}
    ret = []
    for p in zoznam:
        for q in linky.get(p,[]):
            if q not in presiel and q not in cache:
                ret.append(q)
                cache[q] = 1
    return ret

def rozhodni(prve, druhe, linky):
    zaznam = {}
    for p1 in prve:
        delta = prve.get(p1,0) - druhe.get(p1,0)
        if delta==0 : continue
        if abs(delta) > 1 : return False
        if delta in zaznam: return False
        zaznam[delta] = p1

    for p1 in druhe:
        if p1 not in prve:
            if druhe[p1] != 1: return False
            if -1 in zaznam: return False
            zaznam[-1] = p1

    if 1 in zaznam: 
        start = zaznam[1]
    else: 
        for p1 in prve:
            start = p1
            break
    
    presiel = [start]
    zoznam  = [start]
    
    while True:
        nc = prejdi_strom(linky, presiel, zoznam)
        if nc == [] : break
        presiel += nc
        zoznam = nc
    
    return [x for x in prve if x not in presiel] == [] and [x for x in prve if x not in presiel]== []
    
def readInput(file):
    n = int(file.readline())
    prve = {}
    druhe = {}
    linky = {}
    for _ in xrange(0,n):
        s = file.readline().strip()
        prve[s[0]] = prve.setdefault(s[0],0) + 1
        druhe[s[-1]] = druhe.setdefault(s[-1],0) + 1
        linky.setdefault(s[0],[]).append(s[-1])
    return prve, druhe, linky

if __name__ == "__main__":
    import sys
    file = sys.stdin
    tc = int(file.readline())
    for _ in xrange(0,tc):
        prve, druhe, linky = readInput(file)
        print ["The door cannot be opened.","Ordering is possible."][rozhodni(prve, druhe, linky)] 
