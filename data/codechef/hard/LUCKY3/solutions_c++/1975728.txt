#include <cstdio>
#include <cstring>
#include <algorithm>
#include <iostream>
#include <climits>
#include <numeric>
#include <vector>
#include <cmath>
#include <map>
using namespace std;
#define ll long long
#define mp make_pair
#define pb push_back
#define fi first
#define se second
#define rep(i,n) for(int i=0;i<n;i++)
#define all(a)  a.begin(),a.end()
#define ESP (1e-9)
#define N 100010
#define M 1000000007
#define sz(a) int(a.size())
#define pii pair<int,int>
vector<string>l;
void F(string s)
{
 string p=s;
 if(s.size()<=9)
 {
  	reverse(all(s));
  	while(s.size()<9)s+='0';
  	reverse(all(s));
  	l.pb(s);
 }
 if(sz(p)==9)return;
 string t=p;
 t+='4';F(t);
 t=p;t+='7';F(t);
}
string a[64];
ll dp[51][1<<9];bool b[51][1<<10];int c[51][1<<10];
int main()
{
	//freopen("in.txt","r",stdin);
	l.clear();F("");
	sort(all(l));
	int T,n,i,j,k;
	scanf("%d",&T);
	while(T--)
	{
	 scanf("%d",&n);
	 for(i=0;i<n;i++)
	 {
	   cin>>a[i];
	   reverse(all(a[i]));
	   while(a[i].size()<9)a[i]+='0';
	   reverse(all(a[i]));
	 }
	 for(i=0;i<n;i++)
	 for(j=0;j<sz(l);j++)
	 {
	  b[i][j]=1;c[i][j]=0;
	  for(k=0;k<9;k++)
	  if(a[i][k]>l[j][k])b[i][j]=0;
	  else if(a[i][k]==l[j][k])c[i][j]|=(1<<k);
	 }
	 ll ans=0;
	 for(i=1;i<sz(l);i++)
	 {
	  j=0;
	  memset(dp,0,sizeof(dp));
	  while(j<9&&l[i][j]=='0')j++;
	  int mask=0;
	  for(j-=1;j>=0;j--)mask|=1<<j;
	  dp[0][mask]=1;
	  for(j=0;j<n;j++)
	  for(k=0;k<(1<<9);k++)
	  if(dp[j][k])
	  {
	   dp[j+1][k]+=dp[j][k];
	   if(b[j][i]==0)continue;
	   int kk=k|c[j][i];
	   dp[j+1][kk]+=dp[j][k];
	  }
	  ans+=dp[n][(1<<9)-1];
	 }
	 printf("%lld\n",ans);
	}
	return 0;
}
