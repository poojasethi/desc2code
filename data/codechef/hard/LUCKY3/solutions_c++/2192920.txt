#include<stdio.h>
#include<iostream>
#include<algorithm>
#include<vector>
#include<map>
#include<vector>
#include<math.h>
#include<string.h>
#include<climits>

using namespace std;

int t,n;
char arr[100][20];
long long dp[1030][55];

long long ans;

long long fun(int mask1,int mask2,int pos)
{
    if(dp[mask2][pos]!=-1)
        return dp[mask2][pos];
    if(pos==n)
        return 0;
    int temp,temp2,len=strlen(arr[pos]),flag=1,flag2=1;
    temp=mask1;
    int counter=0;
    while(temp>1)
    {
        temp>>=1;
        counter++;
    }
    dp[mask2][pos]=0;
    if(len<=counter)
    {
        int i=0;
        temp=mask1;
        temp2=mask2;
        while(i<len)
        {
            if(temp&(1<<i))
            {
                if(arr[pos][len-1-i]>'7')
                    flag=0;
                if(arr[pos][len-1-i]=='7')
                    temp2|=(1<<i);
            }
            else
            {
                if(arr[pos][len-i-1]>'4')
                    flag=0;
                if(arr[pos][len-1-i]=='4')
                    temp2|=(1<<i);
            }
            i++;
        }
        if(flag)
        {
            dp[mask2][pos]+=fun(mask1,temp2,pos+1);
            for(int i=0;i<counter;i++)
            {
                if((temp2&(1<<i))==0)
                    flag2=0;
            }
            if(flag2)
                dp[mask2][pos]++;
        }
    }
    dp[mask2][pos]+=fun(mask1,mask2,pos+1);
    return dp[mask2][pos];
}
int main()
{
    scanf("%d",&t);
    while(t--)
    {
        cin>>n;
        for(int i=0;i<n;i++)
            cin>>arr[i];
        ans=0;
        for(int i=2;i<1024;i++)
        {
            for(int j=0;j<=1024;j++)
                for(int k=0;k<=n;k++)
                    dp[j][k]=-1;
            ans+=fun(i,0,0);
        }
        printf("%lld\n",ans);
    }
}
