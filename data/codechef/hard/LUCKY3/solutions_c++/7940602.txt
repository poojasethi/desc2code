#include<iostream>
#include<algorithm>
#include<vector>
#include<map>
#define tr(con,it) for(typeof((con).begin()) it = (con).begin(); it != (con).end(); it++)
using namespace std;
 
vector< map<int, int64_t > > dp(51);
int a[51],x,nm;
 
int chec(int no)
{
    if(no>0)
    {for(int i=no;i!=0;i=i/10)
     if(((i%10)!=4)&&((i%10)!=2))
              return 0;
     return 1;}
     else
      return 0;
}
 
int mas(int p, int q)
{
    int m=0,i;
    for(i=1;(p!=0)&&(q!=0);p/=10,q/=10,i*=10)
    {
      int rp=p%10;
      int rq=q%10;
      if(rp>=rq)
       m=rp*i+m;
      else
       m=rq*i+m;
    }
    if(p!=0)
     return(p*i+m);
    else
     return (q*i+m);
}
       
 
int64_t cal(int p,int q)
{
      
    if(dp[p].find(q)!=dp[p].end())
     { return (dp[p].find(q)->second);}
    //int64_t ans=0;
    if(p==(x))
     return chec(q);
     nm=mas(a[p],q);
     dp[p][q]=cal(p+1,nm)+cal(p+1,q);
     return dp[p][q];
}
 
int main()
{
    int t,n,k;
    scanf("%d",&t);
    while(t--)
    {
              dp.clear();
              dp.resize(51);
              int c,j,in;
              scanf("%d",&n);
              x=0;
              for(int i=0;i<n;i++)
               {scanf("%d",&in);
               c=0;
               a[x]=0;
                 for(int k=in,j=1;k!=0;k=k/10,j*=10)
                  {
                         int rm=k%10;
                         if(rm>7)
                           {c=1;
                            break;}
                         else if(rm==7)
                           a[x]+=j*4;
                         else if(rm>4)
                           a[x]+=j*3;
                         else if(rm==4)
                          a[x]+=j*2;
                         else
                          a[x]+=j;
                  }
                 if(c==0)
                   x++;
               }
                 printf("%lld\n",cal(0,0));
    }
}
 