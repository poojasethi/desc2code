
/*
 **	Author : Amit Bansal	**
 */

#include<stdio.h>
#include<iostream>
#include<string.h>
#include<ctype.h>
#include<math.h>
#include<stdlib.h>

#include<vector>
#include<algorithm>
#include<string>
#include<sstream>

#include<map>
#include<set>
#include<list>
#include<queue>
#include<stack>
#include<bitset>

#include<functional>
#include<numeric>
#include<utility>
#include<iomanip>
#include<ctime>

using namespace std;
typedef long long						LL;
typedef vector<int> 						VI;
typedef vector<LL> 						VL;
typedef vector<double> 						VD;
typedef vector<string> 						VS;
typedef vector<vector<int> >					VII;
typedef stringstream 						ss;

#define all(v)							(v).begin(),(v).end()
#define forv(i,v)						for(int i=0;i<(v).size();i++)
#define fors(i,n)						for(int i=0;i<n;i++)
#define fori(i,x,n)						for(int i=x;i<n;i++)
#define ford(i,x,n)						for(int i=x;i>n;i--)
#define pb(x)							push_back(x)
#define SZ(v)							int(v.size())
#define SORT(v)							sort(all(v))
#define gcd                                                     __gcd
#define maxv(v)							*max_element(all(v))
#define minv(v)							*min_element(all(v))
#define sumv(v)							accumulate(all(v),0);
#define SI 							( {int x;scanf("%d",&x);x;} )
#define sqr(a) 							(a)*(a)
#define mp 							make_pair
#define seive(n) 					VI prime(n+1,1); prime[0]=prime[1]=0; fori(i,2,sqrt(n)+1) if(prime[i]) for(int j=i+i;j<=n;j+=i) prime[j]=0;
#define pi 2*acos(0.0)
#define mod 1000000007
#define inf 1000000000 

int hx[]={ -2, -2, -1, -1,  1, 1 , 2, 2 };			//moves of a knight(horse)
int hy[]={ -1,  1, -2,  2, -2, 2, -1, 1 };			//sorted: first on x ,then on y

int dx[]={ 1, -1, 0,  0 };					//E,W,N,S
int dy[]={ 0,  0, 1, -1 };

int nx[]={ 1, -1, 0,  0, -1,  1, 1, -1 };			//N-8 neighbourhood
int ny[]={ 0,  0, 1, -1,  1, -1, 1, -1 };			//E,W,N,S,N-W,S-E,N-E,S-W


class pt
{
    public:
	int x,y;
};

typedef vector<pt> 	VP;


/*
   bool comp(pt a1,pt a2)
   {
   if(a1.x<a2.x)
   return true;
   else if(a1.x>a2.x)
   return false;
   else
   {
   if(a1.y<a2.y)
   return true;
   return false;
   }
   }
 */
VS L(1022);
VI mask(1022,0);
int ind=0;

void F(string s1)
{
    string s2=s1;
    reverse(all(s1));
    int z=0;
    while(s1.size()<9)
    {
	s1+='0';
	mask[ind]+=(1<<z++);
    }
    reverse(all(s1));
    L[ind++]=s1;
    if(s2.size()!=9)
    {
	F(s2+'4');
	F(s2+'7');
    }
    return ;
}


int main()
{
    F("4");
    F("7");

    int t=SI;
    while(t--)
    {
	int n=SI;
	string A[n];
	bool B[n+1][1<<10];
	int C[n+1][1<<10];
	fors(i,n)
	{
	    cin>>A[i];
	    reverse(all(A[i]));
	    while(A[i].size()<9)
		A[i]+='0';
	    reverse(all(A[i]));
	    forv(j,L)
	    {
		B[i][j]=true;
		C[i][j]=0;
		fors(l,9)
		{
		    if(A[i][l]>L[j][l])
			B[i][j]=false;
		    if(A[i][l]==L[j][l])
			C[i][j]+=(1<<l);
		}
	    }
	}

	LL res=0;
	LL dp[n+1][1<<9];
	forv(i,L)
	{
	    memset(dp,0,sizeof(dp));
	    dp[0][mask[i]]=1;
	    fors(j,n)
		fors(k,1<<9)
		{
		    if(dp[j][k]==0)
			continue;
		    dp[j+1][k]+=dp[j][k];

		    int kk=k | (C[j][i]);
		    if(B[j][i]==true)
			dp[j+1][kk]+=dp[j][k];
		}

	    res+=(LL)dp[n][(1<<9)-1];
	}
	cout<<res<<endl;
    }

    return 0;
}

