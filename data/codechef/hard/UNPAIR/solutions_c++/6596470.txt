#pragma comment(linker, "/STACK:1024000000,1024000000") 
#include <iostream> 
#include <stdlib.h> 
#include <ctime> 
#include <cmath> 
#include <stdio.h> 
#include <vector> 
#include <algorithm> 
#include <queue> 
#include <string.h> 
#include <map> 
#include <set> 
#include <assert.h>
#define x first 
#define y second 
#define pb push_back 
#define mp make_pair 
#define vi vector<int> 
#define pii pair<int,int> 
#define ll long long 
#define inf 1000000007 
#define mod 1000000007
#define all(x) x.begin(),x.end() 
#define N 100010
#define pi acos(-1.)
#define DBG(x) cerr<<#x<<"="<<x<<"\n"; 
#define FOREACH(it,x) for(__typeof(x.begin()) it=x.begin();it!=x.end();it++) 
using namespace std; 

int a[105][105],f[105];
pair<int,pii>q[10010];
int find(int a){return a==f[a]?a:f[a]=find(f[a]);}
int main()
{
    int T,i,j,k,n,m;
    scanf("%d",&T);
    while(T--){
        scanf("%d",&n);m=0;
        for(i=0;i<n;i++)
            for(j=0;j<n;j++){
                scanf("%d",&a[i][j]);
                if(a[i][j]>0&&i<j)q[m++]=mp(a[i][j],mp(i,j));
            }
        if(n==1){
            if(a[0][0]==0)puts("-1");
            else printf("%d\n",a[0][0]);
            continue;
        }
        for(i=0;i<n;i++)f[i]=i;
        sort(q,q+m);
        ll ans=0;
        for(i=0;i<m;i++){
            int x=q[i].y.x,y=q[i].y.y;
            x=find(x),y=find(y);
            if(x==y)continue;
            ans+=q[i].x;
            f[y]=x;
        }    
        m=0;
        for(i=0;i<n;i++)if(f[i]==i)m++;
        if(m>1)puts("-1");
        else printf("%lld\n",ans*2);
    }
    return 0;
}