#include <cstdio>
#include <algorithm>

#define long long long
#define M 20000
#define INF 2000000000
#define H 100100

using namespace std;

long p[M],pc=1,k[M],s=0,n;
long u[H];

void pre(void){
    p[0]=0;
    for (long i=2; i<H; ++i)
    if (u[i]==0){
        p[pc]=i;
        for (long j=i; j<H; j+=i)
        u[j]=pc;
        pc++;
    }
}

long bin(long x){
    return (long) (upper_bound(p,p+pc,x)-p-1);
}

void read(void){
    scanf("%lld",&n);
    for (long i=0; i<=pc; ++i)
    k[i]=0;

    s=0;

    for (long i=0,x; i<n; ++i){
        scanf("%lld",&x);
        scanf("%lld",&k[bin(x)]);
    }
    if (k[1]==0)
    k[1]=1;
}

void pref(long x, long h){
    for (long i; x>1;){
        i=u[x];
        x/=p[i];
        k[i]+=h;
    }
}

void calc(void){
    for (long i=pc; i>1; --i)
    if (k[i])
    pref(p[i]-1,k[i]);
    s=k[1];
}

int main()
{
    long t;
    pre();
    scanf("%lld",&t);
    while (t--){
        read();
        calc();
        printf("%lld\n",s);
    }
    return 0;
}
