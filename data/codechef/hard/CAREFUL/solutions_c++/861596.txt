#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cmath>
#include <cstring>
using namespace std;
#define p(x) cout<<#x<<":"<<x<<"\n"
#define lim 100001
#define ll long long

int i,j,p,x,k,cs,n;
ll s;
bool B[lim];
int P[lim],M[lim];

int main()
{
  M[2]=1;
  for(i=2;i<lim;i++)
    if(!B[i])
	{
	  P[p++]=i;
	  for(j=2*i;j<lim;j+=i)
	    B[j]=1;
	  for(j=0,x=i-1;j<p && P[j]*P[j]<=x;j++)
	    while(!(x%P[j]))
		{
		  M[i]+=M[P[j]];
		  x/=P[j];
		}
	  if(x>1)
	    M[i]+=M[x];
	}
  scanf("%d",&cs);
  while(cs--)
  {
    scanf("%d",&n);
	for(i=0,s=1;i<n;i++)
	{
	  scanf("%d%d",&p,&k);
	  s+=(ll)k*M[p];
	  if(p==2)
	    s--;
	}
	cout<<s<<"\n";
  }
  return 0;
}
