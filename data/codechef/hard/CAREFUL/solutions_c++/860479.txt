#include <iostream>
#include <cstdio>
#include <fstream>
using namespace std;

const int MAX = 100000;

int steps[MAX];
int primes[10000];


int main()
{
int i,j,k;
for(i=0;i<MAX;steps[i++]=1);
for(i=2;(k=i*i)<MAX;i++)
 if(steps[i])
  for(j=k;j<MAX;j+=i) steps[j]=0;
k=0;
for(int i=2;i<MAX;i++)
 if(steps[i])
  primes[k++]=i;
for(i=0;i<MAX;steps[i++]=0);
steps[2]=1;
for(i=1;i<k;i++) 
   {
   int t=primes[i]-1;
   while( (t & 1) == 0 )
   { steps[primes[i]]++; t=t >> 1; }
   j=1;
   while ( t > 1 )
   { 
    while (t % primes[j] == 0) {
    steps[primes[i]]+=steps[primes[j]];
    t=t/primes[j];
     }
   j++;
   }
  }
int t;
scanf("%d",&t);
while(t--)
{
int m,p,k,yea2;
unsigned long long ans;
ans=0;
yea2=0;
scanf("%d",&m);
while(m--)
{
scanf("%d",&p);
scanf("%d",&k);
ans+= 1LL * k * steps[p];
yea2|=p==2;
}
if(yea2)
ans--;
printf("%lld\n",(ans+1));
}
return 0;
}