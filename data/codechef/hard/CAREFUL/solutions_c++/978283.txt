/*
 * File: alien.cpp
 * Author: wym510 
 * Email: <wym6110@gmail.com>
 * Create Date: 2012-4-12 23:06:39
*/

#include <vector>
#include <string>
#include <map>
#include <set>
#include <list>
#include <cmath>
#include <ctime>
#include <cstdio>
#include <iostream>
#include <fstream>
#include <sstream>
#include <queue>
#include <deque>
#include <stack>
#include <cstdlib>
#include <algorithm>
#include <cstring>
#define S size()
#define B begin()
#define E end()
#define P push_back
#define fu(i,a,b) for(int i=a;i<b;++i)
#define fd(i,a,b) for(int i=b-1;i>=a;--i)
typedef long long int64;
using namespace std;

const int MaxT=120000;

int num[MaxT],phi[MaxT];
int vis[MaxT];

void prime()
{
	for(int i=2;i<MaxT;i++) if(!vis[i])
		for(int j=i;j<MaxT;j+=i) vis[j]=i;
		
	phi[1]=1;num[1]=-1;
	for(int i=2;i<MaxT;i++)
		if(i/vis[i]%vis[i]==0) phi[i]=phi[i/vis[i]]*vis[i];
		else phi[i]=phi[i/vis[i]]*(vis[i]-1);
		
	for(int i=2;i<MaxT;i++) num[i]=num[phi[i]]+1;
	num[1]++;num[2]++;
}

int main()
{
	int test;

	//freopen("alien.in","r",stdin);
	//freopen("alien.out","w",stdout);
	ios_base::sync_with_stdio(false);
	
	for(prime(),cin>>test;test;test--)
	{
		int m;
		int64 res=1;

		cin>>m;
		for(int i=0;i<m;i++)
		{
			int p,q;

			cin>>p>>q;
			if(p==2) res--;
			res+=(int64)num[p]*(int64)q;
		}
		cout<<res<<endl;
	}
	return 0;
}

/* vim: set ts=4 sw=4: */

