/*
 * File: careful.cpp
 * Author: wym510 
 * Email: <wym6110@gmail.com>
 * Create Date: 2012-02-20 14:05:44
*/

#include <vector>
#include <string>
#include <map>
#include <set>
#include <list>
#include <cmath>
#include <ctime>
#include <cstdio>
#include <iostream>
#include <fstream>
#include <sstream>
#include <queue>
#include <deque>
#include <stack>
#include <cstdlib>
#include <algorithm>
#include <cstring>
#define S size()
#define B begin()
#define E end()
#define P push_back
#define fu(i,a,b) for(int i=a;i<b;++i)
#define fd(i,a,b) for(int i=b-1;i>=a;--i)
typedef long long int64;
using namespace std;

const int MaxT=120000;

int num[MaxT],phi[MaxT];
int vis[MaxT];

void prime()
{
	for(int i=2;i<MaxT;i++) if(!vis[i])
		for(int j=i;j<MaxT;j+=i) vis[j]=i;
	phi[1]=1;num[1]=-1;
	for(int i=2;i<MaxT;i++)
		if(i/vis[i]%vis[i]==0) phi[i]=phi[i/vis[i]]*vis[i];
		else phi[i]=phi[i/vis[i]]*(vis[i]-1);
	for(int i=2;i<MaxT;i++) num[i]=num[phi[i]]+1;
	num[1]++;num[2]++;
}

int main()
{
	int test;

	prime();
	for(cin>>test;test;test--)
	{
		int m;
		int64 res=1;

		scanf("%d",&m);
		for(int i=0;i<m;i++)
		{
			int p,k;

			scanf("%d%d",&p,&k);
			if(p==2) res--;
			res+=(int64)num[p]*(int64)k;
		}
		cout<<res<<endl;
	}
	return 0;
}

/* vim: set ts=4 sw=4: */

