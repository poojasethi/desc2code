#include <stdio.h>
 
main()
{
int X[8][10250];
for(scanf("%d",&X[7][9]); X[7][9]--; printf("%d\n",X[7][0]))
	{
	for(X[7][12]=scanf("%d",&X[7][13]); X[7][12]<=X[7][13]; scanf("%d",&X[4][X[7][12]++]));
	for(X[7][12]=!(X[7][3]=X[6][0]=!(X[7][7]=2)); X[7][12]<=X[7][13]; X[7][12]++)
		{
		for(X[7][8]=X[7][7]+(X[7][6]=0); X[7][8]; X[7][6]=(((X[7][5]=X[7][6]+X[7][8])<=X[7][3])&&(X[4][X[6][X[7][5]]]<X[4][X[7][12]]))?X[7][5]:X[7][6],X[7][8]>>=1);
		X[3][X[7][12]]=X[6][X[7][6]];
		if((X[7][6]==X[7][3])||(X[4][X[7][12]]<X[4][X[6][X[7][6]+1]]))
			{
			X[6][X[7][6]+1]=X[7][12];
			X[7][3]=(X[7][6]+1>X[7][3])?X[7][6]+1:X[7][3];
			X[7][7]=(X[7][3]>X[7][7])?X[7][7]*2:X[7][7];
			}
		}
	for(X[7][12]=X[7][3]+1; --X[7][12]>=1; X[2][X[7][12]]=X[6][X[7][12]]);
	for(X[7][10]=!(X[7][0]=0); X[7][10]<=X[7][3]; X[7][10]++)
		{
		for(X[7][1]=X[7][4]=X[2][X[7][10]]+!(X[7][11]=1); X[7][11]<=X[7][13]; X[5][X[7][11]++]=X[4][X[7][1]=(++X[7][1]>X[7][13])?1:X[7][1]]);
		for(X[7][2]=X[6][0]=!(X[7][7]=2)+!(X[7][11]=1); X[7][11]<=X[7][13]; X[1][X[7][11]++]=X[7][2])
			if(X[5][X[7][11]]>X[4][X[7][4]])
				{
				for(X[7][8]=X[7][7]+(X[7][6]=0); X[7][8]; X[7][6]=(((X[7][5]=X[7][6]+X[7][8])<=X[7][2])&&(X[5][X[6][X[7][5]]]<X[5][X[7][11]]))?X[7][5]:X[7][6],X[7][8]>>=1);
				if((X[7][6]==X[7][2])||(X[5][X[7][11]]<X[5][X[6][X[7][6]+1]]))
					{
					X[6][X[7][6]+1]=X[7][11];
					X[7][2]=(X[7][6]+1>X[7][2])?X[7][6]+1:X[7][2];
					X[7][7]=(X[7][2]>X[7][7])?X[7][7]*2:X[7][7];
					}
				}
		for(X[7][1]=X[7][4]+!(X[7][11]=1); X[7][11]<=X[7][13]; X[5][X[7][11]++]=X[4][X[7][1]=(--X[7][1]<1)?X[7][13]:X[7][1]]);
 
		for(X[7][11]=!(X[7][11]=X[7][2]=X[6][0]=!(X[7][7]=2)); X[7][11]<=X[7][13]; X[0][X[7][11]++]=X[7][2])
			if(X[5][X[7][11]]<X[4][X[7][4]])
				{
				for(X[7][8]=X[7][7]+(X[7][6]=0); X[7][8]; X[7][6]=(((X[7][5]=X[7][6]+X[7][8])<=X[7][2])&&(X[5][X[6][X[7][5]]]>X[5][X[7][11]]))?X[7][5]:X[7][6],X[7][8]>>=1);
				if((X[7][6]==X[7][2])||(X[5][X[7][11]]>X[5][X[6][X[7][6]+1]]))
					{
					X[6][X[7][6]+1]=X[7][11];
					X[7][2]=(X[7][6]+1>X[7][2])?X[7][6]+1:X[7][2];
					X[7][7]=(X[7][2]>X[7][7])?X[7][7]*2:X[7][7];
					}
				}
		for(X[7][11]=-!(X[0][0]=X[1][0]=0); ++X[7][11]<=X[7][13]; X[7][0]=(X[7][0]<X[0][X[7][11]]+X[1][X[7][13]-X[7][11]]+1)?(X[0][X[7][11]]+X[1][X[7][13]-X[7][11]]+1):X[7][0]);
		}
	}
return 0;
}
 