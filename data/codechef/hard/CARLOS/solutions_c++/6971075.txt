#include <cstdio>
#include <cstring>
using namespace std;

#define INF 2000000

int mat[200][200];
int dp[2][200];

int min(int a, int b) {
    return (a < b ? a : b);
}

void transitiveClosure(int n) {
    int i, j, k;
    for(k = 0; k < n; k++)
        for(i = 0; i < n; i++)
            for(j = 0; j < n; j++)
                mat[i][j] = mat[i][j] || (mat[i][k] && mat[k][j]);
}

int main() {
	int t, i, j, m, k, n, x, y, curr, flag, a;
	scanf("%d", &t);
	while(t--) {
	    scanf("%d%d%d", &m, &k, &n);
	    memset(mat, 0, sizeof(mat));
	    for(j = 0; j < m; j++)
            dp[0][j] = dp[1][j] = INF;
	    for(i = 0; i < k; i++) {
	        scanf("%d%d", &x, &y);
	        x--; y--;
	        mat[x][y] = mat[y][x] = 1;
	    }
	    for(i = 0; i < m; i++) mat[i][i] = 1;
	    transitiveClosure(m);
	    scanf("%d", &a);
	    a--;
	    for(j = 0; j < m; j++)
	        if(mat[a][j] == 1)
	            dp[0][j] = 1;
	    dp[0][a] = 0;
	    flag = 0;
	    for(i = 1; i < n; i++) {
	        scanf("%d", &a);
	        a--;
	        curr = INF;
	        flag ^= 1;
	        for(j = 0; j < m; j++) {
	            curr = min(curr, dp[flag ^ 1][j]);
	            if(curr == INF || mat[a][j] == 0) {
	                dp[flag][j] = INF;
	                continue;
	            }
	            dp[flag][j] = curr + (j == a ? 0 : 1);
	        }
	    }
	    curr = INF;
	    for(j = 0; j < m; j++) curr = min(curr, dp[flag][j]);
	    if(curr == INF) curr = -1;
	    printf("%d\n", curr);
	}
	return 0;
}
