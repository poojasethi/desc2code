/* Sacheendra MS */
#include <bits/stdc++.h>
using namespace std;
#define MOD 1000000007
#define pii pair<int, int>
#define vi  vector<int>
#define pb  push_back
#define M(a,x) memset(a,x,sizeof(a))
#define sci(x) scanf("%d",&x);
#define scl(x) scanf("%lld",&x);
#define scs(x) scanf("%s",x);
#define print(x) printf("%d",x);
#define nl printf("\n")
#define printl(x) printf("%lld",x)
#define F(i,a,n) for(int i=a;i<n;i++)
#define INF 100000000000000000LL
#define MAX 1000005
int b[201][201];
vi v[201];
int ans[201];
int a[200005];
long long dp[200005][201];
inline void bfs(int s,int visited[])
{
    visited[s]=1;
    queue<int> q;
    q.push(s);
    while(!q.empty()) {
        q.pop();
        F(i,0,v[s].size()) {
            if(!visited[v[s][i]])
            {
                visited[v[s][i]]=1;
                q.push(v[s][i]);
            }
        }
        if(q.empty())
            return ;
        s=q.front();
    }
}
int main() {
    int t;sci(t);
    while(t--) {
        M(a,0);
        F(i,0,201)
            v[i].clear();
        int m,n,k;sci(m);sci(k);sci(n);
        F(i,0,k) {
            int x,y;
            cin>>x>>y;
            v[x].pb(y);
            v[y].pb(x);
        }
        M(b,0);
        F(i,1,m+1) {
            bfs(i,b[i]);
        }
        F(i,1,n+1) sci(a[i]);
        F(i,1,n+1) dp[i][m+1]=INF;
        F(i,1,m+1) dp[n+1][i]=0;

        for(int i=n;i>=1;i--) {
            for(int j=m;j>=1;j--) {
                dp[i][j]=dp[i][j+1];
                if(b[a[i]][j])
                    dp[i][j]=min(dp[i][j],(a[i]!=j)+dp[i+1][j]);
            }
        }
        long long mxx=INF;
        F(i,1,m+1) {
            mxx=min(dp[1][i],mxx);
        }
        if(mxx==INF) {
            print(-1);
        }
        else {
            printl(mxx);
        }
        nl;
    }
    return 0;
}
