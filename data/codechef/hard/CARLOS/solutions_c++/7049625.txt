#include<bits/stdc++.h>

#define inf 999999
#define min(a,b) a<b?a:b
int s[200005];
int dp[200001][201];
/*void dfs(int i)
	{
		int j;
		if(visit[i]!=1)
			{
				printf("%d  --> ",i);
				visit[i]=1;
			}
		for(j=0;j<v;++j)
			{
				if(a[i][j]==1&&visit[j]==0)
					dfs(j);
			}
	}*/

bool a[201][201];
	
int main()
	{
		int t,m,k,n,x,y,i,j,min,l;
		scanf("%d",&t);
		while(t-->0)
			{
				
				scanf("%d%d%d",&m,&k,&n);

				memset(a,0,sizeof(a));
				memset(s,0,sizeof(s));
				
				for(i=0;i<k;++i)
					{
						scanf("%d%d",&x,&y);
						a[x][y]=1;;
						a[y][x]=1;
					}
				for(l=1; l<=m; l++)
					for(i=1; i<=m; i++)
						for(j=1; j<=m; j++)
							if(a[i][j]!=1)
								a[j][i]=a[i][j]=a[i][l]&a[l][j];
				for(i=1;i<=n;++i)
					scanf("%d",&s[i]);
				for(i=0;i<=n;++i)
					{
						for(j=0;j<=200;j++)
							{
								dp[i][j]=0;
							}
						dp[i][0]=inf;
					}
				min=inf;
				/*for(i=0;i<=m;++i)
					{
						for(j=0;j<=m;++j)
							printf("%d ",a[i][j]);
						printf("\n");
					}
				for(i=1;i<=n;++i)
					{
						for(j=1;j<=m;++j)
							{
								printf("%d ",dp[i][j]);	
							}
						printf("\n");
					}*/
				for(i=1;i<=n;++i)
					{
						for(j=1;j<=m;++j)
							{
								if(a[s[i]][j]==0&&s[i]!=j)//if conversion of s[i] to j is not allowed
									dp[i][j]=min(dp[i-1][j]+inf,dp[i][j-1]);
								else if(s[i]==j)//if s[i] and j both are same
									{
										//printf("YES");
										dp[i][j]=min(dp[i-1][j-1],min(dp[i-1][j],dp[i][j-1]))+0;
									}
								else if(a[s[i]][j]==1)//if conversion of s[i] to j is allowed
									{
										dp[i][j]=min(min(dp[i-1][j-1],dp[i-1][j])+1,dp[i][j-1]);
									}	
							}	
					}
				

					if(dp[n][m]>=inf)
						puts("-1");
					else
						printf("%d\n",dp[n][m]);
			}
			
	}
	