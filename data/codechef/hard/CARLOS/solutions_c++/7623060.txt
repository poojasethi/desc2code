/* Sacheendra MS */
#include <bits/stdc++.h>
using namespace std;
#define MOD 1000000007
#define pii pair<int, int>
#define vi  vector<int>
#define pb  push_back
#define M(a,x) memset(a,x,sizeof(a))
#define sci(x) scanf("%d",&x);
#define scl(x) scanf("%lld",&x);
#define scs(x) scanf("%s",x);
#define print(x) printf("%d",x);
#define nl printf("\n")
#define printl(x) printf("%lld",x)
#define F(i,a,n) for(int i=a;i<n;i++)
#define INF 100000000000000000LL
#define MAX 1000005
int b[201][201];
vi v[201];
int ans[201];
int a[200005];
long long dp[200005][201];
inline void bfs(int s,int visited[])
{
    visited[s]=1;
    queue<int> q;
    q.push(s);
    while(!q.empty()) {
        q.pop();
        F(i,0,v[s].size()) {
            if(!visited[v[s][i]])
            {
                visited[v[s][i]]=1;
                q.push(v[s][i]);
            }
        }
        if(q.empty())
            return ;
        s=q.front();
    }
}
int main() {
    int t;sci(t);
    while(t--) {
        M(a,0);
        F(i,0,201)
            v[i].clear();
        int m,n,k;sci(m);sci(k);sci(n);
        F(i,0,k) {
            int x,y;
            cin>>x>>y;
            v[x].pb(y);
            v[y].pb(x);
        }
        M(b,0);
        F(i,1,m+1) {
            bfs(i,b[i]);
        }
        F(i,1,n+1) sci(a[i]);
        for(int i=0;i<=n;i++) {
            dp[i][0]=INF;
        }
        for(int i=0;i<=m;i++) {
            dp[0][i]=0;
        }
        for(int i=1;i<=n;i++) {
            for(int j=1;j<=m;j++) {
                if(j!=a[i] && b[a[i]][j]) {
                    dp[i][j]=dp[i-1][j]+1;
                }
                if(j==a[i]) {
                    dp[i][j]=dp[i-1][j];
                    continue;
                }
                if(b[a[i]][j]==0) {
                    dp[i][j]=INF;
                }
            }
            for(int j=1;j<=m;j++) {
                dp[i][j]=min(dp[i][j],dp[i][j-1]);
            }
        }
        /*      for(int i=0;i<=n;i++) {
                for(int j=0;j<=n;j++) {
                cout<<dp[i][j]<<" ";
                }
                cout<<endl;
                }*/
        if(dp[n][m]>=INF)
            cout<<-1<<endl;
        else
            cout<<dp[n][m]<<endl;
    }
    return 0;
}
 