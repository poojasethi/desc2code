#include <bits/stdc++.h>
using namespace std;
#define mod 1000000007
#define rep(a, b, c) for(int a = b; a < c; a++)
#define asd(x)              cout<<__LINE__<<" :: "<<#x<< ": "<<x<<endl;
#define asdf(x, y)          cout<<__LINE__<<" :: "<<#x<< ": "<<x<<" | "<<#y<< ": "<<y<<endl;
typedef pair<int,int> ii;
typedef long long int lli;
#define pb push_back
#define mp make_pair
#define inf 100000000
#ifndef ONLINE_JUDGE
#define gc getchar
#define pc putchar
#else
#define gc getchar_unlocked
#define pc putchar_unlocked
#endif
int read_int() {
    char c = gc();
    while((c < '0' || c > '9') && c != '-') c = gc();
    int ret = 0, neg = 0;
    if (c == '-') neg = 1, c = gc();
    while(c >= '0' && c <= '9') {
        ret = 10 * ret + c - 48;
        c = gc();
    }
    return neg ? -ret : ret;
}
 
lli read_ll() {
    char c = gc();
    while((c < '0' || c > '9') && c != '-') c = gc();
    lli ret = 0; int neg = 0;
    if (c == '-') neg = 1, c = gc();
    while(c >= '0' && c <= '9') {
        ret = 10 * ret + c - 48;
        c = gc();
    }
    return neg ? -ret : ret;
}
 
lli c[5010][5010];
void ncr()
{
    c[0][0]=1;
    rep(i,1,5010)
    c[i][0]=1,c[0][i]=0;
    rep(i,1,5010)
    rep(j,1,5010)
    {
        c[i][j]=c[i-1][j]+c[i-1][j-1];
        while(c[i][j]>=mod)
            c[i][j]-=mod;
    }
}
int a[200010];
int gr[210][210],vis[210];
int m;
int dp[200010][210];
bool check(int x,int y)
{
    vis[x]=1;
    rep(i,1,m+1)
    {
        if(vis[i])
            continue;
        if(gr[x][i]==1 )
        {
             if(i==y)
                return true;
             else if(check(i,y))
             return true;
 
        }
 
    }
    return false;
}
 
int main(){
   int n,k,t,x,y;
   cin>>t;
   while(t--)
   {
       memset(gr,0,sizeof(gr));
        memset(dp,0,sizeof(dp));
       m=read_int();
       k=read_int();
       n=read_int();
       rep(i,1,m+1)
       gr[i][i]=1;
       rep(i,0,k)
       {
           x=read_int();
           y=read_int();
           gr[x][y]=1;
           gr[y][x]=1;
       }
       /*rep(i,1,m+1)
       {
           rep(j,1,m+1)
           {
               if(gr[i][j]==1)
                continue;
                memset(vis,0,sizeof(vis));
               if(check(i,j))
                  gr[i][j]=1;
           }
       }*/
        rep(k,1,m+1)
       {
           rep(i,1,m+1)
           {
               rep(j,1,m+1)
               {
                   gr[i][j]=max(gr[i][j],(gr[i][k]&&gr[k][j]?1:0));
               }
           }
       }

 
       rep(i,0,n)
       a[i]=read_int();
       rep(i,1,n+1)
       dp[i][0]=inf;
 
       rep(i,1,n+1)
       {
           rep(j,1,m+1)
           {
               if(a[i-1]==j)
              {
                 
               dp[i][j]=min(dp[i-1][j],dp[i][j-1]);
              }
              else if(gr[a[i-1]][j])
              {
                    dp[i][j]=min(dp[i-1][j]+1,dp[i][j-1]);
              }
              else
                dp[i][j]=dp[i][j-1];
           }
       }
     //  int ans=inf;
       //rep(i,1,m+1)
      // ans=min(ans,dp[n][i]);
       if(dp[n][m]==inf)
        cout<<"-1"<<endl;
       else cout<<dp[n][m]<<endl;
 
 
 
   }
 
  return 0;
 
 
    }