#include <cstdio>
#include<iostream>
#include <cstring>
#include <queue>
#include <algorithm>
#include <limits>
using namespace std;
#define N 50010
int a[N],t[N<<2],w[210],c[210],s,n;
void build(int p,int l,int r)
{
	if(l==r)
	{
		if(l<=n-1)t[p]=a[l];
		else t[p]=0;return;
	}
	int m=(l+r)>>1;
	build(p<<1,l,m);build(p<<1|1,m+1,r);
	t[p]=t[p<<1]+t[p<<1|1];
}
void update(int p,int l,int r,int x,int v)
{
	t[p]+=v;
	if(l==r)return;
	int m=(l+r)>>1;
	if(x<=m)update(p<<1,l,m,x,v);
	else update(p<<1|1,m+1,r,x,v);
}
int qw;
int query(int p,int l,int r,int s)
{
	if(l==r)
	{
		qw=l;return 0;
	}
	int m=(l+r)>>1;
	if(s>=t[p<<1])return t[p<<1]+query(p<<1|1,m+1,r,s-t[p<<1]);
	else return query(p<<1,l,m,s);
}
int main()
{
	int T,i,j,k,m,l,M,ca=0;
	scanf("%d",&T);
	while(T--)
	{
		printf("Case #%d:\n",++ca);
		scanf("%d%d",&M,&n);M++;
		for(i=0;i<n;i++)
		scanf("%d",&a[i]),a[i]++;
		s=1;
		while(s<=n)s*=2;
		build(1,0,s-1);
		memset(w,-1,sizeof(w));
		w[0]=0;c[0]=0;
		int mu=0;
		while(1)
		{
			char st;
			scanf(" %c",&st);
			if(st=='E')break;
			if(st=='I')
			{
				scanf("%d",&k);k--;
				bool f=0;
				for(l=1;l<210;l++)
				{
					if(w[l]<0||w[l]>=mu)f=1;
					if(f)
					{
						c[l]=query(1,0,s-1,c[l-1]+M);
						//printf("%d\n",qw);
						w[l]=qw;
						mu=w[l-1]+1;
					}
					if(w[l]<0||w[l]>k)
					{
						printf("%d\n",l);break;
					}
				}
			}
			else
			{
				scanf("%d%d",&i,&j);i--,j++;
				update(1,0,s-1,i,j-a[i]);
				a[i]=j;
				mu=min(mu,i);
			}
		}
		puts("");
	}
}