#include <iostream>
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

using namespace std;

class wordspara
{
public :

int lineno;
int length;
int countyet;
};

wordspara words[50000];
int m,n,a[100000];
int operat=0;
int j=0;


int getline(int i)
{
if((words[i].length + words[i-1].countyet+1 ) <=m)
return words[i-1].lineno;
else
{
return ((words[i-1].lineno)+1);
}
}

int getcountyet(int i)
{
if(words[i].length + words[i-1].countyet + 1 > m)
return words[i].length;
else
return words[i].length + words[i-1].countyet+1;
}

void printlineid(int posn)
{
cout<<words[posn-1].lineno<<endl;
}

void changelength(int posn,int len)
{
a[posn-1]= len;

if(posn==0)
posn=1;

int prevcountyet=0,prevlineno=0;

for(int i=posn-1;i<n;i++)
{
if(i==0)
{
words[i].length = a[i];
words[i].lineno=1;
words[i].countyet = a[i];
}
else
{
words[i].length = a[i];
prevcountyet=words[i].countyet;
words[i].countyet = getcountyet(i);
prevlineno=words[i].lineno;
words[i].lineno = getline(i);

if(prevcountyet==words[i].countyet && prevlineno==words[i].lineno)
    break;
}
}

}
int main()
{
int tc;
char input[50];
bool flag=true;
int lindex=0;
int num=0;
int mult=1;
char ch;
int len=0;

cin>>tc;

while(tc--)
{
    cout<<"Case #"<<j+1<<":"<<endl;
j++;
cin>>m;
cin>>n;

for(int i=0;i<n;i++)
{
cin>>a[i];
}

for(int i=0;i<n;i++)
{
if(i==0)
{
words[i].length = a[i];
words[i].lineno=1;
words[i].countyet = a[i];
}
else
{
words[i].length = a[i];
words[i].countyet = getcountyet(i);
words[i].lineno = getline(i);

}
}

while(flag)
{
scanf("%s",input);
num=0;
len=0;
mult=1;
lindex=strlen(input)-1;
if(input[0]=='E')
{
break;
}
else if(input[0]=='I')
{
cin>>num;
printlineid(num);
}
else if(input[0]=='C')
{
cin>>num;
cin>>len;
changelength(num,len);
}



}



}

return 0;


}
