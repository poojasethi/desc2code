#include<stdio.h>
typedef long long ll;
#define getchar getchar_unlocked
 
int scan_f( int *location)
{
	int digit;
	int result = 0;
    while((digit = getchar()) < '0') {}
    result=digit-'0';
	while( (digit = getchar()) >= '0')
		result = (result << 3) + (result << 1) + digit - '0';
 
	*location = result;
 
	return 0;
}
 
int a[100001];
int main()
{
    int t,n,q,w,pos,col,countd;
    int total;
    scan_f(&t);
    while(t--)
    {
        scan_f(&n);
        scan_f(&w);
        for(int i=1;i<=n;i++)
        {
            scan_f(&a[i]);
        }
        total=0;
        int p=a[1];
        countd=1;
        for(int i=2;i<=n;i++)
        {
            if(a[i]==p)countd++;
            else
                {
                    if(countd-w+1 > 0)
                        total+=(countd-w+1);
                    p=a[i];
                    countd=1;
                }
        }
            if(countd-w+1 > 0)
                total+=(countd-w+1);
 
        scan_f(&q);
        int count,count1,count2,j,i;
        while(q--)
        {
            scan_f(&pos);
            scan_f(&col);
            int tempcol=a[pos];
            count=0,i=pos-1,j=pos+1;
            if(a[pos]==col)
			{
				printf("%d\n",total);continue;
			}
			else
            {
				while(a[i]==tempcol && i>0 )
                {   count++;i--; }
				count1=0;
				while(a[j]==tempcol && j<=n )
                {   count1++;j++; }
				count2=count+count1+1;
				if(count2 >= w)
				{
					total-=count2-w+1;
				}
				if(count1 >= w)
					total+=count1-w+1;
				if(count >= w)
					total+=count-w+1;
                count=0;i=pos-1;j=pos+1;
				while(a[i]==col && i>0 )
					{count++;i--;}
				count1=0;
				while(a[j]==col && j<=n )
					{count1++;j++;}
				count2=count+count1+1;
				if(count2>=w)
				{
					total+=count2-w+1;
				}
				if(count1>=w)
					total-=count1-w+1;
				if(count>=w)
					total-=count-w+1;
            }
            a[pos]=col;
            printf("%d\n",total);
        }
    }
    return 0;
}
 