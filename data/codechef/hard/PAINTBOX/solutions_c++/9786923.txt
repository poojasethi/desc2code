#include<bits/stdc++.h>
#define rep(i,a,n) for(int _tmp=n,i=a;i<=_tmp;++i)
#define For(i,u) for(int i=H[u];i;i=nxt[i])
#define re(i,a,b) for (int i=a;i<b;++i)
#define si(x) (int)x.size()
#define pb push_back
#define mp make_pair
#define X first
#define Y second
using namespace std;
template<class T> inline void read(T&x){char c;bool fu=0;for(c=getchar();c<=32;c=getchar());if(c=='-')fu=1,c=getchar();for(x=0;c>32;c=getchar())x=x*10+c-'0';if(fu)x*=-1;}
template<class T> inline void read(T&x,T&y){read(x);read(y);}
template<class T> inline void read(T&x,T&y,T&z) {read(x,y);read(z);}
typedef long long ll;
typedef pair<int,int> pii;
#define lson l,md,x<<1
#define rson md+1,r,x<<1|1
const int N=888888;
int n,W,sum[N],l1[N],l2[N],c1[N],c2[N];
int a[N];
int get(int x){return max(0,x-W+1);}
void up(int x,int len){
	int len1=len-(len>>1),len2=len>>1,lc=x<<1,rc=x<<1|1;
	if (len1==l1[lc]&&c2[lc]==c1[rc]){
		l1[x]=len1+l1[rc];
	}else l1[x]=l1[lc];
	if(len2==l2[rc]&&c1[rc]==c2[lc]){
		l2[x]=len2+l2[lc];
	}else l2[x]=l2[rc];
	sum[x]=sum[lc]+sum[rc];
	c1[x]=c1[lc];c2[x]=c2[rc];
	if(c2[lc]==c1[rc]){
		sum[x]-=get(l2[lc])+get(l1[rc]);
		sum[x]+=get(l2[lc]+l1[rc]);
	}
}
void build(int l,int r,int x){
	if(l==r){c1[x]=c2[x]=a[l];l1[x]=l2[x]=1;sum[x]=W==1;return;}
	int md=l+r>>1;
	build(lson);build(rson);
	up(x,r-l+1);
}
void modify(int p,int c,int l,int r,int x){
	if(l==r){{c1[x]=c2[x]=a[l];l1[x]=l2[x]=1;sum[x]=W==1;return;}}
	int md=l+r>>1;
	if(p<=md)modify(p,c,lson);else modify(p,c,rson);
	up(x,r-l+1);
}
int main() {
	int T;read(T);rep(_,1,T){
		read(n,W);
		rep(i,1,n)read(a[i]);
		build(1,n,1);
		int m;read(m);
		while(m--){
			int x,y;read(x,y);a[x]=y;
			modify(x,y,1,n,1);
			printf("%d\n",sum[1]);
		}
	}
	return 0;
}
