#include<iostream>
#include<stdio.h>
using namespace std;
#define INT(x) scanf("%d",&x)
#define LLD(x) scanf("%lld",&x)
#define PINT(x) printf("%d\n",x)
#define PLLD(x) printf("%lld\n",x)
typedef long long ll;
int main(){
	int t;
	INT(t);
	while(t--){
		int n,w;
		INT(n);INT(w);
		int array[n];
		for(int i=0;i<n;i++) INT(array[i]);
		int cnt=1;
		ll ans=0;
		for(int i=1;i<n;i++){
			if(array[i-1]==array[i]) cnt++;
			else{
				if(cnt>=w) ans+=(cnt-w+1);
				cnt=1;
			}
		}
		if(cnt>=w) ans+=(cnt-w+1);
		int q;
		INT(q);
		while(q--){
			int x; int col;
			INT(x); INT(col);x--;
			if(array[x]==col) cout<<ans<<endl;
			/*else{
			int p=min(x-w+1,0);
			int q=min(x+w-1,n-1);
			cnt=1;
			for(int i=p+1;i<=q;i++){
				if(array[i-1]==array[i]) cnt++;
				else{
					if(cnt>=w) ans-=(cnt-w+1);
					cnt=1;
				}
			}
			if(cnt>=w) ans-=(cnt-w+1);
			cnt=1;
			array[x]=col;
			for(int i=p+1;i<=q;i++){
				if(array[i-1]==array[i]) cnt++;
				else{
					if(cnt>=w) ans+=(cnt-w+1);
					cnt=1;
				}
			}
			if(cnt>=w) ans+=(cnt-w+1);
			cout<<ans<<endl;}*/

		else {
				int p = min(n, x+w);
				
				int cnt=1;
				for (int i=x+1; i<p; i++) {
					if (array[i]==array[i-1]) {
						++cnt;
					} else break;
				}
				
				p = max(-1, x-w);
				for (int i=x-1; i>p; i--) {
					if (array[i]==array[i+1]) {
						++cnt;
					} else break;
				}
				if (cnt>=w) ans-=cnt-w+1;
				
				array[x]=col;
				
				cnt=1;
				p = min(n, x+w);
				for (int i=x+1; i<p; i++) {
					if (array[i]==array[i-1]) {
						++cnt;
					} else break;
				}
				
				p = max(-1, x-w);
				for (int i=x-1; i>p; i--) {
					if (array[i]==array[i+1]) {
						++cnt;
					} else break;
				}
				if (cnt>=w) ans+=cnt-w+1;
				
				printf("%lld\n", ans);
			}}
	}
}