#include<stdio.h>
#include<iostream>
#include<string.h>
#include<stdlib.h>
#include<algorithm>
#include<vector>
#define fe(i,n) for(__typeof(n.begin()) i=n.begin();i!=n.end();i++)
using namespace std;
vector<int>a[50020];
int f[50020][16];
int d[50020];
int e[50020];
int t,n,m,k;
int lca(int x,int y)
{
	int i;
	if(d[x]<d[y])
		swap(x,y);
	for(i=16;i--;)
		if(d[x]>=d[y]+(1<<i))
			x=f[x][i];
	if(x==y)
		return x;
	for(i=16;i--;)
		if(f[x][i]!=f[y][i])
			x=f[x][i],y=f[y][i];
	return f[x][0];
}
void dfs(int x,int y)
{
	f[x][0]=y;
	d[x]=d[y]+1;
	for(int i=1;i<16;i++)
		f[x][i]=f[f[x][i-1]][i-1];
	fe(i,a[x])
		if(*i!=y)
			dfs(*i,x);
}
int MIN(int x,int y)
{
	return d[x]>d[y]?x:y;
}
int S(int x,int y,int z)
{
	int xy=lca(x,y);
	int yz=lca(y,z);
	int zx=lca(z,x);
	return MIN(xy,MIN(yz,zx));
}
int E(int x,int y)
{
	if(d[x]<d[y])
	{
		for(int i=16;i--;)
			if(d[x]+(1<<i)<d[y])
				y=f[y][i];
		if(f[y][0]==x)
			return y;
	}
	return f[x][0];
}
int main()
{
	int n,m,i,p;
	int x,y,z,u;
	for(scanf("%d",&t);t--;)
	{
		scanf("%d %d",&n,&m);
		for(int i=1;i<=n;i++)
			a[i].clear();
		for(int i=1;i<n;i++)
		{
			scanf("%d %d",&x,&y);
			a[x].push_back(y);
			a[y].push_back(x);
		}
		dfs(1,0);
		while(m--)
		{
			scanf("%d",&k);
			for(int i=0;i<k;i++)
				scanf("%d",e+i);
			if(k==2)
			{
				int o=lca(e[0],e[1]);
				printf("%d\n",d[e[0]]+d[e[1]]-2*d[o]-1);
			}
			else
			{
				int o=S(e[0],e[1],e[2]);
				for(int i=0;i<k;i++)
					if(e[i]==o)
						goto bad;
				for(int i=0;i<k;i++)
					e[i]=E(o,e[i]);
				sort(e,e+k);
				for(int i=1;i<k;i++)
					if(e[i-1]==e[i])
						goto bad;
				puts("1");
				continue;
				bad:;
				puts("0");
			}
		}
	}
	return 0;
}