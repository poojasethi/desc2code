#include <iostream>
#include <cstdio>
#include <algorithm>
#include <vector>
#include <cstring>
#include <ctime>
#include <cstdlib>
#include <cmath>
using namespace std;
#define pb push_back
#define x first
#define y second
#define mp make_pair
#define troloy y1
typedef unsigned long long ll;
typedef pair <int, int> pii;


char s[100005];
int a[100005], p[100005];
int solve()
{
  int n, c4 = 0, c7 = 0;
  scanf("%s", s);
  n = strlen(s);
  for (int i = 0; i < n; i++)
    if (s[i] == '4')
    {
      c4++;
      a[i] = 1;
    } else
    {
      a[i] = -1;
      c7++;
    }
  p[n] = 0;
  int sm = 0, mn = 0;
  for (int i = n - 1; i >= 0; i--)
  {
    sm += a[i];
    p[i] = max(p[i + 1], sm - mn);
    mn = min(mn, sm);
  }

  int bal = 0, ret = max(c4, c7);
  for (int i = -1; i < n; i++)
  {
    ret = max(ret, p[i + 1] + bal + c7);
    bal += a[i + 1];
  }
  return ret;
}
int main()
{
  int t;
  cin >> t;
  for (int i = 0; i < t; i++)
    cout << solve() << endl;
  return 0;
}
