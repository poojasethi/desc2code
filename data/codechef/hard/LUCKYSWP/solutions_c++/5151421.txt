#include<cstdio>
#include<iostream>
#include<string>
#include<algorithm>
#include<string.h>
using namespace std;



int search(int f,int e,char s[],char c)
{
	if(f>=e)
		return 0;
	int mid=(f+e)/2;
	int ans=max(search(f,mid,s,c),search(mid+1,e,s,c));
	int local=0;
	int pr4=0;
	int pr7=0;
	int rs=0;
	int i;
	for(i=mid+1;i<=e;i++)
	{
		if(s[i]==c)
			pr4++;
		else
			pr7++;
		rs=max(rs,pr7-pr4);
	}
	local+=rs;
	rs=0;pr4=0;pr7=0;
	for(i=mid;i>=f;i--)
	{
		if(s[i]==c)
			pr4++;
		else
			pr7++;
		rs=max(rs,pr7-pr4);
	}
	local+=rs;
	return max(local,ans);
}
int main()
{
	int t;
	cin>>t;
	char s[100003];
	int i,j;
	while(t--)
	{
		scanf("%s",s);
		int n=strlen(s);
		int total=0;
		for(i=0;i<n;i++)
			if(s[i]=='7')
				total+=1;
		int pr4=0;
		int pr7=0;
		int len=0;
		int ind=-1;
		for(i=0;i<n;i++)
		{
			if(pr4+total-pr7>len)
			{
				ind=i;
				len=pr4+total-pr7;
			}
			if(s[i]=='4')
				pr4++;
			else
				pr7++;
		}
		if(pr4+total-pr7>len)
		{
				ind=i;
				len=pr4+total-pr7;
		}
		int val1=search(0,ind-1,s,'4');
		int val2=search(ind,n-1,s,'7');
		printf("%d\n",len+max(val2,val1));
	}
	return 0;
}
