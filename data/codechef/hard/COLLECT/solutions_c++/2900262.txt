#include <iostream>
#include <stdio.h>

using namespace std;
typedef long long ll;
const int maxn = 5e6 + 5;
#define read(x) scanf("%d",&x)

int n,q;
ll mod = 3046201;
ll fact[maxn];
ll abi[maxn];
char line[20];
int num[maxn];

ll query(int pos)
{
	ll res = 0;

	while(pos)
	{
		res += abi[pos];
		pos -= (pos&-pos);
	}
	return res;
}

void update(ll v, int pos)
{
	if(pos == 0)return;
	while(pos <= n)
	{
		abi[pos] += v;
		pos += (pos&-pos);
	}
}

void change(ll v, int pos)
{
	update(-num[pos],pos);
	update(v,pos);
}

void factor()
{
	fact[0] = fact[1] = 1;
	for(int i = 2; i < maxn; i++)
	{
		fact[i] = fact[i - 1]*(ll)i;
		fact[i] %= mod;
	}
}

ll power(ll a, int pot)
{
	if(a == 0 || a == 1)return a;
	if(pot == 1)return a;
	if(pot == 0)return 1;

	ll res  = power(a,pot/2);
	res = (res*res)%mod;
	if(pot & 1)
		res *= a;
	res %= mod;
	return res;
}

ll comb(int v, int k)
{
	if(k == 0)return 1;
	if(k == 1)return v;
	ll num = fact[v];
	ll den = (fact[k]*fact[v - k])%mod;
	den = power(den,mod - 2);
	return (num*den)%mod;
}

ll distribute ( int berry, int people )
{
	int r = berry % people;
	int blank = people - r;
	int q = ( berry + blank ) / people;

	ll numerator = ( fact[berry] * fact[people] ) % mod;

	ll denominator = ( ( ( power ( fact[q], r ) * power ( fact[q-1], blank ) ) % mod ) * ( ( fact[r] * fact[blank] ) % mod ) ) % mod;
	denominator = power( denominator, mod - 2 );
	return ( numerator * denominator ) % mod;
}

ll mio(int a, int b)
{
	ll sum = query(b) - query(a - 1);
	int c = b - a + 1;
	ll r = sum%c;
	//ll f = sum/c;

	ll aux = c - r;

	ll s = (sum + aux)/c;
	ll f = s - 1;

	ll res = 0;

	ll num = (fact[sum]*fact[c])%mod;

	ll den1 = power(fact[s],r);
	ll den2 = power(fact[f],c - r);
	ll den3 = (fact[r]*fact[c - r])%mod;

	ll den = power((den3*((den1*den2)%mod))%mod,mod - 2);
	res = num;
	res = (res*den)%mod;
	return res;
}

int main()
{
	//cout << comb(5,0) << endl;
	factor();
	read(n);
	int a,b;
	for(int i = 1; i <= n; i++)
	{
		read(num[i]);
		update(num[i],i);
	}

	read(q);

	while(q--)
	{
		cin >> line;
		scanf("%d %d",&a,&b);
		if(line[0] == 'c')
		{
			change(b,a);
			num[a] = b;
		}
		else
		{
			if(a > b)swap(a,b);

			ll res = mio(a,b);

			printf("%lld\n",res);
		}
	}

	return 0;
}
