#include<stdio.h>
#include<iostream>
#include<string.h>
#include<queue>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<fstream>
#include<cmath>
#include<iomanip>
#include<time.h>
using namespace std;
#define ll long long
#define ull unsigned long long
#define inf 1000000007
#define mod 1000000007
#define pii pair<int,int>
#define vi vector<int>
#define VS vector<string>
#define all(x) x.begin(),x.end()
#define mp make_pair
#define pb push_back
#define x first
#define y second
#define N 100010
#define pi 3.14159265358979323846
#define DBG(vari) cerr<<#vari<<"="<<(vari)<<endl;
#define FOREACH(i,t) for(__typeof(t.begin()) i=t.begin();i!=t.end();i++)

vector<pii>v;
int main()
{
	int i,j,T,ca=0,k,m,n;
	scanf("%d",&T);
	while(T--)
	{
		scanf("%d",&n);
		v.clear();
		for(i=0;i<n;i++)
		{
			scanf("%d",&j);
			for(k=2;k<=j/k;k++)
			if(j%k==0)
			{
				int cnt=0;
				while(j%k==0)j/=k,cnt++;
				v.pb(mp(k,cnt));
			}
			if(j>1)v.pb(mp(j,1));
		}
		sort(all(v));
		ll ans=1;
		priority_queue<int>q;
		for(i=0;i<v.size();i=j)
		{
			j=i;
			while(j<v.size()&&v[j].x==v[i].x)
			{
				q.push(v[j].y);j++;
			}
			while(!q.empty())
			{
				if(q.size()==1)
				{
					int a=q.top();q.pop();
					while(a--)ans=ans*v[i].x%mod;
				}
				else if(q.size()==2)
				{
					int a=q.top();q.pop();
					int b=q.top();q.pop();
					a-=b;
					while(a--)ans=ans*v[i].x%mod;
				}
				else
				{
					int a=q.top();q.pop();
					int b=q.top();q.pop();
					a--,b--;
					if(a)q.push(a);if(b)q.push(b);
				}
			}
		}
		printf("%d\n",(int)ans);
	}
	return 0;
}