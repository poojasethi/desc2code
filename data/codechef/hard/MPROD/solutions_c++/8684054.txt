#include <bits/stdc++.h>
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define ll long long
#define ull unsigned long long
#define mp make_pair
#define f first
#define s second
#define N 10007
#define cs 1373
#define BIT(i, n) ( (n >> i) & 1 )
#define ln 1000000000
#define oo 1000000007
#define Pa pair <int, int>

using namespace std;

int ok[N], S[N], cnt, n, u, P[N], rest[2*N], Ma[N];

int Pow(int x, int y)
{
    if(y == 0)  return 1;
    ll u = Pow(x, y/2);
    u = u * u % oo;
    if(y % 2)   u = u * x % oo;
    return u;
}

int main()
{
    ios_base::sync_with_stdio(0);
   // filein("MPROD.inp");    fileout("MPROD.out");
    srand(time(0));
    int T;
    for(int i=2; i<N; i++)
    {
        if(ok[i])   continue;
        S[++cnt] = i;
        for(int j=i; j<N; j+=i)
            ok[j] = 1;
    }
    cin >> T;
    while(T--)
    {
        ll ans = 1;
        int num = 0;
        cin >> n;
    //    n = 20000;
        int w = 0;
        for(int i=1; i<=n; i++)
        {
            cin >> u;
         //   u = rand() * rand() % (1000007) + 1;
            for(int j=1; j <= cnt; j++)
            {
                w = 0;
                while(u % S[j] == 0)
                {
                    w++;
                    u /= S[j];
                }
                P[j] += w;
                Ma[j] = max(Ma[j], w);
            }
            if(u > 1)   rest[++num] = u;
        }
        sort(rest+1, rest+num+1);
        rest[num+1] = 0;
        w = 0;
        for(int i=1; i<=num+1; i++)
        {
            if(rest[i] != rest[i-1])
            {
                ans = ans * ((w == 0) ? 1 : rest[i-1]) % oo;
                w = 1;
            }
            else
                w ^= 1;
        }
        for(int i=1; i<=cnt; i++)
        {
            if(Ma[i] <= P[i]/2) ans = ans * (P[i] % 2 == 0 ? 1 : S[i]) % oo;
            else    ans = ans * Pow(S[i], 2*Ma[i]-P[i]) % oo;
            P[i] = Ma[i] = 0;
        }
        cout << ans << endl;
    }
}
