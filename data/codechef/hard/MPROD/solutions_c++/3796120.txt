#include<iostream>	//------------------------------------------------------------//
#include<cstdio>    //  ___  ___ _____ ______                                     //
#include<algorithm> //  |  \/  |/  ___|| ___ \     This C++ Template Belongs to   //
#include<cmath>     //  | .  . |\ `--. | |_/ /        Manish Singh Bisht          //
#include<vector>    //  | |\/| | `--. \| ___ \       http://fb.me/manish05        //
#include<set>       //  | |  | |/\__/ /| |_/ /    Email: manish05@facebook.com    //
#include<map>       //  \_|  |_/\____/ \____/                                     //
#include<functional>//------------------------------------------------------------//
#include<string>
#include<cstring>
#include<bitset>
#include<cstdlib>
#include<queue>
#include<utility>
#include<fstream>
#include<sstream>

#include<stack>
#include<cstdio>
#include<ctime>
         

using namespace std;
#define gc getchar_unlocked
#define MEM(a,b) memset(a,(b),sizeof(a))
#define FOR(i,n) for(int i=(0);i<(n);i++)
#define TR(v,it) for(typeof(v.begin()) it(v.begin()) ; it != v.end() ; it++)
#define SZ(v) (int)sizeof(v)
#define CLEAR(a) memset((a),0,sizeof(a))
#define S(n) scanf("%d", &n)
#define P(k) printf("%d\n", k)
#define fastS(n) scanint(&n)
#define pb push_back
#define mp make_pair
#define ll long long
#define VI vector<int>
#define PII pair<int, int>
#define ft first
#define sd second
#define all(a) a.begin(),a.end()
#define lb lower_bound
#define ub upper_bound
#define inf (1<<30)
#define PNL printf("\n")
#define md 1000000007
#define bigger(a,b) (a>b?a:b)
#define smaller(a,b) (a<b?a:b)
#define positive(a) (bigger(a,-a))
#define fastS(x) scanint(&x)

void scanint(int *x)                
{
    register int c = gc();
    *x = 0;
    for(;(c<48 || c>57);c = gc());
    for(;c>47 && c<58;c = gc()) {*x = (*x<<1) + (*x<<3) + c - 48;  }
}
ll modPow(ll a,ll b)
{ll x;
    for(x=1;b>0;b/=2,a=(a*a)%md)
        if(b%2==1)
                x=(x*a)%md;
  return x%md;
}

string convertInt(int number){stringstream ss;ss << number;return ss.str();}
int convertString(string s){int num;stringstream sstr(s);sstr>>num;return num;}
int gcd(int a, int b){ return b?gcd(b,a%b):a; }


int minP[(int)1e8+1];
int all_primes[(int)1e7*3 +1];
char al_primes[(int)1e7*3 +1];
int main()
{
	int cur=0;
	for(int i=2;i<=3*1e7;i++)
		if(al_primes[i]==0){
			all_primes[cur++]=i;
			for(int j=2*i;j<=3*1e7;j+=i)al_primes[j]=1;
		}
	
	int T;
	fastS(T);
	while(T--){
	    int n;
	    fastS(n);
	    VI ar(n);
	    map<int,pair<int,int> > P;
	    FOR(i,n){
	    	fastS(ar[i]);
	    	
	    	int x=ar[i];
	    	int j=all_primes[cur-1]+2,cnt=0,k=0;
	    	int maxP=all_primes[cur-1];
	    	while(x!=1){
	    		if(x<maxP && al_primes[x]==0){
	    			cnt=0;
	    			int PPPP=x;
		    		while(x%PPPP==0){
		    			cnt++;
		    			P[PPPP].ft++;
		    			x/=PPPP;
		    			if(cnt>P[PPPP].sd)P[PPPP].sd=cnt;
		    		}	
	    			break;
	    		}
	    		cnt=0;
	    		int PPPP=j;
	    		if(k<cur)PPPP=all_primes[k++];
	    		else j+=2;
if(PPPP*PPPP>x)PPPP=x;
	    		while(x%PPPP==0){
	    			cnt++;
	    			P[PPPP].ft++;
	    			x/=PPPP;
	    			if(cnt>P[PPPP].sd)P[PPPP].sd=cnt;
	    		}
	    	}
	    }
	    
	    long long ans=1;
	    
	    
	    TR(P,it){
	    	pair<int,int> temp=it->sd;
	    	int buffer=temp.ft;
	    	int mx=temp.sd;
	    	if(mx*2>buffer)buffer=mx*2-buffer;
	    	else buffer=buffer%2;
	    	ans = (ans * (modPow((ll)(it->ft),(ll)buffer))) % md;
	    }
	    cout<<ans<<endl;
	}
    return 0;
}