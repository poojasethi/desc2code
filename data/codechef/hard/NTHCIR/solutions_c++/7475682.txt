#include<cstdio>
int main()
{
	long long m,p,b,n,ns,prev;double sum=0,R[5],K[5],l,k,c;int t,i,j;
	scanf("%d",&t);
	scanf("%lld %lld %lld %lld",&n,&p,&m,&b);
	scanf("%lf %lf %lf %lf",&R[1],&R[2],&R[3],&R[4]);
	K[1] = -(1/R[1]);
	K[2] = 1/R[2];
	K[3] = 1/R[3];
	K[4] = 1/R[4];
	c=K[1]+K[2];
	ns=n;
	for(i=0;i<t;i++)
	{
		n = (p*n)%m +b;
		if(ns==n)
		{
			if(i==0)
			{
				l=n-4;k=n-3;
				sum = (t/(l*k*c + k*K[4] - l*K[3]));
				break;
			}
			else
			{
				l=n-4;k=n-3;
				sum += 1/(l*k*c + k*K[4] - l*K[3]);i++;
				j=t/i;
				sum += (j-1)*sum;i = j*i;i--;
			}
		}
		else
		{
			l=n-4;k=n-3;
			sum += 1/(l*k*c + k*K[4] - l*K[3]);
		}
	}
	printf("%0.6lf\n",sum);
	return 0;
} 