/*
Submitted by: prakhar8795
JustMultiply (From EDITORIAL)
*/

#include<stdio.h>
#include<string.h>


long long mult(long long A, long long B, long long MOD)
{
	if ( B == 0 ) return 0;
	long long u = mult(A, B/2, MOD);
	long long res;
	if ( B%2 == 0 )
		res = u + u;
	else
		res = u + u + A;
	while ( res >= MOD ) res -= MOD;
	return res;
}


long long modulo(long long base, long long exponent, long long mod)
{
    long long x = 1;
    long long y = base;
    while (exponent > 0) {
        if (exponent % 2 == 1)
            x = mult(x,y,mod) ;
        y = mult(y,y,mod) ;
        exponent = exponent / 2;
    }
    return x % mod;
}


int main()
{
    int test ;
    scanf("%d",&test) ;
    while(test--) {
        unsigned long long int m ;
        scanf("%llu",&m) ;
        char input[10001];
        scanf("%s",input) ;
        int i,j=0 ;
        long long ans=1%m ;
        for(i=0 ; i<strlen(input) ; i++) {
            long long F=0 ;
            j=i ;
            while(input[j]>='0' && input[j]<='9'){
                F = mult(F,10,m) ;
                F += input[j]-'0' ;
                F %= m ;
                j++ ;
            }
            j++ ;
            j++ ;
            long long secF=1%m ;
            while(input[j]>='0' && input[j]<='9') {
                secF=modulo(secF,10,m) ;
                secF=mult(secF,modulo(F,input[j]-'0',m),m) ;
                j++ ;
            }
            i=j ;
            ans=mult(ans,secF,m) ;
        }
        printf("%llu\n",ans) ;
    }
    return 0 ;
}
