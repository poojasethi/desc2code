#include<bits/stdc++.h>
using namespace std;
char s[10009];

long long mul(long long a,long long b,long long m)
{
	long long ans=0;
	while(b)
	{
		//a=a%m;
		while(a>=m)a-=m;
		if(b&1)
			ans=ans+a;//)%m;
		if(ans>=m)ans-=m;

		b>>=1;
		a<<=1;
	}
	return ans;
}
/*long long powm(long long a,long long b,long long mod)
{
	long long ans=1;
	a=a%mod;
	while(b)
	{
		if(b&1)
			ans=mul(ans,a,mod);
		a=mul(a,a,mod);
		b>>=1;
	}
	return ans;
}*/
int main()
{
	long long m,x,y,ans,xpowy,dp[10],tmp;
	int i,j,len;

	int t;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%lld%s",&m,s);
		//ans=1%m;
		ans=(m!=1);
		len=strlen(s);
		for(i=0;i<len;++i)
		{
			x=0;
			for(j=i;s[j]!='*';++j)
			{
				x=(mul(x,10,m)+s[j]-'0');
				if(x>=m)x-=m;
			}
			++j;//1 star
			++j;//2 star
			dp[0]=1;
			for(int k=1;k<10;++k)
				dp[k]=mul(dp[k-1],x,m);
			//xpowy=1%m;
			xpowy=(m!=1);
			for(;j<len&&s[j]!='*';++j)
			{
				//xpowy=powm(xpowy,10,m);
				tmp=xpowy;
				for(int k=1;k<10;++k)
					tmp=mul(tmp,xpowy,m);
				xpowy=tmp;
				xpowy=mul(xpowy,dp[s[j]-'0'],m);
			}
			i=j;
			ans=mul(ans,xpowy,m);
		}
		printf("%lld\n", ans);
	}
	return 0;
}