#include<bits/stdc++.h>
using namespace std;
char s[10009];

long long mul(long long a,long long b,long long m)
{
	if(b==0)
		return 0;
	long long u=mul(a,b/2,m);
	u=(u+u)%m;
	if(b&1)
		return (u+a)%m;
	return u;
}
long long powm(long long a,long long b,long long mod)
{
	long long ans=1;
	a=a%mod;
	while(b)
	{
		if(b&1)
			ans=mul(ans,a,mod);
		a=mul(a,a,mod);
		b>>=1;
	}
	return ans;
}
int main()
{
	long long m,x,y,ans,xpowy;
	int i,j,len;
	
	int t;
	scanf("%d",&t);
	while(t--)
	{
		scanf("%lld%s",&m,s);
		ans=1%m;
		len=strlen(s);
		for(i=0;i<len;++i)
		{
			x=0;
			for(j=i;s[j]!='*';++j)
			{
				x=mul(x,10,m);
				x=(x+s[j]-'0')%m;
			}
			++j;//1 star
			++j;//2 star
			xpowy=1%m;
			for(;j<len&&s[j]!='*';++j)
			{
				xpowy=powm(xpowy,10,m);
				xpowy=mul(xpowy,powm(x,s[j]-'0',m),m);
			}
			i=j;
			ans=mul(ans,xpowy,m);
		}
		printf("%lld\n", ans);
	}
	return 0;
}