t = input()
for k in range(t):
	x =  raw_input().split(" ")
	m = int(x[0])
	s = x[1].replace("**","^")
	s1 = s.split("*")
	ans =1
	for i in s1:
		a = i.split("^")
		ans =(ans*pow(int(a[0]),int(a[1]),m))%m
	print ans