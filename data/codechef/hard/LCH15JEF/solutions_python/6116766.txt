__author__ = 'KH9071'

n = input()
while n:
    n -= 1
    s = raw_input().split()
    mod = int(s[0])
    expr = s[1].replace("**","pow")
    expr = expr.split("*")
    pro = 1
    for each in expr:
        each = each.split("pow")
        a , b = int(each[0]), int(each[1])
        pro = (pro* pow(a,b,mod))%mod
    print pro