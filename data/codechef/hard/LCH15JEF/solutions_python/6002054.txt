# your code goes here
import re
t=int(raw_input())
for ma in  xrange(t):
	m,s=raw_input().split()
	a = re.split(r'[^0-9]*', s)
	m=long(m)
	#print a
	ans=1
	l=len(a)
	for i in xrange(0,l,2):
		ans=(ans%m*pow(long(a[i]),long(a[i+1]),m)%m)%m
	print ans