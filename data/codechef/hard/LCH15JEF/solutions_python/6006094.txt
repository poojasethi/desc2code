t=input()
while(t):
	t=t-1
	s=raw_input().split()
	m=s[0]
	s=s[1]
	ans=1
	m=int(m)
	s=s.replace("**",'*').split('*')
	i=0
	while(i<len(s)):
		s[i]=int(s[i])
		s[i+1]=int(s[i+1])
		ans=(ans*pow(s[i],s[i+1],m))%m
		i=i+2
	print ans

 
