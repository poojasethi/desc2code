# your code goes here
t=int(raw_input())
for ii in range(t):
	y=raw_input().split()
	s=y[1].replace("**","^")
	m=int(y[0])
	#print s
	s=s.split("*")
	ans=1
	for i in s:
		a,b=map(int,i.split("^"))
		ans=(ans*pow(a,b,m))%m
	print ans
	
