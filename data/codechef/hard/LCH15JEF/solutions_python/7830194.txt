import math
t = int(input())
for _ in range(t):
    M,S = raw_input().split()
    M = int(M)
    S = S.split('*')
    ans = 1
    for i in range(0, len(S), 3):
        ans = (ans * pow(int(S[i]), int(S[i+2]), M)) % M
    print(ans)