import re
t = int(raw_input())
for case in range(t):
    m, exp = raw_input().split()
    m = int(m)
    exp = re.split(r'[^0-9]+', exp)
    result = 1
    for i in xrange(0, len(exp), 2):
        result = (result * (pow(int(exp[i]), int(exp[i + 1]), m))) % m
    print result

