def fun():
    r=raw_input()
    r=r.split()
    k=r[0];
    q=r[1].replace("**","^")
    q=q.split("*")
    w=len(q)
    ans=1
    for i in range(0,w):
         h=q[i].split("^")
         a=int(h[0])
         b=int(h[1])
         ans=ans*pow(a,b,int(k))%(int(k))
    print ans%int(k)
t=int(raw_input())
for i in range(0,t):
    fun()
