t = input()
for i in xrange(0,t):
    s = raw_input().split()
    M = int(s[0])
    
    exp = s[1].replace("**"," ").split("*")
    r = 1
    for i in exp:
        e = i.split()
        b =int(e[0])
        p =  int(e[1])
        r = (r*pow(b,p,M))%M
    print r 
    