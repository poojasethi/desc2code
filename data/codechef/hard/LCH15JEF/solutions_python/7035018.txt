for _ in range(int(raw_input())):
 m,s=raw_input().split()
 m=int(m)
 a=s.replace('*',' ').split()
 ans=1
 for i in range(len(a)/2):
   ans=(ans*pow(int(a[2*i]),int(a[2*i+1]),m))%m
 print ans