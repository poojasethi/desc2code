t1=int(raw_input())
for i in range(0,t1):
    k=raw_input().split()
    m=int(k[0])
    #pp=k[1].strip()
    cc=k[1].replace("**",',')
    pp=cc.split('*')
    answer=1
    for r in pp:
        a1,a2=r.split(',')
        answer=answer*pow(int(a1),int(a2),m)
    print answer%m