def main():
	t=input()
	while(t):
		t=t-1
		m,s=raw_input().split()
		ans=1
		m=int(m)
		s=s.replace("**",'*').split('*')
		#print m
		#print s
		i=0
		while(i<len(s)):
			s[i]=int(s[i])
			#print s[i]
			s[i+1]=int(s[i+1])
			#print s[i+1]
			#print ans
			ans=(ans*pow(s[i],s[i+1],m))%m
			#print ans
			i=i+2
		print ans
	return 0
 
main() 
