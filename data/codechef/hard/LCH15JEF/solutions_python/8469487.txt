import string
for _ in range(input()):
	m,e=raw_input().split()
	m=int(m)
	e=str(e)
	
	e=string.replace(e,'**',',').split("*")
	#m= e.split(',')
	
	ans=1
	for i in e:
		a,b=map(int,i.split(','))
		ans=ans*pow(a,b,m)
		ans%=m
	print ans	
		
	