for t in xrange(input()):
	m,s=raw_input().split()
	s=s.split('*')
	m=int(m)
	mul=1
	for i in xrange(0,len(s),3):
		x,y=int(s[i]),int(s[i+2])
		mul*=pow(x,y,m)
		mul%m
	print mul%m