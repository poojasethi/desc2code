import sys
def main():
	t = input()
	infile = sys.stdin
	
	for line in infile:
		line = line.strip('\n')
		m,s = line.split()
		m = int(m)
		s = s.replace("**","-")
		s = s.split('*')
		ans = 1
		for i in s:
			b,e = map(int,i.split('-'))
			ans = (ans * pow(b,e,m)) % m
		print ans
main()