#include<bits/stdc++.h>
using namespace std;
#define ll long long 
#define MAX 1000010
ll a[MAX];

int main()
{
ll t,ans,st,fin,p,i,len;
string s;
cin>>t;

while(t--)
{
    cin>>s;
    len=s.length();
    ans=0;
for(i=1;i<=len;i++)
{
if(s[i-1]=='1')
a[i]=1;
else
a[i]=0;
}
//Palindromes of odd length >=3
for(p=2;p<=len;p++)
{
    for(i=1;i*p<=len;i++)
    {
        if(i%p==0)
        {
            st=i/p;
            fin=i*p;
            
            while(st>=1&&fin<=len&&a[st]==a[fin])
            {
                ans++;
                //cout<<"odd "<<st<<" "<<fin<<"\n";
                if(st%p==0)
                st/=p;
                
                else
                    break;
                fin*=p;
            }
            
        }
    }
}

//Palindromes of even length >=2

for(p=2;p<=len;p++)
{
    for(i=1;i*p<=len;i++)
    {
        
            st=i;
            fin=i*p;
            while(st>=1&&fin<=len&&a[st]==a[fin])
            {
                ans++;
                //cout<<"even "<<st<<" "<<fin<<"\n";
                if(st%p==0)
                st/=p;
                else
                    break;
                fin*=p;
            }
        }
    
}
cout<<ans+len<<"\n";
}
return 0;
}