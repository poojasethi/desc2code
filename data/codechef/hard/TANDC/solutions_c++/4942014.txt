#include <cstdio>
#include <iostream>
#define MOD 1000000007
using namespace std;
long long int exp(long long int m, long long int r) {
        long long int temp = 1;
        while (r) {
              if (r % 2 == 0) {
                    m = (m % MOD) * (m % MOD) % MOD;
                    r /= 2;
                } else {
                    temp = (temp % MOD) * (m % MOD);
                    temp = temp % MOD;
                    r--;
                }
        }

        return temp;
    }
int main() {
    int t;
    long long int m, r, ans ,temp;
    scanf("%d", &t);
    while (t--) {
        scanf("%lld%lld", &m, &r);
        temp = 1;
        temp = exp(m, r);
        temp--;
        ans = (temp % MOD) * (exp(m - 1, MOD - 2) % MOD);
        ans = (ans - r) % MOD;
        printf("%lld\n", ans);
        }
    return 0;
    }
