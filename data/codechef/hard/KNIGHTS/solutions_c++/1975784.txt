#include <cstdio>
#include <cstring>
#include <algorithm>
#include <iostream>
#include <climits>
#include <numeric>
#include <vector>
#include <cmath>
#include <set>
#include <map>
using namespace std;
#define ll long long
#define mp make_pair
#define pb push_back
#define fi first
#define se second
#define rep(i,n) for(int i=0;i<n;i++)
#define all(a)  a.begin(),a.end()
#define ESP (1e-9)
#define N 100010
#define M 1000000007
#define sz(a) int(a.size())
#define pii pair<int,int>
#define vi vector<int>
char s[35];
const int dx[8]={-2, -1, 1, 2, 2, 1, -1, -2};
const int dy[8]={-1, -2, -2, -1, 1, 2, 2, 1};
int b[30][30],n,m;
int in(int x,int y)
{return x>=0&&x<n&&y>=0&&y<m;}

int dfs(int x,int y,char v[30][30])
{
 if(v[x][y]||b[x][y]==-1)return 0;
 v[x][y]=1;
 for(int i=0;i<8;i++)
 {
  int nx=x+dx[i],ny=y+dy[i];
  if(in(nx,ny))
  {
   int &w=b[nx][ny];
   if(w==0||(w>0&&dfs(w/32,w%32,v)))
   {
    w=y+x*32;
    return 1;
   }
  }
 }
 return 0;
}
int main()
{
	//freopen("in.txt","r",stdin);
	int T,i,j,k,x,K;
	scanf("%d",&T);
	while(T--)
	{
	 scanf("%d%d",&n,&m);
	 for(i=0;i<n;i++)
	 {
	  scanf("%s",s);
	  for(j=0;j<m;j++)
	  b[i][j]=(s[j]=='.'?0:-1);
	 }
	 int res=0;
	 for(i=0;i<n;i++)
	 for(j=0;j<m;j++)
	 if(b[i][j]!=-1)
	 {
	 	res++;
	 	if((i^j)&1)
	 	{
	 	 char v[30][30]={{0}};
	 	 res-=dfs(i,j,v);
	 	}
	 }
	 printf("%d\n",res);
	}
	return 0;
}
