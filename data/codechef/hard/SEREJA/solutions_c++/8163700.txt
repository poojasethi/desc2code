#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
#define N 100010
#define M 1000000007
#define ll long long
#define uint unsigned
#define ull unsigned long long
uint a[N],ans;
void pow(ull a,ull b)
{
 while(b)
 {
  if(b&1)ans=(ans*a)%M;
  a=(a*a)%M;b>>=1;
 }
}
void solve(int l,int r)
{
 int x=l,i,j,k;
 for(i=l;i<=r;i++)if(a[x]<a[i])x=i;
 for(i=x-1,k=x;i>=l;i=j)
 {
  for(j=i-1;a[j]>=a[i]&&j>=l;j--);
  for(;a[k]>=a[i]&&k<=r;k++);
  pow(a[x]-a[i],(i-j)*(ull)(k-x));
 }
 for(i=x+1,k=x;i<=r;i=j)
 {
  for(j=i+1;a[j]>=a[i]&&j<=r;j++);
  for(;a[k]>a[i]&&k>=l;k--);
  pow(a[x]-a[i],(x-k)*(ull)(j-i));
 }
 if(l<x-1)solve(l,x-1);
 if(x+1<r)solve(x+1,r);
}
int main()
{
  //  freopen("in.txt","r",stdin);
	int T,i,j,k,b,c,n;
	//scanf("%d",&T);
	while(~scanf("%d",&n))
	{
	 a[0]=~0;
	 ans=-1;
	 for(i=1;i<=n;i++)
	 {
	 	scanf("%u",&a[i]);
	    if(a[i]==a[i-1])ans=0;
	 }
	 if(ans==0)
	 {
	  printf("0\n");continue;
	 }
	 ans=1;
	 solve(1,n);
	 printf("%u\n",ans);
	}
	return 0;
}
 
