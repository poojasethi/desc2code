#include <bits/stdc++.h>
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define ll long long
#define mp make_pair
#define f first
#define s second
#define N 1000007
#define cs 1373
#define BIT(i, n) ( (n >> i) & 1 )
#define ln 1e12+1
#define oo 1000000007


using namespace std;

int a[N], V[N], n;
ll G[N], ans[N];

int Solve(int pos)
{
    int Ma = pos, Mi = pos;
    while(a[pos] >= a[Ma] && Ma)  Ma--;
    while(a[pos] <= a[Mi] && Mi)  Mi--;
    int M = min(Ma, Mi);
    Ma = a[pos];    Mi = a[pos];
    for(int i=pos-1; i>M; i--)
    {
        Ma = max(Ma, a[i]);
        Mi = min(Mi, a[i]);
        V[i] = Ma - Mi;
    }
    for(int i=M+1; i<pos; i++)
        G[i] = G[i-1] * V[i] % oo;
    return G[pos-1];
}

int main()
{
    ios_base::sync_with_stdio(0);
    //filein("inp.txt");  fileout("out.txt");
    cin >> n;
    for(int i=1; i<=n; i++)
        cin >> a[i];
    ans[0] = G[0] = 1;
    for(int i=1; i<=n; i++)
        ans[i] = ans[i-1] * Solve(i) % oo;
    cout << ans[n];
}
