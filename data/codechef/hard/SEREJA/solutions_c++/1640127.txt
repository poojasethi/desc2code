/* Author: Karlheinz Jung */
/* Compiler: C++(at)ideone.com */
/* Computer: Rabbit 286 */
/* Contest: December 2012 Long Contest (DEC12) */
/* Problem: Sereja and Data Structures (SEREJA) */

#include <iostream>
#include <map>
#include <climits>

using namespace std;

#define LL long long
#define mod 1000000007
#define _T for(;!(*ez1>='0'&&*ez1<='9'||*ez1=='-');ez1++);if(*ez1=='-'){wq1=-1;ez1++;}while(1){char c=*ez1;if(c<=32)return wq2*wq1;wq2=(wq2<<1)+(wq2<<3)+c-'0';ez1++;}
#define _S s=in!=-1?(s*in)%mod:s;
#define _Q gets(pq1);ez1=pq1;

char pq1[4000000];
char *ez1;

LL sLL(){LL wq1=1,wq2=0;_T}

LL n, su=1;
LL a[100001];
map <pair<LL,LL>,LL> mp;

LL A(LL a, LL b, LL c)
{
LL x=0, y=a%c;
for(;b>0; x=b&1?(x+y)%c:x,y=(y*2)%c,b/=2);
return x%c;
}

LL B(LL a, LL b)
{
LL x=1, y=a;
for(;b>0; x=b&1?A(x,y,mod):x,y=A(y,y,mod),b/=2);
return x%mod;
}

LL C(LL a, LL b, LL c)
{
LL i, r=1;
for(;b>0; r=b&1?(r*a)%c:r,b>>=1,a=(a*a)%c);
return r;
}

LL D(LL a, LL b)
{
return C(a,b-2,b);
}

LL E(LL i, LL j)
{
LL mi=INT_MIN, ma=INT_MAX, p1, p2, x, in, s=1, k;
if(mp.find(pair<LL,LL>(i,j))!=mp.end()) return mp[pair<LL,LL>(i,j)];
if(i>=j) return mp[pair<LL,LL> (i,j)]=-1;
for(k=i-1; ++k<=j; ma=a[k]<ma?a[p1=k]:ma,mi=a[k]>=mi?a[p2=k]:mi);
if(p1>p2) swap(p1,p2);
x=mi-ma;
s=(s*B(x,((p1+1-i)*(j-p2+1))))%mod;
in=E(i,p2-1);_S
in=E(p1+1,j);_S
in=D(E(p1+1,p2-1),mod);_S
return mp[pair<LL,LL>(i,j)]=su=s;
}

main()
{
LL *p, *q;
_Q n=sLL(); _Q
for(q=(p=a+1)+n; p<q; p++)
	if(!(*p=sLL()))
		{
		puts("0");
		return 0;
		}
printf("%lld\n",E(1,n));
return 0;
}
