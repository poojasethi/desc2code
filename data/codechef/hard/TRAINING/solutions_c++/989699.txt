#include <cstdio>
#include <cstring>
#include <cstdlib>
#include <cmath>
#include <string>
#include <iostream>
#include <vector>
#include <map>
#include <utility>
#include <algorithm>
#include <queue>
#include <set>
#include <stack>
#include <list>

using namespace std;

#define X first
#define Y second
#define mk(x, y) make_pair(x, y)
#define pb(x) push_back(x)
#define rep(x, n) for (int x = 0; x < n; x++)
#define range(x, a, b) for (int x = a; x <= b; x++)
#define sz(x) x.size()
#define setv(x, y) memset(x, y, sizeof(x))

typedef long long ll;
typedef pair<int, int> pii;

vector<pii> a;

int main()
{
	int T;

	//freopen("input.txt", "r", stdin);

	scanf("%d", &T);
	while (T--) {
		int n;
		scanf("%d", &n);
		a.clear();
		rep(i, n) {
			int h, w;
			scanf("%d%d", &h, &w);
			a.pb(mk(h, w));
		}
		sort(a.begin(), a.end());
		reverse(a.begin(), a.end());
		vector<int> b;
		vector<int> ans;
		for (int i = 0; i < a.size(); i++) {
			int y = a[i].Y;
			int l = 0, r = b.size();
			while (l < r) {
				int mid = (l + r) / 2;
				if (b[mid] < y) {
					r = mid;
				} else {
					l = mid + 1;
				}
			}
			if (r == b.size()) {
				b.push_back(y);
				ans.push_back(1);
			} else {
				b[r] = y;
				ans[r]++;
			}
		}

		printf("%d\n", ans.size());
		for (int i = 0; i < ans.size(); i++) {
			printf("%d", ans[i]);
			if (i != ans.size() - 1)
				printf(" ");
		}
		printf("\n");
	}
	return 0;
}
