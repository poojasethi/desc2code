#include <cstdio>
#include <iostream>
#include <algorithm>
#include <set>
#include <vector>
 
using namespace std;
typedef pair<int,int> pii;
 
int in(){int r=0,c;for(c=getchar();c<=32;c=getchar());if(c=='-') return -in(); for(;c>32;r=(r<<1)+(r<<3)+c-'0',c=getchar());return r;}
#define MAXN 100100
int lim[MAXN],cnt[MAXN];
 
int main(){
  //~freopen("tin","r",stdin);
  int T=in();
  int i;
  for(int caso=1;caso<=T;caso++){
    int N=in();
    int tt,ss;
    vector<pii> aux;
    for(int i=0;i<N;i++){
      tt=in();
      ss=in();
      aux.push_back(pii(ss,tt));
    }
    sort(aux.begin(),aux.end());
    reverse(aux.begin(),aux.end());
    int lenT=1;
    lim[0]=aux[0].second;
    cnt[0]=1;
    
    for(int i=1;i<N;i++){
      int inf=0;
      int sup=lenT-1;
      int mid;
      while(inf<sup){
        mid=(inf+sup)/2;
        if(lim[mid]<aux[i].second){
          sup=mid;
        }else{
          inf=mid+1;
        }
      }
      
      if(aux[i].second<=lim[inf]){
        lim[lenT]=aux[i].second;
        cnt[lenT]=1;
        lenT++;
      }else{
        lim[inf]=aux[i].second;
        cnt[inf]++;
      }
      
    }
   
    printf("%d\n",lenT);
    for(int i=0;i<lenT;i++){
      if(i!=0) putchar(' ');
      printf("%d",cnt[i]);
    }
    puts("");
    
  }
  
} 
