//Author: Aman Choudhary
#include <vector>
#include <list>
#include <map>
#include <set>
#include <queue>
#include <deque>
#include <stack>
#include <cmath>
#include <algorithm>
#include <functional>
#include <numeric>
#include <utility>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <cstring>
#include <climits>
#include <map>
#include <cassert>
#define mod  1000000007
#define PHI 1000000006
#define ull unsigned long long
#define ill long long int
#define pii pair<int,int>
#define pb(x) push_back(x)
#define F(i,a,n) for(i=(a);i<(n);++i)
#define FD(i,a,n) for(i=(a);i>=(n);--i)
#define FE(it,x) for(it=x.begin();it!=x.end();++it)
#define V(x) vector<x>
#define S(x) scanf("%d",&x)
#define S1(x) scanf("%llu",&x)
#define dholu -9999999999999LL
using namespace std;
#define MX 100010
#define SI ({int x;scanf("%d",&x);x;})

pair<int,int> A[MX];
int cnt[MX], xlim[MX];

int main()
{

    int t;
    cin >> t;
    while (t--) {
        int n, k = 0;
        cin >> n;
        for(int i=0;i<n;i++) cin >> A[i].second >> A[i].first;
        sort(A,A+n);

		xlim[0] = (int)(1e9+5);
		for(int i=n-1;i>=0;i--){
            int x = A[i].second;
            if(k==0 || x <= xlim[k]){
                xlim[++k] = x;
                cnt[k] = 1;
                continue;
            }

            int lo = 0, hi = k;
            while(hi-lo>1) {
                int md = (lo+hi)/2;
                if(x>xlim[md]) hi = md;
                else lo = md;
            }
            xlim[hi] = x; cnt[hi]++;

		}
		printf("%d\n",k);
		for(int i=1;i<=k;i++) printf("%d ",cnt[i]);
        cout << endl;
	}
	return 0;
}
