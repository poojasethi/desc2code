#include <iostream>
#include <algorithm>
#include <cstdio>
#include <utility>
using namespace std;

int n,team,ans[100100],wMax[100100];
pair <int,int> a[100100];

int main()
{
	int test;
	cin >> test;
	while (test--)
	{
		cin >> n;
		for (int i=0;i<n;i++) scanf("%d%d",&a[i].first,&a[i].second);
		sort(a,a+n);
		wMax[team=0]=-(1<<30);
		for (int i=n-1;i>=0;i--)
			if (-a[i].second>=wMax[team]) wMax[++team]=-a[i].second, ans[team]=1;
			else
			{
				int which=upper_bound(wMax+1,wMax+team+1,-a[i].second)-wMax;
				wMax[which]=-a[i].second; ans[which]++;
			}
		cout << team << endl;
		for (int i=1;i<=team;i++) printf("%d ",ans[i]);
		cout << endl;
	}
}
