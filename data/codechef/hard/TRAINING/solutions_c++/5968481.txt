#include<iostream>
#include<cstdio>
#include<algorithm>
#include<vector>
#define ll long long int
using namespace std;
int A[100100],B[100100];
pair<ll,ll>V[100100];
/*bool comp(pair<ll,ll> a,pair<ll,ll> b)
{                   if(a.second<=b.second)
                 {
                     if(a.second==b.second&&a.first>b.first)
                        return false;
                    else
                     return true;
                 }
                 else
                 {
                   if(a.first>b.first)
                    return false;
                   else
                    return true;
                 }
}*/
ll in(){
    ll r=0,c;for(c=getchar();
c<=32;c=getchar());
if(c=='-')
    return -in();
for(;c>32;r=(r<<1)+(r<<3)+c-'0',c=getchar());return r;}
 int main()
 {

     int t;
     int n,a,b,i,j,k;
     t=in();
     while(t>0)
     {
         t--;
         k=0;
         for(i=0;i<100010;i++)
            {A[i]=B[i]=0;}
         //scanf("%lld",&n);
         n=in();;
         B[0]=1000000000;
        for(i=1;i<=n;i++)
         {
             //scanf("%lld %lld",&a,&b);
             a=in();
             b=in();
             V[i]=make_pair(a,b);
         }
         sort(V+1,V+n+1);
          ll nt=0,x,y;
        for(i=n;i;i--)
            {
                ll wt=V[i].second;
            x=0;y=nt;
            while(x<=y){
                ll mid = (x+y)>>1;
                if(B[mid]>=wt)x=mid+1;
                else y=mid-1;
            }
            A[x]++;B[x]=wt;nt=max(nt,x);
        }
        printf("%lld\n",nt);
        for(i=1;i<nt+1;i++)
            printf("%lld ",A[i]);
        printf("\n");
    }
    return 0;
 }
