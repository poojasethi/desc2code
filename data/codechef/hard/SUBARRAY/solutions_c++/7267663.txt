/* Template V1.0 | Author: warlock_ankur */
#include <bits/stdc++.h>
using namespace std;
 
typedef	long long ll;
#define PUT(ST, x) (ST |= 1 << x)		// Put x into Set ST
#define DEL(ST, x) (ST &= ~(1 << x))	// Remove x from Set ST
#define rep(i,n) for(int i = 0; i < n; i++)
#define Rep(i,a,b) for(int i = a; i < b; i++)
#define all(a) a.begin(),a.end()
#define MAXN 100005
 
char str[MAXN];
int v[MAXN], hbp[MAXN];
ll dp[MAXN], sum[MAXN];
 
inline void inp(int &n) {
	n = 0;
	int ch = getchar_unlocked();
	int sign = 1;
	while (ch < '0' || ch > '9') {
		if (ch == '-') sign = -1;
		ch = getchar_unlocked();
	}
	while (ch >= '0' && ch <= '9')
		n = (n << 3) + (n << 1) + ch - '0', ch = getchar_unlocked();
	n = n*sign;
}
 
int main()
{
int t;
	scanf("%d", &t);
	while (t--) {
		int n;
		scanf("%d", &n);
 
		scanf("%s", str);
 
		rep(i, n) {
			scanf("%d", &v[i]);
			sum[i] = v[i] + ((i == 0) ? 0 : sum[i - 1]);
		}
 
		stack<int> st;
		st.push(0);int k,j;
 char ch[8]={'(','{','<','[',')','}','>',']'};
		Rep(i, 1, n) {
			for( j=0;j<4;j++)
   	if(str[i]==ch[j+4])
    {
	   if(!st.empty() && str[st.top()]==ch[j])
	   {
	    k=st.top();
	    st.pop();
      dp[i]=max(0LL,dp[k-1]+sum[i]-sum[k-1]);
	   }
	   else
	    st.push(i),dp[i]=0;
	   break;
    }
   if(j==4)
	  st.push(i),dp[i]=0;
		}
 
		ll ans = 0;
		rep(i, n)
			ans = max(ans, dp[i]);
 
		printf("%lld\n", ans);
	}
 
	return 0;
}