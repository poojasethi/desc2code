#include <iostream>
#include <cstdio>
#include <cstring>
#include <string>
#include <algorithm>
#include <bitset>
#include <map>

#define REP(a,b) for (int a = 0; a < b; a++)
#define FOR(a,b,c) for (int a = b; a <= c; a++)
#define RESET(a,b) memset(a,b,sizeof a)

#define PII pair<int,int>
#define MP make_pair
#define LL long long

#define F first
#define S second

#define MAXP 1000001
using namespace std;

LL fak[100002];
int jum[100002];
int nf;
int nq,jq;
LL n,k,dop;

int main(){
	scanf("%lld%d", &n, &nq);
	
	dop = n;
	nf = 0;
	FOR(i,2,MAXP-1){
		if (n % i == 0){
			fak[nf] = i;
			jum[nf] = 0;
			while (n % i == 0){
				jum[nf]++;
				n /= i;
			}
			nf++;
		}
	}
	if (n > 1){
		fak[nf] = n;
		jum[nf] = 1;
		nf++;
	}
	
	LL all = 1;
	REP(i,nf){
		all *= (LL)(1 + jum[i]);
	}
	
	REP(qq,nq){
		scanf("%d%lld", &jq, &k);
		
		LL ans = 1;
		if (jq == 1){
			REP(i,nf){
				int val = 0;
				while (k % fak[i] == 0){
					val++;
					k /= fak[i];
				}
				
				ans *= (LL)(1 + min(jum[i], val));
			}
		}else{
			ans = 0;
			if (dop % k == 0){
				ans = 1;
				REP(i,nf){
					int val = 0;
					while (k % fak[i] == 0){
						val++;
						k /= fak[i];
					}
			
					ans *= (LL)(1 + jum[i] - val);
				}
			}
			
			if (jq == 3){
				ans = all - ans;
			}
		}
		
		printf("%lld\n", ans);
	}
}	
