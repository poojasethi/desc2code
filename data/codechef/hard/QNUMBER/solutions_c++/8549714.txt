#include <bits/stdc++.h>
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define mp make_pair
#define f first
#define s second
#define N 1005
#define NN 10000000
#define ln 1e10+1
#define ll long long
#define oo 1000000007
#define ln 1e9
#define pii pair < pair <int, int>, int >
#define pi pair < int, pair <int, int> >
#define Pa pair < ll ,int >

using namespace std;

vector <Pa> S;
int Total = 1, q, type;

int Get1(ll k)
{
    int ans = 1;
    for(int i=0; i<S.size(); i++)
    {
        int cnt = 0;
        while(k % S[i].f == 0)  k /= S[i].f, cnt++;
        ans *= (min(cnt, S[i].s) + 1);
    }
    return ans;
}

int Get2(ll k)
{
    int ans = 1;
    for(int i=0; i<S.size(); i++)
    {
        int cnt = 0;
        while(k % S[i].f == 0)  k /= S[i].f, cnt++;
        if(cnt > S[i].s)    return 0;
        ans *= (S[i].s - cnt + 1);
    }
    if(k != 1)  return 0;
    return ans;
}

int main()
{
    //filein("inp.txt");  fileout("out.txt");
    ll k, n;
    cin >> n;
    for(int i=2; i<=sqrt(n); i++)
        if(n % i == 0)
        {
            int cnt = 0;
            while(n % i == 0)   n/=i, cnt++;
            S.push_back(mp(i, cnt));
            Total *= (cnt + 1);
        }
    if(n > 1)   S.push_back(mp(n, 1)), Total *= 2;
    cin >> q;
    while(q--)
    {
        scanf("%d%lld", &type, &k);
        if(type == 1)
            printf("%d\n", Get1(k));
        if(type == 2)
            printf("%d\n", Get2(k));
        if(type == 3)
            printf("%d\n", Total - Get2(k));
    }
}
