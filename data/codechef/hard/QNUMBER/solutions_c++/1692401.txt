#include <cstdio>

#define min(a, b) (a<b? a:b)

using namespace std;

typedef long long LL;

int main()
{
    LL N;
    int Q;
    scanf("%lld %d", &N, &Q);

    int A[20], numFactorsN = 1, len = 0;
    LL P[20];

    if((N&1)==0) {
        int cnt = 0;
        while((N&1)==0) {
            cnt++;
            N>>=1;
        }
        P[len] = 2;
        A[len++] = cnt;
        numFactorsN = numFactorsN * (cnt+1);
    }

    for(int i=3; 1ll*i*i<=N; i+=2) if(N%i==0) {
        int cnt=0;
        while(N%i==0) {
            cnt++;
            N/=i;
        }
        P[len] = i;
        A[len++] = cnt;
        numFactorsN = numFactorsN * (cnt+1);
    }

    if(N>1) {
        P[len] = N;
        A[len++] = 1;
        numFactorsN <<=1;
    }

    while(Q--) {
        int T, T1, T2;
        LL K;
        scanf("%d %lld", &T, &K);

        T1 = T2 = 1;
        for(int i=0; i<len ; i++) {
            int cnt=0;
            while(K%P[i]==0) {
                K/=P[i];
                cnt++;
            }
            T1 = T1 * (min(cnt,A[i]) + 1);
            T2 = T2 * (A[i]-cnt+1);
            if(cnt>A[i]) T2 = 0;
            if(T2==0 && T!=1) break;
        }

        if(K>1) T2=0;

        if(T==1) printf("%d\n", T1);
        if(T==2) printf("%d\n", T2);
        if(T==3) printf("%d\n", numFactorsN - T2);
    }
}
