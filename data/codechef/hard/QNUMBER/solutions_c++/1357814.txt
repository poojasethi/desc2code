    #include <cstdio>
    #include <fstream>
    #include <iostream>
    #define lim 1000000
    #define MAXN 50
    using namespace std;
    typedef long long i64;
    i64 p[MAXN+1];
    int q[MAXN+1],q2[MAXN+1],sz=0;
     
     
     
     
    int min(int a,int b){
    return (a<b)?a:b;
    }
     
    int main()
    {
    i64 N,K,tn;
    int T,Q;
     
    scanf("%lld%d",&N,&Q);
     
    i64 LM=lim; LM*=lim;
     
     
    tn=N;
     
    for(int i=2;i<=lim;i++)
    if(N%i==0){
    p[sz]=i;
    while(N%i==0){N/=i;q[sz]++;}
    sz++;
    }
     
    if(N>1){p[sz]=N; q[sz]=1; sz++;}
    N=tn;
     
     
    while(Q--){
    scanf("%d%lld",&T,&K);
     
     
    int ans=1;
     
    if(T==1){
    for(int i=0;i<sz;i++){
    while(K%p[i]==0){K/=p[i];q2[i]++;}
    ans*=min(q[i],q2[i])+1;
    }
    }
    else if(T==2){
    if(N%K)ans=0;
    else{
    for(int i=0;i<sz;i++){
    while(K%p[i]==0){K/=p[i];q2[i]++;}
    ans*=(q[i]-q2[i]+1);
    }
    }
    }
    else{
    int mod = 1;
    if(N%K)ans=0;
    else{
    for(int i=0;i<sz;i++){
    while(K%p[i]==0){K/=p[i];q2[i]++;}
    ans*=(q[i]-q2[i]+1);
    }
    }
    for(int i=0;i<sz;i++)mod*=(q[i]+1);
    ans = mod - ans;
    }
     
    for(int i=0;i<sz;i++)q2[i]=0;
     
    printf("%d\n",ans);
     
    }
     
    return 0;
    } 