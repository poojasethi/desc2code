#include<iostream>
#include<string.h>
using namespace std;
typedef long long int int64;
int64 a[1000006],pr[100000];
int main()
{
    memset(a,0,sizeof(a));
    int64 i,j,n,p=0,q=0,res=1,q1,t,k,n1;
    for(i=2;i<=10001;i++)
    {
         if(a[i]==0)
         {
         for(j=i+i;j<=1000004;j=j+i)
         {
                             
                 a[j]=1;
         }  
         }
         
    }
    for(i=2;i<=1000004;i++)
    if(a[i]==0)pr[p++]=i;
    int x=0;
    int64 v[1000][2];
  
    scanf("%lld%lld",&n,&q1);
    n1=n;
    while(n!=1)
    {
               if(n%pr[q]==0)
               {
               int c=0;
               while(n%pr[q]==0)
               {
                       c++;
                       n=n/pr[q];         
               }
               v[x][0]=pr[q];
               v[x][1]=c;
               x++;
               res*=(c+1);
               }
               q++;
               if(q==p)
               break;
               
    }
    if(n>1)
    {
           v[x][0]=n;
           v[x][1]=1;
           x++;
           res*=2;
           
    }
   // for(int i=0;i<x;i++)
  //  cout<<v[i][0]<<" "<<v[i][1]<<endl;
    while(q1--)
    {
              
              scanf("%lld%lld",&t,&k);
              int64 restu = 1;
              if(t==1)
              {
                      for(i=0;i<x;i++)
                      {
                                      
                       int64 prim = v[i][0];
                       int64 cnt1 = v[i][1];
                       int64 cnt2 = 0;
                       while(k%prim==0 && cnt2<cnt1)
                       {
                       cnt2++;
                       k/=prim;
                       }
                       restu*=(cnt2+1);
                       if(k==1)break;
                       }
                       printf("%lld\n",restu);
                      
                      
              }
              else if(t==2||t==3)
              {
                            
                            if(n1%k==0)
                            {
                                     // cout<<"hello"<<endl;
                                      int64 r=n1/k;
                                      for(i=0;i<x;i++)
                                      {
                                      
                                      int64 prim = v[i][0];
                                      int64 cnt1 = v[i][1];
                                      int64 cnt2 = 0;
                                      while(r%prim==0 && cnt2<cnt1)
                                      {
                                      cnt2++;
                                      r/=prim;
                                      }
                                      restu*=(cnt2+1);
                                      if(r==1)
                                      break;
                                      }
                                      
                                      if(t==2)
                                      printf("%lld\n",restu);
                                      else if(t==3)
                                      printf("%lld\n",res-restu);
                                      
                            }
                            else if(t==2)
                            printf("0\n");
                            else if(t==3)
                            printf("%lld\n",res);       
              }
                                      
                            
              
              
    }
   // system("pause");
    return 0;
}
