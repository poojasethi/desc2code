#include <bits/stdc++.h>
#define rep(x,n) for(int x=0;x<int(n);++x)
#define print(x) cout << x << endl
#define dbg(x) cerr << #x << " == " << x << endl
#define _ << " , " <<
#define mp make_pair
#define x first
#define y second
using namespace std;

template<class T> void pv(T a, T b) { for (T i = a; i != b; ++i) cout << *i << " "; cout << endl; }

typedef long long ll;
typedef pair<int,int> pii;

const int mod = 1e9 + 7, maxn = 2e5 + 10;
ll f[maxn];

ll fpow(ll x, int e) {
  if(e == 0) return 1;
  ll r = fpow(x * x % mod, e >> 1);
  if(e&1) r = r * x % mod;
  return r;
}

int main() {
  if(true) cin.sync_with_stdio(false);
  int T;
  for(cin>>T;T;T--){
    int K;
    cin>>K;
    vector<int> A(K), B(K);
    rep(i,K) cin>>A[i]>>B[i];
    ll P = 0, Q = 1;
    rep(i,K) Q = Q * (B[i]-A[i]+1) % mod;
    for(int g=200000;g>=1;g--) {
      f[g] = 1;
      rep(i,K) {
        int a=(A[i]+g-1)/g, b=B[i]/g;
        if(a>b) f[g] = 0; else f[g] = f[g] * (b-a+1) % mod;
      }
      for(int gg=g+g;gg<=200000;gg+=g) {
        f[g] -= f[gg];
        if(f[g] < 0) f[g] += mod;
      }
      P += f[g] * g % mod;
    }
    printf("%lld\n", (mod - P % mod) * fpow(Q,mod - 2) % mod);
  }
  return 0;
}

