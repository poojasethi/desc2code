#include <bits/stdc++.h>
using namespace std;
#define N 200000
typedef long long ll;
ll a[5],b[5],ways[N + 1];
int phi[N + 1];
int sie[N + 1];
ll FastPower(ll a,ll p,ll mod)
{
    ll y = 1;
    while(p > 0)
    {
        if(p%2 == 1) y = (y*a)%mod;
        p = p/2;
        a = (a*a)%mod;
    }
    return y;
}
void PreCompute()
{
    for(int i = 1 ; i<=N ; i++) phi[i] = i;
    sie[1] = 1;
    sie[0] = 1;
    for(int i = 2 ; i<=N ; i++)
    {
        if(sie[i] == 0)
        {
            phi[i] = i - 1;
            for(int j = 2*i ; j<=N ; j+=i)
            {
                sie[j] = 1;
                phi[j] = phi[j]/i;
                phi[j] = phi[j]*(i-1);
            }
        }
    }
    //for(int i = 1 ; i<=50 ; i++) printf("%d\n",phi[i]);
}
int main()
{
    PreCompute();
    int tc,t;
    scanf("%d",&tc);
    for(t = 1 ; t<=tc ; t++)
    {
        int k,i;
        scanf("%d",&k);
        ll Q = 1;
        ll mod = pow(10,9) + 7;
        ll pw = pow(10,9) + 5;
        ll MN = pw;
        //printf("%lld %lld\n",pw,mod);
        for(i = 0 ; i<k ; i++)
        {
            scanf("%lld %lld",&a[i],&b[i]);
            ll temp = b[i] - a[i] + 1;
            Q = Q*temp%mod;
            MN = min(MN,b[i]);
        }
        ll invQ = FastPower(Q,pw,mod);
        ll p = 0;
        int mn = (int)MN;
        for(int i = 1 ; i<=N ; i++)
        {
            ll temp = (ll) phi[i];
            ll I = (ll) i;
            for(int j = 0 ; j<k ; j++)
            {
                ll u = b[j]/I;
                ll v = (a[j] - 1)/I;
                ll w = u - v;
                temp = temp*w%mod;
            }
            p = p + temp;
            if(p >= mod) p = p - mod;
        }
        ll ans = mod - p*invQ%mod;
        if(ans >= mod) ans = ans - mod;
        printf("%lld\n",ans);
        //printf("%lld %lld %lld %lld\n",invQ,Q,p,ans);
    }
    return 0;
}
