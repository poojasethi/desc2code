/*===============*\
|  ID: TMANDZU    |
|    LANG: C++    |
\*===============*/
//Tornike Mandzulashvili
//#pragma comment(linker,"/STACK:256000000")
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <algorithm>
#include <stack>
#include <math.h>
#include <vector>
#include <string>
#include <map>
#include <queue>
#include <iostream>
#include <set>

#define Pi 3.14159265
#define hash1 1000003
#define hash2 1000033
#define md 1000000007
#define INF 1000000000
#define mp make_pair
#define pb push_back
#define S size()
#define max(aa,bb) (aa>bb?aa:bb)
#define min(aa,bb) (aa<bb?aa:bb)
#define fi first
#define se second
#define PI pair < int,int >

using namespace std;

const int MAXN=200005;
int phi[MAXN+10];
int i,j,k,maxn,t;
int a[10],b[10];
long long PP,P,Q,N;

void solve()
{
    P=0;
    for (i=1;i<=maxn;i++){
    PP=1;    
    for (j=0;j<k;j++)
    PP=PP*(b[j]/i-(a[j]-1)/i)%md;
    P=(P+(phi[i]*PP%md))%md;
   }
}

long long go(long long A,long long num)
{
    if (num==0) return 1;
    long long H=go(A,num/2);
    if (num%2) return (H*H%md)*A%md;
    return H*H%md;
}

main()
{
 //   freopen("text.in","r",stdin);freopen("text.out","w",stdout);

    phi[1]=1;
    for (i=2;i<=MAXN;i++)
    if (phi[i]==0)
    {
        phi[i]=i-1;
        if ((long long)i*i<=MAXN)
        for (j=i*i;j<=MAXN;j+=i)
        phi[j]=i;
    }else
    {
        j=i/phi[i];
        if (j%phi[i]==0) phi[i]=phi[j]*phi[i];else phi[i]=phi[j]*(phi[i]-1);
    }

    scanf("%d",&t);
    while (t--)
    {
        Q=1;
        maxn=0;
        scanf("%d",&k);
        for (i=0;i<k;i++){
        scanf("%d %d",&a[i],&b[i]);
        maxn=max(maxn,b[i]);
        }
        solve();
        for (i=0;i<k;i++)
        Q=Q*(b[i]-a[i]+1)%md;
  //      cout<<P<<" "<<Q<<endl;
        N=(md-P)*go(Q,md-2)%md;
        printf("%lld\n",N);
    }
}
