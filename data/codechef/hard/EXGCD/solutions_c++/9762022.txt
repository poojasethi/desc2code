#include <bits/stdc++.h>
#define ll long long int
#define s(a) scanf("%lld",&a)
#define f first
#define sc second
#define pb push_back
#define mp make_pair
#define VALUETYPE long long int
#define inf 10e16
#define EVEN(x) ((x%2)==0)
#define ODD(x) ((x%2)==1)

using namespace std;

ll a[211111];
ll mod=1000000007;

ll power(ll a,ll b)
{
    if(b==0) return 1;
    if(b==1) return a;
    ll k = power(a,b/2);
    if(b%2==0) return (k*k)%mod;
    return (((k*k)%mod)*a)%mod;
}

int main()
{
    ll t,n,i,j,k,l,w,ww,x[10],y[10],z;
    s(t);
    while(t--) {
        s(k);
        ll p=0;
        ll q=1;
        for(i=1;i<=k;i++) {
            s(x[i]);s(y[i]);
            q = q*(y[i]-x[i]+1);
            q%=mod;
        }
        for(i=200000;i>=1;i--) {
            w = 1;
            for(j=1;j<=k;j++) {
                w = w*((y[j]/i)-((x[j]-1)/i));
                w%=mod;
            }
            for(j=i+i;j<=200000;j+=i) {
                w = w-a[j];
                if(w<0) w+=mod;
            }
            a[i]=w;
        }
        for(i=1;i<=200000;i++) {
            p = p+i*a[i];
            a[i]=0;
            p%=mod;
        }
        q = power(q,mod-2);
        p=p*q;
        p%=mod;
        p=p*(-1);
        p+=mod;
        p%=mod;
        cout<<p<<endl;
    }
    return 0;
}
