#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;

#define MAXN 200005
#define MOD 1000000007

int phi[MAXN + 1],factor[MAXN + 1];

long long mod_pow(long long a, int b){
    long long ret = 1;
    
    while(b){
        if(b & 1) ret = ret * a % MOD;
        a = a * a % MOD;
        b >>= 1;
    }
    
    return ret;
}

int main(){
    memset(factor,-1,sizeof factor);
    phi[1] = 1;
    
    for(int i = 2;i <= MAXN;++i){
        if(factor[i] == -1){
            phi[i] = i - 1;
            
            if(i <= MAXN / i)
                for(int j = i*i;j <= MAXN;j += i)
                    factor[j] = i;
        }else{
            int aux = i,p = factor[i];
            phi[i] = 1;
            
            while(aux % p == 0){
                aux /= p;
                phi[i] *= p;
            }
            
            phi[i] -= phi[i] / p;
            phi[i] *= phi[aux];
        }
    }
    
    int T,K;
    int A[5],B[5];
    
    scanf("%d",&T);
    
    while(T--){
        scanf("%d",&K);
        
        for(int i = 0;i < K;++i) scanf("%d %d",&A[i],&B[i]);
        
        long long P = 0,Q = 1;
        
        for(int i = 0;i < K;++i)
            Q = Q * (B[i] - A[i] + 1) % MOD;
        
        for(int d = 1;d <= 200000;++d){
            long long aux = phi[d];
            
            for(int i = 0;i < K;++i)
                aux = aux * (B[i] / d - (A[i] - 1) / d) % MOD;
            
            P += aux;
            if(aux >= MOD) aux -= MOD;
        }
        
        P %= MOD;
        Q %= MOD;
        if(P < 0) P += MOD;
        if(Q < 0) Q += MOD;
        
        if(Q == 0){
            if(P != 0) printf("-1\n");
            else printf("0\n");
        }else{
            long long ans = (-P) * mod_pow(Q,MOD - 2) % MOD;
            if(ans < 0) ans += MOD;
            printf("%lld\n",ans);
        }
    }
    
    return 0;
}