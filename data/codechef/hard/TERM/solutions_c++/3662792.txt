#include <iostream>
 
#define MOD 1000003LL
 
using namespace std;
 
long long inv[105];
long long k;
int cnt;
long long b[10000], a[105], c[105];
 
long long Pow(long long k, long long p){
	if (p == 0LL) return 1LL;
	if (p == 1LL) return k % MOD;
	long long tmp = Pow(k, p / 2);
	tmp = tmp * tmp % MOD;
	if (p % 2) tmp = tmp * (k % MOD) % MOD;
	return tmp;
}
 
long long calc(long long p){
	long long rlt = 1LL;
	int i;
	for (i = 1; i <= p; i++){
		rlt = rlt * ((p + k - i) % MOD) % MOD;
		rlt = rlt * inv[i] % MOD;
	}
	return rlt;
}
 
int main() {
	
	int T;
	long long n, p, rlt, tmp;
	int i;
	
	for (i = 1; i <= 100; i++)
		inv[i] = Pow(i, MOD - 2);	
	for (scanf("%d", &T); T--; ){
		cin >> n >> k >> p;
		rlt = 1LL;
		cnt = 0;
		while (n){
			b[cnt++] = n % p;
			n /= p;
		}
		b[cnt++] = 0;
		for (i = 0; i <= p; i++)
			a[i] = calc(i);
		c[0] = a[0];
		for (i = 1; i <= p; i++)
			c[i] = (c[i - 1] + a[i]) % MOD;
		for (i = 0; i < cnt; i++){
			if (b[i] > 0) tmp = Pow(c[p - 1], i) * c[b[i] - 1] % MOD;
			else tmp = 0LL;
			rlt = rlt * a[b[i]] % MOD;
			rlt = (rlt + tmp) % MOD;
		}
		cout << rlt << endl;
	}
	return 0;
}