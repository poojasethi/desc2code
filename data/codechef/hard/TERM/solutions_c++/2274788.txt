#include <stdio.h>
 
#define M 1000003
#define LL long long
 
int x[100];
 
int A(int a, int b){a+=b;return a>=M?a-M:a;}
int B(int a, int b){return (LL)a*b%M;}
 
int C(int b)
{
int a=M, y=1, yy=0, q, tmp, aa=a;
for(;b>1; q=a/b,tmp=a%b,a=b,b=tmp,tmp=y,y=yy-q*y,yy=tmp);
return y>0?y:aa+y;
}
 
main()
{
int fall, i, p, res, q;
int v[100], w[100];
long long n, k;
for(i=0; ++i<100; x[i]=C(i));
for(scanf("%d",&fall); fall--&&scanf("%lld %lld %d",&n,&k,&p); printf("%d\n",res))
	{
	for(n+=v[0]=!(i=w[0]=0); ++i<=p; w[i]=w[i-1]+v[i-1],v[i]=B(v[i-1], B((i+k-1)%M, x[i])));
	for(res=!(q=1); n; res=B(res,v[n%p]),res=A(res,B(q,w[n%p])),q=B(q,w[p]),n/=p);
	}
return 0;
}