#include<cmath>
#include<cstring>
#include<iostream>
#include<vector>
#include<queue>
#include<stack>
#include<map>
#include<set>
#define mp make_pair
#define pb push_back
#define MAX(a,b) (a>b?a:b)
#define MIN(a,b) (a<b?a:b)
#define F first
#define S second
#define ll long long
#define pp pair<int,int>
#define INF 2000000000
using namespace std;
const int n_max=1000005;
int n,i,j,d[n_max],l,r,a[n_max],dp[n_max][4];
int sum[n_max],x;
char s[n_max];
ll ans;

main()
{scanf("%s",&s);
 n=strlen(s);
 for(i=0;i<n;i++){
      a[i]=(int)s[i]-'0';
      a[i]%=3;
      sum[i]=(sum[i-1]+a[i])%3;
 }

 if(s[0]!='0') dp[0][a[0]]=1;
 for(i=1;i<n;i++){
     for(j=0;j<3;j++)dp[i][(j+a[i])%3]+=dp[i-1][j];
     if(s[i]!='0') dp[i][a[i]]++;
   //  cout<<dp[i][0]<<' '<<dp[i][1]<<' '<<dp[i][2]<<endl;
    }
 //system("pause");
 r=-1;
 for(i=0;i<n;i++){
      if(i<=r)d[i]=MIN(r-i+1,d[l+r-i]);
      while(i-d[i]>=0 && i+d[i]<n && s[i-d[i]]==s[i+d[i]])d[i]++;
      if(i+d[i]-1>r)r=i+d[i]-1,l=i-d[i]+1;
 }

 for(i=0;i<n;i++){
      if(a[i]==0)ans++;
      if(i==0)continue;
      x=a[i];
      ans+=dp[i-1][x];
      l=i-d[i];
     // cout<<ans<<' '<<i<<' '<<x<<' '<<dp[i-1][x]<<endl;
      if(l>=0)
      for(j=0;j<3;j++)
            if((j+sum[i-1]-sum[l]+3)%3==x)ans-=dp[l][j];
      //cout<<i<<' '<<d[i]<<' '<<ans<<' '<<l<<' '<<dp[i-1][x]<<endl;

      //system("pause");
 }
 //cout<<ans<<endl;
 r=-1;
 for(i=0;i<n;i++){
      if(i<r)d[i]=MIN(r-i,d[l+r-i-1]);else d[i]=0;
      while(i-d[i]>=0 && i+d[i]+1<n && s[i-d[i]]==s[i+d[i]+1])d[i]++;
      if(i+d[i]>r)r=i+d[i],l=i-d[i]+1;
 }

 for(i=0;i<n;i++){
      x=0;
      ans+=dp[i][x];
      l=i-d[i];
      if(l>=0)
      for(j=0;j<3;j++)
            if((j+sum[i]-sum[l]+3)%3==x)ans-=dp[l][j];
    //  cout<<i<<' '<<ans<<' '<<d[i]<<' '<<l<<endl;
     // system("pause");
 }

 cout<<ans<<endl;
}
