#include<cstdio>
#include<cstring>
#include<algorithm>
#define N 1000001
#define LL long long
using namespace std;

char s[N];
int tr[2*N+1], r[2*N+1], sm[2*N+1], mod[2*N+1][3];

int main()
{
	scanf("%s", s);
	int n = strlen(s); 	
	for(int i=0;i<n;++i)
		tr[2*i] = 0, tr[2*i+1] = s[i]-'0';
	tr[2*n] = 0;

	int ce = 0; 
	for(int i=1;i<=2*n;++i)
	{
		if( i<=ce+r[ce] )
		{
			int mr = ce+r[ce]-i;
			r[i] = min(mr, r[ce-r[ce]+mr]);
		}
		while(++r[i], 0<=i-r[i] && i+r[i]<=2*n && tr[i+r[i]]==tr[i-r[i]]);
		--r[i];
		if(i+r[i] > ce+r[ce]) ce = i;
	}
	
	for(int i=1;i<=2*n;++i)
	{
		sm[i] += sm[i-1]+tr[i];
		sm[i] %=3;
		if(tr[i]) ++mod[i][sm[i]];
		for(int j=0;j<3;++j)
			mod[i][j] += mod[i-1][j];
	}

	LL ans = 0; 
	for(int i=1;i<=2*n;++i)
	{
		if(i%2) ans += tr[i]%3 == 0;
		int nd = (sm[i]+ (2*(3-tr[i]%3))%3)%3;
		ans += mod[i+r[i]][nd]-mod[i][nd];
	}
	printf("%lld\n", ans);
	return 0;
}
