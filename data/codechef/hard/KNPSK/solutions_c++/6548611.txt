#include<iostream>
#include<cstdio>
#include<utility>
#include<cstring>
#include<algorithm>
#include<cmath>
#include<vector>
#include<climits>
#include<queue>
#include<set>
using namespace std;
#define sd(x)           scanf("%d",&x)
#define sld(x)          scanf("%lld",&x)
#define ll              long long
#define mod             1000000007
#define mp              make_pair
#define FF              first
#define SS              second
#define xx              first
#define yy              second.first
#define zz              second.second
#define pb              push_back
#ifndef ONLINE_JUDGE
#define gc getchar
#else
#define gc getchar_unlocked
#endif
ll a[100010];
ll b[100010];
pair<ll,pair<ll,ll> >c[200010];
int main()
{
int n;
sd(n);
int k=0;
int s1=0,s2=0;
for(int i=0;i<n;i++)
{
    int w,c;
    sd(w);
    sd(c);
    if(w==1)
        a[s1++]=c;
    else
        b[s2++]=c;
}
sort(a,a+s1,greater<int>());
sort(b,b+s2,greater<int>());
c[0]=mp(0,mp(-1,-1));
if(s1)
{
    c[1]=mp(a[0],mp(0,-1));
}
else
{
   c[1]=mp(0,mp(-1,-1));
}
for(int i=2;i<=(s1+2*s2);i++)
{
if((c[i-2].zz<s2-1)&&(c[i-1].yy<s1-1))
{
if(c[i-2].xx+b[c[i-2].zz+1]>c[i-1].xx+a[c[i-1].yy+1])
{
    c[i]=mp(c[i-2].xx+b[c[i-2].zz+1],mp(c[i-2].yy,c[i-2].zz+1));
}
else
{
    c[i]=mp(c[i-1].xx+a[c[i-1].yy+1],mp(c[i-1].yy+1,c[i-1].zz));
}
}
else if(c[i-1].yy<s1-1)
{
    c[i]=mp(c[i-1].xx+a[c[i-1].yy+1],mp(c[i-1].yy+1,c[i-1].zz));
}
else
{
    c[i]=mp(c[i-2].xx+b[c[i-2].zz+1],mp(c[i-2].yy,c[i-2].zz+1));
}
if(c[i].xx<c[i-1].xx)
{
  c[i]=c[i-1];
}
//cout<<c[i].xx<<" "<<c[i].yy<<" "<<c[i].zz<<endl;
}
for(int i=1;i<=s1+2*s2;i++)
   cout<<c[i].xx<<" ";
return 0;
}



