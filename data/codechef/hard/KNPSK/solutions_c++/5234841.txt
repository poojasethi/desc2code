#include <bits/stdc++.h>
#define ll long long
using namespace std;
int compare(const void* a, const void* b)
{
	return (*(ll*)a - *(ll*)b);
}

int main()
{
	int n;
	scanf("%d", &n);
	ll arr1[n+2], arr2[n+2];
	ll one=0, two=0;
	for(int i=0; i<n; i++)
	{
		ll temp;
		scanf("%lld", &temp);
		if(temp==2)
		{
			scanf("%lld", &arr2[two]);
			two++;

		}
		else
		{
			scanf("%lld", &arr1[one]);
			one++;
		}
		
	}
	arr1[one++]=0;
	arr2[two++]=0;
	sort(arr1, arr1+one);
	sort(arr2, arr2+two);
	int i;
	
	ll sum=0;
	sum = one + 2*two-3;
	
	one--;
	two--;

	ll sumEv=0;
	bool f=1, k=0;
	for(i=1; i<=sum; i++)
	{
		if(i%2 && f)
		{
			if(k)
			{
				if(sumEv-arr1[one+1]+arr2[two]>=(one>=0?sumEv+arr1[one]:sumEv))
				{
					sumEv = sumEv-arr1[one+1]+arr2[two];
					one++;
					two--;
					printf("%lld ", sumEv);
					sum--;
					i--;
				}
				else
				printf("%lld ", sumEv+arr1[one]);
			}
			else if(one>=0)
			printf("%lld ", sumEv+arr1[one]);
		}
		else
		{
			if(two>=0 && one>=1)
			{
				if(arr2[two]>=arr1[one]+arr1[one-1])
				{
					sumEv+=arr2[two];
					f=1;
					k=0;
					two--;
				}	
				else
				{
					sumEv+=arr1[one]+arr1[one-1];
					f=1;
					k=1;
					one-=2;
				}
			}
			else if(two>=0 && one>=0)
			{
				if(arr2[two]>=arr1[one])
				{
					sumEv+=arr2[two];
					f=1;
					k=0;
					two--;
				}	
				else
				{
					sumEv+=arr1[one];
					f=0;
					k=0;
					one--;
				}
			}
			else if(two>=0)
			{
				sumEv+=arr2[two];
				f=1;
				k=0;
					two--;
				
			}
			else if(one>=1)
			{
				sumEv+=arr1[one]+arr1[one-1];
				f=1;
				k=1;
				one-=2;
			}
			else if(one>=0)
			{
				sumEv+=arr1[one];
				f=0;
				k=0;
				one--;
			}


			printf("%lld ", sumEv);

		}

	}
	return 0;
}