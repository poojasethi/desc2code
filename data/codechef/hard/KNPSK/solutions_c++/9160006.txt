#include<bits/stdc++.h>
using namespace std;
bool cmp(pair < int , int > a , pair < int ,int > b)
{

    if(   a.second * b.first == a.first * b.second   )
        return a.first  < b.first;

    return (a.second*1.0)/a.first < (b.second*1.0)/b.first;

}

int main()
{

    ios::sync_with_stdio(0);
    cin.tie(0);
    int N , i , j ;
    cin>>N;

    vector < pair < int , int > > V(N);

    vector < int > cost(N,0);

    for(i=0;i<N;++i)
        cin>>V[i].first>>V[i].second;

    sort(V.begin(),V.end(),cmp);

    for(i=0;i<N;++i)
        cost[i]=V[i].first==1?V[i].second:(i!=0?cost[i-1]:0);


    long long cur_cost = 0 ;
    int last_1 = -1 ;

    for(i=N-1;i>=0;--i)
    {

        if( V[i].first==2 )
            cout<<max( cost[i] + cur_cost , last_1!=-1? cur_cost - last_1 + V[i].second : -11   )<<" ";

        V[i].first==1?last_1=V[i].second:1;

        cur_cost+=V[i].second;
        cout<<cur_cost<<" ";
    }


    return 0;
}
