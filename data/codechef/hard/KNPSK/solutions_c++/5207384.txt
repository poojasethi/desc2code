#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

int main()
{
	int n,w,c,p,q,r,s,t1,t2,W=0;
	long long int c1, c2, a0=0, a1=0, a;
	vector<int> one, two;

	cin >> n;

	for(int i=0; i<n; i++)
	{
		cin >> w >> c;

		W += w;

		if(w==1)
			one.push_back(c);
		else
			two.push_back(c);
	}

	sort(one.begin(), one.end());
	sort(two.begin(), two.end());

	p = r = one.size()-1;
	q = s = two.size()-1;

	if(p>=0)
	{
		a1 = one[p];
		r = p-1;	
	}

	cout << a1 << " ";

	for(int i=2; i<=W; i++)
	{
		c1 = a1;
		if(r >= 0)
			c1 += one[r];

		c2 = a0;
		if(q >= 0)
			c2 += two[q];

		if(c1>c2)
		{
			p=r, q=s;
			r=p-1, s=q;

			a=c1;
		}

		else
		{
			t1=r, t2=s;
			r=p, s=q-1;
			p=t1, q=t2;
			
			a=c2;
		}

		cout << a << " ";

		a0 = a1;
		a1 = a;
	}

	return 0;
}