#include <iostream>
#include <fstream>
#include <vector>
#include <algorithm>
using namespace std;
int N,W,C, ones[100000], twos[100000];
long long A[3*100000], Sum;
vector < int > one, two;

int main () {
	cin >> N;
	for(int i=1; i<=N; i++) {
		cin >> W >> C;
		Sum+=W;
		if(W == 1) one.push_back(C);
		else 	   two.push_back(C);
	}
	
	sort(one.begin(), one.end());
	sort(two.begin(), two.end());
	reverse(one.begin(), one.end());
	reverse(two.begin(), two.end());
	
	
	if(one.size() > 0) {
		A[1] = one[0];
		ones[1]++;
	} 
	cout << A[1] << " ";
	for(int i=2; i<=Sum; i++) {
		A[i] = A[i - 1];
		ones[i] = ones[i-1];
		twos[i] = twos[i-1];
		int cur = 0;
		if(ones[i-1] < one.size()) 
			A[i]+=one[ones[i-1]],cur = 1;
		if(twos[i-2] < two.size() && A[i] < A[i-2] + two[twos[i-2]]) {
			A[i] = A[i-2] + two[twos[i-2]];
			twos[i] = twos[i-2];
			ones[i] = ones[i-2];
			cur = 2; 
		}
		cur == 1 ? ones[i]++ : twos[i]++;
		cout << A[i] << " ";
	}
    return 0;
}
