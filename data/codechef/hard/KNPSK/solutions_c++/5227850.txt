#include<cstdio>
#include<iostream>
#include<vector>
#include<algorithm>

using namespace std;

#define fr first
#define se second

typedef long long ll;
int main()
{
	int n;
	scanf("%d",&n);
	int w;
	ll c;
	vector<ll> w1,w2,w3;

	int tot=0;

	w1.push_back(0);
	w2.push_back(0);
	w1.push_back(0);
	w1.push_back(0);

	for(int i=0;i<n;i++)
	{
		scanf("%d %lld",&w,&c);
		if(w==1)
		w1.push_back(c);
		else
		w2.push_back(c);
		tot = tot+w;
	}
	sort(w1.rbegin(),w1.rend());
	sort(w2.rbegin(),w2.rend());
	
	for(int i=1;i<w1.size();i++)
	w3.push_back(w1[i]);
	
	vector<pair<ll,pair<int,int> > > dpe,dpe1;
	vector<ll> dpo;
	pair<ll,pair<int,int> > p1;
	
	if(w1[0]+w1[1] > w2[0])
	{
		p1.first = w1[0]+w1[1];
		p1.second.first = 1;
		p1.second.second=-1;
		dpe.push_back(p1);			
	}
	else
	{
		p1.first = w2[0];
		p1.se.fr = -1;
		p1.se.se = 0;
		dpe.push_back(p1);
	}
	
	for(int i=1;i*2+2<=tot;i++)
	{
		int ind1 = dpe[i-1].se.fr+1;
		int ind2 = dpe[i-1].se.se+1;
		if(ind1<w1.size() && ind1+1<w1.size())
		{
			if(ind2<w2.size())
			{
				if(w1[ind1]+w1[ind1+1]> w2[ind2])
				{
					p1.fr = w1[ind1]+w1[ind1+1]+dpe[i-1].fr;
					p1.se.fr = ind1+1;
					p1.se.se = ind2-1;
					dpe.push_back(p1);
				}
				else
				{
					p1.fr = w2[ind2]+dpe[i-1].fr;
					p1.se.fr=ind1-1;
					p1.se.se=ind2;
					dpe.push_back(p1);
				}			
			}
			else
			{
				p1.fr = w1[ind1]+w1[ind1+1]+dpe[i-1].fr;
				p1.se.fr = ind1+1;
				p1.se.se = ind2-1;
				dpe.push_back(p1);		
			}			
		}
		else
		{
			p1.fr = w2[ind2]+dpe[i-1].fr;
			p1.se.fr=ind1-1;
			p1.se.se=ind2;
			dpe.push_back(p1);
		}
	}
	
	//cout<<w3.size()<<endl;
	if(w3[0]+w3[1] > w2[0])
	{
		p1.first = w3[0]+w3[1];
		p1.second.first = 1;
		p1.second.second=-1;
		dpe1.push_back(p1);			
	}
	else
	{
		p1.first = w2[0];
		p1.se.fr = -1;
		p1.se.se = 0;
		dpe1.push_back(p1);
	}
	/*for(int i=0;i<dpe.size();i++)
	cout<<dpe[i].fr<<" ";
	cout<<endl;*/
	for(int i=1;i*2+2<=tot;i++)
	{
		int ind1 = dpe1[i-1].se.fr+1;
		int ind2 = dpe1[i-1].se.se+1;
		if(ind1<w3.size() && ind1+1<w3.size())
		{
			if(ind2<w2.size())
			{
				if(w3[ind1]+w3[ind1+1]> w2[ind2])
				{
					p1.fr = w3[ind1]+w3[ind1+1]+dpe1[i-1].fr;
					p1.se.fr = ind1+1;
					p1.se.se = ind2-1;
					dpe1.push_back(p1);
				}
				else
				{
					p1.fr = w2[ind2]+dpe1[i-1].fr;
					p1.se.fr=ind1-1;
					p1.se.se=ind2;
					dpe1.push_back(p1);
				}			
			}
			else
			{
				p1.fr = w3[ind1]+w3[ind1+1]+dpe1[i-1].fr;
				p1.se.fr = ind1+1;
				p1.se.se = ind2-1;
				dpe1.push_back(p1);		
			}			
		}
		else
		{
			p1.fr = w2[ind2]+dpe1[i-1].fr;
			p1.se.fr=ind1-1;
			p1.se.se=ind2;
			dpe1.push_back(p1);
		}
	}
	/*for(int i=0;i<dpe1.size();i++)
	cout<<dpe1[i].fr<<" ";
	cout<<endl;*/
	dpo.push_back(w1[0]);
	int k=0,l=0;
	for(int i=0;i<dpe1.size();i++)
	{
		dpo.push_back(dpe1[i].fr+w1[0]);
	}
	/*for(int i=0;i<dpo.size();i++)
	cout<<dpo[i]<<" ";
	cout<<endl;*/
	for(int i=1;i<=tot;i++)
	{
		if((i&1)==1)
		printf("%lld ",dpo[k++]);
		else
		printf("%lld ",dpe[l++].fr);
	}
	printf("\n");
	return 0;
}