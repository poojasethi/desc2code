#include<bits/stdc++.h>
using namespace std;
int main(){
	int n,a,b;
	int c1[100009],c2[100009];
	memset(c1,0,sizeof(c1));
	memset(c2,0,sizeof(c2));
	cin>>n;
	int i1,i2,n1,n2,cap=0; i1=i2=0;
	for(int i=0;i<n;i++){
		cin>>a>>b;
		cap+=a;
		if(a==1){
		c1[i1++]=b;
		}
		else     c2[i2++]=b;
	}
	n1=i1,n2=i2;
	sort(c1,c1+n1,greater<int>());
	sort(c2,c2+n2,greater<int>());
	long long int maxi[200009];
	vector< pair<int,int> >v(200009);
	memset(maxi,0,sizeof(maxi));
	maxi[0]=0;
	v[0].first=v[0].second=-1;
	maxi[1]=*max_element(c1,c1+i1);
	v[1].first=0,v[1].second=-1;
	for(int i=2;i<=cap;i++){
		if(maxi[i-1]+c1[v[i-1].first+1] > maxi[i-2]+c2[v[i-2].second+1])
		{
			maxi[i]=maxi[i-1]+c1[v[i-1].first+1];
			if(v[i-1].first+1 < n1)
			v[i].first=v[i-1].first+1;
			else
			v[i].first=v[i-1].first;
			v[i].second=v[i-1].second;
		}
		else{
			maxi[i]=maxi[i-2]+c2[v[i-2].second+1];
			v[i].first=v[i-2].first;
			if(v[i-2].second+1 < n2)
			v[i].second=v[i-2].second+1;
			else
			v[i].second=v[i-2].second;
		}
	}
	for(int i=1;i<=cap;i++) cout<<maxi[i]<<" ";
	
	return 0;
}