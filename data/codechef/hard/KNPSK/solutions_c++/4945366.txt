#include <iostream>
#include <vector>
#include <utility>
#include <algorithm>
#include <list>
#include <queue>
#include <cstdio>
#include <functional>
#include <limits>
#include <string>
#include <cstdlib>
#include <set>
#define ull unsigned long long
#define ll long long
#define abs(x) ((x)>0?(x):(-(x)))
#define MOD 1000000007
#define INF numeric_limits<int>::max()
#define NINF numeric_limits<int>::min()
using namespace std;

vector<ll>v(100001);
vector<ll>w(100001);
vector<ll>ans(200001);

void print(vector<ll>v,ll n)
{
	for (ll i = 1; i <= n; ++i)
	{
		cout<<v[i]<<' ';
	}
	cout<<endl;
}
int main(int argc, char const *argv[])
{
	ll n;
	cin>>n;
	ll x;
	ll a=0,b=0;
	ll m=0;
	for (ll i = 0; i < n; ++i)
	{
		cin>>x;
		if(x==1) cin>>v[a++];
		else cin>>w[b++];
		m+=x;
	}
	sort(v.begin(),v.begin()+a,greater<ll>());
	sort(w.begin(),w.begin()+b,greater<ll>());
	//print(w,b);
	v[a]=0;
	ans[0]=0;
	ll s1=0,s2=0;
	for (ll i = 2; i <= m; i+=2)
	{
		if(s1>=a)
		{
			ans[i]=ans[i-2]+w[s2];
			++s2;
			continue;
		}
		if(s2==b)
		{
			ans[i]=ans[i-2]+v[s1]+v[s1+1];
			s1+=2;
			continue;
		}
		ans[i]=ans[i-2]+max(v[s1]+v[s1+1],w[s2]);
		if(v[s1]+v[s1+1]>=w[s2]) s1+=2;
		else ++s2;
	}
	s1=0,s2=0;
	if(a!=0)
	{
		ans[1]=v[0];
		++s1;
	}
	else ans[1]=0;
	for (ll i = 3; i <= m; i+=2)
	{
		if(s1>=a)
		{
			ans[i]=ans[i-2]+w[s2];
			++s2;
			continue;
		}
		if(s2==b)
		{
			ans[i]=ans[i-2]+v[s1]+v[s1+1];
			s1+=2;
			continue;
		}
		ans[i]=ans[i-2]+max(v[s1]+v[s1+1],w[s2]);
		if(v[s1]+v[s1+1]>=w[s2]) s1+=2;
		else ++s2;
	}

	print(ans,m);
	return 0;
}