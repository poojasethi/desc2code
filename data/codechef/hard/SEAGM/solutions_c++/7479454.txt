#include <iostream>
#include <cstdio>
#include <cmath>
#include <cstring>
#include <algorithm>
using namespace std;
#define rep(i, l, r) for (int i = l; i <= r; i++)
#define drep(i, r, l) for (int i = r; i >= l; i--)
typedef long long ll;
const int N = 108;
int n, T, a[N], g[N][N], sg[N][N], m, cnt[N], mex[N];
double f[N][N];
int gcd(int x, int y)
{
	return !y ? x : gcd(y, x % y);
}
void init(int n)
{
	rep(i, 0, n)
		rep(j, 0, n) g[i][j] = gcd(i, j);
}
void solve()
{
	memset(sg, 0, sizeof(sg));
	memset(f, 0, sizeof(f));
	memset(mex, 0, sizeof(mex));
	rep(j, 0, m) sg[n][j] = 0, f[n][j] = 0; 
	sg[n][1] = 1; f[n][1] = 1;
	int p = 0;
	drep(i, n - 1, 0)
		rep(x, 0, m)
		{
			if (x == 1) {sg[i][x] = 1; f[i][x] = 1; continue;}
			memset(cnt, 0, sizeof(cnt));
			rep(j, 1, n) cnt[g[x][a[j]]]++;
			if (x && i && cnt[x] < i) continue;
			if (x) cnt[x] -= i; ++p;
			rep(y, 0, m) 
			{
				if (cnt[y]) mex[sg[i + 1][y]] = p, f[i][x] += (double)cnt[y] / (n - i) * (1 - f[i + 1][y]);
			}
			for (sg[i][x] = 0; mex[sg[i][x]] == p; sg[i][x]++);
			//printf("%d %d %d\n", i, x, sg[i][x]);
		}
	printf("%d %.4lf\n", sg[0][0] ? 1 : 0, f[0][0]);
}
int main()
{
#ifndef ONLINE_JUDGE
	freopen("game.in", "r", stdin);
	freopen("game.out", "w", stdout);
#endif
	scanf("%d", &T);
	init(100);
	while (T--)
	{
		scanf("%d", &n); m = 0;
		rep(i, 1, n) scanf("%d", &a[i]), m = max(m, a[i]);
		solve();
	}
#ifndef ONLINE_JUDGE
	fclose(stdin); fclose(stdout);
#endif
	return 0;
}
