#include<iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#include<cstdlib>
using namespace std;
const int fx[4]={1,-1,-1,1},
          fy[4]={1,1,-1,-1};
int Mark[701][701];
char G[701][701];
int match[701*701];
int vi[701*701];
int n,m,N,nm,ret,kk;
int c[701*701],next[701*701*4],g[701*701*4];
int vis[701*701],Si[701*701],Sj[701*701];
inline void addedge(int x,int y){
     g[++nm]=y;
     next[nm]=c[x];
     c[x]=nm;
}
 
inline bool dfs(int i){
    for (int k=c[i];k;k=next[k]){
        int j=g[k];
        if (vi[j]!=kk){
                    vi[j]=kk;
                    if (!match[j] || dfs(match[j])){
                       match[j]=i;match[j]=i;
                       return true;
                    }
        }
    }
    return false;
}
inline int getint(int &ret){
    char ch;
    while(!isdigit(ch= getchar()) && ch!='-');
    if(ch == '-') return -getint(ret);
    ret= ch-'0';
    while(isdigit(ch= getchar()))
    ret= ret*10 + ch-'0';
}
int main(){
    while (1){
    getint(n);getint(m);
    if (n==0 || m==0) break;
    nm=0;
    ret=0;
    for (int i=1;i<=n;i++){
        for (int j=1;j<=m;j++){
            G[i][j]=getchar();
        }getchar();
   }
   
   for (int i=1;i<=n;i++)
       for (int j=1;j<=m;j++)
           if (G[i][j]=='G')
              for (int k=0;k<4;k++){                  
                  int xm=i+fx[k];
                  int ym=j+fy[k];
                  int x=xm+fx[k];
                  int y=ym+fy[k];
                  if (x<1 || y<1 || x>n || y>m) continue;
                  if (G[xm][ym]!='P' && G[x][y]=='F') G[x][y]='D';
              }
 
   for (int di=1;di<=2;di++)for (int dj=1;dj<=4;dj++){  
   int N1=0,N2=0;
   int djj=dj+2;
   if (djj>4) djj-=4;
   for (int i=di;i<=n;i+=4) for (int j=dj;j<=m;j+=4) if (G[i][j]=='F') Mark[i][j]=++N1,Si[N1]=i,Sj[N1]=j;
   for (int i=di+2;i<=n;i+=4) for (int j=djj;j<=m;j+=4) if (G[i][j]=='F') Mark[i][j]=++N2,Mark[i][j]+=N1;
   for (int i=1;i<=N1+N2;i++) c[i]=0;
   for (int zz=1;zz<=N1;zz++){
            int i=Si[zz],j=Sj[zz];
            if (G[i][j]=='F')
               for (int k=0;k<4;k++){                   
                   int xm=i+fx[k];
                   int ym=j+fy[k];
                   int x=xm+fx[k];
                   int y=ym+fy[k];
                   if (x<1 || y<1 || x>n || y>m) continue;
                   if (G[xm][ym]!='P' && G[x][y]=='F') addedge(Mark[i][j],Mark[x][y]);
               }
   }
   int ans=0;
   for (int i=1;i<=N1+N2;i++) match[i]=0;
   for (int i=1;i<=N1;i++){
       if (!match[i])
          for (int k=c[i];k;k=next[k]){
              int j=g[k];
              if (!match[j]){
                 match[i]=j;
                 match[j]=i;ans++;break;
              }
          }
   }
   for (int i=1;i<=N1;i++){
       if (!match[i]){
                      kk++;
                      ans+=dfs(i);
       }
   }
   ret+=N1+N2-ans;
   }
   printf("%d\n",ret);
   }
}