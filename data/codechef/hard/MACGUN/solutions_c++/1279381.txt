#include<cstdio>
const int N=705,u[4]={-1,-1,1,1},v[4]={-1,1,-1,1};
int n,m,s1,s2,ans;
int l[N*N],e[N*N][4],id[N][N],p1[N*N],p2[N*N];
char s[N][N];
bool can[N][N],b[N*N];
void addedge(int x,int y){e[x][l[x]++]=y;}
bool find(int x)
{
	for (int i=0;i<l[x];i++){
		int j=e[x][i]; if (b[j]) continue; b[j]=1;
		if (p2[j]<0 || find(p2[j])) {p1[x]=j,p2[j]=x; return 1;}
		}
	return 0;
}
void work()
{
	for (int i=0;i<n;i++) scanf("%s",s[i]); ans=0;
	for (int i=0;i<n;i++) for (int j=0;j<m;j++) can[i][j]=s[i][j]=='F';
	for (int i=0;i<n;i++)
		for (int j=0;j<m;j++) if (s[i][j]=='F'){
			for (int k=0;k<4;k++){
				int x=i+u[k]*2,y=j+v[k]*2;
				if (x<0 || x>=n || y<0 || y>=m) continue;
				if (s[i+u[k]][j+v[k]]!='P' && s[x][y]=='G'){can[i][j]=0; break;}
				}
			}
	for (int xx=0;xx<2;xx++)
	for (int yy=0;yy<4;yy++){
		s1=0,s2=0;
		for (int i=xx;i<n;i+=2) if (i%4>1)
			for (int j=yy<2?yy+2:yy-2;j<m;j+=4)
				if (can[i][j]) id[i][j]=++s2;
		for (int i=xx;i<n;i+=2) if (i%4<2)
			for (int j=yy;j<m;j+=4) if (can[i][j]){
				id[i][j]=++s1;
				for (int k=0;k<4;k++){
					int x=i+u[k]*2,y=j+v[k]*2;
					if (x<0 || x>=n || y<0 || y>=m || !can[x][y]) continue;
					if (s[i+u[k]][j+v[k]]!='P' && s[x][y]=='F')
						addedge(s1,id[x][y]);
					}
				}
		int res=s1+s2;
		for (int i=1;i<=s1;i++) p1[i]=-1;
		for (int i=1;i<=s2;i++) p2[i]=-1;
		for (int i=1;i<=s1;i++) for (int j=0;j<l[i];j++)
			if (p2[e[i][j]]<0) {res--,p1[i]=e[i][j],p2[e[i][j]]=i; break;}
		for (int i=1;i<=s2;i++) b[i]=0;
		for (int i=1;i<=s1;i++) if (p1[i]<0 && find(i))
			{res--; for (int i=1;i<=s2;i++) b[i]=0;}
		ans+=res; for (int i=1;i<=s1;i++) l[i]=0;
		}
	printf("%d\n",ans);
}
int main(){while (scanf("%d%d",&n,&m),n||m) work(); return 0;}
