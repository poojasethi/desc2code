#include<iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#include<cstdlib>
using namespace std;
const int fx[4]={1,-1,-1,1},
          fy[4]={1,1,-1,-1};
int Ch[701][701],Mark[701][701];
char G[701][701];
int match[701*701];
int vi[701*701];
int n,m,N,nm,ret,kk;
int c[701*701],next[701*701*4],g[701*701*4];
int vis[701*701];
inline void addedge(int x,int y){
     g[++nm]=y;
     next[nm]=c[x];
     c[x]=nm;
}
 
inline bool dfs(int i){
    for (int k=c[i];k;k=next[k]){
        int j=g[k];
        if (vi[j]!=kk){
                    vi[j]=kk;
                    if (!match[j] || dfs(match[j])){
                       match[j]=i;match[j]=i;
                       return true;
                    }
        }
    }
    return false;
}
 
int main(){
    while (scanf("%d%d",&n,&m)!=EOF){
    if (n>700 || m>700) break;
    if (n==0 || m==0) break;
    nm=0;
    ret=0;
    for (int i=1;i<=n;i++){
        getchar();
        for (int j=1;j<=m;j++){
            G[i][j]=getchar();
        }
   }
   for (int i=1;i<=n;i++)
       for (int j=1;j<=m;j++)
           if (G[i][j]=='G')
              for (int k=0;k<4;k++){                  
                  int xm=i+fx[k];
                  int ym=j+fy[k];
                  int x=xm+fx[k];
                  int y=ym+fy[k];
                  if (x<1 || y<1 || x>n || y>m) continue;
                  if (G[xm][ym]!='P' && G[x][y]=='F') G[x][y]='D';
              } 
 
   for (int di=1;di<=2;di++)for (int dj=1;dj<=2;dj++){  
   int N1=0,N2=0;
   for (int i=di;i<=n;i+=4) for (int j=dj;j<=m;j+=2) if (G[i][j]=='F') Mark[i][j]=++N1;
   for (int i=di+2;i<=n;i+=4) for (int j=dj;j<=m;j+=2) if (G[i][j]=='F') Mark[i][j]=++N2,Mark[i][j]+=N1;
   for (int i=1;i<=N1+N2;i++) c[i]=0;
   for (int i=di;i<=n;i+=4)
       for (int j=dj;j<=m;j+=2)
            if (G[i][j]=='F')
               for (int k=0;k<4;k++){                   
                   int xm=i+fx[k];
                   int ym=j+fy[k];
                   int x=xm+fx[k];
                   int y=ym+fy[k];
                   if (x<1 || y<1 || x>n || y>m) continue;
                   if (G[xm][ym]!='P' && G[x][y]=='F') addedge(Mark[i][j],Mark[x][y]);
               }
   int ans=0;
   for (int i=1;i<=N1+N2;i++) match[i]=0,vi[i]=0;
   for (int i=1;i<=N1;i++){
       if (!match[i])
          for (int k=c[i];k;k=next[k]){
              int j=g[k];
              if (!match[j]){
                 match[i]=j;
                 match[j]=i;ans++;break;
              }
          }
   }
   kk=0;
   for (int i=1;i<=N1;i++){
       if (!match[i]){
                      kk++;
                      ans+=dfs(i);
                      //for (int j=1;j<=kk;j++) vi[vis[j]]=0;
                      //memset(vi,0,sizeof vi);
       }
   }
   ret+=N1+N2-ans;
   }
   printf("%d\n",ret);
   }
}