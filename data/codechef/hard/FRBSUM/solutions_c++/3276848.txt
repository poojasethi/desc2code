#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<cmath>
using namespace std;
int tr[20][100100];
int sum[20][100100];
int a[100100];
int n,m,len;
int vl[30],vr[30],vp[30];
void build(int l,int r,int p){
	if (l == r) {tr[p][l]= sum[p][l] = a[l];return;}
	int mid = (l+r) >> 1;
	build(l,mid,p+1);build(mid+1,r,p+1);
	int i = l,j = mid+1,k = l-1;
	while (i <= mid && j <= r){
		if (tr[p+1][i] < tr[p+1][j])
			 tr[p][++k] = tr[p+1][i++];
		else tr[p][++k] = tr[p+1][j++];
	}
	if (i <= mid)
		while (i <= mid)
			tr[p][++k] = tr[p+1][i++];
	if (j <= r)
		 while (j <= r)
			 tr[p][++k] = tr[p+1][j++];
	sum[p][l] = tr[p][l];
	for (int i = l+1;i <= r;i++)
		sum[p][i] = sum[p][i-1]+tr[p][i];
}
void find(int l,int r,int ln,int rn,int p){
	if (ln <= l && r <= rn) {
		len++;vl[len] = l,vr[len] = r,vp[len] = p;return;
	}
	int mid = (l+r) >> 1;
	if (ln <= mid) find(l,mid,ln,rn,p+1);
	if (mid < rn) find(mid+1,r,ln,rn,p+1);
}
int main(){
	scanf("%d",&n);
	for (int i = 1;i <= n;i++)
		scanf("%d",&a[i]);
	build(1,n,1);
	scanf("%d\n",&m);
	for (int i = 1;i <= m;i++){
		int l,r;scanf("%d%d",&l,&r);
		len = 0;find(1,n,l,r,1);
		int s = 0;
		while (true){
			int news = 0;
			for (int i = 1;i <= len;i++){
				int L = vl[i],R = vr[i],mid = (L+R) >> 1;
				int *a = tr[vp[i]];int ans = 0;
				while (L <= R){
					if (a[mid] <= s+1) ans = mid,L = mid+1;
					else R = mid-1;
					mid = (L+R) >> 1;
				}
				news += sum[vp[i]][ans];
			}
			if (news == s) {printf("%d\n",s+1);break;}
			s = news;
		}
	}
	return 0;
}
