//TC

#include <algorithm>
#include <iostream>
#include <cstdlib>
#include <cassert>
#include <cstring>
#include <cstdio>
#include <vector>
#include <queue>
#include <stack>
#include <cmath>
#include <list>
#include <set>
#include <map>

#define forn(a,b,c) for(int (a)=(b);(a)<=(c);(a)++)
#define forr(a,b,c) for(int (a)=(b);(a)>=(c);(a)--)
#define foreach(a,b) for( typeof( (b).begin() ) a=(b).begin(); (a)!=(b).end() ; (a)++ )
#define foreachr(a,b) for( typeof( (b).rbegin() ) a=(b).rbegin(); (a)!=(b).rend() ; (a)++ )
#define dg(x)  cerr <<#x<<':'<<x<<" "
#define dbg(x)  cerr <<#x<<':'<<x<<endl
#define SET(A,b) memset(A,b,sizeof (A) )
#define SIZE(A) ((int)(A).size())
#define ALL(A) (A).begin(),(A).end()
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define num(a) (1LL<<(a))
using namespace std;

typedef double dbl;
typedef long long Lint;
typedef pair<int,int> ii;
typedef pair<Lint,Lint> Lii;

const Lint mod = 1e9;

const int MAXN = 200010;

int N,D;

int c[MAXN];

Lint d[MAXN];

int V[MAXN];

int f(int x){
	
	deque< int > st;
	
	//~ dbg(x);
	
	st.pb( 0 );
	
	V[0]=0;
	
	V[N]=1e9;
	
	forn(i,1,N)
		if( c[i]<=x || i==N ){
			
			//~ dbg(i);
			
			while( !st.empty() && d[i]-d[st.front()] > D )
				st.pop_front();
			
			if( st.empty() )
				return (int)1e9;
			
			V[i]=V[ st.front() ]+1;
			
			//~ dbg(V[i]);
			
			st.pb( i );
			
		}
	
	//~ dbg(V[N]);
	
	return V[N];
	
}

int main(){
	
	int T;
	
	scanf(" %d",&T);
	
	while(T--){
		
		scanf("%d %d",&N,&D);
		
		forn(i,1,N)
			scanf("%Ld %d",d+i,c+i);
		
		forn(i,2,N)
			d[i]+=d[i-1];
		
		int L=f( (int)1e9 );
		
		int lo=1,hi=1e9,mi;
		
		while( lo<hi ){
			
			mi=(lo+hi)/2;
			
			if( f(mi)>L )
				lo=mi+1;
			else
				hi=mi;
			
		}
		
		printf("%d %d\n",L,lo);
		
	}
	
	return 0;
	
}
