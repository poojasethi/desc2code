#include <iostream>
#include <cstdio>
#include <vector>
#include <cstring>

using namespace std;

#define maxa 1000000
#define maxn 100000

#define MAX(a,b) ((a) > (b) ? (a) : (b))
#define MIN(a,b) ((a) < (b) ? (a) : (b))

vector<int> fact[maxa + 1];
int arr[maxn + 1];
int best[maxa + 1];
int last[maxa + 1];

int gcd(int a, int b)
{
	if(b==0)
		return a;
	return gcd(b, a%b);
}

int main() 
{
	int i,j,t,n;
	
	for(i=2; i<= maxa; i++)
		if(fact[i].size() == 0)
			for(j=i; j<=maxa; j=j+i)
				fact[j].push_back(i);
				
	scanf("%d", &t);
	
	while(t--)
	{
		scanf("%d", &n);
		
		memset(last, -1, sizeof(last));
       	int ans=-1;
		
		for(i=0; i<n; i++)
		{
			scanf("%d", &arr[i]);
			
			int v=arr[i], x=-1;
			 
			for(j=0;j<fact[v].size();j++)
			{
            	int p=fact[v][j];
            	
               	//the last time a prime factor p appeared in the array
               	if(last[p]!=-1) 
               		x=MAX(x,last[p]);
               		
               	last[p]=i;
            }
			
			//dp stuff
           	if(i)
           	{
               	best[i] = MAX(best[i-1],x);
               	ans=MAX(ans,i-best[i]);
           	}
           	else
             	best[i]=-1;
       }

     	if(ans==1) ans=-1;
       		printf("%d\n",ans);
	}
	
	/*for(i=0; i<n; i++)
		printf("%d ", best[i]);
		
	printf("\n");
	
	for(i=0; i<n; i++)
		printf("%d ", last[i]); */
		
	return 0;
}