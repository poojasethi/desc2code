#include <iostream>
#include <vector>
#include<cstring>
using namespace std;
#define maxn 100009
#define maxv 1000009
#define MEM(a,b) memset(a,(b),sizeof(a))

int last[maxv+9] = {-1};
int best[maxn+9];
int a[maxn];
vector<int> v[maxv+9];

int main() {

	for(int i=2;i<=maxv;i++) if(v[i].size()==0)
	for(int j=i;j<=maxv;j+=i) v[j].push_back(i);
      
	int t; scanf("%d",&t);
	while(t--){
	int n; scanf("%d",&n);
	
	int ans = 1;
	MEM(last,-1);
	
	for(int i=0;i<n;i++){
	scanf("%d",&a[i]);

	int x = -1;

	for(int j=0;j<v[a[i]].size();j++){
	int p=v[a[i]][j];
	if(last[p] != -1)x=max(x,last[p]);	
	last[p] = i;
	}
	

	//printf("%d %d\n",i,x);
	
	if(i){
	best[i] = max(best[i-1],x);
	ans=max(ans,i-best[i]);
	}else
	best[i] = -1;
	
	}
	
	
	if(ans == 1)printf("-1\n");
	else
	printf("%d\n",ans);
	}
	return 0;
}