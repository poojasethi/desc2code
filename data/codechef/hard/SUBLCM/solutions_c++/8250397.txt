#include<bits/stdc++.h>
using namespace std;
int factor[35][1000001];
int hashval[1000001],arr[1000001],dp[100001];
int primefactor(int p,int index)
{
    int maxval=-5;
    for(int i=0;i<factor[30][p];i++)
    {
        maxval=max(maxval,hashval[factor[i][p]]);
        hashval[factor[i][p]]=index;
    }
    return maxval;
}

int intializefactorarr(int p)
{
    if(p==1000001)
        return 0;
    int l=p;
    while(l%2==0)
        l/=2;
    if(p%2==0)
        factor[factor[30][p]++][p]=2;
     for(int i=3;i*i<=l;i+=2)
    {
        if(l%i==0)
             while(l%i==0)
               l/=i;
        if(p%i==0)
        factor[factor[30][p]++][p]=i;
    }
     if(l>1)
    factor[factor[30][p]++][p]=l;
    //printf("%d ",p);
    //intializefactorarr(p+1);

}
int main()
{
    for(int p=2;p<1000001;p++)
    intializefactorarr(p);
    int test;
    cin>>test;
    while(test--)
    {
        int k,p,ans=0;
        scanf("%d",&k);
        for(int i=1;i<=k;i++)
        {
             scanf("%d",&p);
             if(p!=1)
           arr[i]=primefactor(p,i);
          // cout<<arr[i]<<" ";
           dp[i]=min(dp[i-1]+1,-arr[i]+i);
           ans=max(ans,dp[i]);
        }
        if(ans==1)
            printf("-1\n");
        else
        printf("%d\n",ans);
        memset(hashval,0,sizeof(hashval));
    }
}
