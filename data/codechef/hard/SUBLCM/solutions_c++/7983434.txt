#include<bits/stdc++.h>
using namespace std;
#define MAX 1000005
#define pb push_back


vector<int> f[MAX+1];
int dp[MAX+5];
int last[MAX+5];

int main()
{
   int i,j,k,n,q,t;

  for(i=2;i<=MAX;i++) if(f[i].size()==0)
      for(j=i;j<=MAX;j+=i) f[j].pb(i);

   scanf("%d",&t);
  while(t--)
  {
      scanf("%d",&n);
       memset(last,-1,sizeof last);
       int ans=-1,a;
       for(i=0;i<n;i++)
       {
           scanf("%d",&a);
           int v=a,x=-1;

           for(j=0;j<f[v].size();j++)
           {
               int p=f[v][j];
               if(last[p]!=-1)
                    x=max(x,last[p]);
               last[p]=i;
           }
           if(i)
           {
               dp[i] = max(dp[i-1],x);
               ans=max(ans,i-dp[i]);
           }
           else
             dp[i]=-1;
       }


     if(ans==1) ans=-1;
       printf("%d\n",ans);
  }
	return 0;
}


