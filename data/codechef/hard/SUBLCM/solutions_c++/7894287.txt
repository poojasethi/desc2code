/*
      !!  TRUTH IS GOD  !!
       TRUTH ALONE TRIUMPHS
*/

#include<iostream>
#include<vector>
#include<string.h>

#define MAX_SIZE  100000
#define MAX_VALUE 1000000

using namespace std;

int arr[ MAX_VALUE+10 ] , last[ MAX_VALUE + 10 ] , best[ MAX_VALUE + 10 ];

vector<int> fact[ MAX_VALUE+10 ] ;

int main()
{
	 int i , j ,  p , x , min , t , n , answer ;
	 
	 best[0]=-1;
	 
	 for( i=2 ; i<=MAX_VALUE ; i++ )
	  {
	  	 if( fact[i].size()==0 )
	  	  {
	  	  	 for( j=i ; j<=MAX_VALUE ; j+=i )
		  	  {
		  	     fact[j].push_back(i);
		  	  }	 
	      }
	  }
	 	 	 
	 scanf("%d",&t);
	 
	 while( t-- )
	  {
	  	  scanf("%d",&n);
	  	  
	  	  answer=-1;
	  	  
	  	  memset( last , -1 , sizeof(last) );
	  	  
	  	  for( i=0 ; i<n ; i++ )
	  	   {
	  	   	   scanf("%d",arr+i);
	  	   	   
	  	   	   p=fact[ arr[i] ].size();
	  	   	   
	  	   	   min=-1;
	  	   	   
	  	   	   for( j=0 ; j<p ; j++ )
	  	   	     {
	  	   	    	   x= fact[ arr[i] ][ j ];
	  	   	    	 
	  	   	    	   if( last[x]!=-1 && last[x]>min )
	  	   	    	    {
	  	   	    	  	     min=last[x];
	  	   	    	    }
	  	   	    	   
	  	   	    	  last[ x ]=i; 
	  	   	     } 
	  	   	    
	  	   	   
	  	   	   if( i )
	  	   	    {
	  	   	    	 if( best[i-1] > min ) 
						  best[i]=best[i-1];
					 else
					      best[i]=min;
					 
					 if( i-best[i] > answer )
					   answer=i-best[i];		  	   
	  	   	    }
	  	   	   else
			    {
			    	best[i]=-1;
			    } 
	  	   }

	  	   if( answer==1 ) 
	  	    {
	  	    	answer=-1;
	  	    }

	  	   printf("%d\n", answer );
	  }
	 
      return 0;
}