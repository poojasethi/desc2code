#include <bits/stdc++.h>
#define FOR(i,a,b) for(int i=a; i<=b; i++)
#define FRO(i,a,b) for(int i=a; i>=b; i--)
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define ll long long
#define mp make_pair
#define f first
#define s second
#define N 1000005
#define BIT(i, n) ( (n >> i) & 1 )
#define ln
#define oo 300003

using namespace std;

int n, T, P[N], DP[N], Pre[N], pos[N];
vector <int> a[N];

int main()
{
   // filein("inp.txt");  fileout("out.txt");
    cin >> T;
    int u, x;
    for(int i=2; i<N; i++)
    {
        if(P[i])   continue;
        for(int j=i; j<N; j+=i)
            P[j] = i;
    }
    for(int i=2; i<N; i++)
    {
        u = i;
        while(u > 1)
        {
            x = P[u];   a[i].push_back(x);
            while(u % x == 0)   u /= x;
        }
    }
   // T = 50;
    while(T--)
    {
        int ans = 0;
        cin >> n;   //n = 100000;
        memset(pos, 0, sizeof(pos));
        for(int i=1; i<=n; i++)
        {
            Pre[i] = 0;
            scanf("%d", &u);
            //u = rand() * rand() % 1000000;
            for(int j=0; j<a[u].size(); j++)
                Pre[i] = max(Pre[i], pos[a[u][j]]);
            for(int j=0; j<a[u].size(); j++)
                pos[a[u][j]] = i;
        }
        for(int i=1; i<=n; i++)
        {
            DP[i] = max(DP[i-1], Pre[i]+1);
            ans = max(ans, i - DP[i] + 1);
        }
        if(ans > 1) cout << ans << endl;
        else    cout << -1 << endl;
    }
}
