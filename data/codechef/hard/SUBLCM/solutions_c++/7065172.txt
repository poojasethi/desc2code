/*
Author : lifecodemohit
Problem : http://www.codechef.com/problems/SUBLCM
*/

#include <bits/stdc++.h>
using namespace std;
 
#define ll 					long long int
#define MOD 				1000000007
#define sn(n) 				scanf("%lld",&n)
#define pn(n) 				printf("%lld\n",n)
#define ss(str) 			scanf("%s",str)
#define ps(str) 			printf("%s\n",str)
#define rep(i,s,e) 			for(i=s;i<=e;i++)
#define reprev(i,s,e) 		for(i=s;i>=e;i--)
#define reps(b,e,g,str) 	for(b=str,e=&str[g-1];b<=e;b++) 
#define mem(arr,val) 		memset(arr,val,sizeof(arr))
#define dis(arr,s,e) 		for(i=s;i<=e;i++) printf("%lld ",arr[i]); printf("\n"); 

//vector<ll> v1[1000010];
ll v1[1000010][20], v2[1000010];
ll p[1000010],a[100010],last[1000010];

void sieve()
{
	ll i,j;
	rep(i,0,1000000)
	{
		p[i]=1;
		v2[i]=-1;
	}
	p[0]=p[1]=0;
	rep(i,2,1000000)
	{
		if(p[i]==1)
		{
			v2[i]++;
			v1[i][v2[i]]=i;
			//v1[i].push_back(i);
			for(j=i+i;j<=1000000;j=j+i)
			{
				v2[j]++;
				v1[j][v2[j]]=i;
				//v1[j].push_back(i);
				p[j]=0;
			}
		}
	}
}

int main()
{
	sieve();
	ll t;
	sn(t);
	while(t--)
	{
		ll n,i,j,res,left,right;
		sn(n);
		rep(i,0,n-1)
			sn(a[i]);
		left=0;
		right=0;
		rep(i,0,1000000)
			last[i]=-1;
		res=0;
		ll dp=0;
		rep(i,0,n-1)
		{
			ll x=a[i];
			//ll y=v1[x].size()-1;
			ll y=v2[x];
			rep(j,0,y)
			{
				left=max(left,last[v1[x][j]]+1);
				last[v1[x][j]]=i;
				//left=max(left,last[(ll)v1[x][j]]+1);
				//last[(ll)v1[x][j]]=i;
			}
			
			res=max(res,right-left);
			right++;
		}
		if(res==0)
			pn((ll)-1);
		else
			pn(res+1);
	}
	return 0;
}