#include<bits/stdc++.h>
using namespace std ;
int a[1000001] = {0} ;
int cd[1000001];
int b[1000001] ;
int r[1000001];
int dp[1000001] ;
int main()
{
	//printf("ajjbcajbc\n");
	a[1] = 2;
	a[2] = 0;
	int t,i,j,max,n,u,start,x;
    vector<int> p ;
	//printf("ajjbcajbc\n");
    vector<vector<int> > m(1000001) ;
    m[1].push_back(1) ;
	//printf("ajjbcajbc\n");
	int k ;
        k = sqrt(1000001);
        for(i=2;i<=k;i++) {
            if(a[i] == 0) {
                p.push_back(i) ;
                m[i].push_back(i) ;
                j = i*2;t = 3;
                while(j <= 1000000) {
                    m[j].push_back(i) ;
                    a[j] = 1 ;
                    j = i*t;
                    t++;
                }
            }
        }
        for(int i=1001;i<=1000000;i+=2) {
            if(a[i]==0) m[i].push_back(i);
        }

         scanf("%d",&t);
         while(t--) {
         	scanf("%d",&n);
         	for(i=0;i<n;i++) {
         		scanf("%d",&b[i]);
            }

         	max = 0 ;
            memset(dp,0,sizeof(dp)) ;
         	memset(r,-1,sizeof(r)) ;
         	dp[0] = 1 ;
         	int temp1,temp2 ;
         	temp1 = m[b[0]].size() ;
         	for(i=0;i<temp1;i++) {
               // cout << m[b[0]][i] << " " ;
                r[m[b[0]][i]] = 0 ;
         	}
         	//cout << endl ;
         	for(i=1;i<n;i++) {
                int l = m[b[i]].size() ;
                temp2 = -1 ;
                for(j=0;j<l;j++) {
                    if(m[b[i]][j] == 1) continue  ;
                    if(r[m[b[i]][j]] != -1) {
                        temp1 = r[m[b[i]][j]] ;
                        if(temp1 > temp2) temp2 = temp1 ;
                    }
                    r[m[b[i]][j]] = i ;
                }

                dp[i] = min(dp[i-1]+1, i-temp2) ;
         	}
//         	for(i=0;i<n;i++) cout << dp[i] << " " ;
//         	cout << endl ;
         	k = 0 ;
         	for(i=0;i<n;i++) {
                if(dp[i] > k ) k = dp[i] ;
         	}
         	if(k == 1) cout << -1 << endl ;
         	else cout << k << endl ;
        }
    return 0 ;
}
