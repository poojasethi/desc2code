#include <bits/stdc++.h>
#define maxm 20001
#define maxn 5001
#define mp make_pair

using namespace std;
typedef pair<int,int> II;
typedef pair<int,II> III;

int n, m1, m2;
III a[maxm], b[maxm];
int lt[maxn];

void read_in() {
    scanf("%d%d%d",&n,&m1,&m2);
    for(int i=1;i<=m1;i++) {
        int u, v, w; scanf("%d%d%d",&u,&v,&w);
        ++u; ++v;
        a[i]=mp(w,mp(u,v));
    }
    for(int i=1;i<=m2;i++) {
        int u, v, w; scanf("%d%d%d",&u,&v,&w);
        ++u; ++v;
        b[i]=mp(w,mp(u,v));
    }
}

int tim(int u) {
    if (u==lt[u]) return u;
    lt[u]=tim(lt[u]);
    return lt[u];
}

void solve() {
    for(int i=1;i<=n;i++) lt[i]=i;
    long long ans=0, ans1=0;
    int slt=n;
    sort(b+1,b+m2+1);
    for(int i=m2;i>=1;i--) {
        int u=b[i].second.first, v=b[i].second.second;
        u=tim(u); v=tim(v);
        if (u!=v) {
            ans+=b[i].first;
            lt[u]=v;
            slt--;
        }
    }
    ans1=ans;
    sort(a+1,a+m1+1);
    for(int i=1;i<=m1;i++) {
        int u=a[i].second.first, v=a[i].second.second;
        u=tim(u); v=tim(v);
        if (u!=v) {
            ans+=a[i].first;
            lt[u]=v;
            slt--;
        }
    }
    if (slt>1) printf("Impossible\n"); else printf("%lld %lld\n",ans1,ans);
}

int main() {
    #ifndef ONLINE_JUDGE
    freopen("inp.txt","r",stdin);
    freopen("out.txt","w",stdout);
    #endif // ONLINE_JUDGE
    int T; scanf("%d",&T);
    while (T--) {
        read_in();
        solve();
    }
}
