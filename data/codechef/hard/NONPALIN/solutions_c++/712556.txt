#include<cstdio>
#include<cstring>
#include<algorithm>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

typedef unsigned long long ull;

char s[100001];
int len,rad[200000];

void Manacher(){
	int n=2*len;
	for(int i=0,j=0;i<n;){
		while(0<=i-j && i+j+1<n && s[(i-j)/2]==s[(i+j+1)/2]) j++;
		rad[i]=j;

		int k;
		for(k=1;i-k>=0 && rad[i-k]<rad[i]-k;k++) rad[i+k]=rad[i-k];

		i+=k;
		j=(j>k?j-k:0);
	}
}

int next[200010],color[200010];

void init(){
	rep(i,2*len+10){
		next[i]=i;
		color[i]=-1;
	}
}

void gao(int l,int r,int c){
	if(l>r) return;
	if(next[l]==l){
		gao(l+2,r,c);
		color[l]=c;
		next[l]=next[l+2];
	}
	else{
		gao(next[l],r,c);
		next[l]=next[next[l]];
	}
}

int main(){
	int T; scanf("%d ",&T);
	while(T--){
		gets(s);
		len=strlen(s);

		Manacher();

		init();
		rep(i,2*len-1){
			int L,R;
			// odd length
			if(i%2==0){
				L=rad[i]+2;
				R=2*min(i/2,len-i/2-1)+1;
			}
			// even length
			else{
				L=rad[i]+2;
				R=2*min(i/2+1,len-i/2-1);
			}

			gao(L,R,i);
		}

		for(int i=1;i<=len;i++){
			if(~color[i]){
				color[i]/=2;
				if(i&1) color[i]-=i/2;
				else    color[i]-=i/2-1;
			}
			color[i]++;
		}

		ull ans=0;
		for(int i=1;i<=len;i++) ans=ans*100007+color[i];
		printf("%llu\n",ans);
	}

	return 0;
}
