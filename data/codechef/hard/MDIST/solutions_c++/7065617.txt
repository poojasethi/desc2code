#include <bits/stdc++.h>
 
using namespace std;
 
#define HODOR        long long
#define INF          1234567890
#define rep(i, a, b) for(int i = (a); i < (b); ++i)
#define gc           getchar_unlocked
#define pc           putchar_unlocked

template<typename X> inline void inp(X &n ) {
    register int ch=gc();int sign=1;n=0;
    while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=gc();}
    while(  ch >= '0' && ch <= '9' ) n = (n<<3)+(n<<1) + ch-'0', ch=gc();
    n=n*sign;
}
 
struct N {
    int d[4];
}ans;

vector<N> T;

void update(int start, int end) {
    for ( start >>= 1 , end >>= 1 ; start > 0; start >>= 1 , end >>= 1)
        rep(i, start, end+1) 
            for (int j = 0, next = i<<1; j < 4; ++j)
            	if ( j&1 )	T[i].d[j] = min(T[next].d[j], T[next+1].d[j]);
            	else   		T[i].d[j] = max(T[next].d[j], T[next+1].d[j]);	
}

HODOR query(int start, int end) {
    for(ans = T[0]; start <= end ; start = (start+1)>>1, end = (end-1)>>1)
    	rep(j, 0, 4)
    		if ( j&1 )	ans.d[j] = min(ans.d[j], min(T[start].d[j], T[end].d[j]));
        	else		ans.d[j] = max(ans.d[j], max(T[start].d[j], T[end].d[j]));
    return max(1LL*ans.d[0]-ans.d[1], 1LL*ans.d[2]-ans.d[3]);
}

int findSize(int n) {
    int i = 1;
    for (; i < n; i <<= 1);
    return i;
}

int main() {
    // freopen("ip","r",stdin);
    int n, q, a, b, c, sz;
    char ch;

    inp(n), sz = findSize(n), T.assign(sz+sz, (N){-INF, INF, -INF, INF});
    rep(i, 0, n)
        inp(a), inp(b), T[i+sz].d[0] = T[i+sz].d[1] = a+b, T[i+sz].d[2] = T[i+sz].d[3] = a-b;

    update( sz, sz+n-1 ), inp(q);
    rep(i, 0, q) {
        for( ch = gc(); !(ch=='U' || ch=='Q'); ch = gc());
        inp(a), inp(b);
        if ( ch == 'U' ) 
            inp(c), T[a+sz].d[0] = T[a+sz].d[1] = b+c, T[a+sz].d[2] = T[a+sz].d[3] = b-c, update(a+sz, a+sz);
        else 
            printf("%lld\n", query(a+sz, b+sz));
    }
    return 0;
}