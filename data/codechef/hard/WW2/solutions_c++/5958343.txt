#include<bits/stdc++.h>
using namespace std;
#define getcx getchar
#define maxn 35
#define F(i,p,n) for(i=p;i<n;i++)
#define I(i,p,q) for(i=p;i>=q;i--)
#define S(x) scanf("%d",&x)
#define P(x) printf("%d\n",x)
#define Ps(x) printf("%d ",x)
#define LL long long int
#define pii pair<int,int>
LL od[maxn][maxn],ev[maxn][maxn],id[maxn][maxn],com[maxn][maxn],res[maxn][maxn];
const LL mod=1e9+7;
int m;
void mul(LL a[maxn][maxn],LL b[maxn][maxn],LL c[maxn][maxn])
{
    int i,j,k;
    LL temp[maxn][maxn]={{0}};
    F(i,0,m+2)
    {
        F(j,0,m+2)
        {
            F(k,0,m+2)
            {
                temp[i][j]=(temp[i][j]+(a[i][k]*b[k][j])%mod)%mod;
            }
        }
    }
    F(i,0,m+2)
    F(j,0,m+2)
    c[i][j]=temp[i][j];
}
void rec(int num)
{
    if(num==0)
        return ;

    if(num%2)
        mul(id,res,id);
    mul(res,res,res);
    rec(num/2);
}
void mat()
{
    int i,j,k;
    F(i,0,m+2)
    F(j,0,m+2)
    id[i][j]=ev[i][j]=od[i][j]=res[i][j]=com[i][j]=0;
    F(i,1,m+1)
    od[i][i]=od[i][i+1]=od[i][i-1]=ev[i][i]=ev[i][i+1]=ev[i][i-1]=1;
    F(i,1,m+1)
    ev[i][i]=0;
    F(i,0,m+2)
    {
        ev[0][i]=ev[m+1][i]=od[0][i]=od[m+1][i]=0;
    }

    F(i,0,m+2)
    id[i][i]=1;
    mul(od,ev,com);

}
int main()
{
    int i,j,k,t,n;

    S(t);
    while(t--)
    {
        S(n);
        S(m);
        LL ans=0;
        mat();
            /*printf("mat ev:\n");
            F(i,0,m+2)
            {
                F(j,0,m+2)
                    printf("%lld  ",ev[i][j]);
                printf("\n");
            }
            printf("mat od:\n");
            F(i,0,m+2)
            {
                F(j,0,m+2)
                    printf("%lld  ",od[i][j]);
                printf("\n");
            }
            printf("mat com:\n");
            F(i,0,m+2)
            {
                F(j,0,m+2)
                    printf("%lld  ",com[i][j]);
                printf("\n");
            }*/
            mul(id,com,res);
            /*printf("mat id:\n");
            F(i,0,m+2)
            {
                F(j,0,m+2)
                    printf("%lld  ",id[i][j]);
                printf("\n");
            }*/
            rec((n-1)/2);
            /*printf("mat id:\n");
            F(i,0,m+2)
            {
                F(j,0,m+2)
                    printf("%lld  ",id[i][j]);
                printf("\n");
            }
            printf("n=%d\n",n);*/
            if(n%2==0)
            mul(id,ev,id);
            F(i,1,m+1)
            {
                F(j,1,m+1)
                ans=(ans+id[i][j])%mod;
            }
            //ans=(ans+mod-(id[1][0]+id[m][m+1])%mod)%mod;
            printf("%lld\n",ans);
    }
    return 0;
}
