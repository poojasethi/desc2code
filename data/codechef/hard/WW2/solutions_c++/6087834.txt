#include<iostream>
#include<cstring>
#include<stdio.h>
#include<assert.h>
#include<algorithm>
#include<cmath>
#include<vector>
#include<queue>
#include<stack>
#include<map>
#include<set>
#define mp make_pair
#define pb push_back
#define MAX(a,b) ((a)>(b)?(a):(b))
#define MIN(a,b) ((a)<(b)?(a):(b))
#define F first
#define S second
#define ll long long
#define pp pair<int,int>
#define SS system("pause")
#define INF 200000000
#define P 1000000007
#define vec vector<ll>
using namespace std;
int T,n,m,i,j,ans;
vec v;
vector<vec> A,B,C;

vector<vec> nam(vector<vec> A,vector<vec> B){
    vector<vec> C;
    for(int i=0;i<m;i++)C.pb(v);
    int n=A.size(),e=A[0].size(),t=B[0].size();

    for(int i=0;i<n;i++)
        for(int j=0;j<t;j++)
        for(int k=0;k<e;k++)
        C[i][j]=(C[i][j]+((ll)A[i][k]*B[k][j]%P))%P;
    return C;
}

vector<vec> xar(vector<vec> A,int x){
    if(x==1)return A;
    if(x&1)return nam(xar(A,x-1),A);
    vector<vec> B=xar(A,x/2);
    return nam(B,B);
}



int main()
{scanf("%d",&T);
 while(T--){
    scanf("%d%d",&n,&m);
    if(n==1){
        printf("%d\n",m);
        continue;
    }
    if(m==1){
        cout<<0<<endl;
        continue;
    }
    v.clear();
    B.clear();
    for(i=0;i<m;i++)v.pb(0);
    for(i=0;i<m;i++)B.pb(v);

    A.clear();
    A.pb(v);
    A[0][0]=1;
    for(i=1;i+1<m;i++)A[0][i]=2;
    A[0][m-1]=1;


    if(n/2-1>0){
        for(i=0;i<m;i++){
            for(j=MAX(0,i-2);j<=MIN(m-1,i+2);j++)B[i][j]=1;
            if(i>0 && i+1<m)B[i][i]++;
        }
        B=xar(B,n/2-1);
        A=nam(A,B);
    }
    if(n&1){
        C.clear();
        C.pb(v);
        for(i=0;i<m;i++)
            for(j=MAX(0,i-1);j<=MIN(m-1,i+1);j++)
            C[0][i]=(C[0][i]+A[0][j])%P;
        A=C;
    }
    ans=0;
    for(i=0;i<m;i++)ans=(ans+A[0][i])%P;
    printf("%d\n",ans);
 }
 return 0;
}
