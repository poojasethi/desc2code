#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
using namespace std;
#define mod 1000000007
#define ll long long
#define lim 31
ll cs,n,m,e,s,i,j;
ll A[lim][lim],B[lim][lim],C[lim][lim],M[lim][lim],M2[lim][lim];
void mult(ll A[lim][lim],ll B[lim][lim],ll C[lim][lim])
{
   ll i,j,k;
   for(i=0;i<n;i++)
      for(j=0;j<n;j++)
         for(C[i][j]=k=0;k<n;k++)
         C[i][j]=(C[i][j]+A[i][k]*B[k][j])%mod;
}
int main()
{
   cin>>cs;
   while(cs--)
   {
      cin>>m>>n;
      memset(A,0,sizeof A);
      memset(B,0,sizeof B);
      memset(M,0,sizeof M);
      for(i=0;i<n;i++)
         for(M[i][i]=1,j=max(i-1,0ll);j<=min(i+1,n-1);j++)
         {
            A[j][i]=1;
            if(j!=i)
               B[j][i]=1;
         }
      mult(B,A,C);
      e=(m-1)/2;

      for(i=30;i>=0;i--)
      {
         mult(M,M,M2);
         memcpy(M,M2,sizeof M);
         if(e&1<<i)
         {
           mult(M,C,M2);
           memcpy(M,M2,sizeof M);
         }
      }
      if((m-1)&1)
      {
         mult(M,B,M2);
         memcpy(M,M2,sizeof M);
      }
      for(s=i=0;i<n;i++)
      {
         for(j=0;j<n;j++)
         {
            s=(s+M[i][j])%mod;
            //printf("%d ",M[i][j]);
         }
         //printf("\n");
      }
      cout<<s<<"\n";
   }
   return 0;
}

