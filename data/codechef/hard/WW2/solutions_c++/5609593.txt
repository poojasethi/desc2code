#include <iostream>
#include <stdio.h>
#include <string.h>
#include <vector>
using namespace std;

#define fore(i, l, r) for(int i = l; i < r; i++)
#define forn(i, n) fore(i, 0, n)
#define mod(a, b) if(a >= b) a %= b

typedef vector<int> vi;
typedef long long ll;
typedef vector<vi> vvi;
typedef vector<ll> vll;
typedef vector<vll> vvll;

int M = 1000000007;

void multiply(vvll &a, vvll &b, vvll &c){
  int n = a.size();
  forn(i, n){
    forn(j, n){
      c[i][j] = 0;
      forn(k, n){
	c[i][j] += a[i][k] * b[k][j];
	mod(c[i][j], M);
      }
    }
  }
}

void findPower(vvll &a, int p){
  if(p == 0){
    int l = a.size();
    a = vvll(l, vll(l, 0));
    forn(i, l) a[i][i] = 1;
  }
  else if(p > 1){
    if(p & 1){
      vvll ac = a, c = a;
      findPower(a, p >> 1);
      multiply(a, a, c);
      multiply(c, ac, a);
    }
    else{
      findPower(a, p >> 1);
      vvll c = a;
      multiply(c, c, a);
    }
  }
}

void createMatrixOdd(vvll &a, int m){
  if(m < 1) return;
  a[0][1] = 1;
  fore(i, 1, m - 1){
    a[i][i - 1] = 1;
    a[i][i + 1] = 1;
  }
  a[m - 1][m - 2] = 1;
}

void createMatrixEven(vvll &a, int m){
  if(m == 1) a[0][0] = 1;
  else{
    a[0][1] = a[0][0] = 1;
    fore(i, 1, m - 1){
      a[i][i - 1] = a[i][i] = a[i][i + 1] = 1;
    }
    a[m - 1][m - 2] = a[m - 1][m - 1] = 1;
  }
}

void print(vvll &a){
  cout<<endl;
  int l = a.size();
  forn(i, l){
    forn(j, l) cout<<a[i][j]<<" "; cout<<endl;
  }
  cout<<endl;
}

int main(){
  int t;
  scanf("%d", &t);
  while(t--){
    int n, m;
    scanf("%d %d", &n, &m);
    if(m == 1){
      if(n == 1) printf("1\n");
      else printf("0\n");
    }
    else{
      if(n == 1) printf("%d\n", m);
      else{
	vvll a(m, vll(m, 0));
	vvll b = a;
	vvll c = a;
	createMatrixOdd(a, m);
	createMatrixEven(b, m);
	if(n % 2 == 0)
	{
	  multiply(b, a, c);
	  findPower(c, (n - 1) >> 1);
	  vvll temp = c;
	  multiply(a, temp, c);
	}
	else{
	  multiply(a, b, c);
	  findPower(c, n >> 1);
	}

	ll sum = 0;
	forn(i, m){
	  forn(j, m){
	    sum += c[i][j];
	    mod(sum, M);
	  }
	}

	printf("%lld\n", sum);
      }
    }
  }
}
