#include <iostream>
#include <cstdio>
#include <cstdlib>
using namespace std;
const int E = 20, N = 100000+5;
int L;
int T;
int n, g1, g2, erk, p[N][E], er[N];
int LCA(int a, int b)
{
    if(er[a] < er[b])
    swap(a, b);
    for(int j = L; j >= 0; -- j)
    {
        if(er[ p[a][j] ] >= er[b])
        a = p[a][j];
    }
    if(a==b)
    return a;
    for(int j = L; j >= 0; -- j)
    {
        if(p[a][j]!=p[b][j])
        {
            a = p[a][j];
            b = p[b][j];
        }
    }
    return p[a][0];
}
int main()
{
    //freopen("input.txt", "r", stdin);
    scanf("%d", &T);
    for(int te = 1; te <= T; ++ te)
    {
        scanf("%d", &n);
        L = 0;
        while((1<<L) < n)
        ++ L;
        for(int i = 0; i <= L; ++ i)
            p[1][i] = 1;
        g1 = 1;
        g2 = 1;
        erk = 0;
        er[1] = 0;
        for(int i = 2; i <= n; ++ i)
        {
            scanf("%d", &p[i][0]);
            er[i] = er[ p[i][0] ]+1;
            for(int j = 1; j <= L; ++ j)
            p[i][j] = p[ p[i][j-1] ][ j-1 ];

            int pe, er1, er2;
            pe = LCA(i, g1);
            er1 = er[i]+er[g1]-2*er[pe];
            pe = LCA(i, g2);
          //  cout<<pe<<"] ";
            er2 = er[i]+er[g2]-2*er[pe];
           // cout<<pe<<"] \n";
            //cout<<g1<<" "<<g2<<" "<<i<<"| "<<er1<<" "<<er2<<endl;
            if(er1 > erk || er2 > erk)
            {
                if(er1 > er2)
                {
                    g2 = i;
                    erk = er1;
                }
                else
                {
                    g1 = i;
                    erk = er2;
                }
            }
            printf("%d\n", erk);
        }
    }
    return 0;
}
