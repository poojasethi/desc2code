/*when pink tuns blue*/

#include<stdio.h>
#include<string.h>
#include<ctype.h>
#include<stdlib.h>
#include<cmath>
#include<ctime>

#define FO(i,s,e,p) for( int i=(s);i<int(e);i+=p)
#define FOD(i,s,e,p) for( int i=(s);i>int(e);i-=p)


#define FOR(i,s,e) FO(i,s,e,1)
#define FORE(i,s,e) FOR(i,s,e+1)
#define FORD(i,s,e) FOD(i,s,e,1)
#define FORDE(i,s,e) FORD(i,s,e-1)

#define ALL(i,s) for(__typeof((s).begin()) i=(s).begin();i!=(s).end();i++)

#define MEM(tab,fill) memset(tab,fill,sizeof(tab))

#include<iostream>
#include<set>
#include<vector>
#include<string>
#include<sstream>
#include<stack>
#include<queue>
#include<algorithm>
#include<utility>
#include<bitset>
#include<map>
#include<cassert>
//#include<ext/hash_set>
//#include<ext/hash_map>
#define pb push_back
#define ll long long
using namespace std;
using namespace __gnu_cxx;

#define EPS 0.0000001

#define mp make_pair
#define fi first
#define se second
#define inf ((1LL<<29)-1)
#define deb(a) cout<<#a<<' '<<a<<endl
#define PI pair<ll,ll>
#define llu unsigned ll

#define AL(a) (a).begin(),(a).end()
#define PII pair<PI,PI>

#define MIN(a,b) (((a)<(b))?(a):(b))
#define MAX(a,b) (((a)>(b))?(a):(b))

int par[100100][17];
int in[100100],out[100100],cl;
vector<vector<int> > g;
void compute(int node){
    FOR(i,1,17)
        par[node][i]=par[par[node][i-1]][i-1];
    in[node]=cl++;
    ALL(i,g[node]){
        if(*i==par[node][0]) continue;
        par[*i][0]=node;
        compute(*i);
    }
    out[node]=cl++;
}
bool isup(int a,int b){
    return in[a]<=in[b] && out[a]>=out[b];
}

int getone(int a,int b){
    int ret=0;
    FORDE(i,16,0){
        if(isup(par[a][i],b)) continue;
        ret+=1<<i;
        a=par[a][i];
    }
    if(!isup(a,b)) ret++;
    return ret;
}

int getdst(int a,int b){
    return getone(a,b)+getone(b,a);
}


vector<int> tmp;
void solve(){
    MEM(par,0);cl=0;
    int n;cin>>n;

    tmp.resize(n+1);
    g.clear();g.resize(n+1);
    FORE(i,2,n){
        scanf("%d",&tmp[i]);
        g[tmp[i]].pb(i);
        g[i].pb(tmp[i]);
    }
    in[0]=cl++;
    compute(1);
    out[0]=cl++;
    if(n==1) return;

    int a=1,b=1,dst=0;
    FORE(i,2,n){
        int x=i;
        int mx1=getdst(x,a),mx2=getdst(x,b);
        dst=max(max(dst,mx1),mx2);
        if(mx1==dst) b=x;
        else if(mx2==dst) a=x;
        printf("%d\n",dst);
    }

}



int main(){
    //freopen("C:\\a","r",stdin);

    int t;cin>>t;
    while(t--) solve();


    return 0;
}
