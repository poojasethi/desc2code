#include <cstdio>
#define MAX 30
#define FOR(i,m,n) for(i=m;i<=n;i++)

using namespace std;

int smallest_factor[]={0,1,2,3,2,5,2,7,2,3,2,11,2,13,2,3,2,17,2,19,2,3,2,23,2,5,2,3,2,29,2};

int steps[]={0,0,1,1,4,1,5,1,12,6,7,1,16,1,9,8,32,1,21,1,24,10,13,1,44,10,15,27,32,1,31};

void solve(int cur,int first,int last)
{
    int i,f,tmp,temp = smallest_factor[cur];
    if(temp==cur)
    {
    printf("%i ",cur);
    FOR(i,first,last)
    printf("%i ",i);
    printf("\n");
    }
    else
    {
    tmp = cur/temp;
    for(f=first;f<first+tmp;f++)
    {
    printf("%i ",temp);
    for(i=f;i<=last;i=i+tmp)
    printf("%i ",i);
    printf("\n");
    }

    for(i=first;i<last;i=i+tmp)
    solve(tmp,i,i+tmp-1);
    }

    }

int main()
{
    int a,i,j,t,n;

    scanf("%i",&t);

    FOR(i,1,t)
    {
        scanf("%i",&n);

        FOR(j,1,n)
            scanf("%i",&a);

        printf("%i\n",steps[n]);

        solve(n,1,n);
    }

    return 0;
}
