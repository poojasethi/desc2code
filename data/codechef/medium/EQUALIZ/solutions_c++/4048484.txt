#include<stdio.h>
int main(){
	int t,n,i,p,k,prime[300],j,n1,l;
    float A[30],c;
	for(scanf("%d",&t);t>0;t--){
		scanf("%d",&n);//to know how many no. to b equalise
		for(i=0;i<n;i++) scanf("%f",&A[i]);//input n no.
		for(j=0,p=2,n1=n;p<=n;p++)	for(;!(n1%p);n1/=p,prime[j++]=p);//prime factors are stored
			for(i=0,k=0;i<j;k+=(n/prime[i]),i++); printf("%d",k);
		for(l=0,n1=prime[0];l<j;n1*=prime[++l])
		for(p=0;p<n1/prime[l];p++)
			for(k=p;k<n;k+=n1){printf("\n%d ",prime[l]);
		for(i=k,c=0;i<k+n1;i+=n1/prime[l]){c=c+A[i]; printf("%d ",i+1); }
		for(i=k;i<k+n1;i+=n1/prime[l]) A[i]=c/prime[l];}
	
			printf("\n");
		
	}
	return 0;
}