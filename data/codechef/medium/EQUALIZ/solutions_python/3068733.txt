#include<stdio.h>
int main()
{
	int n,i,t,a,K[31]={0,0,1,1,4,1,5,1,12,6,7,1,16,1,9,8,32,1,21,1,24,10,13,1,44,10,15,27,32,1,31};
	scanf("%d",&t);
	while(t--)
	{
		scanf("%d",&n);
		for(i=0;i<n;i++)
			scanf("%d",&a);
		printf("%d\n",K[n]);
		if(K[n]==1)
		{
			printf("%d ",n);
			for(i=1;i<n;i++)
				printf("%d ",i);
			printf("%d\n",n);
		}
		else if(n==4)
		{
			printf("2 1 2\n");
			printf("2 3 4\n");
			printf("2 1 3\n");
			printf("2 2 4\n");
		}
		else if(n==6)
		{
			printf("3 1 2 3\n");
			printf("3 4 5 6\n");
			printf("2 1 4\n");
			printf("2 2 5\n");
			printf("2 3 6\n");
		}
		else if(n==8)
		{
			printf("2 1 2\n");
			printf("2 3 4\n");
			printf("2 1 3\n");
			printf("2 2 4\n");
			printf("2 5 6\n");
			printf("2 7 8\n");
			printf("2 5 7\n");
			printf("2 6 8\n");
			printf("2 1 5\n");
			printf("2 2 6\n");
			printf("2 3 7\n");
			printf("2 4 8\n");
		}
		else if(n==9)
		{
			printf("3 1 2 3\n");
			printf("3 4 5 6\n");
			printf("3 7 8 9\n");
			printf("3 1 4 7\n");
			printf("3 2 5 8\n");
			printf("3 3 6 9\n");
		}
		else if(n==10)
		{
			printf("5 1 2 3 4 5\n");
			printf("5 6 7 8 9 10\n");
			printf("2 1 6\n");
			printf("2 2 7\n");
			printf("2 3 8\n");
			printf("2 4 9\n");
			printf("2 5 10\n");
		}
		else if(n==12)
		{
			printf("3 1 2 3\n");
			printf("3 4 5 6\n");
			printf("2 1 4\n");
			printf("2 2 5\n");
			printf("2 3 6\n");
			printf("3 7 8 9\n");
			printf("3 10 11 12\n");
			printf("2 7 10\n");
			printf("2 8 11\n");
			printf("2 9 12\n");
			printf("2 1 7\n");
			printf("2 2 8\n");
			printf("2 3 9\n");
			printf("2 4 10\n");
			printf("2 5 11\n");
			printf("2 6 12\n");
		}
		else if(n==14)
		{
			printf("7 1 2 3 4 5 6 7\n");
			printf("7 8 9 10 11 12 13 14\n");
			printf("2 1 8\n");
			printf("2 2 9\n");
			printf("2 3 10\n");
			printf("2 4 11\n");
			printf("2 5 12\n");
			printf("2 6 13\n");
			printf("2 7 14\n");
		}
		else if(n==15)
		{
			printf("5 1 2 3 4 5\n");
			printf("5 6 7 8 9 10\n");
			printf("5 11 12 13 14 15\n");
			printf("3 1 6 11\n");
			printf("3 2 7 12\n");
			printf("3 3 8 13\n");
			printf("3 4 9 14\n");
			printf("3 5 10 15\n");
		}
		else if(n==16)
		{
			printf("2 1 2\n");
			printf("2 3 4\n");
			printf("2 5 6\n");
			printf("2 7 8\n");
			printf("2 1 3\n");
			printf("2 2 4\n");
			printf("2 5 7\n");
			printf("2 6 8\n");
			printf("2 1 5\n");
			printf("2 2 6\n");
			printf("2 3 7\n");
			printf("2 4 8\n");
			printf("2 9 10\n");
			printf("2 11 12\n");
			printf("2 13 14\n");
			printf("2 15 16\n");
			printf("2 9 11\n");
			printf("2 10 12\n");
			printf("2 13 15\n");
			printf("2 14 16\n");
			printf("2 9 13\n");
			printf("2 10 14\n");
			printf("2 11 15\n");
			printf("2 12 16\n");
			printf("2 1 9\n");
			printf("2 2 10\n");
			printf("2 3 11\n");
			printf("2 4 12\n");
			printf("2 5 13\n");
			printf("2 6 14\n");
			printf("2 7 15\n");
			printf("2 8 16\n");
		}
		else if(n==18)
		{
			printf("3 1 2 3\n");
			printf("3 4 5 6\n");
			printf("3 7 8 9\n");
			printf("3 1 4 7\n");
			printf("3 2 5 8\n");
			printf("3 3 6 9\n");
			printf("3 10 11 12\n");
			printf("3 13 14 15\n");
			printf("3 16 17 18\n");
			printf("3 10 13 16\n");
			printf("3 11 14 17\n");
			printf("3 12 15 18\n");
			printf("2 1 10\n");
			printf("2 2 11\n");
			printf("2 3 12\n");
			printf("2 4 13\n");
			printf("2 5 14\n");
			printf("2 6 15\n");
			printf("2 7 16\n");
			printf("2 8 17\n");
			printf("2 9 18\n");
		}
		else if(n==20)
		{
			printf("5 1 2 3 4 5\n");
			printf("5 6 7 8 9 10\n");
			printf("5 11 12 13 14 15\n");
			printf("5 16 17 18 19 20\n");
			printf("2 1 6\n");
			printf("2 2 7\n");
			printf("2 3 8\n");
			printf("2 4 9\n");
			printf("2 5 10\n");
			printf("2 11 16\n");
			printf("2 12 17\n");
			printf("2 13 18\n");
			printf("2 14 19\n");
			printf("2 15 20\n");
			printf("2 1 11\n");
			printf("2 2 12\n");
			printf("2 3 13\n");
			printf("2 4 14\n");
			printf("2 5 15\n");
			printf("2 6 16\n");
			printf("2 7 17\n");
			printf("2 8 18\n");
			printf("2 9 19\n");
			printf("2 10 20\n");
		}
		else if(n==21)
		{
			printf("7 1 2 3 4 5 6 7\n");
			printf("7 8 9 10 11 12 13 14\n");
			printf("7 15 16 17 18 19 20 21\n");
			printf("3 1 8 15\n");
			printf("3 2 9 16\n");
			printf("3 3 10 17\n");
			printf("3 4 11 18\n");
			printf("3 5 12 19\n");
			printf("3 6 13 20\n");
			printf("3 7 14 21\n");
		}
		else if(n==22)
		{
			printf("11 1 2 3 4 5 6 7 8 9 10 11\n");
			printf("11 12 13 14 15 16 17 18 19 20 21 22\n");
			printf("2 1 12\n");
			printf("2 2 13\n");
			printf("2 3 14\n");
			printf("2 4 15\n");
			printf("2 5 16\n");
			printf("2 6 17\n");
			printf("2 7 18\n");
			printf("2 8 19\n");
			printf("2 9 20\n");
			printf("2 10 21\n");
			printf("2 11 22\n");
		}
		else if(n==24)
		{
			printf("2 1 2\n");
			printf("2 3 4\n");
			printf("2 5 6\n");
			printf("2 7 8\n");
			printf("2 1 3\n");
			printf("2 2 4\n");
			printf("2 5 7\n");
			printf("2 6 8\n");
			printf("2 1 5\n");
			printf("2 2 6\n");
			printf("2 3 7\n");
			printf("2 4 8\n");
			printf("2 9 10\n");
			printf("2 11 12\n");
			printf("2 13 14\n");
			printf("2 15 16\n");
			printf("2 9 11\n");
			printf("2 10 12\n");
			printf("2 13 15\n");
			printf("2 14 16\n");
			printf("2 9 13\n");
			printf("2 10 14\n");
			printf("2 11 15\n");
			printf("2 12 16\n");
			printf("2 17 18\n");
			printf("2 19 20\n");
			printf("2 21 22\n");
			printf("2 23 24\n");
			printf("2 17 19\n");
			printf("2 18 20\n");
			printf("2 21 23\n");
			printf("2 22 24\n");
			printf("2 17 21\n");
			printf("2 18 22\n");
			printf("2 19 23\n");
			printf("2 20 24\n");
			printf("3 1 9 17\n");
			printf("3 2 10 18\n");
			printf("3 3 11 19\n");
			printf("3 4 12 20\n");
			printf("3 5 13 21\n");
			printf("3 6 14 22\n");
			printf("3 7 15 23\n");
			printf("3 8 16 24\n");
		}
		else if(n==25)
		{
			printf("5 1 2 3 4 5\n");
			printf("5 6 7 8 9 10\n");
			printf("5 11 12 13 14 15\n");
			printf("5 16 17 18 19 20\n");
			printf("5 21 22 23 24 25\n");
			printf("5 1 6 11 16 21\n");
			printf("5 2 7 12 17 22\n");
			printf("5 3 8 13 18 23\n");
			printf("5 4 9 14 19 24\n");
			printf("5 5 10 15 20 25\n");
		}
		else if(n==26)
		{
			printf("13 1 2 3 4 5 6 7 8 9 10 11 12 13\n");
			printf("13 14 15 16 17 18 19 20 21 22 23 24 25 26\n");
			printf("2 1 14\n");
			printf("2 2 15\n");
			printf("2 3 16\n");
			printf("2 4 17\n");
			printf("2 5 18\n");
			printf("2 6 19\n");
			printf("2 7 20\n");
			printf("2 8 21\n");
			printf("2 9 22\n");
			printf("2 10 23\n");
			printf("2 11 24\n");
			printf("2 12 25\n");
			printf("2 13 26\n");
		}
		else if(n==27)
		{
			printf("3 1 2 3\n");
			printf("3 4 5 6\n");
			printf("3 7 8 9\n");
			printf("3 1 4 7\n");
			printf("3 2 5 8\n");
			printf("3 3 6 9\n");
			printf("3 10 11 12\n");
			printf("3 13 14 15\n");
			printf("3 16 17 18\n");
			printf("3 10 13 16\n");
			printf("3 11 14 17\n");
			printf("3 12 15 18\n");
			printf("3 19 20 21\n");
			printf("3 22 23 24\n");
			printf("3 25 26 27\n");
			printf("3 19 22 25\n");
			printf("3 20 23 26\n");
			printf("3 21 24 27\n");
			printf("3 1 10 19\n");
			printf("3 2 11 20\n");
			printf("3 3 12 21\n");
			printf("3 4 13 22\n");
			printf("3 5 14 23\n");
			printf("3 6 15 24\n");
			printf("3 7 16 25\n");
			printf("3 8 17 26\n");
			printf("3 9 18 27\n");
		}
		else if(n==28)
		{
			printf("7 1 2 3 4 5 6 7\n");
			printf("7 8 9 10 11 12 13 14\n");
			printf("2 1 8\n");
			printf("2 2 9\n");
			printf("2 3 10\n");
			printf("2 4 11\n");
			printf("2 5 12\n");
			printf("2 6 13\n");
			printf("2 7 14\n");
			printf("7 15 16 17 18 19 20 21\n");
			printf("7 22 23 24 25 26 27 28\n");
			printf("2 15 22\n");
			printf("2 16 23\n");
			printf("2 17 24\n");
			printf("2 18 25\n");
			printf("2 19 26\n");
			printf("2 20 27\n");
			printf("2 21 28\n");
			printf("2 1 15\n");
			printf("2 2 16\n");
			printf("2 3 17\n");
			printf("2 4 18\n");
			printf("2 5 19\n");
			printf("2 6 20\n");
			printf("2 7 21\n");
			printf("2 8 22\n");
			printf("2 9 23\n");
			printf("2 10 24\n");
			printf("2 11 25\n");
			printf("2 12 26\n");
			printf("2 13 27\n");
			printf("2 14 28\n");
		}
		else if(n==30)
		{
			printf("5 1 2 3 4 5\n");
			printf("5 6 7 8 9 10\n");
			printf("2 1 6\n");
			printf("2 2 7\n");
			printf("2 3 8\n");
			printf("2 4 9\n");
			printf("2 5 10\n");
			printf("5 11 12 13 14 15\n");
			printf("5 16 17 18 19 20\n");
			printf("2 11 16\n");
			printf("2 12 17\n");
			printf("2 13 18\n");
			printf("2 14 19\n");
			printf("2 15 20\n");
			printf("5 21 22 23 24 25\n");
			printf("5 26 27 28 29 30\n");
			printf("2 21 26\n");
			printf("2 22 27\n");
			printf("2 23 28\n");
			printf("2 24 29\n");
			printf("2 25 30\n");
			printf("3 1 11 21\n");
			printf("3 2 12 22\n");
			printf("3 3 13 23\n");
			printf("3 4 14 24\n");
			printf("3 5 15 25\n");
			printf("3 6 16 26\n");
			printf("3 7 17 27\n");
			printf("3 8 18 28\n");
			printf("3 9 19 29\n");
			printf("3 10 20 30\n");
		}
	}
	return 0;
}
