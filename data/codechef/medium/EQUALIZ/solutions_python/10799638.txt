#include<iostream>
#include<vector>

using namespace std;

int main()
{
	int t;
	cin>>t;
	while(t)
	{
		int n;
		cin>>n;
		float a[n];
		int i;
		for(i=0;i<n;i++)
		{
			cin>>a[i];
		}
		int m=n;
		vector<int> primes;
		i=2;
		while(m!=1)
		{
			if(m%i==0)
			{
				primes.push_back(i);
				m=m/i;
				continue;
			}
			i++;
		}
	
		int count=0;
		for(i=0;i<primes.size();i++)
		{
			int x=n/primes[i];
			count+=x;
		}
		cout<<count<<endl;
		int bundle_size=1;
		int bundles=n;
		 m=n;
		 int inter=1;
	 	int inter2;
		for(i=0;i<primes.size();i++)
		{
			int it=m/primes[i];
			inter2=inter;
			inter*=primes[i];
			int j;
		
			for(j=0;j<n;j+=inter)
			{
				int k;
				for(k=j;k<j+inter2;k++)
				{
					cout<<primes[i]<<" ";
					float sum=0;
					int l;
					for(l=k;l<k+inter;l+=inter2)
					{
						cout<<l+1<<" ";
						sum+=a[l];
					}
					float avg=sum/primes[i];
					for(l=k;l<k+inter;l+=inter2)
					{
						a[l]=avg;
					}
					cout<<endl;
				
				
				
				}
			
			}
		
		}
		
		t--;
	}
	
	return 0;
}