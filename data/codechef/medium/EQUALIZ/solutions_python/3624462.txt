#include<stdio.h>
int main()
{
    int arry[31],arre[25],T,N,i,j,k,s=0,tmp,diff,start,count,loop,total,arr[31][6]={{0,0,0,0,0,0},
                            {0,0,0,0,0,0},
                            {1,1,2,0,0,0},
                            {1,1,3,0,0,0},
                            {2,1,2,2,0,0},
                            {1,1,5,0,0,0},
                            {2,1,3,2,0,0},
                            {1,1,7,0,0,0},
                            {3,1,2,2,2,0},
                            {2,1,3,3,0,0},
                            {2,1,5,2,0,0},
                            {1,1,11,0,0,0},
                            {3,1,3,2,2,0},
                            {1,1,13,0,0,0},
                            {2,1,7,2,0,0},
                            {2,1,5,3,0,0},
                            {4,1,2,2,2,2},
                            {1,1,17,0,0,0},
                            {3,1,3,3,2,0},
                            {1,1,19,0,0,0},
                            {3,1,5,2,2,0},
                            {2,1,7,3,0,0},
                            {2,1,11,2,0,0},
                            {1,1,23,0,0,0},
                            {4,1,3,2,2,2},
                            {2,1,5,5,0,0},
                            {2,1,13,2,0,0},
                            {3,1,3,3,3,0},
                            {3,1,7,2,2,0},
                            {1,1,29,0,0,0},
                            {3,1,5,3,2,0}};

    scanf("%d",&T);
    loop=T;
    while(loop--)
    {
        scanf("%d",&N);
        arre[s++]=N;
        for(i=0;i<N;i++)
            scanf("%d",&arry[i]);
    }
    s=0;
    while(T--)
    {
        N=arre[s++];
        total=0;
        for(i=1;i<=arr[N][0];i++)
            total+=N/arr[N][i+1];
        printf("%d\n",total);
        diff=arr[N][1];
        k=2;
        loop=arr[N][0];
        while(loop--)
        {
            start=1;
            tmp=start;
            count=0;
            for(i=1;i<=N/arr[N][k];i++)
            {
                printf("%d ",arr[N][k]);
                for(j=1;j<=arr[N][k];j++)
                {
                    printf("%d ",tmp);
                    tmp+=diff;
                    count++;
                }
                if(count==diff*arr[N][k])
                {
                    start=(tmp-diff)+1;
                    count=0;
                }
                else
                    start++;
                tmp=start;
                printf("\n");
            }
            diff=diff*arr[N][k];
            k++;
        }
    }
    return 0;
}
