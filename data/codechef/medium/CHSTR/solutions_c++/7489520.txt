#include <bits/stdc++.h>
using namespace std;
 
#define gc getchar
#define pb push_back
#define mp make_pair
#define ff first
#define ss second
#define ll long long
#define MOD 1000000007
#define INF 2000000000
#define oo (ll)1e18
#define TRACE
#define _ ios_base::sync_with_stdio(0);cin.tie(0); 
 
#ifdef TRACE
 #define trace(x)            cerr<<x<<endl;
    #define trace1(x)           cerr<<__FUNCTION__<<":"<<__LINE__<<": "#x" = "<<x<<endl;
    #define trace2(x,y)         cerr<<__FUNCTION__<<":"<<__LINE__<<": "#x" = "<<x<<" | "#y" = "<<y<<endl;
    #define trace3(x,y,z)       cerr<<__FUNCTION__<<":"<<__LINE__<<": "#x" = "<<x<<" | "#y" = "<<y<<" | "#z" = "<<z<<endl;
    #define trace4(a,b,c,d)     cerr<<__FUNCTION__<<":"<<__LINE__<<": "#a" = "<<a<<" | "#b" = "<<b<<" | "#c" = "<<c<<" | "#d" = "<<d<<endl;
    #define trace5(a,b,c,d,e)   cerr<<__FUNCTION__<<":"<<__LINE__<<": "#a" = "<<a<<" | "#b" = "<<b<<" | "#c" = "<<c<<" | "#d" = "<<d<<" | "#e" = "<<e<<endl;
    #define trace6(a,b,c,d,e,f) cerr<<__FUNCTION__<<":"<<__LINE__<<": "#a" = "<<a<<" | "#b" = "<<b<<" | "#c" = "<<c<<" | "#d" = "<<d<<" | "#e" = "<<e<<" | "#f" = "<<f<<endl;
 
#else
 
#define trace1(x)
#define trace2(x, y)
#define trace3(x, y, z)
#define trace4(a, b, c, d)
#define trace5(a, b, c, d, e)
#define trace6(a, b, c, d, e, f)
 
#endif
  
typedef pair<ll,ll> pll;
typedef pair<int,int> pii;

void scan(int &x)
{
    register int c = gc();
    x = 0;
    int neg = 0;
    for(;((c<48 || c>57) && c != '-');c = gc());
    if(c=='-') {neg=1;c=gc();}
    if(neg) x=-x;
}
const int M=5005;
int ncr[M][M],z[M];
string s;
void zfunc(){
	int l=0,r=0,n=s.length();
	z[0]=s.length();
	for(int i=1;i<n;i++){
		z[i]=0;
		if(i<=r)
		z[i]=min(z[i-l],r-i+1);
		while(i+z[i]<n&&s[i+z[i]]==s[z[i]])
		z[i]++;
		if(i+z[i]-1>r)
		l=i,r=i+z[i]-1;
	}
}
int main(){
    //freopen("inp.txt","r",stdin);
    //freopen("out.txt","w",stdout);
    int t,n,q;
    for(int i=0;i<M;i++)
    ncr[i][i]=1,ncr[i][0]=1;
    for(int i=2;i<M;i++){
		for(int j=1;j<i;j++){
			ncr[i][j]=ncr[i-1][j-1]+ncr[i-1][j];
			if(ncr[i][j]>=MOD)
			ncr[i][j]%=MOD;
		}
	}
    scanf("%d",&t);
    while(t--){
		scanf("%d%d",&n,&q);
		int ct[n+5],tmp[n+5],ans[n+5],ns[n+5],m=n;
		memset(ct,0,sizeof ct);
		cin>>s;
		for(int i=0;i<n;i++){
			memset(tmp,0,sizeof tmp);
			zfunc();
			for(int i=0;i<(int)s.length();i++)
			tmp[z[i]]++;
			for(int i=m-1;i>=1;i--)
			tmp[i]+=tmp[i+1];
			for(int i=1;i<=m;i++)
			ct[tmp[i]]++;
			/*cout<<s<<endl;
			for(int i=1;i<=n;i++)
			trace2(i,ct[i]);*/
			m--;
			s.erase(s.begin(),s.begin()+1);
		}
		ans[n]=ct[n];
		for(int i=n-1;i>=1;i--)
		ans[i]=ct[i]-ct[i+1];
		for(int i=1;i<=n;i++){
			ns[i]=0;
			for(int j=i;j<=n;j++){
				ll x=ncr[j][i];
				x=x*ans[j]+ns[i];
				if(x>=MOD)
				x%=MOD;
				ns[i]=x;
				//trace5(i,j,ncr[j][i],ans[j],ns[i]);
			}
		}
		
		int k;
		while(q--){
			scanf("%d",&k);
			if(k>n)
			puts("0\n");
			else
			printf("%d\n",ns[k]);
		}
	}
    return 0;
}
