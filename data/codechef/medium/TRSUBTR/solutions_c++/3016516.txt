#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include <algorithm>
#include <vector>
#include <string.h>
using namespace std;

typedef long long ll;
const ll md=1234567;
int age[200200];
int lc[200200];
int rc[200200];
bool p[200200];
ll t1[200200];
ll t2[200200];

int read(){
	memset(t1,0,sizeof(t1));
	int n=0;scanf("%d",&n);
	
	for(int i=1;i<=n;i++){
		scanf("%d",&age[i]);
		lc[i]=-1;rc[i]=-1;p[i]=false;
	}
	
	for(int i=1;i<=n-1;i++){
		int a=0,b=0;char c=' ';
		scanf("%d %d %c",&a,&b,&c);
		if(c=='M')lc[a]=b;
		else rc[a]=b;
		p[b]=true;
	}
	
	return n;
}

ll go(int i){
	if(i==-1) return 0;
	else{
		t1[i]=(ll)age[i]+md*go(lc[i])+md*md*go(rc[i]);
		return t1[i];
	}
}

int main(){
	int n=read();
	for(int i=1;i<=n;i++){
		if(!p[i])go(i);
	}
	for(int i=1;i<=n;i++)t2[i]=t1[i];
	sort(t2+1,t2+n+1);
	
	int m=0;scanf("%d",&m);
	for(int i=1;i<=m;i++){
		int x=read();
		for(int i=1;i<=x;i++){
			if(!p[i])go(i);
			if(binary_search(t2+1,t2+n+1,t1[i])){
				cout<<"YES"<<endl;
				break;
			}
			else{
				cout<<"NO"<<endl;
				break;
			}
		}
	}
}
