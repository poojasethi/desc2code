#include<bits/stdc++.h>
using namespace std;
#define lld long long int
#define gc getchar_unlocked
inline int read()
{
    int x;
    register int c = gc();
    x = 0;
    int neg = 0;
    for(;((c<48 || c>57) && c != '-');c = gc());
    if(c=='-') {neg=1;c=gc();}
    for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
    if(neg) x=-x;
    return x;
}

int root(int ar[],int x)
{
  if(x!=ar[x])
    ar[x]= root(ar,ar[x]);
return ar[x];
    
}

int main()
{
	

    int t,i;
    scanf("%d",&t);
    while(t--)
    {
    	int n;
        scanf("%d",&n);
        int ar[10001];
        int  size[10001];
    	int s[n+1];
    	for(i=1;i<=n;i++)
    		{
    		ar[i]=i;size[i]=1;
    		scanf("%d",&s[i]);
    		}
    	int m;
    	scanf("%d",&m);
    	while(m--)
    	{
    		int a,b,c;
    		//scanf("%d",&a);
            a=read();
    		if(a==0)
    		{
             //scanf("%d %d",&b,&c);
             b=read();c=read();
             int x=root(ar,b);
             int y=root(ar,c);
             if(x==y)
             	{cout<<"Invalid query!"<<endl;continue;}
             if(s[x]>s[y])
             {
             	size[x]+=size[y];
             	ar[y]=x;
             }
             else if(s[x]<s[y])
             {
             	size[y]+=size[x];
             	ar[x]=y;
             }
    		}

    		else
    		{
             //scanf("%d",&a);
             a=read();
             int x=root(ar,a);
             cout<<x<<endl;
    		}

    	}

    	 
    }
	return 0;
}