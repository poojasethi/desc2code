    #include<bits/stdc++.h>
    #define ll long long
    using namespace std;
     
    ll root(ll chef[],ll i)
    {
        while(chef[i]!=i)
        {
            chef[i]=chef[chef[i]];
            i=chef[i];
        }
        return i;
    }
     
    void Union(ll score[],ll chef[],ll x,ll y)
    {
        ll root_x=root(chef,x);
        ll root_y=root(chef,y);
        if(root_x==root_y)
            printf("Invalid query!\n");
        else
        {
            if(score[root_x] > score[root_y])
            {
                chef[root_y]=chef[root_x];
            }
            else
            {
                if(score[root_x] < score[root_y])
                {
                    chef[root_x]=chef[root_y];
                }
            }
        }
    }
    int main(void)
    {
        ll t,n,*score,*chef,q,x,y,type;
        scanf("%lld",&t);
        while(t--)
        {
            scanf("%lld",&n);
            ll score[n+1];
            ll chef[n+1];
            for(ll i=1;i<=n;i++)
            {
                scanf("%lld",&score[i]);
                chef[i]=i;
            }
            scanf("%lld",&q);
            while(q--)
            {
                scanf("%lld",&type);
                if(type==0)
                {
                    scanf("%lld %lld",&x,&y);
                    Union(score,chef,x,y);
                }
                else
                {
                    scanf("%lld",&x);
                    printf("%lld\n",root(chef,x));
                }
            }
        }
            return 0;
    } 