	#include<iostream>
	#include<stdio.h>
	
	#define get getchar_unlocked
	#define put putchar_unlocked
 	using namespace std;

	inline int inp()
	{
	
	int n=0, c=get(),f=1;
	while(c!='-'&&(c<'0'||c>'9')) c=get();
	if(c=='-'){f=-1;c=get();}
	 
	while(c>='0'&&c<='9'){n=(n<<3)+(n<<1)+c-'0',c=get();}
	return n*f;
	 
	}
	void op(int n)
	{
		if(n<0){n=-n;put('-');}
 
		int i=10; char output_buf[11];
		output_buf[10]='\n';
	 
		do{output_buf[--i]=(n%10)+'0'; n=n/10;}
		while(n);
	 
		while(i<11){put(output_buf[i]);i=i+1;}
	 
	}

	int main()
	{

		int t;
		cin>>t;
		while(t>0)
		{
			int n;
			n=inp();
			int a[2][100005];
			for(int i=1;i<=n;i++)
			{
				a[0][i]=inp();
				a[1][i]=i;
			}	

			int q;
			q=inp();
			
			for(int i=0;i<q;i++)
			{

				int num1,num2,num3;
				num1=inp();
				if(num1==0)
				{
					num2=inp();
					num3=inp();
					int parentnum2,parentnum3;
					parentnum2=a[1][num2];
					
					while(parentnum2!=a[1][parentnum2])
					{
						parentnum2=a[1][parentnum2];
					}	
					a[1][num2]=parentnum2;

					parentnum3=a[1][num3];
					
					while(parentnum3!=a[1][parentnum3])
					{
						parentnum3=a[1][parentnum3];	
					}	
					a[1][num3]=parentnum3;
					
					if(parentnum3==parentnum2)
					{
						printf("Invalid query!\n");
					}	
					else if(a[0][parentnum2]>a[0][parentnum3])
						a[1][parentnum3]=parentnum2;
					else if(a[0][parentnum2]<a[0][parentnum3])
						a[1][parentnum2]=parentnum3;
				}	
				else
				{
					scanf("%d",&num2);
					int parent=a[1][num2];
					while(parent!=a[1][parent])
						parent=a[1][parent];
					op(parent);
				}	
			}	
			t--;
		}	
	}