// DishOwner.cpp : Defines the entry point for the console application.
//

#include <cstdio>
#include <iostream>
using namespace std;

int score[10005], parent[10005];

int findParent(int x)
{
	return ((x == parent[x])?(x):(parent[x] = findParent(parent[x])));
}

void compete(int x, int y)
{
	int px = findParent(x);
	int py = findParent(y);

	if(px == py)
	{
		printf("Invalid query!\n");
		return;
	}

	if(score[px] == score[py])
	{
		return;
	}

	if(score[px] < score[py])
	{
		parent[px] = py;
	}
	else
	{
		parent[py] = px;
	}
}


int main()
{
	int t;
	scanf("%d", &t);
	while(t--)
	{
		int n;
		scanf("%d", &n);
		for(int i=1; i<=n; i++)
		{
			cin>>score[i];
			parent[i] = i;
		}
		int q;
		scanf("%d", &q);
		while(q--)
		{
			int type;
			scanf("%d", &type);
			if(type)
			{
				int x;
				scanf("%d", &x);
				printf("%d\n", findParent(x));
			}
			else
			{
				int x, y;
				scanf("%d%d", &x, &y);
				compete(x, y);
			}
		}
	}
	return 0;
}

