#include <stdio.h>
#include <stdlib.h>

using namespace std;

int input()
{
    int n=0;
    char c=getchar_unlocked();
    while(c < '0' || c >'9') {c=getchar_unlocked();}
    while(c>='0' && c<='9')
    {
        n=(n<<3)+(n<<1)+c-'0';
        c=getchar_unlocked();
    }
    return n;
}

int main(){
	int T, N, num;
	int* S;
	int dec;
	int* holders;
	int x, y, Q, temp;
	T = input();
	while(T--){
		N = input();
		holders = new int[N];
		S = new int[N];
		for(int i = 0; i < N; i++){
			S[i] = input();
			holders[i] = i;
		}
		Q = input();
		while(Q--){
			dec = input();
			x = input();
			x--;
			temp = x;
			while(x != holders[x]){
				x = holders[x];
			}
			holders[temp] = x;				
			if(dec == 0){
				y = input();
				y--;
				temp = y;
				while(y != holders[y]){
					y = holders[y];
				}
				holders[temp] = y;
				if(x == y){
					printf("Invalid query!\n");
					continue;
				}
				if(S[x] > S[y]){
					holders[y] = x;
				}
				else if(S[x] < S[y]){
					holders[x] = y;
				}
			}
			else{
				printf("%d\n", x+1);
			}
		}
		delete(S);
		delete(holders);
	}
}
