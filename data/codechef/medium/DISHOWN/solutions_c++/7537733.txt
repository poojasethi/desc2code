#include <bits/stdc++.h>
 using namespace std;

int pset[10010];
int s[1000010];
void iniset(int n){ for(int i=0 ; i<n ; i++) pset[i] = i;}
int findset(int a){ return a==pset[a] ? a : pset[a] = findset(pset[a]);}
void unionset(int a, int b){ pset[findset(a)] = findset(b); }
int main(){
	int t; scanf("%d",&t);
	while(t--){
		int n; scanf("%d",&n);
		iniset(n+1);
		for(int i=0 ; i<n ; i++) scanf("%d",&s[i+1]);
		int qe; scanf("%d",&qe);
		for(int i=0 ; i<qe ; i++){
			int c; scanf("%d",&c);
			if(c){
				int a; scanf("%d",&a);
				printf("%d\n",findset(a));
			}
			else{
				int a,b; scanf("%d%d",&a, &b);
				int p = findset(a);
				int q = findset(b);
				if(p == q)
					printf( "Invalid query!\n");
				else if(s[p]>s[q]) pset[q] = p;
				else if(s[p]<s[q]) pset[p] = q;
			}
		}
		
	}
	return 0;
}