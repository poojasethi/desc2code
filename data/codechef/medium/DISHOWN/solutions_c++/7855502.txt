
#include<bits/stdc++.h>

using namespace std;

#define si(x) scanf("%d",&x)
#define pri(x) printf("%d",x)
#define sll(x) scanf("%lld",&x)
#define pll(x) printf("%lld",x)
#define sstr(s) scanf("%s",s)
#define pstr(s) printf("%s",s)
#define nl printf("\n")
#define ll long long int
int s[10005],p[10005],n;

int parent(int x) {
    if(x!=p[x]) {
	p[x]=parent(p[x]);
    }
    return p[x];
}

void un(int src, int dest) {
    int psrc=parent(src);
    int pdest=parent(dest);
    p[psrc]=pdest;
}
int main()
{
    int t;
    si(t);
    while(t--) {
	int q,type,x,y;
	memset(s,0,sizeof(s));
	memset(p,0,sizeof(p));
	si(n);
	for(int i=1;i<=n;++i) {
	    p[i]=i;
	    si(s[i]);
	}
	si(q);
	while(q--) {
	    si(type);
	    if(type==0) {
		si(x); si(y);
		int px=parent(x);
		int py=parent(y);
		if(px==py) {
		    printf("Invalid query!"); nl;
		    continue;
		}
		else {
		    if(s[px] > s[py]) {
			un(py,px);
		    }
		    else if(s[p[x]] < s[p[y]]) {
			un(px,py);
		    }
		}
	    }
	    else if(type==1) {
		si(x);
		pri(parent(x)); nl;
	    }
	}
    }
    return 0;
}
