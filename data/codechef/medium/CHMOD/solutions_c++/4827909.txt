//
//  chmod.cpp
//
//  http://www.codechef.com/problems/CHMOD
//  Created by Rohan Rathod on 9/14/14.
//
//

#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <stack>
#include <queue>
#include <cmath>
using namespace std;

typedef unsigned long long int uli;

int prime[]={2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89,97};
int number[100001];
int n;
int frequency[101][25];
int cumfrequence[100001][25];    // cumulative frequency

void print()  // print
{
    for(int i=0;i<n;i++)
    {
        for(int j=0;j<25;j++)
        {
            printf("%d",frequency[i][j]);
        }
        printf("\n");
    }
    printf("\n\n");
}

void set()     // to assign pre value to all
{
    for(int i=0;i<n;i++)
    {
        for(int j=0;j<25;j++)
        {
            frequency[i][j]=0;
        }
    }
    
    for(int i=0;i<n;i++)
    {
        for(int j=0;j<25;j++)
        {
            cumfrequence[i][j]=0;
        }
    }
    
    for(int i=1;i<=100;i++)
    {
        int k=i;
        int j=0;
        while(k>=prime[j])
        {
            if(k%prime[j]==0)
            {
                k=k/prime[j];
                frequency[i][j]++;
            }
            else
            {
                j++;
            }
        }
    }
}

void inialize()
{
    for(int i=1;i<=n;i++)
    {
        for(int j=0;j<25;j++)
        {
            cumfrequence[i][j]=cumfrequence[i-1][j]+frequency[number[i]][j];
        }
    }
}

uli multiply(uli a,uli b,uli modulo)
{
    if(b==0)
        return 1% modulo;
    uli ans=1;
    uli x=a;
    
    while(b>0)
    {
        if(b&1)
            ans=(ans*x)%modulo;
        b>>=1;
        x=(x*x)% modulo;
    }
    return ans;
}

void compute(int left,int right, int modulo)
{
    uli ans=1;
    for(int j=0;j<25;j++)
    {
        int count=cumfrequence[right][j]-cumfrequence[left-1][j];
        uli answer=1;
        if(count!=0)
            answer=multiply(prime[j]%modulo,count,modulo);
        ans=(ans*answer)%modulo;
        if(ans==0)
            break;
        
    }
    printf("%llu\n",ans%modulo);
}

int main(void)
{
    set();
    scanf("%d",&n);
    for(int i=1;i<=n;i++)
        scanf("%d",number+i);
    inialize();
    
    int t;
    scanf("%d",&t);
    for(int i=0;i<t;i++)
    {
        int left,right,modulo;
        scanf("%d %d %d",&left,&right,&modulo);
        compute(left,right,modulo);
    }
}