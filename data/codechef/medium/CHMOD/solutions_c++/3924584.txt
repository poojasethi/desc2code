#include <iostream>
#include<cstdio>
using namespace std;
#define LL long long
#define ll long long
#define cin(x) scanf("%d",&x);
inline LL bigmod(LL a, LL b, LL m)
{
	if(b == 0) return 1 % m;

	LL x = a, ans = 1;

	while(b)
	{
		if(b&1) ans = (ans * x)%m;
		b >>= 1;
		x = (x*x)%m;
	}
	
	return ans;
}
int prime[]={2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97};
int fac_tab[102][26];
int power[100006][26];
int main() {
	
for(int i=2;i<101;i++){
	int k=i;
	for(int j=0;j<25;j++){
		int cnt=0,tmp=prime[j];
		while(k%tmp==0)
			cnt++,k/=tmp;
		fac_tab[i][j]=cnt;
		if(k==1)
			break;
	}
	
}
int n,in[100005];
cin(n);
for(int i=1;i<=n;i++)
	cin(in[i]);

for(int i=1;i<=n;i++){
	int k=in[i];
	for(int j=0;j<25;j++){
		
		power[i][j]=power[i-1][j]+fac_tab[k][j];
	}
	
}
int t;
cin(t);
while(t--){
	int l,r,m;
	cin(l);cin(r);cin(m);
	ll ans=1;
	for(int j=0;j<25;j++){
		int tmp=power[r][j]-power[l-1][j];
		ans=(ans*bigmod(prime[j],tmp,m))%m;
		if(ans==0)
			break;
	
	}
	
cout<<ans<<endl;
}

	return 0;
}