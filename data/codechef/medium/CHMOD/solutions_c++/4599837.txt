#include<bits/stdc++.h>

using namespace std;
 
#define FOR(i,a,b) for(int i=a;i<b;i++)
#define For(i,a,b) for(int i=a-1;i>=0;i--)
#define K 10000000
#define L 400
#define ll long long
#define s1(a) scanf("%d",&a);
#define s2(a) scanf("%lld",&a);
#define s3(a,b) scanf("%d%d",&a,&b);
#define s4(a,b,c) scanf("%d%d%d",&a,&b,&c);
#define pb push_back
#define mp make_pair
#define F first
#define S second 

/*******************************MAIN CODE STARTS*******************************/

int n,a[100010],t,r,l;
int v[25][100010];
int p[]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};
ll m;

ll fast_exp(ll base, int exp) {
    ll res=1;
    while(exp>0) {
       if(exp%2==1) res=(res*base)%m;
       base=(base*base)%m;
       exp/=2;
    }
    return res%m;
}

void out();

void scan()
{
	s1(n)
	FOR(i,0,n)
		s1(a[i]);
	FOR(i,0,25)
	{
		v[i][0]=0;
	}
	FOR(i,1,n+1)
	{
		FOR(j,0,25)
		{
			v[j][i]=v[j][i-1];
		}
		FOR(j,0,25)
		{
			while(a[i-1]%p[j]==0)
			{
				++v[j][i];
				a[i-1]=a[i-1]/p[j];
			}
		}
		//cout<<'Y';
	}
	int t;
	//cout<<'Y';
	s1(t)
	FOR(i,0,t)
	{
		s3(l,r)
		s2(m)
		out();
	}
}

inline void out()
{
	ll ans=1;
	//cout<<'Y';
	FOR(i,0,25)
	{
		if(v[i][r]!=v[i][l-1])
		{
			ans=(ans*((fast_exp(p[i],(v[i][r]-v[i][l-1])))))%m;
		}
		//cout<<ans<<'\n';
	}
	cout<<ans%m<<'\n';	
}

int main()
{
	scan();
	//out();
	return 0;
}