#include<stdio.h>

long long int pow_module(long long int base,long long int exp,int MOD)
{
long long int res = 1;
while(exp>0){
if(exp&1)res =(res*base)%MOD;
base=(base*base)%MOD;
exp>>=1;
}
return res;
}
long long int prime[25]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};
   long long int PF[100005][25];

int main()
{
    long long int arr,result,temp;

    int l,r,m,t,i,j,n;
    scanf("%d",&n);
    for(i=1;i<=n;i++){
        scanf("%lld",&arr);
    for(j=0;j<25&&arr>1;j++){
        temp=0;
        while(arr%prime[j]==0){
        temp++;
        arr = arr/prime[j];
        }
        PF[i][j]= PF[i-1][j] + temp;
      }
      for(;j<25;j++)
        PF[i][j] = PF[i-1][j];
    }
   // for(i=0;i<=5;i++){
    // for(j=0;j<25;j++)
     //printf("%d ",PF[i][j]);
   // printf("\n");
    //}
    scanf("%d",&t);
    while(t--)
    {   result=1;
        scanf("%d%d%d",&l,&r,&m);
        for(i=0;i<25;i++){
             temp = PF[r][i] - PF[l-1][i];
             result = (result * pow_module(prime[i],temp,m))%m;
        }

        printf("%lld\n",result);
    }
    return 0;
}
