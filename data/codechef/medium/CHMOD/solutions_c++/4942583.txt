#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<math.h>
#define MAX5 100001
using namespace std;
int arr[MAX5][25];
int prime[]={2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97};
int sum[25],temp;
int mod;
long long int power(int x,int n)

{

	long long int t1;

	if(n==0)

		return 1;

	else if(n==1)

		return x%mod;

	else

	{

		t1=power(x,n/2);

		t1=t1*t1;

		if(t1>=mod)

			t1=t1%mod;

		
		if(n%2)

			t1=x*t1;

		if(t1>=mod)

			t1=t1%mod;

		return t1;

	}

}

 

int main()

{

	int t,n,i,j,k,t1;

	long long int ans;

    for(i=0;i<100005;i++)

	{

	for(j=0;j<25;j++)
			arr[i][j]=0;

	}

	scanf("%d",&n);

	for(i=1;i<=n;i++)

	{

	scanf("%d",&temp);

		for(j=0;j<25;j++)

			arr[i][j]=arr[i-1][j];

		for(j=0;j<25;j++)

		{

			if(temp==1 || temp==0)

				break;

			else if(temp%prime[j]==0)

			{
				temp=temp/prime[j];

				arr[i][j]++;

				j--;

			}
		}

	}

	scanf("%d",&t);


	while(t--)

	{

			scanf("%d",&i);
	scanf("%d",&j);
	scanf("%d",&mod);


		
		ans=1;

		for(k=0;k<25;k++)
		{

			sum[k]=(arr[j][k]-arr[i-1][k]);

			if(sum[k]>0)

			{

				ans*=power(prime[k],sum[k]);

				if(ans>mod)

					ans=ans%mod;

				else if(ans==mod)

				{

					ans=0; break;

				}

			}

		}

		if(ans>=mod)

			ans=ans%mod;

	printf("%lld\n",ans);

	}

	return 0;

} 

