#include<stdio.h>
#include<iostream>
#include<cmath>
using namespace std;

int a[100000];
int P[100000][25];

long long int power(int a,int b,long int m)
{
    if(b==0)
    return 1LL;
    else if(b%2)
    {
        long long int v=power(a,b/2,m);
        v=(v*v)%m;
        v=(a*v)%m;
        return v;
    }
    else
    {
        long long int v=power(a,b/2,m);
        v=(v*v)%m;
        return v;
    }
}

int count(int n,int m)
{
    if(n%m==0)
    {
        int c=0;

        while(n%m==0)
        {
            c++;
            n=n/m;
        }

        return c;
    }

    return 0;
}

int main()
{
    int p[]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};

    long int n,l,r,i,j,t,m;
    scanf("%ld",&n);

    for(i=0;i<25;i++)
        for(j=0;j<n;j++)
        P[i][j]=0;

    scanf("%d",&a[0]);
    for(j=0;j<25;j++)
    P[0][j]=count(a[0],p[j]);

    for(i=1;i<n;i++)
    {
        scanf("%d",&a[i]);
        for(j=0;j<25;j++)
        P[i][j]=P[i-1][j]+count(a[i],p[j]);
    }

    /*for(j=0;j<25;j++)
    {
        for(i=0;i<n;i++)
        printf("%d ",P[j][i]);
        printf("\n");
    }*/

    scanf("%ld",&t);

    while(t--)
    {
        scanf("%ld%ld%ld",&l,&r,&m);

        long long int res=1;

        for(i=0;i<25;i++)
        {
            int x;
            if(l>1)
            x=P[r-1][i]-P[l-2][i];
            else x=P[r-1][i];

            long long int v=power(p[i],x,m);
            res=(res*v)%m;
        }
        printf("%lld\n",res);
    }

    return 0;
}
