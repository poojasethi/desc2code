#include <stdio.h>
#define MAXN 105

inline int Max(int a , int b){ return (a>b?a:b); }

int n,m;
int mapa[MAXN][MAXN];
bool vis[MAXN][MAXN][10][3][3];
int DP[MAXN][MAXN][10][3][3];
int P;
char c;
int answer;

void reset(){
    for(int i=0;i<=n+1;i++)
    for(int j=0;j<=m+1;j++)
    for(int k=0;k<10;k++)
    for(int w=0;w<3;w++)
    for(int p=0;p<3;p++)
        vis[i][j][k][w][p]=false;
}

int busca(int y, int x, int ant, int row, int col){
    if(vis[y][x][ant][row][col])
        return DP[y][x][ant][row][col];
    if(y>n||x>m)
        return 0;
    int aux=0;
    int num=mapa[y][x];
    if(row==1)
        num+=P;
    if(col==1)
        num+=P;
    num%=10;
    aux=Max(aux,busca(y+1,x,ant,0,col));
    aux=Max(aux,busca(y,x+1,ant,row,0));
    aux=Max(aux,busca(y+1,x,ant,1,col));
    aux=Max(aux,busca(y,x+1,ant,row,1));
    if(ant>=num){
        aux=Max(aux,busca(y+1,x,num,0,col)+1);
        aux=Max(aux,busca(y,x+1,num,row,0)+1);
        aux=Max(aux,busca(y+1,x,num,1,col)+1);
        aux=Max(aux,busca(y,x+1,num,row,1)+1);
    }
    vis[y][x][ant][row][col]=true;
    return DP[y][x][ant][row][col]=aux;
}

int main(){
    int t;
    scanf("%d",&t);
    while(t--){
        scanf(" %d %d",&n,&m);
        for(int i=1;i<=n;i++){
            for(int j=1;j<=m;j++){
                scanf(" %c",&c);
                mapa[i][j]=c-'0';
            }
        }
        answer=0;
        for(P=0;P<10;P++){
            reset();
            answer=Max(answer,busca(1,1,9,0,0));
            answer=Max(answer,busca(1,1,9,1,0));
            answer=Max(answer,busca(1,1,9,0,1));
            answer=Max(answer,busca(1,1,9,1,1));
        }
        printf("%d\n",answer);
    }
    return 0;
}
