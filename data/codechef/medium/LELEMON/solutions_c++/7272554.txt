    #include<iostream>
    #include<cstdio>
    #include<math.h>
    #include<algorithm>
    #define gc getchar_unlocked
    using namespace std;
     
    void fastin(int &x)
    {
    register int a=gc();
    x=0;
    for(;a<48 || a>57;a=gc());
    for(;a>47 && a<58;a=gc())
    x=(x<<1)+(x<<3)+a-48;
    }
     
    int main()
    {
    int c,r,ans,i,t,n,m,vl[101],ord[10004];
    fastin(t);
    while(t--)
    {
    int no[101]={};
    r=ans=0;
    fastin(n);fastin(m);
    for(i=0;i<m;i++)
    {
    fastin(ord[i]);
    no[ord[i]]++;
    }
    while(n--)
    {
    fastin(c);
    for(i=0;i<c;i++)
    fastin(vl[i]);
    sort(vl,vl+c);
    if(c<=no[r])
    {
    for(i=0;i<c;i++)
    ans+=vl[i];
    }
    else
    {
    for(i=(c-no[r]);i<c;i++)
    ans+=vl[i];
    }	
    r++;
    }	
    printf("%d\n",ans);
    }
     
    return 0;
    }