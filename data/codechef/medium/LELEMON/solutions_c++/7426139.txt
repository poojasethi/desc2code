#include<bits/stdc++.h>
#define lli long long int
using namespace std;
int main()
{
	lli i,index,sum,j,k,c,m,n,t,size[100];
	scanf("%lld",&t);
	while(t--)
	{
		scanf("%lld%lld",&n,&m);

		lli p[m];

		for(i=0;i<m;i++)
			scanf("%lld",&p[i]);

		lli arr[n][101];
		for(i=0;i<n;i++)
		{
			scanf("%lld",&c);

			size[i]=c;

			for(j=0;j<c;j++)
				scanf("%lld",&arr[i][j]);

			sort(arr[i],arr[i]+c);
		}
		sum=0;
		for(i=0;i<m;i++)
		{
			index=p[i];
			if(size[index]!=0)
			{
				sum+=arr[index][size[index]-1];
				size[index]--;
			}
		}
		printf("%lld\n",sum);
	}
}
