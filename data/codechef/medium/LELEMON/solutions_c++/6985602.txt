#include<bits/stdc++.h>
using namespace std;

int main()

{

std::ios::sync_with_stdio(false);

int T;
cin>>T;

while(T--)
{
int N, M, sum=0;
cin>>N>>M;

int i, k, j;
int *B, *A, **C;
B=new int[M+1];  //Rooms Visited
A=new int[N];  //The Number of Bottles
C=new int*[N]; //Bottles' Volume

for(i=0;i<M; i++)
cin>>B[i];

B[M]=-1;

for(j=0; j<N; j++)
{
cin>>A[j];
C[j]=new int[A[j]];

for(i=0; i<A[j]; i++)
cin>>C[j][i];

sort(C[j], C[j]+A[j]);
}

sort(B, B+M);

int first, last,count=0;
first=last=0;
//i=1;
while(last<M)
{
while(B[first]==B[last])
{
count++;
last++;
};

int m;
if(count<A[B[first]])
m=count;
else
m=A[B[first]];

//cout<<sizeof(C[B[first]])<<endl;

for(i=1; i<=m; i++)
{
sum=sum+C[B[first]][A[B[first]]-i];
//cout<<sum<<endl;
}

first=last;
count=0;
}

cout<<sum<<"\n";
}
return 0;
}


