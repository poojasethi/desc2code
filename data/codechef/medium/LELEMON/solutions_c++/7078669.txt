#include<bits/stdc++.h>
#define in(t) scanf("%d",&t)
#define out(t) printf("%d\n",t);
#define for(i,j,n) for(i=j;i<n;i++)
using namespace std;
int a[100];
int c[100];
int main()
{
	int t,n,m,i,j,b,bttle,ans,r;
	in(t);
	while(t--)
	{
		in(n);
		in(m);
		int ans=0;
		for(i,0,100)
		{
			a[i]=0;
		}
		for(i,0,m)
		{
			in(r);
			a[r]+=1;
		}
		for(i,0,n)
		{
			in(b);
			for(j,0,b)
			{
				in(c[j]);
			}
			sort(c,c+b);
			while(b>0 && a[i]>0)
			{
				ans+=c[b-1];
				a[i]--;
				b--;
			}
		}
		
		out(ans);
	}
}