#include<stdio.h>
#include<iostream>
#include<algorithm>
using namespace std;
int main()
{
	long long int t,n,m;
	scanf("%lld",&t);
	for(;t>0;t--)
	{
		scanf("%lld%lld",&n,&m);
		long long int a[m],i,j,b[n][101],sum=0;
		for(i=0;i<m;i++)
		scanf("%lld",&a[i]);
		for(i=0;i<n;i++)
		{
			scanf("%lld",&b[i][100]);
			for(j=0;j<b[i][100];j++)
			scanf("%lld",&b[i][j]);
			sort(b[i],b[i]+j);
			b[i][100]--;
		}
		for(i=0;i<m;i++)
		{
			j=b[a[i]][100];
			if(j>=0)
			sum=sum+b[a[i]][j];
			b[a[i]][100]--;
		}
		printf("%lld\n",sum);
	}
	return 0;
}