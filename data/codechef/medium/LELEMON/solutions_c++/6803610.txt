#include<stdio.h>
int main()
{
	long long int t,n,c[100][100],c1[100],i1,i2;
	long long int m,v,p[10000],sum,s1,c2,a,b,k;
	scanf("%lld",&t);
	while(t--)
	{	
		sum=0;
		scanf("%lld%lld",&n,&m);
		if(n==0||m==0)
		{
			printf("%lld\n",sum);	
		}		
		
		else
		{	for(k=0;k<m;k++)
			scanf("%lld",&p[k]);
		
			for(a=0;a<n;a++)
			{	
				scanf("%lld",&c1[a]);
				for(b=0;b<c1[a];b++)
				{
					scanf("%lld",&c[a][b]);
				}
			}
			for(k=0;k<m;k++)
			{	
				s1=0;
				c2=p[k];
				for(a=0;a<c1[c2];a++)
				{
					if(s1<c[c2][a])
					{
						s1=c[c2][a];
						i1=a;
						i2=c2;
					}
				}
				c[i2][i1]=0;
				sum=sum+s1;
			}
			printf("%lld\n",sum);
		}
		
	}
	return 0;
} 