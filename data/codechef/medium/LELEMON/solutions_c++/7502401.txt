//F
#include <bits/stdc++.h>
 using namespace std;

int p[10010];
vector<int> mat[110];
int main(){
	int t; cin >> t;
	while(t--){
		int n,m,ans=0; cin >> n >> m;
		for(int i=0 ; i<m ; i++) cin >> p[i];
		for(int i=0 ; i<n ; i++){
			mat[i].clear();
			int c; cin >> c;
			for(int j=0 ; j<c ; j++){
				int a;cin >> a;
				mat[i].push_back(a);
			}
			sort(mat[i].begin(), mat[i].end());
		}
		for(int i=0 ; i<m ; i++){
			if(mat[p[i]].size()>0){ans += mat[p[i]][mat[p[i]].size()-1]; mat[p[i]].pop_back();}
		}
		cout << ans << endl;
	}
	return 0;
}