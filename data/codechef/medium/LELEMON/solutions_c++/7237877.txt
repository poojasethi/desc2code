#include <iostream>
using namespace std;

int t, n, c[105], j, p[10005];
long int m, i, k, v[100][105], d, pos;

long int find_max(int r)
{
    long int mx=0;
    for(k=0; k<c[r]; k++)
    {
        if(mx < v[r][k])
        {
            mx = v[r][k];
            pos = k;
        }
    }
    return mx;
}

int main()
{
    cin >> t;
    while(t--)
    {
        cin >> n >> m;
        d = 0;
        for(i=0; i<m; i++)
            cin >> p[i];
        for(i=0; i<n; i++)
        {
            cin >> c[i];
            for(j=0; j<c[i]; j++)
                cin >> v[i][j];
        }
        for(i=0; i<m; )
           {
              int r = p[i];
              long int mx = find_max(r);
              v[r][pos] = 0;
              d = d + mx;
              i = i+1;
           }
        cout << d << endl;
    }
    return 0;
}
