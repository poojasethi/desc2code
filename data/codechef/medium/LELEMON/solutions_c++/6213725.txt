#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;

struct room{
	int c;
	vector<long int> p;
};

int main() {
	ios::sync_with_stdio(false);
	int t;
	cin>>t;
	while(t>0){
		int n,m,temp2;
		long long int sum=0;
		long int temp;
		vector<int> m_ar;
		cin>>n;
		cin>>m;
		for(int i=0;i<m;i++){
			cin>>temp;
			m_ar.push_back(temp);
		}
		room given[n];
		for(int i=0;i<n;i++){
			cin>>given[i].c;
			for(int j=0;j<given[i].c;j++){
				cin>>temp;
				given[i].p.push_back(temp);
			}
			sort(given[i].p.begin(),given[i].p.end());
		}
		for(int i=0;i<m;i++){
			temp2=m_ar.at(i);
			if(given[temp2].c<=0){
				continue;
			}
			sum=sum+given[temp2].p.at(given[temp2].c-1);
			given[temp2].c--;
		}
		cout<<sum<<'\n';
		t--;
	}
	return 0;
}