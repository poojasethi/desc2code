#include<stdio.h>
#include<iostream>
#include<algorithm>
using namespace std;
int cmpfunc (const void * a, const void * b)
{
   return ( *(int*)b - *(int*)a );
}
int main()
{
   long t=0,n=0,p[10005],i=0,j=0,c[101],temp=0,count[101];
  long sum=0;
  long m=0,v[101][101];
  scanf("%ld",&t);
  while(t--)
  {
    scanf("%ld",&n);
    scanf("%ld",&m);
    for(i=0;i<n;i++)
       count[i]=0;
    for(i=0;i<m;i++)
    {
      scanf("%ld",&p[i]);
      count[p[i]]++;
    }
    sum=0;
    for(i=0;i<n;i++)
    {
      scanf("%ld",&c[i]);
      for(j=0;j<c[i];j++)
        scanf("%ld",&v[i][j]);
    }
    for(i=0;i<n;i++)
    {
      qsort(v[i],c[i],sizeof(long),cmpfunc);
      if(count[i]>c[i])
       temp=c[i];
      else
       temp=count[i];
      for(j=0;j<temp;j++)
        sum+=v[i][j];
    }
    printf("%ld\n",sum);
  }
  return 0;
}