#include <bits/stdc++.h>
using namespace std;
 
typedef pair< int , int > pii;
typedef long long LL;
#define fr first
#define se second
#define EPS 1e-8
#define INF 10000*10000*10000LL
stringstream ss;
#define two(x) ( 1LL<<x )
LL mod = 1000000007LL;

/**************************Code****************************/

int a[10010], b[128][128], c[128], d[128];

int main()
{
	int t, n, m;
	scanf( "%d", &t );
	while( t -- )
	{
		scanf( "%d%d", &n, &m );
		for( int i = 0 ; i < m ; i ++ )
			scanf( "%d", a + i );
		for( int i = 0 ; i < n ; i ++ )
		{
			d[i] = 0;
			cin >> c[i];
			for( int j = 0 ; j < c[i] ; j ++ )
				scanf( "%d", &b[i][j] );
			sort( b[i], b[i]+c[i], greater < int > () );
		}
		int ans = 0;
		for( int i = 0 ; i < m ; i ++ )
			if( d[ a[i] ] < c[ a[i] ] )
				ans += b[ a[i] ][ d[ a[i] ] ++ ];
		printf( "%d\n", ans );
	}
	return 0;
}
