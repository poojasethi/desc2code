T = int(raw_input())
for t in range(T):
	n,m = tuple(map(lambda x: int(x),raw_input().split()))
	p = [int(x) for x in raw_input().split()]
	# print "n,m:",n,m
	# print "p:",p
	rooms ={}
	for i in range(n):
		rooms[i] = [int(x) for x in raw_input().split()][1:]
		rooms[i].sort()
		# print rooms[i]
	lemon= 0
	for j in p:
		if len(rooms[j])>0: 
			z = rooms[j].pop()
			# print z
			lemon += z
	print lemon
