#include <bits/stdc++.h>

using namespace std;
struct num
{
    float a,b;
};
int mycmp(const void* p,const void* q)
{
    struct num *p1=(struct num*) p;
    struct num *q1=(struct num*) q;
    return p1->a>q1->a;
}
int mycmp1(const void* p,const void* q)
{
    struct num *p1=(struct num*) p;
    struct num *q1=(struct num*) q;
    return p1->b<q1->b;
}
int main()
{
    long int t,n;
    struct num x[100000];
    double ans;
    int i,j,k;
    cin>>t;
    while(t--)
    {
        cin>>n;
        for(i=0;i<n;i++)
            scanf("%f%f",&x[i].a,&x[i].b);
        qsort(x,n,sizeof(struct num),mycmp);
        j=x[0].a;
        k=0;
        for(i=1;i<n;i++)
        {
            if(x[i].a!=j)
            {
                qsort(&x[k],i-k,sizeof(struct num),mycmp1);
                j=x[i].a;
                k=i;
            }
        }
        qsort(&x[k],i-k,sizeof(struct num),mycmp1);
        ans=0;
        for(i=1;i<n;i++)
            ans+=(sqrt(pow(x[i].b-x[i-1].b,2)+pow(x[i].a-x[i-1].a,2)));
        printf("%.2lf\n",ans);
    }
    return 0;
}
