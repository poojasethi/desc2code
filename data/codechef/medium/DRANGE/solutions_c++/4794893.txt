#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <climits>
#define getcx getchar_unlocked 
#define mod 1000000007
#define MIN(a,b) a<b?a:b
#define MAX(a,b) a>b?a:b

using namespace std;

int d[1000005];

inline void inp( int &n )//fast input function
{
        n=0;
        int ch=getcx();
        int sign=1;
        while( ch < '0' || ch > '9' )
        {if(ch=='-')sign=-1; ch=getcx();}
        while( ch >= '0' && ch <= '9' )
        n = (n<<3)+(n<<1) + ch-'0', ch=getcx();
        n=n*sign;
}

int main(void)
{

	int test;
	inp(test);
	while(test--)
	{
		int n,m;
		inp(n),inp(m);

		d[1]=1;

		for(int i=2;i<=n;i++)
			d[i]=-1;

		for(int i=0;i<m;i++)
		{
			int w,x,y,z;

			inp(w),inp(x),inp(y),inp(z);

			if(w==1)
				z=z*-1;

			d[x]+=z;
			d[y+1]-=z;		

		}


		int mn=mod,mx=-mod;

		for(int i=1;i<=n;i++)
		{
			d[i]= d[i-1] - d[i];
			mn= MIN(mn,d[i]);
			mx= MAX(mx,d[i]);
		}

		printf("%d\n",mx-mn );

	}
}