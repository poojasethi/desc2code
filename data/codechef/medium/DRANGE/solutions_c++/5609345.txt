#include<iostream>
#include<stdio.h>
#include<malloc.h>
#include<stdlib.h>
#include<string.h>
#include<limits.h>
#define ll long int
using namespace std;
int main()
{
    int t;
    scanf("%d",&t);
    ll n,m,maxm,minm,cur,i,w,x,y,z;
    ll *a=(ll*)malloc(sizeof(ll)*1000005);
    while(t--)
    {     memset(a,0,1000005*sizeof(ll));
        scanf("%ld%ld",&n,&m);
        while(m--)
        {
            scanf("%ld%ld%ld%ld",&w,&x,&y,&z);
            if(w==1)
            {
                a[x-1]+=z;
                a[y]-=z;
            }
            else if(w==2)
            {
                a[x-1]-=z;
                a[y]+=z;
            }

        }
        cur=0;minm=INT_MAX;maxm=INT_MIN;
        for(i=0;i<n;i++)
        {
            cur +=a[i];
            maxm=maxm<(cur+i+1)?(cur+i+1):maxm;
            minm=minm>(cur+i+1)?(cur+i+1):minm;
        }
        printf("%ld\n",(maxm-minm));
    }
    return 0;
}
