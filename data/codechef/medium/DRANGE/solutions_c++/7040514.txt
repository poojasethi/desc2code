// LUCIFER <3 SLS <3

#include <bits/stdc++.h>

using namespace std;

#define s(x) scanf("%d", &x)
#define get getchar_unlocked

int scan()
{
    int n = 0, ch = get();
    while (ch < '0' || ch > '9')
        ch = get();
    while (ch >= '0' && ch <= '9') {
        n = (n << 3) + (n << 1) + ch - '0';
        ch = get();
    }
    return n;
}

int a[1000011];

int main()
{
    int t, n, m, i, w, x, y, z, mn, mx;
    t = scan();
    while (t--) {
        n = scan();
        m = scan();
        for (i = 1; i <= n; ++i)
            a[i] = 0;
        while (m--) {
            w = scan();
            x = scan();
            y = scan()+1;
            z = scan();
            if (w == 1) {
                a[x] += z;
                a[y] -= z;
            }
            else {
                a[x] -= z;
                a[y] += z;
            }
        }
        mn = INT_MAX;
        mx = INT_MIN;
        for (i = 2; i <= n; ++i)
            a[i] += a[i-1];
        for (i = 1; i <= n; ++i) {
            a[i] += i;
            //cout << a[i] << " ";
            mx = mx > a[i] ? mx : a[i];
            mn = mn > a[i] ? a[i] : mn;
        }
        printf("%d\n", mx-mn);
    }
    return 0;
}
