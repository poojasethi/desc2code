#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define MAX 1000007
int a[MAX];
int main(){
   int t,i,j;
   scanf("%d",&t);
   for(i=0;i<t;i++){
   int n,m;
   scanf("%d",&n);
   scanf("%d",&m);
   memset(a,0,sizeof(a));
   for(j=0;j<m;j++){
   int w,r1,r2,val;
   scanf("%d",&w);
   scanf("%d",&r1);
   scanf("%d",&r2);
   scanf("%d",&val);
   if(w==2){
   a[r1]-=val;
   a[r2+1]+=val;
   }
   else{
   a[r1]+=val;
   a[r2+1]-=val;
   }
   }
   int max1=INT_MIN;
   int min1=INT_MAX;
   for(j=1;j<=n;j++){
   a[j]+=a[j-1];
   max1=max(max1,a[j]+j);
   min1=min(min1,a[j]+j);
   }
   printf("%d\n",max1-min1);
   }


   return 0;
}
