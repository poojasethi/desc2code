#include<bits/stdc++.h>
using namespace std;

int a[1000005],d[1000005];

int main()
{
    int n,i,t,w,x,y,z,m,mx,mn;

    scanf(" %d",&t);

    while(t--){
        scanf(" %d %d",&n,&m);

        memset(d,0,sizeof(d));

        while(m--){
            scanf(" %d %d %d %d",&w,&x,&y,&z);
            if(w==1){
                if(x>0)
                    d[x-1]+=z;
                d[y]-=z;
            }
            else{
                if(x>0)
                    d[x-1]-=z;
                d[y]+=z;
            }
        }

        a[1]=mx=mn=d[1];
        for(i=2;i<=n;i++){
            a[i]=d[i-1]+a[i-1]+1;
            mx=max(mx,a[i]);
            mn=min(mn,a[i]);
        }
      /*  for(i=1;i<=n;i++)
            printf("%d ",a[i]);*/
        //printf("\n");
        printf("%d\n",mx-mn);
    }
    return 0;
}
