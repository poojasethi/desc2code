#include<fstream>
#include<stdio.h>
#include<stdlib.h>
#include<algorithm>
#include<string.h>
#include<vector>
#include<utility>
#include<iostream>
using namespace std;

#define ii pair<int,int>
#define pb push_back
#define mp make_pair
#define fi first
#define se second
#define rep(i,a,b) for (int i = a; i<=b; i++)
#define INF 1000000000
#define LL long long int
int dc[] = {0,1,0,-1};
int dr[] = {-1,0,1,0};

int tc, w,x,y,z,m,n,add[1000003],mini,maxi;

int main(void)
{
    scanf("%d",&tc);
    for (int cases = 1; cases<=tc; cases++)
    {
        scanf("%d%d",&n,&m);
        memset(add,0,sizeof(add));
        for (int i = 1; i<=m; i++)
        {
            scanf("%d%d%d%d",&w,&x,&y,&z);
            if (w==1)
            {
                add[x]+=z;
                add[y+1]-=z;
            } else
            if (w==2)
            {
                add[x]-=z;
                add[y+1]+=z;
            }
        }
        mini = 1 + add[1];
        maxi = 1 + add[1];
        for (int i = 2; i<=n; i++)
        {
            add[i]+=add[i-1];
            mini = min(mini, i+add[i]);
            maxi = max(maxi, i+add[i]);
        }
        printf("%d\n",maxi-mini);
    } 



}
