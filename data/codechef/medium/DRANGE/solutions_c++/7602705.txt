#include<stdio.h>

using namespace std;

int a[1000001], d[1000001];
int main()
{
    int t, n, m;
    scanf("%d", &t);
    while (t--)
    {   int x, y, z, w;
        scanf("%d%d", &n, &m);
        for (int i=1; i<=n; i++)
            a[i]=i;
        for (int i=1; i<n; i++)
            d[i]=1;
        for (int i=0; i<m; i++)
        {
            scanf("%d%d%d%d", &w, &x, &y, &z);
            if (w==1)
            {
                if (x==1)
                    a[1]=a[1]+z;
                else
                    d[x-1]+=z;
                d[y]-=z;
            }
            else if (w==2)
            {
                if (x==1)
                    a[i]-=z;
                else
                    d[x-1]-=z;
                d[y]+=z;
            }
        }
        for (int i=1; i<n; i++)
            a[i+1]=d[i]+a[i];
        int minm=a[1], maxm=a[1];
        for (int i=1; i<=n; i++)
        {

            if (a[i]<minm)
                minm=a[i];
            if (a[i]>maxm)
                maxm=a[i];
        }
        printf("%d\n", maxm-minm);
    }
    return 0;
}
