#include<stdio.h>

using namespace std;

int A[1000002], D[1000002];
int main()
{
    int T, N, M, x, y, z, w;
    scanf("%d", &T);
    while (T--)
    {
        scanf("%d%d", &N, &M);
        for (int i=1; i<=N; i++)
            A[i]=i;
        for (int i=1; i<N; i++)
            D[i]=1;
        for (int i=0; i<M; i++)
        {
            scanf("%d%d%d%d", &w, &x, &y, &z);
            if (w==1)
            {
                if (x==1)
                    A[1]=A[1]+z;
                else
                    D[x-1]+=z;
                D[y]-=z;
            }
            else if (w==2)
            {
                if (x==1)
                    A[i]-=z;
                else
                    D[x-1]-=z;
                D[y]+=z;
            }
        }
        for (int i=1; i<N; i++)
            A[i+1]=D[i]+A[i];
        int mn=A[1], mx=A[1];
        for (int i=1; i<=N; i++)
        {

            if (A[i]<mn)
                mn=A[i];
            if (A[i]>mx)
                mx=A[i];
        }
        printf("%d\n", mx-mn);
    }
    return 0;
}
