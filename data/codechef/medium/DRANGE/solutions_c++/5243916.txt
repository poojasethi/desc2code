#include<iostream>
#include<cstdio>
#define gc getchar_unlocked
//#define gc getchar
using namespace std;
 
void scanint(int &x)
{
    register int c = gc();
    x=0;
    for( ; (c<48) || (c>57) ; c=gc() );
    for( ; (c>47) && (c<58) ; c=gc() )
        x = (x<<1) + (x<<3) + c -48 ;
}
 
int main()
{
    int tc,i,n,m,w,x,y,z,k,j,mn,mx,r;
    int *pieces;
    int *diff;
    pieces = new int[1000002];
    diff = new int[1000002];
 
    //cin>>tc;
    scanint(tc);
 
    for(i=0;i<tc;i++)
    {
        //cin>>n>>m;
        scanint(n);
        scanint(m);
 
        pieces[0]=1;
 
        for(k=0;k<n;k++)
        {
            diff[k]=1;
        }
 
        for(j=0;j<m;j++)
        {
            //cin>>w>>x>>y>>z;
            scanint(w);
            scanint(x);
            scanint(y);
            scanint(z);
 
            if(w==1)
            {
                if(x-2>=0)
                    diff[x-2]+=z;
 
                else
                    pieces[0]+=z;
 
                if(y<=n-1)
                    diff[y-1]-=z;
            }
 
            else
            {
                if(x-2>=0)
                    diff[x-2]-=z;
 
                else
                    pieces[0]-=z;
 
                if(y<=n-1)
                    diff[y-1]+=z;
            }
 
        }
 
 
        mn=pieces[0];
        mx=pieces[0];
 
        for(k=1;k<n;k++)
        {
            pieces[k]=pieces[k-1]+diff[k-1];
 
            if(pieces[k]<mn)
                mn=pieces[k];
 
            if(pieces[k]>mx)
                mx=pieces[k];
        }
 
        r=mx-mn;
        cout<<r<<endl;
    }
    return 0;
}