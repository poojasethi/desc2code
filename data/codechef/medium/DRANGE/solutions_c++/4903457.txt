#include<iostream>
#include<limits.h>
#include<stdlib.h>
#include<string>
#include<cstring>
//#include<conio.h>
#include<stdio.h>
using namespace std;
//inline int getchar_unlocked() { return getchar(); }
inline int read_int() {
    char c;
    while ((c=getchar_unlocked()) < 48 || c > 57);
    int p = c-48;
    while ((c=getchar_unlocked()) >= 48 && c <= 57) p=p*10+c-48;
    return p;
}
int d[1000005];
int main()
{
      int t,m,w,n,x,y,z;
      
      t=read_int();
      
      while(t--)
      {
                n=read_int();
                m=read_int();
                        for(int i=0;i<=n;i++)
                d[i]=1;
                for(int i=0;i<m;i++)
                {
                        w=read_int();
                        x=read_int();
                        y=read_int();
                        z=read_int();
                                           if(w==1)
                         {
                                 d[x-1]+=z;
                                 d[y]-=z;
                                 
                         }
                         else
                         {
                         d[x-1]-=z;
                         d[y]+=z;
                         }
                         
                }
                int min=INT_MAX;
                int max=INT_MIN;
                int x1=0;
                for(int i=1;i<=n;i++)
                {
                        x1=x1+d[i-1];
                        if(max<x1)
                        max=x1;
                        if(min>x1)
                        min=x1;
                }
                cout<<max-min<<endl;
      }
    //  getch();
      return 0;
}
      
