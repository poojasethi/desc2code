#include <bits/stdc++.h>
using namespace std;
long long int b[1000001];

inline void inp(int *n) {
  *n = 0;
  int ch = getchar();
  //int sign = 1;
  while(ch < '0' || ch > '9') {
    //if (ch == '-') sign = -1; 
    ch = getchar();
  }
  while(ch >= '0' && ch <= '9')
    *n = (*n<<3) + (*n<<1) + ch - '0', ch = getchar();
  //n = n*sign;
}
inline void outp(int a) {
  char c;
  char snum[20];
  int i=0;
  do {
    snum[i++]=a%10+48;
    a=a/10;
  } while(a!=0);
  i=i-1;
  while(i>=0)
    putchar(snum[i--]);
  putchar('\n');
}
int main()
{
	int t,w;
	int i,n,m;
	scanf("%d",&t);
	while(t--) {
		//scanf("%lld%lld",&n,&m);
		inp(&n);
		inp(&m);
		/*for(i=0;i<n;i++) printf("%lld ",b[i]);
		printf("\n");
		for(i=0;i<n;i++) printf("%lld ",a[i]);
		printf("\n");*/
		while(m--) {
			int x,y,z;
			scanf("%d",&w);
			inp(&x);
			inp(&y);
			inp(&z);
			if(w==2) z*=-1;
			b[x]= b[x] + z;
			b[y+1]= b[y+1]-z;
		}
		int c=0,minn=1000000,maxx=-1000000,sum=0;
		for(i=1;i<=n;i++) {
			sum+=b[i];
			c=i+1+sum;
			if(c<minn) minn=c;
			if(c>maxx) maxx=c;
			//printf("%lld ",b[i]);
			b[i]=0;
		}
		b[n]=0;
		//printf("\n");
		//printf("%lld\n",maxx-minn);
		outp(maxx-minn);
		//k=n;
	}
}