#include<bits/stdc++.h>
#define ld long int 

using namespace std;

int main()
{
    ld t,N,M;
    ld max,min,w,x,y,z,p;
    ld A[1000002];
    scanf("%d",&t);
    while(t--)
    {
        scanf("%ld%ld",&N,&M);
        memset(A,0,sizeof(A));
    
        while(M--)
        {
            scanf("%d%ld%ld%ld",&w,&x,&y,&z);
            if(w==1)
            {
                A[x]+=z; A[y+1]-=z;
            }
            else
            {
                A[x]-=z; A[y+1]+=z;
            }
        }
        max=min=A[1]+1; 
        for(int i=2;i<=N;i++)
        {
            A[i]+=(A[i-1]); 
            p=A[i]+i;
            if(p>max) max=p;
            if(p<min) min=p;
        }
        printf("%ld\n",max-min);
    }
    return 0;
}