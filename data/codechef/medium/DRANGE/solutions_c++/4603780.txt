#include <cstdio>
#include <cstring>
using namespace std;

int main()
{
	int t, n, m, w, x, y, z;
	scanf("%d", &t);
	while(t--)
	{
		scanf("%d %d", &n, &m);
		int arr[n];
		memset(arr, 0, sizeof(arr));
		while(m--)
		{
			scanf("%d %d %d %d", &w, &x, &y, &z);
			x--;
			if(w&1)
			{
				arr[x] += z;
				arr[y] -= z;
			}
			else
			{
				arr[x] -= z;
				arr[y] += z;
			}
		}
		arr[0]++;
		int maxval = arr[0], minval = arr[0];
		for(int i = 1; i < n; i++)
		{
			arr[i] += arr[i-1] + 1;
			if(arr[i] > maxval)
			{
				maxval = arr[i];
			}
			else if(arr[i] < minval)
			{
				minval = arr[i];
			}
		}
		printf("%d\n", maxval-minval);
	}
    return 0;
}