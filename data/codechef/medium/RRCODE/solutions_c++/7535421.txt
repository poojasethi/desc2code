#include<bits/stdc++.h>
using namespace std;
#define f(i,a,b) for(int i=(int)(a);i<(int)(b);i++)
#define rf(i,a,b) for(int i=(int)(a);i>=(int)(b);i--)
#define s(n)                        scanf("%d",&n)
#define p(n)			    printf("%d\n",n)
#define sl(n)                       scanf("%lld",&n)
#define pl(n)			    printf("%lld\n",n)
#define ll long long int
ll F(ll N,ll K,ll Answer,ll b,ll A[])
{

	if(b=='A')
	{
      ll ans=A[0];
         for(int j=1;j<N;j++)
            ans=(ans & A[j]);
       return (Answer & ans);
	}
	else if(b=='O')
	{

        ll ans=A[0];
         for(int j=1;j<N;j++)
            ans=(ans | A[j]);
       return Answer|ans;
	}
	else if(b=='X')
	{
		if(K%2!=0)K=1;
		else K=2;
		ll ans=A[0];
      	if(K==1)
         for(int j=1;j<N;j++)
            ans=(ans ^ A[j]);
         else ans=0;
       return Answer^ans;
	}
}
int main()
{
    int t;
    s(t);
    while(t--)
    {
        ll final,n,k,answer;
        string op;
        sl(n); sl(k); sl(answer);
        ll a[n+2];
        f(i,0,n)
        sl(a[i]);
        cin>>op;
        if(k!=0)
        final=F(n,k,answer,op[0],a);
		else
		final=answer;
		pl(final);

    }
    return 0;
}
