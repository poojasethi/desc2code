#include <cstdio>
#include <cmath>

using namespace std;

typedef unsigned long long ULL;
const ULL MAX=1000000080798150871LL;
const int MAXL=1001;

void pascal(ULL (*C)[MAXL])
{
    for(int i=2; i<MAXL; i++)
	for(int j=0; j<=i; j++)
	{
	    if (j == 0 && j == i)
		C[i][j] = 1;
	    else
		C[i][j] = (C[i-1][j-1] + C[i-1][j]) % MAX;
	}
}

int main()
{
    ULL C[MAXL][MAXL];
    C[0][0] = C[1][0] = C[1][1] = 1;
    pascal(C);

    int T, N, M, L, K, D;
    char input[4];
    int cnt[3];
    ULL wind[3];
    scanf("%d", &T);
    while(T-- > 0)
    {
        scanf("%d %d %d %d", &N, &M, &L, &K);
       
        for(int i=0; i < 3; i++)
            cnt[i] = 0;

        if (K == 1)
            D = M;
        else if (K == 2)
        {
            if (M == 3)
                D = 3;
            else if (M == 2)
                D = 1;
            else
                D = 0;
        }
        else if (K == 3)
            D = 1;
        else
            D = 0;

        for(int i=0; i < N; i++)
        {
            scanf("%s", input);
            if (K == 1)
            {
                for(int j=0; j < D; j++)
                    if (input[j] == '1')
                        ++cnt[j];
            }
            else if (K == 2)
            {
                if (D && input[0] =='1' && input[1] == '1')
                    ++cnt[0];
                if (D == 3)
                {
                    if (input[1] == '1' && input[2] == '1')
                        ++cnt[1];
                    if (input[0] == '1' && input[2] == '1')
                        ++cnt[2];
                }
            }
            else if (K == 3)
            {
                if (input[0] == '1' && input[1] == '1' && input[2] == '1')
                    ++cnt[0];
            }
        }

        ULL r = 0;
        for(int i=0; i < D; i++)
            r += C[cnt[i]][L];
        printf("%lld\n", r % MAX);
    }
    return 0;
}
