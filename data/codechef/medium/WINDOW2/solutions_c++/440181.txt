#include<iostream>
using namespace std;

typedef long long LL;
 
const int N = 1000;
const int M = 3;
const LL MOD=1000000080798150871LL;
 
LL bin[N+1][N+1];
 
void precalc()
{
	for(int n=0;n<=N;n++)
	{
		bin[n][0]=bin[n][n]=1;
		for(int k=1;k<n;k++)
			bin[n][k]=(bin[n-1][k-1]+bin[n-1][k])%MOD;
	}
}

int main()
{
    //calculate nCr table
    precalc();
    int t = 0;
    cin>>t;
    while(t-- > 0)
    {
        int n,m,l,k;
        cin>>n>>m>>l>>k;
        int a[8];
        a[0] = a[1] = a[2] = a[3] = a[4]= a[5] = a[6] = a[7] =0;
        for(int i = 0 ; i < n ; i++)
        {
            int num;
            cin>>num;
            switch(num)
            {
                case 0 : a[0]++;
                         break;
                case 1 : a[1]++;
                         break;
                case 10 : a[2]++;
                          break;
                case 11 : a[3]++;
                          break;
                case 100 : a[4]++;
                           break;
                case 101 : a[5]++;
                           break;
                case 110 : a[6]++;
                           break;   
                case 111 : a[7]++;
                           break;
                default : 
                           break;
            }           
        } 
        LL ans = 0;
        if(k == 1)
            ans = bin[a[1]+a[3]+a[5]+a[7]][l] + bin[a[2]+a[3]+a[6]+a[7]][l]
                + bin[a[4]+a[5]+a[6]+a[7]][l];
        else if(k == 2)
        {
            ans = bin[a[3]+a[7]][l] + bin[a[5]+a[7]][l]
                + bin[a[6]+a[7]][l];
        }
        else
            ans = bin[a[7]][l];
        ans = ans % MOD;      
        cout<<ans<<endl;
    }
    return 0;
}

