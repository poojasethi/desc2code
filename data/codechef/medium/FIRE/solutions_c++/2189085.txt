#include<stdio.h>
using namespace std;
int a[10001][4],s,t1,t,n1,n;
bool sv[10001],sp[10001],visit[10001];
int solve(int x)
{
    //printf("%d",x);
    visit[x]=1;
    int k=0,c=0,i;
    if(sp[x]) return 0;
    if(a[x][0]<=1) return 1;
    for(i=1;i<=a[x][0];i++)
    {
             if(!visit[a[x][i]])  k=solve(a[x][i])|k;
    }
    return k;
}
int main()
{
    int i,j;
    scanf("%d",&t);
    while(t--)
    {
              scanf("%d %d %d",&n,&s,&t1);
              for(i=1;i<=n;i++)
              {
                               scanf("%d",&a[i][0]);
 				//printf("yes");
                               sp[i]=0;
                               sv[i]=0;visit[i]=0;
                               for(j=1;j<=a[i][0];j++)
                               {
                                                scanf("%d",&a[i][j]);
						//printf("yes2");
                               }
              }
              for(i=1;i<=t1;i++)
              {
                                scanf("%d",&n1);
				//printf("yes3");
                                sp[n1]=1;
              }
              if(solve(s)) printf("yes\n");
              else printf("no\n");
    }
}
              


