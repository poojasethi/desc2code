#include<stdio.h>

int a[10002][3];
bool ver[10002];
int size[10002];

void check(int par,int curr){
    int i;
    if(size[curr-1]==1)
    return;

    for(i=0;i<size[curr-1];i++)
    if(a[curr-1][i]!=par)
    check(curr,a[curr-1][i]);


    int cnt=0;
    for(i=0;i<size[curr-1];i++)
    if(ver[a[curr-1][i]-1]==true)
    cnt++;

    if(cnt>1)
    ver[curr-1]=true;
}

int main(){
    int test,n,s,t,i,j;
    scanf("%d",&test);
    while(test--){
        scanf("%d%d%d",&n,&s,&t);
        for(i=0;i<n;i++){
            ver[i]=false;
            scanf("%d",&size[i]);
            for(j=0;j<size[i];j++)
            scanf("%d",&a[i][j]);
        }

        while(t--){
            scanf("%d",&i);
            ver[i-1]=true;
        }

        check(-1,1);
        if(ver[s-1])
        printf("no\n");
        else
        printf("yes\n");
    }
    return 0;
}
