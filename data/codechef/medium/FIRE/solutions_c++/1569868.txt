#include<iostream>
#include<stdlib.h>
int x[10001][4],s;
int fun(int,int [],int [],int);
using namespace std;
int main()
{
	int n,i,t1,j,a,ts,k,vl;
	char ch;
	cin>>ts;
	while(ts--){
	cin>>n>>s>>t1;
	int t[n+1],st[n+1];
	for(i=1;i<=n;i++)
	{
		st[i]=0;
		cin>>t[i];
		for(j=1;j<=t[i];j++)
			cin>>x[i][j];
	}
	for(i=1;i<=t1;i++)
	{
		cin>>a;
		st[a]=1;
	}
	if(!st[s])
	{
		if(t[s]<2)
			vl=1;
		else
			vl=fun(s,t,st,0);
	}
	if(!vl || st[s])
		cout<<"no"<<endl;
	else
		cout<<"yes"<<endl;
	}
	return 0;
}
int fun(int node,int t[],int st[],int prnode)
{
	int vl[4],i,c=0,sum=0;
	for(i=1;i<=t[node];i++)
	{
		if(x[node][i]!=prnode && !st[x[node][i]])
		{
			if(t[x[node][i]]<3)
				vl[++c]=1;
			else
				vl[++c]=fun(x[node][i],t,st,node);
			sum+=vl[c];
		}
	}
	if(!c)
		return 0;
	return !!sum;
}
