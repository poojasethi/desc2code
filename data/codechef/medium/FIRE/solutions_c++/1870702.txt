#include<cstdio>
#include<set>
#include<string.h>
using namespace std;
#define M 11000
int child[M][3],ch[M];bool sp[M];
bool protect(int s,int p)
{
 if(sp[s])return 0;
 int cant=0;
 for(int i=0;i<ch[s];i++)
 {
  int t=child[s][i];
  if(t==p)continue;
  if(!protect(t,s))cant++;
 }
 if(cant>1)return 0;
 return 1;
}
int main()
{
  //freopen("in.txt","r",stdin);
  int T,i,n,s,t;
  scanf("%d",&T);
  while(T--)
  {
   scanf("%d%d%d",&n,&s,&t);
   for(i=1;i<=n;i++)
   {
    scanf("%d",&ch[i]);
    for(int j=0;j<ch[i];j++)
    scanf("%d",&child[i][j]);
   }
   memset(sp,0,sizeof(sp));
   while(t--)
   {
    int x;
    scanf("%d",&x);
    sp[x]=1;
   }
   printf("%s\n",protect(s,s)?"yes":"no");
  }
  return 0;
}
