#include <iostream>
#include <stdio.h>
#include <queue>

using namespace std;
int c[10005],adl[10005][4],k,s;
bool save[10005],chk[10005];

bool solve(int v)
{
     if(save[v]==1) return false;
     if(v!=s&&c[v]==2) return true;
     if(c[v]<2) return true;
     bool temp=0;
     chk[v]=1;
     for(int i=0;i<c[v];i++)
     if(chk[adl[v][i]]==0)temp=temp||solve(adl[v][i]);
     return temp;
     }
int main()
{
    int t,n,temp;
    
    scanf("%d",&t);
    while(t--)
    {
              scanf("%d%d%d",&n,&s,&k);
              for(int i=1;i<=n;i++)
              {
                      scanf("%d",&c[i]);
                      for(int j=0;j<c[i];j++) scanf("%d",&adl[i][j]);
                      }
              for(int i=1;i<=n;i++) save[i]=0,chk[i]=0;
              for(int i=0;i<k;i++)
              {
                      scanf("%d",&temp);
                      save[temp]=1;
                      }
              if(save[s]==1)
              {
                            printf("no\n");
                            continue;
                            }
              if(solve(s)==1) printf("yes\n");
              else printf("no\n");
              }
  //  system("pause");
    return 0;
}
                                                                                             
                                          
