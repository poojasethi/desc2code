#include<cstdio>

int lc[10001];
int rc[10001];
int p[10001];
bool special[10001];
bool burnt[10001];

bool check(int r)
{
	if(special[r])return false;
	
	burnt[r]=true;

	if(burnt[p[r]])
	{
		if(rc[r]==0 || lc[r]==0)return true;
		return ( check(lc[r]) || check(rc[r]) );
	}
	else if(burnt[lc[r]])
	{
		if(rc[r]==0 || p[r]==0)return true;
		return ( check(p[r]) || check(rc[r]) );
	}
	else
	{
		if(lc[r]==0 || p[r]==0)return true;
		return ( check(p[r]) || check(lc[r]) );
	}

}

int main()
{
	int T;
	int n,s,t;
	int i,j,nc;
	int temp;
	bool possible;

	scanf("%d",&T);

	while(T--)
	{
		scanf("%d%d%d",&n,&s,&t);

		for(i=1;i<=n;i++)
		{
			burnt[i]=false;

			if(i!=s)
			{
				scanf("%d",&nc);
				if(nc==3)
					scanf("%d%d%d",&p[i],&lc[i],&rc[i]);
				else if(nc==2)
				{
					scanf("%d%d",&p[i],&lc[i]);
					rc[i]=0;
				}
				else if(nc==1)
				{
					scanf("%d",&p[i]);
					lc[i]=rc[i]=0;
				}
			}
			else
			{
				p[i]=0;
				burnt[0]=true;
				scanf("%d",&nc);
				if(nc==2)
					scanf("%d%d",&lc[i],&rc[i]);
				else if(nc==1)
				{
					scanf("%d",&lc[i]);
					rc[i]=0;
				}
				else lc[i]=rc[i]=0;
			}
		}

		for(i=1;i<=n;i++)special[i]=false;
		for(i=1;i<=t;i++){
			scanf("%d",&temp);
			special[temp]=true;
		}

		possible=check(s);

		if(possible)puts("yes");
		else puts("no");
	}
	return 0;
}