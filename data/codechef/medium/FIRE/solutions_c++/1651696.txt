#include <cstdio>
#include <cstring>
#include <vector>
using namespace std;

int tst, n, s, t, x;
vector<bool> f;
vector<int> a[10005];
vector<bool> save;

void go(int cur, int p) {
	if (save[cur]) {
		f[cur] = false;
	} else if ((a[cur].size()<=1) || (cur!=s && a[cur].size()<=2)) {
		f[cur] = true;
	} else {
		for (int i=0; i<a[cur].size(); i++)
			if (a[cur][i]!=p) {
				go(a[cur][i], cur);
				f[cur] = f[cur] || f[a[cur][i]];
			}
	}
}

int main() {
	//freopen("in.txt", "r", stdin);
	scanf("%d", &tst);
	while (tst--) {
		scanf("%d%d%d", &n, &s, &t);
		s--;
		f.clear();
		save.clear();
		for (int i=0; i<n; i++) {
			a[i].clear();
			int cnt;
			scanf("%d", &cnt);
			for (int k=0; k<cnt; k++) {
				scanf("%d", &x);
				x--;
				a[i].push_back(x);
			}
		}
		save.resize(n, false);
		for (int i=0; i<t; i++) {
			scanf("%d", &x);
			x--;
			save[x] = true;
		}
		f.resize(n, false);
		go(s, -1);
		printf("%s\n", f[s]?"yes":"no");
	}
	return 0;
}