#include <iostream>
#include <stdio.h>
#include <string.h>


using namespace std;
#define maxn 10009

char line[maxn];
int pre[maxn],suf[maxn],num[maxn];
int alf[30];
int p;
int size;

int cuantos()
{
	int mx = 0;
	for(int i = 0; i < 30; i++)
		mx = max(mx,alf[i]);
	return mx;
}

void sufix()
{
	int pos = 0;

	for(int i = size - 1; i >= 0; i--)
	{
		if(line[i] == '#')
			suf[p - 1 - pos++] = cuantos();
		else
			alf[line[i] - 'a']++;
	}
	suf[0] = cuantos();
	fill(alf,alf + 30,0);

}

void prefix()
{
	int pos = 0;
	for(int i = 0; line[i]; i++)
	{
		if(line[i] == '#')
			pre[pos++] = cuantos();
		else
			alf[line[i] - 'a']++;
	}
	pre[pos++] = cuantos();
	fill(alf,alf + 30,0);
}

void preprocess()
{
	for(int i = 0; line[i]; i++)
	{
		if(line[i] == '#')
		{
			num[p++] = cuantos();
			fill(alf,alf + 30,0);
		}
		else
			alf[line[i] - 'a']++;
	}
	num[p++] = cuantos();
	fill(alf,alf + 30,0);
}

void reset()
{
	fill(alf,alf + 30,0);
	fill(pre,pre + size,0);
	fill(suf,suf + size,0);
	fill(num,num + size,0);
	p = 0;
}

int main()
{
	int t;
	cin >> t;

	while(t--)
	{
		cin >> line;
		size = strlen(line);
		preprocess();
		sufix();
		prefix();
		//cout << p << endl;
		if(p < 3)
			cout << 0 << endl;
		else
		{
			/*for(int i = 0; i < p; i++)
				cout << num[i] << " ";
			cout << endl;
			for(int i = 0; i < p; i++)
				cout << pre[i] << " ";
			cout << endl;
			for(int i = 0; i < p; i++)
				cout << suf[i] << " ";
			cout << endl;
			 */
			int total = 0;
			for(int i = 0; i < p - 2; i++)
			{
				if(pre[i] != 0 && num[i + 1] != 0 && num[i + 2] != 0 && suf[i + 3] != 0)
					total = max(total, pre[i] + num[i + 1] + num[i + 2] + suf[i + 3]);
			}
			if(total != 0)
				cout << total + 3 << endl;
			else
				cout << 0 << endl;
		}
		reset();
	}
	return 0;
}
