# include<iostream>f
# include<cmath>
using namespace std;
int max(int sum[26])
{
    int val=0;
    for(int i=0;i<26;i++)
    {
        if(sum[i]>val)
        {
            val=sum[i];
        }
    }
    return val;
}            
int main()
{
    int t;
    cin>>t;
    for(int q=1;q<=t;q++)
    {
        char a[10000];
        cin>>a;
        int l;
        int count=0;
        for(l=0;a[l]!='\0';l++);
        for(int i=0;i<l;i++)
        {
            if(a[i]=='#')
            {
                count++;
            }
        }        
        //cout<<"count "<<count<<endl<<endl<<endl;
        int alpha[count+1][26];
        int sum[26]={0};
        //cout<<"asd"<<endl;
        int maxchar1[count+1];
        int maxchar2[count+1];
        //cout<<"zxc"<<endl;
        int count1=0;
        for(int i=0;i<=count;i++)
        {
            maxchar1[i]=0;
            maxchar2[i]=0;
            for(int j=0;j<26;j++)
            {
                alpha[i][j]=0;
            }
        }        
        //cout<<"qwe"<<endl;
        for(int i=0;a[i]!='\0';i++)
        {
            if(a[i]=='#')
            {
                count1++;
            }
            else
            {
                //cout<<"a[i]-97 "<<a[i]-97<<endl;
                alpha[count1][(a[i]-97)]+=1;
            }
        }
        /*for(int i=0;i<=count;i++)
        {
            for(int j=0;j<26;j++)
            {
                //cout<<alpha[i][j]<<"  ";
            }
            //cout<<endl<<endl;
        }*/        
        for(int i=0;i<=count;i++)
        {
            //int val=0;
            for(int j=0;j<26;j++)
            {
                sum[j]+=alpha[i][j];
            }
        }     
        //cout<<endl<<endl<<"sum"<<endl;
        /*for(int i=0;i<26;i++)
        {
            //cout<<sum[i]<<"  ";
        }*/
        //cout<<endl<<endl;    
        for(int i=count;i>=0;i--)
        {
            maxchar1[i]=max(sum);
            for(int j=0;j<26;j++)
            {
                sum[j]-=alpha[i][j];
            }
        }
        for(int i=0;i<26;i++)
        {
            sum[i]=0;
        }    
        for(int i=0;i<=count;i++)
        {
            for(int j=0;j<26;j++)
            {
                sum[j]+=alpha[i][j];
            }
        }    
        //cout<<endl<<"sum"<<endl;
        /*for(int i=0;i<26;i++)   
        {
            //cout<<sum[i]<<"  ";
        }*/
        //cout<<endl<<endl;          
        for(int i=0;i<=count;i++)
        {
            maxchar2[i]=max(sum);
            for(int j=0;j<26;j++)
            {
                sum[j]-=alpha[i][j];
            }
        }           
        /*for(int i=0;i<26;i++)
        {
            sum[i]=0;
        }    
        for(int i=0;i<=count;i++)
        {
            for(int j=0;j<26;j++)
            {
                sum[j]+=alpha[i][j];
            }
        }*/             
        //cout<<"maxchar1"<<endl<<endl;
        /*for(int i=0;i<=count;i++)
        {
            //cout<<maxchar1[i]<<"  ";
        }*/
        //cout<<endl<<endl;
        //cout<<"maxchar2"<<endl<<endl;
        /*for(int i=0;i<=count;i++)
        {
            //cout<<maxchar2[i]<<"  ";
        }*/
        //cout<<endl<<endl;        
        if(count1<3)
        {
            cout<<"0"<<endl;
        }
        else
        {
            int maxlength=0;
            for(int i=0;i<count-2;i++)
            {
                    int maxlen1=0;
                    int v1,v2,v3,v4;
                    v1=i;
                    v2=i+1;
                    v3=i+2;
                    v4=i+3;
                    maxlen1+=maxchar1[v1];
                    //cout<<"maxchar1 "<<maxchar1[v1]<<endl;
                    if(maxchar1[v1]==0)
                    {
                        continue;
                    }    
                    maxlen1+=max(alpha[v2]);
                    if(max(alpha[v2])==0)
                    {
                        continue;
                    }    
                    //cout<<"max(alpha[v2]) "<<max(alpha[v2])<<endl;
                    maxlen1+=max(alpha[v3]);
                    if(max(alpha[v3])==0)
                    {
                        continue;
                    }    
                    //cout<<"max(alpha[v3]) "<<max(alpha[v3])<<endl;
                    maxlen1+=maxchar2[v4];
                    if(maxchar2[v4]==0)
                    {
                        continue;
                    }    
                    //cout<<"maxchar2 "<<maxchar2[v4]<<endl;
                    maxlen1+=3;
                    if(maxlength<maxlen1)
                    {
                        maxlength=maxlen1;
                    }    
                }
                cout<<maxlength<<endl;
            }        
    }                        
//system("pause");
return 0;
}

