#include<iostream>
#include<cstdio>
#include<cstring>
using namespace std;
long long int maxi(long long int a,long long int b)
{
    if(a>b)
        return a;
    else
        return b;
}

int main()
{
    long long int t,l,k,f,g,p,i,j,count1[20000],count2[20000],count3[20000],maximum1,maximum2,maximum3,a[20000],b[20000],c[20000];
    char s[20000];
   cin>>t;
   while(t--)
   {
       maximum1=0;
       maximum2=0;
       maximum3=0;
       cin>>s;
       l=strlen(s);
       k=0;
       f=0;
       g=0;
       p=0;
       for(i=0;i<20000;i++)
       {
           count1[i]=0;
           count2[i]=0;
           count3[i]=0;

       }
       for(i=0;i<20000;i++)
       {
           a[i]=0;
           b[i]=0;
           c[i]=0;
       }
       for(i=0;i<l;i++)
       {
           if(s[i]=='#')
           f++;
       }
       for(i=0;i<l;i++)
       {
           if(s[i]!='#')
           {
               count1[s[i]]++;
           }
           else
           {

              for(j=97;j<=122;j++)
              {
                  maximum1=maxi(maximum1,count1[j]);
              }
              //maximum1=maxi(maximum1,count1['#']);
              a[k++]=maximum1;
               //count1[s[i]]++;
           }
       }
       for(i=l-1;i>=0;i--)
       {
           if(s[i]!='#')
           {
               count2[s[i]]++;
           }
           else
           {

               for(j=97;j<=122;j++)
               {
                   maximum2=maxi(maximum2,count2[j]);
               }
               //maximum2=maxi(maximum2,count2['#']);
               b[g++]=maximum2;
               //count2[s[i]]++;
           }
       }


       for(i=0;i<l;i++)
       {
           if(s[i]!='#')
           {
            count3[s[i]]++;
           }
           else
           {
               if(i==0)
                c[p++]=-20000;
               else if(s[i]==s[i-1])
             {
                 c[p]=-20000;
                 p++;
             }
             else
             {

maximum3=0;
   for(j=97;j<=122;j++)
             {
                 maximum3=maxi(maximum3,count3[j]);
                 count3[j]=0;
             }
             c[p++]=maximum3;
             }
           }
       }
       long long int answer=0;
       for(i=0;i<f-2;i++)
       {
           if(a[i]>0&&b[f-i-3]>0)
           answer=maxi(answer,a[i]+c[i+1]+c[i+2]+b[f-i-3]+3);
           //cout<<answer<<endl;
          //cout<<a[i]<<" "<<c[i+1]<<" "<<c[i+2]<<" "<<b[f-i-3]<<endl;

       }

       //cout<<b[0]<<b[1]<<endl;
       //cout<<a[0]<<b[0]<<c[0]<<endl;
       //cout<<c[1]<<c[2];

cout<<answer<<endl;
   }

return 0;
}
