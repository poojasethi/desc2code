#include <iostream>
#include <string.h>

using namespace std;
#define maxn 10009

char line[maxn];
int lcs[maxn];
int cant;
int alf[maxn];
int pos;

int pre[maxn];
int suf[maxn];

int cuantos()
{
	int total = 0;

	for(int i = 0; i < 150; i++)
		total = max(total,alf[i]);

	return total;
}

void solvepref()
{
	int p = 0;
	fill(alf,alf + 200,0);
	for(int i = 0; line[i]; i++)
	{
		if(line[i] == '#')
			pre[p++] = cuantos();
		else
			alf[line[i]]++;
	}
	pre[p] = cuantos();
}

void solvesuf()
{
	int p = 0;
	fill(alf,alf + 200,0);
	int size = strlen(line);
	for(int i = size - 1; i >= 0; i--)
	{
		if(line[i] == '#')
			suf[pos - p++] = cuantos();
		else
			alf[line[i]]++;
	}
	suf[pos - p] = cuantos();
}

void rellena()
{
	for(int i = 0; line[i]; i++)
	{
		if(line[i] == '#')
		{
			lcs[pos++] = cuantos();
			fill(alf,alf + 200,0);
		}
		else
			alf[line[i]]++;
	}
	lcs[pos] = cuantos();
}

int main()
{
	int t;
	cin >> t;

	while(t--)
	{
		fill(lcs,lcs + maxn,0);
		fill(pre,pre + maxn,0);
		fill(suf,suf + maxn,0);
		fill(alf,alf + 200 + 1,0);

		pos = 0;
		cin >> line;
		rellena();
		if(pos < 3)
		{
			cout << 0 << endl;
			continue;
		}
		/*if(pos == 3)
		{
			if(lcs[0] == 0 || lcs[1] == 0 || lcs[2] == 0 ||lcs[3] == 0)
			{
				cout << 0 << endl;
				continue;
			}

			int total = 0;
			for(int i = 0; i <= 3; i++)
				total += lcs[i];
			cout << total + 3 << endl;
			continue;
		}
*/

		solvepref();
		solvesuf();

/*
		cout << pos << endl;
		for(int i = 0; i <= pos; i++)
			cout << lcs[i] << " ";
		cout << endl;
		for(int i = 0; i <= pos; i++)
			cout << pre[i] << " ";
		cout << endl;
		for(int i = 0; i <= pos; i++)
			cout << suf[i] << " ";

		cout << endl;
*/
		int total = 0;

		for(int i = 0; i <= pos - 3; i++)
		{
			if(pre[i] != 0 && lcs[i + 1] != 0 && lcs[i + 2] != 0 && suf[i + 3] != 0)
			{
				total = max(total, pre[i] + lcs[i + 1] + lcs[i + 2] + suf[i + 3]);
				//cout << pre[i] << " " << lcs[i + 1] << " " << lcs[i + 2] << " " << suf[i + 3] << endl;
			}

		}
		if(total != 0)
			cout << total + 3 << endl;
		else
			cout << 0 << endl;

	}
	return 0;
}
