#include<iostream>
#include<stdio.h>
#include<string.h>
using namespace std;
int main()
{
     long long store[100]={0},k,a[100005],j,t,i,max,temp,tot[30]={0},maxtot=0,tot2[30]={0},maxtot2=0 , p[100005]={0},q[100005]={0},w,max2,max3,b[100005]={0};
     char s[100005];
     cin>>t;

     while(t--)
     {maxtot=0;
     maxtot2=0;
     max=0;
     max2=0;
     max3=0;
          k=0;
         scanf("%s",s);
         for(i=0;i<26;i++){tot[i]=tot2[i]=0;}
          for(i=0;i<10005;i++){a[i]=0;b[i]=0;p[i]=0;q[i]=0;}
         
         for(i=0;i<strlen(s);i++){
            if(s[strlen(s)-i-1]!='#')
              {
              tot2[s[strlen(s)-i-1]-'a']++;
               if(tot2[s[strlen(s)-i-1]-'a']>max3)
               {
               max3=tot2[s[strlen(s)-i-1]-'a'];b[strlen(s)-i-1]=max3;
               }
               else{b[strlen(s)-i-1]=max3;}
        
               }
               else{b[strlen(s)-i-1]=max3;}
         } 
           for(i=0;i<strlen(s);i++)
          {
                 
          max=0;
               if(s[i]!='#')
               {
               tot[s[i]-'a']++;
               if(tot[s[i]-'a']>max2){max2=tot[s[i]-'a'];}
               }

               if(s[i]=='#'||i==(strlen(s)-1) )
               {
               if(i==strlen(s)-1&&s[i]!='#')
               {store[s[i]-'a']++;}
                    max=store[0];
                    store[0]=0;
                    for(j=1;j<26;j++)
                    {
                         if(store[j]>max){max=store[j];}
                         store[j]=0;
                    }
                    if(max!=0){a[k]=max;p[k]=max2;q[k]=b[i];k++;}
                    if(max==0&&(i-1>=0)&&s[i-1]=='#'){a[k++]=-1000000;p[k-1]=max2;q[k-1]=b[i];}
               }
              else
               {
                  store[s[i]-'a']++;
               }
          }
               if(k<=3){cout<<"0"<<endl;continue;}
               max=0;
               temp=0;
               for(i=0;i<(k-3);i++)
               {
               //if(a[i]>0&&a[i+3]>0)
                   if(p[i]>0&&q[i+2]>0){
                    temp=p[i]+a[i+1]+a[i+2]+q[i+2];}
                    //}
                    
               if(temp>max){max=temp;}
               }
               if(max>0){cout<<max+3<<endl;}
               else{cout<<"0"<<endl;}

     }
         return 0;
}