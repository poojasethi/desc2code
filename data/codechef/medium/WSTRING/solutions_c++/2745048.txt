#include<iostream>
#include<vector>
#include<cstring>
using namespace std;

int find(vector<vector<int> > &occur,int u,int v){
	int m = 0;
	for(int j = 0;j<26;j++)
		m = max(m,occur[v][j]-occur[u][j]);
	return m>0?m:-100000;
}

int main(){
	int t;
	cin>>t;
	while(t--){
		string s;
		cin>>s;
		s = "#" + s + "#";
		vector<vector<int> > c(s.length(),vector<int>(26,0));
		vector<int> occurence(1,0);
		for(int i = 1;i<s.length();i++){
			for(int j = 0;j<26;j++){
				c[i][j] = c[i-1][j];
			}
			if(s[i] == '#')occurence.push_back(i);
			else c[i][s[i]-'a']++;
		}
		int n = s.size()-1;
		int answer = 0;
		for(int i = 4;i<occurence.size();i++){
		//	answer = max(answer,)
			answer = max(answer,find(c,0,occurence[i-3]) + find(c,occurence[i-3],occurence[i-2]) + find(c,occurence[i-2],occurence[i-1]) + find(c,occurence[i-1],n));
		}
		answer = answer>0?answer+3:0;
		cout<<answer<<endl;
	}
}
