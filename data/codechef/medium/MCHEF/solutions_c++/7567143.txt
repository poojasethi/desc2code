#include<bits/stdc++.h>
#define inc(x) scanf("%c",&x)
#define ins(x) scanf("%s",x)
#define in(x) scanf("%d",&x)
#define in2(x,y) scanf("%d%d",&x,&y)
#define in3(x,y,z) scanf("%d%d%d",&x,&y,&z)
#define inll(x) scanf("%lld",&x)
#define inll2(x,y) scanf("%lld%lld",&x,&y)
#define inll3(x,y,z) scanf("%lld%lld%lld",&x,&y,&z)
#define lli long long int
#define ou(x) printf("%d\n",x)
#define oull(x) printf("%lld\n",x)
#define ouf(x) printf("%f\n",x)
#define fli(i,x,y) for(int i=x;i<y;i++)
#define fld(i,x,y) for(int i=x;i>y;i--)
#define pb push_back
#define mp make_pair
#define vi vector<int>
#define pll pair<long long int ,long long int>
#define vll vector<long long int,long long int>
#define vl vector<long long int>
#define vs vector<string>
#define MOD 1000000007
#define INF 99999999
#define I int 
#define MAX 100009
using namespace std;
lli max_sum[MAX][510];
I test,i,j;
/*lli func(lli a,lli b)
{
	return (a>b?b:a);
}*/
int main()
{ 	
	in(test);
	while(test--)
	{ 	
		I n,k,m,l,r,cost,range[MAX];
		lli change,total=0;
		in3(n,k,m);
		pair<I,I> pair1;
			pair<I,pair<I,I> >plll ;
			vector< pair<I, pair<I,I> > > vpp;
		lli arr[MAX];
	
		for(i=1;i<=n;i++)
		{
			inll(arr[i]);
			total+=arr[i];
		}
			for(i=0;i<MAX;i++)
		range[i] = INT_MAX;
			for(i=0;i<m;i++)
		 	{
				in3(l,r,cost);
				pair1=mp(l,r);
				plll=mp(cost,pair1);
				vpp.pb(plll);
			}
		sort(vpp.begin(), vpp.end());
		for(i=0;i<501;i++)
		{		
			for(j=vpp[i].second.first; j<=vpp[i].second.second;j++)
			{	
			 	if(range[j]==INT_MAX)
				range[j]=vpp[i].first;  
				else if(range[j]>vpp[i].first)
				range[j]=vpp[i].first;
			}
		}
	for(i=0;i<=n;i++)
	{
		for(j=0;j<=k;j++)
			{
				if(i==0||j==0)
				max_sum[i][j]=0;
				else if (j>=range[i])
				max_sum[i][j]=min(max_sum[i-1][j], arr[i]+max_sum[i-1][j-range[i]]);
				else max_sum[i][j]=max_sum[i-1][j];
			}
	}
	if(max_sum[n][k]<0)
	change=(lli)(total-max_sum[n][k]);
	else
	change=total;
	cout<<change<<endl;
}
return 0;
}   