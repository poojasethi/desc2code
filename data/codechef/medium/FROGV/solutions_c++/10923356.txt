#include<iostream>
#include<algorithm>
using namespace std;
#define ll long long
struct frog{
  int in;
  int x;
};
bool compare(struct frog a,struct frog b){
   return (a.x>b.x);
}
int main(){
  int n,p,a,b;
  int k;
  cin>>n>>k>>p;
  struct frog arr[n];
  ll max_dis[n];
  for(int i=0;i<n;i++){
     cin>>arr[i].x;
     arr[i].in=i;
  }
  // precalculate
  sort(arr,arr+n,compare);
  
  max_dis[arr[0].in]=arr[0].x+k;
  for(int i=1;i<n;i++){
    if(arr[i-1].x-arr[i].x<=k)
    max_dis[arr[i].in]=max_dis[arr[i-1].in];
    else 
    max_dis[arr[i].in]=arr[i].x+k;
  }
  
   for(int i=0;i<p;i++){
    cin>>a>>b;
    if(max_dis[a-1]==max_dis[b-1]) cout<<"Yes"<<endl;
    else cout<<"No"<<endl;
  }
  return 0;
}