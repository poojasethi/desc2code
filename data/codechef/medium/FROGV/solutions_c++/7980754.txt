#include<bits/stdc++.h>
#define ll long long int
using namespace std;
ll mxd[1000000];
struct node
{
    int id;
    ll x;

}a[1000000];
bool comp(const node &a,const node &b)
{
    return a.x>b.x;
}
int main()
{
    int n,p,xx,yy;
    ll k;
    cin>>n>>k>>p;
    for(int i=0;i<n;i++)
    {
        cin>>a[i].x;
        a[i].id=i;
    }
    sort(a,a+n,comp);
    mxd[a[0].id]=a[0].x+k;
    for(int i=1;i<n;i++)
    {
        mxd[a[i].id]=i;
        if((a[i-1].x-a[i].x)<=k)
            mxd[a[i].id]=mxd[a[i-1].id];
        else
            mxd[a[i].id]=a[i].x+k;
    }
    while(p--)
    {
        cin>>xx>>yy;
        xx--;
        yy--;
        if(mxd[xx]==mxd[yy])
            cout<<"Yes\n";
        else
            cout<<"No\n";
    }
    return 0;
}
