#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
struct pairr{
	ll val;
	ll i;
};
bool comp(pairr a,pairr b)
{
	return a.val<=b.val;
}
int main()
{
	ll n,k,p;
	cin>>n>>k>>p;
	pairr a[n];
	for(ll i=0;i<n;i++)
	{
	cin>>a[i].val;
	a[i].i=i;}
	sort(a,a+n,comp);
	ll m[n];
	ll c[n-1];
	memset(c,0,sizeof(c));
	for(ll i=0;i<n-1;i++)
	{
		m[a[i].i]=i;
		if(a[i+1].val-a[i].val>k)
		{
			c[i]=-1;
			//c[i+1]=-1;
		}
		if(i!=0)
		c[i]+=c[i-1];
		//cout<<c[i]<<endl;
	}
	m[a[n-1].i]=n-1;
	for(ll i=0;i<p;i++)
	{
		ll b,d;
		cin>>b>>d;
		b--;
		d--;
		b=m[b];
		d=m[d];
		ll p;
		if(b<d)
		p=(b==0)?c[d-1]:c[d-1]-c[b-1];
		else if(b>d)
		p=(d==0)?c[b-1]:c[b-1]-c[d-1];
		else
		p=0;
		if(p==0)
		cout<<"Yes"<<endl;
		else
		cout<<"No"<<endl;
	}
	return 0;
}