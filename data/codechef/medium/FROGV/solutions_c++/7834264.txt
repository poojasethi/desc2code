#include<stdio.h>
#include<stdlib.h>
#include<cstdlib>
#include<string.h>
#include<math.h>
#include<time.h>
#include<algorithm>
#include<vector>
#include<map>
#include<iostream>
#include<functional>
#include<utility>
using namespace std;

#define gc getchar_unlocked
typedef unsigned long long ull;

void scanint(int &x);
void scanlong(ull &x);
int binarySearch(int[],int,int,int);

int main()
{
    int nVal,kVal,pVal;
    scanint(nVal);scanint(kVal);scanint(pVal);
    int inputArr[nVal];
    int helperArr1[nVal];
    int helperArr2[nVal];
    for(int i=0;i<nVal;++i)
    {
        scanint(inputArr[i]);
        helperArr1[i]=inputArr[i];
    }
    sort(helperArr1,helperArr1+nVal);
    int curVal = helperArr1[nVal-1];
    int cur_max_reach = curVal+kVal;
    helperArr2[nVal-1]=cur_max_reach;
    for(int i=nVal-2;i>=0;--i)
    {
        if( (helperArr1[i] + kVal) < curVal)
        {
                cur_max_reach = helperArr1[i] + kVal;
        }
        curVal = helperArr1[i];
        helperArr2[i]=cur_max_reach;
    }
    /*for(int i=0;i<nVal;++i)
    {
        printf("%d %d\n",helperArr1[i],helperArr2[i]);
    }*/
    for(int i=0;i<pVal;++i)
    {
        int left,right;
        scanint(left);scanint(right);
        int val1 = inputArr[left-1];
        int val2 = inputArr[right-1];
        //printf("%d %d\n",val1,val2);
        int index_val1 = binarySearch(helperArr1,0,nVal-1,val1);
        int index_val2 = binarySearch(helperArr1,0,nVal-1,val2);
        //printf("%d %d\n",index_val1,index_val2);
        if(helperArr2[index_val1] == helperArr2[index_val2])
            printf("Yes\n");
        else
            printf("No\n");
    }
        return 0;
}

int binarySearch(int arr[],int left,int right,int val)
{
    while(right >= left)
    {
        int mid = left + (right - left)/2;
        if(arr[mid] == val)
            return mid;
        if(arr[mid] > val) right = mid-1;
        else left=mid+1;
    }
}

void scanint(int &x)
{
        int flag=0;
        register int c = gc();
        if(c == '-') flag=1;
	x = 0;
	for(;(c<48 || c>57);c = gc());
	for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
        if(flag == 1)x=-x;
}

void scanlong(ull &x)
{
        int flag=0;
        register int c = gc();
        if(c == '-') flag=1;
	x = 0;
	for(;(c<48 || c>57);c = gc());
	for(;c>47 && c<58;c = gc()) {x = (x<<1) + (x<<3) + c - 48;}
        if(flag == 1)x=-x;
}

