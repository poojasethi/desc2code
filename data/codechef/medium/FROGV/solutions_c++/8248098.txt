#include <bits/stdc++.h>
using namespace std;

struct node{
	int ind , x ;	
};

bool cmp(const node& a , const node& b){
	return b.x>a.x;
}
int main() {
	int n , k , p , max_d[100005] , x , y;
	node a[100005];
	scanf("%d%d%d" , &n , &k , &p);
	for(int i=0 ; i<n ; i++) { scanf("%d" , &a[i].x); a[i].ind=i+1; }
	sort(a , a+n , cmp);
	
	max_d[a[n-1].ind]=a[n-1].x + k;
	for(int i=n-2 ; i>=0 ; i--) max_d[a[i].ind]=(a[i+1].x-a[i].x <= k)?(max_d[a[i+1].ind]):(a[i].x+k);
	
	while(p--){
		scanf("%d%d" , &x , &y);
		if(max_d[x]==max_d[y]) cout<<"Yes\n";
		else cout<<"No\n";
	}
	return 0;
}