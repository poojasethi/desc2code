#include<iostream>
#include<algorithm>
#define mod 1000000007
typedef long long ll;
using namespace std;
ll a[10000005],pr[10000005],sf[10000005];
int main()
{	//freopen("scl2.txt","r",stdin);
	ll n,k,q;
	cin>>n>>k>>q;
	ll ar,b,c,d,e,f,r,s,t,m,a1;
	ll l1,la,lc,lm,d1,da,dc,dm;
	cin>>ar>>b>>c>>d>>e>>f>>r>>s>>t>>m>>a1;
	cin>>l1>>la>>lc>>lm>>d1>>da>>dc>>dm;
	
	a[0]=a1;
	ll pw=t;
	for(int i=1;i<n;i++)
	{
		pw=(pw*t)%s;
		if(pw<=r)
		{
			a[i]=(a[i-1]*(ar*a[i-1] + b)%m + c%m)%m;
		}
		else
		a[i]=(a[i-1]*(d*a[i-1] + e)%m+ f%m)%m;
	}
	
/*	for(int i=0;i<n;i++)
	cout<<a[i]<<" ";
	cout<<"\n";*/
	
	//computing prefix array
	ll c1=n%k,m1=a[n-1];
	for(int i=n-1;i>=0;i--)
	{
		if(c1==0)
		{
			c1=k;
			m1=a[i];
		}
		m1=min(m1,a[i]);
		pr[i]=m1;
		c1--;
	}
	//computing suffix array
	ll c2=0,m2=a[1];
	for(int i=0;i<n;i++)
	{
		if(c2==k)
		{
			c2=0;
			m2=a[i];
		}
		m2=min(m2,a[i]);
		sf[i]=m2;
		c2++;
	}
	
	/*for(int i=0;i<n;i++)
	cout<<sf[i]<<" ";
	cout<<"\n";
	for(int i=n-1;i>=0;i--)
	cout<<pr[i]<<" ";
	cout<<"\n";*/
	ll l,rit;
	ll sm=0,mlt=1;
	for(int i=1;i<=q;i++)
	{
		l1=((l1*la)%lm + lc%lm)%lm;
		d1=((d1*da)%dm+ dc%dm)%dm;
		l=l1+1;
		rit=min(l+k-1+d1,n);
		//cout<<l<<rit<<"\n";
		
		ll mn;
			mn=min(pr[l-1],sf[rit-1]);
			if(((l-1)/k)==((rit-1)/k-2))
			mn=min(mn,sf[(rit-rit%k)-1]);
		
		sm+=mn;
		
		mlt=(mlt*mn)%mod;
		mlt%=mod;
		
	}
	
	cout<<sm<<" "<<mlt<<"\n";
	return 0;
}