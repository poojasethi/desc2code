#include<bits/stdc++.h>
 
using namespace std;
 
#define MAX(a,b) ((a)>(b)?(a):(b))
#define MIN(a,b) ((a)<(b)?(a):(b))
 
#define REP(i,a,b) for(i=a;i<b;i++)
#define rep(i,b) for(i=0;i<b;i++)
#define rep1(i,b) for(i=1;i<=b;i++)
 
#define plln(n) printf("%lld\n",n)
 
#define s3ll(n1,n2,n3) scanf("%lld%lld%lld",&n1,&n2,&n3)
#define s2ll(n1,n2) scanf("%lld%lld",&n1,&n2)
#define sll(n) scanf("%lld",&n)
 
typedef long long LL;
 
#define mod 1000000007
#define mx 1000000
 
const int maxn = 100 * 100100;
 
int x[maxn];
int z[maxn];
 
deque<int> dq;
 
 
int main()
{
    int n, k, q;
	scanf("%d%d%d", &n, &k, &q);
	{
		int a, b, c, d, e, f, r, s, t, m, T;
		scanf("%d%d%d%d%d%d%d%d%d%d%d", &a, &b, &c, &d, &e, &f, &r, &s, &t, &m, &x[0]);
		T = t;
		for(int i = 1; i < n; i++) {
			T = T * t % s;
			if(T <= r) {
				x[i] = (x[i - 1] * (a * 1ll * x[i - 1] + b) + c) % m;
			} else {
				x[i] = (x[i - 1] * (d * 1ll * x[i - 1] + e) + f) % m;
			}
		}
		for(int i=0;i<n;i++)
        {
            while((!dq.empty())&&(dq.back()>x[i]))
                dq.pop_back();
 
            dq.push_back(x[i]);
 
            if((i>=k)&&(x[i-k]==dq.front())) dq.pop_front();
            if(i>=k-1){
                z[i-k+1]=dq.front();
            }
        }
	}
	{
		int l1, la, lc, lm, d1, da, dc, dm;
		scanf("%d%d%d%d%d%d%d%d", &l1, &la, &lc, &lm, &d1, &da, &dc, &dm);
		int l, r;
		LL sum = 0, mul = 1;
		for(int i = 0; i < q; i++) {
			l1 = (la * 1ll * l1 + lc) % lm;
			d1 = (da * 1ll * d1 + dc) % dm;
			l = l1 + 1;
			r = min(l + k - 1 + d1, n);
			l--, r--;
			LL mn = min(z[l], z[r - k + 1]);
			sum += mn;
			mul = (mul * mn) % mod;
		}
		cout << sum << " " << mul << endl;
	}
	return(0);
    return 0;
}