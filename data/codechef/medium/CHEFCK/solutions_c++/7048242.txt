#include<stdio.h>
#include<string.h>
#include<math.h>
#include<algorithm>
#include<string>
#include<queue>
#include<map>
#include<iostream>
#include<vector>
#define MAX 100
#define MOD 1000000007
#define pb push_back
#define mp make_pair
#define scll(t) scanf("%lld",&t)
#define scl(t) scanf("%ld",&t)
#define sc(t) scanf("%d",&t)
#define max(a,b) a>b?a:b
#define min(a,b) a<b?a:b
#define ll long long
#define fre freopen("in.txt","r",stdin),freopen("out.txt","w",stdout)
using namespace std;
ll arr[10000000+5];
ll brr[10000000+5];
ll te[10000000+5];
deque<ll>q;
ll n,qu,k,a,b,c,d,e,f,r,s,t,m,l1,y,la,lc,lm,d1,da,dc,dm,i,L,R,qwe,sum,mul;
void gen()
{
	
	q.clear();
	for(i=0;i<k;i++)
	{
		while(!q.empty()&&arr[i]<=arr[q.back()])
			q.pop_back();
		q.push_back(i);
	}
	
	for(i=k;i<n;i++)
	{
		
		brr[i-k]=arr[q.front()];
		
		while(!q.empty()&&arr[i]<=arr[q.back()])
			q.pop_back();
		while(!q.empty()&&q.front()<=i-k)
			q.pop_front();
		q.push_back(i);
	}
	brr[n-k]=arr[q.front()];
}
int main()
{	

	scanf("%lld%lld%lld",&n,&k,&qu);
	scanf("%lld%lld%lld%lld%lld%lld%lld%lld%lld%lld%lld",&a,&b,&c,&d,&e,&f,&r,&s,&t,&m,&arr[0]);
	scanf("%lld%lld%lld%lld%lld%lld%lld%lld",&l1,&la,&lc,&lm,&d1,&da,&dc,&dm);
	te[1]=t;
	sum=0;
	mul=1;
	for(i=2;i<=n;i++)
	{
		te[i]=(te[i-1]*t)%s;
	}
	for(i=1;i<n;i++)
	{
		if(te[i+1]<=r)
			arr[i]=(a*arr[i-1]*arr[i-1]+b*arr[i-1]+c)%m;
		else
			arr[i]=(d*arr[i-1]*arr[i-1]+e*arr[i-1]+f)%m;
	}
	gen();
	ll tre;
	for(i=1;i<=qu;i++)
	{
		l1=(la*l1+lc)%lm;
		d1=(da*d1+dc)%dm;
		L=l1+1;
		R=min(L+k-1+d1,n);
		tre=min(brr[L-1],brr[R-k]);
		sum+=tre;
		mul=(mul*tre)%MOD;
	}
	printf("%lld %lld",sum,mul);
	
	return 0;
}