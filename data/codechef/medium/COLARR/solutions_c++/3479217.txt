#include <iostream>
#include <algorithm>
using namespace std;

#define maxnm 1001

int b[maxnm][maxnm], c[maxnm][maxnm];
int a[maxnm], changed[maxnm];

int main() {
    ios::sync_with_stdio(false);
    int t;
    cin >> t;
    while(t--) {
        int n, m, k, start, dif;
        cin >> n >> m >> k;
        int sum = 0;
        for(int i=1;i<=n;++i) {
            cin >> a[i];
            changed[i] = 0;
        }
        for(int i=1;i<=n;++i) for(int j=1;j<=m;++j) cin >> b[i][j];
        for(int i=1;i<=n;++i) for(int j=1;j<=m;++j) cin >> c[i][j];
        for(int i=1;i<=n;++i) {
            start = b[i][a[i]];
            sum += start;
            dif=0;
            for(int j=1;j<=m;++j) {
                if((b[i][j]-c[i][j])>dif) dif = b[i][j]-c[i][j];
            }
            changed[i] = dif-start;
            if(changed[i]<0) changed[i] = 0;
        }
        sort(changed+1,changed+n+1);
        for(int i=n; k>0&&i>=1; --i,--k) sum=sum+changed[i];
        cout << sum << endl;
    }
    return 0;
}
