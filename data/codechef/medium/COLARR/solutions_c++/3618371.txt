#include <iostream>
using namespace std;
#include <stdio.h>
#include <vector>
#include <algorithm>
int main(){
	int n,m,k,i,j,t,ans;
	scanf("%d",&t);
	while(t--){
		ans=0;
		scanf("%d%d%d",&n,&m,&k);
		int initial[n];
		for(i=0;i<n;i++){
			scanf("%d",initial+i);
		}
		int B[n][m];
		for(i=0;i<n;i++){
			for(j=0;j<m;j++)
				scanf("%d",&B[i][j]);
		}
		j=0;
		for(i=0;i<n;i++){
			ans+=B[i][initial[j++]-1];
		}
		int C[n][m];
		for(i=0;i<n;i++){
			for(j=0;j<m;j++)
				scanf("%d",&C[i][j]);
		}
		int opt_dif[n];
		std::vector<int> v;
		v.push_back(0);
		for(i=0;i<n;i++){
			int max=0;
			int index=0;
			for(j=0;j<m;j++){
				if(B[i][j]-C[i][j]>max){
					max=B[i][j]-C[i][j];
					index=j;
				}
			}
			//cout<<"i "<<i<<" max "<<max<<" "<<max-B[i][initial[i]-1]<<endl;
			if(max-B[i][initial[i]-1]>0)
				v.push_back(max-B[i][initial[i]-1]);
		}
		sort(v.begin(),v.end(),greater<int>());
		/*for(i=0;i<v.size();i++){
			cout<<v[i]<<" ";
		}cout<<endl;*/
		for(i=0;i<v.size()&&i<k;i++){
			ans+=v[i];
		}
		cout<<ans<<endl;
	}


return 0;	
}
























