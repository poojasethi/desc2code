#include<bits/stdc++.h>
using namespace std;
//#define gc getchar//_//unlocked

#include<stdio.h>
#define GETCHAR getchar_unlocked
inline int readInt()
{
int flag=1;
int n = 0;
char c;
while (1)
{
c=GETCHAR();
if(c>='0'&&c<='9') {n = n * 10 + c - '0';flag=0;}
else if(flag!=1) break;
}
return n;
}



struct node{
	int inC;
	int maxx;
	int prof[1002];
	int input[1002];
	int output[1002];
bool operator () (const node & a,const node &b){
	return a.maxx > b.maxx;
}
};
	node no[1002];	
//-----------------------

//------------------------
int main(){
	int t;
	t=readInt();
	while(t--){
		int n,m,k,take;
		n=readInt();
		m=readInt();
		k=readInt();
		for(int i=1;i<=n;i++){
			no[i].inC=readInt();
		}
		for(int i=1;i<=n;i++)
		{
			for(int j=1;j<=m;j++)
			no[i].input[j]=readInt();
			//cin>>no[i].prof;
		}
		for(int i=1;i<=n;i++)
		{
			for(int j=1;j<=m;j++)
			{
				no[i].output[j]=readInt();
				no[i].prof[j] = (no[i].input[j] - no[i].output[j])-no[i].input[no[i].inC];
			}
		}
		//--------------------
		int mm=INT_MIN;
		for(int i=1;i<=n;i++){
			mm=INT_MIN;
			for(int j=1;j<=m;j++)
				if(mm<no[i].prof[j])
					mm = no[i].prof[j];
			no[i].maxx = mm;
		}
	//-------------------------		
		sort(no+1,no+1+n,node());
		int ans=0;
		
		for(int i=1;i<=k;i++)
		if(no[i].maxx>0)
		ans += no[i].maxx;
		
		for(int i=1;i<=n;i++)
			ans += no[i].input[no[i].inC];
		cout<<ans<<endl;
	}
}
		
		
		