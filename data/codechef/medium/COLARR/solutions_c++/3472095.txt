#include<algorithm>
#include<iostream>
#include<stdio.h>
using namespace std;
int main(){
	int i,j,t,n,m,k,respuesta,a[1001],b[1001][1001],c[1001][1001],dp[1001];
	scanf("%d",&t);
	while(t--){
		scanf("%d%d%d",&n,&m,&k);
		for(i=0;i<n;i++){
			scanf("%d",&a[i]);
			dp[i]=0;
		}
		for(i=0;i<n;i++)
			for(j=0;j<m;j++)
				scanf("%d",&b[i][j]);
		for(i=0;i<n;i++)
			for(j=0;j<m;j++)
				scanf("%d",&c[i][j]);
		//fill(dp,dp+n,0);
		for(i=0;i<n;i++)
			for(j=0;j<m;j++)
				dp[i]=max(b[i][j]-b[i][a[i]-1]-c[i][j],dp[i]);
	    respuesta=0;
		for(j=0;j<n;j++)
			respuesta+=b[j][(a[j]-1)];
		sort(dp,dp+n);
		reverse(dp,dp+n);
		for(j=0;j<k;j++)
			respuesta+=dp[j];
		printf("%d\n",respuesta);
	}
	return 0;
}