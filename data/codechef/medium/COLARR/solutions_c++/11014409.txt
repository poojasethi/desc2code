#include <bits/stdc++.h>
#define mod 1000000007
#define ll long long int
#define pb(x) push_back(x)
#define MP(x,y) make_pair(x,y)
using namespace std;
ll b[1001][1001],c[1001][1001],a[1001],ans[1000001];
void solve()
{
	ll n,m,k,i,j,z=0,x=0;
	ll sum=0,maxi;
	scanf("%lld%lld%lld",&n,&m,&k);
	for(i=0;i<n;i++)
		scanf("%lld",&a[i]);
	for(i=0;i<n;i++)
		for(j=0;j<m;j++)
			scanf("%lld",&b[i][j]);
	for(i=0;i<n;i++)
		for(j=0;j<m;j++)
			scanf("%lld",&c[i][j]);
	for(i=0;i<n;i++)
	{
		sum+=b[i][a[i]-1];
	}
	for(i=0;i<n;i++)
	{
		maxi=b[i][0]-c[i][0]-b[i][a[i]-1];
		for(j=0;j<m;j++)
		{
			maxi=max(b[i][j]-c[i][j]-b[i][a[i]-1],maxi);
		}
		ans[z]=maxi;
		z++;
	}	
	sort(ans,ans+n);
	i=z-1;
	while(x<k && i>=0)
	{
		if(ans[i]>0)
		{
			sum+=ans[i];
			x++;
		}	
		i--;
	}
	printf("%lld\n",sum);
}
int main()
{
    int t;
    cin>>t;
    while(t--)
        solve();
    return 0;
}  