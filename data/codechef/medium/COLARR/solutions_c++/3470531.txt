#include<iostream>
#include<stdio.h>
#include<stdlib.h>
#include<algorithm>
using namespace std;
typedef struct alll
{
    int val;
    int changed;
    int ind;
}array;
bool compare(array a, array b)
{
  //  printf("%d %d\n",a.changed,b.changed);
    if(a.changed<b.changed)return true;
    else return false;
//    return (a.changed - b.changed);
}
int main()
{
    int t;
    scanf("%d",&t);
    
    while(t--)
    {
	//	printf("SD");
	int n,m,i,j;
	int k,max[1009],value=0,index=0,arrval,maxval;
	int get[1009][1009],net[1009][1009];
	array arr[1009];
	scanf("%d%d%d",&n,&m,&k);
	for(i=0;i<n;i++)
	{
	    scanf("%d",&arr[i].val);
	    arr[i].ind=i;
	}
	for(i=1;i<=n;i++)
	    for(j=1;j<=m;j++)
		scanf("%d",&get[i][j]);
	//	printf("WEWE");
	for(i=1;i<=n;i++)
	{
	    arrval=maxval=-10000009;
	    for(j=1;j<=m;j++)
	    {
		scanf("%d",&net[i][j]);
		net[i][j]*=-1;
		net[i][j]+=get[i][j];
		net[i][j]-=get[i][arr[i-1].val];
		if(net[i][j]>maxval)
		{
		    maxval=net[i][j];
		    arrval=get[i][arr[i-1].val];
		}
	    }
	    if(maxval>0)
	    {
		index++;
		arr[i-1].changed=maxval; //  -get[i][arr[i].val];
	    }
	    else
	    {
//		value+=get[i][arr[i].val];
		arr[i-1].changed=-1;
	    }
	}
	sort(arr,arr+n,compare);
/*	for(i=0;i<n;i++)
	    printf("%d ",arr[i].changed);
	printf("\n\n");
*/	value=0;
	for(i=n-1;(i>=n-k && i>=n-index);i--)
	{
	    value+=arr[i].changed+get[arr[i].ind+1][arr[i].val];
//	    printf("A%d \n",arr[i].changed);
	}
	for(j=i;j>=0;j--)
	{
	    value+=get[arr[j].ind+1][arr[j].val];	
//	    printf("%d\n",get[arr[j].ind+1][arr[j].val]);
	}
	printf("%d\n",value);
    }
    return 0;
}
