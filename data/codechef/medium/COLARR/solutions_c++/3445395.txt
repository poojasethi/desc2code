#include <iostream>
#include <cstdio>
#include <algorithm>
using namespace std;

int scan()
{ int noRead=0;
    char p= getchar();
    for(;p<33;)
    { p=getchar(); }
    while(p>32)
        {
            noRead = (noRead << 3) + (noRead << 1) + (p - '0');
            p=getchar();
        }
    return noRead;
}

int a[1001];
int b[1001][1001];
int c[1001][1001];
int delta[1001];
int main(void){
    int n, m , k;
    int t = scan();
    while(t--){
    n = scan();
    m = scan();
    k = scan();
    for ( int i = 1; i <= n; i++)
        a[i] = scan();

   for ( int i = 1; i <= n; i++)
        for ( int j = 1; j <= m; j++){
            b[i][j] = scan();
   }

   for ( int i = 1; i <= n; i++)
        for ( int j = 1; j <= m; j++){
            c[i][j] = scan();
   }

    for ( int i = 1; i <= n; i++){
        delta[i] = 0;
        for ( int j = 1; j <= m ; j++ )
            delta[i] = max(delta[i], b[i][j] - b[i][a[i]] - c[i][j]);
    }

    sort(delta+1,delta+n+1,greater<int>());
    int ans = 0;
    for ( int i = 1; i <= n; i++)
        ans += b[i][a[i]];
    for ( int i = 1; i <= k ; i++)
        ans += delta[i];
    printf("%d\n",ans);
    }

    return 0;
}
