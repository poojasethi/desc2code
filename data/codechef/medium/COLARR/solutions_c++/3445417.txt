#include <iostream>
#include <cstdio>
#include <algorithm>
using namespace std;
char buf[58000000];
 
int a[1001];
int b[1001][1001];
int c[1001][1001];
int delta[1001];
 
int scan() {
int m;
static char *bp=buf;
if(*bp<'0' || *bp>'9')
*bp++;
for(m=*bp++-48; *bp>=48; bp++) m = m*10+*bp-48;
bp++;
return m;
}
 
int main(void){
fread(buf, 1, 51000100, stdin);
int n, m , k;
int t = scan();
while(t--){
n = scan();
m = scan();
k = scan();
for ( int i = 1; i <= n; i++)
a[i] = scan();
 
for ( int i = 1; i <= n; i++)
for ( int j = 1; j <= m; j++){
b[i][j] = scan();
}
 
for ( int i = 1; i <= n; i++)
for ( int j = 1; j <= m; j++){
c[i][j] = scan();
}
 
for ( int i = 1; i <= n; i++){
delta[i] = 0;
for ( int j = 1; j <= m ; j++ )
delta[i] = max(delta[i], b[i][j] - b[i][a[i]] - c[i][j]);
}
 
sort(delta+1,delta+n+1);
int ans = 0;
for ( int i = 1; i <= n; i++)
ans += b[i][a[i]];
for ( int i = 1; i <= k ; i++)
ans += delta[n-i+1];
printf("%d\n",ans);
}
 
return 0;
}