#include <algorithm>
#include <cstdio>
#include <iostream>
#include <cstring>
#include <sstream>
#include <vector>
#include <cmath>
#include <set>
#include <map>

using namespace std;

int main()
{
	//freopen("input.txt","r",stdin);

	int t,n,money;
	string str1,str2;
	cin>>t;
	while(t--)
    {
        map<string,pair<string,int> > stod,dtos;

        cin>>n;
        for(int i=1;i<n;i++)
        {
            cin>>str1>>str2;
            //cout<<str1<<"   "<<str2<<endl;
            scanf(" %d$",&money);
            pair<string,int> p(str2,money);
            pair<string,int> r(str1,money);
            stod[str1]=p;
            dtos[str2]=r;
        }
        string source="";
        map<string,pair<string,int> >::iterator finder;
        for(map<string,pair<string,int> >::iterator itr=stod.begin();itr!=stod.end();itr++)
        {
            //cout<<itr->first<<"  "<<itr->second.first<<"   "<<itr->second.second<<endl;
            if(dtos.find(itr->first)==dtos.end())
            {
                source=itr->first;
                finder=itr;
                break;
            }
        }
        int sum=0;
        while(source!="")
        {
            cout<<finder->first<<" "<<finder->second.first<<" "<<finder->second.second<<"$"<<endl;
            sum+=finder->second.second;
            finder=stod.find(finder->second.first);
            if(finder!=stod.end())
                source=finder->first;
            else
                source="";
        }
        cout<<sum<<"$"<<endl;

    }
	return 0;
}
