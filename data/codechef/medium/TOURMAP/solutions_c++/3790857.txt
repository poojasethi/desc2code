#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <cmath>
#include <cstring>
#include <cctype>
#include <vector>
#include <set>
#include <map>
#include <algorithm>
#include <numeric>
#include <bitset>

#define lld long long
#define llu unsigned long long

#define rep(i,x,y) for(i=x;i<y;i++)
#define rrep(i,x,y) for(i=x;i>=y;i--)
#define trv(y,x) for(typeof(x.begin())y=x.begin();y!=x.end();y++)

using namespace std;
map<string,pair<string,int> >M;
map<string,int> V;
vector<string> A;
int main()
{
	int t,i,n,TotalCost;
	string s;
	cin>>t;
	while(t--)
    {
        cin>>n;
        TotalCost=0;
        rep(i,0,n-1)
            {
                cin>>s;
                cin>>M[s].first;
                scanf("%d$",&M[s].second);
                TotalCost+=M[s].second;
                A.push_back(s);
                V[M[s].first]=1;
            }
         trv(it,A)
            if(V[*it]!=1)
                {
                    s=*it;
                    break;
                }
         rep(i,0,n-1)
         {
             cout<<s<<" "<<M[s].first<<" "<<M[s].second<<"$\n";
             s=M[s].first;
         }
         cout<<TotalCost<<"$\n";
         M.clear();
         A.clear();
         V.clear();
    }
    return 0;

}
