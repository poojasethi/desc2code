#include<bits/stdc++.h>
#define LL long long int
#define sc(x) scanf("%d",&x)
#define sl(x) scanf("%lld",&x)
#define pf(x) printf("%d\n",x)
#define pl(x) printf("%lld\n",x)
#define pb push_back
#define MAX 100005
#define M 1000000007
using namespace std;
 
int d[MAX],b[MAX];
 
bool A[MAX+1];
void sieve()
{
  A[1]=1;
  for(int i=4;i<=MAX;i+=2)
  A[i]=1;
  for(int i=3;i*i<=MAX;i+=2)
  for(int j=i*i;j<=MAX;j+=2*i)
  A[j]=1;
 }
 
 int main ()
{
	sieve();
	int t,n,k,x,y,l;LL s;
	sc(t);
	set<int> z;
	set<int>::iterator it;
	while(t--)
	{
		sc(n);
		k=0;
			  for(int i=0;i<n;i++)
    {
        cin>>d[i];
        b[i]=0;
    }
                    
     for(int i=0;i<n;i++)
 
                               if(b[i]==0)
                               {
                               	k=0;
                               b[i]=1;
                               k++;
                               for(int j=d[i]-1;j!=i;j=d[j]-1)
                               {
                               k++;
                               b[j]=1;
                               }
                               
      z.insert(k);
	}
	
	int  B[MAX+1];
	for(int i=0;i<=MAX;i++)
	{
		B[i]=0;
	}
	s=1;
	for(it=z.begin();it!=z.end();it++)
	{
		x=*it;
	for(int i=2;i<=x;i++)
	{
		if(A[i]==0)
		{
			int mp=0;
			while(x%i==0)
			{
				x=x/i;
				mp++;
			}
			if(mp>B[i])
			{
				B[i]=mp;
			}
		}
	}				
	}
	it=z.end();
	it--;
	x=*it;
	for(int i=2;i<=x+1;i++)
	{
		if(A[i]==0)
		{
			y=B[i];
			while(y--)
			{
				s=((s%M)*i)%M;
			}
		}
	}
		pl(s%M);
	z.clear();
	}
 
return 0;                               
}