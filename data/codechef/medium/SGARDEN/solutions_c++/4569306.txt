#include<iostream>
using namespace std;
 
long long a[100009],b[100009],c[100009],p[10000];
 
int main()
{
	long long t,i,j,count,cnt;
	
	a[0]=a[1]=1;
	for(i=2;i*i<=100001;i++)
	{
		if(a[i]==0)
		{
			j=i*i;
			for(;j<=100001;j+=i)	
			a[j]=1;
		}
	}
	count=0;
	for(i=2;i<=100001;i++)
	{
		if(a[i]==0)
		{ p[count]=i;count++;}
	}
	//cout<<count<<endl;
	cnt=count;
	
	cin>>t;
	while(t--)
	{
		long long n,total_loops=0,max=0,ans=1,flag;
		cin>>n;
		for(i=1;i<=n;i++)
		{cin>>a[i]; b[i]=0;}
 
		for(i=1;i<=n;i++)
		{
			if(b[i]==0)
			{
				b[i]=1;
				j=i;
				count=1;
				while(i!=a[j])
				{
					j=a[j];
					b[j]=1;
					count++;
				}
				if(count>max)
				max=count;
				c[total_loops++]=count;
			}
		}
		//for(j=0;j<total_loops;j++)
		//cout<<c[j]<<"  ";
		//cout<<endl;	
		j=0;
		while(p[j]<=max&&j<cnt)
		{
			flag=0;
			for(i=0;i<total_loops;i++)
			{
				if(c[i]%p[j]==0)
				{ c[i]/=p[j]; flag=1; }
			}
			if(flag==1)
			{
				ans=(ans*p[j])%1000000007;
			}
			else
			j++;
		}	
		cout<<ans<<endl;
	}
	return 0;
}
 