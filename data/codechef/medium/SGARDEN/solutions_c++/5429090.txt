/*
user  : triveni
date  : 04/07/2014
time  : 15:52:26
*/
#include <bits/stdc++.h>

using namespace std;

#define      pii               std::pair<int,int>
#define      vi                std::vector<int>
#define      mp(a,b)           std::make_pair(a,b)
#define      X                 first
#define      Y                 second

typedef long long LL;
LL MOD = 1000000007;

vector<pii> fact[100001];
vi ans;
int f[100001];

LL pow_(LL a, LL b, LL mod){
	LL ans = 1;
	while(b)
	{
		if(b&1) ans = ans * a % mod;
		a = a * a % mod;
		b >>= 1;
	}
	return ans;
}

void factorize(int ct)
{
	if(fact[ct].size()) return ;
	if(ct == 1){
		fact[1].push_back(mp(1,1));
		return;
	}
	int n = ct;
	for(int i=2;i*i<=n;++i)
	{
		int c = 0;
		while(n%i==0)
		{
			++c;
			n/=i;
		}
		if(c) fact[ct].push_back(mp(i,c));
	}
	if(n != 1) fact[ct].push_back(mp(n,1));
	return ;
}
void doit()
{
	for(int i=0;i<ans.size();++i)
	{
		for(int j=0;j<fact[ans[i]].size();++j)
		{
			pii p = fact[ans[i]][j];
			f[p.X] = max(f[p.X], p.Y);
		}
	}
	LL an = 1;
	for(int i=1;i<=100000;++i)
		an = an * pow_(i,f[i], MOD)  % MOD;
	printf("%lld\n",an);
}
int main()
{
	int T, N,A[100001];
	scanf("%d",&T);
	while(T--)
	{
		scanf("%d",&N);
		for(int i=1;i<=N;++i)
			scanf("%d",A+i);
		ans.clear();
		memset(f,0,sizeof f);
		for(int i=1;i<=N;++i)
		{
			int ct = 0, id = i;
			while(A[id])
			{
				int tmp = A[id];
				A[id] = 0;
				id = tmp;
				ct++;
			}
			if(ct) factorize(ct), ans.push_back(ct);
		}
		doit();
	}
	return 0;
}
