     #include <iostream>
    #include <algorithm>
    #define MOD 1000000007
    using namespace std;
     
    int main()
    {
    int t,n;
     
    cin >> t;
     
    while(t--)
    {
    cin >> n;
     
    int order[n+1], mark[n+1], cycle[n], k=0;
     
    for(int i=1; i<=n; i++)
    {
    cin >> order[i];
    mark[i] = false;
    }
     
    for(int i=1; i<=n; i++)
    {
    if(!mark[i])
    {
    int next = order[i], c=0;
    mark[i] = true;
     
    while(next != i)
    {
    mark[next] = true;
    c++;
    next = order[next];
    }
     
    cycle[k++] = c+1;
    }
    }
     
    int maxpw[n+1];
    fill(maxpw, maxpw+n+1,0);
     
    for(int i=0; i<k; i++)
    {
    int m = cycle[i];
     
    for(int j=2; j*j<=m; j++)
    {
     
    int p=0;
     
    while(m%j==0)
    {
    m=m/j;
    p++;
    }
     
    maxpw[j] = max(maxpw[j],p);
    }
     
    if(m!=1)
    maxpw[m] = max(maxpw[m],1);
    }
     
    long long int prod = 1;
    for(int i=2; i<=n; i++)
    for(int j=0; j<maxpw[i]; j++)
    prod = (prod*i)%MOD;
     
    cout << prod << "\n";
    }
     
    return 0;
    } 