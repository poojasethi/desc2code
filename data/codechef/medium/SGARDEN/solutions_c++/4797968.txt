#include<iostream>
using namespace std;
#define mod 1000000007
int arr[]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317};

int main()
{
	int t;
	cin>>t;
	while(t--)
	{   
    	int fact[100005]={0};
		int n,top=0;
		long long ans=1;
		cin>>n;
		int a[n+1],b[n+1];
		for(int i=1;i<=n;i++)
		{
			cin>>a[i];
			b[i]=-1;
		}
		b[0]=-1;
		for(int i=1;i<=n;i++)
		{  int temp=1,j=a[i];
			if(b[i]!=-1)
		    continue;
			while(j!=i)
			{ 
				temp++;
				b[j]=1;
				j=a[j];
			}

           for(int i=0;arr[i]*arr[i]<=temp;i++)
           {
           	int cnt=0;
           	while(temp%arr[i]==0)
           	{
           	cnt++;
           	temp=temp/arr[i];
           	}
           		fact[arr[i]]=max(fact[arr[i]],cnt);
           		top=max(top,arr[i]);
           }
           if(temp>1)
           {
           	fact[temp]=max(fact[temp],1);
           	top=max(top,temp);
           }
           
           
			
		}
		for(long long i=0;i<=top;i++)
           {
           	while(fact[i]--)
			{
				ans=((ans%mod)*(i%mod))%mod;
			}
           	
           }
		
		cout<<ans<<endl;
	}
}