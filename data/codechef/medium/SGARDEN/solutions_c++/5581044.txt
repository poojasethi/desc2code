#include <iostream>
using namespace std;

#define mod 1000000007
#define maxn 100001

long long res;
int a[maxn], prime[maxn], factors[maxn], psize;
bool isvisited[maxn];

int main() {
    for(int i=2;i<maxn;++i) isvisited[i] = true;
    for(int i=2;i<maxn;++i) {
        if (isvisited[i]) {
            for(int j=i+i;j<maxn;j+=i) isvisited[j] = false;
        }
    }
    psize = 0;
    for(int i=2;i<maxn;++i) {
        if(isvisited[i]) {
            prime[psize] = i;
            ++psize;
        }
    }

    int t, n, count;
    cin >> t;
    while(t--) {
        cin >> n;
        for(int i=0;i<psize;++i) factors[i] = 0;
        for(int i=1;i<=n;++i) {
            cin >> a[i];
            isvisited[i] = false;
        }

        for(int i=1;i<=n;++i) {
            if (!isvisited[i]) {
                count = 0;
                int j = i;
                while(!isvisited[j]) {
                    isvisited[j] = true;
                    j = a[j];
                    ++count;
                }

                for(j=0; j<psize && prime[j]<=count; ++j) {
                    if ((count%prime[j]) == 0) {
                        long long cp = prime[j];
                        int p = 0;
                        while((count%cp) == 0) {
                            ++p;
                            cp = cp * prime[j];
                        }
                        factors[j] = max(factors[j], p);
                    }
                }
            }
        }

        res = 1;
        for(int i=0;i<psize;++i) {
            for(int j=0; j<factors[i]; ++j)
                res = (res * prime[i])%mod;
        }

        cout << res << endl;
    }
    return 0;
}
