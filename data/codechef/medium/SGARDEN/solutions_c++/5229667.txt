#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<iostream>
#include<cmath>
#include<algorithm>
#define ll long long
#define mod 1000000007
using namespace std;
int T,n,a[100002],pd[100002];
int num[100002],zz;
void init()
{
	scanf("%d",&n);
	int i;
	for(i=1;i<=n;i++) scanf("%d",&a[i]);
}
int dfs(int x)
{
	int i=a[x],ct=1;
	pd[i]=1;
	while(i!=x)
	   {i=a[i]; pd[i]=1; ct++;}
	return ct;
}
int gcd(int x,int y)
{
	if(y==0) return x;
	else return gcd(y,x%y);
}
void pre()
{
	memset(pd,0,sizeof(pd));
	zz=0;
	int i,t;
	for(i=1;i<=n;i++)
	   {if(!pd[i])
	       {num[++zz]=dfs(i);
	        //t=dfs(i); num[++zz]=t;
		    //printf("%d %d\n",i,t);
		   }
	   }
}
void lcm()
{
	ll ans=1;
	int i,j;
	for(i=1;i<=zz;i++)
	   {if(num[i]!=1)
	       {for(j=i+1;j<=zz;j++)
		       num[j]/=gcd(num[i],num[j]);
		    ans=(ans*num[i])%mod;
		   }
	   }
	printf("%lld\n",ans);
}
int main()
{
	scanf("%d",&T);
	while(T--)
	   {init(); pre(); lcm();}
	return 0;
}