#include<iostream>
#include<vector>
#include<cstdlib>
using namespace std;

int prim( int  n, vector<long> & s)
{	s.push_back(2);

	for(int i = 3 ; i <= n ; i++)
	{	int det = 1;
		for(int l = 0 ; l < s.size(); l++)
		{	if((i%(s.at(l))==0))
			{	det = 0;
				break;
			}
		}
		if(det==1)
		{	s.push_back(i);
		}
		
	}
	
}
int max (long n , long a)
{	int count=0;
		while(n>=a&&(n%a==0))
	{
		n=n/a;
		count++;
	}
	return count;
}
long max2 (vector<long> & d)
{	long ma = d[0];
 	for(int i = 1 ; i < d.size() ;i ++)
	{	if(ma<d.at(i))
		{	ma = d[i];
		}
	}
	return ma ;
}
int mov(vector<long> &r , vector<long> & s , vector<long> & t, vector<long> & ne)
{	
 for(int l = 0 ; l < s.size() ; l++   )
	{	int m=0;
	
		for(int j = 0; j < r.size() ; j++  )
		{	
			if(m < max(r.at(j),s.at(l)))
			{	m = max(r.at(j),s.at(l));
				
			}
		
		}
		if(m!=0)
		{	ne.push_back(s.at(l));
			t.push_back(m);
		}
		
		
	}
}
long mul(long n , long k)
{	long pe = 1 ;
	while (k>0)
	{	pe = n * pe;
		k--;
	}
	return pe;
}
long long  lcm1(vector<long> & f , vector<long> & ne)
{	long long ans = 1;
	for(int i =0 ; i< ne.size() ; i++)
	{	ans = (ans * mul(ne.at(i),f.at(i)))%1000000007;
	}
	return ans;
	
}



int backt( long x[] , long a[] , long val[], vector<long> & r,long n)
{	int i = 0 ;
	for(int i =0 ; i < n  ; i++)
	{	int no = x[i];
		if(val[i]!=1)
		{	int d = x[i];
			int b_f = a[i];
			val[i]=1;
			r.push_back(1);
			while(d!=b_f)
			{	val[d]=1;
				d = x[d];
				r.at(r.size()-1) += 1;
				
			}
		}
	}
}
	
int main()
{	int t;
	cin>>t;
	long long ans[t];
	for(int p = 0 ; p < t ; p++)
	{	long n;
		cin>>n;
		
		long* a = new long[n];
		
		
		for(long i = 0 ; i < n ; i++)
		{	cin>>a[i];
		}
	

	
	
		

		long b[n];
		long x[n];
		long  var[n];
		for(long i = 0 ; i < n ; i++)
		{	b[i]=i;
			x[i] = a[i] -1 ;
			var[i] = 0;
		}
		if (n==0)
		{	ans[p]=n;
			break;
			
		}
		vector<long> r;
		backt(x,b,var,r,n);
		vector<long> s1;
		vector<long> t1;
		vector<long> ne;
		long ma = max2(r);
		prim(ma+1,s1);
		mov(r,s1,t1,ne);
		ans[p]=lcm1(t1,ne);
	}
	
	for(int i = 0 ; i < t; i++)
	{	cout<<ans[i]<<" ";
	}

}
		
		