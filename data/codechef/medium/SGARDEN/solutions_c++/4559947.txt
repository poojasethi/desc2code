#include<iostream>
using namespace std;
long long a[100005]={0};
long long mark[100005]={0};
long long no=0;
long long b[100005]={0};
long long prime[100005]={0};
long long primestore[10005]={0};
long long value=0;
long long maxprime[100005]={0};
long long mod=1000000007;
long long quick_pow(long long x,long long y)
{
    long long ret=1;
    while(y)
    {
        if(y&1)
        ret=ret*x%mod;
        x=x*x%mod;
        y>>=1;
    }
    return ret;
}
void primecalculate(long long *a)
{
    a[1]=1;
    a[0]=1;
    for(int i=2;i<=1000;i++)
    {
        if(!a[i])
        {
            for(int j=2;j*i<=100002;j++)
            {
                a[j*i]=1;
            }
        }
    }
}
main()
{
    int t,n;
    primecalculate(prime);
    for(int i=0;i<100001;i++)
    if(!prime[i])
    primestore[value++]=i;
    //cout<<"last prime"<<primestore[9591]<<"\n";//total 9592 prime number//
    cin>>t;
    while(t)
    {
        no=0;
        t--;
        cin>>n;
        for(int i=1;i<=n;i++)
        {
            int num;
            cin>>num;
            a[i]=num;
        }
        for(int i=1;i<=n;i++)
        {
            if(mark[i])
            {

            }
            else
            {
                int freq=0;
                int k=i;
                int j=i;
                while(a[j]!=k)
                {
                    mark[j]=1;
                    int temp=a[j];
                    j=temp;
                    freq++;
                }
                mark[j]=1;
                b[no++]=freq+1;
                //cout<<b[no-1]<<"\n";
            }
        }
       //l.c.m calculation//
       for(int i=0;i<no;i++)
       {
         for(int j=0;j<9592;j++)
           {
            int tempo=0;
            if(b[i]==1)
            break;
            while(b[i]%primestore[j]==0)
              {
                 b[i]=b[i]/primestore[j];
                 tempo++;
              }
              if(tempo>maxprime[j])
              maxprime[j]=tempo;

            }
         }
         long long ans=1;
         for(int j=0;j<9592;j++)
         {
            maxprime[j]=quick_pow(primestore[j],maxprime[j]);
            ans=(ans*maxprime[j])%mod;
         }
         cout<<ans<<"\n";
         for(int i=0;i<100003;i++)
         {
             a[i]=0;
             mark[i]=0;
             b[i]=0;
             maxprime[i]=0;
         }
    }
    return 0;
}
