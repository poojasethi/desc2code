#include <iostream>
#include <algorithm>
#include <cstdio>
#include <cstring>
#define FOR(i,m,n) for(i=m;i<=n;i++)
#define MAX 1000
#define sc scanf

using namespace std;

int ans[MAX+10][MAX+10],n;char s[MAX+10];

int answ(int i,int j)
{
    if(i>0 && i<=n && j>0 && j<=n) return ans[i][j];
    return 0;
}

void update_ans(int i,int j)
{
    int max1=max(answ(i-2,j+1),answ(i+2,j+1));
    int max2=max(answ(i-1,j+2),answ(i+1,j+2));
    ans[i][j]+=max(max1,max2);
}

int main()
{
    int i,j,t,x1,y1,k;

    sc("%i",&t);

    FOR(i,1,t)
    {
            n=0;sc("%i",&n);gets(s);

            memset(ans,0,sizeof(ans));

            FOR(j,1,n)
            {
                gets(s);
                FOR(k,0,n-1)
                {
                    if(s[k]=='P') ans[j][k+1]=1;
                    else if(s[k]=='K') {x1=j;y1=k+1;}
                }
            }

        for(k=n-1;k>=0;k--)
            FOR(j,1,n)
                update_ans(j,k);

           printf("%i\n",ans[x1][y1]);
    }

    return 0;
}
