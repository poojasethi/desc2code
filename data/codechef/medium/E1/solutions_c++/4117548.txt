#include <bits/stdc++.h>
using namespace std;
 
char s[1001][1001];
int dp[1001][1001];


int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{	
		int n;
		scanf("%d",&n);
		getchar();
 
		for(int i=0;i<n;i++)
			scanf("%s",s[i]),getchar();
			
		bool found=false;
 		memset(dp,0,sizeof(dp));
 		
		for(int c=n-1;c>=0;c--)
		{
			for(int r=0;r<n;r++)
			{
				int temp=0;
				
				if (r-2>=0 && c+1<n) temp=max(temp, dp[r-2][c+1]);
				if (r-1>=0 && c+2<n) temp=max(temp, dp[r-1][c+2]);
				if (r+1<n && c+2<n) temp=max(temp, dp[r+1][c+2]);
				if (r+2<n && c+1<n) temp=max(temp, dp[r+2][c+1]);
				
				dp[r][c] = (s[r][c]=='P'?1:0) + temp;

				if (s[r][c]=='K')
				{
					printf("%d\n",dp[r][c]);
					found = true;
					break;
				}
			}
			
			if (found) 
				break;
		}
		
	} //tc
	
	return 0;
} 