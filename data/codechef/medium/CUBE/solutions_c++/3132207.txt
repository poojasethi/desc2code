#include<iostream>
#include<stdio.h>
 
using namespace std;
 
int a[41][41][41];
char s[41][41][41];
 
int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		int n,p,size,cnt;
		cin>>n>>p;
		
		for(int i=0;i<=n;i++)
		for(int j=0;j<=n;j++)
		for(int k=0;k<27;k++)
			a[i][j][0]=a[i][0][j]=a[0][i][j]=0;
 
		getchar();
		for(int z=1;z<=n;z++)
		for(int y=1;y<=n;y++)
		for(int x=1;x<=n;x++)
		{
			s[z][y][x]=getchar();
		}
 
        getchar();
		for(int z=1;z<=n;z++)
		for(int y=1;y<=n;y++)
		for(int x=1;x<=n;x++)
		{
			char c;
			c=getchar();
			a[z][y][x]=a[z-1][y][x]+a[z][y-1][x]+a[z][y][x-1]-a[z][y-1][x-1]-a[z-1][y][x-1]-a[z-1][y-1][x]+a[z-1][y-1][x-1];
			if(c==s[z][y][x])
			  a[z][y][x]++;
		}
 
		for(size=n;size>0;size--)
		{
			cnt=0;
			for(int z=n;z-size>=0;z--)
			{
				for(int y=n;y-size>=0;y--)
				{
					for(int x=n;x-size>=0;x--)
					{
     					int ca=a[z][y][x]-a[z-size][y][x]-a[z][y-size][x]-a[z][y][x-size]+a[z][y-size][x-size]+a[z-size][y][x-size]+a[z-size][y-size][x]-a[z-size][y-size][x-size];
						if((ca*100)/(size*size*size)>=p)
						   cnt++;
      				}
				}
			}
			if(cnt>0)
			   break;
		}
		
		if(size==0)
		   cout<<"-1"<<endl;
		else
		   cout<<size<<" "<<cnt<<endl;
	}
	return 0;
}
 