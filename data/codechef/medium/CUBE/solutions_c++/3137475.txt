#include<bits/stdc++.h>

 #define MOD 1000000007

using namespace std;
typedef long long ll;
int main()
{
    #ifndef ONLINE_JUDGE
        freopen("input.txt","r",stdin);
        //freopen("output.txt","w",stdout);
    #endif





	int a[42][42][42];
	int test,n,p,len,i,j,k,wi,count,min,siz,cube;
	char sa[64010],sb[64010];

	scanf("%d",&test);
	while(test--)
    {
        scanf("%d %d %s %s",&n,&p,sa,sb);
        len=n*n*n;
        wi=n*n;
        for(i=0;i<len;i++)a[i/wi+1][(i%wi)/n+1][i%n+1]=(sa[i]==sb[i]);

        //for(i=1;i<=n;i++,printf("\n"))for(j=1;j<=n;j++,printf("\n"))for(k=1;k<=n;k++)printf("%d ",a[i][j][k]);printf("__________\n\n");
        //dp
        for(i=0;i<=n;i++)for(j=0;j<=n;j++)a[0][i][j]=a[i][0][j]=a[i][j][0]=0;
        for(i=1;i<=n;i++)for(j=1;j<=n;j++)for(k=1;k<=n;k++)a[i][j][k]+=a[i-1][j][k]+a[i][j-1][k]+a[i][j][k-1]-a[i-1][j-1][k]-a[i-1][j][k-1]-a[i][j-1][k-1]+a[i-1][j-1][k-1];

        //for(i=1;i<=n;i++,printf("\n"))for(j=1;j<=n;j++,printf("\n"))for(k=1;k<=n;k++)printf("%d ",a[i][j][k]);printf("*************\n\n");
        if(a[n][n][n]==0 && p){printf("-1\n");continue;}
        count=0;
        for(siz=n;siz>0;siz--)
        {
            cube=siz*siz*siz;
            min=(p*cube+99)/100;
            for(i=0;i<=n-siz;i++)for(j=0;j<=n-siz;j++)for(k=0;k<=n-siz;k++)
                if((a[i+siz][j+siz][k+siz]-a[i+siz][j+siz][k]-a[i+siz][j][k+siz]-a[i][j+siz][k+siz]+a[i+siz][j][k]+a[i][j+siz][k]+a[i][j][k+siz]-a[i][j][k])>=min)count++;
            if(count)break;
        }
        if(count)printf("%d %d\n",siz,count);
        else printf("-1\n");
    }

 return 0;
}
