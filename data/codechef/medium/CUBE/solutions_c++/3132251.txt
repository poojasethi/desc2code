#include<iostream>
#include<vector>
#include<map>
#include<algorithm>
#include<set>
#include<cstring>
#include<cmath>
#include<stack>
#include<queue>

#define MOD 1000000007
#define LL long long int
#define PB push_back
#define sd(x) scanf("%d",&x)
#define sld(x) scanf("%lld",&x)
#define pf(x) printf("%d",x)
#define pef(x) printf("%d\n",x)

LL max(LL x,LL y)
{if(x>y) return x;return y;}

LL min(LL x,LL y)
{if(x<y) return x;return y;}

LL gcd(LL x,LL y)
{LL temp;if(x<y) { temp=x;x=y;y=temp;}while(x%y){temp = y;y = x%y;x=temp;}return y;}

LL po(LL x,LL y)
{if(y==0) return 1;LL ans=po(x,y/2);ans*=ans;if(y&1) ans*=x;return ans;}

using namespace std;

#define M 42
int a[M][M][M],b[M][M][M],c[M][M][M],d[M][M][M];
LL n;
        


int main()
{
    LL test=1,p;
    cin>>test;
    while(test--)
    {
        cin>>n>>p;
 
        for(int i=0;i<=n;i++)
		for(int j=0;j<=n;j++)
		for(int k=0;k<27;k++)
			d[i][j][0]=d[i][0][j]=d[0][i][j]=0;
 
        getchar();
		for(int z=1;z<=n;z++)
		for(int y=1;y<=n;y++)
		for(int x=1;x<=n;x++)
		{
			a[z][y][x]=getchar();
		}
 
        getchar();
		for(int z=1;z<=n;z++)
		for(int y=1;y<=n;y++)
		for(int x=1;x<=n;x++)
		{
			char c;
			c=getchar();
			d[z][y][x]=d[z-1][y][x]+d[z][y-1][x]+d[z][y][x-1]-d[z][y-1][x-1]-d[z-1][y][x-1]-d[z-1][y-1][x]+d[z-1][y-1][x-1];
			if(c==a[z][y][x])
			  d[z][y][x]++;
		}
        
        
        LL o,cnt;
         
        for( o=n;o>0;o--)
        {
            cnt= 0;
            
			for(int z=n;z-o>=0;z--)
			
				for(int y=n;y-o>=0;y--)
				
					for(int x=n;x-o>=0;x--)
				{	int ca=d[z][y][x]-d[z-o][y][x]-d[z][y-o][x]-d[z][y][x-o]+d[z][y-o][x-o]+d[z-o][y][x-o]+d[z-o][y-o][x]-d[z-o][y-o][x-o];
		            if((ca*100)/(o*o*o)>=p)
			         cnt++;
                }
      				if(cnt>0) break;    
        }
    	if(o==0)
		   cout<<"-1"<<endl;
		else
		   cout<<o<<" "<<cnt<<endl;
	}
    return 0;
}
