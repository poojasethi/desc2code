//This code was writen by Alexander Dryapko (sdryapko)
#include<sstream>
#include<iostream>
#include<stdio.h>
#include<math.h>
#include<stdlib.h>
#include<algorithm>
#include<vector>
#include<map>                             	
#include<set>               
#include<string>
#include<string.h>  
#define gcd(a,b) __gcd((a),(b));
#define sqr(a) ((a)*(a))
#define odd(a) ((a)&1)
#define pw2(x) (1ll<<(x))
#define F first
#define S second
const int maxi=2000000000;              
const int maxq=1000000000;
const double eps=1e-10;       
const double pi=3.1415926535897932;
const double inf=1e+18;
const int mo=1000000007;

using namespace std;
char c[1111111];
struct T {
	int x,y,z;
} g[1111111];
int n,m,tt,p[1111111];
bool my(T x,T y) {
	if (x.z<y.z) return true; else return false;
}
void uni(int x,int y) {
	if (rand()&1) p[x]=y; else p[y]=x;
}
int get(int x) {
	if (p[x]==x) return x;
	return p[x]=get(p[x]);
}
int main(){                 
    //    freopen("input.txt","r",stdin);      
    //    freopen("output.txt","w",stdout); 
     	scanf("%d\n",&tt);
     	for (int t=0;t<tt;t++) {
     		scanf("%d%d\n",&n,&m);
     		for (int i=1;i<=n;i++) scanf("%c",&c[i]);
     		for (int i=0;i<m;i++) {
     			scanf("%d%d%d\n",&g[i].x,&g[i].y,&g[i].z);
     			if (c[g[i].y]=='R') g[i].y=n+1;
     			if (c[g[i].x]=='R') g[i].x=n+1;
     			g[m+i].x=g[i].y;
     			g[m+i].y=g[i].x;
     			g[m+i].z=g[i].z;
     		}  
     		m=2*m;
     		
     		sort(g,g+m,&my);
    	        for (int i=1;i<=n+1;i++) p[i]=i;
    		long long ans=0;
    		long long otr=0;
    		for (int i=0;i<m;i++) {
    			//cout<<g[i].z<<endl;
    			if (g[i].z<0) {
    				ans+=g[i].z;
    				otr+=g[i].z;
    				//cout<<g[i].z<<endl;
    			
    				uni(get(g[i].x),get(g[i].y));
    			} else if (get(g[i].x)!=get(g[i].y)) {
    				ans+=g[i].z;
    			//	cout<<g[i].z<<endl;
    				uni(get(g[i].x),get(g[i].y));
    		        }
    		}
    		cout<<ans-otr/2<<endl;
    		
    	}	
       	return 0;
}
