#include <stdio.h>
 
#define MOD 1000000007
#define NMAX 111
 
int A[NMAX], cnt[NMAX][NMAX];
int N, i, j, k, len, x, y;
 
int main() {
	//freopen("y.txt", "r", stdin);
	scanf("%d", &N);
	for (i = 1; i <= N; i++)
		scanf("%d", &A[i]);
 
	for (i = 1; i <= N; i++)
		cnt[i + 1][i] = 1;
	
	for (len = 1; len <= N; len++)
		for (i = 1; i + len - 1 <= N; i++) {
			j = i + len - 1;
			cnt[i][j] = cnt[i + 1][j];
			if (A[i] < 0) {
				for (k = i + 1; k <= j; k++)
					if (A[k] == -A[i]) {
						x = ((long long) cnt[i + 1][k - 1] * (long long) cnt[k + 1][j]) % MOD;
						cnt[i][j] += x;
						if (cnt[i][j] >= MOD) cnt[i][j] -= MOD;
					}
			}
		}
	
	printf("%d\n", cnt[1][N]);
	return 0;
}