#include<iostream>
#include<stdio.h>
#define MOD 1000000007
long recursion(int i,int j,long a[],long dp[][101])
{
int k,l;
long long value,value2,temp;
value=1;
if(i>=j)
{
dp[i][j]=1;
return dp[i][j];
}
if(dp[i][j]!=-1)
return dp[i][j];
for(l=i;l<=j;l++)
for(k=j;k>l;k--)
{
if(a[l]==-a[k] && a[l]<0)
{
value2=recursion(k+1,j,a,dp);
/*if(dp[l][k]!=-1 && (l!=i && k!=j))
{
}*/
if(dp[l+1][k-1]!=-1 )
value=(value+((dp[l+1][k-1])*value2)%MOD)%MOD;
else
{
//temp=(recursion(l+1,k-1,a,dp)-1)*2+2;/*one with() and null*/
temp=recursion(l+1,k-1,a,dp);
value=(value+((temp)*value2)%MOD)%MOD;
}
}
//else
//dp[l][k]=recursion(l,k,a,dp);
}
if(dp[i][j]==-1)
dp[i][j]=value;
return dp[i][j];
}
 
 
int main()
{
int n,i,j;
long a[100],dp[101][101],ans;
scanf("%d",&n);
for(i=0;i<n;i++)
scanf("%ld",&a[i]);
for(i=0;i<=n;i++)
for(j=0;j<=n;j++)
dp[i][j]=-1;
dp[0][0]=1;
ans=recursion(0,n-1,a,dp);
/*for(i=0;i<=n;i++)
{
for(j=0;j<=n;j++)
printf("%ld ",dp[i][j]);
printf("\n");
}*/
printf("%ld",ans);
}