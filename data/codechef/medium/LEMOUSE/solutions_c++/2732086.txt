#include<iostream>
#include<cstdio>
#include<vector>
#include<climits>
using namespace std;


int main(){
	int t;
	cin>>t;
	while(t--){
		int n,m;
		cin>>n>>m;
		vector<string> grid(n);
		vector<vector<int> > mouse(n,vector<int>(m,0));
		vector<vector<int> > shadow(n,vector<int>(m,0));
		for(int i = 0;i<n;i++){
			cin>>grid[i];
		}
		//cout<<"here 1"<<endl;
		for(int i = 0;i<n;i++){
			for(int j = 0;j<m;j++){
				mouse[i][j] = grid[i][j] - '0';
			}
		}
		//cout<<"here 2"<<endl;
		for(int i = 0;i<n;i++){
			for(int j = 0;j<m;j++){
				if(mouse[i][j] == 1){
					if(i>0)shadow[i-1][j]++;
					if(j>0)shadow[i][j-1]++;
					if(i<n-1)shadow[i+1][j]++;
					if(j<m-1)shadow[i][j+1]++;
				}
			}
		}
		//cout<<"here 3"<<endl;
		vector<vector<vector<int> > > ans(n,vector<vector<int> >(m,vector<int>(2)));
		ans[0][0][0] = ans[0][0][1] = shadow[0][0] - mouse[0][0];
		
		//cout<<"values of shadow are as follows: "<<endl;
		/*for(int i = 0;i<n;i++){
			for(int j = 0;j<m;j++){
				cout<<shadow[i][j]<<" ";
			}
			cout<<endl;
		}		
		*/		
		for(int j = 1;j<m;j++){
			ans[0][j][0] = shadow[0][j] - mouse[0][j] + ans[0][j-1][0];
			ans[0][j][1] = INT_MAX;
		}
		
		//cout<<"values in the first row :"<<endl;
		/*for(int j = 0;j<m;j++){
			cout<<ans[0][j][0]<<" ";
		}
		cout<<endl;
		*/
		//cout<<"here 4"<<endl;
		for(int i = 1;i<n;i++){
			ans[i][0][0] = INT_MAX;
			ans[i][0][1] = shadow[i][0] - mouse[i][0] + ans[i-1][0][1];
		}
		//cout<<"here 5"<<endl;
		for(int i = 1;i<n;i++){
			for(int j = 1;j<m;j++){
				ans[i][j][0] = shadow[i][j] - mouse[i][j] + min(ans[i][j-1][0],ans[i][j-1][1] - mouse[i-1][j]);
				ans[i][j][1] = shadow[i][j] - mouse[i][j] + min(ans[i-1][j][0] - mouse[i][j-1],ans[i-1][j][1]);
			}
		}
		//cout<<"here 6"<<endl;
		int answer = min(ans[n-1][m-1][0],ans[n-1][m-1][1]) + mouse[0][0] + mouse[n-1][m-1];
		cout<<answer<<endl;
	}
}
