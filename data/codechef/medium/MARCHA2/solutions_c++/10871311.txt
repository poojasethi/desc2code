#include<cstdio>
using namespace std;
int main(){
    int T;
    scanf("%d",&T);
    while(T--){
        int K;
        scanf("%d",&K);
        int arr[K];
        for(int i=0;i<K;i++){
            scanf("%d",&arr[i]);
        }
        int branch=0,tmp=1,fail=0;
        for(int i=0;i<K;i++){
            if(tmp<arr[i]){
                fail=1;
                break;
            }
            if(i==K-1 && tmp!=arr[i]){
                fail=1;
                break;
            }
            branch=tmp-arr[i];
            tmp=branch*2;
        }
        if(fail){
            printf("No\n");
        }
        else
        {
            printf("Yes\n");
        }
    }
}
