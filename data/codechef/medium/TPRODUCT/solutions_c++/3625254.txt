#include<stdio.h>
#include<math.h>
#define MOD 1000000007
int main(){
int H,N,i;
unsigned long long Arr[33000];
double Brr[33000];
while(1){
 scanf("%d",&H);
 if(H==0)
    break;
 N = 1<<H;
 N = N - 1;
  for(i=1;i<=N;i++){
    scanf("%llu",&Arr[i]);
   Brr[i]=log10(Arr[i]);
}
for(i=N-(1<<(H-1));i>0;i--){
   if(Brr[2*i]>Brr[2*i+1]){
   Arr[i]=(Arr[i]*Arr[2*i])%MOD;
   Brr[i]=Brr[2*i]+Brr[i];
   }
   else{
   Arr[i]=(Arr[i]*Arr[2*i+1])%MOD;
   Brr[i]=Brr[2*i+1]+Brr[i];
   }
 }
 printf("%llu\n",Arr[1]);
}
return 0;
}