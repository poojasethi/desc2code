#include <cstdio>
#include <cmath>
#include <algorithm>
#include <iostream>
using namespace std;
int l[32769];
double p[32769];
int main()
{
    int n;
    scanf("%d",&n);
    while ( n )
    {
        int len = (1<<n)-1;
        for(int i=1; i<=len; i++) scanf("%d",(l+i));
        int t = (1<<(n-1))-1;
        for(int i=len; i>=0; i--)
        {
            if(i>t) p[i] = log(l[i]);
            else p[i] = log(l[i])+std::max(p[2*i],p[2*i+1]);
        }
        long long r=l[1];
        int i=1;
        while ( (2*i+1)<=len )
        {
            if ( p[2*i] < p[2*i+1] )
            {
                r = (r*l[2*i+1])%1000000007;
                i = 2*i+1;
            }
            else
            {
                r=(r*l[2*i])%1000000007;
                i = 2*i;
            }
        }
        printf("%d\n",r);
        scanf("%d",&n);
    }
    return 0;
}
