    #include <iostream>
    #include<cmath>
    #define modulo 1000000007LL
    using namespace std;
    long long p[600000];
    double logp[600000];
    int x;
    long long calculate(int v)
    {
    if(v>=(x+1)/2 && v<=x)
    {logp[v]=log10(p[v]);return (p[v])%modulo;}
    else
    {
    int v1=2*v;
    int v2=v1+1;
    long long f=(p[v]*calculate(v1))%modulo;
    long long y=(p[v]*calculate(v2))%modulo;
    if(logp[v1]>logp[v2])
    {logp[v]=logp[v1]+log10(p[v]);return f;}
    else
    {logp[v]=logp[v2]+log10(p[v]);return y;}
    }
    }
    int main() {
    int h=1;
    while(true)
    {
    cin>>h;
    if(h==0)break;
    x=pow(2,h)-1;
    for(int i=1;i<=x;i++)
    scanf("%lld",&p[i]);
    cout<<calculate(1)<<"\n";
    }
    return 0;
    } 