#include <stdio.h> 
#define MAX 32768
#define MOD 1000000007
long long a[MAX];
double b[MAX];
int main(){
 
	int H, i,n;
	scanf("%d",&n);
	while(H=(1<<n)-1){
 
		for(i = 1; i <= H; i++)
 		{
 			scanf("%lld",&a[i]);
 			b[i] = a[i];
		}
 
		for(i = H/2; i >= 1; i--){
 
			if(b[i*2] > b[i*2+1])
 
				a[i] *= a[i*2], b[i] *= b[i*2];
 
			else
 
				a[i] *= a[i*2+1], b[i] *= b[i*2+1];
 
			a[i] %= MOD;
 
		}
 
		printf("%lld\n",a[1]);
 		scanf("%d",&n);
	}
 
	return 0;
 
}