#include<algorithm>
#include<iostream>
#include<cmath>
#define mod 1000000007
using namespace std;
long long a[100000];
double b[100000];
int main()
{
    long long h,i,j,nodes;
    while(1)
    {
        cin>>h;
        if(h==0)
            break;
        else
        {
            for(i=0;i<100000;i++)
            {
                a[i]=b[i]=0;
            }
            nodes=pow(2,h)-1;
            for(i=1;i<=nodes;i++)
            {
                cin>>a[i];
                b[i]=log(a[i]);
            }
            for(i=nodes/2;i>=1;i--)
            {
                if(b[2*i]>b[2*i+1])
                    b[i]=b[2*i]+b[i],a[i]=a[2*i]*a[i];
                else
                    b[i]=b[2*i+1]+b[i],a[i]=a[2*i+1]*a[i];
                a[i]=a[i]%mod;
            }
            cout<<a[1]%mod<<endl;
        }
    }
    return 0;
}
