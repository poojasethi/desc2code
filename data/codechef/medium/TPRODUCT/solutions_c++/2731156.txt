#include<iostream>
#include<math.h>
#include<algorithm>
#include<string.h>
#include<set>
#include<map>
#include<vector>
#define FOR(i,a,b) for(int i=a;i<b;i++)
#define FORL(i,a,b) for(int i=a;i<=b;i++)
#define FORI(i,a,b,inc) for(int i=a;i<b;i=i+inc)
#define FORD(i,a,b) for(int i=a;i>=b;i--)
#define LL long long
#define MAX 1003002
#define MOD 1000000007
#define pb push_back
double MaxFun(double a , double b)
{
          if(a > b)
               return a;
          return b;
}
using namespace std;
int main()
{
    while(1)
    {         
         int h;
         scanf("%d",&h);
         if(h == 0)
              break;
         int n = pow(2,h)-1; 
         LL V[n];
         double P[n];
         LL ans[n];
         FOR(i,0,n) 
                   scanf("%lld",&V[i]); 
         FORL(i,n/2+1,n)
         {
                  P[i-1] = log((double)V[i-1]); 
                  ans[i-1] = V[i-1];
         }
                       
         FORD(i,n/2,1)
         {
                      //cout<<i-1<<" "<<2*i-1<<" "<<2*i<<endl;
                      if(P[2*i] >= P[2*i-1])
                      {
                          P[i-1] = log((double)V[i-1]) + P[2*i];
                          ans[i-1] = V[i-1]*ans[2*i];
                          ans[i-1] = ans[i-1]%MOD;      
                      }
                      else
                      {
                          P[i-1] = log((double)V[i-1]) + P[2*i-1];
                          ans[i-1] = V[i-1]*ans[2*i-1];
                          ans[i-1] = ans[i-1]%MOD;      
                      }
                      
         }          
         printf("%lld\n",ans[0]);
          
          
    }
    
    return 0;
}
