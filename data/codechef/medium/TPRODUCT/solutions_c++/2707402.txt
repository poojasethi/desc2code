#include<iostream>
#include<cstdio>
#include<cmath>
using namespace std;
double compare(int a[],int i,int n)
{
	double x=1.0;
	if(((2*i)+1)>=n)
	return log(x*a[i]);
	else
	{
		double m1=compare(a,((2*i)+1),n);
		double m2=compare(a,((2*i)+2),n);
		if(m1>=m2)
		return m1+log(a[i]);
		else return m2+log(a[i]);
	}
}
long long int find(int a[],int i,int n)
{
	long long int x=1LL;
	if(((2*i)+1)>=n)
	return a[i];
	else
	{
		long long int m1=(find(a,((2*i)+1),n)%1000000007);
		long long int m2=(find(a,((2*i)+2),n)%1000000007);
		if(compare(a,((2*i)+1),n)>=compare(a,((2*i)+2),n))
		return ((((a[i]*x)%1000000007)*m1)%1000000007);
		else
		return ((((a[i]*x)%1000000007)*m2)%1000000007);
	}
} 	  
int main()
{
	int n,i;
	do
	{
		scanf("%i",&n);
		if(n==0)
		break;
		n=(1<<n)-1;
		int *a = new int[n];
		for(i=0;i<n;i++)
		scanf("%i",a+i);
		cout<<(find(a,0,n)%1000000007)<<endl;
		delete []a;
	}
	while(n);
	return 0;
}	 	 
		

