#include <iostream>
#include <math.h>
#define size 100000
#define limit 1000000007
using namespace std;

unsigned long long int a[size];
long double b[size];

long double max(long double a, long double b)
{
    if(a>b)
        return a;
    return b;
}

void answer(int l)
{
    while(l--)
    {
        int start, end;
        start=pow(2, l), end=pow(2, l+1);
        for(int i=start; i<end; i++){
            if(b[i]*b[2*i] > b[i]*b[2*i+1])
            {
                a[i]*=(a[2*i]);
                b[i]= b[i]*b[2*i];
            }
            else
            {
                a[i]*=(a[2*i + 1]);
                b[i]= b[i]*b[2*i + 1];
            }
            a[i]%=limit;
        }
    }
}
int main()
{
    int l;
    while(1)
    {
        cin>>l;
        if(!l)
            break;
        int n=pow(2, l)-1;
        for(int i=1; i<=n; i++){
            cin>>a[i];
            b[i]=a[i];
        }
        answer(l-1);
        cout<<a[1] <<endl;
    }
    return 0;
}