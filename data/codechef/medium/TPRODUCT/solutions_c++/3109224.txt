#include<iostream>
#define MAX 32768
#define MOD 1000000007
using namespace std;
long long int V[MAX];
double P[MAX];
int main()
{
	int H,n,i;
	cin>>H;
	while(H!=0)
	{
		n = (1<<H)-1;
		for(i=1;i<=n;i++)
		{
			cin>>V[i];
			P[i] = V[i];
		}
		for(i=n/2;i>0;i--)
		{
			if(P[i*2] > P[i*2+1])
			{
				V[i] *= V[i*2];
				P[i] *= P[i*2];
			}
			else
			{
				V[i] *= V[i*2+1];
				P[i] *= P[i*2+1];
			}
			V[i] %= MOD;
		}
		cout<<V[1]<<endl;
		cin>>H;
	}
	return 0;
}