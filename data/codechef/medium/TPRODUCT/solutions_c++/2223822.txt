#include<math.h>
#include<stdio.h>
#include<iostream>
using namespace std ;
#define mod 1000000007 ;

int main()
{
	int i,j,k,l,m,n,t,Arry[33000],total,num,count,height[20] ;
	unsigned long long int ans ;
	double p[33000] ;
	scanf("%d",&n);
	while(n!=0)
	{
		num = (1<<n)-1 ;
		for(i=1 ;i<=num ;i++)
		{
			scanf("%d",&Arry[i]);
		}
		for(i=(num+1)/2 ; i<=num ; i++)
		{
			p[i] = log(double(Arry[i])) ;		// store log(p_i) of all leaves in p_i array
		}
		for(i=((num+1)/2-1);i>=1;i--)
		{
			if(p[2*i] > p[2*i+1])
				p[i] = p[2*i] + log(double(Arry[i])) ;
			else
				p[i] = p[2*i+1] + log(double(Arry[i])) ;     // store log(p_i) of all parents
		}
		i = 1 ;
		count = 1 ;
		while(i<=num)
		{
			height[count] = i ;       // get indexes from parent to leave 
			count += 1 ;
			if(2*i <= num)
			{
				if(p[2*i] > p[2*i+1])
					i = 2*i ;
				else
					i = 2*i+1 ;
			}else
				i = 2*i ;
		}
		count-- ;

		ans = 1 ;
		for(i=count ;i>=1 ;i--)
		{
			ans = (ans * Arry[height[i]]) % mod ;
		}
		ans = ans % mod ;
		printf("%llu\n",ans);
		scanf("%d",&n) ;
	}
	return 0 ;
}