#include<stdio.h>
#include <math.h>
int main()
{
   long long i=0,j=0,len=0,a[33000]={0},last=0,r=0;
   int h;
   double s[33000];
   while(1)
   {    
       scanf("%d",&h);
       
       if(h==0)
           break;
       
       len=pow(2.0,h);
       
       for(i=1;i<len;i++)
       {
           scanf("%lld",&a[i]);
           s[i]=a[i];
       }
       
       last=i-1;
      
       
       while(last!=1)
       {
           r=last/2;
           
           
           if(s[last]>s[last-1])
           {
               a[r]=a[r]*a[last];
               s[r]=s[r]*s[last];
               
           }
           else
           {
               a[r]=a[r]*a[last-1];    
               s[r]=s[r]*s[last-1];
           
           }   
           a[r]=a[r]%1000000007;
               
           last=last-2;
       
       
       }
       
       
       
       printf("%lld\n",a[last]);
       
       for(j=1;j<len;j++)
           a[j]=s[j]=0;
    }   
return 0;
 
}   