#include<iostream>
#include<algorithm>
#include<cmath>
using namespace std;
 
#define e 1e-9
 
long long int ans,h, n, v[32800];
double l[32800];
 
void trace(int i)
{
ans = (ans*v[i])%1000000007;
if (2*i>n) return;
if (abs(l[i]-l[2*i+1]-log(v[i]) )>e ) trace(2*i); else trace(2*i+1);
}
 
int main()
{
while (cin>>h)
{
if (h==0) break;
n = (1<<h) - 1;
for (int i = 1; i<=n; i++) cin>>v[i];
for (int i = n; i>=1; i--)
{
if (2*i>n) l[i] = log(v[i]); else
{
l[i] = l[i * 2];
if (l[i] < l[i * 2 + 1] - e)
l[i] = l[i * 2 + 1];
l[i] += log(v[i]);
}
}
ans = 1;
trace(1);
cout<<ans<<endl;
}
//system("pause");
return 0;
}