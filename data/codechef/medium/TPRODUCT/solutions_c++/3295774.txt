#include<iostream>
#include<bits/stdc++.h>
#define MOD 1000000007
using namespace std;
#define getcx getchar_unlocked
// fast input function
#ifdef ONLINE_JUDGE
 inline void inp( int &n )
 {
    n=0;
    int ch=getcx();int sign=1;
    while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getcx();}

    while(  ch >= '0' && ch <= '9' )
            n = (n<<3)+(n<<1) + ch-'0', ch=getcx();
    n=n*sign;
  }
#else
inline void inp(int &n){
 cin>>n;
}
#endif
#ifdef ONLINE_JUDGE
inline long long inpll(){
	char c = getchar_unlocked();
	long long n = 0;
	while(c < '0' || c > '9') c = getchar_unlocked();
	while(c >= '0' && c <= '9')
		n = (n<<3) + (n<<1) + c - '0', c = getchar_unlocked();
	return n;
}
#else
inline long long inpll(){
	long long  x;
	cin>>x;
	return x;
}
#endif
void getroot(double *brr,long long int *arr,int ss,int se,int index)
{
  if(ss==se)
   {
		return ;
    }
    int mid=(ss+se)/2;
    getroot(brr,arr,ss,mid,2*index+1);
    getroot(brr,arr,mid+1,se,2*index+2);

    if(brr[2*index+1]>brr[2*index+2])
    {
	   brr[index]*=brr[2*index+1];
	   arr[index]*=arr[2*index+1];
    }
    else
    {
          brr[index]*=brr[2*index+2];
          arr[index]*=arr[2*index+2];
    }
    arr[index]%=MOD;
}
int  main()
{
 int h;
 int n;
 inp(h);
 while(h)
 {
   int size=(int)pow(2,h)-1;
   long long int *arr=new long long int[size];
   double *brr=new double [size];
   for(int i=0;i<size;i++){
     arr[i]=inpll();
     brr[i]=arr[i];
   }
   n=(size+1)/2;
   getroot(brr,arr,0,n-1,0);
   printf("%lld\n",arr[0]);
   inp(h);
   delete(arr);
   //delete(brr);
 }
 return 0;
}
