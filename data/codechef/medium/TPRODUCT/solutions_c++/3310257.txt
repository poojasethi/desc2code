#include<iostream>
#include<math.h>
#define MOD 1000000007

using namespace std;

unsigned long long  a[50010];
double b[40000];


int pow(int N)
{
	int temp;

	if(N==0)
		return 1;

	temp=pow(N/2);
	temp*=temp;

	if(N&1)
		return 2*temp;
	
	else
		return temp;
}

double maxSegmentTree(int n2,int n,int index)
{
	double nm,nm2;
	if(index>n && index<n2) return a[index];
	nm=maxSegmentTree(n2,n,2*index+1);
	nm2=maxSegmentTree(n2,n,2*index+2);
	if(nm>nm2){
	b[index]*=b[2*index+1];
	a[index]*=a[2*index+1];
	}
	else{
		b[index]*=b[2*index+2];
		a[index]*=a[2*index+2];
	}
	a[index]%=MOD;
	return b[index];
}


int main()
{
	int i,h,n,n2;
	cin>>h;
	while (h)
	{
		if(h==0)
		{
			cin>>a[0];
			cout<<a[0]<<endl;
		}

		n=pow(h-1);
		n2=n-1+n;
		for(i=0;i<n2;i++)
			{cin>>a[i];
			b[i]=a[i];
		}

		maxSegmentTree(n2,n-2,0);
		cout<<a[0]<<endl;

		cin>>h;
	}

	return 0;
}
