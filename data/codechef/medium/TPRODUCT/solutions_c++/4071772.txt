#include<iostream>
#include<cstdio>
#include<cmath>
#define left(i) (2*i)
#define right(i) (2*i+1)
#define m 1000000007

using namespace std;

int main() {
//    freopen("in.txt", "r", stdin);
//    freopen("out.txt", "w", stdout);
    int h,i;
    scanf("%d", &h);
    while(h!=0) {
            int n = pow(2,h)-1;
            double a[n+1];
            long long v[n+1];
            for(i=1; i<=n; i++) {
                scanf("%lld", &v[i]);
//                printf("v[i]: %lld\n", v[i]);
                a[i] = log10(v[i]);
//                printf("a[i]: %f\n", a[i]);
            }

            int x = pow(2,h-2);
            while(x!=1) {
                int y = 2*x - 1;
                for(int j=x; j<=y; j++) {
                    int maxi = a[left(j)]>a[right(j)]?left(j):right(j);
                    v[j] = ( (v[j] % m) * (v[maxi] % m) ) % m;
                    a[j] += a[maxi];
                }
                x /= 2;
            }
            int maxi = a[left(1)]>a[right(1)]?left(1):right(1);
            v[1] = ( (v[1] % m) * (v[maxi] % m) ) % m;
            printf("%lld\n", v[1]);

            scanf("%d", &h);
    }
    return 0;
}
