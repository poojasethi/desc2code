#include<iostream>
#include<vector>
#include<algorithm>
#define MAX 10002

using namespace std;

struct song
{
    int l, b;
};

bool myfunc(song a, song b)
{
    return (a.l < b.l);
}

int main()
{
    int t;
    song s[100005];

    cin>>t;

    while(t--)
    {
        int n, i;

        cin>>n;

        vector<bool> vis(1000000005, false);

        for(i=0; i<n; i++)
            cin>>s[i].b>>s[i].l;

        sort(s, s+n, myfunc);

        vector<int> s1, s2;

        for(i=0; i<n; i++)
        {
            if(vis[s[i].b]==false)
            {
                vis[s[i].b] = true;
                s1.push_back(s[i].l);
            }
            else
            {
                s2.push_back(s[i].l);
            }
        }

        long long ans = 0;

        for(i=0; i<s1.size(); i++)
            ans += (long long)s1[i]*(i+1);
        for(i=0; i<s2.size(); i++)
            ans += (long long)s2[i]*s1.size();

        cout<<ans<<"\n";
    }

    return 0;
}
