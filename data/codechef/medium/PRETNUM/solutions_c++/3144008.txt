#include<stdio.h>
#include<stdlib.h>
#include<math.h>
#define MAX 1000001
int prime[MAX]={0};
int sp[]={3,5,7,11,13,17,19,23,29,31,37};
void sieve(){
 int i,j;
 prime[0]=1;
 prime[1]=1;
 for(i=2;i<MAX;i++){
  j=2;
  if(!prime[i])                   
  while(i*j<MAX){
   prime[i*j]=1;              
   j++;               
  }                  
 }
}
void sieve_seg(int* arr,long long L,long long R){
 long long i,bal;
  if(L<2)
    arr[0]=1;       
 
 for(i=2;i<=sqrt(R);i++){
  
   if(!prime[i]){
   
      bal=L%i;     
      if(bal)
        bal=i-bal; 
      while(L+bal<=R){
      
       if((L+bal)!=i)
         arr[bal]=1;
         bal+=i;
         
      }
                    
  }                                             
 }    
}
 
int main(){
 int t,*arr,i,num,j;
 long count=0;
 long long x,L,R,power;
 sieve();
 scanf("%d",&t);   
 while(t--){
 count=0;
  scanf("%lld%lld",&L,&R);
             
  arr=(int*)calloc((R-L+1),sizeof(int));
  sieve_seg(arr,L,R);
 
  
  for(i=0;i<R-L+1;i++)
   if(!arr[i])
     count++;
  
  for(i=0;i<MAX;i++){
    if(!prime[i]){   
        j=0;
         x=(long long)pow(i,sp[j]-1);
 
         while(x<=R && j<11){
 
           if(x>=L)
            count++;
 
           j++;
 
           x=(long long)pow(i,sp[j]-1);
        }
    }
}
  printf("%d\n",count);
  free(arr);          
 }   
 
 return 0;    
}
 