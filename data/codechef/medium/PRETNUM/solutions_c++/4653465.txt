#include<cstdio>
#include<cmath>

#define ll unsigned long long
#define getcx getchar_unlocked

int arr[1000001]={0};
int arr_initial[1000001]={0};
/*inline void inp( ll &n )//fast input function
{
   *n=0;
   int ch=getcx();int sign=1;
   while( ch < '0' || ch > '9' ){if(ch=='-')sign=-1; ch=getcx();}

   while(  ch >= '0' && ch <= '9' )
           *n = ((*n)<<3)+((*n)<<1) + ch-'0', ch=getcx();
   *n=(*n)*sign;
}*/

int MultipleCross(ll factor, ll small, ll big)
{
    unsigned long long int num,m;
    m=(small/factor)*factor<small?small/factor+1:small/factor;
    if(m<2)
        m=2;
    num=factor*m;
    while(num<=big)
    {
        arr[num-small]=1;
        m++;
        num=(factor)*m;
    }
    return 0;
}

int markAll(int n)
{
    int m=2,num;
    num=n*m;
    while(num<=1000)
    {
        arr_initial[num]=1;
        m++;
        num=n*m;
    }

}

int noFactors(ll n)
{
    //Passed in square root NOT square
    int i,ans=3;
    for(i=2;i<n;i++)
        if((n*n)%i==0)
            ans+=2;
    return ans;
}

int main()
{
    ll t,a,b,i,upper,low,countPrime;
    scanf("%llu",&t);
    //Intialize first prime array
    arr_initial[0]=arr_initial[1]=1;
    upper=32;
    for(i=2;i<=upper;i++)
    {
        if(arr_initial[i]==0)
            {
                markAll(i);
            }
    }
    while(t--)
    {
        scanf("%llu",&a);
        scanf("%llu",&b);
        //Init
        for(i=0;i<=b-a;i++)
            if((i+a)&1||(i+a)==2)
                arr[i]=0;
            else
                arr[i]=1;
        if(a==1)
            arr[0]=1;
        //Start marking from mutiples of 3
        upper=sqrt(b);
        for(i=3;i<=upper;i++)
        {
            //printf("Done for%llu\n",i);
            MultipleCross(i,a,b);
        }
        countPrime=0;
        for(i=0;i<=b-a;i++)
            if(arr[i]==0)
            {countPrime++;}
        //Now for the perfect squares
        low=sqrt(a);
        if(low*low!=a)
            low++;
        if(low==1)
            low++;
        for(i=low;i*i<=b;i++)
        {
            if(arr_initial[noFactors(i)]==0)
                {//printf("%llu is the Square Perfect with %d\n",i*i,noFactors(i));
                    countPrime++;}
        }
        printf("%llu\n",countPrime);
    }
    return 0;
}

