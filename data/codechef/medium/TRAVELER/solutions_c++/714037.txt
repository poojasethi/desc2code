#include<cstdio>
#include<algorithm>
#include<cstring>
#include<utility>
using namespace std;

char city[60][30];
char road[2500][3][30];
char path[60][30];
int flag[60];

int main()
{
	int n,m,t;
	scanf("%d",&n);
	getchar();
	for(int i=0; i<n; i++)
		scanf("%s",city[i]);
	scanf("%d",&m);
	for(int i=0; i<m; i++)
		scanf("%s%s%s",road[i][0],road[i][1],road[i][2]);
	scanf("%d",&t);
	for(int i=0; i<t; i++)
	{
		int l = 0;
		int k;
		char a[60],b[60];
		memset(path,'\0',sizeof(path));
		memset(flag,0,sizeof(flag));
		scanf("%d",&k);
		for(int j=0; j<k; j++)
			scanf("%s",path[j]);
		if(k == 1)
		{
			int j;
			for(j=0; j<n; j++)
				if(!strcmp(path[0],city[j]))
					break;
			if(j != n)
				printf("0\n");
			else
				printf("ERROR\n");
			continue;
		}
		int check = 0;
		for(int j=0; j<k-1; j++)
		{
			strcpy(a,path[j]);
			strcpy(b,path[j+1]);
			int x;
			for(x=0; x<n; x++)
				if(!strcmp(a,city[x]) || !strcmp(b,city[x]))
					flag[x]++;
			for(x=0; x<n; x++)
				if(flag[x] > 1)
					break;
			if(x != n)
			{
				printf("ERROR\n");
				check = 1;
				break;
			}
			for(x=0; x<m; x++)
				if(!strcmp(a,road[x][0]) && !strcmp(b,road[x][1]))
				{
					l += atoi(road[x][2]);
					break;
				}
			if(x == m)
			{
				printf("ERROR\n");
				check = 1;
				break;
			}
			for(x=0; x<n; x++)
				if(!strcmp(b,city[x]))
					flag[x]--;
		}
		if(check == 0)
			printf("%d\n",l);
	}
	return 0;
}
