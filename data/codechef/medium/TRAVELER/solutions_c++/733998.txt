#include<set>
#include<vector>
#include<iostream>
#include<cstdio>
#include<memory.h>
#include<map>

using namespace std;

int adj[100][100];

int main()
{
	int n,m,d,t,k;
	cin>>n;
	string s,q;
	map<string,int> ind;
	
	for (int i=0;i<n;i++)
	{
		cin>>s;
		ind[s] = i;
	}
	cin>>m;
	memset(adj,-1,sizeof adj);
	for (int i=0;i<m;i++)
	{
		cin>>s>>q>>d;
		adj[ind[s]][ind[q]] = d;
	}
	cin>>t;
	while(t--)
	{
		cin>>k;
		bool mark[51] = {0};
		int old,loc = -1;
		bool err = false;
		int res = 0;
		for (int i=0;i<k;i++)
		{
			cin>>s;
			if (err)
				continue;
			if (ind.find(s) == ind.end())
			{
				err = true;
				continue;
			}
			old = loc;
			loc = ind[s];
			if (mark[loc] || adj[old][loc] == -1)
			{
				err = true;
				continue;
			}
			mark[loc] = 1;
			if (i > 0)
				res += adj[old][loc];
		}
		if (err)
			cout<<"ERROR"<<endl;
		else
			cout<<res<<endl;
	}
	return 0;
}