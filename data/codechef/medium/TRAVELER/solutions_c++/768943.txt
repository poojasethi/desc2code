#define DEBUG 1

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int f(char c[50][21], char s[21], int n) {
  int i;
  for(i=0;i<n;i++)
    if(!strcmp(c[i], s))
      return i;
  return -1;
}

int main(void) {
  int n, m, c1, c2, i, d[50][50], x, t, k, total, p;
  char c[50][21], s[21], v[50];

  scanf("%d", &n);
  for(i=0;i<n;i++)
    scanf("%s", &c[i]);

  memset(d, 0, sizeof(d));
  scanf("%d", &m);
  while(m--) {
    scanf("%s", &s);
    c1=f(c, s, n);
    scanf("%s%d", &s, &x);
    c2=f(c, s, n);
    d[c1][c2]=x;
  }

  scanf("%d", &t);
  while(t--) {
    memset(v, 0, sizeof(v));
    total=0;
    scanf("%d", &k);
    for(i=0;i<k;i++) {
      scanf("%s", &s);
      if(total>=0) {
	c1=f(c, s, n);
	if(c1==-1 || v[c1])
	  total=-1;
	else {
	  v[c1]=1;
	  if(i>0)
	    if(d[p][c1]==0)
	      total=-1;
	    else
	      total+=d[p][c1];
	  p=c1;
	}
      }
    }
    if(total==-1)
      printf("ERROR\n");
    else
      printf("%d\n", total);
  }
  
  return 0;
}
