#include <vector>
#include <list>
#include <map>
#include <set>
#include <queue>
#include <deque>
#include <stack>
#include <bitset>
#include <algorithm>
#include <functional>
#include <numeric>
#include <utility>
#include <sstream>
#include <iostream>
#include <iomanip>
#include <cstdio>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include<string>
#include<cstring>
using namespace std;
int n;
int comp(string * s,string str)
{
	int i;
	 for(i=0;i<n;i++)
		 if(s[i]==str)
			 return i;
	 return -1;
}
int main()
{
 int t;
 

   int  m;
   scanf("%d",&n);
   string s[60];
   for(int i=0;i<n;i++)
   {
	  
	   cin>>s[i];
	
   }
   scanf("%d",&m);
   int c[60][60];
   for(int i=0;i<60;i++)
	   for(int j=0;j<60;j++)
		   c[i][j]=-1;
   for(int i=0;i<m;i++)
   {
	   string sr,dest;int cost;
	   cin>>sr>>dest>>cost;
	   int ii=comp(s,sr);
	   int jj=comp(s,dest);
	   c[ii][jj]=cost;
   }
   scanf("%d",&t);
  while(t--)
 {
	 long long int ans=0;
	 bool chk=true;
	 bool cc[60];
	 memset(cc,0,60*sizeof(bool));
	 int k; scanf("%d",&k);
	 string sr,dest;
	 cin>>sr;
	 for(int i=1;i<k;i++)
	{
		
		cin>>dest;
		int ii=comp(s,sr);
	   int jj=comp(s,dest);
		
		if(chk&&ii!=-1&&jj!=-1&&!cc[jj]&&ii!=jj){
			if(c[ii][jj]!=-1)
			{ans+=c[ii][jj];cc[ii]=cc[jj]=true; }
			else
		   chk=false;
		}
		else
		{
			 chk=false;
		}
			sr=dest;
	
	 }
	 int ii=comp(s,sr);
	 if(ii==-1)
		 chk=false;
	 if(!chk)
		 printf("ERROR\n");
	 else
		cout<<ans<<"\n";
	 }
}