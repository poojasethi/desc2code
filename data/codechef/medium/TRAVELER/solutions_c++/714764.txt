#include<stdio.h>
#include<string>
#include<string.h>
#include<map>
#include<set>
using namespace std;

int main(){
	int m,d;
	char a[21],b[21];
	map<pair<string,string>,int> q;
	set<string> s;
	scanf("%d\n",&m);
	while(m-->0){
		scanf("%s",a);
		s.insert(a);
	}
	scanf("%d\n",&m);
	while(m-->0){
		scanf("%s %s %d\n",a,b,&d);
		q.insert(pair<pair<string,string>,int>(pair<string,string>(a,b),d));
	}
	scanf("%d",&m);
	while(m-->0){
		int ans=0;
		bool err=0;
		set<string> z;
		scanf("%d %s",&d,a);
		if(s.count(a))
			z.insert(a);
		else
			err=1;
		while(d-->1){
			scanf("%s",b);
			if(z.count(b))
				err=1;
			else
				z.insert(b);
			if(q.count(pair<string,string>(a,b)))
				ans+=q[pair<string,string>(a,b)];
			else
				err=1;
			strcpy(a,b);
		}
		if(err)
			printf("ERROR\n");
		else
			printf("%d\n",ans);
	}
	return 0;
}
