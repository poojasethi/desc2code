#include<iostream>
#include<map>
#define max 60
using namespace std;
int n;
long adj[max][max]={0};
int visited[max]={0};
map<string,int> city;
int main()
{
    cin>>n;
    for(int i=1;i<=n;i++)
    {
            string s;
            cin>>s;
            city.insert(pair<string,int>(s,i));
            
    }
    long edge;
    cin>>edge;
    for(long i=0;i<edge;i++)
    {
            string a,b;
            long len;
            cin>>a>>b>>len;
            adj[city[a]][city[b]]=len;
            
            }
    /*
    for(int i=0;i<n;i++)
    {
    for(int j=0;j<n;j++)
    cout<<adj[i][j]<<" ";
    cout<<"\n";
    }
    */
    int path;
    cin>>path;
    for(int i=0;i<path;i++)
    {
            int tot;
            cin>>tot;
            string paths[max];
            for(int j=0;j<tot;j++)
            {                  
            string s;
            cin>>paths[j];
            }
            bool pathy=true;
            if(city[paths[0]])
            visited[city[paths[0]]]=1;
            else
            pathy=false;
            
            long sum=0;
            for(int j=1;j<tot;j++)
            {
            //cout<<city[paths[j]]<<" "<<visited[city[paths[j]]]<<" "<<pathy<<" "<<adj[city[paths[j-1]]][city[paths[j]]]<<"\n";
            if( city[paths[j]] &&  visited[city[paths[j]]] ==0 && pathy && adj[city[paths[j-1]]][city[paths[j]]] > 0 )
                    {
                    sum+=adj[city[paths[j-1]]][city[paths[j]]];
                  visited[city[paths[j]]]=1;  
                 }
                 else pathy=false;
                    
            }//for       
                    
            if(pathy)
            cout<<sum<<"\n";
            else
            cout<<"ERROR\n";
                    
     for(int i=0;i<=n;i++)
     visited[i]=0;       
            
            
            }//for
    
    //system("pause");
    return 0;
    }
