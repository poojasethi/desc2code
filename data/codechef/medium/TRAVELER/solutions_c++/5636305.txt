#include<bits/stdc++.h>
using namespace std;
int main()
{
    long  int n,m,k,i,j,dis,d,t,flag,z,flag2=0;
    string city1[50],city2[50],x,y,temp;
    map<string,int>route;
    cin>>n;
    for(i=0;i<n;i++)
    {
        cin>>city1[i];
    }
    cin>>m;
    for(i=0;i<m;i++)
    {
        cin>>x>>y>>d;
        temp=x+y;
        route[temp]=d;
    }
    cin>>t;
    for(i=0;i<t;i++)
    {
        cin>>k;
        flag=0;
        dis=0;
        for(j=0;j<k;j++)
        {
            cin>>city2[j];
            for(z=0;z<j;z++)
            {
                if(city2[z]==city2[j])
                {
                    flag=1;
                    break;
                }
            }
        }
        if(flag==0)
        {
            if(k==1)
            {
                flag2=0;
                for(j=0;j<n;j++)
                {
                   if(city2[0]==city1[j])
                   {
                       flag2=1;
                       break;
                   }
                }
                if(flag2==0)
                {
                    flag=1;
                }
            }
            if(k!=1)
            {
                for(j=0;j<k-1;j++)
                {
                x=city2[j];
                y=city2[j+1];
                temp=x+y;
                if(route[temp]==0)
                {
                    flag=1;
                    break;
                }
                else
                {
                    dis+=route[temp];
                }
                }
            }
        }
        if(flag==1)
        {
            cout<<"ERROR"<<endl;
        }
        else
        {
            cout<<dis<<endl;
        }
    }
    return 0;
}
