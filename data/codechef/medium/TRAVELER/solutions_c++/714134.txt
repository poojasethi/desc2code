#include<iostream>
#include<fstream>
#include<set>
#include<algorithm>
#include<map>
#include<string>
#include<cstdio>
#include<cstdlib>
using namespace std;

int main()
{
	//ifstream ifile("input.txt");
      //  if(ifile) {
        //       freopen("input.txt","rt",stdin);
        //}
	// if(ifile) {
      //          freopen("output.txt","wt",stdout);
        //}
	
	int n;
	cin>>n;
	
	map<pair<string,string>,int>m;
	set<string>v,v1;
	
	for(int i=0;i<n;i++)
	{
		string s;
		cin>>s;
		v.insert(s);
	}	
	
	int m2;
	cin>>m2;
	
	while(m2--)
	{
		int k;
		string s1,s2;
		cin>>s1>>s2>>k;
		m[make_pair(s1,s2)]=k;
	}
	
	int t;
	cin>>t;

	while(t--)
	{
		int k;
		bool f=false;
		int sm=0;
		set<string>v1;
		string c,ch;
		cin>>k;
		cin>>c;
		if(!v.count(c))
		f=true;
		
		k=k-1;
		v1.insert(c);
		while(k--)
		{
			cin>>ch;
			if(!f)
			{
				if(!v1.insert(ch).second)
				f=true;
				
				if(m.count(make_pair(c,ch)))
				{
					sm+=m[make_pair(c,ch)];
				}
				else
					f=true;
			}
			c=ch;
		}
		if(f)
			cout<<"ERROR"<<"\n";
		else
			cout<<sm<<"\n";
	}
	return 0;
}
