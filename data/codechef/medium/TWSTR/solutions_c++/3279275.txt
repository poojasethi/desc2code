#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define idx(ch) (ch=='-'?26:ch-'a')
const int MAX=1001,MAX_C=30;
struct recipe
{
public:
	int priority,index;
	recipe *c[MAX_C];
	recipe()
	{
		priority=1<<31;
		for (int i = 0; i < MAX_C; i++)
		{
			c[i]=NULL;
		}
	}
};
int T,N,Q,V;
recipe root,*r,*p;
char* R[MAX];
char s[MAX];
int main()
{
	scanf("%d",&N);
	for (int i = 0; i < N; i++)
	{
		scanf("%s %d",&s,&V);
		int length=strlen(s);
		char* name=(char*)malloc(MAX*sizeof(char));
		strcpy(name,s);
		R[i]=name;
		r=&root;
		for (int j = 0; j < length; j++)
		{
			int k=idx(s[j]);
			p=r->c[k];
			if(p==NULL)
			{
				p=new recipe();
				r->c[k]=p;
			}
			if(V>p->priority)
			{
				p->priority=V;
				p->index=i;
			}
			r=p;
		}
	}
	scanf("%d",&Q);
	for (int i = 0; i < Q; i++)
	{
		scanf("%s",s);
		int length=strlen(s);
		r=&root;
		for (int j = 0; j < length; j++)
		{
			r=r->c[idx(s[j])];
			if(r==NULL)
			{
				printf("NO\n");
				goto next;
			}
		}
		printf("%s\n",R[r->index]);
next:continue;
	}
}