#include<iostream>
//#include<conio.h>
#include<string.h>
#define lli long long int
#include<math.h>
#include<stdio.h>
#include<map>
#include<stack>
#include<queue>
#include<stdlib.h>
 
#define gc getchar_unlocked()
 
using namespace std;
 
/*int in()
{
  char c;lli t=0,negative=1;
  c=gc;
  while((c<48||c>57)&&c!='-')c=gc;
  if(c=='-')
  {negative=-1;c=gc;}
  while(c>=48&&c<=57)
  {t=(t<<3)+(t<<1)+c-'0';c=gc;}
  return t*negative;
}*/
 
int find(string query,string recipe_arr[],int index)
{
    int len=query.length();
    string temp=recipe_arr[index].substr(0,len);
    if( query.compare(temp)==0 )
    {
              return 1;
    }
    return 0;
}
int main()
{
    //freopen("input.in","r",stdin);
    //freopen("out2.in","w",stdout);
    int n;
    cin>>n;
 
    string recipe[n];
    lli prior[n];
 
    for(int i=0;i<n;i++)
    {
            cin>>recipe[i];
            cin>>prior[i];//=in();
    }
 
    int T;
    cin>>T;
    for(int lop=1;lop<=T;lop++)
    {
            string ans="NO";
            string query;
            cin>>query;
            lli max=-1000000000;
            for(int i=0;i<n;i++)
            {
 
               if(find(query,recipe,i)==1)// pattern found in string
               {
                  //cout<<recipe[i]<<" ";
                  if(prior[i]>max) // if priority is greater than current priority
                  {
                    ans=recipe[i];
                    max=prior[i];
                  }
               }
            }
           cout<<ans<<endl;
 
 
    }// for ends
    //getch();
    return 0;
}//main ends