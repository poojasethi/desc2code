//Md. Ahsan Kabir Shohagh
#include<bits/stdc++.h>
using namespace std;
#define sz 1000005
#define pb(a) push_back(a)
#define ll long long
#define ull unsigned long long
#define fread freopen("input.txt","r",stdin)
#define fwrite freopen("output.txt","w",stdout)
#define mem(abc,z) memset(abc,z,sizeof(abc))
#define PI acos(-1)
#define quick ios_base::sync_with_stdio(0)
#define inf (1LL<<60)

ll a[sz],E[sz],S[sz];

int main(){
   int t,n,positive;
   ll ans;
   scanf("%d",&t);
//   cin>>t;
   while(t--){
     scanf("%d",&n);
//     cin>>n;
     E[0]=S[n+1]=0;
     positive=0;
     for(int i=1;i<=n;i++){
        scanf("%lld",&a[i]);
//        cin>>a[i];
        E[i]=S[i]=0;
        if(a[i]>=0) positive=1;
     }
     //kadane-algo
     ll mx=-inf,cur=0;
     ans=-inf;
     for(int i=1;i<=n;i++){
        cur=cur+a[i];
        if(cur<0){
            cur=0;
        }
        if(cur>=mx){
            mx=cur;
            E[i]=mx;
        }
        else E[i]=cur;
     }
     mx=-inf,cur=0;
     for(int i=n;i>=1;i--){
        cur=cur+a[i];
        if(cur<0) cur=0;
        if(cur>=mx){
            mx=cur;
            S[i]=mx;
        }
        else S[i]=cur;
     }
     for(int i=1;i<=n;i++){
        ans=max(ans,E[i-1]+S[i+1]);
        ans=max(ans,E[i-1]+S[i]);
     }
     if(positive==0){
        ans=a[1];
        for(int i=2;i<=n;i++){
            ans=max(ans,a[i]);
        }
     }
     printf("%lld\n",ans);
//     cout<<ans<<endl;
   }
   return 0;
}
/*
5
5
1 -2 3 -2 5
2
-1 -2
4
1 2 -3 4
5
1000 -1 0 -1 1000
3
-1 -2 3
*/
