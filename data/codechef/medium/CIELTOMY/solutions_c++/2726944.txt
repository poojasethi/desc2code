#include<iostream>
#include<math.h>
#include<algorithm>
#include<string.h>
#include<set>
#include<map>
#include<vector>
#define FOR(i,a,b) for(int i=a;i<b;i++)
#define FORL(i,a,b) for(int i=a;i<=b;i++)
#define FORI(i,a,b,inc) for(int i=a;i<b;i=i+inc)
#define FORD(i,a,b) for(int i=a;i>=b;i--)
#define LL long long
#define MAX 1003002
#define MOD 1000000007
#define pb push_back
using namespace std;
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {         
          int n,m,a,b,c;
          scanf("%d%d",&n,&m);
          int arr[n+1][n+1][2];
          FORL(i,1,n)          
                     FORL(j,1,n)
                     {
                         arr[i][j][0] = MAX;
                         arr[i][j][1] = 0;       
                     }          
          FOR(i,0,m)
          {
                scanf("%d%d%d",&a,&b,&c);
                arr[a][b][0] = c; 
                arr[b][a][0] = c;      
                arr[a][b][1] = 1;
                arr[b][a][1] = 1;
          }
          
          FORL(k,1,n)
                     FORL(i,1,n)
                                FORL(j,1,n)
                                {
                                      if(i!=j && j!=k && i!=k && arr[i][k][1] !=0 && arr[k][j][1] != 0 && arr[i][k][0]+arr[k][j][0] <= arr[i][j][0] )     
                                      {
                                              if(arr[i][k][0]+arr[k][j][0] < arr[i][j][0])
                                                        arr[i][j][1] = arr[i][k][1]*arr[k][j][1];
                                              else
                                                        arr[i][j][1]+= arr[i][k][1]*arr[k][j][1];                            
                                              arr[i][j][0] = arr[i][k][0]+arr[k][j][0];
                                      }      
                                                                 
                                }
          printf("%d\n",arr[1][n][1]);
          
          
    }
    
    return 0;
}
