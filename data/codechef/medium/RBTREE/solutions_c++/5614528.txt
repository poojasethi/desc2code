#include <iostream>
#include<stdio.h>
using namespace std;
char s[3];
long long int height(long long int i){
    long long int j=0;
    for(j=0;i!=1;j++){
        i=i/2;
    }
return j;
}
int main()
{
    long long int q,x,y,h1,h2,f,k,l,r1=0,r2=0,b1=0,b2=0,r3=0,b3=0,r=0,b=0,lca=1;
    int count=0;
    scanf("%lld",&q);
    while(q--){
        scanf("%s",s);
        if(s[1]=='i'){
            count=count^1;
            continue;
        }
        scanf("%lld",&x);
        scanf("%lld",&y);
        h1=height(x);
        h2=height(y);
        f=0;
        k=h1;
        l=h2;
        if(h1>h2){
            while(h1-f!=h2){
                f++;
            }
            while(f!=0){
                x=x/2;
                k=k--;
                f--;
            }
        }
        if(h1<h2){
            while(h1+f!=h2){
                f++;
            }
            while(f!=0){
                y=y/2;
                l=l--;
                f--;
            }
        }
      if(x==y){

        lca=k;

      } else if(x!=y){
        f=0;
      while(x!=y){
        x=x/2;
        y=y/2;
        f++;
      }
      lca=k-f;

      }
      //printf("%lld %lld %lld %lld %lld \n",h1,h2,k,l,lca);
 if(count==0){
        if(s[1]=='r'){
            if(h1%2==0){
                r1=h1/2;
            }
            else if(h1%2!=0){
                r1=(h1+1)/2;
            }
            if(h2%2==0){
                r2=h2/2;
            }
            else if(h2%2!=0){
                r2=(h2+1)/2;
            }
            if(lca%2==0){
                r3=lca/2;
            }
            else if(lca%2!=0){
                r3=(lca+1)/2;
            }
            if(lca%2!=0){
                r=r1+r2-(2*r3)+1;
                printf("%lld\n",r);
            }else if(lca%2==0){
                r=r1+r2-(2*r3);
                printf("%lld\n",r);
            }
        }
         if(s[1]=='b'){
            if(h1%2==0){
                b1=h1/2;
            }
            else if(h1%2!=0){
                b1=(h1-1)/2;
            }
            if(h2%2==0){
                b2=h2/2;
            }
            else if(h2%2!=0){
                b2=(h2-1)/2;
            }
            if(lca%2==0){
                b3=lca/2;
            }
            else if(lca%2!=0){
                b3=(lca-1)/2;
            }
            if(lca%2==0){
                b=b1+b2-(2*b3)+1;
                printf("%lld\n",b);
            }else if(lca%2!=0){
                b=b1+b2-(2*b3);
                printf("%lld\n",b);
            }
        }

     }



         if(count==1){
        if(s[1]=='b'){
            if(h1%2==0){
                r1=h1/2;
            }
            else if(h1%2!=0){
                r1=(h1+1)/2;
            }
            if(h2%2==0){
                r2=h2/2;
            }
            else if(h2%2!=0){
                r2=(h2+1)/2;
            }
            if(lca%2==0){
                r3=lca/2;
            }
            else if(lca%2!=0){
                r3=(lca+1)/2;
            }
            if(lca%2!=0){
                r=r1+r2-(2*r3)+1;
                printf("%lld\n",r);
            }else if(lca%2==0){
                r=r1+r2-(2*r3);
                printf("%lld\n",r);
            }
        }
         if(s[1]=='r'){
            if(h1%2==0){
                b1=h1/2;
            }
            else if(h1%2!=0){
                b1=(h1-1)/2;
            }
            if(h2%2==0){
                b2=h2/2;
            }
            else if(h2%2!=0){
                b2=(h2-1)/2;
            }
            if(lca%2==0){
                b3=lca/2;
            }
            else if(lca%2!=0){
                b3=(lca-1)/2;
            }
            if(lca%2==0){
                b=b1+b2-(2*b3)+1;
                printf("%lld\n",b);
            }else if(lca%2!=0){
                b=b1+b2-(2*b3);
                printf("%lld\n",b);
            }
        }

     }


}
    return 0;
}
