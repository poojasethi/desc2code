#include<iostream>

using namespace std;

int level(int x){
int ans=1;
while(x!=1){
x=x/2;
ans++;
}
return ans;

}

int main(){
	int q,i,x,y,tog=0,levelx,levely,ansb,ansr,yes,final,j;
	char temp;
	cin>>q;
	for(i=0;i<q;i++){
		
		cin>>temp;
		cin>>temp;
		if(temp=='i')
			tog=(!tog);
		else if(temp=='b'){	
			cin>>x>>y;
			levelx=level(x);
			levely=level(y);
			ansb=0;
			
			if(tog==0){
				yes=0;				
			}
			else{
				yes=1;
			}	
			if(levely%2==1){
				yes=!yes;
			}
			/*if(yes)
				ansb++;
			if(y!=x && ((levely%2==1)*(tog==0)||(tog==1)*(levely%2==1)))
				ansb++;*/		
			for(j=levely;j>levelx;j--){         //no. of blue levels
				y=y/2;
				if(yes){
					ansb++;
				}
				yes=!yes;
					
			}
			//cout<<ansb<<"   ";              /////////////
			if(tog==0){
				yes=0;
				
			}
			else
				yes=1;
			if(levelx%2==1){
				yes=!yes;
			}
			for(j=levelx;j>levely;j--){    //no. of red levels
				x=x/2;
				if(yes)
					ansb++;
				yes=!yes;	
			}
				//cout<<ansb<<"   ";                 ///////////
			while(x!=y){
			//cout<<("hello");
				x=x/2;//cout<<"x= "<<x<<"   ";
				y=y/2;//cout<<"y= "<<y<<"   ";
				if(yes)
					ansb=ansb+2;
				yes=!yes;	
			
			}
			if(yes)
				ansb++;
			cout<<ansb<<endl;
		}
		else if(temp=='r'){	
			cin>>x>>y;
			levelx=level(x);
			levely=level(y);
			ansb=0;
			
			if(tog==0){
				yes=1;				
			}
			else{
				yes=0;
			}	
			if(levely%2==1){
				yes=!yes;
			}
			/*if(yes)
				ansb++;
			if(y!=x && ((levely%2==1)*(tog==0)||(tog==1)*(levely%2==1)))
				ansb++;*/		
			for(j=levely;j>levelx;j--){        
				y=y/2;
				if(yes){
					ansb++;
				}
				yes=!yes;
					
			}
			if(tog==0){
				yes=1;
				
			}
			else
				yes=0;
			if(levelx%2==1){
				yes=!yes;
			}
			for(j=levelx;j>levely;j--){    //no. of red levels
				x=x/2;
				if(yes)
					ansb++;
				yes=!yes;	
			}
			while(x!=y){
			//cout<<("hello");
				x=x/2;
				y=y/2;
				if(yes)
					ansb=ansb+2;
				yes=!yes;	
			
			}
			if(yes)
				ansb++;
			cout<<ansb<<endl;
		}
		
	}

}















