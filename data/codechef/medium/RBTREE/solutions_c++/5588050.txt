#include<stdio.h>
#include<math.h>

/*
	Red = 1
	Black = 0
*/
int getcolor(int a)
{
	int t = log2(a);
	if(t % 2 == 0) {
		return 1;
	}else {
		return 0;
	}
}
int getsum(int p, int q, int b[], int r[])
{
	int t = getcolor(p);
	if(t == 1) {
		r[0]++;
	}else {
		b[0]++;
	}
	t = getcolor(q);
	if(t == 1) {
		r[0]++;
	}else {
		b[0]++;
	}
	//printf("black = %d red = %d\n",b[0],r[0]);
	while(p != q) {
		if(p > q) {
			p = p/2;
			int t = getcolor(p);
			if(t == 1) {
				r[0]++;
			}else {
				b[0]++;
			}
		}else if(q > p) {
			q = q/2;
			int t = getcolor(q);
			if(t == 1) {
				r[0]++;
			}else {
				b[0]++;
			}
		}
		if(p == q) {
			int t = getcolor(p);
			if(t == 1) {
				r[0]--;
			}else {
				b[0]--;
			}
		}
	}
}
int main()
{
	int n;
	scanf("%d", &n);
	bool flip = 1;
	int p;
	int q;
	char s[10];
	while(n--) {
		int b[2] = {0};
		int r[2] = {0};
		scanf("%s",&s);
		if(s[1] == 'r' || s[1] == 'b') {
			//printf("i am here\n");
			scanf("%d %d",&p,&q);
			getsum(p,q,b,r);
			if(s[1] == 'r') {
				if(flip == 1) {
					printf("%d\n",b[0]);
				}else {
					printf("%d\n",r[0]);
				}
			}else if(s[1] == 'b') {
					if(flip == 1) {
						printf("%d\n",r[0]);
					}else {
						printf("%d\n",b[0]);
					}
			}
		} else {
				flip = flip ^ 1;
		}
	}
	return 0;
}