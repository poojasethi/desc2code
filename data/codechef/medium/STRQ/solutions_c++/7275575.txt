#include<cstdio>
#include<cstring>
using namespace std;
#define rep(i,n) for(int i=0; i<(n); i++)
#define forn(i,a,b) for(int i=(a); i<=(b); i++)
inline void getint(int &x)
{
    register int c = getchar_unlocked();
    x = 0;
    for(;(c<48 || c>57);c = getchar_unlocked());
    for(;c>47 && c<58;c = getchar_unlocked()) {x = (x<<1) + (x<<3) + c - 48;}
}
inline int getc()
{
    register int x = getchar_unlocked();
    for(;(x<97 || x>122);x = getchar_unlocked());
    return x;
}
inline void O(long long int a)
{
 register char s[11];
 register int t = -1;
 do s[++t]=a%10+'0',a/=10; while(a>0);
 while(t>=0) putchar_unlocked(s[t--]);
 putchar_unlocked('\n');
}
int len;
char str[1000010];
long long cummcnt[1000010][4],interval[(1<<20)][4][4];
void fill()
{
  rep(i,4) cummcnt[0][i] = 0;
  forn(i, 1, len)
  {
    rep(j,4) cummcnt[i][j] = cummcnt[i-1][j];
    cummcnt[i][str[i-1]%4]++;
  }
  
  rep(i,4) rep(j,4) rep(k,2) interval[k][i][j] = 0;
  forn(x, 2, len)
  {
    int j = str[x-1]%4;
    rep(i,4) rep(k,4) interval[x][i][k] = interval[x-1][i][k];
    rep(i,4) interval[x][i][j] += cummcnt[x-1][i];
  }
}
int main(){
  scanf("%s",str);
  len = strlen(str);
  fill();
  int q;
  getint(q);
  int l,r,x,y;
  while(q--){
    x = getc()%4;
    y = getc()%4;
    getint(l); getint(r);
    O(interval[r][x][y] - interval[l-1][x][y] - ((cummcnt[r][y] - cummcnt[l-1][y]) * cummcnt[l-1][x]));
  }
}