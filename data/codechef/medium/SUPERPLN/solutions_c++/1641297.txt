#include <cstdio>
#include <vector>
#include <cstring>
#include <algorithm>
#include <set>
using namespace std;

struct flight {
	int c1,c2,t1,t2;
	bool visited;
	flight() {}
	flight(int c, int t) {
		c1 = c;
		t1 = t;
	}
	bool operator<(const flight &k) const {
		if (k.c1 == c1)
			return t1<k.t1;
		return c1<k.c1;
	}
};

const int MAXN = 10005;
int n, ans, s, e, st, et, cnt;
flight a[MAXN];

int main() {
#ifndef ONLINE_JUDGE
	freopen("in.txt", "r", stdin);
#endif
	int tc;
	scanf("%d", &tc);
	while (tc--) {
		scanf("%d", &n);
		for (int i=0; i<n; i++) {
			scanf("%d%d%d%d", &a[i].c1, &a[i].t1, &a[i].c2, &a[i].t2);
			a[i].visited = false;
		}
		scanf("%d%d%d%d", &s, &st, &e, &et);
		sort(a, a+n);
		ans = -1;
		cnt=0;
		while (ans < 0) {
			if (s==e && st<=et) ans = 1;
			else {
				int i = lower_bound(a, a+n, flight(s, st))-a;
				if (i==n || a[i].visited || a[i].c1!=s) ans = 0;
				else {
					cnt++;
					s = a[i].c2;
					st = a[i].t2;
					a[i].visited = true;
				}
			}
		}
		if (ans) {
			printf("Yes %d\n", cnt);
		} else {
			printf("No\n");
		}
	}
	return 0;
}