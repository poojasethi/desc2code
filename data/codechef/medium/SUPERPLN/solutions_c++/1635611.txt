#include<iostream>
#include<map>
#include<vector>
#include<cstdio>
#include<algorithm>
using namespace std;
class data
{
    public:
    int dcity;
    int dtime;
    int acity;
    int atime;
    int visited;
    data()
    {
        //visited=0;

    }
    void read()
	{
		scanf("%d%d%d%d",&dcity,&dtime,&acity,&atime);
	}
    data(int a,int b)
    {
        dcity=a;
        dtime=b;
    }

    bool operator<(const data &a ) const
    {
        return dcity<a.dcity || dcity==a.dcity && dtime<a.dtime;
    }
    };
int main()
{
    int test;
    cin>>test;
    class data array[10000];
   // vector<int> visited(100000);
    while(test--)
    {
        //int n,d,dt,a,at;
        int n;
        //cout<<"enter the no of flights ";
        scanf("%d",&n);
            for(int i=0;i<n;i++)
        {
            array[i].read();
            //scanf("%d%d%d%d",&array[i].dcity,&array[i].dtime,&array[i].acity,&array[i].atime);
            //cin>>d>>dt>>a>>at;
            array[i].visited=0;
           //mymap.insert(make_pair(d,data(d,dt,a,at)));
        }
        sort(array,array+n);
        int currcity;
        int currtime;
        int arrcity;
        int arrtime;
        scanf("%d%d%d%d",&currcity,&currtime,&arrcity,&arrtime);
        //cin>>currcity>>currtime>>arrcity>>arrtime;
        int count=0;
        int ans=-1;

        while(ans==-1)
        {
            if(currcity==arrcity && currtime<=arrtime)
           {
               ans=1;
               break;
           }
            else{//multimap<int ,class data>:: iterator it=mymap.find(currcity);
            int i=lower_bound(array,array+n,data(currcity,currtime))-array;
            //vector<int> :: iterator it=i;
            if(i==n || array[i].visited==1 || array[i].dcity!=currcity )
            {
                break;
            }


            else//if(array[i].dcity==currcity && array[i].dtime<=currtime)
            {
                count++;
                currcity=array[i].acity;
                currtime=array[i].atime;
                array[i].visited=1;
            }

            }


        }
        if(ans==1)
        {
            printf("Yes %d\n",count);
        }
        else
        printf("No\n");


}

   return 0;
}
