#include<iostream>
#include<algorithm>
using namespace std;
struct flight
{
   int startcity,starttime,endcity,endtime,visited;
   flight() {}
   void read()
   {
      scanf("%d%d%d%d",&startcity,&starttime,&endcity,&endtime);
      visited=0;
   }
   bool operator<(const flight &a) const
   {
        return ( (startcity<a.startcity) || (startcity==a.startcity && starttime<a.starttime));
   }
};
flight arr[10000],temp;
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
      int n,i;
      scanf("%d",&n);
      for(i=0;i<n;i++)
         arr[i].read();
      sort(arr,arr+n);
      int partycity,partytime,currentcity,currenttime;
      scanf("%d%d%d%d",&currentcity,&currenttime,&partycity,&partytime);
      int cnt=0,flag=0,st,en,mid;
      while(1)
      {
         if(currentcity==partycity && currenttime<=partytime)
         {
            flag=1;
            break;
         }
         temp.startcity=currentcity;
         temp.starttime=currenttime;
         i=lower_bound(arr,arr+n,temp)-arr;
         if(arr[i].startcity!=currentcity || arr[i].visited==1 || i==n)
         {
            flag=-1;
            break;
         }
         else
         {
             cnt++;
             currentcity=arr[i].endcity;
             currenttime=arr[i].endtime;
             arr[i].visited=1;
         }
      }
      if(flag==1)
        printf("Yes %d\n",cnt);
      else
        printf("No\n");
    }
    return 0;
}
         
