#include <iostream>
#include <fstream>

using namespace std;

ifstream f("wow.in");
#include <cstring>
#define LE 100666
#define ll long long
#define inf ((ll)1<<(ll)60)
#define f cin

struct MAT
{
    unsigned long long e[5][5];
} aux,lmin,A;

int nr[66][66];
bool fr[4][4][262666];
string str;

MAT ops(MAT a,MAT b)
{
    int i,j,t;
    for(i=0; i<4; ++i)
        for(j=0; j<4; ++j) aux.e[i][j]=inf;

    for(i=0; i<4; ++i)
        for(j=0; j<4; ++j)
            for(t=0; t<4; ++t)
                if (a.e[i][t]+b.e[t][j]-1>inf)
                    continue;
                else
                    aux.e[i][j]=min(aux.e[i][j],a.e[i][t]+b.e[t][j]-1);

    return aux;
}

void printm(MAT a)
{
    for(int i=0; i<4; ++i,cout<<'\n')
        for(int j=0; j<4; ++j)
            cout<<a.e[i][j]<<" ";

    cout<<'\n'<<'\n';
}

ll nr_lit(ll nr_word)
{
    if (nr_word==0) return 0;
    ll i,j;
    unsigned long long result=inf;
    bool okz=false;
    A=lmin;
    // printm(A);

    for(i=60; i>=0; --i)
    {
        if (okz==true)
        {
            A=ops(A,A);
            //  cout<<2<<'\n';
            // printm(A);
        }
        if (nr_word&((ll)1<<i)&&okz==true)
        {
            A=ops(A,lmin);
            //  cout<<1<<'\n';
            //printm(A);
        }
        if (nr_word&((ll)1<<i)) okz=true;
    }

    for(i=0; i<4; ++i)
        for(j=0; j<4; ++j) result=min(result,A.e[i][j]);

    return result;
}

ll bs(ll mval,ll nr_ch_now)
{
    ll pos,step;
    for(step=1; step<=mval; step<<=(ll)1);

    for(pos=0; step; step>>=(ll)1)
        if (pos+step<=mval&&nr_lit(pos+step-1)<=nr_ch_now)
            pos+=step;

    return pos;
}

int main()
{
    int n,i,j,t;
    ll nr_chars;
    f>>nr_chars;
    f.get();
    f>>str;
    n=str.length();

    for(i=min(11,n); i>=2; --i)
    {
        for(j=0; j<4; ++j)
            for(t=0; t<4; ++t)
            {
                nr[j][t]=0;
                for(int q=0; q<=(1<<((i-2)*2)); ++q) fr[j][t][q]=false;
            }
        int val=0;

        for(j=0; j<n-i+1; ++j)
        {
            val=0;
            for(t=j+1; t<j+i-1; ++t) val=val*4+str[t]-'A';

            if (fr[str[j]-'A'][str[j+i-1]-'A'][val]==false)
                nr[str[j]-'A'][str[j+i-1]-'A']++;

            fr[str[j]-'A'][str[j+i-1]-'A'][val]=true;
        }

        for(j=0; j<4; ++j)
            for(t=0; t<4; ++t)
                if (nr[j][t]<(1<<((i-2)*2)))
                    lmin.e[j][t]=i;
    }

///for(i=0; i<4; ++i,cout<<'\n')
  //      for(j=0; j<4; ++j)
        //    cout<<lmin.e[i][j]<<" ";
      //  printm(lmin);

    cout<<bs(nr_chars,nr_chars)<<'\n';

    return 0;
}
