#include <bits/stdc++.h>
using namespace std;
#define rep(i,a,n) for (int i=a;i<n;i++)
typedef long long ll;

typedef ll matrix[5][5];
struct node {
	node *go[4];
}pool[3010000],*cur=pool,*rt;
const ll inf=1ll<<61;
matrix ff,res,tmp;
int gg[5][5];
void dfs(node *p,int b,int dep) {
	rep(j,0,4) {
		if (!p->go[j]) gg[b][j]=min(gg[b][j],dep);
		else dfs(p->go[j],b,dep+1);
	}
}
void upd(matrix &a,matrix &b) {
	rep(i,0,4) rep(j,0,4) {
		tmp[i][j]=inf;
		rep(k,0,4) tmp[i][j]=min(tmp[i][j],a[i][k]+b[k][j]);
	}
	rep(i,0,4) rep(j,0,4) a[i][j]=tmp[i][j];
}
ll check(ll c) {
	rep(i,0,4) rep(j,0,4) ff[i][j]=gg[i][j];
	rep(i,0,4) rep(j,0,4) res[i][j]=0;
	for (;c;c>>=1) {
		if (c&1) upd(res,ff);
		upd(ff,ff);
	}
	ll ans=inf;
	rep(i,0,4) rep(j,0,4) ans=min(ans,res[i][j]);
	return ans;
}
ll t;
int n;
char s[101000];
int main() {
	scanf("%I64d",&t);
	scanf("%s",s);
	n=strlen(s);
	rt=cur++;
	rep(i,0,n) {
		node *p=rt;
		for (int j=i;j<i+30&&j<n;j++) {
			int w=s[j]-'A';
			if (!p->go[w]) p->go[w]=cur++;
			p=p->go[w];
		}
	}
	rep(i,0,4) rep(j,0,4) gg[i][j]=(1<<30);
	rep(i,0,4) dfs(rt->go[i],i,1);
	ll l=-1,r=inf;
	while (l+1<r) {
		ll md=(l+r)>>1;
		if (check(md)>=t) r=md; else l=md;
	}
	printf("%I64d\n",r);
}
