#include <bits/stdc++.h>
using namespace std;
#define rep(i,a,n) for (int i=a;i<n;i++)
#define per(i,a,n) for (int i=n-1;i>=a;i--)
#define pb push_back
#define mp make_pair
#define all(x) (x).begin(),(x).end()
#define SZ(x) ((int)(x).size())
typedef vector<int> VI;
typedef long long ll;
typedef pair<int,int> PII;
const ll mod=1000000007;
ll powmod(ll a,ll b) {ll res=1;a%=mod;for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}
// head

struct node {
	node *go[4];
}pool[3010000],*cur=pool,*rt;
const ll inf=1ll<<61;
ll ff[5][5],res[5][5],tmp[5][5];
int gg[5][5];
void dfs(node *p,int b,int dep) {
	rep(j,0,4) {
		if (!p->go[j]) gg[b][j]=min(gg[b][j],dep);
		else dfs(p->go[j],b,dep+1);
	}
}
ll check(ll c) {
	rep(i,0,4) rep(j,0,4) ff[i][j]=gg[i][j];
	rep(i,0,4) rep(j,0,4) res[i][j]=0;
	for (;c;c>>=1) {
		if (c&1) {
			rep(i,0,4) rep(j,0,4) {
				tmp[i][j]=inf;
				rep(k,0,4) tmp[i][j]=min(tmp[i][j],res[i][k]+ff[k][j]);
			}
			rep(i,0,4) rep(j,0,4) res[i][j]=tmp[i][j];
		}
		rep(i,0,4) rep(j,0,4) {
			tmp[i][j]=inf;
			rep(k,0,4) tmp[i][j]=min(tmp[i][j],ff[i][k]+ff[k][j]);
		}
		rep(i,0,4) rep(j,0,4) ff[i][j]=tmp[i][j];
	}
	ll ans=inf;
	rep(i,0,4) rep(j,0,4) ans=min(ans,res[i][j]);
	return ans;
}
ll t;
int n;
char s[101000];
int main() {
	scanf("%I64d",&t);
	scanf("%s",s);
	n=strlen(s);
	rt=cur++;
	rep(i,0,n) {
		node *p=rt;
		for (int j=i;j<i+30&&j<n;j++) {
			int w=s[j]-'A';
			if (!p->go[w]) p->go[w]=cur++;
			p=p->go[w];
		}
	}
	rep(i,0,4) rep(j,0,4) gg[i][j]=(1<<30);
	rep(i,0,4) dfs(rt->go[i],i,1);
	ll l=-1,r=inf;
	while (l+1<r) {
		ll md=(l+r)>>1;
		if (check(md)>=t) r=md; else l=md;
	}
	printf("%I64d\n",r);
}
