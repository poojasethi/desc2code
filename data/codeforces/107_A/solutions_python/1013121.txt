n,p = map(int, raw_input().split(' '))

inc = [0]*n
out = [0]*n
ps = [-1]*n
ds = [0]*n

for i in xrange(p):
  a, b, d = map(int, raw_input().split(' '))
  ps[a-1] = b-1
  ds[a-1] = d
  out[a-1] += 1
  inc[b-1] += 1


res = []
for i in xrange(n):
  if (out[i] == 1 and inc[i] == 0):
    d = ds[i]
    j = i
    while ps[j] != -1:
      d = min(d, ds[j])
      j = ps[j]
    res.append((i+1, j+1, d))

print len(res)
for a, b, d in res:
  print a, b, d
