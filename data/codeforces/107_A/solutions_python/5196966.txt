I=lambda:map(int, raw_input().split())
n,p=I()
i=[0]*(n+1)
o=i[:]
D=i[:]
for j in [0]*p:
    a,b,d=I()
    o[a]=b
    i[b]=a
    D[a]=d
r=[]

for j in range(1,n+1):
    if i[j]: continue
    k=j
    m=D[k]
    while o[k]:
        m=min(m,D[k])
        k=o[k]
    if m:
        r+=['%s %s %s'% (j,k,m)]
    
print len(r)
print '\n'.join(r)