def main():
    n, p = map(int, raw_input().split())
    data, not_roots = {}, set()

    for i in xrange(p):
        a, b, d = map(int, raw_input().split())
        data[a] = [b, d]
        not_roots.add(b)

    baks = [x for x in data if x not in not_roots]
    results = []
    for x in baks:
        node, capacity = x, 0
        while node in data:
            b, d = data[node]
            node = b
            capacity = min(capacity, d) if capacity else d
        results.append([x, node, capacity])

    print len(results)
    for result in results:
        print ' '.join(map(str, result))


if __name__ == '__main__':
    main()
