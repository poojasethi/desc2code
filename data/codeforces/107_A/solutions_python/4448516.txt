
I=lambda:map(int, raw_input().split())
n, p = I()
g = [0] * (n+1)
x = [0] * (n+1)
ind = [0] * (n+1)
for _ in xrange(p):
    a, b, d = I()
    g[a] = b
    x[a] = d
    ind[b] += 1
tanks = [i for i in xrange(1, n+1) if ind[i] == 0]
ans = []
for i in tanks:
    s, d = i, 1000000000
    while g[s] != 0:
        d = min(d, x[s])
        s = g[s]
    if s != i:
        ans.append((i, s, d))
print len(ans)
for tank, tap, d in ans:
    print tank, tap, d