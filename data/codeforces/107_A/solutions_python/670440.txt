#!/usr/bin/python

n , p = map(int , raw_input().split())

From = {}
To = {}

def Input():
	for i in range(p):
		a , b , d = raw_input().split()
		To[a] = (b , int(d))
		From[b] = a

#def calu(s):
#	global Min
#	print(s, Min)
#	if not To.has_key(s):
#		print(s , Min)
#		return (s , Min)
		
#	v = To[s]
#	Min = min(Min , v[1])
#	calu(v[0])

def calu(s):
	
	Min = 1000000000000
	while To.has_key(s):
		Min = min(Min , To[s][1])
		s = To[s][0]

	
	return (s , Min)

def solve():
	res = []
	for i in range(1, n + 1):
		r = str(i)
		if not From.has_key(r):
			b , d = calu(r)
			if r != b:
				res.append((r , b  ,d))

	size = len(res)
	print(size)
	for temp in res:
		print temp[0] , temp[1] , temp[2]
	


Input()
#print(To['1'])
solve()

