#!/usr/bin/env python
import sys

n, p = map(int, sys.stdin.readline().split())

a = {}
inv = {}

for _ in xrange(p):
    x, y, d = map(int, sys.stdin.readline().split())
    a[x] = (y, d)
    inv[y] = (x, d)

res = []

for i in range(1, n + 1):
    if i in inv or i not in a:
        continue
    cur = i
    mind = 2000000
    while cur in a:
        mind = min(mind, a[cur][1])
        cur = a[cur][0]
    if cur not in a:
        res.append( (i, cur, mind) )

print len(res)
for a, b, c in res:
    print a, b, c

