#include <iostream>
#include <map>
#include <cstdio>
#include <algorithm>
#include <cmath>
using namespace std;
int n,m,i,j,x,y,k,a[1111],b[1111],d[1111][1111];
int ans[1111][3];

void dfs(int i)
{//cout<<i<<',';
 int j=0;
 for (j=1;j<=n;j++)
  if (d[i][j]) {k=min(k,d[i][j]);
                y=j;
                dfs(j);
                }
}
int main()
{
cin>>n>>m;
while (m--)
{ cin>>x>>y>>k;
 d[x][y]=k;
 a[x]=1;b[y]=1;
}
int t=0;
for (i=1;i<=n;i++)
 if (a[i] && !b[i]) {ans[t][0]=i;k=1e9;y=-1;dfs(i);ans[t][1]=y;ans[t++][2]=k; }

cout<<t<<endl;
for (i=0;i<t;i++)
 printf("%d %d %d\n",ans[i][0],ans[i][1],ans[i][2]);
}
