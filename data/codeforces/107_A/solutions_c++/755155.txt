#include <stdio.h>

int to[1005], from[1005], d[1005];
int terminal, siz;
void dfs(int x) {
	if(to[x]==0) {terminal = x; return;}
	if(siz > d[x]) siz = d[x];
	dfs(to[x]);
}

int main(void) {
	int n, p;
	scanf("%d%d", &n, &p);
	for(int i=0;i<p;i++) {
		int x, y, z;
		scanf("%d%d%d", &x, &y, &z);
		to[x] = y;
		from[y] = x;
		d[x] = z;
	}
	int cnt=0;
	for(int i=1;i<=n;i++)
		if(to[i]==0 && from[i]) ++cnt;
	printf("%d\n", cnt);
	for(int i=1;i<=n;i++)
		if(to[i] && from[i] == 0) {
			siz=d[i];
			dfs(to[i]);
			printf("%d %d %d\n", i, terminal, siz);
		}
	return 0;
}
