#include <cstdio>
#include <algorithm>
#include <cstring>
#define N  1005
using namespace std;

int n, m, x, y, w, ret, pout[N], dia[N], pin[N];

int main(){

	scanf("%d%d", &n, &m);
	while (m--){
		scanf("%d%d%d", &x, &y, &w);
		pout[x] = y;
		dia[x] = w;
		pin[y] = x;
	}
	
	for (int i=1; i<=n; i++){
		if (!pin[i] && pout[i]) ret++;
	}
	printf("%d\n", ret);
	
	for (int i=1; i<=n; i++){
		if (!pin[i] && pout[i]){
			int x = i, y = (1<<30);
			while (pout[x]) y = min(y, dia[x]), x = pout[x];
			printf("%d %d %d\n", i, x, y);
		}
	}
	
	return 0;
}
