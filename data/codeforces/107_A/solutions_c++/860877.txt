#include<iostream>
#include<cstring>
using namespace std;
const int maxn=1010;
int adj[maxn][3],tap;
int dfs(int x,int ans){
	if(adj[x][1]==-1){
		tap=x;
		return ans;
	}
	return dfs(adj[x][1],min(ans,adj[x][2]));
}
int main(){
	int n,p,a,b,c;
	cin>>n>>p;
	memset(adj,-1,sizeof adj);
	for(int i=0;i<p;i++){
		cin>>a>>b>>c;
		a--;b--;
		adj[b][0]=a;
		adj[a][1]=b;
		adj[a][2]=c;
	}
	int num=0;
	for(int i=0;i<n;i++)
			if(adj[i][0]==-1&&adj[i][1]!=-1)
				num++;
	cout<<num<<endl;
	for(int i=0;i<n;i++)
			if(adj[i][0]==-1&&adj[i][1]!=-1){
				int mn=dfs(i,9999999);
				cout<<i+1<<' '<<tap+1<<' '<<mn<<endl;
			}
}			