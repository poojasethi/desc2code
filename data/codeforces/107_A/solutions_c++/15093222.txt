#include<stdio.h>
#include<algorithm>
#define N 1005
using namespace std;
int a[N],b[N],vis[N],d[N],X[N],Y[N],Z[N];
int n,m,x,y,z,i,cnt;
void DFS(int x,int s){
    vis[x]=1;
    if (!a[x]){
        ++cnt;X[cnt]=i;Y[cnt]=x;Z[cnt]=s;
        return;
  }else if (!vis[a[x]])
    DFS(a[x],min(s,b[x]));
}
int main(){
    scanf("%d%d",&n,&m);
    for (i=1;i<=m;i++)
        scanf("%d%d%d",&x,&y,&z),
        a[x]=y,b[x]=z,d[y]=1;
    for (i=1;i<=n;i++)
        if (!d[i]&&!vis[i]&&a[i]!=i&&a[i])
            DFS(i,b[i]);
    printf("%d\n",cnt);
    for (i=1;i<=cnt;i++)
        printf("%d %d %d\n",X[i],Y[i],Z[i]);
}
