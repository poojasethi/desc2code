#include <stdio.h>
#include <string.h>

#define MAXN 2000

int in[MAXN], out[MAXN], f[MAXN], next[MAXN];

int main() {
	int n, m;
	scanf("%d%d", &n, &m);
	for(int i = 0; i < m; ++i) {
		int u, v, e;
		scanf("%d%d%d", &u, &v, &e);
		++out[u], ++in[v], f[u] = e;
		next[u] = v;
	}
	int res = 0;
	for(int i = 1; i <= n; ++i)
		if(in[i] == 0 && out[i]) ++res;
	printf("%d\n", res);
	for(int i = 1; i <= n; ++i) {
		if(!in[i] && out[i]) {
			printf("%d", i);
			int mini = f[i], j;
			for(j = next[i]; out[j]; j = next[j])
				if(f[j] < mini) mini = f[j];
			printf(" %d %d\n", j, mini);
		}
	}
	return 0;
}
