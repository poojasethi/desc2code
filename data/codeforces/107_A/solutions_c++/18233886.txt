#include<bits/stdc++.h>
using namespace std;
int x,y,a,c,b,arr2[1001],ch[1001],arr[1001],d,e,cnt;
void tot(int s){
if(arr[s]==0){
    e=s;
    return;
}
d=min(d,arr2[s]);
tot(arr[s]);
}
int main(){
    cin>>x>>y;
    for(int i=1;i<=y;i++){
        cin>>a>>b>>c;
        ch[b]++;
        arr[a]=b;
        arr2[a]=c;
    }
    for(int i=1;i<=x;i++)if(ch[i]==0&&arr[i]!=0)cnt++;
    cout<<cnt<<endl;
    for(int i=1;i<=x;i++){
        if(ch[i]==0&&arr[i]!=0){
            d=1e6;
            tot(i);
            cout<<i<<" "<<e<<" "<<d<<endl;
        }
    }
}
