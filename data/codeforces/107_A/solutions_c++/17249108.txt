#include<cstdio>
const int N=1001;
int pre[N],next[N],dis[N][N];
int main()
{
	int ans=0;
	int i,n,m,a,b,c;
	scanf("%d%d",&n,&m);
	for(i=0;i<m;i++)
	{
		scanf("%d%d%d",&a,&b,&c);
		pre[b]=a;
		next[a]=b;
		dis[a][b]=c;
	}
	for(i=1;i<=n;i++)
	{
		if(!pre[i]&&next[i])
			ans++;
	}
	printf("%d\n",ans);
	for(i=1;i<=n;i++)
	{
		if(!pre[i]&&next[i])
		{
			int mi=0x7f7f7f7f;
			a=i;
			while(next[a])
			{
				b=next[a];
				mi=mi<dis[a][b]?mi:dis[a][b];
				a=b;
			}
			printf("%d %d %d\n",i,a,mi);
		}
	}
	return 0;
}
		   		  		  			 	  		 	  		 		