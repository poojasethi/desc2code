#include <iostream>
#include <vector>
#include <cmath>

using namespace std;

int main()
{
  int n,p;
  cin>>n>>p;
  vector<int> siguiente(n+1,-1);
  vector<int> cantidad(n+1,0);
  vector<int> llega(n+1,0);
  for (int i=0;i<p;i++) {
    int a,b,c;
    cin>>a>>b>>c;
    siguiente[a]=b;
    llega[b]=1;
    cantidad[a]=c;
  }
  int cuantos=0;
  for (int i=0;i<n+1;i++)
    if (llega[i]==0 and siguiente[i]!=-1)
      cuantos++;
  cout<<cuantos<<endl;
  for (int i=0;i<n+1;i++) {
    if (llega[i]==0 and siguiente[i]!=-1) {
      cout<<i<<" ";
      int u=i;
      int minimo=10000000;
      while (siguiente[u]!=-1) {
	minimo=min(minimo,cantidad[u]);
	u=siguiente[u];
      }
      cout<<u<<" "<<minimo<<endl;
    }
  }
}

