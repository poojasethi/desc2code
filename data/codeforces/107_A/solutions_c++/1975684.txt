#include<iostream>
#include<vector>

using namespace std;

pair<int,int> seq[1001];
bool out[1001];
bool in[1001];

int main()
{
	int n,m,a,b,c;
	cin>>n>>m;
	for (int i=0;i<m;i++)
	{
		cin>>a>>b>>c;
		seq[a-1] = make_pair(b-1,c);
		out[a-1] = true;
		in[b-1] = true;
	}	
	int mn,next,cnt = 0;;
	
	for (int i=0;i<n;i++)
		if (out[i] && !in[i])
			cnt++;
	cout<<cnt<<endl;
	for (int i=0;i<n;i++)
	{
		if (out[i] && !in[i])
		{
			next = i;
			mn = 0x7fffffff;
			while(true)
			{
				mn = min(mn,seq[next].second);
				next = seq[next].first;
				if (!out[next])
					break;
			}
			cout<<i+1<<" "<<next+1<<" "<<mn<<endl;
		}
	}
	return 0;
}
 	 		 	  		    	 	 	 	 	  	