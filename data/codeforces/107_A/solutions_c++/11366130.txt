#include<bits/stdc++.h>
using namespace std;
int in[1010];
int out[1010];
int a[1010][1010];
void dfs(int x,int mini)
{
	if(out[x]==x)
	{
		cout<<x<<" "<<mini<<endl;
		return;
	}
	else
		dfs(out[x],min(mini,a[x][out[x]]));
}
int main()
{
	ios_base::sync_with_stdio(false);
	int n,m,i,x,y,z;
	cin>>n>>m;
	for(i=1;i<=n;i++)
		in[i]=out[i]=-1;
	while(m--)
	{
		cin>>x>>y>>z;
		in[y]=x;
		out[x]=y;
		if(in[x]==-1)
			in[x]=x;
		if(out[y]==-1)
			out[y]=y;	
		a[x][y]=z;		
	}	
	x=0;
	for(i=1;i<=n;i++)
		if(in[i]==i)
			x++;
	cout<<x<<endl;
	for(i=1;i<=n;i++)
		if(in[i]==i)
		{
			cout<<i<<" ";
			dfs(i,100000000);
		}	
	return 0;	
}
