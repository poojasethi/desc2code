#include <iostream>
#include <algorithm>
#include <vector>
#include <string>
using namespace std;

const int MAXN = 1001;
const int INF = 0x0FFFFFFF;

int n,p,x,y,d;
int nxt[MAXN];
int prv[MAXN];
int diam[MAXN];

int main()
{
    cin>>n>>p;
    while(p--)
    {
        cin>>x>>y>>d;
        nxt[x]=y;
        prv[y]=x;
        diam[x]=d;
    }

    d=0;
    for(int i=1;i<=n;i++)
        if(!prv[i]&&nxt[i]) d++;

    cout << d << '\n';

    for(int i=1;i<=n;i++)
        if(!prv[i]&&nxt[i])
        {
            d=INF; x=i;
            while(nxt[x]) { d=min(d,diam[x]); x=nxt[x]; }
            cout << i << ' ' << x << ' ' << d << '\n';
        }

    return 0;
}

