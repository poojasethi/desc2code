//By Lin
#include<cstdio>
#include<cstring>
#include<algorithm>
#define maxn 1005
using namespace std; 

int		data[maxn][2],n,p;
bool	mark[maxn];

int		main()
{
	int x, y,w;
	scanf("%d%d", &n , &p );
	for (int i = 0; i<p; i++) {
		scanf("%d%d%d", &x, &y ,&w );
		data[x][0] = y; 
		data[x][1] = w; 
		mark[y] = true; 
	}
	int tol = 0; 
	for (int i = 1; i<=n; i++) 
		if ( !mark[i] && data[i][0] ) tol++; 
	printf("%d\n" , tol );
	for (int i = 1; i<=n; i++) 
		if ( !mark[i] && data[i][0] ) {
			int y = i, k = data[i][1];
			while ( data[y][0] ) {
				k = min( k , data[y][1] );
				y = data[y][0];
			}
			printf("%d %d %d\n" , i , y , k );
		}
	return 0;
}
