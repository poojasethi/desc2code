#include <iostream>
#include <algorithm>

#define MAXN 1010

using namespace std;

int N,P,D[MAXN][MAXN],next[MAXN],prev[MAXN],result,tank[MAXN],tap[MAXN],amount[MAXN];

int main()
{
	cin >> N >> P;
	for (int i=0;i<P;i++)
	{
		int a,b,d;
		cin >> a >> b >> d;
		D[a][b]=d;
		next[a]=b;
		prev[b]=a;
	}
	for (int i=1;i<=N;i++)
		if (!prev[i]&&next[i])
		{
			int j=i,k=1000000;
			while (next[j])
			{
				k=min(k,D[j][next[j]]);
				j=next[j];
			}
			tank[result]=i;
			tap[result]=j;
			amount[result]=k;
			result++;
		}
	cout << result << endl;
	for (int i=0;i<result;i++)
		cout << tank[i] << " " << tap[i] << " " << amount[i] << endl;
	return 0;
}