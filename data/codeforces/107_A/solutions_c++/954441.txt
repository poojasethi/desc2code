#include<iostream>
#include <algorithm>
using namespace std;
#define pb push_back
typedef pair<int,int> ii;
int nxt[1000],flow[1000];
int in[1000];
ii dfs(int a,int p)
{
    if(nxt[a])
    {
        ii t=dfs(nxt[a],a);
        return ii(t.first,min(t.second,flow[a]));
    }
    return ii(a,99999999);
}
int main()
{
int n,m,a,b,f;
cin>>n>>m;
while(m--)
{
cin>>a>>b>>f;
nxt[a]=b;
flow[a]=f;
in[b]=1;
}
int c=0;
for(int i=1;i<=n;i++)
if(!in[i]&&nxt[i])
c++;
cout<<c<<endl;
for(int i=1;i<=n;i++)
if(!in[i]&&nxt[i])
{
ii t=dfs(i,-1);
cout<<i<<' '<<t.first<<' '<<t.second<<endl;
}
}