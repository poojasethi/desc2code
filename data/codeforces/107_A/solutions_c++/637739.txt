#include <iostream>
using namespace std;

int N, P;
int in[1001], out[1001];
int ind[1001], outd[1001];

int main() {
	cin >> N >> P;
	for (int i = 1; i <= N; i++) in[i] = out[i] = -1;
	for (int i = 0; i < P; i++) {
		int a, b, d;
		cin >> a >> b >> d;
		out[a] = b;
		outd[a] = d;
		in[b] = a;
		ind[b] = d;
	}
	
	int t = 0;
	for (int i = 1; i <= N; i++)
		if (in[i] == -1 && out[i] != -1)
			t++;
	cout << t << endl;
	
	for (int i = 1; i <= N; i++)
		if (in[i] == -1 && out[i] != -1) {
			//t++;
			int tank = i;
			int tap = out[tank];
			int diam = outd[tank];
			while (out[tap] != -1) {
				tap = out[tap];
				diam = min(ind[tap],diam);
			}
			cout << tank << " " << tap << " " << diam << endl;
		}
	
	return 0;
}
