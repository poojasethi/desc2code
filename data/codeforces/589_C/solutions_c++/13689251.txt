#include <bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

#define LL long long
#define PI 3.14159265358979

#define PII pair<int,int>
#define PLL pair<LL,LL>
#define mp make_pair
#define fi first
#define se second

using namespace std;

int n,m,len,f[61],lo[61];//n<=60,len<=100,m<=10^5
char t[61][105];
char L[99999];
int tl,pl;
int cnt[61][105][26];
LL g(LL pos,int c){
    LL ans=0;
    FD(i,n-1,0){
        if((1LL<<i) < pos/len || ((1LL<<i) == pos/len && pos%len>0)){
            //pos > len*(1<<i)
            ans+=(1LL<<i)*cnt[0][len][c];
            pos-=(1LL<<i)*len;
            if(pos<=f[i+1]){
                ans+=cnt[i][lo[i]-f[i+1]+pos][c]-cnt[i][lo[i]-f[i+1]][c];
                pos=0;
                break;
            }else{
                ans+=cnt[i][lo[i]][c]-cnt[i][lo[i]-f[i+1]][c];
                pos-=f[i+1];
            }
        }
    }
    ans+=cnt[0][pos][c];
    return ans;
}
int main(){
    cin.getline(t[0],105);
    len=strlen(t[0]);
    FD(i,len,1) t[0][i]=t[0][i-1];
    
    scanf("%d %d",&n,&m);
    FI(i,1,n){
        int x;
        scanf("%d",&x);
        if(i<=60) f[i]=x;
    }
    n=min(n,60);
    
    lo[0]=len;
    
    //gen t[1] ... t[n]
    FI(i,1,len) L[i]=t[0][i];
    tl=pl=len;
    FI(i,1,n){
        if(pl>=6666){
            lo[i]=101;
            tl-=f[i];
            FI(j,1,lo[i]) t[i][j]=L[tl-lo[i]+j];
        }else{
            f[i]%=tl;
            int shuf=f[i],j=tl;
            FI(k,tl-shuf+1,tl) L[++j]=L[k];
            FI(k,1,tl-shuf) L[++j]=L[k];
            tl*=2;
            pl*=2;
            lo[i]=min(101,tl);
            FI(j,1,lo[i]) t[i][j]=L[tl-lo[i]+j];
        }
    }
    memset(cnt,0,sizeof(cnt));
    FI(k,0,n){
        FI(i,1,lo[k]){
            FI(j,0,25) cnt[k][i][j]=cnt[k][i-1][j];
            cnt[k][i][t[k][i]-'a']++;
        }
    }
    FI(i,1,m){
        LL l,r;
        char c;
        scanf("%lld %lld %c",&l,&r,&c);
        printf("%lld\n",g(r,c-'a')-g(l-1,c-'a'));
    }
    return 0;
}
