#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define pii pair<int,int>
#define pll pair<ll,ll>
#define pdd pair<double,double>
#define X first
#define Y second
#define REP(i,a) for(int i=0;i<a;++i)
#define REPP(i,a,b) for(int i=a;i<b;++i)
#define FILL(a,x) memset(a,x,sizeof(a))
#define	foreach( gg,itit )	for( typeof(gg.begin()) itit=gg.begin();itit!=gg.end();itit++ )
#define	mp make_pair
#define	pb push_back
#define sz(a) int((a).size())
#define all(a)  a.begin(), a.end()
#define	debug(ccc)	cout << #ccc << " = " << ccc << endl;
#define present(c,x) ((c).find(x) != (c).end())
const double eps = 1e-8;
#define EQ(a,b) (fabs((a)-(b))<eps)
inline int max(int a,int b){return a<b?b:a;}
inline int min(int a,int b){return a>b?b:a;}
inline ll max(ll a,ll b){return a<b?b:a;}
inline ll min(ll a,ll b){return a>b?b:a;}
const int mod = 1e9+7;
const int N = 1e6+10;
const ll inf = 1e18;
ll fl(ll x, ll y) {
    if (x >= 0) return x / y;	return x / y - (x % y ? 1 : 0);
}
ll cl(ll x, ll y) {
    if (x >= 0) return (x + y - 1) / y;    return x / y;
}

ll power(ll a,ll n){
	if(n==0){
		return 1;
	}
	ll b = power(a,n/2);
	b = b*b%mod;
	if(n%2) b= b*a%mod;
	return b;
}

int abs(int a){
	if(a>=0)	return a;
	else return -a;
}


int K[N];
ll mx;
pll B[N];
ll A[N];
pair< ll, pii > Q[N];
//priority_queue < pair< ll, pii > > Q;
ll C[30],M[30][100];
int E[30][110],D[30][110];
int n,m;

void f(int day, string s,ll l){
//	printf("%d %lld\n",day,l);
	if(l>mx)	return;
	if(day==0){
		REP(i,s.size()) M[s[i]-'a'][day]++;
	}else{
	 	REP(i,26)	M[i][day]=2*M[i][day-1];
	}
	string r;
	//printf("%d\n",(int)s.size());
	K[day]%=(int)s.size();
	if(2*l<6010){
		r = s + s.substr((int)s.size()-K[day]) + s.substr(0,(int)s.size()-K[day]) ;
	}else {
		r = s.substr(0,(int)s.size()-K[day]);
	}
	//cout<<endl<<r<<endl;
	//printf("Hi\n");
	f(day+1,r, 2*l);
//	printf("Hi %d\n",day);
	string p = s.substr((int)s.size()-K[day]);
	memset(E,0,sizeof(E));
	
	REP(i,p.size()){
		E[p[i]-'a'][i]++;
		if(i!=0)	REP(j,26)	E[j][i]+=E[j][i-1];
	}
	pair< ll, pii > a;
	int pp;
	REP(i,m){
		a = Q[i];
		if(a.X<0)	continue;
		 pp = a.Y.Y;
		 if(a.X<l)	continue;
		if(a.X-l<K[day]){
	/*		if(a.Y.Y==0){
				printf("%lld\n",l);
			}
	*/
//			printf("%lld %d %d %d %d %lld\n",a.X,i,a.Y.X,a.Y.Y,pp,a.X-l);			
			if(pp>0)	A[a.Y.X]+=(E[pp-1][a.X-l]+M[pp-1][day]);
			else 	A[a.Y.X]-=(E[-pp-1][a.X-l]+M[-pp-1][day]);
			Q[i].X=-1;
			//printf("%d %lld\n",E[pp-1][a.X-l],A[a.Y.X]);
		}else{
	/*		if(a.Y.Y==0){
				printf("%lld\n",l);
			}
	*/		
			
			if(pp>0)	A[a.Y.X]+=(E[pp-1][K[day]-1]+M[pp-1][day]);
			else A[a.Y.X]-=(E[-pp-1][K[day]-1]+M[-pp-1][day]);
			Q[i].X = a.X-l-K[day];
				
//			printf("%lld\n",A[a.Y.X]);
		}
	}
	

	if(day==0){
		REP(i,m){
			 a = Q[i];
	//		printf("%lld %d %d\n",a.X,a.Y.X,a.Y.Y);
	/*		if(a.Y.Y==0){
				printf("%lld\n",l);
			}
			
	*/		pp = a.Y.Y;
//			printf("%lld %d %d %d\n",a.X,i,a.Y.X,a.Y.Y);
			if(a.X>=0){

				if(pp>0)	A[a.Y.X]+=D[pp-1][a.X];
				else A[a.Y.X]-=D[-pp-1][a.X];
				//printf("%lld %d %d %d\n",A[a.Y.X],i,D[pp-1][a.X],pp);
			}

		}

		return;
	}
	
}

int main(){
	
	string s;
	cin>>s;
	
	REP(i,s.size()){
		D[s[i]-'a'][i]++;
		REP(j,26)	D[j][i]+=D[j][i-1];
	}

	scanf("%d %d",&n,&m);
	REP(i,n){
		scanf("%d",&K[i]);
	//	K[i]=110;
	}
	mx =-1;
	REP(i,m){
		char ch;
		scanf("%lld %lld %c",&B[i].X,&B[i].Y,&ch);
		//B[i].X=1;B[i].Y=inf;ch='a';
		B[i].Y--;B[i].X--;
		Q[2*i]=(mp(B[i].Y,mp(i,ch-'a'+1)));
		Q[2*i+1]=(mp(B[i].X-1,mp(i,-(ch-'a'+1))));
		mx = max(mx, B[i].Y);
	}
	//cout<<"hi"<<endl;
//	clock_t t;
//	t = clock();
	m*=2;
	f(0,s,(int)s.size());
//	t = clock() - t;
  //	printf ("It took meclicks (%f seconds).\n",((float)t)/CLOCKS_PER_SEC);
	m/=2;
	REP(i,m)	printf("%lld\n",A[i]);

	return 0;
}