#include <bits/stdc++.h>
#define N 222222
char s[111][22222];
int n,m,ink[N],tailpos,CH;
long long total[111][133],bu[111][133],len[N];
char chread(){
    char re;
    for (; (re = getchar()) < 33; );
    return re;
}
long long calc(long long x){//printf("%d %I64d\n", x,bu[1][CH]);
    long long re = 0;
    for (int i = 0; ; i ++ )
        if (len[i] <= x){
            re += total[i][CH];
            x -= len[i];
        }
        else{
            if (x >= ink[i]) return re + bu[i][CH] + calc(x - ink[i]);
            for (int j = 0; j < x; j ++ )
                if (s[i][j] == CH) re ++ ;
            return re;
        }
}
int main(){
    scanf("%s%d%d", s[0], &n, &m);
    for (int i = 1; i <= n; i ++ )
        scanf("%d", &ink[i]);
    if (n > 62) n = 62;
    len[0] = ink[0] = strlen(s[0]);
    for (int i = 0; i < len[0]; i ++ )
        s[0][i] -= 'a';
    for (int i = 0; i < len[0]; i ++ )
        total[0][s[0][i]] ++ ;
    for (int i = 1; i <= n; i ++ ){//printf("%d %I64d\n",i, len[i - 1]);
        if (len[i - 1] > 1000000000000000000LL){
            n = i - 1;
            continue;
        }
        for (int j = 0; j < 26; j ++ )
            if (i != 1) total[i][j] = total[i - 1][j] * 2;
            else total[i][j] = total[i - 1][j];
        len[i] = len[0];
        if (len[0] > 6400){
            for (int j = 0; j < ink[i]; j ++ )
                s[i][j] = s[0][tailpos - ink[i] + j];
            tailpos -= ink[i];
            len[0] *= 2;
        }
        else{
            for (int j = 0; j < len[i]; j ++ )
                s[i][(j + ink[i]) % len[0]] = s[0][j];
            memcpy(s[0] + len[0], s[i], len[0]);
            tailpos = (len[0] *= 2);
            //if (len[0] < 111) printf("%s\n", s[0]);
        }
    }
    /*for (int i = 1; i <= n; i ++ ){
        for (int j = 0; j < 99; j ++ )
            if (s[i][j]) printf("%c", s[i][j]);
        printf("\n");
    }*/
    len[0] = len[1];
    for (int i = 1; i <= n; i ++ )
        for (int j = 0; j < ink[i]; j ++ )
            bu[i][s[i][j]] ++ ;
    len[n + 1] = 1;
    for (int i = 1; i <= m; i ++ ){
        long long l, r;
        scanf("%I64d%I64d", &l, &r);
        CH = chread() - 'a';
        printf("%I64d\n", calc(r) - calc(l - 1));
    }
}