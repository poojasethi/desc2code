#include <iostream>
#include <cstdio>
#include <string>
#include <vector>
#include <cstring>

using namespace std;

#define si(a) scanf("%d",&a)

string day_last[100],day_last_final[100];
int shift[100005],highest_day,length;
char ch;
vector<vector<int> > all_data[100];

vector<vector<int> > func(string s)
{
    int i,al[26];
    memset(al,0,sizeof(al));
    vector<vector<int> > temp;
    vector<int> tt;
    for(i=0;i<26;i++)
        temp.push_back(tt);
    for(i=0;i<s.size();i++){
        al[s[i]-'a']++;
        for(int j=0;j<26;j++)
            temp[j].push_back(al[j]);
    }
    return temp;
}

long long solve(int now,long long pos)
{
    if(!now){
        return all_data[0][ch-'a'][pos];
    }
    long long prev_len=(1ll<<(now-1));
    prev_len*=length;
    if(pos<prev_len)
        return solve(now-1,pos);
    long long ans=(1ll<<(now-1));
    ans*=all_data[0][ch-'a'][length-1];
    if(pos>=prev_len+shift[now])
        ans+=solve(now-1,pos-(prev_len+shift[now]));
    if(day_last_final[now].size())
        ans+=all_data[now][ch-'a'][min(pos-prev_len,(long long)shift[now]-1)];
    return ans;
}

int main()
{
    //freopen("input.txt","r",stdin);
    string s;
    cin>>s;
    int len=s.size(),i,n,m;
    length=len;
    si(n);si(m);
    for(i=1;i<=n;i++)
        si(shift[i]);
    long long p=len;
    for(highest_day=1;highest_day<n;highest_day++){
        p*=2;
        if(p>1000000000000000000ll)
            break;
    }
    day_last[0]=day_last_final[0]=s;
    p=len;
    for(i=1;i<=highest_day;i++){
        shift[i]%=(p);
        len=p;
        p*=2;
        day_last[i]=day_last[i-1]+day_last[i-1].substr(len-shift[i],shift[i])+day_last[i-1].substr(0,len-shift[i]);
        if(p>6000)
            break;
    }
    for(i++;i<=highest_day;i++){
        shift[i]%=p;
        p*=2;
        len=day_last[i-1].size();
        day_last[i]=day_last[i-1].substr(0,len-shift[i]);
    }
    for(i=1;i<=highest_day;i++){
        len=day_last[i-1].size();
        day_last_final[i]=day_last[i-1].substr(len-shift[i],shift[i]);
    }
    for(i=0;i<=highest_day;i++)
        all_data[i]=func(day_last_final[i]);
    for(i=0;i<m;i++){
        long long l,r;
        scanf("%I64d%I64d %c",&l,&r,&ch);
        l--;r--;
        long long ans=solve(highest_day,r);
        if(l)
            ans-=solve(highest_day,l-1);
        printf("%I64d\n",ans);
    }
    return 0;
}

		 	    	  	 		   	       			