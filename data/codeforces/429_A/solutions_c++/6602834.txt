#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
struct edge{
	int t,next;
}g[400001];
int i,j,k,n,m,a[200001],tot,h[200001],q[200001];
void addedge(int x,int y){
	g[++tot].t=y;g[tot].next=h[x];h[x]=tot;
	g[++tot].t=x;g[tot].next=h[y];h[y]=tot;
}
void work(int x,int fa,int t1,int t2){
	int i,w1,w2;
	if (a[x]^t1) w1=t2,w2=t1^1,q[++q[0]]=x;else w1=t2,w2=t1;
	for (i=h[x];i;i=g[i].next)
	 if (fa!=g[i].t) work(g[i].t,x,w1,w2);
}
int main(){
	scanf("%d",&n);tot=0;memset(h,0,sizeof(h));
	for (i=1;i<n;i++) scanf("%d%d",&j,&k),addedge(j,k);
	for (i=1;i<=n;i++) scanf("%d",&a[i]);
	for (i=1;i<=n;i++) scanf("%d",&k),a[i]^=k;
	q[0]=0;work(1,0,0,0);
	for (i=0;i<=q[0];i++) printf("%d\n",q[i]);
	return 0;
}