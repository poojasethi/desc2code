#include <cstdio>
#include <cstdlib>
using namespace std;

int n,x,y;
int cnt,son[100001],next[200001],ed[200001];
int vis[100001],a[100001],ans[100001],Cnt;

inline void add(int x,int y)
{
	next[++cnt]=son[x]; son[x]=cnt; ed[cnt]=y;
}

void dfs(int u,int h,int f1,int f2)
{
	vis[u]=1; if (h&1?a[u]^f1:a[u]^f2) ans[++Cnt]=u,h&1?f1^=1:f2^=1;
	for (int j=son[u];j;j=next[j]) if (!vis[ed[j]]) dfs(ed[j],h+1,f1,f2);
}

int main()
{
	scanf("%d",&n);
	for (int i=1;i<n;i++)
	{
		scanf("%d%d",&x,&y);
		add(x,y); add(y,x);
	}
	for (int i=1;i<=n;i++) scanf("%d",&a[i]);
	for (int i=1;i<=n;i++) scanf("%d",&x),a[i]^=x;
	dfs(1,1,0,0);
	printf("%d\n",Cnt);
	for (int i=1;i<=Cnt;i++) printf("%d\n",ans[i]);
}

