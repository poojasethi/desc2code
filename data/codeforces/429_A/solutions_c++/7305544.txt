#include <iostream>
#include <vector>
using namespace std;
const int Nmax=100001;
int n, a[Nmax], b[Nmax], i, x, y, ans;
vector <int> e[Nmax];

void dfs(int x)
{
	for (int i=0; i<e[x].size(); i++) {
		if (a[e[x][i]]==0) {
			a[e[x][i]]=x; dfs(e[x][i]);
		}
	}
}

int main()
{
	cin>>n;
	for (i=1; i<n; i++) {
		cin>>x>>y; e[x].push_back(y); e[y].push_back(x);
	}
	dfs(1);
	for (i=1; i<=n; i++) cin>>b[i];
	for (i=1; i<=n; i++) {
		cin>>x; b[i]^=x;
	}
	a[1]=0; 
	for (i=1; i<=n; i++) if (b[i]!=b[a[a[i]]]) ans++;
	cout<<ans<<endl;
	for (i=1; i<=n; i++) if (b[i]!=b[a[a[i]]]) cout<<i<<endl;
	return 0;
}
