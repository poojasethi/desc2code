#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 100010
#define M 2000000
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int x,y,z,id;
	int use;
} a[N],b[M];
int i,j,k,n,m,x,y,z,t,root;
int id[N],in[N],qu[N],Id[N],F[N],h[N],an[N];
inline int work() {
	int s=0,T;
	for (;;) {
		For(i,1,n) F[i]=id[i]=0,in[i]=N;
		For(i,1,m) {
			int A=a[i].id,B=a[i].y;
			if (a[i].x!=B&&B!=root&&a[i].z<in[B]) {
				in[B]=a[i].z;
				qu[B]=a[i].x;
				h[B]=A;
			}
		}
		For(i,1,n) if (i!=root) {
			if (in[i]==N) return -1;
			s+=in[i];
		}
		T=0;
		For(i,1,n) if (i!=root) {
			b[h[i]].use++;
			for (j=i;j!=root&&!F[j];j=qu[j]) F[j]=i;
			if (j!=root&&F[j]==i) {
				++T;
				for (k=j;qu[k]!=j;k=qu[k]) id[k]=T;
				id[k]=T;
			}
		}
		if (!T) return s;
		For(i,1,n) if (!id[i]) id[i]=++T;
		For(i,1,m) {
			int A=a[i].id,B=a[i].y;
			a[i].x=id[a[i].x];
			a[i].y=id[B];
			if (a[i].x!=a[i].y&&B!=root) {
				a[i].z-=in[B];
				a[i].id=++t;
				b[t].x=A;
				b[t].y=h[B];
			}
		}
		n=T;
		root=id[root];
	}
}
int main() {
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
	scanf("%d%d",&n,&m); t=m; root=1;
	For(i,1,m) {
		scanf("%d%d%d",&x,&y,&z);
		a[i]=(ww){x,y,z,i};
		b[i].z=z;
	}
	For(i,1,n) id[i]=i;
	int an=work();
	if (an<0) printf("-1\n");
	else {
		printf("%d\n",an);
		for (i=t;i>m;i--) b[b[i].x].use+=b[i].use,b[b[i].y].use-=b[i].use;
		For(i,1,m) if (b[i].z&&b[i].use) printf("%d ",i);
		printf("\n");
	}
	return 0;
}
 			  			   				   						 			 	