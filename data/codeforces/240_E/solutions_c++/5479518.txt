#include <cstdio>
#define maxn 100005

struct edge
{
	int x,y,z,p;
} a[maxn*10],e[maxn];
int N,M,K,w[maxn],p[maxn],q[maxn],d[maxn],b[maxn],c[maxn];

int main()
{
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
	scanf("%d%d",&N,&M);
	for (int i=1; i<=M; i++) scanf("%d%d%d",&e[i].x,&e[i].y,&e[i].z),c[i]=e[i].z,e[i].p=++K;
	int ans=0;
	for (int n=N,m=M,r=1,nn,mm;; n=nn,m=mm,r=q[r])
	{
		for (int i=1; i<=n; i++) w[i]=1e9,p[i]=q[i]=b[i]=d[i]=0;
		for (int i=1; i<=m; i++) if (e[i].z<w[e[i].y]) w[e[i].y]=e[i].z,p[e[i].y]=e[i].x,d[e[i].y]=e[i].p;
		nn=mm=w[r]=p[r]=d[r]=0;
		for (int i=1; i<=n; i++) if (!p[i]&&i!=r) {ans=-1; break;} else ans+=w[i],a[d[i]].z++;
		for (int i=1,x; i<=n; i++) if (!q[i])
		{
			for (x=i; x&&!q[x]&&b[x]!=i; x=p[x]) b[x]=i;
			if (x==i) for (q[i]=++nn,x=p[i]; x!=i; x=p[x]) q[x]=nn;
		}
		if (!nn) break;
		for (int i=1; i<=n; i++) if (!q[i]) q[i]=++nn;
		for (int i=1; i<=m; i++) if (q[e[i].x]!=q[e[i].y])
		{
			a[++K].x=e[i].p,a[K].y=d[e[i].y];
			e[i].z-=w[e[i].y],e[i].x=q[e[i].x],e[i].y=q[e[i].y],e[i].p=K,e[++mm]=e[i];
		}
	}
	if (ans<0) {puts("-1"); return 0;}
	printf("%d\n",ans);
	for (int i=K; i>M; i--) a[a[i].x].z+=a[i].z,a[a[i].y].z-=a[i].z;
	for (int i=1; i<=M; i++) if (c[i]&&a[i].z) printf("%d ",i);
}