#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n	100005
#define m	2000005
#define INF	(1<<30)
#define For(i,a,b)	for(int i=a;i<=b;i++)

int		N,M,T,C,Rt,Ans,D[n],V[n],IN[n],Be[n],La[n],Min[n];
struct	Lin{int u,v,c;}E[n],Q[m];
bool	G[n];

int		MST(){
		for	(int ret=0;;){
			For(i,1,N)	IN[i]=Be[i]=La[i]=V[i]=0,Min[i]=INF;
			For(i,1,M)	if	(E[i].u!=E[i].v&&E[i].v!=Rt&&E[i].c<Min[E[i].v])
				IN[E[i].v]=E[i].u,Min[E[i].v]=E[i].c,La[E[i].v]=D[i];
			For(i,1,N)	if	(i!=Rt){
				if	(Min[i]==INF)	return	-1;	ret+=Min[i];
			}

			For(i,1,N)	if	(i!=Rt){
				int j=i,k;	Q[La[i]].c++;
				for	(;V[j]!=i&&j!=Rt&&!Be[j];j=IN[j])	V[j]=i;
				if	(j!=Rt&&!Be[j]){
					for	(k=j,C++;IN[k]!=j;k=IN[k])	Be[k]=C;	Be[k]=C;
				}
			}

			if	(!C)	return	ret;
			For(i,1,N)	if	(!Be[i])	Be[i]=++C;
			For(i,1,M)	{
				int v=E[i].v;
				E[i].u=Be[E[i].u];	E[i].v=Be[E[i].v];
				if	(E[i].u!=E[i].v)
					E[i].c-=Min[v],Q[++T]=(Lin){D[i],La[v],0},D[i]=T;
			}	Rt=Be[Rt];	N=C;	C=0;
		}
}

int		main(){
		freopen("input.txt","r",stdin);
		freopen("output.txt","w",stdout);

		scanf("%d%d",&N,&M);	T=M;Rt=1;
		For(i,1,M)	scanf("%d%d%d",&E[i].u,&E[i].v,&E[i].c),D[i]=i,G[i]=E[i].c;
		printf("%d\n",Ans=MST());
		if	(Ans!=-1){
			for	(int i=T;i>M;i--)	Q[Q[i].u].c+=Q[i].c,Q[Q[i].v].c-=Q[i].c;
			For(i,1,M)	if	(G[i]&&Q[i].c) printf("%d ",i);
		}
}