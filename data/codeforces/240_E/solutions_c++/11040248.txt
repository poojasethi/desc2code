#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define	n	100005
#define m	2000005
#define INF	(1<<30)
#define For(i,a,b)	for(int i=a;i<=b;i++)

int		N,M,T,C,Rt,Ans,V[n],IN[n],Be[n],La[n],Min[n];
struct	Lin{int u,v,c,l,a,b,t;}E[n],Q[m];

int		MST(){
		for	(int ret=0;;){
			For(i,1,N)	IN[i]=Be[i]=La[i]=V[i]=0,Min[i]=INF;
			For(i,1,M)	if	(E[i].u!=E[i].v&&E[i].v!=Rt&&E[i].c<Min[E[i].v])
				Min[E[i].v]=E[i].c,IN[E[i].v]=E[i].u,La[E[i].v]=E[i].l;
			For(i,1,N)	if	(i!=Rt){
				if	(Min[i]==INF)	return	-1;	ret+=Min[i];
			}

			For(i,1,N)	if	(i!=Rt){
				Q[La[i]].t++;	int j=i,k;
				for	(;V[j]!=i&&j!=Rt&&!Be[j];j=IN[j])	V[j]=i;
				if	(j!=Rt&&!Be[j]){
					for	(C++,k=j;IN[k]!=j;k=IN[k])	Be[k]=C;	Be[k]=C;
				}
			}

			if	(!C)	return	ret;
			For(i,1,N)	if	(!Be[i])	Be[i]=++C;
			For(i,1,M)	{
				int v=E[i].v;	E[i].u=Be[E[i].u];	E[i].v=Be[E[i].v];
				if	(E[i].u!=E[i].v){
					E[i].c-=Min[v];	Q[++T]=E[i];	Q[T].t=0;
					Q[T].a=E[i].l;	Q[T].b=La[v];	E[i].l=T;
				}
			}	Rt=Be[Rt];	N=C;	C=0;
		}
}

int		main(){
		freopen("input.txt","r",stdin);
		freopen("output.txt","w",stdout);
		scanf("%d%d",&N,&M);	Rt=1;
		For(i,1,M)
			scanf("%d%d%d",&E[i].u,&E[i].v,&E[i].c),Q[++T]=E[i],E[i].l=T;
		if	((Ans=MST())==-1)	puts("-1");
		else	{
			printf("%d\n",Ans);
			for	(int i=T;i>M;i--)
				Q[Q[i].a].t+=Q[i].t,Q[Q[i].b].t-=Q[i].t;
			For(i,1,M)	if	(Q[i].t&&Q[i].c)	printf("%d ",i);
		}
}