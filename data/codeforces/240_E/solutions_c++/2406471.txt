#include <iostream>
#include <cstdio>
#include <cstring>
#include <vector>
using namespace std;

const int ot=100100;
int ans,n,m,d[101000],next[201000],num[201000],a[101000],len[201000],Q[101000],col[101000],tt,cnt,co,x,y,z;
bool vis[101000],w[101000];
vector <int> L[101000],pr;

void Insert(int x,int y,int z)
{
	next[++tt]=a[x];num[tt]=y;len[tt]=z;a[x]=tt;
	next[tt+ot]=a[y];num[tt+ot]=x;len[tt+ot]=z;a[y]=tt+ot;
}

void dfs1(int x)
{
	vis[x]=true;
	for (int p=a[x];p;p=next[p]) if (tt<ot && !vis[num[p]])	dfs1(num[p]);
	Q[++cnt]=x;
}

void dfs2(int x)
{
	vis[x]=false;col[x]=co;
	L[co].push_back(x);
	for (int p=a[x];p;p=next[p]) if (tt>ot && vis[num[p]]) dfs2(num[p]);
}

void find(int x)
{
	w[x]=true;
	for (int i=0;i<L[x].size();i++)
	{
		for (int p=a[L[x][i]];p;p=next[p])
		{
			if (p<ot && len[p]<=d[col[num[p]]] && !w[col[num[p]]]) 
			{
				find(col[num[p]]);
				if (len[p]==1) pr.push_back(p);
			}
		}
	}
}

int main()
{
	freopen("input.txt","r",stdin);freopen("output.txt","w",stdout);
	
	scanf("%d%d",&n,&m);
	for (int i=1;i<=m;i++) scanf("%d%d%d",&x,&y,&z),Insert(x,y,z);
	
	dfs1(1);
	for (int i=cnt;i>=1;i--) if (vis[Q[i]]) co++,dfs2(Q[i]);
	
	for (int i=2;i<=co;i++) d[i]=1;
	for (int i=1;i<=m;i++)
	{
		if (col[num[i]]!=col[num[i+ot]]) d[col[num[i]]]=min(d[col[num[i]]],len[i]);
	}
	find(1);
	for (int i=1;i<=co;i++) if (!w[i]) { printf("-1\n");return 0; }
	for (int i=1;i<=co;i++) ans+=d[i];
	printf("%d\n",ans);
	for (int i=0;i<ans;i++) printf("%d ",pr[i]);
	printf("\n");
	
	return 0;
}