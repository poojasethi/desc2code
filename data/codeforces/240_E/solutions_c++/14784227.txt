#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <queue>
using namespace std;

const int MAXN= 101010;

class Road
{public:
	int t, next, v;
}e[MAXN];
int p[MAXN];
int z = 0;

bool vis[MAXN];
int dep[MAXN];

int n, m;

void add(int u, int v, int c)
{
	++z;
	e[z].t = v;
	e[z].next = p[u];
	e[z].v = c;
	p[u] = z;
}

void bfs()
{
	queue<int> q;
	q.push(1);
	dep[1] = 0;
	vis[1] = true;
	
	while(!q.empty())
	{
		int u = q.front();
		q.pop();
		for(int tmp = p[u]; tmp != -1; tmp = e[tmp].next)
		{
			if(!vis[e[tmp].t])
			{
				vis[e[tmp].t] = true;
				if(e[tmp].v)
					dep[e[tmp].t] = tmp;
				q.push(e[tmp].t);
			}
			else
			if(dep[e[tmp].t] && !e[tmp].v)
			{
				q.push(e[tmp].t);
				dep[e[tmp].t] = 0;
			}
		}
	}
}

int ans[MAXN];
int cnt = 0;

int main()
{
	freopen("input.txt","r", stdin);
	freopen("output.txt", "w", stdout);
	
	memset(p, -1, sizeof(p));
	
	scanf("%d%d", &n, &m);
	int u, v, c;
	for(int i = 1; i <= m; ++i)
	{
		scanf("%d%d%d", &u, &v, &c);
		add(u, v, c);
	}
	bfs();
	
	for(int i = 1; i <= n; ++i)
	{
		if(!vis[i])
		{
			printf("-1\n");
			return 0;
		}
	}
	
	for(int i = 1; i <= n; ++i)
	{
		if(dep[i])
			ans[++cnt] = dep[i];
	}
	printf("%d\n", cnt);
	for(int i = 1; i <= cnt; ++i)
		printf("%d ", ans[i]);
	printf("\n");
	
	return 0;
}
