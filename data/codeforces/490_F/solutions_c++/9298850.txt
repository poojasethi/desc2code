#include<cstdio>
#include<cmath>
#include<cstring>
#include<iostream>
#include<vector>
#define maxn 6048
using namespace std;
int n;
vector<int>u[maxn];
int r[maxn];
int dp[maxn];
int ans=0;
void dfs(int now,int fa)
{
    int rank=lower_bound(dp,dp+n,r[now]) - dp;
    ans=max(ans,rank+1);
    int tmp = dp[rank];
    dp[rank]=r[now];
    for(int i=0;i<u[now].size();i++)
        if(u[now][i]!=fa)
            dfs(u[now][i],now);
    dp[rank]=tmp;
    return ;
}
int main(){
    scanf("%d",&n);
    for(int i=1;i<=n;i++)
        scanf("%d",&r[i]);
    int x,y;
    for(int i=1;i<n;i++)
    {
        scanf("%d%d",&x,&y);
        u[x].push_back(y);
        u[y].push_back(x);
    }
    memset(dp,0x7f7f7f7f,sizeof(dp));
    for(int i=1;i<=n;i++)
        dfs(i,-1);
    printf("%d\n",ans);
    return 0;
}
