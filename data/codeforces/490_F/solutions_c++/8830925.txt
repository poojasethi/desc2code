#include<cstdio>
#include<cstdlib>
#include<algorithm>
#define N 23333
#define rep(i,n) for(int i=1;i<=n;i++)
using namespace std;
int dis[N],f[N],n,w[N],ans;
int son[N],next[N],ed[N],cnt;
void dfs(int t,int F){
    int j=lower_bound(f,f+1+n,w[t])-f;
    
    
    if(f[j-1]<w[t]){
        int tmp=f[j];
        f[j]=w[t],ans=max(j,ans);
        for(int i=son[t];i;i=next[i])
        if(ed[i]!=F) dfs(ed[i],t);
        f[j]=tmp;
        return;
    }
    
    
    for(int i=son[t];i;i=next[i])
    if(ed[i]!=F) dfs(ed[i],t);
        
}
int main(){
    scanf("%d",&n);
    rep(i,n) scanf("%d",&w[i]);
    
    rep(i,n-1){
        int x,y; scanf("%d%d",&x,&y);
        next[++cnt]=son[x]; son[x]=cnt; ed[cnt]=y;
        next[++cnt]=son[y]; son[y]=cnt; ed[cnt]=x;
    }
    
    rep(i,n) f[i]=0x7f7f7f7f;
    rep(t,n) dfs(t,0);
    
    printf("%d\n",ans);
}
