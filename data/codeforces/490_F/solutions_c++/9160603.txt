#include<bits/stdc++.h>
using namespace std;
vector <int>a[6000];int ans=0;
int r[6001],d[6001];int n;
void dfs(int cur,int par)
{int i,backup;

    int k=lower_bound(d,d+n,r[cur])-d;
backup=d[k];
ans=max(ans,k+1);
d[k]=r[cur];
for(i=0;i<a[cur].size();i++)
if(a[cur][i]!=par)
dfs(a[cur][i],cur);
d[k]=backup;


}
main()
{int x,y,i;
    cin>>n;
    for(i=0;i<n;i++)
    cin>>r[i];
    for(i=0;i<n-1;i++){
    cin>>x>>y;
    x--;y--;
    a[x].push_back(y);
    a[y].push_back(x);}

    for(i=0;i<n;i++)
    d[i]=1000001;
    for(i=0;i<n;i++)
    dfs(i,-1);
    cout<<ans;
}
