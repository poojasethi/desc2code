#include <iostream>
#include <algorithm>
#include <cstdio>
#include <cstring>
#include <vector>
#include <map>
#define LL long long
using namespace std;
const int maxn=6005;
int v[maxn];
vector<int> g[maxn];
int dp[maxn];
int ans;
int n;
void dfs(int rt,int fa)
{
    int d=lower_bound(dp,dp+n+1,v[rt])-dp;
    ans=max(d+1,ans);
    int old=dp[d];
    dp[d]=min(dp[d],v[rt]);
    for(int i=0; i<g[rt].size(); ++i)
    {
        if(fa!=g[rt][i])
            dfs(g[rt][i],rt);
    }
    dp[d]=old;
}
int main()
{
    scanf("%d",&n);
    for(int i=1; i<=n; ++i)
        scanf("%d",&v[i]);
    for(int i=1; i<n; ++i)
    {
        int x,y;
        scanf("%d%d",&x,&y);
        g[x].push_back(y);
        g[y].push_back(x);
    }
    memset(dp,0x7f,sizeof(dp));
    for(int i=1; i<=n; ++i)
        dfs(i,-1);
    printf("%d\n",ans);
    return 0;
}
