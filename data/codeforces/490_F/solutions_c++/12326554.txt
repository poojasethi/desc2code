#include<iostream>
#include<vector>
#define MAXN 6005
using namespace std;
vector <int> f[MAXN];
int n;
int d[MAXN];
int ans;
int x[MAXN];
int dfs(int i,int pre){
    int k=lower_bound(x, x + n, d[i]) - x;
    ans=max(ans,k);
    int temp=x[k];
    x[k]=d[i];
    for(int j=0;j<f[i].size();j++){
        if(f[i][j]!=pre) dfs(f[i][j],i);
    }
    x[k]=temp;
}
int main()
{
    ans=0;
    cin>>n;
    for(int i=1;i<=n;i++) {
        cin>>d[i];
        f[i].clear();
    }
    for(int i=0;i<n-1;i++){
        int ix,iy;
        cin>>ix>>iy;
        f[ix].push_back(iy);
        f[iy].push_back(ix);
    }
    for(int i=0;i<=n;i++) x[i]=0x7fffffff;
    for(int i=1;i<=n;i++){
        dfs(i,0);
    }
    cout<<ans+1<<endl;
    return 0;
}

    	 				 		  		  			  			 			