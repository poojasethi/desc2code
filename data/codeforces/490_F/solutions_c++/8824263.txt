#include<cstdio>
#include<algorithm>
#include<cstring>
#include<vector>
#include<iostream>
#define rep(i,x,y) for(int i=x;i<=y;++i)
#define dep(i,x,y) for(int i=x;i>=y;--i)
#define LL long long
#define LD long double
using namespace std;
#define N 6005

int n,r[N],x,y,son[N],next[N<<1],ed[N<<1],p[N],ans;

void dfs(int x,int fa){
	int po=lower_bound(p+1,p+1+n,r[x])-p;
	ans=max(ans,po);
	int tmp=p[po];
	p[po]=r[x];
	for(int j=son[x];j;j=next[j])
		if(ed[j]^fa)
			dfs(ed[j],x);
	p[po]=tmp;
}

int main(){
	scanf("%d",&n);
	rep(i,1,n) scanf("%d",r+i);
	rep(i,2,n){
		scanf("%d%d",&x,&y);
		next[i]=son[x],son[x]=i,ed[i]=y;
		next[i+n]=son[y],son[y]=i+n,ed[i+n]=x;
	}
	memset(p,0x7f,sizeof(p));
	rep(i,1,n)
		dfs(i,0);
	printf("%d\n",ans);
}
