#include <bits/stdc++.h>
using namespace std;
int ar[6002],dp[6002];
vector <int> adj[6002];
int ret=0,n;
const int INF =1e9+7;
void dfs(int ind,int par=0){
	int k= lower_bound(dp,dp+n,ar[ind])-dp;
	ret= max(ret,k+1);
	int v = dp[k];
	dp[k]= ar[ind];
	for(int i=0;i<adj[ind].size();++i)
		if(adj[ind][i]!=par)
			dfs(adj[ind][i],ind);
	dp[k]= v;
}
int main(){
	int i,a,b;
	cin>>n;
	for(i=1;i<=n;++i)cin>>ar[i];
	for(i=0;i<n-1;++i){
		cin>>a>>b;
		adj[a].push_back(b);
		adj[b].push_back(a);
	}
	for(i=0;i<=n;++i)dp[i]=INF;
	for(i=1;i<=n;++i){
		dfs(i);
	}
	cout<<ret<<endl;
}
