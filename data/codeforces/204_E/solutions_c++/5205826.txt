#include <cmath>
#include <cstdio>
#include <cstring>
#include <cstdlib>
#include <iostream>
#include <algorithm>
#define maxn 200205
#define ll long long
using namespace std;

int N,K,L,le[maxn],S[maxn],p[maxn],pr[maxn],wr[maxn],w[maxn],c[maxn],t[maxn],tmp[maxn],r[maxn*2],sa[maxn],h[maxn],q[maxn];
char s[maxn];
ll ans[maxn];

void init()
{
	scanf("%d%d",&N,&K);
	for (int i=1,l; i<=N; i++)
	{
		scanf("%s",s),l=strlen(s);
		for (int j=0; j<l; j++) S[++L]=s[j],p[L]=i,le[L]=l-j;
		S[++L]=i+128,p[L]=i;
	}
}

void build()
{
	for (int i=1; i<=L; i++) r[i]=S[i];
	for (int x=1; x<=L; x<<=1)
	{
		memset(t,0,sizeof(t));
		memset(tmp,0,sizeof(tmp));
		for (int i=1; i<=L; i++) t[r[i+x]]++;
		for (int i=1; i<=L+128; i++) t[i]+=t[i-1];
		for (int i=L; i; i--) tmp[t[r[i+x]]--]=i;
		memset(t,0,sizeof(t));
		for (int i=1; i<=L; i++) t[r[i]]++;
		for (int i=1; i<=L+128; i++) t[i]+=t[i-1];
		for (int i=L; i; i--) sa[t[r[tmp[i]]]--]=tmp[i];
		tmp[sa[1]]=1;
		for (int i=2; i<=L; i++) tmp[sa[i]]=tmp[sa[i-1]]+(r[sa[i]]!=r[sa[i-1]]||r[sa[i]+x]!=r[sa[i-1]+x]);
		memcpy(r,tmp,sizeof(tmp));
		if (r[sa[L]]==L) break;
	}
	for (int i=1,k=0; i<=L; i++)
	{
		if (k) k--;
		for (int j=sa[r[i]-1]; i+k<=L&&j+k<=L&&S[i+k]==S[j+k]; k++);
		h[r[i]]=k;
	}
}

void doit()
{
	build();
	for (int i=1,t=0,j=0,l=1,r=0; i<=L; i++)
	{
		for (;t<K&&j<=L; q[++r]=j,w[j]=h[q[l]])
		{
			t+=!(c[p[sa[++j]]]++);
			for (;l<=r&&h[q[r]]>h[j]; r--);
		}
		if (t<K) break;
		for (;l<=r&&q[l]<=i; l++);
		pr[i]=j,wr[i]=l>r?le[sa[i]]:h[q[l]],t-=!(--c[p[sa[i]]]);
	}
	for (int i=1,l=1,r=0; i<=L; i++)
	{
		for (;l<=r&&pr[q[l]]<i; l++);
		for (;l<=r&&wr[q[r]]<wr[i]; r--);
		q[++r]=i,w[i]=max(w[i],wr[q[l]]);
	}
	for (int i=1; i<=L; i++) ans[p[sa[i]]]+=w[i];
	for (int i=1; i<=N; i++) printf("%I64d%c",ans[i],i==N?'\n':' ');
}

int main()
{
	init();
	doit();
	return 0;
}