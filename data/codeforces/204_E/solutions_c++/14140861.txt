#include<cstdio>
#include<cstring>
#define rep(i,n) for (i=0;i<n;i++)
#define N 201000
int A[N],B[N],a[N],c[N],v[N],sa[N],rk[N],h[N],bl[N],d[N];
int n,m,K,i,j,len,cnt,f=1,b,r,q[N],l[N],w[N];
long long ans[N]; char s[N];
bool cmp(int *s,int a,int b,int l){return s[a]==s[b]&&s[a+l]==s[b+l];}
void SA(int n)
{
	int i,j,k=0,p,m=n+255,*x=A,*y=B,*t;
	rep(i,m) c[i]=0; rep(i,n) c[x[i]=a[i]]++; rep(i,m) c[i+1]+=c[i];
	for (i=n-1;i>=0;i--) sa[--c[x[i]]]=i;
	for (j=1,p=1;p<n;j*=2,m=p){
		for (p=0,i=n-j;i<n;i++) y[p++]=i;
		rep(i,n) if (sa[i]>=j) y[p++]=sa[i]-j;
		rep(i,m) c[i]=0; rep(i,n) c[v[i]=x[y[i]]]++; rep(i,m) c[i+1]+=c[i];
		for (i=n-1;i>=0;i--) sa[--c[v[i]]]=y[i];
		for (t=x,x=y,y=t,i=1,p=1,x[sa[0]]=0;i<n;i++)
			x[sa[i]]=cmp(y,sa[i],sa[i-1],j)?p-1:p++;
		}
	rep(i,n) rk[sa[i]]=i;
	for (i=0;i<n;h[rk[i++]]=k) for (k?k--:0,j=sa[rk[i]-1];a[i+k]==a[j+k];k++);
}
int main()
{
	scanf("%d%d",&n,&K);
	rep(i,n){
		scanf("%s",s),len=strlen(s);
		rep(j,len) bl[m]=i+1,d[m]=len-j,a[m++]=s[j];
		a[m++]=i+255;
		}
	SA(++m); rep(i,m) c[i]=v[i]=0; c[0]=m;
	rep(i,m){
		while (cnt<K && r<m){
			l[r]=i,cnt+=!(c[bl[sa[r]]]++);
			while (f<=b && h[q[b]]>h[r]) b--; q[++b]=r;
			w[r++]=h[q[f]];
			}
		if (cnt<K) break; f+=f<=b&&q[f]<=i;
		v[i]=f>b?d[sa[i]]:h[q[f]]; cnt-=!(--c[bl[sa[i]]]);
		}
	f=1,b=0;
	rep(i,m){
		while (f<=b && v[q[b]]<v[i]) b--; q[++b]=i;
		while (f<=b && q[f]<l[i]) f++;
		if (f<=b && v[q[f]]>w[i]) w[i]=v[q[f]]; ans[bl[sa[i]]]+=w[i];
		}
	rep(i,n) printf("%I64d%s",ans[i+1],i+1<n?" ":"\n"); return 0;
}
