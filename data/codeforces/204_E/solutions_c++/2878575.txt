#include<cstdio>
#include<cstring>
#define rep(i,n) for (i=0;i<n;i++)
#define N 201000
int A[N],B[N],a[N],c[N],v[N],sa[N],rk[N],h[N],bl[N],d[N];
int n,m,K,i,j,len,cnt,fr=1,bk,r,res,q[N],l[N],w[N];
long long ans[N]; char s[N];
bool cmp(int *s,int a,int b,int L){return s[a]==s[b] && s[a+L]==s[b+L];}
void SA(int n)
{
	int i,j,k=0,m=n+255,p,*x=A,*y=B,*t;
	rep(i,m) c[i]=0; rep(i,n) c[x[i]=a[i]]++; rep(i,m) c[i+1]+=c[i];
	for (i=n-1;i>=0;i--) sa[--c[x[i]]]=i;
	for (j=1,p=1;p<n;j*=2,m=p){
		for (i=n-j,p=0;i<n;i++) y[p++]=i;
		rep(i,n) if (sa[i]>=j) y[p++]=sa[i]-j;
		rep(i,m) c[i]=0; rep(i,n) c[v[i]=x[y[i]]]++; rep(i,m) c[i+1]+=c[i];
		for (i=n-1;i>=0;i--) sa[--c[v[i]]]=y[i];
		for (t=x,x=y,y=t,i=1,x[sa[0]]=0,p=1;i<n;i++)
			x[sa[i]]=cmp(y,sa[i],sa[i-1],j)?p-1:p++;
		}
	rep(i,n) rk[sa[i]]=i;
	for (i=0;i<n;h[rk[i++]]=k)
		for (k?k--:0,j=sa[rk[i]-1];a[i+k]==a[j+k];k++);
}
int main()
{
	scanf("%d%d",&n,&K);
	rep(i,n){
		scanf("%s",s),len=strlen(s);
		rep(j,len) bl[m]=i+1,d[m]=len-j,a[m++]=s[j];
		a[m++]=i+255;
		}
	SA(++m); rep(i,m) c[i]=v[i]=0; c[0]=m+5;
//	rep(i,m) printf("%d ",a[i]); puts("");
//	rep(i,m) printf("%d ",sa[i]); puts("");
//	rep(i,m) printf("%d ",h[i]); puts("");
	rep(i,m){
		while (cnt<K && r<m){
			cnt+=!(c[bl[sa[r]]]++); l[r]=i;
	//		printf("%d %d %d\n",r,i,cnt);
			while (fr<=bk && h[q[bk]]>=h[r]) bk--; q[++bk]=r;
			w[r++]=h[q[fr]];
			}
//		printf("%d %d  %d %d\n",i,r,fr,bk);
		if (cnt<K) break; fr+=fr<=bk && q[fr]<=i;
		v[i]=fr<=bk?h[q[fr]]:d[sa[i]]; cnt-=!(--c[bl[sa[i]]]);
		}
//	rep(i,m) printf("%d ",v[i]); puts("");
//	rep(i,m) printf("%d ",w[i]); puts("");
//	rep(i,m) printf("%d ",l[i]); puts("");
	fr=1,bk=0;
	rep(i,m){
		while (fr<=bk && v[q[bk]]<=v[i]) bk--; q[++bk]=i;
		while (fr<=bk && q[fr]<l[i]) fr++;
		res=w[i]; if (fr<=bk && v[q[fr]]>res) res=v[q[fr]];
		ans[bl[sa[i]]]+=res;
		}
	rep(i,n) printf("%I64d%s",ans[i+1],i+1<n?" ":"\n"); return 0;
}
