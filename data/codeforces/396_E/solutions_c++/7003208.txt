#include <stdio.h>
#include <algorithm>
#include <memory.h>
#include <vector>
using namespace std;
typedef __int64 ll;
const ll mod = 1000000007;
typedef pair<ll, ll>pll;
#define M 1001001
#define rep(i,n) for(int i=0; i<n; i++)
#define REP(i,n) for(int i=1; i<=n; i++)
#define sz size()
#define pb push_back
int mn[M];
vector<int> v[M];
vector<pll> a[M];
ll ans[M];
int n, pn;
ll T;


void init(){
	for(int i=2; i<M; i++)if(!mn[i]){
		mn[i]=i;
		if(i>10000)continue;
		for(int j=i*i; j<M; j+=i)if(!mn[j])mn[j]=i;
	}
	///printf("%d\n", mn[M-1]);
	for(int j=2; j<M; j++)if(mn[j]==j){
		int k=j-1;
		while(k>1){
			v[j].pb(mn[k]);
			k/=mn[k];
		}
		pn++;
	}
	///printf("pn = %d\n", pn);
}
void input(){
#define scanf_
#ifdef scanf_
	scanf("%d", &n);
	int p;
	ll x;
	while(n--){
		scanf("%d %I64d", &p, &x);
		a[p].pb(pll(0, x));
	}
	scanf("%I64d", &T);
#else
	n = pn;
	rep(i,1000)if(mn[i]==i){
		int p=i;
		ll x=100000000;
		x = x*x;
		a[p].pb(pll(0,x));
	}
	T=100000000;
	T = T*100;
#endif
}

void solve(){
	ll rest;
	///printf("Time = %I64d\n", T);
	for(int p=M-1; p>1; p--)if(a[p].sz>0){
		//printf("p=%d, a[p].sz=%d\n", p, a[p].sz);
		sort(a[p].begin(), a[p].end());
		//rep(i, a[p].sz)printf("	%I64d, %I64d\n", a[p][i].first, a[p][i].second);
		int k=1;
		rest = 0;
		for(int i=1; i<a[p].sz; i++){
			if(a[p][i].first>a[p][k-1].second+a[p][k-1].first){
				a[p][k++]=a[p][i];
			}else{
				a[p][k-1].second += a[p][i].second;
			}
		}

		rest = a[p][k-1].second+a[p][k-1].first;
		if(rest>T)ans[p]=rest-T; else ;
		int nn=0;
		rep(i, k){
			if(a[p][i].first>=T)break;
			///a[p][i] = pll(a[p][i].first+1, a[p][i].second);
			if(a[p][i].first+a[p][i].second>=T){
				a[p][i].second = T-a[p][i].first;
			}
			a[p][i].first++;
			nn++;
		}
		if(nn>k)puts("ERR");
		rep(j, v[p].sz){
			int q=v[p][j];
			rep(i, nn){
				a[q].pb(a[p][i]);
			}
		}
	}
}

void print(){
	int res=0;
	rep(i,M)if(ans[i])res++;
	printf("%d\n", res);
	rep(i,M)if(ans[i])printf("%d %I64d\n", i, ans[i]);
}

int main(){
	///freopen("232_E2.in", "r", stdin);
	init();
	input();
	solve();
	print();
	return 0;
}

/*

Test: #9, time: 46 ms., memory: 37976 KB, exit code: 0, checker exit code: 1, verdict: WRONG_ANSWER
Input

2

3 1

29 1

2

Output

1

2 4

Answer

2

2 3

3 1

Checker Log

wrong answer 1st lines differ - expected: '2', found: '1'


*/
