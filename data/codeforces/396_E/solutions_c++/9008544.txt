#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <algorithm>
using namespace std;
int v[1000005],pr[1000005],L[1000005],i,j,A,ansx[1000005],o,m;
long long c[1000005],p[1000005],ansy[1000005],B,s[1000005];
bool FLAG;
int main()
{
    for (i=2; i<=1000000; i++)
    {
        if (!v[i]) {pr[++o]=i; L[i]=i;}
        for (j=1; j<=o && pr[j]*i<=1000000; j++)
        {
            v[pr[j]*i]=1; L[pr[j]*i]=pr[j];
            if (i%pr[j]==0) break;
        }
    }
    scanf("%d",&m);
    for (i=1; i<=m; i++)
    {
        scanf("%d%I64d",&A,&B);
        p[A]+=B;
    }
    scanf("%I64d",&B);
    for (i=1; i<=1000000; i++) c[i]=B;
    FLAG=true;
    while (FLAG)
    {
        FLAG=false;
        for (i=2; i<=1000000; i++)
          if (p[i] && c[i])
          {
              B=min(p[i],c[i]);
              p[i]-=B; c[i]-=B;
              for (j=i-1; j>1; j/=L[j]) p[L[j]]+=B;
              s[i]+=B-1;
              FLAG=true;
          } else
            if (s[i]) s[i]--; else if (c[i]) c[i]--;
    }
    o=0;
    for (i=2; i<=1000000; i++) if (p[i])
    {
        ansx[++o]=i;
        ansy[o]=p[i];
    }
    cout<<o<<endl;
    for (i=1; i<=o; i++) printf("%d %I64d\n",ansx[i],ansy[i]);
    return 0;
}
