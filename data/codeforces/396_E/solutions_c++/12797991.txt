#include<iostream>
#include<cstdio>
#define lld long long
#define LLD_IO "%I64d"
using namespace std;
const int N = 1000000 + 10, MaxN = N + 10;
int pm[MaxN], m;
lld a[MaxN], k;
void init()
{
	scanf("%d", &m);
	int pi;
	for(int i = 1; i <= m; ++i)
	{
		scanf("%d", &pi);
		scanf(LLD_IO, &a[pi]);
	}
	scanf(LLD_IO, &k);
	
	for(int i = 2; i <= N; ++i)
		for(int j = i; j <= N; j += i)
			if(!pm[j]) pm[j] = i;
}

void Push(int x,lld s){for(a[x--] -= s; x > 1; x /= pm[x]) a[pm[x]] += s;}

void solve()
{
	int tm = (int)min(20LL, k);
	for(int T = tm; T > 0; --T)
		for(int i = 2; i <= N; ++i)
			if(a[i]) Push(i, 1);
	k -= tm;
	
	int tot = 0;
	for(int i = N; i >= 2; --i)
		if(a[i])
		{
			if(a[i] <= k) Push(i, a[i]);
			else Push(i, k), ++tot;
		}
	printf("%d\n", tot);
	for(int i = 2; i <= N; ++i)
		if(a[i]) printf("%d "LLD_IO"\n", i, a[i]);
}

int main()
{
	
	init();
	
	solve();
	
	return 0;
}
