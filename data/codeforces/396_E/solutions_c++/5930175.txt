#include<cstdio>
#include<cstring>
#include<cmath>
#include<algorithm>
using namespace std;
typedef long long ll;
#define rep(i,n) for (int i=1;i<=n;++i)
const int N=1000000,M=N+5;
int n,ans,L,x,f[M],p[M]; ll c[M],k[M],K,Protect[M];
int main()
{
	for (int i=2;i<=N;++i){
		if (!f[i]) f[i]=i,p[++L]=i;
		for (int j=1;p[j]<=f[i] && p[j]*i<=N && j<=L;++j) f[p[j]*i]=p[j];
	}
	scanf("%d",&n);
	rep(i,n) scanf("%d",&x),scanf("%I64d",c+x);
	scanf("%I64d",&K);
	rep(i,L) k[p[i]]=K;
	int j,flag;
	do{
		flag=0;
		rep(i,L) if (c[j=p[i]]){
			if (!k[j]) continue;
			ll t=min(k[j],c[j]); k[j]-=t,c[j]-=t,flag=1; Protect[j]+=t-1;
			for (--j;j>1;j/=f[j]) c[f[j]]+=t;
		}else if (Protect[j]) --Protect[j]; else if (k[j]) --k[j];
	}while (flag);
	rep(i,L) ans+=c[p[i]]>0; printf("%d\n",ans);
	rep(i,L) if (c[p[i]]) printf("%d %I64d\n",p[i],c[p[i]]);
	return 0;
}
