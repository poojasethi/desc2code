#include<stdio.h>
#define ll __int64
ll g(ll l,ll r,ll k)
{
    ll d=(r-l)/(k-1),tmp;
    while(d>1)
    {
        if(1+(r/d)-((l+d-1)/d)>=k)return d;
        tmp=1+r/d;
        d-=((tmp*d-r)+tmp-1)/tmp;
    }
    return 1;
}
ll f(ll n,ll m)
{
    ll i,j,k;
    if(n==1||n==2)return (1%m);
    n-=2;
    ll a[2][2]={1,0,0,1},b[2][2]={1,1,1,0},temp[2][2];
    while(n)
    {
        if(n&1)
        {
            for(i=0;i<2;i++)
            for(j=0;j<2;j++)
            for(temp[i][j]=k=0;k<2;k++)
            temp[i][j]=(temp[i][j]+a[i][k]*b[k][j]%m)%m;
            for(i=0;i<2;i++)
            for(j=0;j<2;j++)
            a[i][j]=temp[i][j];
        }
        for(i=0;i<2;i++)
        for(j=0;j<2;j++)
        for(temp[i][j]=k=0;k<2;k++)
        temp[i][j]=(temp[i][j]+b[i][k]*b[k][j]%m)%m;
        for(i=0;i<2;i++)
        for(j=0;j<2;j++)
        b[i][j]=temp[i][j];
        n>>=1;
    }
    return (a[0][0]+a[0][1])%m;
}
int main()
{
    ll l,r,k,m;
    scanf("%I64d %I64d %I64d %I64d",&m,&l,&r,&k);
    printf("%I64d\n",f(g(l,r,k),m));
    return 0;
}
