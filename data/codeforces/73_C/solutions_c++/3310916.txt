#include <cstdio>
#include <cstring>
#include <iostream>

using namespace std;

int N,K;
int way[256][256];
int dn[128][128][32];

bool used[128][128][32];

string S;

int f( int pl , int k , int p ){
	
	if( pl>=(int)S.size() )
		return 0;
		
	if( used[pl][k][p])
		return dn[pl][k][p];
		
	int c=S[pl]-'a';
	int r=way[p][c]+f(pl+1,k,c);
	
	if(k)
		for( int i=0 ; i<'z'-'a'+1 ; i++ )
			r=max(r,way[p][i]+f(pl+1,k-1,i));
	
	used[pl][k][p]=1;
	return dn[pl][k][p]=r;
}

int main(){
	
	cin >> S >> K >> N;
	
	for( int i=0 ; i<N ; i++ ){
		
		char x,y;
		int c;
		
		cin >> x >> y >> c;
		x-='a', y-='a';
		way[(int)x][(int)y]=c;
	}
	
	cout << f(0, K, 30) << endl;
}
