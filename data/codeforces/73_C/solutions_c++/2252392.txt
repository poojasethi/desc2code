#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
int main(void) {
  char s[128],s1[32],s2[32];
  int k,n,t[128][128][32],g[32][32]={{0}},a=-1000000000;
  scanf("%s %d %d",s,&k,&n);
  int l=strlen(s);
  for(int i=0,x;i<n&&3==scanf("%s %s %d",s1,s2,&x);++i)g[*s1-'a'][*s2-'a']=x;
  memset(t,0xcc,sizeof(t));
  t[0][0][26]=0;
  for(int i=0;i<l;++i)for(int j=0;j<=k;++j)for(int u=0;u<=26;++u)for(int w=0;w<26;++w)
    t[i+1][j+(w+'a'==s[i]?0:1)][w]=max(t[i+1][j+(w+'a'==s[i]?0:1)][w],t[i][j][u]+g[u][w]);
  for(int i=0;i<=k;++i)for(int j=0;j<26;++j)a=max(a,t[l][i][j]);
  printf("%d\n",a);
  return 0;
}
