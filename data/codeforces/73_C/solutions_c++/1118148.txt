#include <iostream>
#include <cstring>
using namespace std;

int mem[110][110][27];
string ori;
int cost[27][27];
int dp(int n, int k, int p) {
	if (k < 0) {
		return -(1 << 30);
	}
	if (n == ori.size()) {
		return 0;
	}
	int &res = mem[n][k][p];
	if (res > -999999) {
		return res;
	}
	res = -(1 << 30);
	for (int i = 0; i < 26; ++i) {
		res = max(res, dp(n + 1, k - (i + 'a' != ori[n]), i) + cost[p][i]);
	}
	return res;
}
int main() {
	memset(mem, -128, sizeof(mem));
	
	int k, m;
	cin >> ori >> k >> m;
	for (int i = 0; i < m; ++i) {
		char a, b;
		int v;
		cin >> a >> b >> v;
		cost[a - 'a'][b - 'a'] += v;
	}
	cout << dp(0, k, 26);
}
