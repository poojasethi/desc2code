#include <bits/stdc++.h>
using namespace std;
string s;
int k , n , l;
int grid[30][30] , mem[700][105][30];
int solve(int ind,int rem,int prev){
    if(ind==l){
        return 0;
    }
    int &ret = mem[ind][rem][prev];
    if(ret!=-1) return ret;
    int cur = s[ind]-'a';
    ret = solve(ind+1,rem,cur) + grid[prev][cur];
    if(rem==0)  return ret;
    for(int i=0;i<26;i++)
        ret = max(ret,grid[prev][i] + solve(ind+1,rem-1,i));

    return ret;
}

int main(){
    memset(grid,0,sizeof grid);
    cin >> s ;  l = s.length();
    cin >> k ;
    cin >> n ;
    for(int i=0;i<n;i++){
        int x;  char c1,c2;
        getchar();
        scanf("%c %c%d",&c1,&c2,&x);
        grid[c1-'a'][c2-'a'] = x;
    }
    memset(mem,-1,sizeof mem);
    cout << solve(0,k,28) << endl;
    return 0;
}

                                                                                                                                          