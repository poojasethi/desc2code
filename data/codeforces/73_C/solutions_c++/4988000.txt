#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
char s[123];
int K,N;
int pu[300][300],u;
char x,y;
int dp[120][300][125];
int f(int k,char x,int h)
{
	if(k == u)	return 0;
	if(dp[k][(int)x][h] != -1)	return dp[k][(int)x][h]; 
	int mx=f(k+1,s[k],h)+pu[(int)x][(int)s[k]];
	for(int i='a';h && i<='z';i++)
		mx=max(mx,f(k+1,i,h-1)+pu[(int)x][(int)i]);
	return dp[k][(int)x][h]=mx;
}

int main()
{
	memset(dp,-1,sizeof(dp));
	scanf(" %s %d",s,&K);
	u=strlen(s);
	scanf("%d",&N);
	for (int i = 0; i < N; i++)
	{
		int t;
		scanf(" %c %c %d",&x,&y,&t);
		pu[(int)x][(int)y]=t;
	}
	printf("%d\n",f(0,14,K));
	return 0;
}
