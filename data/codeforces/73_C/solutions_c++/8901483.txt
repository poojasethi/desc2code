#include<bits/stdc++.h>
using namespace std;
#define MAX 10005555
int costo[124][124];
int memo[105][126][105];

string s;


int solve(int idx,char ant,int cambios){
    if(cambios < 0) return -MAX;
    if(idx==s.size())return 0;
    if(memo[idx][ant][cambios]!=-MAX)return memo[idx][ant][cambios];
    int sol = -MAX;
    for(int i = 'a';i<='z';i++){
        if(i!=s[idx])
            sol = max(sol,solve(idx+1,i,cambios-1)+costo[ant][i]);
        else
            sol = max(sol,solve(idx+1,i,cambios)+costo[ant][i]);
    }
    return memo[idx][ant][cambios]=sol;

}

int main(){
    int n,m,t;cin>>s>>n>>m;
    char a,b;

    memset(costo,0,sizeof costo);
    for(int i=0;i<105;i++)for(int j=0;j<126;j++)for(int k=0;k<105;k++)memo[i][j][k] = -MAX;

    for(int i=0;i<m;i++){cin>>a>>b>>t;costo[a][b]=t;}
    cout<<solve(0,'#',n)<<endl;
}
