#include <stdio.h>
#include <iostream>
#include <string>
#include <string.h>
#include <algorithm>
using namespace std;

int bonus[30][30];
string word;

int memo[110][30][110];

int solve(int index, int lastLetter, int k) {
	if ( index == word.size() ) return 0;
	if ( memo[index][lastLetter][k] != -1 ) return memo[index][lastLetter][k];
	
	int ret = 0;

	ret = bonus[lastLetter][word[index]-'a'] + solve(index+1,word[index]-'a',k);
	if ( k ) {
		for ( int i = 0; i < 26; i++ ) {
			ret = max(ret, bonus[lastLetter][i] + solve(index+1, i, k-1));
		}
	}
	return memo[index][lastLetter][k] = ret;
}

int main() {
	memset(memo,-1,sizeof(memo));
	int k, n;
	cin >> word >> k;
	string s1, s2;
	int c;
	scanf("%d\n", &n);
	while ( n-- ) {
		cin >> s1 >> s2 >> c;
		bonus[s1[0]-'a'][s2[0]-'a'] = c;
	}

	printf("%d\n", solve(0,27,k));
}
