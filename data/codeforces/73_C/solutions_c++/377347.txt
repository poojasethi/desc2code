#include<stdio.h>
#include<cstring>
#include<iostream>
#include<vector>
#include<queue>
#include<string>
#include<ctype.h>
#include<math.h>

using namespace std;

int M[300][300],k,m,DP[333][333][333];
char A[10000],C[5];
bool I[333][333][333];
int Val(int i , int t , int c)
{

    if( i == -1 && c == 0) return 0;
    if(i == -1) return 0;
    if(I[i][t][c]) return DP[i][t][c];
    I[i][t][c] = true;
    int v = Val(i-1,A[i],c) + M[A[i]][t] ;
    if(c)
    for(int j = 'a'; j <='z';j++)
    {
        if(Val(i-1,j,c-1) + M[j][t] > v) v = Val(i-1,j,c-1) + M[j][t] ;
    }
    return DP[i][t][c] = v;
}
int main()
{
    scanf("%s%d",A,&k);
    scanf("%d",&m);
    while(m--){
        int x;
        scanf("%s%s%d",C,C+2,&x);
        M[C[0]][C[2]] = x;
        }
    int r = Val(strlen(A)-1,'*',k);

    printf("%d\n",r);

  return 0;
}
