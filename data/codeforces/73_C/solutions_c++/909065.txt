//In the name of Allah
//
//
#include <iostream>
#include <string>
#include <cstring>
using namespace std;
const int INF=(1u<<31)-1;
string s;
int d[100+10][100+10][26+10];
using namespace std;
int k,n;
int map[30][30];
int fll(int a,int b,int c)
{
	if (a==(int)s.size())
		return 0;
	if (b<0)
		return -INF;
	if (d[a][b][c]!=-1)
		return d[a][b][c];
	d[a][b][c]=-INF;
	for (char i='a';i<='z';i++)
	{
		int t=-INF;
		if (i==s[a])
			t=fll(a+1,b,i-'a')+map[c][i-'a'];
		else if (b>0)
			t=fll(a+1,b-1,i-'a')+map[c][i-'a'];
		d[a][b][c]=max(d[a][b][c],t);
	}
	return d[a][b][c];
}
int main()
{
	ios_base::sync_with_stdio(false);
	cin>>s>>k;
	cin>>n;
	memset(d,-1,sizeof(d));
	for (int i=0;i<n;i++)
	{
		char a,b;
		int c;
		cin>>a>>b>>c;
		map[a-'a'][b-'a']=c;
	}
	int res=-INF;
	for (char i='a';i<='z';i++) 
	{
		int t=-INF;
		if (i==s[0])
			t=fll(1,k,i-'a');
		else if (k>0)
			t=fll(1,k-1,i-'a');
		res=max(res,t);
	}
	cout<<res<<endl;
	return 0;
}
