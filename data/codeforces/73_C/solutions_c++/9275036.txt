#include <bits/stdc++.h>
#define INF 1000000000
using namespace std;

int n,k;
string s;
int a[32][32];
bool vis[102][102][27];
int dp[102][102][27];

int f(int idx, int cnt, int prev)
{
    if ( idx == n ) return 0;
    if ( vis[idx][cnt][prev] ) return dp[idx][cnt][prev];
    vis[idx][cnt][prev] = true;
    int ans = -INF;
    for ( int i = 1; i <= 26; i++ ) {
        if ( i == s[idx]-96 ) {
            ans = max(ans, a[prev][i] + f(idx+1, cnt, i));
        }
        else {
            if ( cnt+1 <= k ) ans = max(ans, a[prev][i] + f(idx+1, cnt+1, i));
        }
    }
    dp[idx][cnt][prev] = ans;
    return ans;
}
int main()
{
    int m,x;
    char p1,p2;
    cin >> s >> k;

    n = (int)s.size();

    cin >> m;

    while ( m-- ) {
        cin >> p1 >> p2 >> x;
        a[p1-96][p2-96] = x;
    }

    int ans = f(0,0,0);

    cout << ans << endl;
    return 0;
}
