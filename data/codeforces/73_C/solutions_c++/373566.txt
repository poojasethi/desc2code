#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cmath>
#include <cstring>
using namespace std;
#define p(x) cout<<#x<<":"<<x<<"\n"
#define lim 101
#define lim2 27

int n,c,m,i;
char a,b;
char str[lim];
int M[lim][lim][lim2],A[lim2][lim2];

int solve(int i,int j,int k)
{
  int &res=M[i][j][k],p;
  
  if(res==-1)
  {
    if(i==n)
      res=0;
    else
    {
      res=-100001;
      for(p=0;p<26;p++)
        if(j+(p!=str[i]-'a')<=c)
          res=max(res,solve(i+1,j+(p!=str[i]-'a'),p)+A[k][p]);
    }
    //printf("%d %d %d %d\n",i,j,k,res);
  }
  return res;
} 
int main()
{
  scanf("%s%d%d",str,&c,&m);
  n=strlen(str);
  for(i=0;i<m;i++)
  {
    cin>>a>>b;
    scanf("%d",&A[a-'a'][b-'a']);
  }
  memset(M,-1,sizeof M);
  printf("%d",solve(0,0,26));
  return 0;
}
