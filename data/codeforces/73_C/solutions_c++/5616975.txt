#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define MP make_pair
#define PB push_back
#define REP(i,n) for(int i=0;i<n;i++)

int dp[109][30][109];
bool vis[109][30][109];

int cost[30][30];
char s[1000];
int K,I,len;

int rec(int pos,int prev,int change)
{
    if(pos==len)return 0;
    if(vis[pos][prev][change])return dp[pos][prev][change];
    int cn=s[pos]-'a'+1;
    int ret=cost[prev][cn]+rec(pos+1,cn,change);
    for(int i=1;i<=26 && change<K;i++)ret=max(ret,cost[prev][i]+rec(pos+1,i,change+(cn!=i)));
    vis[pos][prev][change]=true;
    return dp[pos][prev][change]=ret;
}

int main()
{
    scanf("%s %d",s,&K);
    len=strlen(s);
    scanf("%d",&I);
    char a,b;
    int c;
    REP(o,I)
    {
        cin >> a >> b >> c;
        cost[a-'a'+1][b-'a'+1]=c;
    }
    cout << rec(0,0,0) << endl;
    return 0;
}
/*
winner 0
1
w i 10
*/

	 	  	   	 	   	    	