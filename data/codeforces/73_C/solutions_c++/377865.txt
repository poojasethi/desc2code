#include <stdio.h>
#include <string.h>
#include <algorithm>
#define maxn 110
#define INF 1000000000

using namespace std;

int f[maxn][30][maxn];
int w[30][30];
char s[maxn];
int n,m;
int main(){
	int i,j,k;
	scanf("%s",s);
	n=strlen(s);
	scanf("%d",&m);
	memset(w,0,sizeof(w));
	for (scanf("%d",&k);k>0;k--){
		int v;
		char a[10],b[10];
		scanf("%s %s %d",a,b,&v);
		w[a[0]-'a'][b[0]-'a']=v;
	}
	for (i=0;i<n;i++)
		for (j=0;j<26;j++)
			for (k=0;k<=m;k++) f[i][j][k]=-INF;
	if (m>=1)
		for (i=0;i<26;i++)
			if (i!=s[i]-'a') f[0][i][1]=0;
	f[0][s[0]-'a'][0]=0;
	for (i=1;i<n;i++)
		for (j=0;j<26;j++)
			for (k=0;k<=m;k++)
				if (f[i-1][j][k]>-INF){
					for (int c=0;c<26;c++)
						if (c==s[i]-'a'){
							f[i][c][k]=max(f[i][c][k],f[i-1][j][k]+w[j][c]);
						}else{
							f[i][c][k+1]=max(f[i][c][k+1],f[i-1][j][k]+w[j][c]);
						}
				}
	int ans=-INF;
	for (i=0;i<26;i++)
		for (k=0;k<=m;k++) ans=max(ans,f[n-1][i][k]);
	printf("%d\n",ans);
	return 0;
}
