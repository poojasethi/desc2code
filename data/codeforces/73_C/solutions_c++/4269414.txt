#include <iostream>
#include <cstdio>
#define FOR(i,p,k) for(int i = (p);i<(k);i++)
using namespace std;
int NONE = -1000000000;//-10^9
int war[30][30];
int dp[105][105][30];
string tab;
int ile,n;
void dane()
{
	cin>>tab>>ile;
	cin>>n;
	FOR(i,0,n)
	{
		char a,b;
		int w;
		cin>>a>>b>>w;
		war[a-'a'][b-'a']=w;
	}
}
void licz()
{
	FOR(i,0,tab.size())
		FOR(j,0,i+1)
			FOR(k,0,26)
				dp[i+1][j][k]=NONE;
	dp[1][0][tab[0]-'a']=0;
	FOR(i,0,26)
		if(tab[0]-'a'!=i)
			dp[1][1][i]=0;	
	FOR(i,1,tab.size())
	{
		FOR(j,0,min(ile+1,i+2))
			FOR(k,0,26){
				int wz=NONE;
				FOR(z,0,26)
					if(tab[i]-'a'==k && j<=i)
					wz=max(wz,dp[i][j][z]+war[z][k]);
					else if(j!=0)
					wz=max(wz,dp[i][j-1][z]+war[z][k]);
				dp[i+1][j][k]=wz;
			}
	}

	int MX = NONE;
	FOR(i,0,ile+1)
		FOR(j,0,26)
			MX=max(MX,dp[tab.size()][i][j]);
	cout<<MX<<"\n";
}

int main()
{
	dane();
	licz();
	return 0;
}

