#include<cstdio>
#include<cstring>
int f[103][103][26],k,n,tr[26][26];
//                                     Last Change:  2011-04-10 16:54:24
char s[103];
char input()
{
	char ch=getchar();
	while(ch<'a'||ch>'z')ch=getchar();
	return ch;
}
int main()
{
	scanf("%s%d",s+1,&k);
	for(scanf("%d",&n);n--;)
	{
		char p=input(),q=input();
		int v;
		scanf("%d",&v);
		tr[p-'a'][q-'a']=v;
	}
	int len=strlen(s+1);
	for(int i=0;i<=len;++i)
		for(int j=0;j<=k;++j)
			for(int k=0;k<26;++k)
				f[i][j][k]=-1000000000;
	f[0][0][0]=0;
	for(int i=0;i<len;++i)
		for(int j=0;j<=i&&j<=k;++j)
			for(int k=0;k<26;++k)
			{
				for(int l=0;l<26;++l)
				{
					int &p=f[i][j][k];
					int &q=f[i+1][j+(s[i+1]-'a'!=l)][l];
					int vv=i?tr[k][l]:0;
					if(p+vv>q)
						q=p+vv;
				}
			}
	int ans=-100000000;
	for(int i=0;i<=k;++i)
		for(int j=0;j<26;++j)
			if(f[len][i][j]>ans)
				ans=f[len][i][j];
	printf("%d\n",ans);
	return 0;
}
