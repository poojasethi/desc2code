#include <cstdio>
#include <algorithm>
#include <cstring>
#include <iostream>

#define inf 1000000000
using namespace std;


char s[125],ch1,ch2;
int M,mat[30][30],K,x,uz,ar[105];
int dn[105][105][30];
bool mrk[105][105][30];
int f(int a,int left,int once)
{
	if(mrk[a][left][once])
		return dn[a][left][once];
	//~ printf("%d %d %d\n",a,left,once);
	if(a==uz+1)
		return 0;
	int ret;
	ret=f(a+1,left,ar[a])+mat[once][ar[a]];
	if(left)
		for (int i = 1; i <=26; i++)
		{
			ret=max(ret,f(a+1,left-1,i)+mat[once][i]);
		}
	
	mrk[a][left][once]=1;
	return dn[a][left][once]=ret;
	
}
int main ()
{
	//~ freopen("oku.txt","r",stdin);
	scanf(" %s %d",s,&K);
	uz=strlen(s);
	for (int i = 0; i < uz; i++)
	{
		ar[i+1]=s[i]-'a'+1;
	}
	
	scanf("%d",&M);
	for (int i = 0; i < M; i++)
	{
		scanf(" %c %c %d",&ch1,&ch2,&x);
		ch1-='a';
		ch2-='a';
		ch1++;
		ch2++;
		
		mat[(int)ch1][(int)ch2]=x;
	}
	cout << f(1,K,0) << endl;
	
	



}
