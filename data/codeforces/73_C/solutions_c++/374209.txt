#include<cstdio>
#include<algorithm>
#include<cmath>
#include<iostream>
#include<vector>
#include<string.h>
#define pb push_back;
using namespace std;

string s;
int k,n;

int C[27][27];

int memo[121][121][27];

int solve(int ind, int score, int prev)
{
	//cout<<ind<<endl;
	if(memo[ind][score][prev] != -1)
	return memo[ind][score][prev];
	
	if(ind==s.length())return 0;
	int ans=C[prev][s[ind]-'a'] + solve(ind+1,score,s[ind]-'a') ;
	if(score > 0)
	{
		for(int i=0;i<26;i++)
		{
			if(i != (s[ind]-'a') && score>0)
			ans=max(ans,C[prev][i] + solve(ind+1,score-1,i));
		}
	}
	
	return memo[ind][score][prev]=ans;
}

int main()
{
	memset(memo,-1,sizeof(memo));
	cin>>s>>k>>n;
	for(int i=0;i<n;i++)
	{
		char c1,c2;
		int c;
		cin>>c1>>c2>>c;
		C[c1-'a'][c2-'a']=c;
	}
	cout<<solve(0,k,26)<<endl;
	return 0;
}
