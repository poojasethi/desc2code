#include<iostream>
#include<vector>
#include<algorithm>
#include<strings.h>
#include<stack>
#define x first
#define y second
using namespace std;
typedef pair<int,int> point;
int adj['z'+1]['z'+1],n,k,mem[678][101]['z'+1];
string str;
int dp(int idx,int t,int c)
{
    if(idx==str.size())  return 0;
    int &ret=mem[idx][t][c];
    if(ret!=-1) return ret;
    ret=adj[c][str[idx]]+dp(idx+1,t,str[idx]);
    if(t) for(int i='a';i<='z';i++)
    {
        ret=max(ret,adj[c][i]+dp(idx+1,t-1,i));
    }
    return ret;
}
int main()
{
    memset(mem,-1,sizeof mem);
    cin>>str>>k>>n;
    for(int i=0;i<n;i++)
    {
        char a,b;int c;
        cin>>a>>b>>c;
        adj[a][b]=c;
    }
    cout<<dp(0,k,1)<<endl;
    return 0;
}

                                                                                                                                                                                              