#include <iostream>
#include <cstdio>
#include <string>

using namespace std;

string s;
int k;

int C['z' + 1 ]['z' + 1];

int  tab['z' + 1 ][100][101];
bool was['z' + 1 ][100][101];

int solve(char x, int p, int k) {
    if (p==s.length())
        return 0;
    if (was[x][p][k])
        return (tab[x][p][k]);
    int res=solve(s[p], p+1, k) + C[x][s[p]];
    if (k>0)
        for (char y='a'; y<='z';y++)
            if (y!= s[p])
                res=max(res,solve(y,p+1,k-1)+C[x][y]);
    tab[x][p][k]=res;
    was[x][p][k]=true;

    return res;
}

int main() {

    cin >> s >> k;
    int n;
    cin >> n;
    for (int i = 0; i < n; i++) {
        char x, y;
        cin >> x >> y;
        cin >> C[x][y];
    }
    int res = solve(s[0], 1, k);

    if (k>0)
        for (char ch='a';ch<='z';ch++)
            if (ch!=s[0])
                res=max(res,solve(ch,1,k-1));
    cout<<res;
    return 0;
}
