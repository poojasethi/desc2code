#include <iostream>
#include <cstdio>
#include <cstring>
using namespace std;

char S[105],a1,a2;
int C[30][30],K,N,E,a3,dp[105][105][30];
bool visit[105][105][30];

int cal(int x,int left,int pre){
	if(visit[x][left][pre]) return dp[x][left][pre];
	visit[x][left][pre] = 1;
	if(x == N) dp[x][left][pre] = 0;
	else{
		dp[x][left][pre] = C[pre][S[x]-'a'] + cal(x+1,left,S[x]-'a');
		if(left > 0){
			for(int i=0;i<26;++i)
					dp[x][left][pre] = max(dp[x][left][pre],C[pre][i] + cal(x+1,left-1,i));
		}
	}
	return dp[x][left][pre];
}

int main(){
	scanf("%s %d%d",S,&K,&E);
	N = strlen(S);
	for(int i=0;i<E;++i){
		scanf(" %c %c %d",&a1,&a2,&a3);
		C[a1-'a'][a2-'a'] = a3;
	}
	printf("%d\n",cal(0,K,27));
}
