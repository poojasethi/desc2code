#include <cstdio>
#include <algorithm>
#include <string>
#include <iostream>
#include <climits>
#include <map>
#include <utility>
#include <cstring>
#define sc second
#define fr first
#define pcc pair <char,char>
using namespace std;
int hak,k,n,fyt[150][150],dyn[155][105][105];
bool mrk[155][105][105];
string s;
char c1,c2;
int dene(char a,int x,int kln)
{
	if (mrk[(int)a][x][kln]) return dyn[(int)a][x][kln];
	if (x>(int)s.size())
		return 0;
	int enb=dene(s[x-1],x+1,kln)+fyt[(int)a][(int)s[x-1]];
	if (kln>0)
		for (char i='a';i<='z';i++)
			enb=max(enb,dene(i,x+1,kln-1)+ fyt[(int)a][(int)i]);
	mrk[(int)a][x][kln]=1;
	return dyn[(int)a][x][kln]=enb;
}
int main()
{
	cin >> s;
	scanf("%d %d",&hak,&n);
	for (int i=1;i<=n;i++)
	{
		scanf(" %c %c %d",&c1,&c2,&k);
		fyt[(int)c1][(int)c2]=k;
	}
	printf("%d",dene(0,1,hak));
}
