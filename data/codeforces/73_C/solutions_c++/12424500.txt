#include<bits/stdc++.h>
using namespace std;
int arr[100][100];
int r[107][107][29],n,m;
string str;
int dp(int idx,int k,int last)
{
    if(k<0)
        return -(1<<22);
    if(idx==n)
        return 0;
    if(r[idx][k][last]!=-1)
        return r[idx][k][last];
    int &ret=r[idx][k][last];
    ret=-(1<<22);
    for(int i=0;i<26;i++)
        ret=max(ret,((idx)?(arr[last][i]):(0))+dp(idx+1,(i!=str[idx]-'a')?k-1:k,i));
    return ret;
}
int main()
{
    memset(r,-1,sizeof r);
    int k;
    cin>>str>>k>>m;
    n=str.size();
    for(int i=0;i<m;i++)
    {
        char a,b;
        int x;
        cin>>a>>b>>x;
        arr[a-'a'][b-'a']=x;
    }
    cout<<dp(0,k,0);
}

                                                                                                                   