#include <cstdio>
#include <cstring>
#include <algorithm>
#define INF (1<<28)
using namespace std;

int n,m,x,dp[105][105][30],ret,pr;
char s[105],s1[5],s2[5];
int v[300][300];

void upd(int &x, int y){
	x = max(x,y);
}

int main(){

	scanf("%s%d", s, &m);
	n = strlen(s);
	scanf("%d", &pr);
	while (pr--){
		scanf("%s%s%d", s1, s2, &x);
		v[s1[0]][s2[0]] = x;
	}

	memset(dp, 128, sizeof(dp));

	for (int i=0; i<=m; i++){
		for (char c='a'; c<='z'; c++){
			if (c==s[0] || i==1) dp[0][i][c-'a']=0;
		}
	}

	for (int i=1; i<n; i++){
		for (char pc='a'; pc<='z'; pc++){
			for (int j=0; j<=m; j++){
				for (char c='a'; c<='z'; c++) upd(dp[i][j+(c!=s[i])][c-'a'], dp[i-1][j][pc-'a'] + v[pc][c]);
			}
		}
	}

	ret = -INF;
	for (int j=0; j<=m; j++){
			for (char c='a'; c<='z'; c++) upd(ret, dp[n-1][j][c-'a']);
	}
	
	printf("%d\n",ret);
	return 0;
}
