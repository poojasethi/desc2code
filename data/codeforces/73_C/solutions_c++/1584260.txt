#include<cstdio>
#include<cstring>
#include<iostream>
using namespace std;
char s[102];
int k,l;
int dp[102][102][26];//dp[i][j][k] ��ʾ����i���ַ��Ĺ�j�Σ���ǰ�ַ�Ϊk
int b[26][26];//��¼bonusֵ
bool v[102][102][26];//���
int dfs(int cur,int p,int pre)
{
	int i;
	if(cur>=l) return 0;
	if(v[cur][p][pre]) return dp[cur][p][pre];
	int t=s[cur]-'a';
	int r=b[pre][t]+dfs(cur+1,p,t);
	if(p)
	{
		for(i=0;i<26;i++)
			if(r<b[pre][i]+dfs(cur+1,p-1,i)) r=b[pre][i]+dfs(cur+1,p-1,i);
	}
	v[cur][p][pre]=true;
	dp[cur][p][pre]=r;
	return r;
}
int main()
{
	int n,c;
	char x,y;
	while(~scanf("%s%d",s,&k))
	{
		l=strlen(s);
		memset(b,0,sizeof(b));
		memset(v,false,sizeof(v));
		scanf("%d",&n);
		while(n--)
		{
			getchar();
			scanf("%c %c%d",&x,&y,&c);
			b[x-'a'][y-'a']=c;
		}
		printf("%d\n",dfs(0,k,27));
	}
	return 0;
}

