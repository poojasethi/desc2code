#include <bits/stdc++.h>

using namespace std;

typedef long long ll;
typedef pair < int, int > pii;

const ll linf = 1e18 + 9;
const int inf = 1e9 + 9;
const int N = 2e2 + 9;

ll dp[N][N][N];

int n, k, hash[N][N], w, m;

char c, c2, str[N];

ll f(int i, int k, char t) {
	ll &r = dp[i][k][t];
	if (r != -inf) return r;
	if (k < 0) return r = -inf;
	if (i == n) return r = 0;
	r = f(i+1, k, str[i+1]) + hash[t][str[i+1]];
	for (int j = 0; j < 26; j++)
		r = max(r, f(i+1, k-1, j+'a') + hash[t][j+'a']);
	return r;
}

int main() {

	scanf("%s", str+1);

	n = strlen(str + 1);

	cin >> k >> m;

	for (int i = 1; i <= m; i++) {
		cin >> c >> c2 >> w;
		hash[c][c2] = w;
	}

	for (int i = 0; i < N; i++)
		for (int j = 0; j < N; j++)
			for (int t = 0; t < N; t++)
				dp[i][j][t] = -inf;

	cout << f(0, k, 0) << endl;

	return 0;
}
