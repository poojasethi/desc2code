#include<bits/stdc++.h>

using namespace std;

#define N 202

int H[N][N],M[N][N][N],k,i,w,t;

char a,b;

string str;

int f(int i, int k, char c){

    if(k < 0)
        return -1000000009;

    if(i == str.size())
        return 0;

    int j,&r = M[i][k][c];

    if(r != -1)
        return r;
    r=-924923249;

    for(j='a';j<='z';j++)
        r = max( r , f(i+1,k-(j!=str[i]),j)+H[c][j] );

    return r;
}
int main(){

    cin >> str >> k >> w;

    while(w--){
        cin >> a >> b >> t;
        H[a][b] = t;
    }

    memset(M , -1 , sizeof M);
    cout << f(0,k,0);
    return 0;
}
