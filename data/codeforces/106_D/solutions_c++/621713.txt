#include <iostream>
#include <string>
#include <map>
#include <sstream>
#include <algorithm>
#include <vector>
#include <set>
#include <queue>
#include <cmath>

using namespace std;

typedef long long LL;

int L[4][1001][1001];
char A[1001][1001];
int B[100001][2];
int D[256];
int dx[4]={-1,1,0,0};
int dy[4]={0,0,-1,1};
int N,M,K;

int main(){

  cin>>N>>M;
  for(int i=0;i<N;i++){
    for(int j=0;j<M;j++){
      cin>>A[i][j];
    }
  }
  cin>>K;
  D['W']=0; D['E']=1;
  D['N']=2; D['S']=3;
  for(int i=0;i<K;i++){
    char d;
    cin>>d>>B[i][1];
    B[i][0]=D[d];
  }

  for(int i=0;i<N;i++){
    int l=0;
    for(int j=0;j<M;j++){
      if(A[i][j]=='#') l=0;
      L[0][i][j]=l;
      if(A[i][j]!='#') l+=1;
    }

    l=0;
    for(int j=M-1;j>=0;j--){
      if(A[i][j]=='#') l=0;
      L[1][i][j]=l;
      if(A[i][j]!='#') l+=1;
    }
  }

  for(int j=0;j<M;j++){
    int l=0;
    for(int i=0;i<N;i++){
      if(A[i][j]=='#') l=0;
      L[2][i][j]=l;
      if(A[i][j]!='#') l+=1;
    }

    l=0;
    for(int i=N-1;i>=0;i--){
      if(A[i][j]=='#') l=0;
      L[3][i][j]=l;
      if(A[i][j]!='#') l+=1;
    }
  }

  string res;

  for(int i=0;i<N;i++){
    for(int j=0;j<M;j++){

      if( !(A[i][j]>='A' && A[i][j]<='Z') ) continue;

      int ok=1;
      int y=i;
      int x=j;

      for(int k=0;k<K;k++){
        if( L[B[k][0]][y][x]<B[k][1] ) {ok=0;break;}
        y+=dy[B[k][0]]*B[k][1];
        x+=dx[B[k][0]]*B[k][1];
      }

      if(ok) res+=A[i][j];
    }
  }

  sort(res.begin(),res.end());

  if(res.size()) cout<<res<<endl;
  else cout<<"no solution"<<endl;

  return 0;
}

