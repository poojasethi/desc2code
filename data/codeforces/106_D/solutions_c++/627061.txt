#include<cstdio>
#include<cstring>
#include<cmath>

int main()
{
    int n,m;
    scanf("%d%d",&n,&m);

    int ar[n][m][4],north[m],east[m],west,south[m][n],ind_e=0,ind_s[m];
    char s1[n][m+1],str[30],ch;
    int in[30][2],indx=0;

    for(int i=0;i<m;ind_s[i]=0,i++);

    for(int i=0;i<n;i++)
	scanf("%*c%s",s1[i]);

    for(int i=0;i<n;i++)
	for(int j=0;j<m;j++)
	{
	    ch=s1[i][j];

	    if(ch!='#' && ch!='.')
	    {
		in[indx][0]=i;
		in[indx][1]=j;
		str[indx++]=ch;
	    }

	    if(ch=='#')
	    {
		ar[i][j][0]=ar[i][j][1]=ar[i][j][2]=ar[i][j][3]=0;
		west=j;

		for(int k=0;k<ind_e;k++)
		    ar[i][east[k]][0]=j-east[k];
		ind_e=0;

		for(int k=0;k<ind_s[j];k++)
		{
		    int z=south[j][k];
		    ar[z][j][3]=i-z;
		}
		ind_s[j]=0;
	    }
	    else
	    {
		ar[i][j][1]=j-west;
		east[ind_e++]=j;
		south[j][ind_s[j]++]=i;
	    }
	}

    for(int i=0;i<n;i++)
	for(int j=0;j<m;j++)
	{
	    ch=s1[i][j];
	    if(ch=='#')
		north[j]=i;
	    else
		ar[i][j][2]=i-north[j];
	}

    int t;
    scanf("%d",&t);
    char s[t],ans[27];
    int x[t],ind=0;
    for(int i=0;i<t;i++)
	scanf("%*c%c%d",&s[i],&x[i]);

    for(int i=0;i<indx;i++)
    {
	int k,a=in[i][0],b=in[i][1];
	for(k=0;k<t;k++)
	{
	    if(s[k]=='E')
		if(ar[a][b][0]>x[k])
		    b=b+x[k];
		else
		    break;

	    else if(s[k]=='W')
		if(ar[a][b][1]>x[k])
		    b=b-x[k];
		else
		    break;

	    else if(s[k]=='N')
		if(ar[a][b][2]>x[k])
		    a=a-x[k];
		else
		    break;

	    else if(s[k]=='S')
		if(ar[a][b][3]>x[k])
		    a=a+x[k];
		else
		    break;
	}
	if(k==t)
	    ans[ind++]=str[i];
    }


    for(int i=0;i<ind;i++)
    {
	int min=91;
	for(int j=0;j<ind;j++)
	{
	    if(ans[j]=='a')
		continue;
	    if(ans[j]<min)
	    {
		min=ans[j];
		t=j;
	    }
	}
	printf("%c",min);
	ans[t]='a';
    }

    if(ind == 0)
	printf("no solution");
    printf("\n");

    return 0;
}
