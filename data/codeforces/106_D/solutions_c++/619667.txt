#include<cstdio>

int n,m,k;
int map[1000][1000][4];	//N,S,W,E
int pos[26][2];
bool letter[26];
int ins[100000][2];
bool ok;

int main(){
 int i,j,l;
 char c;
 scanf("%d%d\n",&n,&m);
 for(i=0;i<n;i++){
  for(j=0;j<m;j++){
   scanf("%c",&c);
   if(c == '#'){
    for(l=0;l<4;l++) map[i][j][l] = -1;
    continue;
   }
   for(l=0;l<4;l++) map[i][j][l] = 0;
   if(c == '.') continue;
   pos[c-'A'][0] = i; pos[c-'A'][1] = j;
   letter[c-'A'] = true;
  }
  scanf("\n");
 }
//printf("%d %d %d",map[5][9][0],map[4][8][0],map[4][6][0]);

 scanf("%d\n",&k);
 for(i=0;i<k;i++){
  scanf("%c %d\n",&c,&ins[i][1]);
//fprintf(stderr,"%c %d\n",c,ins[i][1]);
  if(c=='N') ins[i][0] = 0;
  if(c=='S') ins[i][0] = 1;
  if(c=='W') ins[i][0] = 2;
  if(c=='E') ins[i][0] = 3;
 }

 for(i=1;i<n-1;i++){
  for(j=1;j<m-1;j++){
   if(map[i][j][0] == -1) continue;
   map[i][j][0] = map[i-1][j][0] + 1;
   map[i][j][2] = map[i][j-1][2] + 1;
  }
 }

 for(i=n-2;i>0;i--){
  for(j=m-2;j>0;j--){
   if(map[i][j][0] == -1) continue;
   map[i][j][1] = map[i+1][j][1] + 1;
   map[i][j][3] = map[i][j+1][3] + 1;
  }
 }

 int x,y;
 for(i=0;i<26;i++){
  if(!letter[i]) continue;
//fprintf(stderr,"%c\n",i+'A');
  x = pos[i][0]; y = pos[i][1];
  for(j=0;j<k;j++){
//printf("%d %d %d %d %d\n",x,y,map[x][y][ins[j][0]],ins[j][0],ins[j][1]);
   if(map[x][y][ins[j][0]] < ins[j][1]) break;
   if(ins[j][0] == 0) x -= ins[j][1];
   if(ins[j][0] == 1) x+=ins[j][1];
   if(ins[j][0] == 2) y-=ins[j][1];
   if(ins[j][0] == 3) y+=ins[j][1];
  }
  if(j==k){ printf("%c",i+'A'); ok = true; }
 }
 if(ok) printf("\n");
 else printf("no solution\n");

 return 0;
}
