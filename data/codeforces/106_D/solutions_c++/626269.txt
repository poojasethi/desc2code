#include<iostream>
#include<string>
#include<stdio.h>
#include<cstring>
#include<algorithm>

using namespace std;
 string res,s[1000];
int n,m,k;
int W[1001][1001],E[1001][1001],S[1001][1001],N[1001][1001];

int dl[100000];
char nap[100000];
char u(int i,int j)
{
 for (int i1=0;i1<k;i1++)
 {
  if (nap[i1]=='N') {if (N[i][j]>=dl[i1]) i-=dl[i1]; else  return 0;}
  if (nap[i1]=='S') {if (S[i][j]>=dl[i1]) i+=dl[i1]; else  return 0;}
  if (nap[i1]=='W') {if (W[i][j]>=dl[i1]) j-=dl[i1]; else  return 0;}
  if (nap[i1]=='E') {if (E[i][j]>=dl[i1]) j+=dl[i1]; else  return 0;}
 }

return 1;
}
int main()
{
//  freopen("input.txt","r",stdin);
 memset(W,0,sizeof(W));memset(E,0,sizeof(E)); memset(N,0,sizeof(N));memset(S,0,sizeof(S));
 cin>>n>>m;
 cin>>s[0];
  int kol;
 for (int i=1;i<n-1;i++)
  {
   cin >> s[i];
   kol=0; for (int j=1;j<m-1;j++) if (s[i][j]!='#') W[i][j]=kol++; else kol=0;
   kol=0; for (int j=m-1;j>0;j--) if (s[i][j]!='#') E[i][j]=kol++; else kol=0;
  }
 cin >>s[n-1];

for (int j=1;j<m-1;j++)
  {
    kol=0; for (int i=1;i<n-1;i++) if (s[i][j]!='#') N[i][j]=kol++; else kol=0;
    kol=0; for (int i=n-1;i>0;i--) if (s[i][j]!='#') S[i][j]=kol++; else kol=0;
  }
 cin >> k;
 for (int i=0;i<k;i++) cin >> nap[i]>>dl[i];
res="";
for (int i=1;i<n-1;i++)
   for (int j=1;j<m-1;j++) if ((s[i][j]!='#')&&(s[i][j]!='.')) if (u(i,j)) res+=s[i][j];
  sort(res.begin(),res.end());
  if (res[0]) cout <<res; else cout <<"no solution";
}
