#include <cstdio>
#include <cstring>
#include <vector>
#include <algorithm>
using namespace std;

typedef pair<int, int> PII;
vector<PII> p;

int dx[4]={-1, 0, 1, 0}, dy[4]={0, 1, 0, -1};
char a[1005][1005];
int r[4][1005][1005];
int n, m;

bool test(int x, int y) {
	for(int i=0;i<(int)p.size();i++) {
		int f = p[i].first, g = p[i].second;
		if(r[f][x][y] <= g) { return false;	}
		x += dx[f] * g;
		y += dy[f] * g;
	}
	return true;
}

int main(void) {
	scanf("%d%d", &n, &m);
	for(int i=0;i<n;i++)
		scanf("%s", a[i]);
	int q;
	scanf("%d", &q);
	for(int i=0;i<q;i++) {
		char x[10];
		int f=0, g=0;
		scanf("%s%d", x, &g);
		if(x[0]=='N') f=0;
		else if(x[0]=='E') f=1;
		else if(x[0]=='S') f=2;
		else if(x[0]=='W') f=3;
		p.push_back(make_pair(f, g));
	}
	for(int i=0;i<n;i++) {
		for(int j=0;j<m;j++) {
			if(a[i][j]!='#') {
				r[3][i][j] = (j? r[3][i][j-1]+1: 1);
				r[0][i][j] = (i? r[0][i-1][j]+1: 1);
			}
		}
	}
	for(int i=n-1;i>=0;--i) {
		for(int j=m-1;j>=0;--j) {
			if(a[i][j]!='#') {
				r[1][i][j] = (j==m-1? 1: r[1][i][j+1]+1);
				r[2][i][j] = (i==n-1? 1: r[2][i+1][j]+1);
			}
		}
	}
	vector<char> w;
	for(int i=0;i<n;i++)
		for(int j=0;j<m;j++) {
			if(a[i][j]>='A' && a[i][j]<='Z') {
				if(test(i, j)) w.push_back(a[i][j]);
			}
		}
	sort(w.begin(), w.end());
	if(w.size()==0) puts("no solution");
	else {
		for(int i=0;i<(int)w.size();i++)
			printf("%c", w[i]);
		puts("");
	}
	return 0;
}

