#include<iostream>
#include<cstring>
#include<cmath>
#include<cstdio>
#include<algorithm>

using namespace std;
int d[4][2]={-1,0,0,1,1,0,0,-1};
char c[1005][1005];
int w[4][1005][1005];
char ans[1005];
int p[100005],q[100005];
int m,n,s;

bool bfs(int x,int y)
{
    int i;
    for (i=1; i<=s; i++)
    {
        if (w[p[i]][x][y]>q[i])
        {
            x=x+d[p[i]][0]*q[i];
            y=y+d[p[i]][1]*q[i];
        }
        else return 0;
    }
    return true;
}

int main()
{
    char ch;
    int i,j,r;
    cin>>m>>n;
    for (i=1; i<=m; i++)
     for (j=1; j<=n; j++)
      cin>>c[i][j];
    for (i=1; i<=m; i++)
     for (j=1; j<=n; j++)
      if (c[i][j]=='#')
      {w[0][i][j]=0; w[3][i][j]=0;}
    else {w[0][i][j]=w[0][i-1][j]+1; w[3][i][j]=w[3][i][j-1]+1;}
    for (i=m; i>=1; i--)
     for (j=n; j>=1; j--)
      if (c[i][j]=='#')
      {w[1][i][j]=0; w[2][i][j]=0;}
    else {w[1][i][j]=w[1][i][j+1]+1; w[2][i][j]=w[2][i+1][j]+1;}
    cin>>s;
    for (i=1; i<=s; i++)
    {
        cin>>ch;
        if (ch=='N') p[i]=0; else if (ch=='E') p[i]=1;
         else if (ch=='S') p[i]=2; else p[i]=3;
        cin>>q[i];
    }
    r=0;
    for (i=1; i<=m; i++)
     for (j=1; j<=n; j++)
      if (c[i][j]!='.' && c[i][j]!='#')
       if (bfs(i,j))
        ans[++r]=c[i][j];
    if (r>0)
    {
        sort(ans+1,ans+r+1);
        for (i=1; i<=r; i++) cout<<ans[i];
        cout<<endl;
    }
    else cout<<"no solution"<<endl;
}
