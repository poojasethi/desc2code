#include <cstdio>
#include <cstring>
#include <iostream>
#include <algorithm>
using namespace std;
char map[1005][1005];
int l[4][1005][1005];
int n,m,q;
const int dir[4][2]={0,-1,1,0,0,1,-1,0};
int get(char xx)
{
	if(xx=='W')return 0;
	if(xx=='S')return 1;
	if(xx=='E')return 2;
	return 3;
}
int d[100005],len[100005];
char ans[1000000],top;
bool ch(int x,int y)
{
	for(int i=0;i<q;i++)
	{
		int a=d[i];
		if(l[a][x][y]<len[i])return false;
		x+=dir[a][0]*len[i];
		y+=dir[a][1]*len[i];
		if(map[x][y]=='#')return false;
	}
	return true;
}
int main()
{
	while(~scanf("%d%d",&n,&m))
	{
		for(int i=0;i<n;i++)
		scanf("%s",map[i]);
		scanf("%d",&q);
		char op[5];
		for(int i=0;i<q;i++)
		{
			scanf("%s%d",op,&len[i]);
			d[i]=get(op[0]);
		}
		for(int i=0;i<n;i++)
		{
			l[0][i][0]=0;
			for(int j=1;j<m;j++)
			if(map[i][j]!='#')
			{
				if(map[i][j-1]!='#')
				l[0][i][j]=l[0][i][j-1]+1;
				else l[0][i][j]=0;
			}
		}
		for(int j=0;j<m;j++)
		{
			l[1][n-1][j]=0;
			for(int i=n-2;i>=0;i--)
			if(map[i][j]!='#')
			{
				if(map[i+1][j]!='#')
				l[1][i][j]=l[1][i+1][j]+1;
				else l[1][i][j]=0;
			}
		}
		for(int i=0;i<n;i++)
		{
			l[2][i][m-1]=0;
			for(int j=m-2;j>=0;j--)
			if(map[i][j]!='#')
			{
				if(map[i][j+1]!='#')
				l[2][i][j]=l[2][i][j+1]+1;
				else l[2][i][j]=0;
			}
		}
		for(int j=0;j<m;j++)
		{
			l[3][0][j]=0;
			for(int i=1;i<n;i++)
			if(map[i][j]!='#')
			{
				if(map[i-1][j]!='#')
				l[3][i][j]=l[3][i-1][j]+1;
				else l[3][i][j]=0;
			}
		}
		top=0;
		for(int i=0;i<n;i++)
		for(int j=0;j<m;j++)
		if(map[i][j]>='A'&&map[i][j]<='Z')
		{
			if(ch(i,j))
			ans[top++]=map[i][j];
		}
		if(top==0)puts("no solution");
		else
		{
			sort(ans,ans+top);
			for(int i=0;i<top;i++)
			putchar(ans[i]);
			puts("");
		}
	}
}
