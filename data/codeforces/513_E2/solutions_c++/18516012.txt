#include<iostream>
#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<cmath>
#include<algorithm>
#define K 205
#define N 30005
#define LL long long
#define oo (1<<29)
using namespace std;
int n,k,a[N],f[K][N][2][2][2];
int main()
{
	int i,j,op;
	scanf("%d %d",&n,&k);
	for(i=1;i<=n;i++)
		scanf("%d",&a[i]);
	for(i=1;i<=k;i++){
		f[i][0][0][0][0]=f[i][0][0][1][0]=f[i][0][1][0][0]=f[i][0][1][1][0]=-oo;
		f[i][0][0][0][1]=f[i][0][0][1][1]=f[i][0][1][0][1]=f[i][0][1][1][1]=-oo;
	  }
	for(i=1;i<=n;i++){
		for(j=0;j<=k;j++){
			op=1+(j>1&&j<k);
			f[j][i][0][0][0]=max(f[j][i-1][0][0][0],f[j][i-1][0][0][1]);
			f[j][i][0][0][1]=(j ? f[j][i-1][0][0][1]-op*a[i] : -oo);
			f[j][i][0][1][0]=max(f[j][i-1][0][1][0],f[j][i-1][0][1][1]);
			f[j][i][0][1][1]=f[j][i-1][0][1][1];
			f[j][i][1][0][0]=max(f[j][i-1][1][0][0],f[j][i-1][1][0][1]);
			f[j][i][1][0][1]=f[j][i-1][1][0][1];
			f[j][i][1][1][0]=max(f[j][i-1][1][1][0],f[j][i-1][1][1][1]);
			f[j][i][1][1][1]=(j ? f[j][i-1][1][1][1]+op*a[i] : -oo);
			if(j) f[j][i][0][0][1]=max(f[j][i][0][0][1],max(max(f[j-1][i-1][0][1][0],f[j-1][i-1][0][1][1]),max(f[j-1][i-1][1][1][0],f[j-1][i-1][1][1][1]))-op*a[i]);
			if(j) f[j][i][0][1][1]=max(f[j][i][0][1][1],max(max(f[j-1][i-1][0][1][0],f[j-1][i-1][0][1][1]),max(f[j-1][i-1][1][1][0],f[j-1][i-1][1][1][1])));
			if(j) f[j][i][1][0][1]=max(f[j][i][1][0][1],max(max(f[j-1][i-1][0][0][0],f[j-1][i-1][0][0][1]),max(f[j-1][i-1][1][0][0],f[j-1][i-1][1][0][1])));
			if(j) f[j][i][1][1][1]=max(f[j][i][1][1][1],max(max(f[j-1][i-1][0][0][0],f[j-1][i-1][0][0][1]),max(f[j-1][i-1][1][0][0],f[j-1][i-1][1][0][1]))+op*a[i]);
			if(j==1) f[j][i][1][0][0]=f[j][i][1][0][1]=f[j][i][0][1][0]=f[j][i][0][1][1]=-oo;
		  }
	  }
	printf("%d",max(f[k][n][0][0][0],max(f[k][n][0][0][1],max(f[k][n][1][1][0],f[k][n][1][1][1]))));
	return 0;
}
