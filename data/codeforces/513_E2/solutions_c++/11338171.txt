// 10 monthes remaining for red =D
#include <cstdio>
using namespace std;

#define max(a,b)    ((a)>(b)?(a):(b))
#define For(i,a,b)  for(int i=a;i<=b;i++)

int     N,M,A[30005],F[30005][205][4];

int     main(){
        scanf("%d%d",&N,&M);
        For(i,1,M)  For(j,0,3)  F[0][i][j]=-1e9;
        For(i,1,N)  {
            scanf("%d",&A[i]);
            For(j,1,M){
                int x=2-(j==1||j==M);
                F[i][j][0]=max(F[i-1][j][0]-x*A[i],F[i-1][j-1][3]-x*A[i]);
                F[i][j][1]=max(F[i-1][j][1],F[i][j][0]);
                F[i][j][2]=max(F[i-1][j][2]+x*A[i],F[i-1][j-1][1]+x*A[i]);
                F[i][j][3]=max(F[i-1][j][3],F[i][j][2]);
                if  (j!=1&&j!=M){
                    F[i][j][1]=max(F[i][j][1],F[i-1][j-1][1]);
                    F[i][j][3]=max(F[i][j][3],F[i-1][j-1][3]);
                }
            }
        }   printf("%d\n",max(F[N][M][1],F[N][M][3]));
}