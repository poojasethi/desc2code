#include<iostream>
#include<cstdio>
#include<algorithm>
#include<cstring>
using namespace std;
const int L_N=30000+10;
const int L_K=200+5;
const int INF=1e9;
int a[L_N],S[L_N],f[L_N][L_K][2][2],g[L_N][L_K][2][2],N,K;
bool vis[L_N][L_K][2][2],vis1[L_N][L_K][2][2];
inline int co(int c){
    return c<0?0:1;
}

int G(int,int,int,int);
int F(int,int,int,int);

int G(int i,int j,int c1,int c2){
    if(i>N) return j==K?0:-INF;
    if(vis1[i][j][co(c1)][co(c2)]) return g[i][j][co(c1)][co(c2)];
    else vis1[i][j][co(c1)][co(c2)]=true;
    
    int ret=max(F(i,j+1,c2,-1),F(i,j+1,c2,1));
    
    int tmp=G(i+1,j,c1,c2);
    if(j==1) tmp+=c2*a[i];
    else if(j==K) tmp+=-c1*a[i];
    else tmp+=-c1*a[i]+c2*a[i];
    
    ret=max(ret,tmp);
    
    return g[i][j][co(c1)][co(c2)]=ret;
}

int F(int i,int j,int c1,int c2){
    if(j>K) return 0;
    if(i>N) return -INF;
    if(vis[i][j][co(c1)][co(c2)]) return f[i][j][co(c1)][co(c2)];
    else vis[i][j][co(c1)][co(c2)]=true;
    
    int ret=F(i+1,j,c1,c2);

    int tmp=G(i+1,j,c1,c2);
    if(j==1) tmp+=c2*a[i];
    else if(j==K) tmp+=-c1*a[i];
    else tmp+=-c1*a[i]+c2*a[i];
    ret=max(ret,tmp);
    
    //printf("f[%d][%d][%d][%d]=%d\n",i,j,c1,c2,ret);
    return f[i][j][co(c1)][co(c2)]=ret;
}
int main(){
    //freopen("in.txt","r",stdin);
    scanf("%d %d",&N,&K);
    for(int i=1;i<=N;i++){
        scanf("%d",&a[i]);
        S[i]=S[i-1]+a[i];
    }
    
    int ans=0;
    ans=max(ans,F(1,1,1,1));
    ans=max(ans,F(1,1,1,-1));
    ans=max(ans,F(1,1,-1,1));
    ans=max(ans,F(1,1,-1,-1));
    
    printf("%d\n",ans);
    return 0;
}