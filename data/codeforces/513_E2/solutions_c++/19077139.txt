#include <bits/stdc++.h>
using namespace std;

int op[] = {-1, 1};
int a[30005], f[30005][205][2][2][2];


int main()
{
    ios::sync_with_stdio(0); cin.tie(0);
    int n, k;
    cin >> n >> k;
    memset(f,-18,sizeof f);
    for(int i = 1; i <= n; ++i) {
        cin >> a[i];
        f[i][0][1][0][0] = f[i][0][1][0][1] = 0;
    }
    f[0][0][1][0][0]=f[0][0][1][0][1]=0;
    for(int i=1;i<=n;i++)
        for(int num=1;num<=k;num++)
            for(int fi=0;fi<=1;fi++)
                for(int se=0;se<=1;se++) {
                    int fir=op[fi] , sec=op[se];
                    if(num==1) fir=0; if(num==k) sec=0;
                    //cout<<a[i]*(fir+sec)<<endl;
                    f[i][num][0][fi][se]=max(f[i][num][0][fi][se],f[i-1][num-1][1][1][1-fi]+a[i]*(fir+sec)) ;
                    f[i][num][0][fi][se]=max(f[i][num][0][fi][se],f[i-1][num-1][1][0][1-fi]+a[i]*(fir+sec)) ;
                    f[i][num][0][fi][se]=max(f[i][num][0][fi][se],f[i-1][num][0][fi][se]+a[i]*(fir+sec)) ;
                    f[i][num][1][fi][se]=max(f[i][num][1][fi][se],f[i][num][0][fi][se]) ;
                    f[i][num][1][fi][se]=max(f[i][num][1][fi][se],f[i-1][num][1][fi][se]) ;
                }
    cout<<max(max(f[n][k][1][1][0],f[n][k][1][0][0]),max(f[n][k][1][0][1],f[n][k][1][1][1])); //cout<<ans<<endl;
}
