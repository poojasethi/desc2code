#include <bits/stdc++.h>
#define MAX_N 30006 
#define MAX_K 205 
#define oo -1e9 - 1e7

using namespace std; 

int dp[MAX_N][MAX_K][4]; 
int a[MAX_N]; 
int n,k; 

int main () 
	{
		cin >> n >> k;
		
		for (int i = 1; i <= n; i++) cin >> a[i]; 
		
		for (int i = 0; i <= n; i++)
			for (int j = 0; j <= k; j++) 
				for (int t = 0; t < 4; t++) dp[i][j][t] = oo; 
				
		for (int i = 1; i <= n; i++) 
			for (int j = 1; j <= k; j++)
				{
					int mul = 2 - (j == 1 || j == k); 
					
					dp[i][j][0] = max(dp[i-1][j][0],max(dp[i-1][j-1][1],dp[i-1][j-1][3])) + a[i] * mul; 
					if (j == 1) dp[i][j][0] = max(dp[i][j][0], a[i] * mul); 
					
					dp[i][j][1] = max(dp[i-1][j][1],max(dp[i-1][j-1][0],dp[i-1][j-1][2])) - a[i] * mul; 
					if (j == 1) dp[i][j][1] = max(dp[i][j][1], -a[i] * mul); 
					
					dp[i][j][2] = max(dp[i-1][j][2],max(dp[i-1][j-1][2],dp[i-1][j-1][0]));
					
					dp[i][j][3] = max(dp[i-1][j][3],max(dp[i-1][j-1][3],dp[i-1][j-1][1]));
				}
				
		int res = oo; 
		
		for (int i = k; i <= n; i++) res = max(res,max(dp[i][k][0],dp[i][k][1])); 
		cout << res; 
		return 0;
	}