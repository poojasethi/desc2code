#include <iostream>
#include <fstream>
#include <iomanip>
#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <bitset>
#include <set>
#include <map>
#include <vector>
#include <string>
#include <cstring>
#include <queue>
#include <math.h>
#include <memory.h>
using namespace std;

#define max(a,b) ((a)>(b)?(a):(b))
#define FOR0(i,n) for( i = 0 ; i < n ; ++i )
#define FOR1(i,n) for( i = 1 ; i <= n ; ++i )
#define sys_p system( "pause" ) 
#define pb push_back
#define mp make_pair
#define FI first
#define SE second

typedef unsigned long long LL ;

const LL INF = (LL)1e18 ;
const LL MOD = (LL)1e13 + 9 ;

string s, p[20] ; LL n, l[20], r[20], ph[2005], m[2005*2005], ms, ans, t ;
vector < LL > g ;

LL get(LL x)
{
      return upper_bound(m,m+ms,x) - upper_bound(m,m+ms,x-1) ;  
}

void go(string s)
{
      ms = 0 ;
      for( int i = 0 ; i < s.size() ; ++i )
      {
          LL cuh = 0 ; 
          for( int j = i ; j < s.size() ; ++j )
          {
               cuh += (s[j]-'a'+1)*ph[j-i] ;
               m[ ms++ ] = cuh*ph[2004-(j-i)] ;
          }
      }
      sort( m, m+ms ) ;
}

LL i, j, good[2004*2004] ;

main()
{ 
      ph[0] = 1 ;
      FOR1(i,2004)
        ph[i]=(ph[i-1]*31) ;
        
      cin >> s ; 
      go(s) ;
      g.pb(m[0]) ;
      FOR1( i, ms-1 )
        if(m[i]!=m[i-1])
          g.pb(m[i]);
      
      cin >> n ;
      FOR1( j,n )
      {
        cin >> p[j] >> l[j] >> r[j] ;
        go(p[j]) ;    
        FOR0( i,(LL)g.size() )
        {
          t = get( g[i] ) ;
          if( t < l[j] || t > r[j] ) good[i] = 1 ;
        }
      }
      
      FOR0( i,(LL)g.size() ) ans += !good[i] ; 
      cout<< ans ;
}
