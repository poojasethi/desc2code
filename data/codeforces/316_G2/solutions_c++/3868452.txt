#include <cstdio>
#include <cstring>
#include <iostream>
#include <cmath>
#include <ctime>
#include <cstdlib>
#include <map>
#include <set>
#include <algorithm>
#include <queue>
#include <deque>
#include <bitset>
#include <string>
#include <vector>
#include <sstream>
#define zero(a) (abs(a)<eps)
#define lowbit(a) ((a)&(-(a)))
#define abs(a) ((a)>0?(a):(-(a)))
#define dj(x1,y1,x2,y2) ((x1)*(x2)+(y1)*(y2))
#define cj(x1,y1,x2,y2) ((x1)*(y2)-(x2)*(y1))
#define dis(x1,y1,x2,y2) (((x2)-(x1))*((x2)-(x1))+((y2)-(y1))*((y2)-(y1)))
const double eps = 1e-9;
const double pi = acos(-1);
const int oo = 1000000000;
const int mod = 1000000007;
const double E = 2.7182818284590452353602874713527;
using namespace std;

map<long long,int> hash;
char a[2005],b[15][2005],tmp[2005];
int x[15],y[15];

int check(int l,int r,int t)
{
   int s=0,p=1;
   strncpy(tmp+1,a+l,r-l+1);
   tmp[r-l+2]=0;
   while (1)
   {
      char *x;
      if ((x=strstr(b[t]+p,tmp+1))==NULL)
         break;
      s++;
      p=x-b[t]+1;
   }
   return s;
}

int main()
{
   int n,len,ans=0;
   gets(a+1);
   len=strlen(a+1);
   cin>>n;
   for (int i=1;i<=n;i++)
      scanf("%s%d%d",b[i]+1,&x[i],&y[i]);
   for (int i=1;i<=len;i++)
   {
      int ll=i,rr=len;
      for (int j=1;j<=n;j++)
      {
         int l=i-1,r=len+1;
         while (l<r-1)
         {
            int mid=(l+r)>>1;
            if (check(i,mid,j)<=y[j])
               r=mid;
            else
               l=mid;
         }
         ll=max(ll,r);
         l=i-1;
         r=len+1;
         while (l<r-1)
         {
            int mid=(l+r)>>1;
            if (check(i,mid,j)>=x[j])
               l=mid;
            else
               r=mid;
         }
         rr=min(rr,l);
      }
      long long s=0;
      for (int j=i;j<=rr;j++)
      {
         s=s*31+a[j]-'0';
         if (j>=ll)
         {
            ans+=!hash[s];
            hash[s]=1;
         }
      }
   }
   cout<<ans<<endl;
   return 0;
}
