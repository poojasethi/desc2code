#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define N 41000
using namespace std;
int w[N],h[N],sa[N],r[N],wv[N],t[N],ans,i,j,k,X[12],Y[12],num[12],n,tr[N],L,m,l,
	be[N],x,y;
char a[N],ch[N];
void da(){
	int i,m,j,p;
	memset(r,0,sizeof(r));
	memset(w,0,sizeof(w));
	for(i=1;i<=n;++i) w[r[i]=a[i]]++;
	for(i=1;i<=2000;++i) w[i]+=w[i-1];
	for(m=2000,i=n;i>=1;--i) sa[w[r[i]]--]=i;
	for(j=1;j<n;j*=2){
		for(p=0,i=n-j+1;i<=n;++i)tr[++p]=i;
		for(i=1;i<=n;++i) if(sa[i]>j) tr[++p]=sa[i]-j;
		for(i=1;i<=n;++i) wv[i]=r[tr[i]];
		for(i=1;i<=m;++i) w[i]=0;
		for(i=1;i<=n;++i) w[wv[i]]++;
		for(i=1;i<=m;++i) w[i]+=w[i-1];
		for(i=n;i>=1;--i) sa[w[wv[i]]--]=tr[i];
		for(i=1;i<=n;++i) t[i]=r[i];
		for(p=0,i=1;i<=n;++i) if(t[sa[i]]==t[sa[i-1]]&&t[sa[i]+j]==t[sa[i-1]+j]) r[sa[i]]=p;else r[sa[i]]=++p;
		m=p;
		if(p==n) break;
	}
}
void geth(){
	int i,j,p=0;
	for(i=1;i<=n;h[r[i++]]=p) for(p?p--:0,j=sa[r[i]-1];a[j+p]==a[i+p];p++);
}
int main(){
	scanf("%s",a+1);
	n=L=strlen(a+1);
	scanf("%d",&m);
	for(i=1;i<=m;++i){
		scanf("%s",ch+1);
		l=strlen(ch+1);
		a[++n]=i; be[n]=11;
		for(j=1;j<=l;++j)a[++n]=ch[j],be[n]=i;
		scanf("%d%d",&X[i],&Y[i]);
	}
	da();
	geth();
	//for(i=1;i<=n;++i)printf("%d ",a[i]);
	/*for(i=1;i<=n;++i){
		printf("*%d %d ",h[i],be[sa[i]]);
		//for(j=sa[i];j<=n;++j)printf("%d ",a[j]);
		printf("%s\n",a+sa[i]);
		//printf("\n");
	}*/
	for(i=1;i<=L;++i){
		x=y=r[i];
		memset(num,0,sizeof(num));
		for(j=L;j>=i;--j){
			while(x-1>=1 && h[x]>=j-i+1){
				x--;
				num[be[sa[x]]]++;
				if(be[sa[x]]==0 && sa[x]<i)goto a1;
			}
			while(y+1<=n && h[y+1]>=j-i+1){
				y++;
				num[be[sa[y]]]++;
				if(be[sa[y]]==0 && sa[y]<i)goto a1;
			}
			for(k=1;k<=m;++k){
				if(num[k]>Y[k])goto a1;
				if(num[k]<X[k])break;
			}
			if(k==m+1)ans++;
		}
		a1:;
	}
	printf("%d\n",ans);
}
