#include<bits/stdc++.h>
#define pii pair<int,int>
#define f first
#define s second
#define ll long long
#define mp make_pair
#define pb push_back
#define inf 2000000000
#define FOR(a,b,c) for(int a=b;a<=c;a++)
#define ROF(a,b,c) for(int a=b;a>=c;a--)
#define sqr(a) ((a)*(a))
#define max3(a,b,c) max(a,max(b,c))
#define min3(a,b,c) min(a,min(b,c))
#define foreach(itit,gg) for(typeof(gg.begin())itit=gg.begin();itit!=gg.end();itit++)
#define mod 1000000007
using namespace std;

int n,q,timer,st[300005],fin[300005],lv[300005];
vector<int> V[300005];
class fenwick{
	public:
	ll fw[300005];
	void update(int x,int y,int v){
		for(;y;y-=y&-y)
			fw[y]=(fw[y]+v)%mod;
		for(x--;x;x-=x&-x)
			fw[x]=((fw[x]-v)%mod+mod)%mod;
	}
	ll qy(int x){
		ll res=0;
		for( ; x<=n;x+=x&-x) res = (res+fw[x])%mod;
		return res;
	}
};
void dfs(int node,int ata){
	
	st[node] = ++timer;
	lv[node] = lv[ata]+1;
	foreach(it,V[node])
		if(*it != ata)
			dfs(*it,node);

	fin[node] = timer;
}
fenwick f1,f2;
int FF(ll a){
	return (a%mod+mod)%mod;
}
int main(){
	
	int cmd,v;
	ll x,k;
	
	cin >> n;
	
	FOR(i,2,n){
		cin >> x;
		V[x].pb(i);
	}
	
	cin >> q;
	dfs(1,0);
	while(q--){
		
		scanf("%d",&cmd);
		
		if(cmd == 1)
		{
			scanf("%d %lld %lld",&v,&x,&k);
			f1.update(st[v],fin[v],(x+lv[v]*k)%mod);
			f2.update(st[v],fin[v],k);
		}
		else {
			scanf("%d",&v);
			printf("%d\n",FF(f1.qy(st[v]) - lv[v]*f2.qy(st[v])));
		}
	}
	return 0;
}
