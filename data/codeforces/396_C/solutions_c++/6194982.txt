#include <stdio.h>
#include <vector>
#define N 300100

using namespace std;

typedef __int64 ll;

const ll Mod=1000000007;
ll val[N];
vector <int> v[N];
int ft[N], ftime=0;
int s[N], e[N], n;
int dis[N];
ll add[N], pen[N], rep[N];

void dfs(int u, int dep) {
	ft[++ftime]=u;
	dis[ftime]=dep;
	s[u]=ftime;
	int i, j;
	for (i=0; i<v[u].size(); i++) {
		j=v[u][i];
		dfs(j, dep+1);
	}
	e[u]=ftime;
}

void Add(int pos, ll u, ll k, ll d) {
	int i;
	for (i=pos; i<=n; i+=i&-i) {
		add[i]=(add[i]+u)%Mod;
		pen[i]=(pen[i]+k*d)%Mod;
		rep[i]=(rep[i]-k)%Mod;
	}
}

ll Calc(int pos) {
	int i;
	ll A=0, P=0, R=0;
	for (i=pos; i; i-=i&-i) {
		A=(A+add[i])%Mod;
		P=(P+pen[i])%Mod;
		R=(R+rep[i])%Mod;
	}
	return ((A+P+R*dis[pos])%Mod+Mod)%Mod;
}

int main() {
	int q, i, j;
	ll u, k;
//	freopen ("big.in", "r", stdin);
//	freopen ("out.txt", "w", stdout);
	scanf("%d", &n);
	for (i=2; i<=n; i++) {
		scanf("%d", &j);
		v[j].push_back(i);
	}
	dfs(1, 0);
	for (scanf("%d", &q); q--; ) {
		scanf("%d %d", &i, &j);
		if (i==1) {
			scanf("%I64d %I64d", &u, &k);
			Add(s[j], u, k, dis[s[j]]);
			Add(e[j]+1, -u, -k, dis[s[j]]);
		} else printf("%I64d\n", Calc(s[j]));
	}
	return 0;
}
