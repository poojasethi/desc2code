#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;

#define mo 1000000007
const int maxn=300010;
int p[maxn],n1[maxn],h[maxn],st[maxn],ed[maxn],tot=0,d[maxn]={0},ee=0,n;
long long a[maxn]={0},b[maxn]={0};
inline void add(int x,long long y,int z){
	if(!z)	for(;x<=n;x+=x&-x)	a[x]=(a[x]+y)%mo;
	else	for(;x<=n;x+=x&-x)	b[x]=(b[x]+y)%mo;
}
inline long long ask(int x,int z){
	long long ret=0;
	if(!z)	for(;x;x-=x&-x)	ret=(ret+a[x])%mo;
	else	for(;x;x-=x&-x)	ret=(ret+b[x])%mo;
	return ret;
}
void ae(int x,int y){
	p[ee]=y;	n1[ee]=h[x];	h[x]=ee++;
}
void dfs(int x){
	st[x]=++tot;
	for(int i=h[x];~i;i=n1[i])	d[p[i]]=d[x]+1,dfs(p[i]);
	ed[x]=tot;
}
int main(){
	scanf("%d",&n);
	memset(h,-1,sizeof(h));
	int x,y,z,q,op;
	for(int i=2;i<=n;i++){
		scanf("%d",&x);
		ae(x,i);
	}
	dfs(1);
	scanf("%d",&q);
	while(q--){
		scanf("%d",&op);
		if(op==1){
			scanf("%d%d%d",&x,&y,&z);
			add(st[x],(y+1ll*z*d[x])%mo,0);
			add(ed[x]+1,(-y-1ll*z*d[x])%mo,0);
			add(st[x],-z,1);
			add(ed[x]+1,z,1);
		}else{
			scanf("%d",&x);
			long long ans=ask(st[x],0)+ask(st[x],1)*d[x]%mo;
			printf("%I64d\n",(ans%mo+mo)%mo);
		}
	}
	return 0;
}