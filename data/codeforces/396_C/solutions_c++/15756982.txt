//In The Name Of God 

#include<bits/stdc++.h>

using namespace std;
#define int long long
typedef long long ll;

const int Maxn=3e5+7;
const int Mod=1e9+7;

const int ADD=1;
const int SLV=2;

int n,q;
vector<int>V[Maxn];
int T,st[Maxn],en[Maxn],h[Maxn];
ll s[2][Maxn];

void dfs(int v,int par=0)
{
  st[v]=T++;
  for(int i=0;i<V[v].size();i++)
    {
      int u=V[v][i];
      if(u!=par)
	h[u]=h[v]+1,dfs(u,v);
    }
  en[v]=T;
}

void add(int t,int x,int v)
{
  for(x++;x<Maxn;x+=x&-x)
    (s[t][x]+=v)%=Mod;
}

int get(int t,int x)
{
  ll ret=0;
  for(x++;x;x-=x&-x)
    (ret+=s[t][x]+Mod)%=Mod;
  return ret;
}

main()
{
  ios::sync_with_stdio(0);cin.tie(0);
  cin>>n;
  for(int p,i=1;i<n;i++)
    cin>>p,V[p-1].push_back(i);
  dfs(0);
  cin>>q;
  for(int t,v,x,k;q--;)
    {
      cin>>t>>v;
      v--;
      if(t==ADD)
	{
	  cin>>x>>k;
	  add(0,st[v],(x+h[v]*k)%Mod);
	  add(0,en[v],-(x+h[v]*k)%Mod);
	  add(1,st[v],k);
	  add(1,en[v],-k);
	}   
      if(t==SLV)
        cout<<(get(0,st[v])%Mod-(get(1,st[v])*h[v]%Mod)+2*Mod)%Mod<<"\n";
    }
  return 0;
}