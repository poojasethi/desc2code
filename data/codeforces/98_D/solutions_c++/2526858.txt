#include<cstdio>
#include<utility>
#define mp make_pair
#define fo(i,a,b) for(i=a;i<=b;++i)
using namespace std;
const int mn=1200000;
int n,L,la;
int a[mn];
pair<int,int>f[mn];
void simp(int r,int s,int t)
{
    int k=s^t,i;
    if(r==n)
    {
        fo(i,1,a[r])f[++L]=mp(s,t);
        return;
    }
    simp(r+1,s,k);
    fo(i,1,a[r])f[++L]=mp(s,t);
    simp(r+1,k,t);
}
void dfs(int r,int s,int t)
{
    int k=s^t,i;
    if(r==n)
    {
        fo(i,1,a[r]-1)f[++L]=mp(s,k);
        f[++L]=mp(s,t);
        fo(i,1,a[r]-1)f[++L]=mp(k,t);
        return;
    }
    if(a[r]==1)
    {
        simp(r,s,t);
        return;
    }
    simp(r+1,s,t);
    fo(i,1,a[r])f[++L]=mp(s,k);
    simp(r+1,t,s);
    fo(i,1,a[r])f[++L]=mp(k,t);
    dfs(r+1,s,t);
}
int main()
{
    scanf("%d",&n);
    int i,v;
    L=0,la=0;
    fo(i,1,n)
    {
        scanf("%d",&v);
        if(v!=la)++L;
        ++a[L],la=v;
    }
    n=L,L=0;
    dfs(1,1,3);
    printf("%d\n",L);
    fo(i,1,L)printf("%d %d\n",f[i].first,f[i].second);
    return 0;
}