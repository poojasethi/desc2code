#include<cstdio>
#define z 6-x-y
const int q=20;
int fr[1<<q],tu[1<<q],re[1<<q],f[q][2],g[q][2],b[q];
int ans,res,n;
void mv(int x,int y,int b){
	fr[ans]=x,tu[ans]=y,re[ans]=b;
	ans++,res+=b;
}
void dfs(int i,int p,int x,int y){
	if (i==n) return;
	if (g[i][p]==1){
		if (b[i]==1 || p==1){
			dfs(i+1,1,x,z);
			mv(x,y,b[i]);
			dfs(i+1,1,z,y);
		} else{
			dfs(i+1,1,x,y);
			mv(x,z,b[i]-1);
			dfs(i+1,1,y,z);
			mv(x,y,1);
			dfs(i+1,1,z,x);
			mv(z,y,b[i]-1);
			dfs(i+1,1,x,y);
		}
	} else{
		dfs(i+1,1,x,y);
		mv(x,z,b[i]);
		dfs(i+1,1,y,x);
		mv(z,y,b[i]);
		dfs(i+1,0,x,y);
	}
}
int main(){
	int cnt,lst,a,i,j;
	scanf("%d",&n);
	i=n+1;
	for (cnt=lst=n=0;i;i--){
		i>1?scanf("%d",&a):a=-1;
		if (cnt && a!=lst){
			b[n++]=cnt;
			cnt=0;
		}
		lst=a,cnt++;
	}
	f[n-1][1]=b[n-1],f[n-1][0]=2*b[n-1]-1;
	g[n-1][0]=g[n-1][1]=1;
	for (i=n-2;i>=0;i--){
		f[i][1]=2*f[i+1][g[i][1]=1]+b[i];
		if (b[i]==1){
			f[i][0]=2*f[i+1][g[i][0]=1]+b[i];
		} else{
			if (4*f[i+1][1]+2*b[i]-1<2*f[i+1][1]+f[i+1][0]+2*b[i])
				f[i][0]=4*f[i+1][g[i][0]=1]+2*b[i]-1; else
				f[i][0]=2*f[i+1][1]+f[i+1][g[i][0]=0]+2*b[i];
		}
	}
	ans=res=0;
	dfs(0,0,1,3);
	printf("%d\n",res);
	for (i=0;i<ans;i++) for (j=0;j<re[i];j++)
		printf("%d %d\n",fr[i],tu[i]);
	return 0;
}
