//program 98-D

#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<vector>

using namespace std;

int Len[20];
vector<int> X,Y;

void G(int N,int A,int B,int C)
{
  if(N)G(N-1,A,C,B);
  for(int i=0;i<Len[N];i++)
    {X.push_back(A);Y.push_back(C);}
  if(N)G(N-1,B,A,C);
}

void F(int N,int A,int B,int C)
{
  if(!N)
    {
      for(int i=1;i<Len[N];i++)
        {X.push_back(A);Y.push_back(B);}
      X.push_back(A);Y.push_back(C);
      for(int i=1;i<Len[N];i++)
        {X.push_back(B);Y.push_back(C);}
    }
  else if(Len[N]==1)
    {
      G(N-1,A,C,B);
      X.push_back(A);
      Y.push_back(C);
      G(N-1,B,A,C);
    }
  else
    {
      G(N-1,A,B,C);
      for(int i=0;i<Len[N];i++)
        {X.push_back(A);Y.push_back(B);}
      G(N-1,C,B,A);
      for(int i=0;i<Len[N];i++)
        {X.push_back(B);Y.push_back(C);}
      F(N-1,A,B,C);
    }
}

int main()
{
  int N;scanf("%d",&N);
  int Last=-1,M=0;
  for(int i=0;i<N;i++)
    {
      int X;scanf("%d",&X);
      if(X==Last)Len[M-1]++;else Len[M++]=1;
      Last=X;
    }
  for(int i=0,j=M-1;i<j;i++,j--)swap(Len[i],Len[j]);
  F(M-1,1,2,3);
  printf("%d\n",(int)X.size());
  for(int i=0;i<X.size();i++)
    printf("%d %d\n",X[i],Y[i]);
  return 0;
}
