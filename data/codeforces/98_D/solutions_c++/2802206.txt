/*
Author: LJQ
PROG: Codeforces Beta #78 Div1 D. Help Monks
DATE: 2012.12.21
*/
#include <cstdio>

using namespace std;

const int maxn = 21;
const int maxs = 1100005;

int num[maxn];
int x[maxs], y[maxs];
int n, m, ret;

void func2(int A, int B, int t)
{
	int C = 6 - A - B;
	if (t == n - 1){
		for (int i = 0; i < num[t]; i ++) x[++ ret] = A, y[ret] = B;
		return;
	}
	func2(A, C, t + 1);
	for (int i = 0; i < num[t]; i ++) x[++ ret] = A, y[ret] = B;
	func2(C, B, t + 1);
}

void func1(int A, int B, int t)
{
	int C = 6 - A - B;
	if (t == n - 1){//top pieces
		for (int i = 1; i < num[t]; i ++) x[++ ret] = A, y[ret] = C;
		x[++ ret] = A; y[ret] = B;
		for (int i = 1; i < num[t]; i ++) x[++ ret] = C, y[ret] = B;
		return;
	}
	if (num[t] == 1){
		func2(A, B, t); return;
	}
	func2(A, B, t + 1);
	for (int i = 0; i < num[t]; i ++) x[++ ret] = A, y[ret] = C;
	func2(B, A, t + 1);
	for (int i = 0; i < num[t]; i ++) x[++ ret] = C, y[ret] = B;
	func1(A, B, t + 1);
}

void init()
{
	scanf("%d", &m); n = 0;
	for (int i = 0, lat, tmp; i < m; i ++){
		scanf("%d", &tmp);
		if (!n || tmp != lat) num[n ++] = 1, lat = tmp;
			else num[n - 1] ++;
	}
}

void print()
{
	func1(1, 3, 0);
	printf("%d\n", ret);
	for (int i = 1; i <= ret; i ++)
		printf("%d %d\n", x[i], y[i]);
}

int main()
{
	init();
	print();
	return 0;
}
