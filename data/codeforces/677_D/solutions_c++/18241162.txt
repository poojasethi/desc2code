//Copyright(c)2016 liuchenrui
#include<bits/stdc++.h>
#define LL long long
using namespace std;
inline void splay(int &v){
	v=0;char c=0;int p=1;
	while(c<'0' || c>'9'){if(c=='-')p=-1;c=getchar();}
	while(c>='0' && c<='9'){v=(v<<3)+(v<<1)+c-'0';c=getchar();}
	v*=p;
}
struct node{
	int x,y,v;
	bool operator<(const node&b)const{
		return v<b.v;
	}
};
vector<node>p[90005];
int n,m,k;
int main(){
	splay(n),splay(m),splay(k);
	for(int i=1;i<=n;i++){
		for(int j=1;j<=m;j++){
			int x;splay(x);
			p[x].push_back((node){i,j,1000000000});
		}
	}
	p[0].push_back((node){1,1,0});
	for(int i=0;i<k;i++){
		sort(p[i].begin(),p[i].end());
		for(int j=0;j<min(p[i].size(),800u);j++){
			for(int k=0;k<p[i+1].size();k++){
				p[i+1][k].v=min(p[i+1][k].v,p[i][j].v+abs(p[i][j].x-p[i+1][k].x)+abs(p[i][j].y-p[i+1][k].y));
			}
		}
	}
	int ans=0;
	for(int i=0;i<p[k].size();i++){
		ans=max(ans,p[k][i].v);
	}
	cout<<ans<<endl;
}