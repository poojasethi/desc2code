#include<cstdio>
#include<cstring>
#include<algorithm>
#include<cstdlib>

using namespace std;

int n,m,fa[1010],S,M,ans[1010],cnt;

struct et{int u,v,t,o;} e[100010];

bool cmp(et a,et b){return a.t<b.t;}

int getfa(int x){if (fa[x]!=x) fa[x]=getfa(fa[x]);return fa[x];}

int main()
{
//    freopen("E.in","r",stdin); freopen("E.out","w",stdout);
    scanf("%d%d",&n,&m);
    if (!(n&1)) {puts("-1");return 0;}
    for (int i=0;i<m;i++)
    {
        scanf("%d%d",&e[i].u,&e[i].v);
        char c; for (c=getchar();c<'A';c=getchar());
        e[i].t=(c=='S')?1:0; e[i].o=i+1;
    }
    sort(e,e+m,cmp);
    for (int i=1;i<=n;i++) fa[i]=i;
    for (int i=m-1;i>=0;i--)
    {
        int u=getfa(e[i].u),v=getfa(e[i].v);
        if (u!=v)
        {
            fa[u]=v;
            if (!e[i].t) e[i].t=-1;
		}
	}
	sort(e,e+m,cmp);
	for (int i=1;i<=n;i++) fa[i]=i;
	S=M=cnt=0;
    for (int i=0;i<m;i++)
    if (e[i].t>0 || S<(n-1)/2)
    {
        int u=getfa(e[i].u),v=getfa(e[i].v);
        if (u!=v)
        {
            fa[u]=v;
            ans[cnt++]=e[i].o;
            if (e[i].t>0) M++;else S++;
        }
    }
    if (S<(n-1)/2 || M<(n-1)/2) {puts("-1");return 0;}
    printf("%d\n",n-1);
    for (int i=0;i<n-1;i++) printf("%d ",ans[i]);
    return 0;
}
