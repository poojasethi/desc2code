#include <algorithm>
#include <cstdio>
using namespace std;
const int N=110000;
int i,j,n,m,u,v,s,s1,s2,x[N],y[N],p1[N],p2[N],p3[N];
char c[N];
bool ok;
int f1(int x) {return (x==p1[x])?x:p1[x]=f1(p1[x]);}
int f2(int x) {return (x==p2[x])?x:p2[x]=f2(p2[x]);}
int f3(int x) {return (x==p3[x])?x:p3[x]=f3(p3[x]);}
int main() {
	scanf("%d%d",&n,&m);
	for (i=1;i<=n;i++) p1[i]=p2[i]=p3[i]=i;
	for (i=1;i<=m;i++) {
		scanf("%d%d %c",x+i,y+i,c+i);
		if (c[i]=='S') {
			u=f1(x[i]);v=f1(y[i]);
			if (u!=v) {p1[u]=v;s1++;}
		} else {
			u=f2(x[i]);v=f2(y[i]);
			if (u!=v) {p2[u]=v;s2++;}
		}
		u=f3(x[i]);v=f3(y[i]);
		if (u!=v) {p3[u]=v;s++;}
	}
	ok=(n/2<=s1)&&(n/2<=s2)&&(n%2)&&(s==n-1);
	if (!ok) printf("-1\n");
	else {
		printf("%d\n",n-1);
		s1=s2=0;
		for (i=1;i<=n;i++) p3[i]=i;
		for (i=1;i<=m;i++)
			if (c[i]=='S') {
				u=f2(x[i]);v=f2(y[i]);
				if (u!=v) {
					p2[u]=v;s1++;
					u=f3(x[i]);v=f3(y[i]);
					p3[u]=v;
					printf("%d ",i);
				}
			} else {
				u=f1(x[i]);v=f1(y[i]);
				if (u!=v) {
					p1[u]=v;s2++;
					u=f3(x[i]);v=f3(y[i]);
					p3[u]=v;
					printf("%d ",i);
				}
			}
		for (i=1;(i<=m)&&(s1<n/2);i++)
			if (c[i]=='S') {
				u=f3(x[i]);v=f3(y[i]);
				if (u!=v) {
					p3[u]=v;s1++;
					printf("%d ",i);
				}
			}
		for (i=1;(i<=m)&&(s2<n/2);i++)
			if (c[i]=='M') {
				u=f3(x[i]);v=f3(y[i]);
				if (u!=v) {
					p3[u]=v;s2++;
					printf("%d ",i);
				}
			}
	}
	return 0;
}
