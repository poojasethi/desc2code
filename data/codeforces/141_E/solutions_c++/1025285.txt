#include<stdio.h>
#include<string>
#include<string.h>
#include<stdlib.h>
#include<algorithm>
using namespace std;
//const int N=1000;
int n,m,i,o=0,aa,bb;
int f[1000],ans[1000];
char c;
struct aaa{
	int a,b,u,o;
}a[100000],b[100000];
int A,B;
int ff(int x){
	if(f[f[x]]!=f[x])f[x]=ff(f[x]);return f[x];
}
void uni(int x,int y){
	if(rand()&1)f[ff(x)]=ff(y);else f[ff(y)]=ff(x);
}
int main(){
	scanf("%d%d",&n,&m);
	for(i=0;i<m;i++){
		scanf("%d%d%c%c",&aa,&bb,&c,&c);
		if(aa==bb)continue;
		aa--;bb--;
		if(c=='S'){
			a[A].a=aa;	a[A].b=bb;	a[A].o=i;	A++;
		}else{
			b[B].a=aa;	b[B].b=bb;	b[B].o=i;	B++;
		}
	}
	if( n%2==0 || A+B<n-1 || A<(n-1)/2 || B<(n-1)/2){
		printf("-1\n");
		return 0;
	}
	if(n==1){
		printf("0\n\n");
		return 0;
	}
	for(i=0;i<n;i++)f[i]=i;
	for(i=0;i<A;i++)uni(a[i].a,a[i].b);
	for(i=0;i<B && o<(n-1)/2;i++)
	if(ff(b[i].a)!=ff(b[i].b)){
		uni(b[i].a,b[i].b);
		ans[o++]=b[i].o;
		b[i].u=1;
	}
	for(i=0;i<n;i++)f[i]=i;
	for(i=0;i<B;i++)if(b[i].u)uni(b[i].a,b[i].b);
	for(i=0;i<B&&o<(n-1)/2;i++)
	if(!b[i].u&&ff(b[i].a)!=ff(b[i].b)){
		uni(b[i].a,b[i].b);
		ans[o++]=b[i].o;
		b[i].u=1;
	}
	if(o<(n-1)/2){
		printf("-1\n");
		return 0;
	}
	for(i=0;i<A&&o<n-1;i++)
	if(ff(a[i].a)!=ff(a[i].b)){
		uni(a[i].a,a[i].b);
		ans[o++]=a[i].o;
	}
	if(o<n-1){
		printf("-1\n");
		return 0;
	}
	printf("%d\n",n-1);
	for(i=0;i<n-2;i++)printf("%d ",ans[i]+1);
	printf("%d\n",ans[n-2]+1);
//	if(flag)printf("YES\n");else printf("NO\n");
	return 0;
}

