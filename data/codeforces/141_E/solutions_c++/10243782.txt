#include<bits/stdc++.h>
using namespace std;

const int N=1010;
const int M=100100;
struct cc{
    int p[N];
    void init(int n){
        for(int i=1;i<=n;i++)p[i]=i;
    }
    int f(int x){
        return x==p[x]?x:p[x]=f(p[x]);
    }
    bool judge(int x,int y){
        int fx=f(x),fy=f(y);
        return fx==fy;
    }
    void update(int x,int y){
        int fx=f(x),fy=f(y);
        if(fx!=fy){
            p[fx]=fy;
        }
    }
}aa,bb;
vector<int> ans1,ans2;
int u[M],v[M],lab[M];
char s[10];

int main(){
    int n,m;
    scanf("%d%d",&n,&m);
    if(0==(n&1)){
        puts("-1");
        return 0;
    }
    for(int i=0;i<m;i++){
        scanf("%d%d%s",&u[i],&v[i],s);
        lab[i]=(s[0]=='S');
    }
    aa.init(n),bb.init(n);
    for(int i=0;i<m;i++){
        if(lab[i]){
            aa.update(u[i],v[i]);
        }
    }
    int tot=(n-1)/2;
    for(int i=0;i<m;i++){
        if(0==lab[i]&&!aa.judge(u[i],v[i])){
            aa.update(u[i],v[i]);
            bb.update(u[i],v[i]);
            ans2.push_back(i+1);
            tot--;
        }
    }
    for(int i=0;i<m&&tot>0;i++){
        if(0==lab[i]&&!bb.judge(u[i],v[i])){
            bb.update(u[i],v[i]);
            ans2.push_back(i+1);
            tot--;
        }
    }
    for(int i=0;i<m;i++){
        if(lab[i]&&!bb.judge(u[i],v[i])){
            bb.update(u[i],v[i]);
            ans1.push_back(i+1);
        }
    }
    //cout<<ans1.size()<<" "<<ans2.size()<<endl;
    if(ans1.size()!=(n-1)/2||ans2.size()!=(n-1)/2){
        puts("-1");
        return 0;
    }
    printf("%d\n",n-1);
    for(int i=0;i<ans1.size();i++){
        printf("%d ",ans1[i]);
    }
    for(int i=0;i<ans2.size();i++){
        printf("%d ",ans2[i]);
    }
    return 0;
}

  	 			  		 	   	 		     		