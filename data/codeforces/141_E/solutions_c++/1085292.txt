#include <cstdio>
#define N 1002
#define M 100006

int n, m, A, s[N], S[N], c, d;
char t;
bool z;
struct{
	int x, y;
	char t;
	bool u;
} e[M];

int f(int x){ return x == s[x] ? x : s[x] = f(s[x]);}
int F(int x){ return x == S[x] ? x : S[x] = F(S[x]);}

int main(){
	scanf("%d %d", &n, &m);
	if(~n & 1) z = 1;
	
	A = n - 1 >> 1;
	for(int i = 1; i <= n && !z; i++) s[i] = S[i] = i;
	for(int i = 1, x, y; i <= m && !z; i++){
		scanf("%d %d %c", &e[i].x, &e[i].y, &e[i].t);
		if(e[i].t == 'M') S[F(e[i].x)] = F(e[i].y);
	}
	for(int i = 1; i <= m && !z; i++) if(e[i].t == 'S' && F(e[i].x) != F(e[i].y)){
		s[f(e[i].x)] = f(e[i].y);
		S[F(e[i].x)] = F(e[i].y);
		e[i].u = 1;
		c++;
	}
	if(c > A) z = 1;
	for(int i = 1; i <= m && !z && c < A; i++) if(e[i].t == 'S' && f(e[i].x) != f(e[i].y)){
		s[f(e[i].x)] = f(e[i].y);
		e[i].u = 1;
		c++;
	}
	if(c != A) z = 1;
	
	for(int i = 1; i <= m && !z && d < A; i++) if(e[i].t == 'M' && f(e[i].x) != f(e[i].y)){
		s[f(e[i].x)] = f(e[i].y);
		e[i].u = 1;
		d++;
	}
	if(d != A) z = 1;
	
	if(z) printf("-1\n");
	else{
		printf("%d\n", n - 1);
		for(int i = 1, Q = 0; i <= m; i++) if(e[i].u){
			if(Q) printf(" ");
			printf("%d", i);
			Q = 1;
		}
		if(n - 1) printf("\n");
	}
}
