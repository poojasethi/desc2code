#include<cstdio>
#include<cstring>
#include<vector>
#include<algorithm>
using namespace std;

vector<int>s;
vector<int>m;
vector<int>r;
int u[110000],v[110000];
int n,k,f[1100];

int fin(int x){
	return f[x]==x?x:f[x]=fin(f[x]);
}

void one()
{
	for(int i=1;i<=n;++i)	f[i]=i;
	for(int i=0;i<s.size();++i)
	{
		int uu=u[s[i]],vv=v[s[i]];
		int fu=fin(uu),fv=fin(vv);
		if(fu!=fv)	f[fu]=fv;
	}
}

bool two()
{
	for(int i=0;i<m.size();++i)
	{
		int uu=u[m[i]],vv=v[m[i]];
		int fu=fin(uu),fv=fin(vv);
		if(fu==fv)	continue;
		f[fu]=fv;
		r.push_back(m[i]);
	}
	return r.size()*2<n;
}

bool ok()
{
	if(!(n&1))	return false;
	one();
	if(!two())	return false;
	for(int i=1;i<=n;++i)	f[i]=i;
	for(int i=0;i<r.size();++i)
	{
		int uu=u[r[i]],vv=v[r[i]];
		int fu=fin(uu),fv=fin(vv);
		f[fu]=fv;
	}
	int kk=n/2-r.size();
	for(int i=0;i<m.size()&&kk;++i)
	{
		int uu=u[m[i]],vv=v[m[i]];
		int fu=fin(uu),fv=fin(vv);
		if(fu==fv)	continue;
		kk--;
		f[fu]=fv;
		r.push_back(m[i]);
	}
	if(kk)	return false;
	for(int i=0;i<s.size();++i)
	{
		int uu=u[s[i]],vv=v[s[i]];
		int fu=fin(uu),fv=fin(vv);
		if(fu==fv)	continue;
		f[fu]=fv;
		r.push_back(s[i]);
	}
	return r.size()==n-1;
}

char ss[12];
int main()
{
	scanf("%d %d",&n,&k);
	for(int i=1;i<=k;++i)
	{
		scanf("%d %d %s",&u[i],&v[i],ss);
		if(ss[0]=='S')
			s.push_back(i);
		else
			m.push_back(i);
	}
	if(!ok())
		puts("-1");
	else
	{
		printf("%d\n",n-1);
		for(int i=0;i<r.size();++i)	printf("%d ",r[i]);
		puts("");
	}
	return 0;
}
 	     					 	  				  		 	