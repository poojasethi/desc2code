#include<cstdio>
#include<iostream>
#include<cstring>
#include<algorithm>
#include<vector>
using namespace std;
int n,m,par[3][1005],cnt=0;
struct ed{
  int st,ed,id;
  char col;
}s[100005];
vector<int> ans;
int f(int x,int d){
  if(par[d][x]==x) return x;
  else return par[d][x]=f(par[d][x],d);
}
int main(){
  scanf("%d %d",&n,&m);
  if(n%2==0 || m<n-1){printf("-1\n");return 0;}
  for(int i=1;i<=m;i++){
    scanf("%d %d %c",&s[i].st,&s[i].ed,&s[i].col);
    s[i].id=i;
  }
  for(int i=1;i<=n;i++) par[0][i]=i;
  int cnt2=0;
  for(int i=1;i<=m;i++){
    if(s[i].col=='S'){
      int L=f(s[i].st,0),R=f(s[i].ed,0);
      if(L==R) continue;
      par[0][L]=R;
      cnt2++;
    }
  }
  
  for(int i=1;i<=n;i++) par[2][i]=par[0][i];
  for(int i=1;i<=m;i++){
    if(s[i].col=='M'){
      int L=f(s[i].st,2),R=f(s[i].ed,2);
      if(L==R) continue;
      par[2][L]=R;
      cnt++;
      ans.push_back(s[i].id);
    }
  }
  if(cnt+cnt2!=n-1){printf("-1\n");return 0;}
  for(int i=1;i<=n;i++) par[1][i]=i;
  for(int i=1;i<=m && cnt*2<n-1;i++){
    if(s[i].col=='M'){
      int L=f(s[i].st,0),R=f(s[i].ed,0);
      if(L!=R) continue;
      int _L=f(s[i].st,1),_R=f(s[i].ed,1);
      if(_L==_R) continue;
      par[1][_L]=_R;
      cnt++;
      ans.push_back(s[i].id);
    }
  }
  
  if(cnt*2!=n-1){printf("-1\n");return 0;}
  for(int i=0;i<cnt;i++) par[1][f(s[ans[i]].st,1)]=f(s[ans[i]].ed,1);
  for(int i=1;i<=m;i++){
    if(s[i].col=='S'){
      int L=f(s[i].st,1),R=f(s[i].ed,1);
      if(L==R) continue;
      par[1][L]=R;
      ans.push_back(s[i].id);
    }
  }
  printf("%d\n",n-1);
  if(n==1) printf("\n");
  for(int i=0;i<n-1;i++) printf("%d%c",ans[i],i==n-2?'\n':' ');
  return 0;
}