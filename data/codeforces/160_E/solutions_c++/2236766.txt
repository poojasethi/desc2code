#include <iostream>
#include <algorithm>
#include<stdio.h>
#include<string.h>
#include<queue>
#include<cmath>
#include<list>
#include<set>
#include<map>
#include<vector>
#define N 100005
#define inf 1000000013
#define mp make_pair
#define pb push_back
#define pii pair<int,int>
#define x first
#define y second
#define lst p<<1,l,mid
#define rst p<<1|1,mid+1,r
#define ll long long
using namespace std;
struct bus
{
 int x,y,t,id;
 bool operator < (const bus&a)const
 {
  return y!=a.y?y>a.y:id<a.id;
 }
}bs[N*2];
set<int>b[N*2];
map<int,int>tr;
int nn,ans[N],xs[N*2],ys[N*2],xlen,ylen;
void init(int n)
{
 nn=n;
 for(int x=1;x<=nn;x++)
 b[x].clear(),b[x].insert(inf);
}
void add(int x,int d)
{
 for(;x<=nn;x+=x&-x)b[x].insert(d);
}
int get(int x,int t)
{
 int res=inf;
 for(;x>0;x-=x&-x)res=min(res,*b[x].lower_bound(t));
 return res;
}
int main()
{
   // freopen("in.txt","r",stdin);
    int n,m,i;
    while(~scanf("%d%d",&n,&m))
    {
     int bslen=n+m;
     for(i=0;i<bslen;i++)
     {
      scanf("%d%d%d",&bs[i].x,&bs[i].y,&bs[i].t);
      bs[i].id=i;
     }
     int xlen=0,ylen=0;
     for(i=0;i<bslen;i++)
     xs[xlen++]=bs[i].x,ys[ylen++]=bs[i].y;
     sort(xs,xs+xlen);
     xlen=unique(xs,xs+xlen)-xs;
     sort(ys,ys+ylen);
     ylen=unique(ys,ys+ylen)-ys;
     for(i=0;i<bslen;i++)
     {
      bs[i].x=lower_bound(xs,xs+xlen,bs[i].x)-xs+1;
      bs[i].y=lower_bound(ys,ys+ylen,bs[i].y)-ys+1;
     }
     tr.clear();
     tr[inf]=-1;
     for(i=0;i<n;i++)tr[bs[i].t]=i+1;
     sort(bs,bs+bslen);
     init(xlen);
     for(i=0;i<bslen;i++)
     if(bs[i].id<n)
     add(bs[i].x,bs[i].t);
     else
     {
      int res=get(bs[i].x,bs[i].t);
      ans[bs[i].id-n]=tr[res];
     }
     for(i=0;i<m;i++)
     printf("%d ",ans[i]);
     printf("\n");
    }
    return 0;
}
