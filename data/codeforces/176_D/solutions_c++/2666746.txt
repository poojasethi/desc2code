#include<iostream>
#include<algorithm>
#include<cstdio>
#include<cstring>

using std::min;

const int fin=0,maxn=1000010,maxm=2010;
const int INF=2100000000;
int n,m,tot,e;
char s[maxn];
int next[maxn][26],last[26],suc[maxm][26];
int fs[maxm],len[maxm],sl[maxm];
int a[maxm],f[maxm][maxm];

int main(){
  if(fin){
    freopen("t.in","r",stdin);
    freopen("t.out","w",stdout);
  }
  int i,j,p;
  scanf("%d",&n);
  for(i=1;i<=n;++i){
    fs[i]=tot,scanf("%s",s+tot);
    len[i]=strlen(s+tot),tot+=len[i];
  }
  for(i=0;i<tot;++i)s[i]-='a';
  for(fs[n+1]=tot,i=n;i;--i){
    for(j=0;j<26;++j)last[j]=INF;
    for(j=fs[i+1]-1;j>=fs[i];--j)
      last[s[j]]=j-fs[i],memcpy(next[j],last,sizeof(last));
  }
  scanf("%d",&m);
  for(i=1;i<=m;++i)
    scanf("%d",a+i),sl[i]=sl[i-1]+len[a[i]];
  for(i=0;i<26;++i)suc[m+1][i]=INF;
  for(i=m;i;--i)
    for(j=0;j<26;++j)
      suc[i][j]=next[fs[a[i]]][j]==INF?suc[i+1][j]:(next[fs[a[i]]][j]+sl[i-1]);
  scanf("%s",s+1),e=strlen(s+1);
  for(i=1;i<=e;++i)s[i]-='a';
  for(i=1;i<=e;++i)
    for(p=0,j=1;j<=i;++j){
      f[i][j]=i>j?f[i-1][j]:INF;
      if(f[i-1][j-1]!=INF){
        while(sl[p]<f[i-1][j-1])++p;
        f[i][j]=min(f[i][j],suc[p+1][s[i]]+1);
        if(p!=0&&f[i-1][j-1]-sl[p-1]!=len[a[p]])
          f[i][j]=min(f[i][j],next[f[i-1][j-1]-sl[p-1]+fs[a[p]]][s[i]]+sl[p-1]+1);
      }
    }
  for(i=e;f[e][i]==INF;--i);
  printf("%d",i);
  return 0;
}
