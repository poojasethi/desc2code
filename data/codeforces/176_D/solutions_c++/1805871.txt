//By Lin
#include<cstdio>
#include<cstring>
#include<set>
#define maxn 2005
using namespace std; 

int		n,m,dp[maxn][2],ans,st[maxn],que[maxn];
char	s[1000005],t[maxn];
int		next[1000005][26],last[26];

void	find_next(int i , int j , int k , int &x ,int &y ) 
{
	x = y = -1; 

	while ( i < m && next[j][k] == -1 ) {
		i++; 
		j = st[que[i]];
	}
	//printf("%d %d %c\n" , i , j ,k+'a' ); 
	
	if ( i == m ) return; 
	x = i; 
	y = next[j][k]; 
//	printf("%d %d %d\n", j , k , y ); 
	if ( y == st[que[i]+1] )
	{
		x++; 
		y = st[que[x]];
	}
}
int 	main()
{
	scanf("%d", &n );
	int j = 0; 
	for (int i = 0; i<n; i++) {
		scanf("%s", s+j );
		st[i] = j; 
		for ( ; s[j]; j++ ); 
	}
	st[n] = j;
	scanf("%d", &m );
	memset( next , -1 , sizeof(next) );
	for (int i = 0; i<m; i++) {
		scanf("%d", &que[i] );
		que[i]--; 
	}
	for (int i = 0; i<n; i++) 
	{
		for (int g = 0; g<26; g++) last[g] = st[i]-1; 
		for (int j = st[i]; j<st[i+1]; j++) {
			int t = s[j]-'a';
			//printf("%c\n" , s[j] ); 
			for (int g = last[t]+1; g<=j; g++){
				next[g][t] = j+1; 
			//	printf("%d %c %d\n" , g , t+'a' , j+1 ); 
			}
			last[t] = j; 
		}
	}
	scanf("%s", t ); 
	ans = 0; 
	dp[0][0] = 0;
	dp[0][1] = st[que[0]];  
	for (int i = 0; t[i]; i++) {
		int k = t[i] - 'a'; 
		for (int j = ans; j>=0; j-- ) {
			int p,q; 
			find_next(dp[j][0],dp[j][1],k,p,q);
			//printf("%d %d %c %d %d\n" , dp[j][0] , dp[j][1] , k+'a' , p , q ); 
			if ( p == -1 ) continue; 
			if ( j == ans ) { dp[++ans][0] = p; dp[ans][1] = q;  }
			else if ( p<dp[j+1][0] || p == dp[j+1][0] && q < dp[j+1][1] )
				dp[j+1][0] = p , dp[j+1][1] = q; 
		}
	}
	printf("%d\n" , ans ); 
	return 0; 
}
