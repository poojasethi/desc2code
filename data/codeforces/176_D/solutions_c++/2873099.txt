#include <algorithm> 
#include <iostream> 
#include <cstdio> 
#include <cmath> 
#include <cstdlib> 
#include <string> 
#include <cstring> 
#include <ctime> 
using namespace std;
const int maxn=1111111,
    oo=2000000000;
char s[maxn];
int nx[maxn][26],st[2100];
int d[2100][2100][2],a[2100],li[2100],xx[26];
int main()
{
    //freopen("AC.in","r",stdin);
    //freopen("AC.out","w",stdout);
	int i,j,k,m,n,l,x,y,tot;
	scanf("%d",&n);
	memset(nx,-1,sizeof nx);
	tot=0;
	for (i=0;i<n;i++)
	{
		st[i]=tot;
		scanf("%s",s);
		l=strlen(s);
		tot+=l;
		li[i]=l;
		for (j=l-1;j>=0;j--)
		{
			memcpy(nx[tot-(l-j)],nx[tot-(l-j)+1],sizeof nx[tot-(l-j)]);
			nx[tot-(l-j)][s[j]-'a']=j;
		}
	}
	scanf("%d",&m);
	for (i=0;i<m;i++)
	{
		scanf("%d",&a[i]);
		a[i]--;
	}
	scanf("%s",s);
	l=strlen(s);
	for (i=0;i<=l;i++)
		for (j=0;j<=l;j++)
		{
			d[i][j][0]=oo;
			d[i][j][1]=oo;
		}
	d[0][0][0]=0;
	d[0][0][1]=0;
	for (i=0;i<l;i++)
		for (j=0;j<l;j++)
			if (d[i][j][0]!=oo)
			{
				if ((d[i][j][0]<d[i+1][j][0])||
					((d[i][j][0]==d[i+1][j][0])&&(d[i][j][1]<d[i+1][j][1])))
				{
					d[i+1][j][0]=d[i][j][0];
					d[i+1][j][1]=d[i][j][1];
				}
				x=d[i][j][0];
				y=d[i][j][1];
				while ((x<m)&&(nx[st[a[x]]+y][s[i]-'a']==-1))
				{
					x++;
					y=0;
				}
				if (x<m)
				{
					y=nx[st[a[x]]+y][s[i]-'a'];
					y++;
					if (y==li[a[x]])
					{
						x++;
						y=0;
					}
					if ((x<d[i+1][j+1][0])||
						((x==d[i+1][j+1][0])&&(y<d[i+1][j+1][1])))
					{
						d[i+1][j+1][0]=x;
						d[i+1][j+1][1]=y;
					}
				}
			}
	for (i=l;i>=0;i--)
		if (d[l][i][0]!=oo)
		{
			printf("%d\n",i);
			break;
		}
	return 0;
}
