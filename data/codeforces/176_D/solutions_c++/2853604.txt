#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
const int u=2010,w=1002001;
int a[u],b[u],g[w][26],v[u][26],p[w],next[u][26],f[u][u],d[u][u];
char s[w];
int n,m,i,j,k,l;
int main()
{
	cin>>n;
	for(i=1;i<=n;i++)
	{
		scanf("%s",s+1);
		l=strlen(s+1);
		for(j=l;j;j--)
		{
			for(k=0;k<26;k++) g[m+j][k]=g[m+j+1][k];
			g[m+j][s[j]-'a']=j+1;
			v[i][s[j]-'a']=j+1;
			p[m+j]=i;
		}
		b[i]=m,m+=l+1;
	}
	cin>>m;
	for(i=1;i<=m;i++) scanf("%d",&a[i]);
	for(i=m-1;i>=0;i--)
		for(j=0;j<26;j++)
			next[i][j]=v[a[i+1]][j]?i+1:next[i+1][j];
	scanf("%s",s+1);
	n=strlen(s+1);
	memset(f,0x3f,sizeof(f));
	memset(d,0x3f,sizeof(d));
	f[0][0]=d[0][0]=0;
	for(i=1;i<=n;i++)
		for(j=0;j<i;j++)
			if((l=d[i-1][j],k=f[i-1][j])!=0x3f3f3f3f)
			{
				if(k<f[i][j]||k==f[i][j]&&l<d[i][j]) f[i][j]=k,d[i][j]=l;
				if(l=g[b[a[k]]+l][s[i]-'a'])
				{
					if(k<f[i][j+1]||k==f[i][j+1]&&l<d[i][j+1])
						f[i][j+1]=k,d[i][j+1]=l;
				}
				else if(k=next[k][s[i]-'a'])
				{
					l=v[a[k]][s[i]-'a'];
					if(k<f[i][j+1]||k==f[i][j+1]&&l<d[i][j+1])
						f[i][j+1]=k,d[i][j+1]=l;
				}
			}
	for(i=n;i;i--)
		if(f[n][i]!=0x3f3f3f3f) break;
	cout<<i<<endl;
	return 0;
}