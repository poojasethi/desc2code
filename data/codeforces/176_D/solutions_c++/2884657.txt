#include <cstdio>
#include <iostream>
using namespace std;
int n,m,i,j,k,ans,now,x,y,next[1010001][27],ne[2001][27],f[2001],s[2001],len[2001],a[1000001],p[2001],f1[2001],o;
char ch;
int hs(int x,int y)
{
	if (x==-1) return y;
	if (y==-1) return x;
	if (x<y) return x;else return y;
}
int hs1(int x,int y)
{
	return s[x-1]+y;
}
int hs2(int x,int y)
{
	return s[x-1]+x+y;
}
int main()
{
	scanf("%d",&n);getchar();
	for (i=1;i<=n;++i)
	{
		for (ch=getchar();ch>='a'&&ch<='z';ch=getchar())
		++len[i],a[hs1(i,len[i])]=ch-96;
		s[i]=s[i-1]+len[i];
		for (k=1;k<=26;++k) next[hs2(i,len[i])][k]=-1;
		for (j=len[i]-1;j>=0;--j)
		{
			for (k=1;k<=26;++k) next[hs2(i,j)][k]=next[hs2(i,j+1)][k];
			next[hs2(i,j)][a[hs1(i,j+1)]]=j+1;
		}
	}
	scanf("%d",&m);
	for (i=1;i<=m;++i) scanf("%d",&p[i]);
	for (k=1;k<=26;++k) ne[m][k]=-1;
	for (i=m-1;i>0;--i)
	{
		for (k=1;k<=26;++k) if (next[hs2(p[i+1],0)][k]>-1)
		ne[i][k]=len[p[i]]+next[hs2(p[i+1],0)][k]; else ne[i][k]=-1;
		for (k=1;k<=26;++k) if ((ne[i+1][k]>-1)&&(ne[i][k]==-1))
		ne[i][k]=len[p[i]]+ne[i+1][k];
	}
	getchar();
	for (ch=getchar();ch>='a'&&ch<='z';ch=getchar())
	{
		now=ch-96;++ans;
		for (i=0;i<=ans-1;++i) f[i]=f1[i];f[ans]=-1;
		for (i=1;i<=ans;++i)
		{
			x=f1[i-1];if (x==-1) continue;y=0;
			for (j=1;x>len[p[j]];x-=len[p[j]],y+=len[p[j]],++j);
			o=hs(next[hs2(p[j],x)][now],ne[j][now]);
			if (o>-1)
			{
				y+=o;if ((f[i]==-1)||(f[i]>y)) f[i]=y;
			}
		}
		if (f[ans]==-1) --ans;
		for (i=0;i<=ans;++i) f1[i]=f[i];
	}
	printf("%d\n",ans);
}
