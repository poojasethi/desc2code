#include<cstdio>
#include<cstring>
#include<vector>
#include<utility>
using namespace std;
#define fs first
#define sc second
#define ht return 0
struct pk{
	int nxt[26];
};
vector<pk> v[2002],w;
char s[1000002];
pair<int,int> ans[2002],now;
int a[2002];
int main(){
	int n,i,j,len,m;
//	freopen("176d.in","r",stdin);
//	freopen("176d.out","w",stdout);
	scanf("%d",&n);
	for (i=0;i<n;i++){
		scanf("%s",s);
		len=strlen(s);
		for (v[i].resize(len+1),j=0;j<26;j++) v[i][len].nxt[j]=len;
		for (j=len-1;j>=0;j--){
			v[i][j]=v[i][j+1];
			v[i][j].nxt[s[j]-'a']=j;
		}
	}
	for (scanf("%d",&m),i=0;i<m;i++){
		scanf("%d",a+i);
		a[i]--;
	}
	for (w.resize(m+1),i=0;i<26;i++) w[m].nxt[i]=m;
	for (i=m-1;i>=0;i--) for (j=0;j<26;j++)
		w[i].nxt[j]=v[a[i]][0].nxt[j]==v[a[i]].size()-1?w[i+1].nxt[j]:i;
	scanf("%s",s);
	len=strlen(s);
	for (ans[0]=make_pair(0,-1),i=1;i<=len;i++) ans[i]=make_pair(m,-1);
	for (i=0;i<len;i++) for (j=i+1;j;j--) if (ans[j-1].fs!=m){
		now=ans[j-1];
		now.sc=v[a[now.fs]][now.sc+1].nxt[s[i]-'a'];
		if (now.sc==v[a[now.fs]].size()-1){
			now.fs=w[now.fs+1].nxt[s[i]-'a'];
			now.sc=now.fs!=m?v[a[now.fs]][0].nxt[s[i]-'a']:-1;
		}
		if (now<ans[j]) ans[j]=now;
	}
	for (i=len;ans[i].fs==m;i--);
	printf("%d\n",i);
	return 0;
}
