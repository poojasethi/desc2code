#include<bits/stdc++.h>
using namespace std;

int n,m,l,tot,ans,inf=2147483647;
int c[2010][2],f[1000010][27],next[2010][27],d[2010],g[2010][2010];
char a[1000010],b[1000010];

int calc(int i,char ch)
{int j;
 if(i==inf) return inf;
 j=i%1000001;
 i=i/1000001;
 if(i!=0 && j!=c[d[i]][1]-c[d[i]][0]+1 && f[c[d[i]][0]+j][ch-96])
 	return i*1000001+f[c[d[i]][0]+j][ch-96]-c[d[i]][0]+1;
 else if(next[i][ch-96])
 	return next[i][ch-96]*1000001+f[c[d[next[i][ch-96]]][0]][ch-96]-c[d[next[i][ch-96]]][0]+1;
 else
 	return inf;	
}

int main()
{int i,j,k;
 
 scanf("%d",&n);
 for(i=1;i<=n;i++)
 {	scanf("%s",b+1);
 	l=strlen(b+1);
 	c[i][0]=tot+1;
 	c[i][1]=tot+l;
 	for(j=tot+1;j<=tot+l;j++)
 		a[j]=b[j-tot];
 	tot+=l;
 	for(j=tot;j>=tot-l+1;j--)
 	{	for(k=1;k<=26;k++)
 			f[j][k]=f[j+1][k];
 		f[j][a[j]-96]=j;
	}
 }
 scanf("%d",&m);
 for(i=1;i<=m;i++)
 	scanf("%d",&d[i]);
 for(i=m-1;i>=0;i--)
	for(j=1;j<=26;j++)
 		if(f[c[d[i+1]][0]][j]) 
			next[i][j]=i+1;
		else
			next[i][j]=next[i+1][j];							
 scanf("%s",b+1);
 l=strlen(b+1);
 for(j=1;j<=l;j++) g[0][j]=inf;
 for(i=1;i<=l;i++)
 	for(j=1;j<=l;j++)
		g[i][j]=min(g[i-1][j],calc(g[i-1][j-1],b[i]));
 for(i=l;i>=1;i--)
 	if(g[l][i]!=inf)
	{	ans=i;
		break;
	}
 printf("%d\n",ans);
 return 0;
}