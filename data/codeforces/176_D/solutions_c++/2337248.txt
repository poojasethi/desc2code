#include<cstdio>
#include<cstring>
#define fo(i,a,b) for(i=a;i<=b;++i)
#define fd(i,a,b) for(i=a;i>=b;--i)
const int mn=2010,mm=1010000;
int n,m,i,j,k,d,len;
int la[mm][30],ne[mn][30],s[mn],l[mn];
int c[mn],f[mn],g[mn],F,G;
char st[mm];
void calc(int v,int i,int j,int&x,int&y)
{
    int k=c[i];
    if(j==l[k]||la[s[k]+j+1][v]==0)
    {
        x=ne[i+1][v],y=la[s[c[x]]+1][v]-s[c[x]];
        return;
    }
    x=i,y=la[s[k]+j+1][v]-s[k];
}
int main()
{
    scanf("%d",&n);
    fo(i,1,n)
    {
        scanf("%s",st+1);
        l[i]=strlen(st+1);
        s[i+1]=s[i]+l[i];
        fd(j,l[i],1)
        {
            k=s[i]+j;
            fo(d,0,25)la[k][d]=la[k+1][d];
            la[k][st[j]-97]=s[i]+j;
        }
    }
    scanf("%d",&m);
    fo(i,1,m)scanf("%d",c+i);
    fo(i,0,25)ne[m+1][i]=m+1;
    d=0;
    fd(i,m,0)
    {
        k=c[i];
        fo(j,0,25)
            if(la[s[k]+1][j]==0)ne[i][j]=ne[i+1][j];else ne[i][j]=i;
    }
    scanf("%s",st+1);
    len=strlen(st+1);
    fo(i,1,len)f[i]=m+1;
    fo(j,1,len)
    {
        fd(i,d,0)
        {
            calc(st[j]-97,f[i],g[i],F,G);
            if(F>f[i+1]||(F==f[i+1]&&G>g[i+1]))continue;
            f[i+1]=F,g[i+1]=G;
        }
        if(f[d+1]!=m+1)++d;
    }
    printf("%d\n",d);
    return 0;
}