#include<cstdio>
#include<cstring>
const int N=2005,M=N*500;
int U[M][26],to[N][26],o[26],w[N],id[N],f[N],g[N],n,m,L,H,x,y;
char s[M];
int find(char c,int x,int y,int &f,int &g)
{
    if (U[w[id[x]]+y][c]) f=x,g=U[w[id[x]]+y][c];
    else f=to[x][c],g=U[w[id[f]]][c];
}
int main()
{
    scanf("%d",&n);
    for (int i=1;i<=n;i++,memset(o,0,sizeof(o))){
        scanf("%s",s+1),L=strlen(s+1),w[i+1]=w[i]+L+1;
        for (int j=L;j>=0;j--) memcpy(U[w[i]+j],o,sizeof(o)),j?o[s[j]-97]=j:0;
        }
    scanf("%d",&m); for (int i=1;i<=m;i++) scanf("%d",&id[i]);
    for (int i=m;i;i--){
        memcpy(to[i],o,sizeof(o));
        for (int j=0;j<26;j++) if (U[w[id[i]]][j]) o[j]=i;
        }
    scanf("%s",s),n=strlen(s),f[0]=1;
    for (int i=0;i<n;i++,f[H+1]?H++:0) for (int j=H;j>=0;j--){
        find(s[i]-97,f[j],g[j],x,y);
        if (x && (!f[j+1] || x*M+y<f[j+1]*M+g[j+1])) f[j+1]=x,g[j+1]=y;
        }
    printf("%d\n",H); return 0;
}