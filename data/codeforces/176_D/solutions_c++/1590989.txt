#include<cstdio>
#include<cstring>
const int N=2205,LEN=1010005;
int n,M,m,now;
int a[N][26],b[LEN][26];
int w[N],s[N],f[N],q[N],e[N];
int c[LEN];
char ss[LEN];
int main()
{
	//pre---------------------------------
	scanf("%d",&n); w[0]=0; now=0;
	for (int i=1;i<=n;i++){
		scanf("%s",ss); int len=strlen(ss);
		for (int j=0;j<len;j++) c[++now]=ss[j]-'a';
		w[i]=now;
		}
	for (int j=0;j<26;j++) b[now+1][j]=-1;
	for (int i=now;i;i--){
		for (int j=0;j<26;j++) b[i][j]=b[i+1][j];
		b[i][c[i]]=i;
		}
	scanf("%d",&M); s[0]=0;
	for (int i=1;i<=M;i++){
		int x; scanf("%d",&x);
		q[i]=x; s[i]=s[i-1]-w[x-1]+w[x];
		}
	for (int j=0;j<26;++j) a[M+1][j]=-1;
	for (int i=M;i>=1;--i){
		for (int j=0;j<26;++j) a[i][j]=a[i+1][j]; int x=q[i];
		for (int j=0;j<26;++j)
			if (b[w[x-1]+1][j]!=-1 && b[w[x-1]+1][j]<=w[x])
				a[i][j]=s[i-1]+b[w[x-1]+1][j]-w[x-1];
		}
	//work---------------------------------
	scanf("%s",ss); m=strlen(ss);
	for (int i=1;i<=m;i++) e[i]=ss[i-1]-'a';
	for (int i=1;i<=m;i++) f[i]=-1; f[0]=0;
	for (int i=1;i<=m;i++){
		int p=e[i];
		for (int j=i-1;j>=0;j--) if (f[j]!=-1){
			int x=f[j],l=0,r=M;
			while (l<r){
				int mid=(l+r)/2;
				if (s[mid]>=x) r=mid; else l=mid+1;
				}
			int len=-1,v=x-s[l-1],now=q[l];
			if (l>0 && b[w[now-1]+v+1][p]!=-1
					&& b[w[now-1]+v+1][p]<=w[now])
				len=b[w[now-1]+v+1][p]-w[now-1]-v;
			else len=a[l+1][p]-x;
			if (len>0 && (f[j+1]==-1 || f[j+1]>x+len)) f[j+1]=x+len;
			}
		}
	//prt---------------------------------
	for (int j=m;j>=0;j--) if (f[j]!=-1){printf("%d\n",j); return 0;}
}
