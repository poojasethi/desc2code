#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
using namespace std;

typedef pair<int, int> PII;
const int maxl = 1000005, maxn = 2005;
int next[maxl][26], next1[maxn][26];
int be[maxn], ed[maxn], mask[maxn], v[maxn];
char st[maxl], st1[maxn];
PII f[maxn][maxn];
int n, m, len, tot;

int main() {
    int i, j, x, y, t, ans; ans = 0;
    scanf("%d", &n);
    for (i = 1; i <= n; ++i) {
        be[i] = tot + 1;
        scanf("%s", st + be[i]);
        tot += strlen(st + be[i]);
        ed[i] = tot;
    }
    for (j = 0; j < 26; ++j) next[tot + 1][j] = tot + 1;
    for (i = tot; i >= 1; --i)
        for (j = 0; j < 26; ++j)
            next[i][j] = (st[i] == 'a' + j) ? i : next[i + 1][j];
    for (i = 1; i <= n; ++i)
        for (j = be[i]; j <= ed[i]; ++j)
            mask[i] |= 1 << (st[j] - 'a');
    scanf("%d", &m);
    for (i = 1; i <= m; ++i) scanf("%d", v + i);
    for (j = 0; j < 26; ++j) next1[m + 1][j] = m + 1;
    for (i = m; i >= 0; --i)
        for (j = 0; j < 26; ++j)
            next1[i][j] = (mask[v[i]] & (1 << j)) ? i : next1[i + 1][j];
    scanf("%s", st1 + 1); len = strlen(st1 + 1);
    for (i = 1; i <= len; ++i) f[i][0] = PII(m + 1, tot + 1);
    for (i = 1; i <= len; ++i)
        for (j = 1; j <= len; ++j) {
            f[i][j] = f[i][j - 1]; t = st1[j] - 'a';
            x = f[i - 1][j - 1].first; y = f[i - 1][j - 1].second;
            if (x > m) continue;
            if (next[y + 1][t] > ed[v[x]]) {
                x = next1[x + 1][t]; if (x > m) continue;
                f[i][j] = min(f[i][j], PII(x, next[be[v[x]]][t]));
            } else f[i][j] = min(f[i][j], PII(x, next[y + 1][t]));
            if (f[i][j].second <= tot) ans = max(ans, i);
        }
    printf("%d\n", ans);
    return 0;
}
            
