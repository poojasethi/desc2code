#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <vector>
#include <cstring>
using namespace std;
long long int END = 2002000000;
char str[1000001],s[2005];
int b[1000001],first[2005][26],cur[26],m,n,t[2005],f[2005][2005]; 
int next[1000005][26],start[2005]; int next0[26][1000001];
void pre(int num)
{
  int i,j;
  for(i=0;str[i]!='\0';i++)
    b[i] = str[i]-'a';
  memset(cur,-1,sizeof(cur));
  for(i--;i>=0;i--)
    {
      for(j=0;j<26;j++)
	next0[j][i] = cur[j];
      cur[b[i]] = i;
    }
  for(j=0;j<26;j++)
    first[num][j] = cur[j];
  for(i=0;str[i]!='\0';i++)
    for(j=0;j<26;j++)
      next[start[num]+i][j] = next0[j][i];
  start[num+1] = start[num]+i;
}
int find_next(int pos,int c)
{
  int num = pos/1000001;
  int p = pos%1000001;
  if(next[start[t[num]]+p][c] != -1)
    return num*1000001+next[start[t[num]]+p][c];
  if(num == m) return END; num++;
  while(first[t[num]][c] == -1)
    {
      if(num == m)
	return END;
      num++;
    }
  return num*1000001+first[t[num]][c];
}
int solve()
{
  int p,len,slen = strlen(s+1);
  for(p=0;p<=slen;p++)
    for(len=0;len<=slen;len++)
      f[p][len] = END;
  f[0][0] = 1000001;
  for(p=1;p<=slen;p++)
    if(first[t[1]][s[p]-'a'] == 0)
      f[p][1] = 1000001;
  for(p=0;p+1<=slen;p++)
    for(len=0;len<=slen;len++)
      if(f[p][len] != END)
      {
	f[p+1][len+1] = min(f[p+1][len+1],find_next(f[p][len],s[p+1]-'a'));
	f[p+1][len] = min(f[p+1][len],f[p][len]);
      }
  for(len=slen;len>=0;len--)
    if(f[slen][len] < END)
      return len;
  return 0;
}
int main()
{
  //freopen("d.in","r",stdin);
  //freopen("d.out","w",stdout);
  scanf("%d",&n);
  int i; 
  for(i=1;i<=n;i++){
    scanf("%s",str);pre(i);}
  scanf("%d",&m);
  for(i=1;i<=m;i++)
    scanf("%d",&t[i]);
  scanf("%s",s+1);
  printf("%d\n",solve());
}
