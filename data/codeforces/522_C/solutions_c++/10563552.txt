#include<iostream>
#include<math.h>
#include<algorithm>
#include<stdio.h>
#include<map>
#include<vector>
#include<set>
#define F first
#define S second
#define P system("PAUSE");
#define H return 0;
#define pb push_back
using namespace std;
const long long A=100000000000000LL,N=100228;

char e[N];
long long i,j,t[N],n,rt,m,po,to,p[2],koko,a[N],k[N],b[N];

int main(){
	cin>>koko;
	while(koko--){
		cin>>n>>m;n--;
		for(i=0;i<m;i++)cin>>a[i];
		po=rt=A;p[0]=p[1]=0;
		for(i=0;i<n;i++){
			cin>>b[i]>>k[i],b[i]--;
			if(k[i])po=min(po,i);
			if(b[i]==-1){
				p[0]++;
				if(po==A)p[1]++;	
			}else a[b[i]]--;
		}
		for(i=0;i<m;i++)e[i]='N',t[i]=0;
		if(po==A){
			for(i=0;i<m;i++)if(a[i]<=p[0])e[i]='Y';
		}else{
			for(i=po;i<n;i++)if(b[i]>=0)t[b[i]]=1;
			for(i=0;i<m;i++)if(!t[i] && p[1]>=a[i])e[i]='Y',rt=min(rt,a[i]);
			if(rt!=A){
				to=p[0]-rt;
				for(i=0;i<m;i++)if(a[i]<=to)e[i]='Y';
			}
		}
		for(i=0;i<m;i++)cout<<e[i];cout<<"\n";	
	}	
}
