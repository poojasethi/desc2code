#include <cstdlib>
#include <cstdio>
#include <algorithm>
#include <vector>
#include <queue>
#include <cmath>
#include <stack>
#include <map>
#include <set>
#include <deque>
#include <cstring>
#include <functional>
#include <climits>
#include <list>
#include <ctime>
 
#define F1(x,y,z) for(int x=y;x<z;x++)
#define F2(x,y,z) for(int x=y;x<=z;x++)
#define F3(x,y,z) for(int x=y;x>z;x--)
#define F4(x,y,z) for(int x=y;x>=z;x--)
#define pb push_back
#define LL long long
 
#define MAX 105
#define AMAX 55
#define MOD 1000000007

#define f(c,d) ((1<<(c))*(d))
#define zs za.size()
 
using namespace std;

bool debug=0;

struct w{
	LL a,b,c,d;
};

int n,ta;
vector<int> prime;
bool ok;
int x[MAX],y[MAX];
map<int,pair<int,int> > z[MAX];
map<int,pair<int,int> >::iterator it,itt;
vector<int> za;
vector<LL> zb[MAX],zc[MAX];
w pa,pb;
LL ans=1;
LL tb,tc,td;

LL ff(LL a, LL b, LL &x, LL &y){
    if(a%b==0){
        x=0;
        y=1;
        return b;
    }
	LL xx,yy;
    LL re=ff(b,a%b,xx,yy);
    x=yy;
    y=xx-yy*(a/b);
    return re;
}

LL gcd(LL a,LL b){
	if(b==0)return a;
	return gcd(b,a%b);
}

void f1(LL ba,LL ca,LL bb,LL cb){
	if(pa.a!=-1&&pa.c!=-1){
		tb=ca*pa.b-cb*pa.d;
		tc=-ca*pa.a-ba+cb*pa.c+bb;
		//tb*k=tc
		if(tb==0){
			if(tc==0)pb=pa;
			else pb.a=-2;
		}else if(tc%tb!=0)pb.a=-2;
		else{
			tc/=tb;
			pb.a=pa.a+pa.b*tc;
			pb.c=pa.c+pa.d*tc;
			pb.b=pb.d=0;
		}
	}else if(pa.a!=-1){
		tb=ca*pa.b;
		tc=ca*pa.a+ba-bb;
		//cb*y-tb*k=tc
		if(cb==0&&tb==0){
			if(tc==0)pb=pa;
			else pb.a=-2;
		}else if(cb==0){
			if(-tc<0||(-tc)%tb!=0)pb.a=-2;
			else{
				pb.c=-1;
				pb.a=(-tc)/tb;
				pb.b=0;
			}
		}else if(tb==0){
			if(tc<0||tc%cb!=0)pb.a=-2;
			else pb=(w){pa.a,pa.b,tc/cb,0};
		}else{
			LL xx,yy,xxx,yyy;
			td=ff(cb,-tb,xx,yy);
			if(tc==0){
				td=abs(td);
				pb=(w){pa.a,pb.b*cb/td,0,tb/td};
			}else if(tc%td!=0)pb.a=-2;
			else{
				tc/=td;
				xx*=tc;
				xxx=tb/td;
				yy*=tc;
				yyy=cb/td;
				if(xxx<0){
					xxx*=-1;
					yyy*=-1;
				}
				LL tt=max(xx>=0?xx/xxx:(-xx-1)/xxx+1,yy>=0?yy/yyy:(-yy-1)/yyy+1);
				xx+=xxx*tt;
				yy+=yyy*tt;
				pb=(w){pa.a+pa.b*yy,pa.b*yyy,xx,xxx};
			}
		}
	}else if(pa.c!=-1){
		tb=cb*pa.d;
		tc=cb*pa.c+bb-ba;
		//ca*x-tb*k=tc
		if(ca==0&&tb==0){
			if(tc==0)pb=pa;
			else pb.a=-2;
		}else if(ca==0){
			if(-tc<0||(-tc)%tb!=0)pb.a=-2;
			else{
				pb.a=-1;
				pb.c=(-tc)/tb;
				pb.d=0;
			}
		}else if(tb==0){
			if(tc<0||tc%ca!=0)pb.a=-2;
			else pb=(w){tc/ca,0,pa.c,pa.d};
		}else{
			LL xx,yy,xxx,yyy;
			td=ff(ca,-tb,xx,yy);
			if(tc==0){
				td=abs(td);
				pb=(w){0,tb/td,pa.c,pb.d*cb/td};
			}else if(tc%td!=0)pb.a=-2;
			else{
				tc/=td;
				xx*=tc;
				xxx=tb/td;
				yy*=tc;
				yyy=ca/td;
				if(xxx<0){
					xxx*=-1;
					yyy*=-1;
				}
				LL tt=max(xx>=0?xx/xxx:(-xx-1)/xxx+1,yy>=0?yy/yyy:(-yy-1)/yyy+1);
				xx+=xxx*tt;
				yy+=yyy*tt;
				pb=(w){xx,xxx,pa.c+pa.d*yy,pa.c*yyy};
			}
		}
	}else{
		if(ca==0&&cb==0){
			if(ba==bb)pb=pa;
			else pb.a=-2;
		}else if(ca==0){
			tb=ba-bb;
			if(tb<0||tb%cb!=0)pb.a=-2;
			else{
				pb.a=-1;
				pb.c=tb/cb;
				pb.d=0;
			}
		}else if(cb==0){
			tb=bb-ba;
			if(tb<0||tb%ca!=0)pb.a=-2;
			else{
				pb.a=tb/ca;
				pb.b=0;
				pb.c=-1;
			}
		}else{
			tc=bb-ba;
			LL xx,yy,xxx,yyy;			
			td=ff(ca,-cb,xx,yy);
			//printf("! A %lld %lld\n",tc,td);
			if(tc==0)pb=(w){0,cb/td,0,ca/td};
			else if(tc%td!=0)pb.a=-2;
			else{
				//printf("! B %lld %lld\n",xx,yy);
				tc/=td;
				xx*=tc;
				xxx=cb/td;
				yy*=tc;
				yyy=ca/td;
				if(xxx<0){
					xxx*=-1;
					yyy*=-1;
				}
				//printf("! C %lld %lld %lld %lld\n",xx,xxx,yy,yyy);
				LL tt=max(xx>=0?-(xx/xxx):(-xx-1)/xxx+1,yy>=0?-(yy/yyy):(-yy-1)/yyy+1);
				xx+=xxx*tt;
				yy+=yyy*tt;
				pb=(w){xx,xxx,yy,yyy};
			}
		}
	}
}

LL po(int b,LL p){
	if(p==0)return 1;
	if(p&1)return po(b,p-1)*b%MOD;
	LL t=po(b,p/2);
	return t*t%MOD;
}

int main(){
	F1(a,2,1000000){
		ok=1;
		F1(b,0,prime.size()){
			if(prime[b]*prime[b]>a)break;
			if(a%prime[b]==0){
				ok=0;
				break;
			}
		}
		if(ok)prime.pb(a);
	}
	scanf("%d",&n);
	F1(a,0,n)scanf("%d%d",&x[a],&y[a]);
	F1(a,0,n){
		ok=1;
		F1(b,0,n){
			if(x[a]%x[b]!=0){
				ok=0;
				break;
			}
			tb=1;
			while(true){
				if(tb==x[a]/x[b])break;
				if(tb>x[a]/x[b]){
					ok=0;
					break;
				}
				tb*=y[b];
			}
		}
		if(ok){
			printf("%d\n",x[a]);
			if(debug)system("pause");
			return 0;
		}		
		ta=x[a];
		F1(b,0,prime.size()){
			if(prime[b]*prime[b]>ta)break;
			if(ta%prime[b]==0){
				it=z[a].insert(make_pair(prime[b],make_pair(0,0))).first;
				while(ta%prime[b]==0){
					it->second.first++;
					ta/=prime[b];
				}
			}
		}
		if(ta!=1)z[a].insert(make_pair(ta,make_pair(0,0))).first->second.first++;ta=x[a];
		ta=y[a];
		F1(b,0,prime.size()){
			if(prime[b]*prime[b]>ta)break;
			if(ta%prime[b]==0){
				it=z[a].insert(make_pair(prime[b],make_pair(0,0))).first;
				while(ta%prime[b]==0){
					it->second.second++;
					ta/=prime[b];
				}
			}
		}
		if(ta!=1)z[a].insert(make_pair(ta,make_pair(0,0))).first->second.second++;
	}
	F1(a,1,n){
		itt=z[a-1].begin();
		for(it=z[a].begin();it!=z[a].end();++it){
			if(itt==z[a-1].end()||it->first!=itt->first){
				printf("-1\n");
				if(debug)system("pause");
				return 0;
			}
			++itt;
		}
		if(itt!=z[a-1].end()){
			printf("-1\n");
			if(debug)system("pause");
			return 0;
		}
	}
	for(it=z[0].begin();it!=z[0].end();++it)za.pb(it->first);
	F1(a,0,n){
		it=z[a].begin();
		F1(b,0,zs){
			zb[a].pb(it->second.first);
			zc[a].pb(it->second.second);
			//printf("%d %lld %lld\n",za[b],zb[a][b],zc[a][b]);
			++it;
		}
	}
	F1(a,1,n){
		pa.a=pa.c=-1;
		F1(b,0,zs){
			//printf("a %d b %d\n",a,b);
			//printf("%lld %lld %lld %lld\n",zb[a-1][b],zc[a-1][b],zb[a][b],zc[a][b]);
			f1(zb[a-1][b],zc[a-1][b],zb[a][b],zc[a][b]);
			//printf(" %lld %lld %lld %lld\n",pb.a,pb.b,pb.c,pb.d);
			if(pb.a==-2){
				printf("-1\n");
				if(debug)system("pause");
				return 0;
			}
			pa=pb;
		}
		if(pa.c!=-1)F1(b,0,zs){
			zb[a][b]+=zc[a][b]*pa.c;
			zc[a][b]*=pa.d;
		}
	}
	F1(a,0,zs)ans=ans*po(za[a],zb[n-1][a])%MOD;
	printf("%I64d\n",ans);
	if(debug)system("pause");
    return 0;
}
