#include<bits/stdc++.h>

using namespace std;

#define mp make_pair
#define st first
#define nd second
#define pb push_back

int n,m,k,x,y,v,need,t,val,i;

bool H[100005];

vector<pair<int,int> > V[100005],T;

priority_queue<pair<int,pair<int,int> > , vector<pair<int,pair<int,int> > > , greater<pair<int,pair<int,int> > > > PQ;

int main(){

	cin>>n>>m>>k;

	for(i=1 ; i<=m ; i++){
		scanf("%d %d %d",&x,&y,&v);
		V[x].pb(mp(v,y));
		V[y].pb(mp(v,x));
	}

	for(i=1 ; i<=k ; i++){
		scanf("%d %d",&x,&y);
		T.pb(mp(y,x));
	}

	PQ.push(mp(0,mp(0,1)));

	while(!PQ.empty()){
		
		val=PQ.top().st;
		x=PQ.top().nd.nd;
		t=PQ.top().nd.st;

		PQ.pop();

		if(H[x])
			continue;

		H[x]=1;

		if(t)
			need++;

		for(i=0 ; i<V[x].size() ; i++)
			PQ.push(mp(val+V[x][i].st,mp(0,V[x][i].nd)));

		if(x==1)
			for(i=0 ; i<T.size() ; i++)
				PQ.push(mp(val+T[i].st,mp(1,T[i].nd)));
	}

	cout<<k-need;
	
	return 0;
}
