#include <iostream>
#include<bits/stdc++.h>
using namespace std;

#define mp make_pair

bool visited[100005];
vector<pair<int,int> > g[100005];

int main() {
    // your code goes here
    int n,m,x,y,c,k;
    
   scanf("%d%d%d",&n,&m,&k);
    
    for(int i=0;i<m;i++){
        scanf("%d%d%d",&x,&y,&c);
        g[x].push_back(mp(y,c));
        g[y].push_back(mp(x,c));
    }
    
    for(int i=0;i<=n;i++){
        visited[i]=0;
    }
    
    priority_queue<pair<long long,int> > q;
    
    for(int i=0;i<k;i++){
        scanf("%d%d",&x,&c);
        q.push(mp(-c,-x));
    }
    
    q.push(mp(0,1));
    int ans=0;
    
    while(!q.empty())
    {
        long long val=q.top().first;
        int u=q.top().second;
        
        if(u<0 && visited[u=-u])ans++;
        
        q.pop();
        if(visited[u])continue;
        visited[u]=1;
        
        for(int i=0;i<g[u].size();i++){
            int v=g[u][i].first;
            if(!visited[v]){
                q.push(mp(val-g[u][i].second,v));
            }
        }
    }

    printf("%d",ans);
    return 0;
}