#include<iostream>
#include<cstring>
#include<cstdio>
using namespace std;
#define prt(k) cout<<#k"="<<k<<" ";
#define ll long long
#define inf 0x3f3f3f3f
#define N 300333
#include<vector>
#define pb push_back
#define mp make_pair
int n,m,k;
int d[N];
#include<queue>
bool vis[N];
vector<int> to[N],dist[N];
int main()
{
    scanf("%d%d%d",&n,&m,&k);
    for(int i=0;i<m;i++)
    {
        int u,v,w;
        scanf("%d%d%d",&u,&v,&w);
        to[u].pb(v) ; dist[u].pb(w);
        to[v].pb(u) ; dist[v].pb(w);
    }
    priority_queue<pair<ll,int> > q;
    q.push(mp(0,1));
    for(int i=0;i<k;i++)
    {
        int s,y;
        scanf("%d%d",&s,&y);
        q.push(mp(-y,s-n));
    }
    int ans=0;
    memset(vis,0,sizeof(vis));
    while(!q.empty())
    {
        pair<ll,int> t=q.top(); q.pop();
        int u=t.second,w=t.first; 
        if(u<1)
        {
            u+=n;
            if(vis[u]) ++ans;
        }
        if(vis[u]) continue;
        vis[u]=1;
        for(int i=0;i<to[u].size();i++)
            q.push(mp(w-dist[u][i],to[u][i]));
    }
    cout<<ans<<endl;
}