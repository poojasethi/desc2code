#include <cstdio>
#include <iostream>
#include <cmath>
#include <algorithm>
#include <cstring>
#include <vector>
#include <queue>
#define pb push_back
#define mp make_pair
using namespace std;
typedef long long ll;
typedef pair<int,int>pii;
typedef pair<ll,int>pli;

int vis[100005];
int n,m,k,ans,dqx,x,v,y,z,w;
pli dq;
int main()
{
	vector<pii>g[100005];
	scanf("%d%d%d",&n,&m,&k);
	for (int i=1;i<=m;++i)
	{
		scanf("%d%d%d",&x,&y,&z);
		g[x].pb(mp(y,z));
		g[y].pb(mp(x,z));
	}
	priority_queue<pli>q;
	for (int i=1;i<=k;++i)
	{
		scanf("%d%d",&x,&w);
		q.push(mp(-w,-x));
	}
	q.push(mp(0,1));
	ans=0;
	memset(vis,0,sizeof(vis));
	while (q.size())
	{
		dq=q.top();
		q.pop();
		x=dq.second;
		dqx=dq.first;
		if (x<0&&(vis[x=-x])) ++ans;
		if (vis[x]) continue;
		vis[x]=1;
		for (int i=0;i<g[x].size();++i)
		{
			v=g[x][i].first;
			if (!vis[v]) q.push(mp(dqx-g[x][i].second,v));
		}
	}
	printf("%d\n",ans);
	return 0;
}
		  	 	   		 	 	     		  			  	