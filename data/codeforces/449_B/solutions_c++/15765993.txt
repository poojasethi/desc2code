#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
    int n,m,k;
    int s,y;
    int u,v,x;
int main() {
    int n,m,k;
    int s,y;
    int u,v,x;
    scanf("%d%d%d",&n,&m,&k);
    vector<pair<int,int> >g[n+1];
    priority_queue <pair<ll,int> > q;
    bool vis[n+1];
    for (int i=1;i<=n;i++) {
        vis[i]=false;
    }
    for (int i=0;i<m;i++){
        scanf("%d%d%d",&u,&v,&x);
        g[u].push_back (make_pair(v,x));
        g[v].push_back (make_pair(u,x));
    }

    for (int j=0;j<k;j++){
        scanf("%d%d",&s,&y);
        q.push(make_pair(-y,-s));
    }
    q.push(make_pair(0,1));
    int r=0;
    while (q.size()){
        int a = q.top().second;
        int w = q.top().first;
        q.pop();
        int b = abs(a);
        if (vis[b]){
            if (a<0) r++;
            continue;
        }
        vis[b] = true;
        for (int i=0;i<(int)g[b].size();i++){
            pair<int,int> c = g[b][i];
            if (vis[c.first]) continue;
            q.push(make_pair(w-c.second,c.first));
        }
    }
    printf ("%d\n",r);
    return 0;
}