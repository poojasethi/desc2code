#include <bits/stdc++.h>
#define INF 1000000000
using namespace std;

int n, m, k, a, b, c, dist[100005], jarak, x, y;
vector<pair<int,pair<int,int> > > adjlist[100005];
priority_queue<pair<int,pair<int,int> > > pq;

int main(){
	scanf("%d%d%d", &n, &m, &k);
	memset(dist, 0, sizeof dist);
	while(m--){
		scanf("%d%d%d", &a, &b, &c);
		adjlist[a].push_back(make_pair(b, make_pair(c, 0)));
		adjlist[b].push_back(make_pair(a, make_pair(c, 0)));
	}
	for(int i = 1 ; i <= k ; i++){
		scanf("%d%d", &a, &b);
		adjlist[1].push_back(make_pair(a, make_pair(b, i)));
	}
	pq.push(make_pair(0, make_pair(0, 1)));
	while(!pq.empty()){
		jarak = -pq.top().first;
		y = -pq.top().second.first;
		x = pq.top().second.second;
		pq.pop();
		if(dist[x]) continue;
		dist[x] = jarak;
		if(y) k--;
		for(int i = 0 ; i < adjlist[x].size(); i++){
				pq.push(make_pair(-(adjlist[x][i].second.first + jarak), make_pair(-adjlist[x][i].second.second, adjlist[x][i].first)));
		}
	}
	printf("%d\n", k);
}
