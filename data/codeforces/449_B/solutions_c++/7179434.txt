#include<bits/stdc++.h>
using namespace std;
#define lli long long int
#define mp make_pair
#define pb push_back
#define nd second
#define st first
#define N 100005

lli x,y,z,k,n,m,i,t,sp[N],hh[N],h[N],u;
priority_queue< pair< lli,pair <lli,lli> > > q;
vector< pair< lli,pair <lli,lli> > >v[500000];
int main(){
    cin >> n >> m >> k;
    for(i=0;i<m;i++){
        cin >> x >> y >> z;
        v[x].pb(mp(y,mp(0,z)));
        v[y].pb(mp(x,mp(0,z)));
    }
    
    for(i=1;i<=k;i++){
        cin >> x >> y;
        v[1].pb(mp(x,mp(i,y)));
    }
    q.push(mp(0,mp(0,1)));
    while(!q.empty()){
        t=-q.top().nd.st; y=-q.top().st; x=q.top().nd.nd; q.pop();
        if(h[x]) continue; if(t) k--;
        sp[x]=y; h[x]=1;
        u=v[x].size();
        for(i=0;i<u;i++)
            q.push(mp(-(sp[x]+v[x][i].nd.nd),mp(-v[x][i].nd.st,v[x][i].st)));
     }
    cout << k;
}    