#include <iostream>
#include <vector>
#include <queue>
#include <cstring>
#define mp make_pair
#define pb push_back
#define ff first
#define ss second

using namespace std;
vector<pair<int,long long> > adj[100005];
bool vis[100005];
int main()
{  ios_base::sync_with_stdio(0);
 int n, i, j, k, l, m;
 int res = 0;
 cin>>n>>m>>k;
 while(m--)
 {
 	int u, v;
	long long e;
	cin>>u>>v>>e;
	adj[u].pb(mp(v, e));
	adj[v].pb(mp(u, e));
 }
   priority_queue<pair<long long,int> > pq;
   pq.push(mp(0, 1));  
   m = k;
   while(k--)
   {
   	int u;
   	long long e;
   	cin>>u>>e;
   	pq.push(mp(-e, u - n));
   }
   while(!pq.empty()){
   	  int u = pq.top().second;
   	  long long dis = pq.top().first;
   	  pq.pop();
   	  if(u <= 0) {
   	  	  u += n;
   	  	  if(vis[u]) res++;
		 }
	  if(vis[u]) continue;
	  vis[u] = 1;
	  int sz = adj[u].size();
	  for(i = 0; i < sz; i++) {
	     int v = adj[u][i].first;
	     long long e = adj[u][i].second;
	     pq.push(mp(dis - e, v));
	  }
   }
   cout<<res<<endl;
	return 0;
} 