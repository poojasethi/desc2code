#include <bits/stdc++.h>
using namespace std;
//printf("%.7f\n", double value);

typedef long long ll;
int n,m,k;
vector<pair<int,ll> >  adj[100005];
ll dist[1000005];
int v[100005];

priority_queue<pair<ll,int> > pq;

int main () {
  for(int i=0; i<100005; i ++)
    dist[i] = 1e18;

  cin >> n >> m >> k;

  for(int i=0; i<m; i++) {
    int u, v, x;
    scanf("%d %d %d", &u,&v,&x);
    adj[u].push_back(make_pair(v,x));
    adj[v].push_back(make_pair(u,x));
  }

  int ret = 0;
  for(int i=0; i<k; i++) {
    int s,y;
    scanf("%d %d", &s , &y);
    pq.push(make_pair(-y,s-n));
  }

  dist[1] = 0;
  pq.push(make_pair(0,1));

  while(!pq.empty()) {
    ll cost  = -pq.top().first;
    int here = pq.top().second;

    pq.pop();
    if(here <= 0) {
      here += n;
      if(v[here]) ret ++;
    }

    if(v[here]) continue;
    v[here] = true;

    for(int i=0; i<adj[here].size(); i++) {
      int there = adj[here][i].first;
      ll nextDist = cost + adj[here][i].second;
      pq.push(make_pair(-nextDist, there));
    }
  }


  cout << ret << endl;
  return 0;
}