#include<cstdio>
#include<vector>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

typedef long long ll;

int n,val[100000];
vector<int> T[100000];

pair<ll,ll> dfs(int u,int pre){
	ll plus=0,minus=0;
	rep(i,T[u].size()){
		int v=T[u][i];
		if(v!=pre){
			pair<ll,ll> tmp=dfs(v,u);
			plus=max(plus,tmp.first);
			minus=max(minus,tmp.second);
		}
	}

	ll val2=val[u]+plus-minus;
	if(val2>0) minus+=val2;
	else       plus+=-val2;
	return make_pair(plus,minus);
}

int main(){
	scanf("%d",&n);
	rep(i,n-1){
		int u,v; scanf("%d%d",&u,&v); u--; v--;
		T[u].push_back(v);
		T[v].push_back(u);
	}
	rep(u,n) scanf("%d",val+u);

	pair<ll,ll> ans=dfs(0,-1);
	printf("%I64d\n",ans.first+ans.second);

	return 0;
}
