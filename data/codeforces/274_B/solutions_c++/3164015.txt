#include <cstdio>
#include <iostream>
#include <vector>
using namespace std;
const int MAXN=1000*100+10;
typedef long long ll;
typedef pair<ll,ll> P;
int n,m,x,y;
ll V[MAXN];
ll ans;
bool mark[MAXN];
vector <int> A[MAXN];
P dfs(int v)
{
	mark[v]=1;
	ll p=0,m=0;
	for(int i=0;i<A[v].size();i++)
		if(!mark[A[v][i]])
		{
			P tmp=dfs(A[v][i]);
			p=max(p,tmp.first);
			m=max(m,tmp.second);
		}
	V[v]+=p-m;
	if(V[v]>0)
		m+=V[v];
	else
		p+=-V[v];
//	cerr << v+1 << " " << V[v] << " " << p << " " << m << endl;
	return P(p,m);
}
int main()
{
	cin >> n;
	for(int i=0;i<n-1;i++)
	{
		scanf("%d%d",&x,&y);
		x--;
		y--;
		A[x].push_back(y);
		A[y].push_back(x);
	}
	for(int i=0;i<n;i++)
		cin >> V[i];
	P tmp=dfs(0);
	cout << tmp.first+tmp.second << endl;
	return 0;
}
