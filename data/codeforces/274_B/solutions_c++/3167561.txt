#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define int64 long long
using namespace std;
int i,j,k,l,n,m,head[120000],e[240000],next[240000],len,x,y,fa[120000];
int64 f0[120000],f1[120000],v[120000];
void dfs(int x){
	for(int i=head[x];i;i=next[i])if(e[i]!=fa[x]){
		fa[e[i]]=x;
		dfs(e[i]);
		f0[x]=min(f0[x],f0[e[i]]);
		f1[x]=max(f1[x],f1[e[i]]);
	}
	v[x]=v[x]+f0[x]+f1[x];
	if(v[x]>0)f0[x]-=v[x];
	else f1[x]-=v[x];
}	
int main(){
	scanf("%d",&n);
	for(i=1;i<n;++i){
		scanf("%d%d",&x,&y);
		next[++len]=head[x]; head[x]=len; e[len]=y;
		next[++len]=head[y]; head[y]=len; e[len]=x;
	}
	for(i=1;i<=n;++i)scanf("%I64d",&v[i]);
	dfs(1);
	printf("%I64d\n",f1[1]-f0[1]);
//s	system("pause");
}
