#include <iostream>
#include <algorithm>
#include <cstdio>
#include <cstring>
#include <cassert>
#include <string>
#define N 200009
using namespace std;
int n,k,cnt;
int father[N];
int refa(int x){
    if(father[x]==x)return x;
    else return father[x]=refa(father[x]);
}
void add(int a,int b){
    int fa=refa(a);
    int fb=refa(b);
    if(fa!=fb){
        cnt--;
        father[fb]=fa;
    }
}
int main()
{
    ios::sync_with_stdio(false);
    cin>>n>>k;
    for(int i=0;i<n*2+4;i++)father[i]=i;
    cnt=n*2+4;
    int a,b;char c[5];
    while(k--){
        cin>>a>>b>>c;
        a--;b--;
        int minx=abs(a-b);
        int maxx=min(a+b,2*(n-1)-a-b);
        if(c[0]=='o'){
            add(minx*2,(maxx+2)*2+1);
            add(minx*2+1,(maxx+2)*2);
        }else{
            add(minx*2,(maxx+2)*2);
            add(minx*2+1,(maxx+2)*2+1);
        }
    }
    for(int i=0;i<n+2;i++){
        if(refa(2*i)==refa(2*i+1)){
            puts("0");
            return 0;
        }
    }
    long long ans=1;
    cnt=(cnt-4)/2;
    assert(cnt>=0);
    while(cnt--){
        ans=(ans*2)%(1000000007LL);
    }
    cout<<ans<<endl;
    return 0;
}