#include <iostream>
#include <cstring>
#include <cstdio>
#include <vector>
#define maxn 100010
#define mod 1000000007
#define abs(x) ((x)<0?-(x):(x))

using namespace std;

struct Edge
{
    int v,c;
    Edge(int _v,int _c):v(_v),c(_c){}
};

vector<Edge> g[maxn];
char tmp[10];
int c[maxn];
int n,k,cnt;
bool flag;

void addedge(int a,int b,int c)
{
    g[a].push_back(Edge(b,c));
    g[b].push_back(Edge(a,c));
}

void build(int i,int j,int v)
{
    int d=min(min(i-1,j-1),min(n-i,n-j)),
        m=abs(i-j)+d+1,
        l=max(m-d-2,0),
        r=min(m+d  ,n);
    
    addedge(l,r,v);
}

void dfs(int u,int color)
{
    if(flag)return;
    if(c[u]+1)
    {
        if(c[u]!=color)flag=true;
        return;
    }
    
    c[u]=color;
    for(int i=0;i<g[u].size();i++)
        dfs(g[u][i].v,g[u][i].c ^ color);
}

int main()
{
    scanf("%d%d",&n,&k);
    for(int t=1,i,j,v;t<=k;t++)
    {
        scanf("%d%d%s",&i,&j,&tmp);
        v=(tmp[0]=='o');
        build(i,j,v);
    }
    
    memset(c,-1,sizeof(c));
    for(int i=0;i<=n;i++)if(c[i]==-1)
        dfs(i,0),++cnt;
    
    if(flag)
		printf("0\n");
	else
	{
	    int res=1;
    	for(cnt--;cnt;cnt--)
    		res=(res+res)%mod;
    	printf("%d\n",res);
    }
    
    return 0;
}
