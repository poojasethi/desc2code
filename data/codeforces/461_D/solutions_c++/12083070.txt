#include<stdio.h>
#include<algorithm>
#include<string.h>
#include<math.h>
using namespace std;
#define mod 1000000007
int father[200500],total;
int fa(int x){
    if(x!=father[x]) father[x]=fa(father[x]);
    return father[x];
}
void Union(int a,int b){
    int x,y;
    x=fa(a);
    y=fa(b);
    if(x!=y){
        total--;
        father[x]=y;
    }
}
int main()
{
    int n,m,x,y,i,j,flag;
    __int64 sum;
    char c[5];
    while(scanf("%d%d",&n,&m)!=EOF)
    {
        for(i=0;i<=(2*n+3);i++) father[i]=i;
        total=n*2;
        for(i=0;i<m;i++){
            scanf("%d%d%s",&x,&y,c);
            int s=(c[0]=='o');
            x--;y--;
            int f=abs(x-y),l=min(x+y,2*(n-1)-x-y);
            l+=2;
            Union(f*2,2*l+s);Union(f*2+1,2*l+(s^1));
        }
        flag=0;
        for(i=0;i<=n+1;i++){
            if(fa(i*2)==fa(i*2+1)) {flag=1;break;}
        }
        sum=1;
        if(flag) printf("0\n");
        else {
            for(i=1;i<=total/2;i++){
                sum=2*sum%mod;
            }
            printf("%I64d\n",sum);
        }
    }
}
