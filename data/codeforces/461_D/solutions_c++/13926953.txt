#include<cstring>
#include<cstdio>
#include<algorithm>
#include<cmath>
#define rep(i,a,b) for (int i=a;i<=b;++i)
#define dep(i,a,b) for (int i=a;i>=b;--i)
#define N 200005
#define M 1000000007
using namespace std;
int f[N],ans,n,m;typedef long long ll;ll res=1;
int get(int x) {return f[x]==x?x:f[x]=get(f[x]);}
void Union(int x,int y) {int p=get(x),q=get(y);if (p==q) return;ans--;f[p]=q;}
int main() {
	scanf("%d%d",&n,&m);ans=2*n;rep(i,0,(n+1)*2+1) f[i]=i;
	while (m--) {
		int i,j,l,r,k;char s[5];scanf("%d%d%s",&i,&j,s);k=s[0]=='o';i--;j--;
		l=abs(i-j);r=min(i+j,2*n-2-i-j);
		l-=2;if (l<0) l+=n+2;
		Union(l*2,r*2+k);Union(l*2+1,r*2+k^1);
	}
	rep(i,0,n+1)if (get(i*2+1)==get(i*2)) return puts("0"),0;
	rep(i,1,ans/2) res=res*2%M;
	printf("%I64d\n",res);
	return 0;
}
