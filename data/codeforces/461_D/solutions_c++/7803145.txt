/*
 * Author:  Yzcstc
 * Created Time:  2014年09月15日 星期一 22时04分00秒
 * File Name: d.cpp
 */
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cmath>
#include <algorithm>
#include <string>
#include <vector>
#include <stack>
#include <queue>
#include <set>
#include <utility>
#define M0(x) memset(x, 0, sizeof(x))
#define MP make_pair
#define PB push_back
#define Inf 0x3fffffff
#define eps 1e-8
#define pi acos(-1)
#define N 301010
#define M 1000000007
using namespace std;
int fa[N], n, m;

inline int find(const int k){
    return fa[k] == k ? k : fa[k] = find(fa[k]);
}

inline void merge(const int x,const int y, int& S){
    int fx = find(x), fy = find(y);
    if (fx == fy) return;
    fa[fx] = fy, S--;
}

void solve(){
    for (int i = 0; i < (n+2)<<1; ++i) fa[i] = i;
    int S = (n << 1), x, y, v, l, r;
    char s[15];
    for (int i = 0; i < m; ++i){
         scanf("%d%d%s", &x, &y, s), --x, --y;
         v = s[0] == 'o' ? 1 : 0;
         l = abs(y - x), r = min((n - 1) * 2 - x - y, x + y) + 2;
         if (v == 0)
                merge(l<<1, r<<1, S), merge(l<<1|1, r<<1|1, S);
         else
                merge(l<<1, r<<1|1, S), merge(l<<1|1, r<<1, S);
    }
    for (int i = 0; i < n+2; ++i) if (find(i<<1) == find(i<<1|1)) {
         puts("0");
         return;
    }
    int ans = 1;
    for (int i = 0; i < (S >> 1); ++i) ans = (ans<<1) % M;
    cout << ans << endl;
}

int main(){
//   freopen("a.in", "r", stdin);
//   freopen("a.out", "w", stdout);
   scanf("%d%d", &n, &m);
   solve();
   return 0;
}