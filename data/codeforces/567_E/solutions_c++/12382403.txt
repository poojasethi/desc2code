#include<bits/stdc++.h>
#define pb push_back
#define mp make_pair
#define ff first
#define ss second
#define all(a) a.begin(), a.end()
#define mod 1000000003
#define endl "\n"

using namespace std;
typedef long long LL;
typedef vector<int> VI;
typedef vector< vector<int> > VVI;
typedef pair< LL, LL > PII;

VI g[2][100010],w[2][100010];
LL cnt[2][100010];
vector< pair<PII,PII> > E;
LL d[2][100010],INF = (LL)(1e11);
int n,m,S,T;

void path(int s, int idx)
{
	for(int i=1; i<=n; i++) d[idx][i] = INF; cnt[idx][s] = 1;
	priority_queue< pair<PII,LL> > pq; pq.push(mp(mp(0,s),s));
	while(!pq.empty())
	{
		LL u,dist,p; u = pq.top().ff.ss; dist = -pq.top().ff.ff; p = pq.top().ss; pq.pop();
		if(dist > d[idx][u]) continue;
		if(dist == d[idx][u]) {cnt[idx][u] += cnt[idx][p]; if(cnt[idx][u] >= mod) cnt[idx][u] -= mod; continue;}
		cnt[idx][u] = cnt[idx][p]; d[idx][u] = dist;
		for(int i=0; i<g[idx][u].size(); i++)
		{
			int v = g[idx][u][i];
			if(d[idx][v] >= dist + w[idx][u][i])
				pq.push(mp(mp(-dist-w[idx][u][i],v),u));
		}
	}
}

int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);

	cin>>n>>m>>S>>T;
	for(int i=0; i<m; i++)
	{
		int x,y,l; cin>>x>>y>>l;
		g[0][x].pb(y); w[0][x].pb(l);
		g[1][y].pb(x); w[1][y].pb(l);
		E.pb(mp(mp(x,g[0][x].size()-1),mp(y,g[1][y].size()-1)));
	}
	path(S,0);
	path(T,1);
	//for(int i=1; i<=n; i++) cout<<i<<" "<<d[0][i]<<" "<<d[1][i]<<" "<<cnt[0][i]<<" "<<cnt[1][i]<<endl;
	for(int i=0; i<m; i++)
	{
		LL u,v,j,k,val;
		u = E[i].ff.ff; v = E[i].ss.ff;
		j = E[i].ff.ss; k = E[i].ss.ss;

		if(d[0][u] + d[1][v] + w[0][u][j] == d[0][T] && cnt[0][u]*cnt[1][v]%mod == cnt[0][T]) {cout<<"YES\n"; continue;}
		val = d[0][T]-1-d[0][u]-d[1][v];
		if(val>0) cout<<"CAN "<<w[0][u][j]-val<<endl;
		else cout<<"NO\n";
	}

	return 0;
}

