//In the Name of God
#include<vector>
#include<set>
#include<cstdio>
#define int long long
using namespace std;
const int M=1e9+13,inf=10001000010000010;
int n,m,v[100001],u[100001],w[100001],S,T,V,U,WW,dis[2][100001],a[2][100001],A;
vector<int> g[2][100001],W[2][100001],d[2][100001];
set<pair<int,int> > s;
bool mark[100001];
void dij(int k){
  dis[k][A]=0;
  s.insert(make_pair(dis[k][A],A));
  while(s.size()){
      V=s.begin()->second;
      s.erase(s.begin());
      for(int i=0;i<g[k][V].size();i++){
	  U=g[k][V][i];
	  WW=W[k][V][i];
	  if(dis[k][U]==dis[k][V]+WW)
	    d[k][U].push_back(V);
	  if(dis[k][U]>dis[k][V]+WW){
	      d[k][U].clear();
	      d[k][U].push_back(V);
	      s.erase(make_pair(dis[k][U],U));
	      dis[k][U]=dis[k][V]+WW;
	      s.insert(make_pair(dis[k][U],U));
	    }
	}
    }
}
inline int dfs(int x,int k){
  if(mark[x])
    return a[k][x];
  mark[x]=true;
  for(int i=0;i<d[k][x].size();a[k][x]+=dfs(d[k][x][i],k),i++);
  return a[k][x]=a[k][x]%M;
}
main(){
  scanf("%d%d%d%d",&n,&m,&S,&T);
  for(int i=1;i<=n;dis[0][i]=dis[1][i]=inf,i++);
  for(int i=0;i<m;i++){
      scanf("%d%d%d",v+i,u+i,w+i);
      g[0][v[i]].push_back(u[i]);
      g[1][u[i]].push_back(v[i]);
      W[0][v[i]].push_back(w[i]);
      W[1][u[i]].push_back(w[i]);
    }
  A=S;
  dij(0);
  A=T;
  dij(1);
  a[0][S]=a[1][T]=1;
  dfs(T,0);
  for(int i=1;i<=n;mark[i]=false,i++);
  dfs(S,1);
  for(int i=0;i<m;i++){
      if((a[1][S]==(a[1][u[i]]*a[0][v[i]])%M) && dis[0][v[i]]+dis[1][u[i]]+w[i]==dis[0][T])
	printf("YES\n");
      else if(dis[0][v[i]]+dis[1][u[i]]+1<dis[0][T])
	printf("CAN %d\n",dis[0][v[i]]+dis[1][u[i]]+w[i]-dis[0][T]+1);
      else
	printf("NO\n");
    }
  return 0;
}
