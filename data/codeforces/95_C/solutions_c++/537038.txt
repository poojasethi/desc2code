#include<stdio.h>
#include<queue>
#include<vector>
using namespace std;

priority_queue<pair<long long,int>,vector<pair<long long,int> >,greater<pair<long long,int> > > pq;
long long dis[1024];
vector<pair<int,int> > l[1024];
int n,m;

void sp(int s) {
	for(int i=0;i<n;i++) dis[i]=1000000000000000000LL;
	dis[s]=0;
	pq.push(make_pair(0,s));
	while(!pq.empty()) {
		long long d=pq.top().first;
		int x=pq.top().second;
		pq.pop();
		if (d!=dis[x]) continue;
		for(int i=0;i<l[x].size();i++) {
			int cur=l[x][i].first,dd=l[x][i].second;
			if (d+dd<dis[cur]) dis[cur]=d+dd,pq.push(make_pair(d+dd,cur));
		}
	}
}

int a[1024][1024];
int d[1024],c[1024],v[1024];

int main() {
	int x,y;
	scanf("%d %d",&n,&m);
	scanf("%d %d",&x,&y);
	x--,y--;
	for(int i=0;i<m;i++) {
		int ai,bi,wi;
		scanf("%d %d %d",&ai,&bi,&wi);
		ai--,bi--;
		l[ai].push_back(make_pair(bi,wi));
		l[bi].push_back(make_pair(ai,wi));
	}
	for(int i=0;i<n;i++) {
		scanf("%d %d",&d[i],&c[i]);
		sp(i);
		for(int j=0;j<n;j++) if (dis[j]<=d[i]) a[i][j]=1;
	}
	for(int i=0;i<n;i++) dis[i]=1000000000000000000LL;
	dis[x]=0;
	for(int i=0;i<n;i++) {
		int k=-1;
		for(int j=0;j<n;j++) if (!v[j] && (k<0 || dis[j]<dis[k])) k=j;
		v[k]=1;
		for(int j=0;j<n;j++) if (a[k][j] && dis[k]+c[k]<dis[j]) dis[j]=dis[k]+c[k];
	}
	if (dis[y]==1000000000000000000LL) puts("-1"); else printf("%I64d\n",dis[y]);
	return 0;
}