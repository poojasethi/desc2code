#include <stdio.h>
#include <string.h>
#include <algorithm>
#define maxn 200010
#define inf 100000000

using namespace std;

int *f[21];
int a[maxn];
int n,m;
int calc(int x,int y){
    for (int i=m;i;i--)
        if ((x&((1<<i)-1))==(y>>(m-i))) return i;
    return 0;
}
int main(){
    scanf("%d",&n);
    for (int i=0;i<n;i++){
        char buf[30];
        scanf("%s",buf);
        m=strlen(buf);
        for (int j=0;j<m;j++) a[i]=((a[i]<<1)|(buf[j]-'0'));
    }
    for (int i=0;i<=m;i++){
        f[i]=new int[1<<i];
        for (int j=0;j<(1<<i);j++) f[i][j]=m;
//      memset(f[i],0,sizeof(int)*(1<<i));
    }
    int tot=m;
    for (int i=1;i<n;i++){
        int lcp=calc(a[i-1],a[i]);
        tot+=m-lcp;
        int minv=m;
        for (int j=0;j<=m;j++) minv=min(minv,f[j][a[i]>>(m-j)]-j);
        minv+=lcp;
        for (int j=0;j<=m;j++){
            int k=(a[i-1]&((1<<j)-1));
            f[j][k]=min(f[j][k],minv);
        }
    }
    int minv=0;
    for (int i=0;i<=m;i++)
        for (int j=0;j<(1<<i);j++) minv=min(minv,f[i][j]);
    printf("%d\n",tot+minv);
    return 0;
}
