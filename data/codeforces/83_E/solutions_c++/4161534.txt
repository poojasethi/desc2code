#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<cstring>
#define INF 0x7ffffff
using namespace std;
const int MAXN=200005;
const int MAXL=22;
const int MAXK=(1<<23)+5;
int N,M,len,ans;
int f[MAXN];
int p[MAXN][MAXL];
int mx[MAXK],tmd;
int two[MAXL];
char ss[MAXL];
int ask(int x,int y)
{
	int i,suf=0,pre=0,mx=0;
	for(i=1;i<=len;i++)
	{
		suf=suf+two[i-1]*p[x][len-i+1];
		pre=pre*2+p[y][i];
		if(suf==pre)mx=i;
	}
	return mx;
}
int main()
{
	int i,j,pre,suf,tmp;
	scanf("%d",&N);
	for(i=1;i<=N;i++)
	{
		scanf("%s",ss);
		len=strlen(ss);
		p[i][0]=p[i][len+1]=1;
		for(j=1;j<=len;j++)
			p[i][j]=(ss[j-1]-'0');
	}
	ans=len*N;
	for(i=0;i<(1<<len+2);i++)
		mx[i]=-INF;
	for(i=1,two[0]=1;i<=len;i++)
		two[i]=two[i-1]*2;
	f[0]=0,mx[1]=0;
	for(i=1;i<N;i++)
	{
		for(j=0,pre=0;j<=len;j++)
		{
			pre=pre*2+p[i+1][j];
			f[i]=max(f[i],mx[pre]+j+tmd);
		}
		tmd+=ask(i,i+1),tmp=-tmd;
		mx[1]=max(mx[1],f[i]+tmp);
		for(j=len,suf=0;j>=1;j--)
		{
				suf=suf+two[len-j]*p[i][j];
				mx[suf+two[len-j+1]]=max(mx[suf+two[len-j+1]],f[i]+tmp);
		}
	}
	f[N]=mx[1]+tmd;
	printf("%d\n",ans-f[N]);
	return 0;
}
  	 	   			  			   	 	 	 	