#include<cstdio>
#include<cstdlib>
#include<iostream>
#include<cstring>
#include<algorithm>
#include<cmath>	

using namespace std;

#define INF 0x3f3f3f3f
#define LEN 200010

int n,a[LEN],m,f[21][1<<20];
char s[35];

void init()
{
	scanf("%d",&n);
	for(int i=1;i<=n;i++)
	{
		scanf("%s",s);
		m=strlen(s);
		for(int j=0;j<m;j++)
			a[i]=(a[i]<<1)+s[j]-'0';
	}
	for(int i=0;i<=m;i++)
		for(int j=0;j<(1<<m);j++)
			f[i][j]=INF;
	f[0][0]=0;
}

void work()
{
	int ans=m;
	for(int i=2;i<=n;i++)
	{
		int len;
		for(len=m;;len--)
			if((a[i-1]&((1<<len)-1))==a[i]>>(m-len)) 
				break;
		len=m-len;
		ans+=len;
		int anss=INF;
		for(int j=0;j<=m;j++)
			anss=min(anss,f[j][a[i]>>(m-j)]+m-j);
		for(int j=0;j<=m;j++)
			f[j][a[i-1]&((1<<j)-1)]=min(f[j][a[i-1]&((1<<j)-1)],anss-len);
	}
	int anss=0;
	for(int i=0;i<=m;i++)
		for(int j=0;j<(1<<m);j++)
			anss=min(anss,f[i][j]);
	printf("%d\n",ans+anss);
}

int main()
{
	init();
	work();
	return 0;
}
		   	 		 			 		 	 	  	 		