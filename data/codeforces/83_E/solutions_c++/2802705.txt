#include<algorithm>
#include<cstdio>
#include<cstring>

using std::min;

const int maxn=200010,maxm=21;
const int INF=1<<30;
int n,L;
char s[maxm];
int a[maxn],all[maxm],f[maxm][1<<maxm-1];

int main(){
  int i,j,t,p,det;
  scanf("%d\n",&n);
  for(i=0;i<n;++i){
    gets(s),L=strlen(s);
    for(j=0;j<L;++j)a[i]=a[i]*2+s[j]-48;
  }
  if(n==1)return printf("%d",L),0;
  for(i=0;i<=L;++i)all[i]=(1<<i)-1;
  memset(f,0x0f,sizeof(f)),f[0][0]=0,det=L;
  for(i=1;i<n;++i){
    for(p=0;(a[i-1]&all[L-p])!=(a[i]>>p);++p);
    for(t=INF,j=0;j<=L;++j)
      t=min(t,det+f[j][a[i]>>L-j]+L-j);
    for(det+=p,j=0;j<=L;++j)
      f[j][a[i-1]&all[j]]=min(f[j][a[i-1]&all[j]],t-det);
  }
  for(t=INF,j=0;j<=all[L];++j)t=min(t,det+f[L][j]);
  printf("%d",t);
  return 0;
}
