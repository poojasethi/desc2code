#include<cstdio>
#include<cstring>

int Ans,Len,Num,LastLen,LastNum,Sum,n,Min[2100000],Start[30];

char Str[30];

int GetAns()
{
	Ans=1000000000;
	for(int k=0;k<=Len;k++)
		if(Ans>Min[Start[k]+(Num>>Len-k)]+Len-k)
			Ans=Min[Start[k]+(Num>>Len-k)]+Len-k;
	return Ans;
}

void Add(int x)
{
	for(int k=0;k<=LastLen;k++)
		if(Min[Start[k]+(LastNum&((1<<k)-1))]>x)
			Min[Start[k]+(LastNum&((1<<k)-1))]=x;
}

int main()
{
	int i,j;
	scanf("%d",&n);
	memset(Min,63,sizeof Min);
	for(i=1;i<=20;i++)Start[i]=Start[i-1]+(1<<i-1);
	Min[0]=0;
	for(i=1;i<=n;i++)
	{
		scanf("%s",Str);
		Len=strlen(Str);
		for(j=Num=0;j<Len;j++)Num=Num*2+Str[j]-'0';
		for(j=Len<LastLen?Len:LastLen;j>0;j--)
			if((Num>>Len-j)==(LastNum&((1<<j)-1)))
				break;
		Sum+=Len-j;
		Add(GetAns()+j-Len);
		LastLen=Len;
		LastNum=Num;
	}
	printf("%d\n",Min[0]+Sum);
	return 0;
}
