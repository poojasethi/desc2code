#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N (1<<20)
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,an;
int a[N],f[21][N];
char p[30];
int main() {
	scanf("%d",&n);
	For(i,1,n) {
		scanf("%s",p+1);
		m=strlen(p+1);
		For(j,1,m) a[i]=a[i]*2+p[j]-'0';
	}
	memset(f,6,sizeof(f));
	f[0][0]=0;
	an=m;
	For(i,2,n) {
		int t=an;
		for (j=m;j;j--) if ((a[i]>>m-j)==(a[i-1]&(1<<j)-1)) break;
		an+=m-j;
		int re=1<<30;
		For(j,0,m) re=min(re,f[j][a[i]>>m-j]+m-j);
		For(j,0,m) {
			int A=a[i-1]&(1<<j)-1;
			f[j][A]=min(f[j][A],re+t-an);
		}
	}
	int re=1<<30;
	For(i,0,m-1)For(j,0,(1<<m)-1) re=min(re,f[i][j]);
	printf("%d\n",an+re);
	return 0;
}
