#include <cstdio>
#include <cstring>

const int maxn = 200012;
int n, len[maxn], val[maxn], e[21], s[maxn], f[maxn], pre[21][1 << 20];
char str[maxn][21];

inline int min(int x, int y){return x < y ? x : y;}

int main(){
	scanf("%d", &n);
	for (int i = 1; i <= n; i++){
		scanf("%s", str[i]);
		len[i] = strlen(str[i]);
		for (int j = 0; j < len[i]; j++)
			val[i] = (val[i] << 1) + (str[i][j] == '1');
	}
	e[1] = 1; s[1] = len[1];
	for (int i = 2; i < 21; i++) e[i] = (e[i - 1] << 1) + 1;
	for (int i = 2; i <= n; i++){
		int l = min(len[i - 1], len[i]);
		while ((val[i - 1] & e[l]) != (val[i] >> (len[i] - l))) l--;
		s[i] = s[i - 1] + len[i] - l;
	}
	memset(f, 60, sizeof(f));
	memset(pre, 60, sizeof(pre));
	f[0] = 0; pre[0][0] = 0;
	for (int i = 1; i <= n; i++){
		for (int l = 0; l <= len[i + 1]; l++)
			f[i] = min(f[i], pre[l][val[i + 1] >> (len[i] - l)] + s[i] + len[i + 1] - l);
		for (int l = 0; l <= len[i]; l++)
			pre[l][val[i] & e[l]] = min(pre[l][val[i] & e[l]], f[i] - s[i + 1]);
	}
	printf("%d\n", f[n]);
}
