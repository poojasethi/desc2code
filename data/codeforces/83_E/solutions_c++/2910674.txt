#include<cstdio>
#include<cstring>
int N,i,j,k,tmp,l,Ans;
int A[200005];
int f[1048576][21];
char S[25];
int main()
{
	scanf("%d",&N);
	for(i=1;i<=N;++i)
	{
		scanf("%s",S);
		l=strlen(S);
		for(j=0;j<l;++j) A[i]=A[i]*2+S[j]-'0';
	}
	memset(f,127,sizeof(f));
	Ans=l;
	f[0][0]=0;
	for(i=2;i<=N;++i)
	{
		for(k=l;k;--k)
			if((A[i-1]&((1<<k)-1))==(A[i]>>(l-k)))
				break;
		Ans+=l-k,tmp=l*i;
		for(j=0;j<=l;++j)
			if(f[A[i]>>j][l-j]+j<tmp)
				tmp=f[A[i]>>j][l-j]+j;
		for(j=0;j<=l;++j)
			if(tmp-l+k<f[A[i-1]&((1<<j)-1)][j])
				f[A[i-1]&((1<<j)-1)][j]=tmp-l+k;
	}
	tmp=l*N;
	for(i=0;i<=l;++i)
		for(j=0;j<1<<i;++j)
			if(f[j][i]<tmp)
				tmp=f[j][i];
	Ans+=tmp;
	printf("%d\n",Ans);
	return 0;
}
