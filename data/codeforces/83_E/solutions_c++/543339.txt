#include <map>
#include <set>
#include <cmath>
#include <stack>
#include <queue>
#include <string>
#include <vector>
#include <fstream>
#include <sstream>
#include <stdio.h>
#include <string.h>
#include <iostream>
#include <algorithm>
using namespace std;
#define li		long long
#define rep(i,to)	for(li i=0;i<((li)to);i++)
#define pb		push_back
#define sz(v)		((li)v.size())

#define MAX 21
int other[MAX][1<<MAX];
int main(){
	rep(i,MAX)rep(j,1<<MAX) other[i][j]=1<<25;
	other[0][0]=0;
	li n,only=0,bef,now=0,len,change;
	string str;
	cin>>n;
	rep(i,n){
		bef=now;
		cin>>str;
		now=0;
		rep(j,sz(str))if(str[j]=='1') now+=(1<<(sz(str)-1-j));
		for(li j=0;j<=sz(str);j++)if(bef%(1<<j)==(now>>(sz(str)-j))) len=j;
		if(i==0) len=0;
		only+=sz(str)-len;
		change=(1<<25);
		for(li j=0;j<=sz(str);j++) change=min(change,(li)other[sz(str)-j][now>>j]-sz(str)+j);
		if(i)for(li j=0;j<=sz(str);j++){
			other[j][bef%(1<<j)]=min((li)other[j][bef%(1<<j)],change+len);
		}
	}
	cout<<only+other[0][0]<<endl;
}
