#include<iostream>
#include<stdio.h>
#include<stdlib.h>
#include<string>
#include<string.h>
#include<math.h>
#include<algorithm>
#include<queue>
#include<vector>
#include<map>
#include<set>
#include<memory.h>
#define min(a,b) (a<b?a:b)
using namespace std;
char tmp[21];
int n,m,a[200001],f[22][1048579];
int ans,minn=0x7ffffff;
void init(){
	memset(a,false,sizeof(a));
	scanf("%d",&n);
	for(int i=1;i<=n;i++){
		scanf("%s",&tmp);
		if(i==1) m=strlen(tmp);
		for(int j=0;j<m;j++)
			a[i]=(a[i]<<1)+tmp[j]-'0';
	}
	ans=m;
	memset(f,0x40,sizeof(f));
	f[0][0]=0;
	for(int i=2;i<=n;i++){
		int lap=0,be=0x7ffffff;
		for(int j=m;j>0;j--)
			if((a[i-1]&((1<<j)-1))==(a[i]>>(m-j))){lap=j;break;}
		ans+=m-lap;
		for(int j=m;j>=0;j--)
			be=min(be,f[m-j][a[i]>>j]+j);
		for(int j=m;j>=0;j--){
			int& tmp=f[j][a[i-1]&((1<<j)-1)];
			tmp=min(tmp,be+lap-m);
		}
	}
	for(int i=0;i<=m;i++){
		for(int j=0;j<(1<<i);j++)
			minn=min(minn,f[i][j]);
	}
	cout<<ans+minn;
}
int main(){
	//freopen("compress.in","r",stdin);
	//freopen("compress.out","w",stdout);
	init();
	return 0;
}
