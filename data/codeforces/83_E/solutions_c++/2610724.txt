//83E
#include <iostream>
#include <cstdio>
#include <cstring>
using namespace std;
#define REP(i,n) for(int i=0;i<(n);i++)
#define FOR(i,st,ed) for(int i=st;i<=(ed);i++)
#define FORD(i,st,ed) for(int i=(st);i>=(ed);i--)

const int MAXN=200000;
const int INF=0x3f3f3f3f;
int n,m;
int a[MAXN+10];
int f[21][1<<20];
int getMore(int x,int y){
	FORD(i,m,0)
		if((x&((1<<i)-1))==(y>>(m-i)))
			return m-i;
}
int main(){
	scanf("%d",&n);
	REP(i,n){
		static char tmp[100];
		scanf("%s",tmp);
		m=strlen(tmp);
		REP(j,m)
			a[i]=a[i]<<1|(tmp[j]-'0');
	}
	
	memset(f,'?',sizeof(f));
	f[0][0]=0;
	int ans=m;
	FOR(i,1,n-1){
		int more=getMore(a[i-1],a[i]);
		ans+=more;
		int minn=INF;
		FOR(j,0,m)
			minn=min(minn,f[j][a[i]>>(m-j)]+m-j);
		FOR(j,0,m)
			f[j][a[i-1]&((1<<j)-1)]=min(f[j][a[i-1]&((1<<j)-1)],minn-more);
	}
	int add=INF;
	FOR(i,0,m)
		REP(j,1<<i)
			add=min(add,f[i][j]);
	cout<<ans+add<<endl;
	return 0;
}