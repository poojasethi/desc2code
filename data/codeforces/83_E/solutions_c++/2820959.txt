#include<cstdio>
#include<cstring>
#include<algorithm>
#define For(i,n) for(int i=1;i<=n;i++)
#define FOR(i,a,b) for(int i=a;i<=b;i++)
using namespace std;
int n,m,k,tot,tmp,p[21],a[200010],f[1048576][21];
char s[30];
int main()
{
	scanf("%d ",&n);
	For(i,n)
	{
		gets(s+1);
		m=strlen(s+1);
		For(j,m) a[i]=(a[i]<<1)+s[j]-'0';
	}
	FOR(i,0,m) p[i]=1<<i;
    memset(f,0xC0,sizeof(f));
    f[0][0]=0;
	FOR(i,2,n)
	{
		for(k=m;k;k--)
		    if ((a[i-1] & p[k]-1) == (a[i]>>m-k)) break;
		tot+=k;tmp=0;
		FOR(j,0,m) tmp=max(tmp,f[a[i]>>m-j][j]+j);
		FOR(j,0,m) f[a[i-1] & p[j]-1][j]=max(f[a[i-1] & p[j]-1][j],tmp-k);
	}
	tmp=0;
	FOR(j,0,m)
		FOR(i,0,p[j]-1) tmp=max(tmp,f[i][j]);
	printf("%d",n*m-tot-tmp);
	return 0;
}
