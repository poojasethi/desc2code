#include <iostream>
#include <cmath>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <algorithm>
#include <string>
using namespace std;
const int N=200000,M=21,D=1<<M;

int f[D],g;char ch[M+1],pre[M+1];

int main(){
	int i,j,n,tmp,ans,m,s,t1,t2,t3;
//	freopen("a.in","r",stdin);
	scanf("%d",&n);
	memset(f,64,sizeof(f));f[1]=0;
	for (i=1;i<=n;i++){
		scanf(" %s",ch);m=strlen(ch);
		if (i!=1){
			for (j=0,s=1,tmp=f[s]+g;j<m;j++){
				s<<=1;s^=ch[j]==49;
				tmp=min(tmp,f[s]+g-j-1);
			}tmp+=m;
			for (j=0,t3=0,t1=0,t2=0;j<m;j++){
				t1^=(1<<j)*(pre[m-j-1]==49);
				t2<<=1,t2^=ch[j]==49;
				if (t1==t2) t3=j+1;
			}g+=m-t3;
			for (j=0,s=1;j<=m;j++){
				f[s]=min(f[s],tmp-g);
				s^=(1<<j)*(pre[m-j-1]==48);
				s^=1<<j+1;
			}
		}else g=m;
		for (j=0;j<m;j++) pre[j]=ch[j];
	}
	for (i=0,ans=g;i<D;i++) ans=min(ans,f[i]+g);
	printf("%d\n",ans);
	return 0;
}