#include <cstdio>
#include <cstring>
#include <algorithm>
#define maxn 200005
#define Pre(i,l) (a[i]>>(L-(l)))
#define Suf(i,l) (a[i]&((1<<(l))-1))
using namespace std;

int N,L,a[maxn],w[maxn],g[25][1<<21];

void init()
{
	scanf("%d",&N);
	char s[25];
	for (int i=1; i<=N; i++)
	{
		scanf("%s",s),L=strlen(s);
		for (int j=0; j<L; j++) (a[i]<<=1)+=s[j]-48;
		if (i==1) w[i]=L; else for (int j=L; j>=0; j--) if (Pre(i,j)==Suf(i-1,j)) {w[i]=w[i-1]+L-j; break;}
	}
}

void doit()
{
	int ans=w[N];
	memset(g,63,sizeof(g)),g[0][0]=0;
	for (int i=2; i<=N; i++)
	{
		int x=1e9;
		for (int j=0; j<=L; j++) x=min(x,g[L-j][Pre(i,L-j)]+j+w[i-1]); 
		for (int j=0; j<=L; j++) g[j][Suf(i-1,j)]=min(g[j][Suf(i-1,j)],x-w[i]);
		ans=min(ans,x+w[N]-w[i]);
	}
	printf("%d\n",ans);
}

int main()
{
	init();
	doit();
	return 0;
}