#include <cstdio>
#include <cstring>
#include <algorithm>
#include <iostream>
#include <ctime>
#include <cmath>
#define maxn 1050000
#define rep(i,n) for(int i=1;i<=n;++i)
using namespace std;
void getmin(int &x,int y)
{
    if(x>y)x=y;
}
int a[maxn],f[1<<21];
int n,aug,ans,len;
char s[30];
int get(int x,int y)
{
    int i=0;
    for (i=0;(x&(1<<len-i)-1)!=(y>>i);++i); 
    return i;
}
int main()
{
    scanf("%d\n",&n);
    rep(i,n)
    {
        scanf("%s\n",s);
        len=strlen(s);
        rep(j,len)a[i]=(a[i]<<1)+s[j-1]-'0';
    }
    ans=len;
    memset(f,1,sizeof(f));
    f[0]=0;
//  printf("%d\n",len);
//  printf("True\n");
    for(int i=2;i<=n;++i)
    {
        int x=get(a[i-1],a[i]);
        ans+=x;
        aug=1<<21;
        for(int j=0;j<=len;++j)
        {
            getmin(aug,f[(1<<len-j)-1+(a[i]>>j)]+j);
        }
        aug-=x;
    //  printf("True\n");
        for(int j=0;j<=len;++j)
        {
            getmin(f[(1<<j)-1+(a[i-1]&(1<<j)-1)],aug);
        }
    }
    aug=0;
    for(int i=0;i<1<<21;++i)aug=min(aug,f[i]);
    printf("%d\n",ans+aug);
    return 0;
}
