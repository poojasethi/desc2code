#include <cstdio>
#include <cstring>

using namespace std;

int n,m,a[200010],ans;
int f[21][1<<20];
char buf[21];

void ckmin(int &a,int b){b<a ? a=b : 0;}
int main()
{
	scanf("%d",&n);
	for(int i=1;i<=n;i++){
		scanf("%s",buf);m=strlen(buf);
		for(int j=0;j<m;j++) a[i]=(a[i]<<1)+buf[j]-'0';
	}
	memset(f,0x3f,sizeof(f));
	f[0][0]=0;ans=m;
	for(int i=2,j,k;i<=n;i++){
		for(j=m;j && (a[i-1]&((1<<j)-1))!=(a[i]>>m-j);j--);
		ans+=m-j;k=0x3f3f3f3f;
		for(int p=0;p<=m;p++) ckmin(k,f[p][a[i]>>m-p]-p+j);
		for(int p=0;p<=m;p++) ckmin(f[p][a[i-1]&((1<<p)-1)],k);
	}
	int t=0;
	for(int i=0;i<=m;i++)
		for(int j=0;j<(1<<i);j++)
			ckmin(t,f[i][j]);
	printf("%d\n",ans+t);
	return 0;
}
