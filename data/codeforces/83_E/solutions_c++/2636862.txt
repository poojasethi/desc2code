#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>

using namespace std;

const int INF=0x3f3f3f3f;

int f[22][1<<21],n,l,z[200010];

char s[30];

int main()
{
	scanf("%d",&n);
	for (int a=1;a<=n;a++)
	{
		scanf("%s",s+1);
		l=strlen(s+1);
		for (int b=1;b<=l;b++)
			z[a]=z[a]*2+s[b]-'0';
	}
	memset(f,0x3f,sizeof(f));
	f[0][0]=0;
	int ans=l;
	for (int a=2;a<=n;a++)
		for (int nowl=l;;nowl--)
			if ((z[a-1]&((1<<nowl)-1))==(z[a]>>(l-nowl)))
			{
				nowl=l-nowl;
				ans+=nowl;
				int minv=INF;
				for (int b=0;b<=l;b++)
					minv=min(minv,f[b][z[a]>>(l-b)]+l-b);
				for (int b=0;b<=l;b++)
					f[b][z[a-1]&((1<<b)-1)]=min(f[b][z[a-1]&((1<<b)-1)],minv-nowl);
				break;
			}
	int minv=0;
	for (int a=0;a<=l;a++)
		for (int b=0;b<(1<<l);b++)
			minv=min(minv,f[a][b]);
	printf("%d\n",ans+minv);

	return 0;
}
