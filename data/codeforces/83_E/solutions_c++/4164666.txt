#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<algorithm>
#define maxn 200010
#define maxm 21
using namespace std;
int n,L;
char s[maxm];
int digit[maxn],F[maxm][1<<20];
void read()
{
	static char s[maxm];
	for(int i=1;i<=n;i++)
	{
		scanf("%s",s+1);
		L=strlen(s+1);
		for(int j=1;j<=L;j++)
			digit[i]=digit[i]*2+s[j]-'0';
	}
}
void min(int &a,int b)
{
 	if(a>b)
	 	a=b;
}
int solve()
{
	int delta;
	if(n==1)
		return L;
	for(int i=0;i<=L;i++)
		for(int j=0;j<(1<<L);j++)
			F[i][j]=1<<30;
	F[0][0]=0,delta=L;
	for(int i=2;i<=n;i++)
	{
		int p=0,minv=1<<30;
		while((digit[i-1]&((1<<(L-p))-1))!=(digit[i]>>p))
			p++;
		for(int j=0;j<=L;j++)
			min(minv,delta+F[j][digit[i]>>(L-j)]+L-j);
		delta+=p;
		for(int j=0;j<=L;j++)
			min(F[j][digit[i-1]&((1<<j)-1)],minv-delta);
	}
	int ans=1<<30;
	for(int i=0;i<(1<<L);i++)
		min(ans,delta+F[L][i]);
	return ans;
}
int main()
{
	scanf("%d",&n);
	read();
	printf("%d\n",solve());
	return 0;
}

	  	  		   			 		 	 			   	