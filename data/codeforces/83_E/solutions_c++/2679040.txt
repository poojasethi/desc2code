#include <cstdio>
#include <cstring>
#define INFI 999999999
char str[100]; int m,n,a[1000000],f[22][1<<21];
int common(int x,int y)
{
  if(x == 0 || y == n+1) return 0;
  for(int i=m;i>=0;i--)
    {
      int s1 = a[x]&((1<<i)-1);
      int s2 = a[y]>>(m-i);
      if(s1 == s2) return i;
    }
  return 0;
}
int main()
{
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int i,spent,save,j,s,raw=0;
  scanf("%d",&n);
  for(i=1;i<=n;i++)
    {
      scanf("%s",str); m = strlen(str);
      for(j=0;j<m;j++)
	a[i] = (a[i]<<1)+str[j]-'0';
      raw += m-common(i-1,i);
    }
  for(j=save=0;j<=m;j++) 
    for(s=0;s<(1<<m);s++) 
      f[j][s] = -INFI;
  f[0][0] = 0;
  for(i=2;i<=n;i++)
    {
      spent = m-common(i-1,i);
      for(j=0,save=-INFI;j<=m;j++)
	{
	  int s = a[i]>>j;
	  if(f[m-j][s]-j+spent > save) 
	    save = f[m-j][s]-j+spent;
	}
      for(j=0;j<=m;j++)
	{
	  int s = (1<<(j))-1;
	  s &= a[i-1];
	  if(save > f[j][s]) f[j][s] = save;
	}
    }
  for(j=save=0;j<=m;j++) 
    for(s=0;s<(1<<m);s++) 
      if(f[j][s]>save) save=f[j][s];
  printf("%d\n",raw-save);
}
