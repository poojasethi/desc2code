#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
using namespace std;

#define MAXN 200010
#define bit(x) ((1<<(x))-1)
#define MAXL 22

int N, m, a[MAXN];
int f[MAXL][1<<20];

int Min (int &a, int b) {a = min (a, b);}

int main ()
{
	scanf ("%d", &N); m = 0;
	for (int i = 0; i < N; i++)
	{
		char ch[25]; scanf ("%s", ch); if (!m) m = strlen (ch);
		a[i] = 0;
		for (int j = 0; j < m; j++) a[i] = (a[i]<<1)+ch[j]-'0';
	}
	int ans = m;
	memset (f, 0x40, sizeof(f)); f[0][0] = 0;
	for (int i = 1; i < N; i++)
	{
		int k; for (k = m; k; k--) if ((a[i]>>(m-k)) == (a[i-1]&bit(k))) break;
		ans += m-k;
		int t = 1<<30;
		for (int j = 0; j <= m; j++) t = min (t, f[j][a[i]>>(m-j)]+(m-j));
		for (int j = 0; j <= m; j++) Min (f[j][a[i-1]&bit(j)], t-m+k);
	}
	int t = 1<<30;
	for (int i = 0; i <= m; i++)
		for (int j = 0; j < (1<<i); j++) t = min (t, f[i][j]);
	printf ("%d\n", t+ans);
}