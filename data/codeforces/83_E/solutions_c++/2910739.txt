#include<cstdio>
#include<cstring>
#define rep(i,n) for (int i=0;i<n;i++)
#define Min(x,y) x=x<y?x:y
int a[1<<21],f[1<<21][21],n,m,ans,opt; char s[21];
int main()
{
	scanf("%d",&n); memset(f,6,sizeof(f)),f[0][0]=0;
	rep(i,n){scanf("%s",s),m?0:m=strlen(s); rep(j,m) a[i]=a[i]*2+s[j]-48;}
	rep(i,n) if (i){
		int res=1<<26,j; for (j=0;(a[i-1]&~-(1<<m-j))!=a[i]>>j;j++); ans+=j;
		rep(k,m+1) Min(res,f[a[i]>>k][m-k]+k-j);
		rep(k,m+1) Min(f[a[i-1]&~-(1<<k)][k],res);
		}
	rep(i,1<<m) rep(j,m+1) Min(opt,f[i][j]); printf("%d\n",opt+ans+m); return 0;
}
