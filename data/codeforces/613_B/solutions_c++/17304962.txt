#include<bits/stdc++.h>

using namespace std;

#define t ( m - ( (A[j] * (n-j+1)) - P[j] ) )
#define N 100005LL

long long P[N],A[N],B[N],n,i,j,a,b,m,asd,mx,l = N*N*N,r,x,y;

int main(){

	cin >> n >> mx >> a >> b >> m;

	for(i=1;i<=n;i++){
		cin >> A[i];
		B[i] = A[i];
	}

	if(n == 1){
      cout << min( mx , A[1] + m ) * b + a * (A[1] + m >= mx) << endl;
		cout << min( mx , A[1] + m );
		return 0;
	}

	sort(A+1 , A+n+1);
	reverse(A+1 , A+n+1);

	for(i=n; i ;i--)
		P[i] = P[i+1] + A[i];

	for(i=j=1;i<=n+1;i++){

		j = max(i,j);

		while(j <= n && t < 0)  j++;

		if(t >= 0)
			if( asd < (i-1) * a + (i > n ? mx * b : j <= n ? min(mx,(A[j] + t / (n-j+1))) * b : 0) ){

  				 asd = (i-1) * a + (i > n ? mx * b : j <= n ? min(mx,(A[j] + t / (n-j+1))) * b : 0);

				x = y;
				if(i > 1)
					l = A[i-1];
				if(i <= n)
					r = min(mx,(A[j] + t / (n-j+1)));
				else
					r = mx;

			}

		if(A[i] != A[i-1] || i == 1)
			y = 1;
		else
			y++;

		m -= mx - A[i];
	}

	cout << asd << endl;

	for(i=1;i<=n;i++){

		cout << (B[i] > l || (B[i] == l && x > 0) ? mx : max(B[i] , r)) << " ";

		if(B[i] == l)
			x--;
	}
	return 0;
}
