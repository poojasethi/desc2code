#include <vector>
#include <algorithm>
#include <iostream>

#define fo(i,a,b) for(i=a;i<=b;++i)

using namespace std;

const int mn=101000;

vector<int> edge[mn];
int cost[mn], sz[mn], sc[mn], sv[mn];
int R[mn],vis[mn];
int n,m,i,j,k,nc,tt;
long long ans;
bool cmpc(int i,int j){return cost[i]>cost[j];}
bool cmps(int i,int j){return sz[i]<sz[j];}

void add(int i,int d,int l)
{
    sz[0] = l;
    int j = lower_bound(sv+1, sv+1+n, 0, cmps) - sv;
    if(j == n+1) return;
    j = sv[j];
    if (sz[j] != l || cost[j] > d) return;
    edge[j].push_back(i);
}

bool dfs(int r) {
    vis[r] = nc;
    for(size_t p = 0; p < edge[r].size(); ++p) {
        int i = edge[r][p];
        if (R[i] == 0 || (vis[R[i]] != nc && dfs(R[i]))) {
            R[i] = r;
            return 1;
        }
    }
    return 0;
}

int main() {
    ios_base::sync_with_stdio(0);
    cin >> n;
    fo(i,1,n) cin >> cost[i] >> sz[i];
    fo(i,1,n) sc[i] = sv[i] = i;
    sort(sc+1, sc+1+n, cmpc);
    sort(sv+1, sv+1+n, cmps);

    cin >> m;
    fo(i, 1 ,m) {
        cin >> j >> k;
        add(i, j, k);
        add(i, j, k+1);
    }

    fo(i,1,n) {
        ++nc;
        if(dfs(sc[i])) {
            ++tt;
            ans+=cost[sc[i]];
        }
    }

    cout << ans << endl;
    cout << tt << endl;
    fo(i,1,m) if(R[i]) cout << i << " " << R[i] << endl;

    return 0;
}
