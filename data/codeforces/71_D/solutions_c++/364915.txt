#include <cstdio>
#include <algorithm>
#include <cstring>
using namespace std;

int n,m;
char a[99][99][3];

int cnt, vis[300];

int oksqr(int x,int y){
	int sut=1, dis=1;
	char suit=a[x][y][1];
	cnt++;
	for (int i=x; i<=x+2; i++){
		for (int j=y; j<=y+2; j++){
			if (a[i][j][1]!=suit) sut = 0;
			if (vis[a[i][j][0]]==cnt) dis=0;
			vis[a[i][j][0]]=cnt;
		}
	}
	return sut||dis;
}

int chk(int &rx1, int &ry1, int &rx2, int &ry2){
	for (int x1=1; x1<=n-2; x1++){
		for (int y1=1; y1<=m-2; y1++){
			for (int x2=x1; x2<=n-2; x2++){
				for (int y2=1; y2<=m-2; y2++){
					if (x2<=x1+2&&y1-2<=y2&&y2<=y1+2) continue;
					if (oksqr(x1,y1) && oksqr(x2,y2)){
						rx1 = x1;
						ry1 = y1;
						rx2 = x2;
						ry2 = y2;
						return 1;
					}
				}
			}
		}
	}
	return 0;
}


int done=0;
int rx1,ry1,rx2,ry2;
int j1x,j1y,j2x,j2y,used[100];
char map1[100], map2[100];
char c1,c2,c3,c4;

int main(){


	for (int i=0;i<52;i++){
		map1[i]=i%13+'1';
		if (i%13==0) map1[i]='A';
		if (i%13==9) map1[i]='T';
		if (i%13==10) map1[i]='J';
		if (i%13==11) map1[i]='Q';
		if (i%13==12) map1[i]='K';
		
		if (i/13==0) map2[i]='C';
		if (i/13==1) map2[i]='D';
		if (i/13==2) map2[i]='H';
		if (i/13==3) map2[i]='S';
	}

	scanf("%d%d",&n,&m);
	j1x = j2x = -1;
	for (int i=1;i<=n;i++){
		for (int j=1;j<=m;j++){
			scanf("%s", a[i][j]);
			if (strcmp(a[i][j],"J1")==0) j1x=i,j1y=j;
			else if (strcmp(a[i][j],"J2")==0) j2x=i,j2y=j;
			else{
				int x=0;
				if (a[i][j][0]=='A') x=0;
				else if (a[i][j][0]=='T') x=9;
				else if (a[i][j][0]=='J') x=10;
				else if (a[i][j][0]=='Q') x=11;
				else if (a[i][j][0]=='K') x=12;
				else x=a[i][j][0]-'1';
				
				if (a[i][j][1]=='C') x+=0;
				if (a[i][j][1]=='D') x+=13;
				if (a[i][j][1]=='H') x+=26;
				if (a[i][j][1]=='S') x+=39;
				
				used[x]=1;
			}
		}
	}
	
	if (j1x==-1&&j2x==-1){
		if (chk(rx1,ry1,rx2,ry2)){
			done=1;
			printf("Solution exists.\n");
			printf("There are no jokers.\n");
			printf("Put the first square to (%d, %d).\n", rx1, ry1);
			printf("Put the second square to (%d, %d).\n", rx2, ry2);
			return 0;
		}
	}
	else if (j1x!=-1&&j2x!=-1){
		for (int i=0;i<52;i++){
			for (int j=0;j<52;j++){
				if (i==j||used[i]||used[j]) continue;
				c1=a[j1x][j1y][0]=map1[i];
				c2=a[j1x][j1y][1]=map2[i];
				c3=a[j2x][j2y][0]=map1[j];
				c4=a[j2y][j2y][1]=map2[j];
				if (chk(rx1,ry1,rx2,ry2)){
					done=1;
					printf("Solution exists.\n");
					printf("Replace J1 with %c%c and J2 with %c%c.\n",c1,c2,c3,c4);
					printf("Put the first square to (%d, %d).\n", rx1, ry1);
					printf("Put the second square to (%d, %d).\n", rx2, ry2);
					return 0;
				}
			}
		}
	}
	else if (j1x!=-1){
		for (int i=0;i<52;i++){
			if (used[i]) continue;
			c1=a[j1x][j1y][0]=map1[i];
			c2=a[j1x][j1y][1]=map2[i];
			if (chk(rx1,ry1,rx2,ry2)){
				printf("Solution exists.\n");
				printf("Replace J1 with %c%c.\n",c1,c2);
				printf("Put the first square to (%d, %d).\n", rx1, ry1);
				printf("Put the second square to (%d, %d).\n", rx2, ry2);
				return 0;
			}
		}
	}
	else if (j2x!=-1){
		for (int i=0;i<52;i++){
			if (used[i]) continue;
			c1=a[j2x][j2y][0]=map1[i];
			c2=a[j2x][j2y][1]=map2[i];
			if (chk(rx1,ry1,rx2,ry2)){
				done=1;
				printf("Solution exists.\n");
				printf("Replace J2 with %c%c.\n",c1,c2);
				printf("Put the first square to (%d, %d).\n", rx1, ry1);
				printf("Put the second square to (%d, %d).\n", rx2, ry2);
				return 0;
			}
		}
	}
	
	if (!done) printf("No solution.\n");

	return 0;
}
