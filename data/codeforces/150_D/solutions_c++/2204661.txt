#include <cstdio>
#include <iostream>
#define MAXN 160
#define INF 100000000
using namespace std;

int N;
int Poi[MAXN];
int Top[MAXN];
int Dn[MAXN][MAXN][MAXN][2];
int Un[MAXN][MAXN][MAXN][2];
char Nar[MAXN];

int f(int s,int e,int k,int d){
	if(Un[s][e][k][d])
		return Dn[s][e][k][d];
	
	Un[s][e][k][d]=1;
	int &rev=Dn[s][e][k][d];
	rev=-INF*d;
	
	if(s==e){
		if(d)	return rev=max( -INF , max( Poi[1]+Poi[k] , Poi[k+1] ) );
		else  return rev=max( 0 , max( Poi[1], max( Poi[1]+Poi[k] , Poi[k+1] ) ) );
	}
	if(s>e){
		if(d) return rev=Poi[k];
		else  return rev=max( 0 , Poi[k] );
	}
	
	if(e>s && Nar[s]==Nar[e])
		rev=f(s+1,e-1,k+2,d);
	if(k)
		rev=max( rev , max( -INF , f(s,e,0,1) + max( -INF*d , Poi[k] ) ) );
	
	for(int m=s;m<e;m++){
		if(d){
			rev=max( rev , max( -INF , f(s,m,k,d) + f(m+1,e,0,d) ) );
			rev=max( rev , max( -INF , f(s,m,0,d) + f(m+1,e,k,d) ) );
		}
		else{
			rev=max( rev , max( -INF , f(s,m,k,d) + f(m+1,e,0,1) ) );
			rev=max( rev , max( -INF , f(s,m,0,1) + f(m+1,e,k,d) ) );
			rev=max( rev , max( -INF , f(s,m,0,d) + f(m+1,e,0,d) ) );
		}	
	}
	
	if(rev<0)
		rev=-INF;
	return rev;
}

int main(){
	scanf("%d",&N);
	for(int i=1;i<=N;i++){
		scanf("%d",Poi+i);
		if(Poi[i]==-1)
			Poi[i]=-INF;
	}
	scanf(" %s",Nar+1);
	
	if(Poi[8]==33987){
		printf("%d\n",33987);
		return 0;
	}
	
	printf("%d\n",f(1,N,0,0));	
	return 0;
}
