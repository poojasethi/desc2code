#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n   155
#define INF (1<<28)
#define max(a,b)    ((a)>(b)?(a):(b))
#define For(i,a,b)  for(int i=a;i<=b;i++)

int     N,A[n],G[n],F[n][n][n];
char    s[n];

int     main(){
        scanf("%d",&N);
        For(i,1,N)  scanf("%d",&A[i]);
        scanf("%s",s+1);

        For(i,1,N)  For(j,1,N)  For(k,0,N)  F[i][j][k]=-INF;
        For(i,1,N)  {
            F[i][i][1]=0;
            if  (A[1]!=-1)  F[i][i][0]=A[1];
        }
        For(i,1,N)  F[i][i-1][0]=F[i+1][i][0]=0;

        For(l,2,N)  For(i,1,N-l+1){
            int j=i+l-1;
            For(k,1,l)  {
                if  (k>=2&&s[i]==s[j])  F[i][j][k]=max(F[i][j][k],F[i+1][j-1][k-2]);
                For(t,i+k-1,j-1)    F[i][j][k]=max(F[i][j][k],F[i][t][k]+F[t+1][j][0]);
                For(t,i+1,j-k+1)    F[i][j][k]=max(F[i][j][k],F[t][j][k]+F[i][t-1][0]);
            }
            For(t,i,j-1)F[i][j][0]=max(F[i][j][0],F[i][t][0]+F[t+1][j][0]);
            For(k,1,l)  if  (A[k]!=-1)  F[i][j][0]=max(F[i][j][0],F[i][j][k]+A[k]);
        }

        For(i,1,N)  {
            G[i]=G[i-1];
            For(j,0,i-1)    For(k,0,N)  G[i]=max(G[i],G[j]+F[j+1][i][k]);
        }
        printf("%d\n",G[N]);
}