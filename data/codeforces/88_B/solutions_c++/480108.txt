#include<stdio.h>
#include<stdlib.h>

using namespace std;

struct pnt{
	int x,y;
};

char a[33][33];
int x,n,m;
pnt k[905];
int cur;
int was[256];

int main(){
	//freopen("input.txt","r",stdin);
	scanf("%d%d%d",&n,&m,&x);
	x = x * x;
	for(int i = 0; i < n; i++){
		for(int j = 0; j < m; j++){
			scanf(" %c ",&a[i][j]);
			if (a[i][j] == 'S') {
				k[cur].x = i;
				k[cur].y = j;
				cur++;	
			}
		}
	}
	for(int i = 0; i < n; i++){
		for(int j = 0; j < m; j++){
			if (a[i][j] != 'S'){
				was[a[i][j]] = 1;
				for(int q = 0; q < cur; q++){
					if ((k[q].x - i) * (k[q].x - i) + (k[q].y - j) * (k[q].y - j) <= x){
						was[a[i][j] - 32] = 1;
						q = cur;
					}
				}
			}
		}
	}
	int t;
	int ans = 0;
	scanf("%d",&t);
	for(int i = 0; i < t; i++){
		char ch;
		scanf(" %c ",&ch);
		if (ch >= 'A'){
			if (was[ch] == 0){
				if (cur == 0){
					printf("-1");
					return 0;
				}
				if (was[ch + 32] == 0){
					printf("-1",ch);
					return 0;
				}
				ans++;
			}
		}
		else{
			if (was[ch] == 0) {
				printf("-1");
				return 0;
			}
		}
	}
	printf("%d",ans);
	return 0;
}
