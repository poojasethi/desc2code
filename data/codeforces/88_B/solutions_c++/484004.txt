#include <cstdio>
#include <cctype>
#include <string>
#include <cstring>
#include <iostream>
#include <algorithm>
using namespace std;

int main() {
	string board[32], str;
	int n, m, x, q, ans, h[27], s[27];
	while (cin >> n >> m >> x) {
		memset(h, 0, sizeof(h));
		memset(s, 0, sizeof(s));
		for (int i = 0; i < n; ++i)
			cin >> board[i];
		for (int i = 0; i < n; ++i) {
			for (int j = 0; j < m; ++j) {
				if (board[i][j] != 'S') {
					h[board[i][j] - 'a'] = 1;
				} else {
					h[26] = 1;
					for (int k = 0; k < n; ++k) {
						for (int l = 0; l < m; ++l) {
							if (board[k][l] != 'S' && !s[board[k][l] - 'a']) {
								int xx = (i - k) * (i - k);
								int yy = (j - l) * (j - l);
								s[board[k][l] - 'a'] = (xx + yy <= x * x);
							}
						}
					}
				}
			}
		}
		ans = 0;
		cin >> q >> str;
		for (int j = 0; j < str.length(); ++j) {
			if (islower(str[j])) {
				if (!h[str[j] - 'a']) {
					ans = -1;
					break;
				}
			} else {
				if (!h[str[j] - 'A'] || !h[26]) {
					ans = -1;
					break;
				}
				ans += !s[str[j] - 'A'];
			}
		}
		cout << ans << endl;
	}
	return 0;
}