#include <iostream>
#include <iomanip>
#include <fstream>
#include <algorithm>
#include <cassert>
#include <cctype>
#include <cmath>
#include <complex>
#include <cstdio>
#include <map>
#include <queue>
#include <set>
#include <stack>
#include <string>
#include <vector>
using namespace std;

#define INF 1e8
#define EPS 1e-9
#define rep(i,n) for(int i=0;i<n;i++)

int n,m,x,q,a[26],S,ans;
char k[31][31],c;

int main(){
	cin>>n>>m>>x;
	rep(i,n)rep(j,m)cin>>k[i][j];
	rep(i,n)rep(j,m){
		if(islower(k[i][j]))a[k[i][j]-'a']=max(a[k[i][j]-'a'],1);
		else{
			S=1;
			rep(K,n)rep(l,m){
				if((i-K)*(i-K)+(j-l)*(j-l)<=x*x)a[k[K][l]-'a']=2;
			}
		}
	}
	cin>>q;
	rep(i,q){
		cin>>c;
		if(islower(c)){
			if(!a[c-'a']){
				cout<<-1<<endl;
				return 0;
			}
		}
		else{
			if(!a[c-'A']||!S){
				cout<<-1<<endl;
				return 0;
			}
			if(a[c-'A']<2)ans++;
		}
	}
	cout<<ans<<endl;
}
