/*
ID:zjl19902
PROG:
LANG:C++
*/
#include <iostream>
#include <algorithm>
#include <cstdio>
#include <cstring>
#include <vector>
#include <string>
#include <cmath>
using namespace std;
char map[35][35],t[500005];
bool vis[1000];
int dis[400],x;
int m,n,len;
bool SS;
int ch()
{
	if(!SS)
	for(int i=0;i<len;i++)
	if(isupper(t[i]))return -1;
	int ret=0;
	for(int i=0;i<len;i++)
	{
		if(islower(t[i])&&!vis[t[i]]||isupper(t[i])&&!vis[t[i]+32])return -1;
		if(isupper(t[i]))
		{
			if(dis[t[i]+32]>x)
			ret++;
		}
	}
	return ret;
}
int main()
{
	while(scanf("%d%d%d",&n,&m,&x)==3)
	{
		x*=x;
		for(int i=0;i<n;i++)
		scanf("%s",map[i]);
		scanf("%d%s",&len,t);
		memset(vis,0,sizeof(vis));SS=0;
		for(int i=0;i<400;i++)dis[i]=100000;
		for(int i=0;i<n;i++)
		for(int j=0;j<m;j++)
		{
			vis[map[i][j]]=1;
			if(map[i][j]=='S')
			SS=1;
			else
			{
				for(int k=0;k<n;k++)
				for(int l=0;l<m;l++)
				if(map[k][l]=='S')
				dis[map[i][j]]=min(dis[map[i][j]],(i-k)*(i-k)+(j-l)*(j-l));
			}
		}
		printf("%d\n",ch());
	}
}
