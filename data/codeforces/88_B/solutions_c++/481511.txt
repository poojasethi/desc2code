#include<stdio.h>
#include<stdlib.h>
#include<math.h>
int d[300];
char s[40][40];
int n,m,x,q;
int ans;
int main(){
  int i,j,k,i1,j1;
  char c;
  int can=1;
  scanf("%d%d%d",&n,&m,&x);
  for (i=0;i<n;i++) scanf("\n%s",s[i]);
  for (i=0;i<n;i++)
    for (j=0;j<m;j++){
      if (s[i][j]=='S') continue;
      if (d[s[i][j]]==0) d[s[i][j]]=10000;
      for (i1=0;i1<n;i1++)
        for (j1=0;j1<m;j1++)
          if (s[i1][j1]=='S'){ 
            if (d[s[i][j]]>(i-i1)*(i-i1)+(j-j1)*(j-j1)) 
              d[s[i][j]]=(i-i1)*(i-i1)+(j-j1)*(j-j1);
          }
    }
  scanf("%d",&q);
  scanf("%c",&c);
  for (i=0;i<q;i++){
    scanf("%c",&c);
    if (c<'a') {
      if (d[c+32]==10000||d[c+32]==0) can=0;
      else if (d[c+32]>x*x) ans++;
    }
    else if (d[c]==0) can=0;
  }
  if (can) printf("%d\n",ans);
  else printf("-1\n");
  return 0;
}
