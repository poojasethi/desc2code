#include <iostream>
#include <cmath>

using namespace std;

bool have[30];
double dis[30];
char a[35][35];

int main()
{
	int n, m, x;
	cin >> n >> m >> x;
	for (int j = 0; j < n; j++)
		for (int i = 0; i < m; i++)
			cin >> a[i][j];
	for (int j = 0; j < n; j++)
		for (int i = 0; i < m; i++)
			if (a[i][j] != 'S')
			{
				have[a[i][j] - 'a'] = true;
				double mindis = dis[a[i][j] - 'a'];
				for (int y = 0; y < n; y++)
					for (int x = 0; x < m; x++)
						if (a[x][y] == 'S')
						{
							double d = sqrt(double((x - i) * (x - i) + (y - j) * (y - j)));
							if (mindis == 0 || mindis > d)
								mindis = d;
						}
				dis[a[i][j] - 'a'] = mindis;
			}
	int q;
	cin >> q;
	int ans = 0;
	for (int i = 0; i < q; i++)
	{
		char c;
		cin >> c;
		if ('a' <= c && c <= 'z')
		{
			if (!have[c - 'a'])
			{
				cout << -1 << endl;
				return 0;
			}
		}
		else
		{
			if (!have[c - 'A'] || dis[c - 'A'] == 0)
			{
				cout << -1 << endl;
				return 0;
			}
			if (dis[c - 'A'] > x)
				ans++;
		}
	}
	cout << ans << endl;
}
