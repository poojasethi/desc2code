#!/usr/bin/python2
#-*- coding: utf-8 -*-

import sys,math
def sqr(x):
    return x*x

global x
ret = raw_input()
ret = ret.split(' ')
n = int(ret[0])
m = int(ret[1])
x = int(ret[2])

pole=[[]*n for r in xrange(n)]
for i in range(n) :
    pole[i] = raw_input().rstrip()

#print pole



shifty = []
for i in range(n) :
    for j in range(m) :
        if pole[i][j] == 'S':
            shifty.append((i,j))

jednou = []
dvema = []
jenmale = []

for i in range(n) :
    for j in range(m) :
        pridano = False
        if pole[i][j] != 'S':
            for k in shifty :
                if math.sqrt(sqr(abs(i-k[0])) + sqr(abs(j-k[1]))) <= x :
                    #print x
                    if not (pole[i][j] in jednou):
                        #print pole[i][j],math.sqrt(sqr(abs(i-k[0])) + sqr(abs(j-k[1])))
                        jednou.append(pole[i][j])
                    pridano = True
                    break
            if pridano == False :
                if len(shifty) > 0:
                    if not (pole[i][j] in dvema):
                        dvema.append(pole[i][j])
                else:
                    if not (pole[i][j] in jenmale):
                        jenmale.append(pole[i][j])

#print jednou,dvema

q = int(raw_input())
text = raw_input().rstrip()

kolikrat = 0
konec = False
for i in text :
    if not ((i in jednou) or (i in dvema) or (i in jenmale)):
        if (str.lower(i) in jednou):
            pass
        elif (str.lower(i) in dvema) :
            kolikrat += 1
        else :
            konec = True
            break

if konec == True:
    print '-1'
else :
    print kolikrat
            


