n,m,x=map(int,raw_input().split())
x*=x
k = {(i,j):c for i in xrange(n) for j,c in enumerate(raw_input())}
R = set((i,j) for i in xrange(n) for j in xrange(m))
s = set(p for p in R if k[p]=='S')
d,e = set(),set()
for p in R-s:
    d.add(k[p])
    if s:
        (d if min((p[0]-a)**2+(p[1]-b)**2 for a,b in s)<=x else e).add(k[p].upper())
input()
s = raw_input()
if set(s)-d-e: print -1
else: print sum(1 for c in s if c in e-d)

