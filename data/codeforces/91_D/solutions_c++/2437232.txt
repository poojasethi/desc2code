#include<iostream>
#include<cstdio>


using namespace std;

int a[100001],b[100001],c[100001],d[100001];
bool v[100001];

void work1(int x){
     int p[6];
     int tot=1;
     p[1]=x;int i=x;
     while (a[i]!=x){
           p[++tot]=a[i];
           i=a[i];
     }
     printf("%d\n",tot);
     for (int i=1;i<=tot;i++) printf("%d ",p[i]);
     printf("\n");
     for (int i=1;i<=tot;i++) printf("%d ",a[p[i]]);
     printf("\n");
     for (int i=1;i<=tot;i++) a[p[i]]=p[i];
}

void work2(int x,int y){
     int p[6];
     int tot=0;
     p[++tot]=x;int i=x;
     while (a[i]!=x){
           p[++tot]=a[i];
           i=a[i];
     }
     p[++tot]=y;i=y;
     while (a[i]!=y){
           p[++tot]=a[i];
           i=a[i];
     }
     printf("%d\n",tot);
     for (int i=1;i<=tot;i++) printf("%d ",p[i]);
     printf("\n");
     for (int i=1;i<=tot;i++) printf("%d ",a[p[i]]);
     printf("\n");
     for (int i=1;i<=tot;i++) a[p[i]]=p[i];
}

void work3(int x){
     int p1=a[x];
     int p2=a[p1];
     int p3=a[p2];
     int p4=a[p3];
     int p5=a[p4];
     printf("5\n");
     printf("%d %d %d %d %d\n",x,p1,p2,p3,p4);
     printf("%d %d %d %d %d\n",p1,p2,p3,p4,x);
     a[p1]=p1;a[p2]=p2;a[p3]=p3;a[p4]=p4;
     a[x]=p5;
}

void work4(int x,int y,int z){
     int p1=x,p2=a[x],p3=a[a[x]];
     int p4=y,p5=a[y];
     printf("5\n");
     printf("%d %d %d %d %d\n",p1,p2,p3,p4,p5);
     printf("%d %d %d %d %d\n",p2,p3,p1,p5,p4);
     a[p1]=p1;a[p2]=p2;a[p3]=p3;a[p4]=a[p5];a[p5]=p5;
     work2(y,z);
}

int main(){
    //freopen("d:/input.txt","r",stdin);
    //freopen("d:/output.txt","w",stdout);
    int n;
    scanf("%d",&n);
    for (int i=1;i<=n;i++) scanf("%d",&a[i]);
    int p2=0,p3=0,ans=0;
    for (int i=1;i<=n;i++){
        if (v[i]) continue;
        int j=i;
        b[i]=1;
        v[i]=true;
        while (a[j]!=i){
              b[i]++;
              j=a[j];
              v[j]=true;
        }
        if (b[i]%4==2) p2++;
        if (b[i]%4==3) p3++;
        if (b[i]>=4) ans+=b[i]/4;  
    }
    ans+=min(p2,p3);
    if (p2>p3) ans+=(p2-p3+1)/2;
    else ans+=((p3-p2)/3)*2+(p3-p2)%3;
    p2=p3=0;
    printf("%d\n",ans);
    for (int i=1;i<=n;i++){
        if (b[i]==0) continue;
        while (b[i]>5){
              work3(i);
              b[i]-=4;
        }
        if (b[i]>=4) work1(i);
        if (b[i]==2) c[++p2]=i;
        if (b[i]==3) d[++p3]=i;
    }
    for (int i=1;i<=min(p2,p3);i++) work2(c[i],d[i]);
    if (p2>p3){
        int tmp=p2-p3;
        for (int i=p3+1;i<=p2;i+=2){
            if (i==p2) work1(c[i]);
            else work2(c[i],c[i+1]);
        }
    }
    else {
       for (int i=p2+1;i<=p3;i+=3){
           if (i+2<=p3) work4(d[i],d[i+1],d[i+2]);
           else for (int j=i;j<=p3;j++) work1(d[j]);
       }
    }
    return 0;
}
    
     
     
