#include <stdio.h>
#include <algorithm>
#include <vector>
using namespace std;
const int maxn=110000;
int a[maxn],nov[maxn];
vector < vector<int> > gp[10];
struct point 
{
    vector<int> as[2];
};
vector <point> as;
void dfs(int i,vector<int> &tmp,int in)
{
    nov[i]=0;
    tmp.push_back(i);
    if(a[i]==in)return;
    dfs(a[i],tmp,in);
}
void gao(vector <int> &tmp,int k)
{
    if(as.size()==0||as.back().as[0].size()+k>5)as.resize(as.size()+1);
    if(k==tmp.size())
    {
        for(int i=0;i<tmp.size();i++)
        {
            as.back().as[1].push_back(tmp[(i+1)%tmp.size()]);
            as.back().as[0].push_back(tmp[i]);
        }
        tmp.clear();
    }
    else
    {
        for(int i=tmp.size()-k;i<tmp.size()-1;i++)
        {
            as.back().as[1].push_back(tmp[i+1]);
            as.back().as[0].push_back(tmp[i]);
        }
        as.back().as[1].push_back(tmp[tmp.size()-k]);
        as.back().as[0].push_back(tmp.back());
        for(int i=0;i<k-1;i++)tmp.pop_back();
    }
}
int main()
{
    int n;
    while(scanf("%d",&n)!=EOF)
    {
        for(int i=1;i<=n;i++)scanf("%d",&a[i]);
        gp[2].clear();gp[3].clear();
        vector<int> tmp;
        as.clear();
        for(int i=1;i<=n;i++)nov[i]=1;
        for(int i=1;i<=n;i++)
        if(nov[i])
        {
            tmp.clear();
            dfs(i,tmp,i);
            while(tmp.size()>=4)gao(tmp,min(5,(int)tmp.size()));
            if(tmp.size()==2||tmp.size()==3);
            gp[tmp.size()].push_back(tmp);
        }
        while(gp[2].size()>0||gp[3].size()>0)
        {
            if(gp[2].size()>0&&gp[3].size()>0)
            {
                gao(gp[2].back(),2);gp[2].pop_back();
                gao(gp[3].back(),3);gp[3].pop_back();
            }
            else if(gp[3].size()>=2)
            {
                gao(gp[3].back(),3);gp[3].pop_back();
                gao(gp[3].back(),2);
                gp[2].push_back(gp[3].back());
                gp[3].pop_back();
            }
            else if(gp[2].size()>=2)
            {
                gao(gp[2].back(),2);gp[2].pop_back();
                gao(gp[2].back(),2);gp[2].pop_back();
            }
            else 
            {
                if(gp[2].size()>0)
                {
                    gao(gp[2].back(),2);gp[2].pop_back();
                }
                else 
                {
                    gao(gp[3].back(),3);gp[3].pop_back();
                }
            }
        }
        printf("%d\n",(int)as.size());
        for(int i=0;i<as.size();i++)
        {
            printf("%d\n",as[i].as[0].size());
            for(int j=0;j<2;j++)
            {
                for(int p=0;p<as[i].as[j].size()-1;p++)
                printf("%d ",as[i].as[j][p]);
                printf("%d\n",as[i].as[j].back());
            }
        }
    }
}
