#include <bits/stdc++.h>
using namespace std;

int main() {
int i,j,k,l,r,m,n,t=0,o;
cin>>n;
pair<int,int>a[n];
vector<int> v[100001];
for(i=0;i<n;i++){
    cin>>a[i].first>>a[i].second;
}
sort(a,a+n);
for(i=0;i<n;i++){
   t=abs(a[i].first-a[i].second);
   v[t].push_back(i);
}
int ans[n][2],len=0;
while(n--){
    cin>>m;
    t=0;
    int h=m;
    m=abs(m);
    for(i=0;i<v[m].size();i++){
        r=v[m][i];
        if(a[r].second-a[r].first==h) {t=1;
        v[m].erase(v[m].begin()+i);
          break;}
    }
    if(!t){cout<<"NO"; return 0;}
     else {ans[len][0]=a[r].first; ans[len][1]=a[r].second; len++; }
}
int p=0,q;
q=p;
map<int,int>z,y;
for(i=0;i<len;i++){
    p=ans[i][0]; q=ans[i][1];
    if((z[p]==0 || z[p]<q)  && (y[q]==0|| y[q]<p)) {z[p]=max(q,z[p]);     y[q]=max(y[q],p);  }
    else {cout<<"NO"; return 0;}
}
cout<<"YES"<<endl;
for(i=0;i<len;i++)  cout<<ans[i][0]<<" "<<ans[i][1]<<endl;
return 0;
}
