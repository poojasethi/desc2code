#include <iostream>
#include <cstdio>

using namespace std;

int main(){
	int n, x, y, d;
	cin >> n;
	int porlinea[2][200001];
	bool posible[200001]; 
	for (int i=0; i<200000; i++) {
		porlinea[0][i]=0;
		porlinea[1][i]=0;
		posible[i]=0;
	}
	int resx[n], resy[n], resi=0;
	posible[100000]=1;

	for (int i=0; i<n; i++) {
		scanf("%d %d",&x,&y);
		porlinea[0][y-x+100000]++;
	}

	for (int i=0; i<n; i++) {
		scanf("%d", &d);
		if (!posible[d+100000] || porlinea[1][d+100000] >= porlinea[0][d+100000]){
			cout << "NO" << endl;
			return 0;
		} else {
			posible[d+100000]=0;
			posible[d+100001]=1;
			posible[d+ 99999]=1;
			if (d>0) {
				resx[resi]=porlinea[1][d+100000];
				resy[resi]=d + porlinea[1][d+100000];
			} else {
				resx[resi]=-d + porlinea[1][d+100000];
				resy[resi]=porlinea[1][d+100000];
			}
			resi++;
			porlinea[1][d+100000]++;
		}
	} cout << "YES" << endl;
	for (int i=0; i<n; i++) {
		cout << resx[i] << ' ' << resy[i] << endl;
	}
}
