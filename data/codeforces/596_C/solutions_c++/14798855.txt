#include<bits/stdc++.h>
using namespace std;
#define sc(n) scanf("%lld",&(n))
#define f(i,k,n) for(int (i)=(k);(i)<(n);(i)++)
#define ll long long
#define pb push_back
#define mp make_pair
#define pa pair<ll,ll>
#define be(v) v.begin(),v.end()
#define x first
#define y second
#define mod ((ll)1e9 +7)
#define M (ll)(1e5 +1)

int main()
{
	ll n;
	sc(n);
	pa p[M];
	map<ll,set<pa > > m;
	f(i,0,n)
	{sc(p[i].x);sc(p[i].y);
	m[p[i].y-p[i].x].insert(p[i]);}
	
	vector<pa > v;ll a;
	f(i,0,n)
	{
		sc(a);
		if(m.count(a)&&m[a].size()>0)
		{
			pa q=*m[a].begin();
			m[a].erase(m[a].begin());
			v.pb(q);
			//cout<<q.x<<"    "<<q.y<<endl;
		}
	}
	ll flag=1;set<pa> s;
	if(v.size()!=n)flag=0;
	f(i,1,v.size())
	{
		if(v[i-1].x>=v[i].x&&v[i-1].y>=v[i].y)flag=0;
	}
	if(flag)cout<<"YES\n";
	else cout<<"NO\n";
	
	if(flag)
	{
		f(i,0,n)
		printf("%lld %lld\n",v[i].x,v[i].y);
	}
	return 0;
}
