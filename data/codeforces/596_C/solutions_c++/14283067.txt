#include <cstdio>
#include <vector>
#include <map>
#include <set>
#include <algorithm>

using namespace std;

#define mp(a, b) make_pair(a, b)
#define pb(a) push_back(a)

int main() {
	int n;
	map<int, set<pair<int, int> > > w;
	scanf("%d",&n);
	vector <pair<int, int> > ar(n);
	for (int i = 0; i < n; ++i) {
		int a, b;
		scanf("%d %d",&a, &b);
//		ar[i] = mp(a, b);
		w[b - a].insert(mp(a, b));
	}
	for (int i = 0; i < n; ++i) {
		int cur;
		scanf("%d",&cur);
		set<pair<int, int> >& tmp = w[cur];
		if (!tmp.size()) {
			printf("NO\n");
			return 0;
		}
		else {
			pair<long long int, long long int> p = *(tmp.begin());
			ar[i] = p;
			if (p.first + p.second + p.first * p.second > i) {
				printf("NO\n");
				return 0;
			}
			tmp.erase(tmp.begin());
		}
	}
	printf("YES\n");
	for (int i = 0; i < n; ++i) {
		printf("%d %d\n",ar[i].first, ar[i].second);
	}
}