#include <algorithm>
#include <utility>
#include <cstdio>
#include <queue>
#include <map>
#define x first
#define y second
#define mp make_pair
using namespace std;
const int N = 100005;
typedef pair<int, int> pii;
map<pii, int> h;
map<int, queue<int> > f;
int n, w[N];
pair<int, pii> a[N];
int main() {
	scanf("%d", &n);
	for (int i = 0; i < n; i++) {
		int x, y;
		scanf("%d%d", &x, &y);
		a[i] = mp(0, mp(x, y));
	}
	for (int i = 0; i < n; i++) {
		scanf("%d", w+i);
		f[w[i]].push(i);
	}
	sort(a, a+n);
	for (int i = 0; i < n; i++) {
		pii t = a[i].y;
		int s = t.y-t.x;
		if (f[s].empty()) { puts("NO"); return 0; }
		a[i].x = f[s].front();
		h[t] = a[i].x;
		h[t] = max(h[t], h[mp(t.x, t.y-1)]);
		h[t] = max(h[t], h[mp(t.x-1, t.y)]);
		if (h[t] != a[i].x) { puts("NO"); return 0; }
		f[s].pop();
	}
	sort(a, a+n);
	puts("YES");
	for (int i = 0; i < n; i++)
		printf("%d %d\n", a[i].y.x, a[i].y.y);
	return 0;
}
