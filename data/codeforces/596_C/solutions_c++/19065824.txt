#include <bits/stdc++.h>
using namespace std;

typedef pair<int,int> pii;
 
int main()
{
	int n;
	scanf("%d",&n);
	map<int,set<pii> > mp;
	vector<pii> v(n);
	for(int i=0;i<n;i++)
	{
		int x,y;
		scanf("%d%d",&x,&y);
		mp[y-x].insert(make_pair(x,y));
	}
	for(int i=0;i<n;i++)
	{
		int w;
		scanf("%d",&w);
		if(mp[w].empty())
		{
			printf("NO\n");
			return 0;
		}
		v[i]=*(mp[w].begin());
		mp[w].erase(mp[w].begin());
	}
	vector<int> row(n,-1);
	vector<int> col(n,-1);
	for(int i=0;i<n;i++)
	{
		int x=v[i].first;
		int y=v[i].second;
		if(row[x]!=y-1||col[y]!=x-1)
		{
			printf("NO\n");
			return 0;
		}
		row[x]++;
		col[y]++;
	}
	printf("YES\n");
	for(int i=0;i<n;i++) printf("%d %d\n",v[i].first,v[i].second);
	return 0;
}