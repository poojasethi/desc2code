#include<bits/stdc++.h>
using namespace std;
set <pair<int, int> > myset[200100];
vector < pair<int, int> > myvec;
int main()
{
	long long int n,t;
	int w[100010]={0};
	cin >> n;
	for(int i=0;i<n;i++)
	{
		int x,y;
		cin >>x>>y;
		myset[y-x+100000].insert(make_pair(x,y));
	}
	for(int i=0;i<n;i++)
	{
		cin >>w[i];	
	}
	for(int i=0;i<n;i++)
	{
		if(!myset[w[i]+100000].empty())
		{
			myvec.push_back(*myset[w[i]+100000].begin());		
			myset[w[i]+100000].erase(*myset[w[i]+100000].begin());		
		}
		else
		{
			cout <<"NO"<<endl;
			return 0;
		}
	}
	t=min(myvec[0].first,myvec[0].second);
	for(int i=1;i<n;i++)
	{
		if(t>=max(myvec[i].first,myvec[i].second))
		{
			cout <<"NO"<<endl;
			return 0;	
		}
		long long int temp=min(myvec[i].first,myvec[i].second);
		t=max(t,temp);
	}
	cout <<"YES"<<endl;
	for(int i=0;i<n;i++)
	{
		cout <<myvec[i].first << " "<<myvec[i].second<<endl; 		
	}
	return 0;
	
}
