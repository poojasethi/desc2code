#include <bits/stdc++.h>
using namespace std;
#define N 100006
int main() {
	map<int, set<pair<int, int> > > m;
	int n, i, x, y;
	cin >> n;
	for(i = 0; i < n; i++) {
		cin >> x >> y;
		int diff = y - x;
		m[diff].insert(make_pair(x, y));
	}
	vector<pair<int, int> > p(n);
	for(i = 0; i < n; i++) {
		cin >> x;
		if(m[x].empty()) {
			puts("NO");
			return 0;
		}
		p[i] = *m[x].begin();
		m[x].erase(m[x].begin());
	}
	vector<int> row(N, -1), col(N, -1);
	for(i = 0; i < n; i++) {
		x = p[i].first;
		y = p[i].second;
		if(col[x] != y - 1 || row[y] != x - 1) {
			puts("NO");
			return 0;
		}
		row[y]++;
		col[x]++;
	}
	stringstream out;
	out << "YES" << endl;
	for(i = 0; i < n; i++) out << p[i].first << " " << p[i].second << endl;
	cout << out.str();
	return 0;
}