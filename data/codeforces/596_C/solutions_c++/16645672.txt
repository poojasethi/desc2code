#include <bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

#define LL long long
#define PI 3.14159265358979

#define PII pair<int,int>
#define PLL pair<LL,LL>
#define mp make_pair
#define fi first
#define se second

using namespace std;

int n,d,p[200005];

vector<PII> V[200005];
vector<PII> res;
map<PII,bool> M;

int main(){
	scanf("%d",&n);
	FI(i,1,n){
		int x,y;
		scanf("%d %d",&x,&y);
		V[y-x+100000].push_back(mp(x,y));
	}
	FI(i,0,200000) sort(V[i].begin(),V[i].end());
	FI(i,1,n){
		scanf("%d",&d);
		d+=100000;
		if(p[d]==V[d].size()){
			printf("NO\n");
			return 0;
		}
		PII ins=V[d][p[d]++];
		if(ins.se>0 && !M.count(mp(ins.fi,ins.se-1))){
			printf("NO\n");
			return 0;
		}
		if(ins.fi>0 && !M.count(mp(ins.fi-1,ins.se))){
			printf("NO\n");
			return 0;
		}
		M[ins]=true;
		res.push_back(ins);
	}
	printf("YES\n");
	FI(i,0,n-1) printf("%d %d\n",res[i].fi,res[i].se);
	return 0;
}
