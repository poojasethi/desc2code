#include <bits/stdc++.h>

using namespace std;

typedef long long ll;
typedef pair<int, int> pii;

const int MAXN = 2e5 + 100, S = 1e5 + 50;

vector<pii> diag[MAXN];
int maxim[MAXN], ind[MAXN];
pii ans[MAXN];

int main(){
	ios::sync_with_stdio( false );
	cout.tie(0); cin.tie(0);

	int n; cin >> n;
	for (int i = 0; i < n; i++){
		int x, y; cin >> x >> y;
		diag[y -x + S].push_back(pii(x, y));
	}

	for (int i = 0; i < MAXN; i++)
		sort(diag[i].begin(), diag[i].end());

	memset(maxim, -1, sizeof maxim);

	for (int i = 0; i < n; i++){
		int w; cin >> w; w += S;

		if (ind[w] == diag[w].size()){
			cout << "NO\n";
			return 0;
		}

		ans[i] = diag[w][ ind[w]++ ];
		maxim[w]++;
		if (w <= S && (maxim[w -1] >= maxim[w] || maxim[w + 1] > maxim[w]) || w >= S && (maxim[w + 1] >= maxim[w] || maxim[w - 1] > maxim[w])){
			cout << "NO\n";
			return 0;
		}
	}

	cout << "YES\n";
	for (int i = 0; i < n; i++)
		cout << ans[i].first << " " << ans[i].second << "\n";



}
