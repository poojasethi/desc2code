#include <iostream>
#include <set>
#include <map>
#include <vector>
#define pii pair<int,int>
#define x first
#define y second
using namespace std;
int n,ar[200005],ht[100006];
map<int,set<pii> > mp;
vector<pii> ans;
int main() {
    cin>>n;
    for(int i=0;i<n;i++){
        int a,b;cin>>a>>b;
        mp[b-a].insert(pii(a,b));
    }
    for(int i=0;i<n;i++){
        cin>>ar[i];
        if(!mp.count(ar[i])){
            cout<<"NO";return 0;
        }
        pii p=*(mp[ar[i]].begin());
        mp[ar[i]].erase(mp[ar[i]].begin());
        if((p.x!=0&&ht[p.x-1]<=p.y)||(ht[p.x]!=p.y)){
            cout<<"NO";return 0;
        }
        ht[p.x]++;
        ans.push_back(p);
    }
    cout<<"YES\n";
    for(int i=0;i<n;i++){
        cout<<ans[i].x<<" "<<ans[i].y<<"\n";
    }
}