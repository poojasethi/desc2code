#include<bits/stdc++.h>
using namespace std;
int n;
int a,b;
int exm;
map< int,pair<int,int> >re;
map<int, set< pair<int,int> > >mp;
int main()
{
    scanf("%d",&n);
    re.clear();
    mp.clear();
    for(int i=0;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        mp[b-a].insert(make_pair(a,b));
    }
    for(int i=0;i<n;i++)
    {
        scanf("%d",&exm);
        if(mp[exm].empty())
        {
            printf("NO\n");
            return 0;
        }
        else
        re[i]=*mp[exm].begin();
        mp[exm].erase(mp[exm].begin());
    }
    for(int i=1;i<n;i++)
    {
        int x=re[i].first;
        int y=re[i].second;
        int prex=re[i-1].first;
        int prey=re[i-1].second;
        if(prex>=x&&prey>=y)
        {
            printf("NO\n");
            return 0;
        }
    }
    printf("YES\n");
    for(int i=0;i<n;i++)
    printf("%d %d\n",re[i].first,re[i].second);


    return 0;
}
