#include <bits/stdc++.h>
 
#define fi first
#define se second
#define pb push_back
#define mp make_pair
#define pii pair<int,int>
#define MOD 1000000007
#define ll long long int
#define MAXINT 1000000000
#define SET(x,y) memset(x,y,sizeof(x));

using namespace std;

map<pii,int> m;
map<int,pii> chances;
vector<pii> a; 
ll w[1000006];

void check(pii t) {
	if(m.find(t)==m.end())	return;
	t.fi--;
	if(m.find(t)!=m.end())	return;
	t.se--;
	t.fi++;
	if(m.find(t)!=m.end())	return;
	t.se++;
	chances[t.se-t.fi]=t;
}

int main() {
	int n,x,y,i,ans=1;
	cin>>n;
	for(i=1;i<=n;i++) {
		cin>>x>>y;
		m[mp(x,y)]=1;
	}
	for(i=1;i<=n;i++)	cin>>w[i];
	chances[0]=mp(0,0);
	for(i=1;i<=n;i++) {
		if(chances.find(w[i])==chances.end()) {
			ans=-1;
			break;
		}
		pii t=chances[w[i]];
		a.pb(t);
		m.erase(t);
		chances.erase(w[i]);
		t.fi++;
		check(t);
		t.se++;
		check(t);
		t.fi--;
		check(t);
	}
	if(ans==-1) cout<<"NO"<<endl;
	else {
		cout<<"YES"<<endl;
		for(i=0;i<n;i++)
			cout<<a[i].fi<<" "<<a[i].se<<endl;
	}
	return 0;
}