#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define sc(x) scanf("%d",&x)
#define scs(x) scanf("%s",x)
#define f(i,k,n) for(int i=k;i<n;i++)
#define scl(x)	scanf("%I64d",&x)

typedef pair<int,int> pii;
map<int,priority_queue<pii,vector<pii>,greater<pii> > > mp;
vector<pii>	v;

int main()
{	int n,x,y,w;
	sc(n);
	f(i,0,n)
	{
		sc(x);sc(y);
		mp[y-x].push(pii(x,y));
	}
	f(i,0,n)
	{
		sc(w);
		if(mp.find(w)==mp.end())
		{
			cout<<"NO";
			return 0;
		}
		pii cur=mp[w].top();
		if(!v.empty())
		{
			pii temp=v.back();
			if(temp.first >= cur.first &&  temp.second >= cur.second)
			{
				cout<<"NO";
				return 0;
			}
		}
		v.push_back(cur);
		mp[w].pop();	
	}
	cout<<"YES\n";
	f(i,0,v.size())
		printf("%d %d\n",v[i].first,v[i].second);
	return 0;
	
}
