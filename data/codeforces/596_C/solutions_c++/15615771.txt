#include <bits/stdc++.h>
using namespace std;

#define fi first
#define se second

int n;
int w[100005];
int new_index[100005];
pair<int,int>p[100005];
pair<int,int>ans[100005];
map<int, vector<int> >idx;
map<int,int>cnt;
map<int,int>Iam;

int main(){

	cin >> n;
	for (int i = 0; i < n; i++)
		scanf ("%d %d", &p[i].fi, &p[i].se);

	sort(&p[0], &p[n]);

	for (int i = 0; i < n; i++){
		scanf ("%d", w+i);
		idx[w[i]].push_back(i);
		cnt[w[i]]++;
	}

	for (int i = 0; i < n; i++){
		int s = p[i].se - p[i].fi;
		if (cnt[s]){
			int index = idx[s][Iam[s]];
		
			ans[index] = p[i];
			new_index[i] = index;
		
			Iam[s]++;			
			cnt[s]--;
		}else {
			cout << "NO"; return 0;
		}
	}
	for (int i = 0; i < n-1; i++){
		if (ans[i].fi >= ans[i+1].fi and ans[i].se >= ans[i+1].se){
			cout << "NO"; return 0;
		}
	}

	cout << "YES" << endl;
	for (int i = 0; i < n; i++){
		printf ("%d %d\n", ans[i].fi, ans[i].se);
	}

	return 0;
}
