#include <bits/stdc++.h>

using namespace std;

typedef long long ll;

#define pii pair<int,int>
#define pll pair<ll,ll>
#define PB push_back
#define MP make_pair
#define X first
#define Y second
#define N 100000

vector< vector< pii > > v;
vector<int> b;
vector< pii > p;
int a[N];

int main(){
	int n,i,j,k;

	v.resize(2*N+1);
	b.resize(2*N+1);

	scanf("%d", &n);
	p.resize(n);

	for(k=0;k<n;k++){
		scanf("%d%d", &i, &j);

		v[j-i+N].PB(MP(i,j));
	}

	for(k=0;k<n;k++){
		scanf("%d", &a[k]);
		b[a[k]+N]++;
	}

	for(k=0;k<2*N+1 && v[k].size()==b[k];k++){
		sort(v[k].begin(),v[k].end());
		b[k]=0;
	}

	if(k!=2*N+1 || a[0]!=0)
		printf("NO\n");
	else{
		for(i=0;i<n;i++){
			k = a[i]+N;
			p[i]=v[k][b[k]];
			b[k]++;
		}

		for(i=0;i<N+1;i++)
			b[i]=0;

		for(i=0;i<n;i++){
			if(b[p[i].X]>p[i].Y)
				break;
			else
				b[p[i].X]=p[i].Y;
		}

		// printf("%d\n", i);

		if(i!=n)
			printf("NO\n");
		else{
			printf("YES\n");

			for(i=0;i<n;i++)
				printf("%d %d\n", p[i].X, p[i].Y);
		}
	}

	return 0;
}