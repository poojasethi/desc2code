// In the name of Allah

#include <bits/stdc++.h>
using namespace std;
typedef pair <int, int> pii;
#define rep(i,n) for (int i = 0; i < n; i ++)

const int max_n = 100*1000, d = 100*1000;
vector <pii> v [2*max_n+1];
int ind [2*max_n+1];
pii ans [max_n];

int main ()
{
	int n;
	cin >> n;
	rep (i, n)
	{
		int x, y;
		cin >> x >> y;
		v [y-x+d].push_back (make_pair (x, y));
	}
	rep (i, 2*max_n+1)
		sort (v[i].begin(), v[i].end());
	rep (i, n)
	{
		int w;
		cin >> w;
		if ( ind[w+d] == v[w+d].size() )
		{
			cout << "NO" << endl;
			return 0;
		}
		ans [i] = v[w+d][ind[w+d]++];
		if ( i && ans[i-1].first >= ans[i].first && ans[i-1].second >= ans[i].second )
		{
			cout << "NO" << endl;
			return 0;
		}
	}
	cout << "YES" << endl;
	rep (i, n)
		cout << ans[i].first << " " << ans[i].second << endl;
}
