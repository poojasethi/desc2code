#include <bits/stdc++.h>
using namespace std;

typedef pair<int, int> PII;
#define MP(x, y) make_pair(x, y)
#define PB push_back
#define AA first
#define BB second
PII num[100100];
int main() {
    map<int, set<PII> >q;
    int n; scanf("%d", &n);
    for(int i = 0; i < n; i++) {
        int x, y;
        scanf("%d%d", &x, &y);
        q[y - x].insert(MP(x, y));
    }

    for(int i = 0; i < n; i++) {
        int w; scanf("%d", &w);
        if(!q[w].size()) {
            puts("NO");
            return 0;
        }
        num[i] = *q[w].begin();
        q[w].erase(q[w].begin());
    }
    for(int i = 0; i < n - 1; i++) {
        if(num[i].AA >= num[i + 1].AA && num[i].BB >= num[i + 1].BB)  {
            puts("NO");
            return 0;
        }
    }
    puts("YES");
    for(int i = 0; i < n; i++) {
        printf("%d %d\n", num[i].AA, num[i].BB);
    }
    return 0;
}
	   	   	 			   	   				   	 	