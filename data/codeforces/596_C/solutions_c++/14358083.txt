#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <vector>
#include <map>
#include <set>

using namespace std;

const int N = 200010;

int main() {
	int n;
	scanf("%d", &n);
	map < int, set < pair <int, int> > > mp;
	for (int i = 0; i < n; i++) {
		int x, y;
		scanf("%d %d", &x, &y);
		mp[y - x].insert(make_pair(x, y));
	}
	vector < pair <int, int> > p(N);
	for (int  i = 0; i < n; i++) {
		int t;
		scanf("%d", &t);
		if (mp[t].empty()) {
			puts("NO");
			return 0;
		}
		p[i] = *mp[t].begin();
		mp[t].erase(mp[t].begin());
	}
	vector <int> row(N, 0);
	vector <int> col(N, 0);
	for (int i = 0; i < n; i++) {
		int x = p[i].first;
		int y = p[i].second;
		if (row[x] != y || col[y] != x) {
			puts("NO");
			return 0;
		}
		row[x]++;
		col[y]++;
	}
	puts("YES");
	for (int i = 0; i < n; i++) {
		int x = p[i].first;
		int y = p[i].second;
		printf("%d %d\n", x, y);
	}
	return 0;
}