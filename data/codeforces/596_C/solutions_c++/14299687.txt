#define N (1<<17)
#define PII pair<int,int>
#include <bits/stdc++.h>
using namespace std;

int n,x,y,v,p[N<<1];
vector<int> H[N],V[N];
vector<PII> res,f[N<<1];

int main()
{
	cin>>n;
	for(int i=1;i<=n;i++)
		scanf("%d%d",&x,&y),f[y-x+N].push_back(PII(x,y));
	for(int i=0;i<N<<1;i++)
		sort(f[i].begin(),f[i].end());
	for(int i=1;i<=n;i++)
	{
		scanf("%d",&v),v+=N;
		if(p[v]==f[v].size())
		{
			puts("NO");
			return 0;
		}
		x=f[v][p[v]].first,y=f[v][p[v]++].second;
		res.push_back(PII(x,y)),H[x].push_back(y),V[y].push_back(x);
	}

	for(int i=0;i<N;i++)
	{
		for(int j=1;j<H[i].size();j++)
			if(H[i][j]<H[i][j-1])
			{
				puts("NO");
				return 0;
			}
		for(int j=1;j<V[i].size();j++)
			if(V[i][j]<V[i][j-1])
			{
				puts("NO");
				return 0;
			}
	}
	puts("YES");
	for(int i=0;i<res.size();i++)
		printf("%d %d\n",res[i].first,res[i].second);
	return 0;
}
