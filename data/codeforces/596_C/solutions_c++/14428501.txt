#include <bits/stdc++.h>
using namespace std;
#define pb push_back
#define st first
#define nd second
#define mp make_pair
set<pair<int,int> > q[400005];
int main(){
    int n,add=200000,u;
    cin>>n;
    pair<int,int> t,at,bt;
    for(int i=0;i<n;++i){
        cin>>t.st>>t.nd;
        q[t.nd-t.st+add].insert(t);
    }
    vector<pair<int,int> > a;
    for(int i=0;i<n;++i){
        cin>>u; u+=add;
        if(q[u].empty()) {
            puts("NO");
            return 0;
        }
        a.push_back(*(q[u].begin()));
        q[u].erase(q[u].begin());
        at=*(q[u-1].begin()); bt=*(q[u+1].begin());
        if((u>0&&!q[u-1].empty()&&a.back().st>=at.st)||(u<400000&&!q[u+1].empty()&&bt.st<=a.back().st-1)){
            puts("NO");
            return 0;
        }
    }
    puts("YES");
    for(int i=0;i<n;++i)
        cout<<a[i].st<<" "<<a[i].nd<<endl;
}