#include<stdio.h>
#include<map>
#include<set>
#include<utility> //pair
using namespace std;

typedef pair<int,int> PII;
int n;
PII anslist[100010];

int main(){
	map<int,set<PII> >sub;//值是set型 
	int i,x,y,test;
	scanf("%d",&n);
	for(i=0;i<n;i++){
		scanf("%d%d",&x,&y);
		sub[y-x].insert(make_pair(x,y));//[]方式用map，及相关函数 
	}	
	
	for(i=0;i<n;i++){
		scanf("%d",&test);
		if(sub[test].size()==0){
			printf("NO");
			return 0;	
		}
	anslist[i]=*sub[test].begin();	
	sub[test].erase(sub[test].begin());//删除一个key对应的velue之一。 
	} 
	
	for (i=0;i<n-1;i++){
		if(anslist[i].first>=anslist[i+1].first&&anslist[i].second>=anslist[i+1].second){
			printf("NO\n");
			return 0; 
		}
	}
	
	printf("YES\n");
	for(i=0;i<n;i++){
		printf("%d %d\n",anslist[i].first,anslist[i].second);
	}
	
	return 0;
}
	 	 			 	 	     		 	  	 	 	  		