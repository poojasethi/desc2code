#include<iostream>
#include<stdio.h>
#include<queue>
using namespace std;

struct node{
	int x,y;node(int xx,int yy)
	{
		x=xx,y=yy;
	} node(){}
};	
	bool operator < (node a,node b)
	{
		if(a.x!=b.x) 
		return a.x>b.x;
		else
		return a.y>b.y;
	}
priority_queue<node> q[300000];
vector<node> ans;
int n;
int main()
{
	scanf("%d",&n);
	for(int i=1;i<=n;i++)
	{
		node a;
		scanf("%d%d",&a.x,&a.y);
		int o=100001+a.y-a.x;
		q[o].push(a);
	}
	int x1=-1;
	int y1=-1;

	for(int i=1;i<=n;i++) 
	{	
		int aaa;
		scanf("%d",&aaa);
		if(q[aaa+100001].empty())
		{
			cout<<"NO"<<endl;
			return 0;
		}
		node aa=q[aaa+100001].top();
		q[aaa+100001].pop();
		if(aa.x>x1||aa.y>y1) 
		{
		ans.push_back(aa);
		x1=aa.x;
		y1=aa.y;
		}
		else
		{
			cout<<"NO";
			return 0;
		}
	}
	cout<<"Yes"<<endl;
	for(int i=0;i<ans.size();i++)
	cout<<ans[i].x<<" "<<ans[i].y<<endl;
			
}