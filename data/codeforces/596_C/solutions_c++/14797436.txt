#include<bits/stdc++.h>
#define fi first
#define se second
using namespace std;
typedef pair<int,int> pii;
pii ans[100100];
int main()
{
    int n,a,b;
    cin>>n;
    map<pii, pii> mp;
    map<pii, pii>::iterator it;

    for(int i=0;i<n;i++)
    {
        scanf("%d%d",&a,&b);
        mp[make_pair(b-a,b+a)]=make_pair(a,b);
    }
    for(int i=0;i<n;i++)
    {
        scanf("%d",&a);
        it=mp.lower_bound(make_pair(a,0));
        if(it==mp.end() || it->fi.fi!=a || (it->se.fi+1)*(it->se.se+1)>i+1) return puts("NO"), 0;
        ans[i]=it->se;
        mp.erase(it);
    }
    puts("YES");
    for(int i=0;i<n;i++)
        printf("%d %d\n",ans[i].fi,ans[i].se);
    return 0;
}


