#include <bits/stdc++.h>
using namespace std;
#define fi first
#define se second

typedef pair<int, int> pii;
typedef vector<pii> Container;
typedef greater<pii> Comparer;
typedef priority_queue<pii, Container, Comparer> Queue;
map<int, Queue> m;
Container ans;
int n, x, y, d;

void solve() {
  scanf("%d", &n);
  for (int i = 0; i < n; i++) {
    scanf("%d%d", &x, &y);
    m[y-x].push(pii(x, y));
  }
  ans.resize(n);
  for (int i = 0; i < n; i++) {
    scanf("%d", &d);
    if (m[d].empty()) {
      puts("NO");
      return;
    }
    pii cur = m[d].top();
    if (i) {
      pii prev = ans[i-1];
      if (prev.fi >= cur.fi && prev.se >= cur.se) {
        puts("NO");
        return;
      }
    }
    ans[i] = cur;
    m[d].pop();
  }

  puts("YES");
  for (int i = 0; i < n; i++) {
    printf("%d %d\n", ans[i].fi, ans[i].se);
  }
}

int main() {
  solve();
}