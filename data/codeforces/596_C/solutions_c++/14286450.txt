#include <bits/stdc++.h>

using namespace std;

typedef pair<int, int> pii;
#define x first
#define y second
#define mp make_pair
#define pb push_back
#define MAXN 111111

struct cmp {
  bool operator()(const pii &a, const pii &b) {
    return a.x <= b.x && a.y <= b.y;
  }
};

int main() {
  int n; cin >> n;
  set<pii, cmp> spii;
  vector<set<pii, cmp> > V(2*MAXN, spii);
  for (int i = 0; i < n; ++i) {
    int x, y; cin >> x >> y;
    V[y-x+MAXN].insert(mp(x, y));
  }

  vector<pii> ANS;
  pii last = mp(-1, -1);
  for (int i = 0; i < n; ++i) {
    int w; cin >> w;
    if (V[w+MAXN].empty()) {
      cout << "NO" << endl;
      return 0;
    }
    pii next = *V[w+MAXN].begin();
    if (next.x <= last.x && next.y <= last.y) {
      cout << "NO" << endl;
      return 0;
    }
    last = next;
    ANS.pb(next);
    V[w+MAXN].erase(V[w+MAXN].begin());
  }
  cout << "YES" << endl;
  for (int i = 0; i < n; ++i) {
    cout << ANS[i].x << " " << ANS[i].y << endl;
  }

  return 0;
}
