#include <bits/stdc++.h>

using namespace std;

const int MAX = 100005;
map<int, set<pair<int, int> > > ar;
pair<int, int> P[MAX];
int cx[MAX], cy[MAX];

int main() {
    int N, x, y, w;
    scanf("%d", &N);
    for(int i = 0; i < N; i++) {
        scanf("%d %d", &x, &y);
        ar[y - x].insert(make_pair(x, y));
    }

    for(int i = 0; i < N; i++) {
        scanf("%d", &w);
        if(ar[w].size() == 0) {
            puts("NO");
            return 0;
        }
        P[i] = *ar[w].begin();
        ar[w].erase(ar[w].begin());
    }

    for(int i = 0; i < N; i++) {
        x = P[i].first;
        y = P[i].second;
        if(cx[x] != y || cy[y] != x) {
            puts("NO");
            return 0;   
        }
        cx[x]++;
        cy[y]++;
    }

    puts("YES");
    for(int i = 0; i < N; i++) {
        printf("%d %d\n", P[i].first, P[i].second);
    }

    return 0;
}