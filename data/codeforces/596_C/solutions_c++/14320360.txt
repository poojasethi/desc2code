#include <cstdio>
#include <vector>
#include <algorithm>

using namespace std;

#define N 100005

typedef pair <int, int> PII;

vector <PII> V[N + N];

int lim[N];
PII ord[N];

main() {
	int n;
	scanf("%d", &n);
	for (int i = 0; i < n; i ++) {
		int x, y;
		scanf("%d %d", &x, &y);
		int special = y - x + N;
		V[special].push_back(PII(-x, -y));
	}
	for (int i = 0; i < N + N; i ++) if (!V[i].empty()) {
		sort(V[i].begin(), V[i].end());
	}
	for (int i = 0; i < n; i ++) {
		int u;
		scanf("%d", &u);
		u += N;
		int sz = V[u].size();

		if (!sz) return puts("NO");
		else {
			int x = -V[u][sz - 1].first;
			int y = -V[u][sz - 1].second;
			V[u].pop_back();
			if (x != lim[y]) return puts("NO");
			else {
				lim[y] ++;
				if (y && lim[y] > lim[y - 1]) return puts("NO");
				ord[i] = PII(x, y);
			}
		}
	}
	puts("YES");
	for (int i = 0; i < n; i ++) printf("%d %d\n", ord[i].first, ord[i].second);
}
