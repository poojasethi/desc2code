#include <bits/stdc++.h>
using namespace std;

typedef pair<int, int> pii;
map<int, priority_queue<pii, vector<pii>, greater<pii> > > m;
vector<pii> ans;
int n, x, y, d;

void solve() {
  scanf("%d", &n);
  for (int i = 0; i < n; i++) {
    scanf("%d%d", &x, &y);
    m[y-x].push(pii(x, y));
  }
  for (int i = 0; i < n; i++) {
    scanf("%d", &d);
    if (m.find(d) == m.end()) {
      puts("NO");
      return;
    }
    pii cur = m[d].top();
    if (!ans.empty()) {
      pii prev = ans.back();
      if (prev.first >= cur.first && prev.second >= cur.second) {
        puts("NO");
        return;
      }
    }
    ans.push_back(cur);
    m[d].pop();
  }

  puts("YES");
  for (int i = 0; i < n; i++) {
    printf("%d %d\n", ans[i].first, ans[i].second);
  }
}

int main() {
  solve();
}