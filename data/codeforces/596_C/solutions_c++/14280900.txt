#include<stdio.h>
#include<iostream>
#include<algorithm>
#include<vector>
#include<map>
using namespace std;
int a[100010];
typedef pair<int,int> PII;
map<PII, bool> has;
map<PII, bool> contains;
map<int, int> ct;
int main() {
  int n;scanf("%d", &n);
  for(int i=0;i<n;i++){
    int x,y;
    scanf("%d%d", &x,&y);
    contains[PII(x,y)]=true;
  }
  for(int i=0;i<n;i++)scanf("%d",a+i);
  vector<PII> res;
  for(int i=0;i<n;i++) {
    int ofs = ct[a[i]]++;
    int tx,ty;
    if(a[i]==0)tx=ty=ofs;
    else if (a[i]<0) tx=-a[i]+ofs,ty=ofs;
    else tx=ofs,ty=a[i]+ofs;
    PII p(tx,ty);
    if(contains[p] 
        && (tx==0 || has[PII(tx-1,ty)]) 
        && (ty==0 || has[PII(tx, ty-1)])) {
      res.push_back(p);
      has[p]=true;
    } else {
      break;
    }
  }
  if(res.size() != n) {
    printf("NO\n");
  }else {
    printf("YES\n");
    for(int i=0;i<n;i++)printf("%d %d\n",res[i].first,res[i].second);
  }
  return 0;
}
