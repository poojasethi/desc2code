R=lambda:map(int, raw_input().split())
n=input()
a=sorted([R() for i in range(n)], key=lambda x:(x[1]-x[0],x[0]))
b=sorted(zip(R(),range(1,n+1)))
if all(map(lambda i:a[i][1]-a[i][0]==b[i][0] and b[i][1]>=(a[i][0]+1)*(a[i][1]+1),range(n))):
    print 'YES'
    c=[0]*n
    for i in range(n): c[b[i][1]-1]=a[i]
    for i in range(n): print c[i][0], c[i][1]
else:
    print 'NO'