#include<iostream>
#include<algorithm>
using namespace std;
pair <int,int> a[100000],b[100000];
int i,j,k,k1,l1,l,n,m,s=0;
int main(){ l=0; k=0;
cin>>n; cin>>m;
for(i=1; i<=n; i++) {cin>>j; if (j==1) {l++; cin>>a[l].first; a[l].second=i;}
                            else {k++; cin>>b[k].first; b[k].second=i;}}
sort(a+1, a+l+1); sort(b+1,b+k+1);
k1=k; l1=l;
if (m<2 && a[1].first==0) {cout<<0; return 0;}
if (m%2==1) {s=s+a[l].first; a[l].first=0; l--; m--;}
while(m!=0){
if (a[l].first+a[l-1].first>b[k].first){ m=m-2; s=s+a[l].first+a[l-1].first; a[l].first=0; a[l-1].first=0; l=l-2; if (l<0) l=0;}
else {m=m-2; s=s+b[k].first; b[k].first=0; k--; if (k<0) k=0;}


}
cout<<s<<endl;
for(i=1; i<=l1; i++) if (a[i].first==0) cout<<a[i].second<<' ';
for(i=1; i<=k1; i++) if (b[i].first==0) cout<<b[i].second<<' ';
}