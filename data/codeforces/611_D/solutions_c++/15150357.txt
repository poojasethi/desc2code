// :)
#include <bits/stdc++.h>

typedef long long ll;
using namespace std;

#define MOD 1000000007
int dp[5010][5010],sum[5010][5010],nxt[5010][5010];

int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(NULL);
    int i,j,n,x;
    string s;
    cin>>n;
    cin>>s;
    for(i=n-1;i>=0;i--) {
        for(j=i;j<n;j++) {
            if(s[i]!=s[j]) nxt[i][j]=0;
            else nxt[i][j]=nxt[i+1][j+1]+1;
        }
    }
    for(i=0;i<n;i++) {
        for(j=i;j>=0;j--) {
            if(s[j]=='0') dp[j][i]=0;
            else if(j==0) dp[j][i]=1;
            else {
                dp[j][i]=(2*j-i>=0?sum[2*j-i][j-1]:sum[0][j-1]);
                if(2*j-i>=1) {
                    x=nxt[2*j-i-1][j];
                    if(x<=(i-j) && s[j+x]>s[2*j-i-1+x])
                        dp[j][i]=(dp[j][i]+dp[2*j-i-1][j-1])%MOD;
                }
            }
            if(j==i) sum[j][i]=dp[j][i];
            else sum[j][i]=(sum[j+1][i]+dp[j][i])%MOD;
        }
    }
    cout<<sum[0][n-1]<<'\n';
    return 0;
}