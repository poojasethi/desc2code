#define N 5001
#define M 1000000007
#include <bits/stdc++.h>
using namespace std;

char s[N];
int n,f[N][N],g[N][N],dp[N][N];

int main()
{
	cin>>n>>(s+1);

	for(int i=n;i>=1;i--)
		for(int j=n;j>=i;j--)
			if(s[i]==s[j]) f[i][j]=f[i+1][j+1]+1;
			else f[i][j]=0;

	dp[0][0]=g[0][0]=1;
	for(int i=1;i<=n;i++)
	{
		for(int j=1;j<=i;j++)
		{
			int last=i-j;
			if(s[last+1]=='0')
				dp[i][j]=0;
			else if(j>last)
				dp[i][j]=g[last][last];
			else
			{
				int k=last-j+1,p=f[k][last+1];
				if(p<j && s[last+p+1]>s[k+p]) dp[i][j]=g[last][j];
				else dp[i][j]=g[last][j-1];
			}
		}
		for(int j=1;j<=i;j++)
			g[i][j]=g[i][j-1]+dp[i][j],g[i][j]%=M;
	}
	cout<<g[n][n]<<endl;
	return 0;
}
