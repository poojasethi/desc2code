#include <bits/stdc++.h>

using namespace std;

typedef long long ll;

#define pii pair<int,int>
#define pll pair<ll,ll>
#define PB push_back
#define MP make_pair
#define X first
#define Y second
#define N 5002
#define M 1000000007

int d[N][N], next[N][N];
char s[N];

int main(){
	int n,i,j,k,x;

	scanf("%d", &n);
	scanf("%s", s);

	for(i=n+1;i>0;i--)
		s[i]=s[i-1];

	for(i=n;i>0;i--){
		for(j=i-1;j>0;j--){
			if(s[j]==s[i])
				next[j][i]=1+next[j+1][i+1];
		}
	}

	for(i=1;i<n+1;i++){
		for(j=i,k=i-1;j>1;j--,k-=2){
			if(s[j]=='0');
			else{
				if(k>0){
					x=next[k][j];
					if(k+x<j && j+x<i+1){
						if(s[k+x]<s[j+x])
							d[j][i]=d[k][j-1];
						else
							d[j][i]=d[k+1][j-1];
					}
					else
						d[j][i]=d[k+1][j-1];
				}
				else
					d[j][i]=d[1][j-1];
			}
		}

		for(d[1][i]=1,j=i-1;j>0;j--)
			d[j][i]=(d[j][i]+d[j+1][i])%M;
	}

	printf("%d\n", d[1][n]);

	return 0;
}