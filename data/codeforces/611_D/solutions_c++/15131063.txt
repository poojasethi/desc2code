#include <iostream>
#include <cmath>
#include <cstdlib>
#include <cstdio>
#define mod 1000000007
#define N 5010
#define LL long long 

using namespace std;


int n,lcp[N][N];
LL dp[N][N];
char s[N];

int main ()
{
	//freopen("cs.in","r",stdin);
	//freopen("cs.out","w",stdout);
	scanf("%d",&n);
	scanf("%s",s+1);
	for(int i=n;i>=1;i--)
	{
		for(int j=n;j>=1;j--)
		{
			if(s[i]==s[j])lcp[i][j]=lcp[i+1][j+1]+1;
			else lcp[i][j]=0;
		}
	}
	dp[0][0]=1;
	for(int r=1;r<=n;r++)
	{
		for(int l=1;l<=r;l++)
		{
			int len=r-l+1;
			if(s[l]=='0')dp[l][r]=dp[l-1][r];
			else if(l-1>=len)
			{
				if(lcp[l-len][l]>=len||s[lcp[l-len][l]+l-len]>s[lcp[l-len][l]+l])
				{
					dp[l][r]=(dp[l-1][r]+dp[l-1][l-1]-dp[l-len][l-1])%mod;
				}
				else 
				{
					dp[l][r]=(dp[l-1][r]+dp[l-1][l-1]-dp[l-len-1][l-1])%mod;
				}
			}
			else dp[l][r]=(dp[l-1][r]+dp[l-1][l-1])%mod;
			if(dp[l][r]<0)dp[l][r]+=mod;
		}
	}
	cout<<dp[n][n]<<endl;
	return 0;
}
