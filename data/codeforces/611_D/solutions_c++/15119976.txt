#include <stdio.h>
#include <cstdlib>
#include <algorithm>
#include <queue>
#include <vector>
#include <string>
#include <map>
#include <iostream>
using namespace std;

const int N=5010;
const int MOD=1000*1000*1000+7;
string s;
int n,i,j,sum[N][N],X,k,res[N][N];
int prec[N][N];

bool is_less(int x,int y,int l){

 x++;
 y++;

 if ( prec[x][y]>=l ) return false;
 l=prec[x][y];
 if ( s[x+l]<s[y+l] ) return true;
               else return false;
}

main(){
 cin>>n;
 cin>>s;
 s="#"+s+"#";

 for ( i=n;i>=1;i-- )
  for ( j=n+1;j>i;j-- )
   {
    if ( s[i]!=s[j] ) continue;
    prec[i][j]=1+prec[i+1][j+1];
   }

 for ( j=0;j<=n;j++ )
  sum[0][j]=1;

 for ( i=1;i<=n;i++ )
  for ( j=1;j<=n;j++ )
   {
    X=0;
    if ( j>i ) goto down;

    k=i-j;
    X=sum[k][j-1];
    if ( k>=j && is_less(k-j,i-j,j) ) X+=res[k][j];  X%=MOD;

    down:
    if ( s[i-j+1]=='0' ) X=0;
    res[i][j]=X;
    sum[i][j]=sum[i][j-1]+X; sum[i][j]%=MOD;
   }

 cout<<sum[n][n]<<endl;
}
