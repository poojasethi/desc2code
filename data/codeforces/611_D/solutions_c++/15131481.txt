#include <iostream>
using namespace std;

int n;
string s;
int f[5001][5001], t[5002][5002];
const int mod = 1e9 + 7;

int cmp(int i, int j, int len) {
    if (t[i][j] >= len) return 0; return s[i + t[i][j]] < s[j + t[i][j]];
}

int main() {
    cin >> n;
    cin >> s; s = '~' + s;
    for (int i = n; i > 0; --i) for (int j = n; j > 0; --j) t[i][j] = (s[i] == s[j] ? t[i + 1][j + 1] + 1 : 0);
    for (int i = 0; i <= n; ++i) f[0][i] = 1;
    for (int i = 1; i <= n; ++i) {
        for (int j = 1; j <= n; ++j) {
            f[i][j] = f[i][j - 1]; if (j > i || s[i - j + 1] == '0') continue;
            if (i - 2 * j + 1 > 0 && cmp(i - 2 * j + 1, i - j + 1, j)) f[i][j] = (f[i][j] + f[i - j][j]) % mod;
            else f[i][j] = (f[i][j] + f[i - j][j - 1]) % mod;
        }
    }
    cout << f[n][n] << endl;
}