#include<bits/stdc++.h>
using namespace std;

int _mod(int a) { if(a>=1e9+7) a-=1e9+7; return a; }

int dp[5005][5005],nxt[5005][5005],sum[5005][5005];
char c[5005];

int main(){
	int n;
	int ans=0;
	cin >> n;
	for(int i=1;i<=n;++i) cin >> c[i];
	for(int i=n;i>=1;--i) for(int j=n;j>=i;j--) { if(c[i]!=c[j]) nxt[i][j]=0; else nxt[i][j]=nxt[i+1][j+1]+1; }
	dp[0][0]=1;
	for(int i=1;i<=n;++i){
		for(int j=i;j<=n;++j){
			if(c[i]!='0'){
				int k=max(2*i-j-1,0);
				dp[i][j]=_mod(_mod(1e9+7-sum[k][i-1])+sum[i-1][i-1]);
				if(c[i+nxt[k][i]]>c[k+nxt[k][i]]&&k+nxt[k][i]<=i-1) dp[i][j]=_mod(dp[k][i-1]+dp[i][j]);
				if(j==n) ans=_mod(dp[i][j]+ans);
			}
			sum[i][j]=_mod(sum[i-1][j]+dp[i][j]);
		}
	}
	cout << ans;
}