#include <iostream>
#include <algorithm>
using namespace std;

const int N = 5001,M=1e9+7.5;

int main(){
    ios_base::sync_with_stdio(0);   cin.tie();
    int l;  cin>>l;
    string s;   cin>>s;
    int next[N][N];
    for(int i=0;i<N;i++)    for(int j=0;j<N;j++)    next[i][j] = 0;

    for(int i=l-1;i>=0;i--) for(int j=l-1;j>=0;j--){
        next[i][j] = s[i]!=s[j]?0:1+next[i+1][j+1];
    }

    int dp[N][N];
    for(int i=0;i<N;i++)    for(int j=0;j<N;j++)    dp[i][j]==0;

    dp[0][1] = 1;

    for(int i=1;i<l;i++)    for(int j=1;j<=i+1;j++){
        dp[i][j] = dp[i][j-1];
        if(j==i+1)  {   dp[i][j]++; dp[i][j]%=M;    continue;   }   
        if(s[i-j+1]=='0')   continue;
        if(i-j<j-1) {   dp[i][j]+=dp[i-j][i-j+1];   dp[i][j]%=M;    continue;   }

        if(next[i-j+1][i-2*j+1]<j&&s[i-j+1+next[i-j+1][i-2*j+1]]>s[i-2*j+1+next[i-j+1][i-2*j+1]])   dp[i][j]+=dp[i-j][j];   
        else dp[i][j]+=dp[i-j][j-1];

        dp[i][j]%=M;
    }
    cout<<dp[l-1][l];
}