#include <bits/stdc++.h>
using namespace std;

#define mp(x, y) make_pair((x), (y))

typedef long long ll;

const int mod=1000000007;

int n;
char s[5555];
int same[5555][5555];
int dp[5555][5555];

int main()
{
	scanf("%d\n%s", &n, s);
	for(int i=n-2; i>=0; i--) {
		same[i][n-1]=(s[i]==s[n-1]);
		for(int j=n-2; j>i; j--) {
			same[i][j]=(s[i]==s[j] ? 1+same[i+1][j+1] : 0);
		}
	}
	for(int i=n-1; i>=0; i--) {
		if(s[i]=='0') continue;
		for(int j=0; i+j<n; j++) {
			if(i+j+1==n) {
				dp[i][j]=1;
			} else if(j+1<=n-(i+j+1)) {
				if(s[i+j+1]=='0') continue;
				int cmp=0;
				int k=same[i][i+j+1];
				if(k<=j && s[i+k]<s[i+j+1+k]) {
					cmp=1;
				}
				dp[i][j]=dp[i+j+1][j+1-cmp];
			}
		}
		for(int j=n; j>=0; j--) dp[i][j]=(dp[i][j]+dp[i][j+1])%mod;
	}
	printf("%d\n", dp[0][0]);

	return 0;
}
