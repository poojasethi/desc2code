#include<stdio.h>
#define N 5005
using namespace std;
const int P=1e9+7;
inline void up(int &x){if (x>=P) x-=P;}
int len[N][N],f[N][N],sum[N][N];
int n;char a[N];int i,j,L;
int main(){
    scanf("%d",&n);
    scanf("%s",a+1);
    for (i=n;i;i--)
        for (j=n;j;j--)
            if (a[i]!=a[j]) len[i][j]=0;
            else len[i][j]=len[i+1][j+1]+1;
    for (i=1;i<=n;i++){
        for (j=1;j<=i;j++){
            if (a[i-j+1]=='0') continue;
            if (i-j==0) f[i][j]=1;
            else f[i][j]=sum[i-j][j-1];
            if (i-j<j) continue;
            L=len[i-j-j+1][i-j+1];
            if (L<j&&a[i-j-j+1+L]<a[i-j+1+L]) 
                up(f[i][j]+=f[i-j][j]);
      }for (j=1;j<=n;j++)
            up(sum[i][j]=sum[i][j-1]+f[i][j]);
  }printf("%d\n",sum[n][n]);
}