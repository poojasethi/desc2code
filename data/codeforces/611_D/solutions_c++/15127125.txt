#include<bits/stdc++.h>
using namespace std;
const int MOD = 1000000007;
const int MAX = 5005;
short lcs[MAX][MAX];
int sum[MAX][MAX];
string s;
bool cmp(int l, int mid, int r)
{
	int x = lcs[l][mid];
	if (l + x >= mid)
		return false;
	return (s[l + x] < s[mid + x]);
}
void add(int &x, int y)
{
	x += y;
	if (x >= MOD)
		x -= MOD;
}
int main()
{
	int n;
	cin >> n;
	cin >> s;
	for (int i = n - 1; i >= 0; i--)
		for (int j = n - 1; j >= 0; j--)
			if (s[i] == s[j])
				lcs[i][j] = lcs[i + 1][j + 1] + 1;
			else
				lcs[i][j] = 0;
	for (int j = 1; j <= n; j++)
		for (int i = j - 1; i >= 0; i--)
		{
			if (i == 0)
				sum[i][j] = 1;
			else
			{
				int r = j;
				int mid = i;
				int l = mid - (r - mid);
				int st;
				if (l < 0)
					st = 0;
				else
				{
					st = l;
					if (!cmp(l, mid, r))
						st++;
				}
				sum[i][j] = sum[st][mid];
				if (s[i] == '0')
					sum[i][j] = 0;
			}
			add(sum[i][j], sum[i + 1][j]);
		}
	cout << sum[0][n] << "\n";
	return 0;
}
