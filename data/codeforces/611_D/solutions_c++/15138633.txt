#include<cstdio>
const int mo=1e9+7;
int nxt[5005][5005],f[5005][5005],g[5005][5005];
int n,i,j;
char s[5005];
bool bigger(int i,int j,int len)
{
    if (nxt[i][j]+1>len) return 1;
    return s[i+nxt[i][j]]>=s[j+nxt[i][j]];
}
void add(int &a,int b)
{
    a+=b;
    if (a<0) a+=mo;
    if (a>mo) a-=mo;
}
int main()
{
    scanf("%d",&n);
    scanf("%s",s+1);
    for (i=n;i>=1;i--)
        for (j=n;j>=1;j--)
        if (s[i]==s[j]) nxt[i][j]=nxt[i+1][j+1]+1;
    for (i=1;i<=n;i++)
        for (j=1;j<=i;j++)
        {
            if (s[j]=='0') f[i][j]=0;else
            if (j==1) f[i][j]=1;else
            {
                int len=i-j+1;
                int pre=j-len;
                if (pre<1) pre=1;else
                if (bigger(pre,j,len)) pre++;
                add(f[i][j],g[j-1][j-1]-g[j-1][pre-1]);
            }
            add(g[i][j],g[i][j-1]+f[i][j]);
        }
    printf("%d\n",g[n][n]);
}
