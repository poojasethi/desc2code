#include<bits/stdc++.h>
using namespace std;
int inf=1000000007;
int n,d[5005][5005],dp[5005][5005],re,cmp[5005][5005];
string s;

int cao(int i,int j){
if(cmp[i][j]!=-1) return cmp[i][j];
if(j>=n) return cmp[i][j]=n;
if(s[i]==s[j]) return cmp[i][j]=1+cao(i+1,j+1);
else return cmp[i][j]=0;
}
int f(int ,int);
int g(int i,int j){
if(dp[i][j]!=-1) return dp[i][j];
if(j>=n) return dp[i][j]=0;
if(j==n-1) return dp[i][j]=1;
return dp[i][j]=(f(i,j)+g(i,j+1))%inf;
}

int f(int i,int j){
if(d[i][j]!=-1) return d[i][j];
if(j>=n||i>=n||s[i]=='0') return d[i][j]=0;
if(j==n-1) return d[i][j]=1;
if(s[j+1]=='0') return d[i][j]=0;
if(2*j-i+1>=n) return d[i][j]=0;
int k1=cao(i,j+1),k;
if(k1==n||i+k1>j||(!(s[i+k1]<s[j+1+k1]))) k=2*j-i+2;
else k=2*j-i+1;
return d[i][j]=g(j+1,k);
}

int main(){
cin>>n>>s;
re=0;
memset(d,-1,sizeof(d));
memset(dp,-1,sizeof(dp));
memset(cmp,-1,sizeof(cmp));
for(int j=0;j<n;j++) re=(re+f(0,j))%inf;
cout<<re<<endl;
return 0;
}
