/* In The Name Of God */
#include <bits/stdc++.h>
using namespace std;

const int mod=1e9+7;
const int maxn=5e3+10;
long long sum[maxn][maxn],dp[maxn][maxn];
int lcs[maxn][maxn],n;
string s;
bool check(int pos,int len){
	int sz=lcs[pos-(2*len)+1][pos-len+1];
	if(sz >= len)return false;
	return s[pos-(2*len)+sz] < s[pos-len+sz];
}
int main(){
	cin>>n>>s;
	for(int i=n ; i>=1 ; i--)
		for(int j=i ; j<=n ; j++)if(s[i-1]==s[j-1])
			lcs[i][j]=lcs[i+1][j+1]+1;
	for(int i=0 ; i<=n ; i++)
		sum[0][i]=1;
	for(int i=1 ; i<=n ; i++){
		for(int j=1 ; j<=n ; j++){
			sum[i][j]=sum[i][j-1];
			if(j>i || s[i-j]=='0')
				continue;
			if((i-(j*2)) >= 0 && s[i-(2*j)]!='0' && check(i,j))
				dp[i][j]=sum[i-j][j];
			else
				dp[i][j]=sum[i-j][j-1];
			sum[i][j]=(sum[i][j]+dp[i][j])%mod;
		}
	}
	cout<<sum[n][n]<<endl;
	return 0;
}
