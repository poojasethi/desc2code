#include<cstdio>
const int N=5010,P=1000000007;
int n,i,j,k,z[N],f[N][N],g[N][N],s[N][N],ans;
char a[N];
inline int ask(int A,int B,int C,int D){
  int t=f[A][C];
  if(t>=B-A+1)return 0;
  return a[A+t]<a[C+t];
}
inline int sum(int p,int l,int r){
  if(l<0)l=0;
  if(l==0)return s[p][r];
  return (s[p][r]-s[p][l-1]+P)%P;
}
inline void up(int&a,int b){
  a+=b;
  if(a>=P)a-=P;
}
int main(){
  scanf("%d%s",&n,a+1);
  for(i=n;i;i--)for(j=n;j;j--)if(a[i]==a[j])f[i][j]=f[i+1][j+1]+1;
  for(i=1;i<=n;i++)z[i]=z[i-1]+(a[i]!='0');
  for(i=1;i<=n;i++){
    for(j=0;j<i;j++)if(z[i]!=z[j]&&a[j+1]!='0'){
      if(j==0)g[i][j]=1;
      k=j+j-i;
      if(k>=0){
        if(ask(k+1,j,j+1,i))up(g[i][j],g[j][k]);
      }
      up(g[i][j],sum(j,j+j-i+1,j-1));
    }
    for(s[i][0]=g[i][0],j=1;j<i;j++)s[i][j]=(s[i][j-1]+g[i][j])%P;
  }
  for(i=0;i<n;i++)up(ans,g[n][i]);
  printf("%d",ans);
  return 0;
}