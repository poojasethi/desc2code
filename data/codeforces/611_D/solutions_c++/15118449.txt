#include <cstdio>
#define repu(i,x,y) for (int i=x; i<=y; ++i)
#define repd(i,x,y) for (int i=x; i>=y; --i)
using namespace std;

const int mod=1000000007;
int n,lcp[5100][5100],f[5100][5100],sum[5100][5100];
char str[5100];

bool check(int x,int y,int l)
{
    if (lcp[x][y]>=l)
        return 0;
    else
        return str[x+lcp[x][y]]>str[y+lcp[x][y]];
}

int main()
{
    scanf("%d",&n),scanf("%s",str+1);
    repd(i,n,1)
        repd(j,n,1)
            lcp[i][j]=str[i]==str[j]?lcp[i+1][j+1]+1:0;
    repu(i,0,n)
        sum[0][i]=1;
    repu(i,1,n)
        repu(j,1,n)
        {
            if (j<=i && str[i-j+1]!='0')
                f[i][j]=(sum[i-j][j-1]+check(i-j+1,i-j*2+1,j)*f[i-j][j])%mod;
            sum[i][j]=(f[i][j]+sum[i][j-1])%mod;
        }
    printf("%d\n",sum[n][n]);
    return 0;
}