#include<bits/stdc++.h>
#define I D[i][j]
using namespace std;
int M=1e9+7,n,A,c[5001][5001],D[5001][5001],i,j,l;
string s;
main()
{
  cin>>n>>s;
  memset(c,31,sizeof c);
  for(i=n;i--;)for(j=i+1;j<n;j++)if(s[i]<=s[j])c[i][j]=c[i+1][j+1]*(s[i]==s[j])+1;
  for(D[0][0]=1,i=0;i<n;i++)if(s[i]-'0'){for(j=i;j<n;j++){
  l=j-i+1;if(j)(I+=D[i][j-1])%=M;(D[j+1][j+1+l]+=I)%=M;if(c[i][j+1]<=l)(D[j+1][j+l]+=I)%=M,(D[j+1][j+l+1]-=I)%=M;}
  (A+=D[i][n-1])%=M;}cout<<(A+M)%M;
}