#include <iostream>
#include <cmath>

using namespace std;

int modulo=1e9+7;

const int limite=5005;

int n;
int v[limite];
int maneras[limite][limite];
int coinciden[limite][limite];

int main()
{
  cin>>n;
  for (int i=0;i<n;i++) {
    char c;
    cin>>c;
    v[i]=c-'0';
  }
  for (int i=n-1;i>=0;i--)
    for (int j=n-1;j>i;j--)
      if (v[i]==v[j])
	coinciden[i][j]=1+coinciden[i+1][j+1];
  /*
  for (int i=0;i<n;i++) {
    for (int j=0;j<n;j++)
      cout<<coinciden[i][j];
    cout<<endl;
  }
  */
  for (int i=n-1;i>=0;i--) {
    if (v[i]!=0) {
      maneras[i][n]=1;
      for (int j=n-1;j>i;j--) {
	maneras[i][j]=maneras[i][j+1];
	if (v[j]!=0 and j-i<=n-j) {
	  int coin=min(j-i,coinciden[i][j]);
	  int len;
	  if (coin==j-i) len=j-i+1;
	  else if (v[i+coin]>v[j+coin]) len=j-i+1;
	  else len=j-i;
	  if (j+len<=n)
	    maneras[i][j]=(maneras[i][j]+maneras[j][j+len])%modulo;
	}
      }
    }
  }
  cout<<maneras[0][1]<<endl;
}
