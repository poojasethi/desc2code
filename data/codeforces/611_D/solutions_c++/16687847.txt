#include <bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

#define LL long long
#define PI 3.14159265358979

#define PII pair<int,int>
#define PLL pair<LL,LL>
#define mp make_pair
#define fi first
#define se second

using namespace std;

#define mod 1000000007

int n,dp[5005][5005];
int lcp[5005][5005];
char s[10005];

int main(){
	scanf("%d %s",&n,s+1);
	FD(i,n+1,1) FD(j,n+1,1){
		if(i==n+1 || j==n+1 || s[i]!=s[j]) lcp[i][j]=0;
		else lcp[i][j]=lcp[i+1][j+1]+1;
	}
	FI(i,1,n) dp[1][i]=1;
	FI(i,2,n){
		if(s[i]=='0') continue;
		int sum=0;
		FI(j,i,n){
			dp[i][j]=sum;
			if(i+i-j-1<=0) continue;
			int L = lcp[i+i-j-1][i];
			if(L<j-i+1 && s[i+i-j-1+L]<s[i+L]){
				dp[i][j]+=dp[i+i-j-1][i-1];
				dp[i][j]%=mod;
			}
			sum+=dp[i+i-j-1][i-1];
			sum%=mod;
		}
	}
	int res=0;
	FI(i,1,n) res=(res+dp[i][n])%mod;
	printf("%d\n",res);
	return 0;
}