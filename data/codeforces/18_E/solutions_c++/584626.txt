#include <stdio.h>

int f[505][26][26];
int dp[505][26][26];
int from[505][26][26];
char a[505][505];
const int INF = 1<<28;

int dif(int x, int y, int z) {
	if(y==z) return INF;
	int c=0;
	for(int i=0;a[x][i];i++)
		if(i%2==0 && a[x][i]!=y+'a' || i%2==1 && a[x][i]!=z+'a')
			++c;
	return c;
}

int main(void) {
	int n, m, i, j, k, u, v;
	scanf("%d%d", &n, &m);
	for(i=0;i<n;i++)
		scanf("%s", a[i]);
	for(i=0;i<n;i++)
		for(j=0;j<26;j++)
			for(k=0;k<26;k++)
				f[i][j][k] = dif(i, j, k);
	for(j=0;j<26;j++)
		for(k=0;k<26;k++)
			dp[0][j][k] = f[0][j][k];
	for(i=1;i<n;i++)
		for(j=0;j<26;j++)
			for(k=0;k<26;k++) {
				dp[i][j][k] = INF;
				for(u=0;u<26;u++)
					for(v=0;v<26;v++)
						if(u!=j && v!=k && dp[i][j][k] > dp[i-1][u][v]) {
							dp[i][j][k] = dp[i-1][u][v];
							from[i][j][k] = u*32+v;
						}
				dp[i][j][k] += f[i][j][k];
			}
	int ans = INF, t = -1;
	for(j=0;j<26;j++)
		for(k=0;k<26;k++)
			if(dp[n-1][j][k] < ans) {
				ans = dp[n-1][j][k];
				t = j*32+k;
			}
	printf("%d\n", ans);
	for(i=n-1;i>=0;--i) {
		j = t/32;
		k = t%32;
		for(int u=0;u<m;u++)
			a[i][u] = u%2? k+'a':j+'a';
		t = from[i][j][k];
	}
	for(i=0;i<n;i++)
		puts(a[i]);
	return 0;
}
