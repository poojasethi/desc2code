#include<stdio.h>
int dp[505][30][30]={0},cnt[505][30][2]={0},fr[505][30][30]={0},ans[505]={0},Min=-1,i,m,n,j,k,p,q,c1,c2;
bool datad[505][30][30]={false};
char flag[505][505]={'\0'};
int main()
{
  scanf("%d %d",&n,&m);
  for(i=1;i<=n;i++)
  {
     scanf("%s",flag[i]+1);
     for(j=1;j<=m;j++)
     {
        cnt[i][flag[i][j]-96][j%2]++;
        //printf("%d %d %d\n",i,flag[i][j]-96,j%2);
     }
  }
  for(i=1;i<=n;i++)
  {
     for(j=1;j<=26;j++)
     {
       for(k=1;k<=26;k++)
       {
          if(j==k) continue;
          //printf("%d %d %d %d %d\n",i,j,k,cnt[i][j][1],cnt[i][k][0]);
          for(p=1;p<=26;p++)
          {
            if(p==j) continue;
            for(q=1;q<=26;q++)
            {
               if(p==q||k==q) continue;
               if(dp[i-1][p][q]+(m-(cnt[i][j][1]+cnt[i][k][0]))<dp[i][j][k]||datad[i][j][k]==false)
               {
                  datad[i][j][k]=true;
                  dp[i][j][k]=dp[i-1][p][q]+(m-(cnt[i][j][1]+cnt[i][k][0]));
                  fr[i][j][k]=p*100+q;
               }
            }
          }
          //printf("%d %d %d %d\n\n",i,j,k,dp[i][j][k]);
       }
     }
  }
  for(i=1;i<=26;i++)
  {
     for(j=1;j<=26;j++)
     {
       if(i==j) continue;
       if(dp[n][i][j]<Min||Min==-1)
       {
          //printf("%d %d %d\n",i,j,dp[n][i][j]);
          Min=dp[n][i][j];
          ans[n]=100*i+j;
       }
     }
  }
  i=n;
  printf("%d\n",Min);
  while(i>=1)
  {
    ans[i-1]=fr[i][ans[i]/100][ans[i]%100];
    i--;
  }
  for(i=1;i<=n;i++)
  {
    c1=ans[i]/100;
    c2=ans[i]%100;
    for(j=1;j<=m;j++)
    {
       if(j%2==1) printf("%c",c1+96);
       else printf("%c",c2+96);
    }
    printf("\n");
  }
return 0;
}
