#include <iostream>
#include <string>

using namespace std;

const int limite=600;

const int infinito=1000000000;

int n,m;
string input[limite];
int minimo[limite][26][26];
int cuantos[limite][26][2];
int anteriorc0[limite][26][26];
int anteriorc1[limite][26][26];

int main()
{
  ios::sync_with_stdio(false);
  cin>>n>>m;
  int m0=(m+1)/2;
  int m1=m/2;
  for (int i=1;i<=n;i++) {
    cin>>input[i];
    for (int j=0;j<m;j++)
      cuantos[i][input[i][j]-'a'][j%2]++;
    for (int c0=0;c0<26;c0++) {
      for (int c1=0;c1<26;c1++) {
	int &mi=minimo[i][c0][c1];
	mi=infinito;
	if (c0!=c1) {
	  for (int c0ant=0;c0ant<26;c0ant++) {
	    for (int c1ant=0;c1ant<26;c1ant++) {
	      if (c0ant!=c1ant and c0!=c0ant and c1!=c1ant) {
		int nextmi=minimo[i-1][c0ant][c1ant]+m0-cuantos[i][c0][0]+m1-cuantos[i][c1][1];
		if (nextmi<mi) {
		  mi=nextmi;
		  anteriorc0[i][c0][c1]=c0ant;
		  anteriorc1[i][c0][c1]=c1ant;
		}
	      }
	    }
	  }
	}
      }
    }
  }
  int c0min=0;
  int c1min=1;
  for (int c0=0;c0<26;c0++) {
    for (int c1=0;c1<26;c1++) {
      if (c0!=c1 and minimo[n][c0][c1]<minimo[n][c0min][c1min]) {
	c0min=c0;
	c1min=c1;
      }
    }
  }
  cout<<minimo[n][c0min][c1min]<<endl;
  {
    int c0=c0min;
    int c1=c1min;
    for (int i=n;i>0;i--) {
      for (int j=0;j<m;j+=2)
	input[i][j]=char('a'+c0);
      for (int j=1;j<m;j+=2)
	input[i][j]=char('a'+c1);
      int c0ant=anteriorc0[i][c0][c1];
      int c1ant=anteriorc1[i][c0][c1];
      c0=c0ant;
      c1=c1ant;
    }
  }
  for (int i=1;i<=n;i++)
    cout<<input[i]<<endl;
}
