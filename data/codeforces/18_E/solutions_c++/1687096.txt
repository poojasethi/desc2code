#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;

#define MAXN 501
#define INF 0x3f3f3f3f

char mat[MAXN][MAXN];
int aux[MAXN][27][2];
int memo[MAXN][27][27],n,m,P,I,next1[MAXN][27][27],next2[MAXN][27][27];

int solve(int x, int c1, int c2) {
	if (x == n) return 0;
	
	if (memo[x][c1][c2] != -1) return memo[x][c1][c2];
	
	memo[x][c1][c2] = INF;
	for (int i=0; i<26; i++) {
		if (i == c1) continue;
		for (int j=0; j<26; j++) {
			if (j == i || j == c2) continue;
			int r = P + I - aux[x][i][0] - aux[x][j][1] + solve(x+1,i,j);
			if (memo[x][c1][c2] > r) {
				memo[x][c1][c2] = r;
				next1[x][c1][c2] = i;	next2[x][c1][c2] = j;
			}
		}
	}
	
	return memo[x][c1][c2];
}

void rec(int x, int p1, int p2) {
	int c1,c2;
	c1 = next1[x][p1][p2];	c2 = next2[x][p1][p2];
	if (x == n) return;
	
	for (int i=0; i<m; i++)
		i%2 ? printf("%c",c2+'a') : printf("%c",c1+'a');
	
	printf("\n");
	rec(x+1,c1,c2);
	return;
}

int main() {
	scanf("%d%d",&n,&m);
	for (int i=0; i<n; i++)
		scanf(" %s",mat[i]);
	
	for (int i=0; i<n; i++)
		for (int j=0; j<m; j++)
			aux[i][mat[i][j]-'a'][j%2]++;
	
	for (int i=0; i<n; i++)
		for (int j=0; j<=26; j++)
			for (int k=0; k<=26; k++)
				memo[i][j][k] = -1;
			
	P = m/2 + m%2;	I = m/2;
			
	printf("%d\n",solve(0,26,26));
	rec(0,26,26);
		
	return 0;
}