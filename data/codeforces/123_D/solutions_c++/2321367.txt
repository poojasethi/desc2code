#include<cstdio>
#include<cstring>
#define V 100005
int r[V],sa[V],X[V],Y[V],h[V],a[V],b[V];
void calh(int n)
{
	int i,j,k=0;
	for(i=1;i<=n;i++)r[sa[i]]=i;
	for(i=0;i<n;h[r[i++]]=k)
		for(k?k--:0,j=sa[r[i]-1];a[i+k]==a[j+k];k++);
}
bool cmp(int *r,int a,int b,int l)
{
	return r[a]==r[b]&&r[a+l]==r[b+l];
}
void suffix(int n,int m=128)
{
		int i,j,p,*x=X,*y=Y,*t;	
	for(i=0;i<m;i++)b[i]=0;
	for(i=0;i<n;i++)b[x[i]=a[i]]++;
	for(i=1;i<m;i++)b[i]+=b[i-1];
	for(i=n-1;i>=0;i--)sa[--b[x[i]]]=i;
	for(j=1,p=1;p<n;m=p,j<<=1)
	{
		p=0;
		for(i=n-j;i<n;i++)y[p++]=i;
		for(i=0;i<n;i++)if(sa[i]>=j)y[p++]=sa[i]-j;
		for(i=0;i<m;i++)b[i]=0;
		for(i=0;i<n;i++)b[x[y[i]]]++;
		for(i=1;i<m;i++)b[i]+=b[i-1];
		for(i=n-1;i>=0;i--)sa[--b[x[y[i]]]]=y[i];
		for(t=x,x=y,y=t,x[sa[0]]=0,i=1,p=1;i<n;i++)
			x[sa[i]]=cmp(y,sa[i-1],sa[i],j)?p-1:p++;
	}
	calh(n-1);
}
int max(int a,int b){return a>b?a:b;}
char in[V];
typedef __int64 lld;
int st[V];
int val[V];
int top;
int main()
{
	int i,n;
	while(scanf("%s",in)!=-1)
	{
		for(i=0;in[i];i++)
		{
			a[i]=in[i]-'a'+1;
		}
		n=i;
		a[n]=0;
		suffix(n+1);
		lld ans=(lld)n*(1+n)/2;
		h[++n]=0;
		st[top=0]=0;
		val[top]=0;
		for(i=2;i<=n;i++)
		{
			ans-=h[i];
			int t=i;
			while(h[i]<val[top])
			{
				lld len=i-st[top]+1;
				lld dif=val[top]-max(h[i],val[top-1]);
				ans+=dif*(len*(len+1)/2-1);
				t=st[top--];
			}
			if(h[i]>val[top])
			{
				st[++top]=t;
				val[top]=h[i];
			}
		}
		printf("%I64d\n",ans);
	}
	return 0;
}