#include <bits/stdc++.h>
#define fi first
#define se second
#define endl '\n'

using namespace std;

typedef long long lint;
typedef pair<lint,lint> ii;
typedef pair<ii,lint> iii;
const lint MAXN = 2e5+222;
const lint mod = 1e9+7;

lint N,suf[20][MAXN],go[MAXN],ar[MAXN];
lint at,l[MAXN],r[MAXN];
lint sum[MAXN];
vector<ii> seg[MAXN*5];
char s[MAXN];
iii o[MAXN];
ii st[MAXN];

int main(){
	
	scanf(" %s",s+1);
	
	N=strlen(s+1);
	for(lint i=1;i<=N;i++)
		suf[0][i]=s[i]-'a'+1;
	
	for(lint step=1;step<=19;step++){
		for(lint i=1;i<=N;i++)
			o[i]=iii(ii(suf[step-1][i],suf[step-1][i+(1<<(step-1))]),i);
		sort(o+1,o+N+1);
		lint cnt=0;
		for(lint i=1;i<=N;i++){
			if(o[i].fi!=o[i-1].fi)
				cnt++;
			suf[step][o[i].se]=cnt;
			go[cnt]=o[i].se;
		}
	}
	
	for(lint i=1,beg=0;i<=N;i++,beg--){
		beg=max(0ll,beg);
		if(suf[19][i]==N)
			continue;
		lint j=go[suf[19][i]+1];
		while(s[i+beg]==s[j+beg])
			beg++;
		ar[suf[19][i]]=beg;
	}
	
	st[0]=ii(0,N);
	for(lint i=N-1;i>=1;i--){
		while(at && st[at].fi>=ar[i])
			at--;
		r[i]=st[at].se-i;
		st[++at]=ii(ar[i],i);
	}
	
	at=0;
	st[0]=ii(0,0);
	for(lint i=1;i<N;i++){
		while(at && st[at].fi>ar[i])
			at--;
		l[i]=i-st[at].se;
		st[++at]=ii(ar[i],i);
	}
	
	for(lint i=1;i<N;i++){
		sum[i-l[i]+1]+=1ll*r[i]*ar[i];
		sum[i+1]-=1ll*r[i]*ar[i];
	}
	lint ans=0;
	for(lint i=1;i<N;i++){
		sum[i]+=sum[i-1];
		ans+=sum[i];
	}
	
	ans+=(N+1)*N/2;
	cout<<ans<<endl;
	
	return 0;
}
