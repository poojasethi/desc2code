#include <bits/stdc++.h>
using namespace std;

const int N = 400010;
struct sannode
{
    int l;
    long long c;
    sannode *ch[26],*f; 
    sannode() {
        c = 0;
    }
}e[N],*tail,*head,*tmp,*a[N];

int cnt;
void add(int c,int len)
{
    sannode *p = tail,*np = &e[cnt ++];
    np->l = len;
    for(; p && !p->ch[c]; p = p->f) p->ch[c] = np;
    tail = np;
    if(!p) np->f = head;
    else {
        if(p->ch[c]->l == p->l + 1) np->f = p->ch[c];
        else {
            sannode *q = p->ch[c],*r = &e[cnt ++];
            *r = *q;
            r->l = p->l + 1;
            q->f = np->f = r;
            for(; p && p->ch[c] == q; p = p->f) p->ch[c] = r;
        }
    }
}

char s[N];
int c[N];
void topo_sort()
{
    for(int i = 0; i < cnt; i ++) c[i] = 0;
    for(int i = 0; i < cnt; i ++) c[e[i].l] ++;
    for(int i = 1; i < cnt; i ++) c[i] += c[i - 1];
    for(int i = 0; i < cnt; i ++) a[-- c[e[i].l]] = &e[i];
}

int main()
{
    scanf("%s",s);
    tmp = tail = head = &e[cnt ++];
    for(int i = 0; s[i]; i ++) add(s[i] - 'a',i + 1);
    topo_sort();
    for(int i = 0; s[i]; i ++) {
        tmp = tmp->ch[s[i] - 'a'];
        tmp->c ++;
    }
    for(int i = cnt - 1; i > 0; i --) {
        a[i]->f->c += a[i]->c;
    }
    long long ans = 0;
    for(int i = 1; i < cnt; i ++) {
        ans += (a[i]->l - a[i]->f->l) * a[i]->c * (a[i]->c + 1) / 2;
    }
    cout << ans << endl;
}

		  	 		  	 	  	    	  	 	