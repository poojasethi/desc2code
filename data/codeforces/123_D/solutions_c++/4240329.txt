#include<cstring>
#include<cstdio>
#include<vector>
#include<algorithm>
#include<iostream>
using namespace std;

typedef long long i64;
i64 out[210000],num[210000];
int r[210000],len[210000],f[210000];
int tal,cnt,nex[210000][26];
void add(int c,int m)
{
	len[++cnt]=m;
	out[cnt]=1;
	r[cnt]=cnt;
	for(int i=0;i<26;++i)	nex[cnt][i]=0;
	int p=tal;
	for(;p!=-1&&!nex[p][c];p=f[p])	num[cnt]+=num[p],nex[p][c]=cnt;
	tal=cnt;
	if(p==-1)
		f[tal]=0;
	else
	{
		if(len[nex[p][c]]==len[p]+1)
			f[tal]=nex[p][c];
		else
		{
			len[++cnt]=len[p]+1;
			r[cnt]=cnt;
			int tmp=nex[p][c];
			for(int i=0;i<26;++i)	nex[cnt][i]=nex[tmp][i];
			f[cnt]=f[tmp];
			f[tal]=f[tmp]=cnt;
			for(;p!=-1&&nex[p][c]==tmp;p=f[p])
				num[cnt]+=num[p],num[tmp]-=num[p],nex[p][c]=cnt;
		}
	}
}
bool cmp(const int &i ,const int &j){
	return len[i]<len[j];
}
char s[110000];
int main()
{
	scanf("%s",s);
	tal=cnt=0;
	f[0]=-1;
	num[0]=1;
	for(int i=0;s[i];++i)	add(s[i]-'a',i+1);
	i64 res=0;
	sort(r,r+cnt+1,cmp);
	for(int ii=cnt;ii>0;--ii)
	{
		int i=r[ii];
		res+=out[i]*(out[i]+1)/2*num[i];
		out[f[i]]+=out[i];
	}
	cout<<res<<endl;
	return 0;
}