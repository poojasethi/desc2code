#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<ctime>
#include<cmath>
#include<algorithm>
#define N 500005
#define mo 1000000007
#define Long long long
#define For(i,l,r) for(int i=l;i<=r;i++)
#define Dor(i,r,l) for(int i=r;i>=l;i--)
#define Rep(i,t,v) for(int i=son[t],v=ed[i];i;i=next[i],v=ed[i])
using namespace std;
const Long inf=1LL<<61;
int n,m,K,q[N],inq[N];
int son[N],next[N],ed[N],co[N],cnt;
Long D[N],Ans; int P[N];
void SPFA(){
    int st=0,en=0;
    For(i,1,n) D[i]=inf,P[i]=0;
    scanf("%d",&K);
    For(i,1,K){
        int p; scanf("%d",&p); q[++en]=p; inq[p]=1;
        D[p]=0; P[p]=p;
    }
    while(st<en){
        int u=q[++st]; inq[u]=0;
        for(int i=son[u];i;i=next[i]){
            int v=ed[i];
            if(D[v]>D[u]+co[i]){
                D[v]=D[u]+co[i];
                P[v]=P[u];
                if(!inq[v]) inq[v]=1,q[++en]=v;
            }
        }
    }
}
struct rec{
    int x,y,w;
    void read(){
        scanf("%d%d%d",&x,&y,&w);
        next[++cnt]=son[x]; son[x]=cnt; ed[cnt]=y; co[cnt]=w;
        next[++cnt]=son[y]; son[y]=cnt; ed[cnt]=x; co[cnt]=w;
    }
}E[N];
bool cmp(const rec &i,const rec &j){return D[i.x]+D[i.y]+i.w<D[j.x]+D[j.y]+j.w;}
int fa[N];
int getfa(int v){
    if(fa[v]==v) return v;
    fa[v]=getfa(fa[v]);
    return fa[v];
}
void MST(){
    sort(E+1,E+1+m,cmp);
    For(i,1,n) fa[i]=i;
    For(i,1,m){
        int fx=getfa(P[E[i].x]);
        int fy=getfa(P[E[i].y]);
        Long val=D[E[i].x]+D[E[i].y]+E[i].w;
        if(fx==fy) continue;
        Ans+=val; fa[fx]=fy;
    }
}
int main(){
    scanf("%d%d",&n,&m);
    For(i,1,m) E[i].read();
    
    SPFA();
    MST();
    
    printf("%I64d\n",Ans+D[1]);
}