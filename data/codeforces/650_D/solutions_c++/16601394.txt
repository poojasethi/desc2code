#include <cmath>
#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;

struct edge
{
	int to,next;
}e[400010];

int a[400010],b[400010],ans[400010],head[400010],pre[400010],next[400010],ma[400010],mi[400010],first[400010];
bool ok[400010];

int main()
{
	#ifndef ONLINE_JUDGE
		freopen("input.txt","r",stdin);
		freopen("output.txt","w",stdout);
	#endif
	int n,m;scanf("%d%d",&n,&m);
	for (int i=1;i<=n;i++) scanf("%d",&a[i]);
	for (int i=1;i<=m;i++)
	{
		int x,y;scanf("%d%d",&x,&y);
		e[i].to=y;e[i].next=head[x];head[x]=i;
	}
	int len=0,last;
	for (int i=1;i<=n;i++)
	{
		int p=head[i];
		while (p)
		{
			int l=1,r=len;
			while (l<=r)
			{
				int mid=(l+r)>>1;
				if (a[b[mid]]<e[p].to) l=mid+1; else r=mid-1;
			}
			ans[p]=l;
			p=e[p].next;
		}
		int l=1,r=len;
		while (l<=r)
		{
			int mid=(l+r)>>1;
			if (a[b[mid]]<a[i]) l=mid+1; else r=mid-1;
		}
		if (l>len) {len++;first[len]=i;} else next[b[l]]=i;
		b[l]=i;pre[i]=b[r];
	}
	int t=len;
	int x=b[t];
	for (int i=t;i;i--)
	{
		ma[i]=x;
		x=pre[x];
	}
	x=mi[t]=first[t];
	for (int i=t-1;i;i--)
	{
		int p=first[i];
		while (1)
		{
			if (a[p]<a[x]) {x=p;break;}
			p=next[p];
		}
		mi[i]=x;
	}
	for (int i=1;i<=t;i++) if (mi[i]==ma[i]) ok[ma[i]]=1;
	len=0;
	for (int i=n;i;i--)
	{
		int p=head[i];
		while (p)
		{
			int l=1,r=len;
			while (l<=r)
			{
				int mid=(l+r)>>1;
				if (b[mid]>e[p].to) l=mid+1; else r=mid-1;
			}
			ans[p]+=r;if (ok[i]) ans[p]=max(ans[p],t-1); else ans[p]=max(ans[p],t);
			p=e[p].next;
		}
		int l=1,r=len;
		while (l<=r)
		{
			int mid=(l+r)>>1;
			if (b[mid]>a[i]) l=mid+1; else r=mid-1;
		}
		if (l>len) len++;b[l]=a[i];
	}
	for (int i=1;i<=m;i++) printf("%d\n",ans[i]);
	return 0;
}
