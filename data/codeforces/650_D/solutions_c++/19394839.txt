#include<cstdio>
#include<cstring>
#include<vector>
#define max(a,b)(a > b ? a : b)
#define MN 411111
using namespace std;

struct ccc{
	int x,from,to,i;
};

vector<ccc>v[MN];

int n,m,i,j,k,ans[MN],top,lis,to[MN],from[MN],x,y,st[MN],co[MN],a[MN];

int bigger(int mn,int mx,int x)
{
	if(mx==0 || x<=st[1])return 1;
	while(mx>mn){
		int mid=(mx+mn+1)>>1;
		if(x<=st[mid])mx=mid-1;
		if(x>st[mid])mn=mid;
	}
	return mx+1;
}

int smaller(int mn,int mx,int x)
{
	if(mx==0 || x>=st[1])return 1;
	while(mx>mn){
		int mid=(mx+mn+1)>>1;
		if(x>=st[mid])mx=mid-1;
		if(x<st[mid])mn=mid;
	}
	return mx+1;
}

int main()
{
//	freopen("test.in","r",stdin);
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;i++){
		scanf("%d",&a[i]);
	}
	for(i=1;i<=m;i++){
		scanf("%d%d",&x,&y);
		ccc aa;
		aa.x=y;
		aa.i=i;
		v[x].push_back(aa);
	}
	top=0;
	lis=0;
	for(i=1;i<=n;i++){
		for(j=0;j<(int)v[i].size();j++){
			v[i][j].to=bigger(1,top,v[i][j].x);
		}
		x=bigger(1,top,a[i]);
		to[i]=x;
		top=max(x,top);
		st[x]=a[i];
		lis=max(lis,top);
	}
	top=0;
	for(i=n;i>=1;i--){
		for(j=0;j<(int)v[i].size();j++){
			v[i][j].from=smaller(1,top,v[i][j].x);
		}
		x=smaller(1,top,a[i]);
		from[i]=x;
		top=max(x,top);
		st[x]=a[i];
		if(from[i]+to[i]==lis+1)co[to[i]]++;
	}
	for(i=1;i<=n;i++){
		for(j=0;j<(int)v[i].size();j++){
			ans[v[i][j].i]=v[i][j].from+v[i][j].to-1;
			if(from[i]+to[i]==lis+1 && co[to[i]]==1)
				ans[v[i][j].i]=max(ans[v[i][j].i],lis-1);
			else ans[v[i][j].i]=max(ans[v[i][j].i],lis);
		}
	}
	for(i=1;i<=m;i++)printf("%d\n",ans[i]);
}


				  	 		  	     	 		  	  		 	