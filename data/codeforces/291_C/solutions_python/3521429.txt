def f(x):
	s = []
	for q in xrange(24, -1, -8):
		s.append(str((x >> q) & 255))
	return '.'.join(s)
n, k = map(int, raw_input().split())
a = []
for i in xrange(n):
	a.append(reduce(lambda x, y: x * 256 + y, map(int, raw_input().split('.'))))
mask = (1 << 32) - 2
ans = '-1'
while mask > 0:
	s = set()
	for q in a:
		s.add(q & mask)
	if len(s) == k: ans = f(mask)
	mask = mask & (mask - 1)
print ans