def readip():
    nn=map(int,raw_input().split('.'))
    r=0
    for i in xrange(4):
        r=r*256+nn[i];
    return r

m = [
0b10000000000000000000000000000000,
0b11000000000000000000000000000000,
0b11100000000000000000000000000000,
0b11110000000000000000000000000000,
0b11111000000000000000000000000000,
0b11111100000000000000000000000000,
0b11111110000000000000000000000000,
0b11111111000000000000000000000000,
0b11111111100000000000000000000000,
0b11111111110000000000000000000000,
0b11111111111000000000000000000000,
0b11111111111100000000000000000000,
0b11111111111110000000000000000000,
0b11111111111111000000000000000000,
0b11111111111111100000000000000000,
0b11111111111111110000000000000000,
0b11111111111111111000000000000000,
0b11111111111111111100000000000000,
0b11111111111111111110000000000000,
0b11111111111111111111000000000000,
0b11111111111111111111100000000000,
0b11111111111111111111110000000000,
0b11111111111111111111111000000000,
0b11111111111111111111111100000000,
0b11111111111111111111111110000000,
0b11111111111111111111111111000000,
0b11111111111111111111111111100000,
0b11111111111111111111111111110000,
0b11111111111111111111111111111000,
0b11111111111111111111111111111100,
0b11111111111111111111111111111110,
0b11111111111111111111111111111111]

(n,k)=map(int,raw_input().split())
a=[]
for i in xrange(n):
    a.append(readip())
for mi in xrange(32):
    b=set()
    for i in xrange(n):
        b.add(a[i]&m[mi])
    if len(b)==k:
        aa = int(m[mi]/(256*256*256))
        bb = int(m[mi]/(256*256))%256
        cc = int(m[mi]/(256))%256
        dd = m[mi]%256
        r = '{0}.{1}.{2}.{3}'.format(aa,bb,cc,dd)
        print(r)
        exit(0)
print(-1)