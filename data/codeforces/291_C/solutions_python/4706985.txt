r=lambda:map(int,raw_input().split())
n,k=r()
l=[]
for i in xrange(n):
    p=map(int,raw_input().split('.'))
    t=p[0]*256**3+p[1]*256**2+p[2]*256**1 + p[3]
    l.append(t)
    
for i in xrange(1,32):
    m=((1<<i)-1)<<(32-i)

    s=set(m&j for j in l)
    if len(s)>k:
        break
    if len(s)==k:
        res=[]
        for z in range(4):
            res.append(m%256)
            m/=256
        print '.'.join(map(str, reversed(res)))
        exit()
print -1