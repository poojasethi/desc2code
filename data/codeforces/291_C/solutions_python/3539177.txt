n, k = map(int, raw_input().split())
b = [0] * 100001
for i in xrange(n):
    a = map(int, raw_input().split('.'))
    b[i] = (a[0] << 24) | (a[1] << 16) | (a[2] <<8) | a[3]
msk = 0
for i in xrange(31, 0, -1):
    msk |= (1 << i)
    a = set()
    for j in xrange(n):
        a.add(b[j] & msk);
    if len(a) == k:
        m = 24
        ans = [0] * 4
        for j in range(4):
            ans[j] = (msk >> m) & 255
            m -= 8
        print '.'.join(map(str, ans))
        exit()
print -1

