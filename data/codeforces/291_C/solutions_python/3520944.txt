#!/usr/bin/python
#-*- coding:utf-8 -*-
import sys, re

fin = sys.stdin
n, k = [int(x) for x in fin.readline().split()]

ips = [0] * n
for i in xrange(0, n):
	ip = [int(x) for x in fin.readline().split(".")]
	for j in xrange(0, 4):
		ips[i] += ip[3 - j] * (1 << (8 * j))


answer = "-1"
mask = 0
for i in xrange(0, 31):
	mask += (1 << (31 - i))
	s = set()
	for ip in ips:
		s.add(ip & mask)
	if len(s) == k:
		t = ((1 << 8) - 1)
		answer = "{0}.{1}.{2}.{3}".format(mask >> 24, (mask >> 16) & t, (mask >> 8) & t, mask & t)
		break

print answer
