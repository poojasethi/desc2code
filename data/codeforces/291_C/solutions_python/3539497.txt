R=lambda d:map(int,raw_input().split(d))
n,k=R(' ')
a=[reduce(lambda x,y:x*256+y,R('.')) for _ in range(n)]
m,z,c=-1,-1,0
while m&(1<<31):
  t=set(m&x for x in a)
  if k==len(t):
    z=m&-1
    c+=1
  m<<=1
print '%d.%d.%d.%d'%((z>>24)&0xff,(z>>16)&0xff,(z>>8)&0xff,z&0xff) if c else -1
