if __name__ == "__main__":
    n, k = map(int, raw_input().split())
    addrs = []
    for i in range(n):
        addrs.append(''.join([bin(int(ss))[2:].zfill(8) for ss in raw_input().split(".")]))
    for i in range(1, 33):
        l = len(set((a[:i] for a in addrs)))
        if l >= k:
            break
    if l == k:
        print '.'.join([str(int(("1" * i + "0" * (32 - i))[j*8:(j+1)* 8], 2)) for j in range(4)])
    else:
        print "-1"
