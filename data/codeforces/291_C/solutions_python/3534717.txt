#!/usr/bin/env python
from sys import stdin as cin
import re

def str2int(s):
	return reduce(lambda a,b: a<<8 | b, map(int, s.split(".")))

def int2str(i):
	return ".".join(map(lambda n: str(i>>n & 0xFF), [24,16,8,0]))

def subnets(ips, l):
	mask = -1 << l
	return set(ip & mask for ip in ips)

def main():
	n, k = map(int, next(cin).split())
	ips = set(str2int(next(cin).strip()) for _ in range(n))

	L = 1
	R = 31

	while L+1 < R:
		l = (L + R) // 2
		ips2 = subnets(ips, l)
		if len(ips2) < k:
			R = l
		else:
			L = l
			ips = ips2

	
	if len(subnets(ips, R)) == k:
		return int2str(-1 << R)
	elif len(subnets(ips, L)) == k:
		return int2str(-1 << L)
	else:
		return -1


print main()
