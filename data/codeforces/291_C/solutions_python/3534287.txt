n, k = [int(i) for i in raw_input().split()]

ips = []
for i in range(n):
    ip1, ip2, ip3, ip4 = [int(i) for i in raw_input().split(".")]
    ips.append((ip1<<24)|(ip2<<16)|(ip3<<8)|(ip4))

sn = 0
oi = 31
while oi >= 0:
    sn |= (1<<oi)
    oi -= 1
    nw = set([])
    for ip in ips:
        nw.add(ip&sn)
    if len(nw) == k:
        break

if oi == -1:
    print -1
else:
    print "{0}.{1}.{2}.{3}".format(sn>>24, (sn>>16)&255, (sn>>8)&255, sn&255)