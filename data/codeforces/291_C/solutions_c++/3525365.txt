#include <stdio.h>
#include <algorithm>
using namespace std;
__int64 sto[100001];
void print(__int64 a){
	int i,x[4];
	for(i=3;i>=0;i--){
		x[i]=a&255;
		a>>=8;
	}
	for(i=0;i<4;i++) printf("%d%s",x[i],i<3?".":"\n");
}
int main(){
	//freopen("6.in","r",stdin);
	//freopen("out.txt","w",stdout);
	int n,i,j,k,x[4],cnt;
	__int64 a,mask,one=1,tp,pre;
	scanf("%d %d",&n,&k);
	for(i=0;i<n;i++){
		scanf("%d.%d.%d.%d",x,x+1,x+2,x+3);
		a=0;
		for(j=0;j<4;j++) a=(a<<8)|x[j];
		sto[i]=a;
	}
	sort(sto,sto+n);
	for(i=1;i<32;i++){
		mask=0;
		for(j=0;j<i;j++) mask|=(one<<(31-j));
		cnt=1;
		for(j=0;j<n;j++){
			tp=sto[j]&mask;
			if(j && tp!=pre) cnt++;
			pre=tp;
		}
		if(cnt==k) break;
	}
	if(i<32) print(mask); else puts("-1");
}
