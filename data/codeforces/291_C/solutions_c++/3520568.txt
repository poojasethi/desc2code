#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <iostream>
#include <map>
#define MAX 112345

using namespace std;

typedef long long ll;

int main(){
	int n, k;
	scanf("%d%d", &n, &k);
	ll v[MAX];
	for (int i = 0; i < n; i++){
		ll t;
		cin >> t;
		for (int j = 0; j < 3; j++){
			t = (t<<8LL);
			scanf("%*c");
			ll tm;
			cin >> tm;
			t += tm;
		}
		v[i] = t;
	}
	map <ll, int> m;
	for (ll i = 1; i <= 32; i++){
		m.clear();
		ll mask = (1LL<<(i)) - 1LL;
		mask = (mask << (32LL-i));
		for (int j = 0; j < n; j++)
			m[v[j]&mask] = 1;
		if((int)m.size() == k){
			cout << (mask>>24) << "." << ((mask>>16)&255) << "." << ((mask>>8)&255) << "." << (mask&255) << endl;
			return 0;
		}
	}
	printf("-1\n");
	return 0;
}
