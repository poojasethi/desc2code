#include <stdio.h>
#include <string.h>
#include <iostream>
#include <algorithm>
using namespace std;
const int MAXN=100000+2;
#define LL __int64
LL a[MAXN],b[MAXN];
int main ( ) {
    LL n,k;
    scanf("%I64d%I64d",&n,&k);
    LL f1,f2,f3,f4;
    for (int i=0;i<n;i++) {
        scanf("%I64d.%I64d.%I64d.%I64d",&f1,&f2,&f3,&f4);
        a[i]=(f1<<24)+(f2<<16)+(f3<<8)+f4;
    }
    sort (a,a+n);
    LL MAX=(1LL<<32)-1;
    for(int j=31;j;j--) {
        LL s=MAX>>j<<j;
        for (int i=0;i<n;i++)
        b[i]=a[i]&s;
        if (unique(b,b+n)-b==k) {
            printf("%I64d.%I64d.%I64d.%I64d\n",(s>>24)&255,(s>>16)&255,(s>>8)&255,(s)&255);
            return 0;
        }
    }
            printf("-1\n");
    return 0;
}

  			  				     			  		 	 		