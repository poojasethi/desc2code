#include<iostream>
#include<cstdio>
#include<set>
#define rep(i,n) for(int i=0;i<n;i++)

using namespace std;
unsigned a[100005];
int main()
{
    int n,k;
    unsigned b,c,d,e;
    while(~scanf("%d%d",&n,&k))
    {
        rep(i,n)
        {
           scanf("%d.%d.%d.%d",&b,&c,&d,&e);
           a[i]=(b<<24)+(c<<16)+(d<<8)+e;
        }
        set<int> st;
         unsigned h=0;
        for(int i=31;i>0;i--)
        {
            h|=(1<<i);
            st.clear();
            rep(j,n)
            st.insert(h&a[j]);
            if(st.size()==k) 
                break;
        }
        if(st.size()==k)
            printf("%d.%d.%d.%d\n",h>>24,(h<<8)>>24,(h<<16)>>24,(h<<24)>>24);
        else printf("-1\n");
    }
}

    	 					 		 	        		