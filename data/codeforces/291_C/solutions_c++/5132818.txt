#include <iostream>
#include <algorithm>
#include <stdio.h>
using namespace std;
int n,k;
long long mask=0,ip[100005],b[100005];
int main()
{//freopen("i.txt","r",stdin);
cin>>n>>k;
for (int i=0;i<n;i++)
{int a1,a2,a3,a4; char c1,c2,c3;
 cin>>a1>>c1>>a2>>c2>>a3>>c3>>a4;
 ip[i]=(a1<<24)+(a2<<16)+(a3<<8)+a4;
}
sort(ip,ip+n);
for (int ii=31;ii>=0;ii--)
{mask=mask|(1<<ii);
 int c=1;
 b[0]=ip[0]&mask;
 for (int i=1;i<n;i++)
  {b[i]=ip[i]&mask;
   if (b[i]!=b[i-1]) c++;
  }
 if (c==k)
 {cout<<((mask>>24)&255)<<'.'<<((mask>>16)&255)<<'.'<<((mask>>8)&255)<<'.'<<(mask&255);
  return 0;
 }
}
 cout<<-1; return 0;
}