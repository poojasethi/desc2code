#include <cstdio>
#include <set>
using namespace std;
unsigned int ip[100000];
int main(int argc, char const *argv[])
{
	int n, k;
	scanf("%d%d", &n, &k);
	for (int i = 0; i < n; ++i) {
		int p1, p2, p3, p4;
		scanf("%d.%d.%d.%d", &p1, &p2, &p3, &p4);
		ip[i] = (p1 << 24) | (p2 << 16) | (p3 << 8) | p4;
	}
	unsigned int mask = 0;
	for (int mi = 31; mi > 0; --mi) {
		mask |= (1 << mi);
		set<unsigned int> s;
		for (int i = 0; i < n; ++i) {
			s.insert(ip[i] & mask);
		}
		if (s.size() == k) {
			unsigned int mm = 0xff;
			for (int mmi = 24; mmi >= 0; mmi -= 8) {
				printf("%d", (mask >> mmi) & mm);
				putchar(mmi == 0 ? '\n' : '.');
			}
			return 0;
		}
	}
	printf("-1\n");
	return 0;
}