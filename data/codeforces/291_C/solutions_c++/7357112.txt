#include<iostream>
#include<cstdio>
#include<set>
using namespace std;
unsigned int ip[100010];
int main()
{
    int i,j,n,k;
    unsigned int t=0;
    set<unsigned int> s;
    scanf("%d%d",&n,&k);
    for (i=0;i<n;i++)
    {
        unsigned int a,b,c,d;
        scanf("%d.%d.%d.%d",&a,&b,&c,&d);
        ip[i]=(a<<24)+(b<<16)+(c<<8)+d;
    }
    for (i=31;i>=1;i--)
    {
        t|=(1<<i);
        s.clear();
        for (j=0;j<n;j++)
            s.insert(t&ip[j]);
        if (s.size()==k)
            break;
    }
    if (s.size()==k)
        printf("%d.%d.%d.%d",t>>24,(t<<8)>>24,(t<<16)>>24,(t<<24)>>24);
    else
        printf("-1\n");
    return 0;
}
  		 			  			 			 		    		