#include <cstdio>
#include <set>

using namespace std;

int n, k;
unsigned int v[100010], w[100010], ans;

int main()
{
	scanf("%d %d", &n, &k);
	for (int i=0; i<n; i++) {
		int a[4];
		scanf("%d.%d.%d.%d", a, a+1, a+2, a+3);
		for (int j=0; j<4; j++) {
			v[i] <<= 8;
			for (int k=0; k<8; k++)
				v[i] |= a[j] & (1 << k);
		}
	}
	for (int s=31; s>0; s--) {
		set<int> st;
		for (int i=0; i<n; i++) {
			w[i] |= v[i] & (1 << s);
			st.insert(w[i]);
		}
		ans |= 1 << s;
		if (int(st.size()) == k) {
			for (int i=3; i>=0; i--) {
				printf("%d%c", (ans >> (8 * i)) & 255, "\n."[i>0]);
			}
			return 0;
		}
	}
	printf("-1\n");
	return 0;
}
