#include <iostream>
#include <cstdio>
#include <set>

using namespace std;

unsigned int n,k,st1,st2,st3,st4,i,j,subnet,address[100010];
set <unsigned int> collections;

int main(){
	scanf("%d %d",&n,&k);
	for(i=0;i<n;i++){
		scanf("%d.%d.%d.%d",&st1,&st2,&st3,&st4);
		address[i]=(st1<<24)+(st2<<16)+(st3<<8)+st4;
	}
	subnet=0;
	for(i=31;i>=1;i--){
		subnet+=1<<i;
		collections.clear();
		for(j=0;j<n;j++) collections.insert(subnet&address[j]);
		if(collections.size()==k) break;
	}
	if(collections.size()==k) 
		printf("%d.%d.%d.%d\n",subnet>>24,(subnet<<8)>>24,(subnet<<16)>>24,(subnet<<24)>>24);
	else printf("-1\n");
	return 0;
}
		  			  		  	   	  		   	