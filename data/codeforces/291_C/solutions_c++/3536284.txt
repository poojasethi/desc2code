#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
__int64 a,b,c,d,ip[100010],sm,nw[100010],i,j,k,n,m,ans;
int main()
{
	cin>>n>>m;
	for(i=1;i<=n;i++)
	{
		scanf("%I64d.%I64d.%I64d.%I64d",&a,&b,&c,&d);
		ip[i]=(a<<24)|(b<<16)|(c<<8)|d;
	}
	for(j=1;j<=31;j++)
	{
		sm=((1ll<<(32-j))-1)<<j;
		for(i=1;i<=n;i++) nw[i]=sm&ip[i];
		sort(nw+1,nw+n+1);
		for(i=1,k=0;i<=n;i++)
			if(i==1||nw[i]!=nw[i-1]) k++;
		if(k==m) ans=sm;
	}
	if(ans) printf("%I64d.%I64d.%I64d.%I64d\n",ans>>24&255,ans>>16&255,ans>>8&255,ans&255);
	else puts("-1");
}