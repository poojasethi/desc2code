#include <cstdio>
#include <map>
#include <vector>
using namespace std;
#define REP(i,n) for(int i=0;i<(n);i++)

int main()
{
	int n,k;
	scanf("%d%d",&n,&k);
	vector<unsigned> v;
	REP(i,n)
	{
		int a,b,c,d;
		char buf[100];
		scanf("%s",buf);
		REP(i,100)
			if(buf[i]=='.') buf[i]=' ';
		sscanf(buf,"%d %d %d %d",&a,&b,&c,&d);
		v.push_back(((a*256+b)*256+c)*256+d);
	}
	unsigned mask=0;
	for(int j=31;j>0;j--)
	{
		mask|=(1U<<j);
		map<int,int> used;
		REP(i,n)
			used[v[i]&mask]=1;
		if(used.size()==k)
		{
			int a,b,c,d;
			d=mask&255;
			mask>>=8;
			c=mask&255;
			mask>>=8;
			b=mask&255;
			mask>>=8;
			a=mask&255;
			printf("%d.%d.%d.%d\n",a,b,c,d);
			return 0;
		}
	}
	puts("-1");
}
