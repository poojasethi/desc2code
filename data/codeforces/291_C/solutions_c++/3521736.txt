#include <map>
#include <cstdio>

const int MAXN = 100000;
int n, m;
unsigned ip[MAXN], a, b, c, d, mask;
inline bool check(const unsigned mask)
{
  std::map<unsigned, int> map;
  for (int i = 0; i < n; ++i) ++map[ip[i]&mask];
  return static_cast<int>(map.size()) == m;
}
int main()
{
  scanf("%d%d", &n, &m);
  for (int i = 0; i < n; ++i)
  {
    scanf("%u.%u.%u.%u", &a, &b, &c, &d);
    ip[i] = (a << 24) + (b << 16) + (c << 8) + d;
  }
  mask = 0;
  for (int i = 31; i >= 0; --i)
    if (check(mask ^= 1<<i))
    {
      printf("%u.%u.%u.%u\n", (mask >> 24) & 255, (mask >> 16) & 255, (mask >> 8) & 255, mask & 255);
      return 0;
    }
  printf("-1");
}
