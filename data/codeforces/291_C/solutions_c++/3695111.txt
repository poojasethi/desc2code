#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <queue>
#include <map>
#include <string.h>
#include <vector>
#include <set>

const int N=200010;
const int inf=0x3f3f3f3f;

using namespace std;

#define pb push_back
#define sz(x) ((x).size())

int ip[N];

int main(){
	int n, k;
	scanf("%d%d", &n, &k);
	for(int i = 0; i < n; i++){
		int a[4];
		scanf("%d.%d.%d.%d", a, a + 1, a + 2, a + 3);
		for(int j = 0; j < 4; j++){
			ip[i] |= a[j] << (8 * (3 - j));
		}
	}
	for(int i = 31, j = 0; i >=0; i--){
		j |= (1<<i);
		set<int> st;
		for(int s = 0; s < n; s++)
			st.insert(j & ip[s]);
		if(st.size() == k){
			for(int s = 3; s >= 0; s--){
				printf("%d%c", (j >> (8 * s)) & 255, ".\n"[s == 0]);
			}
			return 0;
		}
	}
	puts("-1");
	return 0;
}
