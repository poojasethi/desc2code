#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<map>
using namespace std;

long long a[100005];
map<long long,int> M;

int main()
{
	int n,k,i,j;
	long long p1,p2,p3,p4;
	scanf("%d%d",&n,&k);
	for(i=0;i<n;i++)
	{
		scanf("%I64d.%I64d.%I64d.%I64d",&p1,&p2,&p3,&p4);
		a[i]=p4+(p3<<8)+(p2<<16)+(p1<<24);
	}
	long long x=0;
	for(j=31;j>=0;j--)
	{
		x+=1LL<<j;
		M.clear();
		for(i=0;i<n;i++)
		{
			long long y=x&a[i];
			M[y]=1;
		}
		if(M.size()==k) break;
	}
	if(j>=0)
	{
		p1=x&(0xFF000000);
		p2=x&(0x00FF0000);
		p3=x&(0x0000FF00);
		p4=x&(0x000000FF);
		printf("%I64d.%I64d.%I64d.%I64d\n",p1>>24,p2>>16,p3>>8,p4);
	}
	else puts("-1");
}
