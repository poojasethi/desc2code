#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <map>
using namespace std;
int n,k,cnt; long long a[100005],m; map<long long,bool> c;
void read(int x)
{
    long long s,t,u,v; scanf("%I64d.%I64d.%I64d.%I64d",&s,&t,&u,&v);
    a[x]=(s<<24)+(t<<16)+(u<<8)+v;
}
void print(long long x)
{
    for(long long i=3;i>=0;--i)
    {
        printf("%I64d",(x>>(i*8))&255);
        if(i) printf(".");
    }
    printf("\n");
}
int main()
{
    scanf("%d%d",&n,&k);
    for(int i=0;i<n;++i) read(i);
    for(long long i=31;i>=0;--i)
    {
        m|=1ll<<i; c.clear(); cnt=0;
        for(int j=0;j<n;++j) if(!c[a[j]&m]) {c[a[j]&m]=1; ++cnt;}
        if(cnt==k) {print(m); return 0;;}
    }
    printf("-1\n"); return 0;
}
