#include<cstdio>
#include<iostream>
#include<algorithm>
using namespace std;
typedef long long LL;
int n, m, i, bn, j;
LL a[100010], b[100010], x;
char ch;
int print(LL x){
	for(j=3;j>0;j--){
		cout<<(x>>(8LL*LL(j)))%256LL<<".";
	}
	cout<<x%256LL<<endl;
}
int main(){
	scanf("%d%d", &n, &m);
	for(i=1;i<=n;i++){
		int x;
		for(j=3;j>=0;j--){
			scanf("%c", &ch);
			scanf("%d", &x);
			a[i]|=LL(x)<<(8LL*LL(j));
		}
	}
	x = 0;
	for(i=31;i>=1;i--){
		x|=1LL<<LL(i);
		bn=0;
		for(j=1;j<=n;j++)b[++bn] = a[j]&x;
		sort(b+1, b+1+bn);
		bn=unique(b+1, b+1+bn)-b;
		if(bn-1 == m){
			print(x);
			return 0;
		}
	}
	printf("-1\n");
	return 0;
}
