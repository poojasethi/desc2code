#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
#define rep(i,n) for (int i=0;i<n;i++)
int n,k,x,cnt;
unsigned int key,a[100005],b[100005];
int main()
{
    scanf("%d%d",&n,&k);
    rep(i,n) rep(j,4) scanf("%d.",&x),(a[i]<<=8)|=x;
    rep(j,32){
        key|=1<<31-j; cnt=0; rep(i,n) b[i]=a[i]&key; sort(b,b+n);
        rep(i,n) if (!i || b[i]!=b[i-1]) cnt++; if (cnt==k) break;
        }
    if (cnt!=k) puts("-1");
    else printf("%d.%d.%d.%d\n",key>>24,key>>16&255,key>>8&255,key&255);
    return 0;
}