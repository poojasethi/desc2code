#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
#include <set>
using namespace std;
#define LL long long

int n,k;
set<LL> s;
LL a[5],ip[100005];

int main() {
	scanf("%d%d",&n,&k);
	for (int i=0; i<n; i++) {
		scanf("%I64d.%I64d.%I64d.%I64d",&a[0],&a[1],&a[2],&a[3]);
		ip[i] = (a[0]<<24)+(a[1]<<16)+(a[2]<<8)+a[3];
	}
	LL sub = 0;
	for (int i=0; i<31; i++) {
		sub |= 1LL<<(31-i);
		s.clear();
		for (int j=0; j<n; j++) {
			s.insert(ip[j]&sub);
		}
		if (s.size() == k) {
			printf("%I64d.%I64d.%I64d.%I64d\n",sub/(1<<24),sub%(1<<24)/(1<<16),sub%(1<<16)/(1<<8),sub%(1<<8));
			return 0;
		}
	}
	puts("-1");
	return 0;
}
