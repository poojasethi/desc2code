#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
__int64 a[100005];
int main()
{
    int n,k;
    char ch;
    cin>>n>>k;
    for(int i=0;i<n;++i)
    {
        int b,c,d,e;
        cin>>b>>ch>>c>>ch>>d>>ch>>e;
        a[i]=((b*256+c)*256+d)*256+e;
    }
    sort(a,a+n);
    __int64 m=0,flag=0;
    for(int i=31;i>=0;--i)
    {
        m+=(1LL<<i);
        int d=1;
        for(int j=1;j<n;++j)
            if((a[j]&m)!=(a[j-1]&m))
                ++d;
        if(d==k){flag=1;break;}
    }
    if(flag)cout<<(m>>24)%256<<'.'<<(m>>16)%256<<'.'<<(m>>8)%256<<'.'<<m%256<<endl;
    else cout<<-1<<endl;
}

  	 		            			   	