#include <cstdio>
#include <cstring>
#include <set>
using namespace std;

unsigned int a[100010];
int main()
{
    int n,k; scanf("%d%d",&n,&k);
    for(int i=0;i<n;++i) {
        unsigned int w,x,y,z; scanf("%u.%u.%u.%u",&w,&x,&y,&z);
        a[i]=(w<<24)+(x<<16)+(y<<8)+z;
    }

    char res[32];
    strcpy(res,"-1");
    unsigned int m=1u<<31;
    for(int i=30;i>=0;--i) {
        set<unsigned int> s;
        for(int j=0;j<n;++j) s.insert(a[j]&m);
        if (s.size()==k) {
            sprintf(res,"%u.%u.%u.%u",m>>24,(m>>16)&0xff,(m>>8)&0xff,m&0xff);
            break;
        }
        m+=(1u<<i);
    }
    puts(res);
    return 0;
}