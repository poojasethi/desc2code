#include<stdio.h>
#include<iostream>
#include<set>
#include<string>
using namespace std;
long long a,s,d[100002],f,g,h,j,k,l,n,m,c,r;
int i;
string x;
set<int> q;
main(){
cin>>n>>m;
for(i=0;i<n;i++){
cin>>x;x="."+x;
k=x.size();
s=1;f=1;
for(a=k-1;a>=0;a--){
if(x[a]=='.') {
d[i]=d[i]+l*f;
f=f<<8;l=0;
s=1;continue;
}
l=l+(x[a]-48)*s;
s=s*10;
}
}

c=1LL<<31;k=0;
for(i=0;i<=31;i++){
q.clear();j=k>>1;
k=(long long)j+c;
for(j=0;j<n;j++){
a=d[j]&k;
q.insert(a);
}
if(q.size()==m){
g=1;f=0;s=0;


int ip4=k%256;
int ip3=(k%(256*256))/256;
int ip2=(k%(256*256*256))/(256*256);
int ip1=k/(256*256*256);
cout<<ip1<<"."<<ip2<<"."<<ip3<<"."<<ip4;

return 0;
}

}cout<<-1;
}
