#include <cstdio>
#include <set>
using namespace std;

int n, k;
unsigned int add[100005];

int main() {
	scanf("%d%d", &n, &k);
	for(int a,b,c,d,i=0; i<n; ++i) {
		scanf("%d.%d.%d.%d", &a, &b, &c, &d);
		add[i] = a<<24 | b<<16 | c<<8 | d;
	}
	unsigned int ans = 0;
	for(unsigned int msk=0xFFFFFFFFu; msk; msk<<=1) {
		set<int> st;
		for(int i=0; i<n; ++i)
			st.insert(add[i] & msk);
		if(st.size() == k) ans = msk;
	}
	if(!ans) puts("-1");
	else printf("%u.%u.%u.%u\n",
				ans>>24&255, ans>>16&255, ans>>8&255, ans&255);
}
