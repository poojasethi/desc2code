#include<stdio.h>
#include<stdlib.h>
#include<set>
using namespace std;
int ip[101000];
int main(){
    int n,k;
    scanf("%d %d",&n,&k);
    for(int i=0;i<n;i++){
        int a,b,c,d;
        scanf("%d.%d.%d.%d",&a,&b,&c,&d);
        ip[i]= (a<<24) + (b<<16)+ (c<<8) +d;
    }
    int mask=0;
    for(int i=31;i>=0;i--){
        mask|=(1<<i);
        set<int> st;
        for(int j=0;j<n;j++){
            st.insert(ip[j]&mask);
        }
        if(st.size()==k){
            int a= (mask>>24)&255;
            int b= (mask>>16) &255;
            int c= (mask>>8) &255;
            int d= (mask) &255;
            printf("%d.%d.%d.%d\n",a,b,c,d);
            return 0;
        }
    }

    printf("-1\n");
}
