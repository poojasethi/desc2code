#include <iostream>
#include <stdio.h>
#include <set>
using namespace std;
long long a[100005];
int main()
{
	int i,j,k,l,o,n,m;
	scanf("%d %d",&n,&m);
	for (i=1;i<=n;i++)
	{
		scanf("%d.%d.%d.%d",&j,&k,&l,&o);
		a[i]=0LL+o+l*256+k*256*256+j*256*256*256;
	}
	bool ans=0;
	long long kk;
	for (i=1;i<=31;i++)
	{
		bool f=0;
		set<long long> s;
		if (i==16)
		{
			i=16;
		}
		kk=0LL+((1<<i)-1)<<(32-i);
		for (j=1;j<=n;j++)
		{
			s.insert(kk&a[j]);
		}
		if (s.size()==m)
		{
			ans=1;
			break;
		}
	}
	if (ans)
	{
		o=kk%256; kk>>=8;
		l=kk%256; kk>>=8;
		k=kk%256; kk>>=8;
		j=kk;
		printf("%d.%d.%d.%d\n",j,k,l,o);
	}
	else
	{
		printf("-1\n");
	}
}