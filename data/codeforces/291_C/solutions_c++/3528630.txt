#include <stdio.h>
#include <vector>
#include <set>

using namespace std;

int main() {

	int n, k;
	scanf("%d %d", &n, &k);

	vector<unsigned> ips;
	ips.resize(n);

	for(int i = n; i--; ) {
		int a, b, c, d;
		scanf("%d.%d.%d.%d", &a, &b, &c, &d);

		ips[i] = a << 24 | b << 16 | c << 8 | d;
	}

	std::set<unsigned> ns;
	unsigned mask = 1 << 31;

	while(true) {
		for(int i = n; i--; ) {
			unsigned n = ips[i] & mask;
			ns.insert(n);
		}

		int s = ns.size();

		if(s == k) {
			printf("%d.%d.%d.%d", mask >> 24 & 0xFF, mask >> 16 & 0xFF, mask >> 8 & 0xFF, mask & 0xFF);
			break;
		}

		if(s > k) {
			printf("-1");
			break;
		}

		mask >>= 1;
		mask |= 1 << 31;

		ns.clear();
	}

    return 0;
}









































