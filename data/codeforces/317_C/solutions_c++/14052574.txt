#include<cstdio>
#include<vector>
#include<string>
#include<algorithm>
#include<cstdio>
#define N 300
#define LL long long
using namespace std;
int a[N],b[N];
int g[N][N];

int vis[N],cs;
int p[N],l;
int n;

bool path(int v){
	vis[v]=cs;
	p[++l]=v;
	if( b[v]>a[v] ) return 1;
	
	for(int i=0;i<n;++i)
		if(g[v][i] && vis[i]!=cs)
			if( path(i) )
				return 1;
	--l;
	return 0;
}

LL s1,s2;
bool aux[N];
void check(int v){
	aux[v]=1;
	s1+=a[v],s2+=b[v];
	for(int i=0;i<n;++i)
		if( g[v][i] && !aux[i])
			check(i);
}

vector<string> ans;
char buff[50];
void flow(int i,int flw){

	int v=p[i],u=p[i+1];
	if(a[v]<flw){
		sprintf(buff,"%d %d %d",v+1,u+1,a[v]);
		ans.push_back(buff);
		flow(i-1,flw);
		sprintf(buff,"%d %d %d",v+1,u+1,flw-a[v]);
		ans.push_back(buff);
	}else{
		sprintf(buff,"%d %d %d",v+1,u+1,flw);
		ans.push_back(buff);
		if(i)
			flow(i-1,flw);
	}

}

int main(){
	int v,e;scanf("%d%d%d",&n,&v,&e);
	for(int i=0;i<n;++i)
		scanf("%d",a+i);
	for(int i=0;i<n;++i)
		scanf("%d",b+i);
	for(int i=0,u,v;i<e;++i){
		scanf("%d%d",&u,&v),--u,--v;
		g[u][v]=g[v][u]=1;
	}
	for(int i=0;i<n && s1==s2 ; ++i)
		if(!aux[i])
			check(i);
	if(s1!=s2)
		printf("NO\n");
	else{
		int q[n],ft=0,bk=-1;
		for(int v=0;v<n;++v)
			if(b[v]<a[v])
				q[++bk]=v;
		while( ft<=bk ){
			int v=q[ft++];
			l=-1,++cs;
			path(v);
			int u=p[l];
			int flw=min(abs(a[v]-b[v]),abs(b[u]-a[u]));
			flow(l-1,flw);
			a[v]-=flw,a[u]+=flw;
			if(a[v]>b[v])
				q[++bk]=v;	
		}
		printf("%d\n",ans.size());
		for(int i=0;i<ans.size();++i)
			printf("%s\n",ans[i].c_str());
	}
	return 0;
}
