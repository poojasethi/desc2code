#include<cstdio>
#define min(a,b)(a<b?a:b)
#define r(a,b) for(int a=0;a<b;a++)
#define s(x) scanf("%d",&x);
int a[333],b[333],n,v,e,k[333][333],p[111111][3],o;void add(int q,int w,int d){p[o][0]=q+1;p[o][1]=w+1;p[o++][2]=d;a[w]+=d;a[q]-=d;}void go(int q,int w,int d){if(k[q][w]==1){add(q,w,d);return;}r(e,n)if(k[q][e]<k[q][w]&&k[e][w]==1){if(a[e]>=d){add(e,w,d);go(q,e,d);break;}else{int s=d-a[e];add(e,w,a[e]);go(q,e,d);add(e,w,s);break;}}}int main(){s(n)s(v)s(e)r(q,n)r(w,n)k[q][w]=n+1;r(q,n)s(a[q])r(q,n)s(b[q])r(q,e){int u,v;s(u)s(v)u--;v--;k[u][v]=k[v][u]=1;}r(q,n)r(w,n)r(e,n)k[w][e]=min(k[w][e],k[w][q]+k[q][e]);o=0;r(i,n)r(q,n){if(a[q]>b[q])r(w,n)if(a[w]<b[w]&&k[q][w]<=n){go(q,w,min(a[q]-b[q],b[w]-a[w]));break;}}r(q,n)if(a[q]!=b[q]){printf("NO\n");return 0;}printf("%d\n",o);r(q,o)printf("%d %d %d\n",p[q][0],p[q][1],p[q][2]);return 0;}
