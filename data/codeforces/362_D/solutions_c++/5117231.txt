#include <bits/stdc++.h>
#define ll long long
#define ull unsigned long long
#define ui unsigned int
#define fi first
#define se second
#define pii pair < int, int > 
#define plli pair < ll, int > 
#define pllll pair < ll, ll > 
#define mp make_pair
#define pb push_back
#define scan1(_x) scanf("%d", &(_x))
#define scan2(_x,_y) scanf("%d%d", &(_x), &(_y))
#define FOR(_i,_a,_b) for(int (_i) = (_a); (_i) < (_b); (_i)++)
#define me(_M,_v) memset((_M), (_v), sizeof (_M))
#define MAXN 100001
#define MOD 1000000007
#define oo (1<<30)
#define EPS 1e-10

using namespace std;

int n, m, p, q;
int x = -1, y = -1, l;
int H[MAXN];
ll T[MAXN], cnt = 0;

int F(int a){ return H[a]==a?a:H[a]=F(H[a]); }
void U(int a, int b, int l){
    T[F(a)] += T[F(b)] + l;
    H[F(b)] = F(a);
}

int main()
{
    scanf("%d%d%d%d", &n, &m, &p, &q);
    for(int i = 0; i <= n; i++)
        H[i] = i;
    FOR(i,0,m){
        scanf("%d%d%d", &x, &y, &l);
        if( F(x) != F(y) ) U(x,y,l);
        else T[F(x)] += l;
    }
    priority_queue < plli > Q;
    for(int i = 1; i <= MAXN; i++)
        if( H[i] == i ) Q.push(mp(-T[i],i)), cnt++;
    
    if( cnt < q || cnt-q > p || (cnt == q && p > 0 && x == -1) ) puts("NO");
    else {
        puts("YES");
        for(int i = cnt - q; i > 0; i--, p--){
            x = Q.top().se; Q.pop();
            y = Q.top().se; Q.pop();
            U(x,y,min(1000000000LL, T[x]+T[y]+1));
            Q.push(mp(-T[x],x));
            printf("%d %d\n", x, y);
        }
        FOR(i,0,p)
            printf("%d %d\n", x, y);
    }
}