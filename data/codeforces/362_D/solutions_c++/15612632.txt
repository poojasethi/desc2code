//Author: sagarkaniche
#include <bits/stdc++.h>
#define ll long long
using namespace std;
#define si(x) scanf("%d",&x)
#define sdb(x) scanf("%lf",&x)
#define sll(x) scanf("%I64d",&x)
#define pb push_back
#define res 1000000007
typedef pair<ll,ll> pp;

int vis[200010];
std::vector<ll> adj[200010],edge[200010];
set<pp>st;
ll dfs(int v)
{
	ll ans=0;
	vis[v]=1;
	for(int i=0;i<adj[v].size();i++)
	{
		ans+=edge[v][i];
		if(!vis[adj[v][i]])
		{
			ans+=dfs(adj[v][i]);	
		} 
	}
	return ans;
}
int main()
{
	int n,m,p,q,i,temp1,temp2,temp3;
	si(n);si(m);si(p);si(q);
	for(i=0;i<m;i++)
	{
		si(temp1);
		si(temp2);
		si(temp3);
		adj[temp1].pb(temp2);
		adj[temp2].pb(temp1);
		edge[temp1].pb(temp3);
		edge[temp2].pb(temp3);
	}

	for(i=1;i<=n;i++) if(!vis[i]) st.insert(pp(dfs(i)/2,i));
	// while(!st.empty())
	// {
	// 	pp x=*st.begin();
	// 	printf("%lld %lld\n",x.first,x.second);
	// 	st.erase(st.begin());
	// }
	if(st.size()<q)
	{
		printf("NO\n");
	}
	else if(st.size()-q>p)
	{
		printf("NO\n");
	}
	else if(q==n)
	{
		if(p!=0) printf("NO\n");
		else printf("YES\n");
	}
	else
	{
		printf("YES\n");
		while(st.size()>q)
		{
			pp x=*st.begin();
			st.erase(st.begin());
			pp y=*st.begin();
			st.erase(st.begin());
			st.insert(pp(min(x.first+y.first+1,(ll)10e9)+x.first+y.first,x.second));
			printf("%I64d %I64d\n",x.second,y.second);
			temp1=x.second;temp2=y.second;
			p--;
		}
		while(p--) printf("%d %d\n", temp1,temp2);
	}
	return 0;
}