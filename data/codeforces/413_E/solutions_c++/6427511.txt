#include <cstdio>
#include <iostream>
#define MAXN 222222

using namespace std;

int n, m;
char a[4][MAXN];
int p[2 * MAXN][22];
int x[2 * MAXN], y[2 * MAXN];

int main(){
    //freopen("input.txt", "r", stdin);

    scanf("%d %d", &n, &m);

    for (int i = 0; i <= 3; i++)
        for (int j = 0; j <= n + 1; j++) a[i][j] = 'X';

    scanf("\n");
    for (int i = 0; i < 2; i++){
        for (int j = 1; j <= n; j++){
            scanf("%c", &a[i + 1][j]);
            x[i * n + j] = i + 1;
            y[i * n + j] = j;
        }
        scanf("\n");
    }

    for (int i = 1; i <= 2 * n; i++){
        p[i][0] = i;
        if (a[x[i]][y[i] + 1] == '.') { p[i][0] = (x[i] - 1) * n + y[i] + 1; continue; }
        if (a[x[i] + 1][y[i]] == '.') { p[i][0] = (x[i]) * n + y[i]; continue; }
        if (a[x[i] - 1][y[i]] == '.') { p[i][0] = (x[i] - 2) * n + y[i]; continue; }
    }

    for (int j = 1; j <= 19; j++)
        for (int i = 1; i <= 2 * n; i++)
            p[i][j] = p[p[i][j - 1]][j - 1];

    while (m--){
        int u, v;
        scanf("%d %d\n", &u, &v);

        if (y[u] == y[v]){
            if (x[u] == x[v]) printf("0\n");
            else printf("1\n");
            continue;
        }

        if (y[v] < y[u]) swap (u, v);

        int res = -1;
        int tmp = 1;
        int uu = u;
        for (int i = 19; i >= 0; i--){
            int uuu = p[uu][i];
            if (y[uuu] >= y[v]) continue;
            //cout << " -> " << uuu << " " << (1 << i) << " " << tmp << endl;
            uu = uuu;
            tmp = tmp + (1 << i);
        }
        uu = p[uu][0];
        //cout << uu << endl;
        if (uu == v) res = tmp;
        //cout << res << endl;

        if (a[x[v] + 1][y[v]] == '.') v = (x[v]) * n + y[v];
        else if (a[x[v] - 1][y[v]] == '.') v = (x[v] - 2) * n + y[v];
        tmp = 2;
        uu = u;
        for (int i = 19; i >= 0; i--){
            int uuu = p[uu][i];
            if (y[uuu] >= y[v]) continue;
            uu = uuu;
            tmp = tmp + (1 << i);
        }
        uu = p[uu][0];

        if (uu == v)
            if (res == -1 || (res != -1 && tmp < res)) res = tmp;

        printf("%d\n", res);
    }
    return 0;
}
