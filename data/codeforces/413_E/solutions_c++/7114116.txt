#include <cstdio>
#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cmath>
using namespace std;
int a[2][400005],b,c,d,e,f[2][400005][2],g,h,i,j,k,l,m,n,fa[500005],r;
int dl[5000005];
int get(int x){
	int L=1;
	dl[L]=x;
	while(fa[dl[L]]!=dl[L]){dl[++L]=fa[dl[L-1]];}
	for(L--;L;L--)fa[dl[L]]=fa[dl[L+1]];
	return fa[x];
}
inline void make(int x,int y){x=get(x);y=get(y);if (x!=y)fa[x]=y;}
char s[400005];
inline void read(int &x){
	x=0;
	char ch;
	for(ch=getchar();ch<'0'||ch>'9';ch=getchar());
	for(;ch>='0'&&ch<='9';ch=getchar())x=x*10+ch-'0';
}
int main(){
	scanf("%d%d",&n,&m);int X=(int)sqrt(n);
	char ch;
	for(ch=getchar();ch!='.'&&ch!='X';ch=getchar());
	for(i=1;i<=n;i++){
		if (ch=='.')a[0][i]=1;
		ch=getchar();
	}
	for(ch=getchar();ch!='.'&&ch!='X';ch=getchar());
	for(i=1;i<n;i++){
		if (ch=='.')a[1][i]=1;
		ch=getchar();
	}
	if (ch=='.')a[1][n]=1;
	for(i=1;i<=n*2;i++)fa[i]=i;
	for(i=1;i<=n;i++){
		if (a[0][i]&&a[0][i+1])make(i,i+1);
		if (a[0][i]&&a[1][i])make(i,n+i);
		if (a[1][i]&&a[1][i+1])make(n+i,n+i+1);
	}
	for(i=n/X;i;i--){
		l=(i-1)*X+1;r=(i*X);
		f[0][r][0]=f[1][r][1]=1;
		f[0][r][1]=f[1][r][0]=2;
		if (!a[0][r+1])f[0][r][0]=f[1][r][0]=1<<30;
		if (!a[1][r+1])f[0][r][1]=f[1][r][1]=1<<30;
		for(j=r-1;j>=l;j--){
			if (a[0][j+1])f[0][j][0]=f[0][j+1][0]+1;else f[0][j][0]=f[1][j+1][0]+2;
			if (a[0][j+1])f[0][j][1]=f[0][j+1][1]+1;else f[0][j][1]=f[1][j+1][1]+2;
			if (a[1][j+1])f[1][j][0]=f[1][j+1][0]+1;else f[1][j][0]=f[0][j+1][0]+2;
			if (a[1][j+1])f[1][j][1]=f[1][j+1][1]+1;else f[1][j][1]=f[0][j+1][1]+2;
		}
	}
	for(;m;m--){
		read(b);read(c);
		if (get(b)!=get(c)){printf("-1\n");continue;}
		d=0;e=0;h=0;
		if (b>n){d=1;b=b-n;}
		if (c>n){e=1;c=c-n;}
		if (b>c){swap(b,c);swap(d,e);}
		if (b==c&&d==e&&!a[d][b]){printf("-1\n");continue;}
		i=b;j=d;
		while ((i-1)/X<(c-1)/X){
			if (f[j][i][1]<f[j][i][0]){
				h+=f[j][i][1];i=((i-1)/X+1)*X+1;j=1;
			}
			else{
				h+=f[j][i][0];i=((i-1)/X+1)*X+1;j=0;
			}
		}
		for(;i<c;i++){
			h++;
			if (a[j][i+1])continue;
			else{h++;j=j^1;}
		}
		if (j!=e)h++;
		printf("%d\n",h);
	}
	return 0;
}
