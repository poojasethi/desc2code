#include <cstdio>

#define N 200000

int a[N][2], b[N][2], c[N][2], n, m, i, j, x, y, z;
char s[2][N + 1];

int main()
{
    scanf("%d%d%s%s", &n, &m, s[0], s[1]);

    for (i = n - 1, x = n; i >= 0; i--)
    {
        if (s[0][i] == 'X')
            x = i;
        c[i][0] = x;
    }

    for (i = n - 1, x = n; i >= 0; i--)
    {
        if (s[1][i] == 'X')
            x = i;
        c[i][1] = x;
    }

    i = 0;

    while (i < n)
    {
        ++z;
        while (i < n && s[0][i] == 'X' && s[1][i] == 'X')
            ++i;

        if (i < n)
            x = s[0][i] == 'X';

        while (i < n)
        {
            for (; i < n && s[x][i] == '.'; i++)
                a[i][x] = ++y, b[i][x] = z;
            if (i < n && s[x ^ 1][i] == '.' && s[x ^ 1][i - 1] == '.')
                x ^= 1, --i;
            else
                break;
        }
    }

    while (m--)
    {
        scanf("%d%d", &x, &y);
        --x, --y;
        i = x % n, j = y % n;
        x /= n, y /= n;
        if (i > j || (i == j && a[i][x] > a[j][y]))
            z = i, i = j, j = z, z = x, x = y, y = z;
        if (x == y && c[i][x] == c[j][y])
            printf("%d\n", j - i);
        else
        {
            if (c[i][x] - 1 <= j)
                z = c[i][x] - i - 1, i = c[i][x] - 1;
            else
                z = j - i, i = j;
            if (!a[i][x])
                x ^= 1, ++z;
            if (!a[j][y])
                y ^= 1, ++z;
            if (a[j][y] > a[i][x])
                z += a[j][y] - a[i][x];
            else
                z += a[i][x] - a[j][y];
            printf("%d\n", b[j][y] == b[i][x] ? z : -1);
        }
    }

    return 0;
}
