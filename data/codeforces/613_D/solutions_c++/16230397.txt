#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <algorithm>
#include <ctime>
#include <cstring>
#include <string>
#include <cmath>
using namespace std;
const int N=1e5+10;
int first[N];
int sign[N];
const int inf=1e9;
struct edge{
	int to,next;
}e[N<<1];
int size,n,m;
void read(int &x){
	x=0;int f=1;char ch=getchar();
	while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}
	while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}
	x*=f;
}
void insert(int u,int v){size++;e[size].to=v;e[size].next=first[u];first[u]=size;}
void ins(int u,int v){insert(u,v);insert(v,u);}
int go[N][20],siz;
int dep[N],id[N],R[N];
int a[N],stk[N];
void dfs(int x,int fa){
	dep[x]=dep[fa]+1;go[x][0]=fa;id[x]=++siz;
	for(int i=first[x];i;i=e[i].next){
		int v=e[i].to;
		if(v!=fa){dfs(v,x);}
	}
	R[x]=siz;
}
bool cmp(int a,int b){
	return id[a]<id[b];
}
int jump(int x,int len){
	for(int i=16;i>=0;i--){
		if(len>=(1<<i))x=go[x][i],len-=(1<<i);
	}
	return x;
}
int lca(int x,int y){
	if(x==y)return x;
	if(dep[x]<dep[y])swap(x,y);
	x=jump(x,dep[x]-dep[y]);
	if(x==y)return x;
	for(int i=16;i>=0;i--){
		if(go[x][i]!=go[y][i])
			x=go[x][i],y=go[y][i];
	}
	return go[x][0];
}
int q;
int dp[N][2];
void f(int x,int fa){
	if(sign[x]!=q){
		int s=0;
		dp[x][0]=0;dp[x][1]=0;
		for(int i=first[x];i;i=e[i].next){
			int v=e[i].to;
			if(v==fa)continue;
			f(v,x);
			s+=min(dp[v][0],dp[v][1]);
			dp[x][1]=min(dp[x][1]+dp[v][0],dp[x][0]+dp[v][1]);
			dp[x][0]=dp[x][0]+dp[v][0];
			dp[x][1]=min(dp[x][1],inf);dp[x][0]=min(dp[x][0],inf);
		}
		dp[x][0]=min(dp[x][0],s+1);
	}
	else{
		dp[x][0]=inf;dp[x][1]=0;
		for(int i=first[x];i;i=e[i].next){
			int v=e[i].to;
			if(v==fa)continue;
			f(v,x);
			dp[x][1]=dp[x][1]+min(dp[v][0],dp[v][1]+1);
			dp[x][1]=min(dp[x][1],inf);dp[x][0]=min(dp[x][0],inf);
		}
	}
}
int main(){
	scanf("%d",&n);
	for(int i=1;i<n;i++){
		int u,v;read(u);read(v);
		ins(u,v);
	}
	dfs(1,0);
	for(int i=1;i<=16;i++)
		for(int j=1;j<=n;j++){
			go[j][i]=go[go[j][i-1]][i-1];
		}
	scanf("%d",&q);
	memset(sign,-1,sizeof(sign));
	while(q--){
		scanf("%d",&m);
		for(int i=1;i<=m;i++)read(a[i]),sign[a[i]]=q;

		sort(a+1,a+m+1,cmp);
		int mm=m;
		for(int i=1;i<mm;i++){
			a[++m]=lca(a[i],a[i+1]);
		}
		size=0;
		bool flag=0;
		sort(a+1,a+m+1,cmp);int top=1,cnt=1;stk[1]=a[1];
		first[a[1]]=0;
		for(int i=2;i<=m;i++){
			if(a[i]==a[i-1])continue;
			a[++cnt]=a[i];first[a[i]]=0;
			while(top&&id[a[i]]>R[stk[top]])top--;
			insert(stk[top],a[i]);
			if(sign[stk[top]]==q&&sign[a[i]]==q&&dep[stk[top]]+1==dep[a[i]])flag=1;
			stk[++top]=a[i];
		}
		if(flag){puts("-1");continue;}
		f(a[1],0);
		printf("%d\n",min(dp[a[1]][0],dp[a[1]][1])==99998?1:min(dp[a[1]][0],dp[a[1]][1]));
	}
	return 0;
}