#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
const int maxn=100000+10;
struct Edge{
    int next,v;
    Edge(){}
    Edge(int next,int v): next(next),v(v){}
}e[maxn<<1];
int n,k,head[maxn],cnt;
int dep[maxn],anc[maxn][20];
int dfn[maxn],last[maxn],timer;
int st[maxn],top,vir[maxn],sz;
bool imp[maxn],num[maxn];
inline int read()
{
    int x=0;
    char ch=getchar();
    while (ch<'0'||ch>'9')
        ch=getchar();
    while (ch>='0'&&ch<='9')
    {
        x=x*10+ch-'0';
        ch=getchar();
    }
    return x;
}
inline void AddEdge(int u,int v)
{
    e[++cnt]=Edge(head[u],v);
    head[u]=cnt;
}
void dfs(int u)
{
    dfn[u]=++timer;
    for (int i=head[u];i;i=e[i].next)
    {
        int v=e[i].v;
        if (v!=anc[u][0])
        {
            dep[v]=dep[u]+1;
            anc[v][0]=u;
            for (int j=0;anc[anc[v][j]][j];j++)
                anc[v][j+1]=anc[anc[v][j]][j];
            dfs(v);
        }
    }
    last[u]=timer;
}
inline int LCA(int u,int v)
{
    if (dep[u]<dep[v])
        swap(u,v);
    for (int i=18;i>=0;i--)
        if (dep[anc[u][i]]>=dep[v])
            u=anc[u][i];
    if (u==v)
        return u;
    for (int i=18;i>=0;i--)
        if (anc[u][i]!=anc[v][i])
            u=anc[u][i],v=anc[v][i];
    return anc[u][0];
}
int dp(int u)
{
    int tot=0,ans=0;
    for (int i=head[u];i;i=e[i].next)
    {
        int v=e[i].v;
        ans+=dp(v);
        tot+=num[v];
    }
    if (imp[u])
    {
        ans+=tot;
        num[u]=1;
    }
    else
    {
        ans+=(tot>1);
        num[u]=(tot==1);
    }
    return ans;
}
inline bool cmp(int a,int b)
{
    return dfn[a]<dfn[b];
}
int main()
{
    if (fopen("in.in","r")!=NULL)
    {
        freopen("in.in","r",stdin);
        freopen("out.out","w",stdout);
    }
    n=read();
    for (int i=1;i<n;i++)
    {
        int x=read(),y=read();
        AddEdge(x,y);
        AddEdge(y,x);
    }
    dfs(dep[1]=1);
    int T=read();
    while (T--)
    {
        k=read();
        sz=0;
        for (int i=1;i<=k;i++)
        {
            int x=read();
            vir[++sz]=x;
            imp[x]=1;
        }
        bool flag=0;
        for (int i=1;i<=sz;i++)
            if (anc[vir[i]][0]!=vir[i]&&imp[anc[vir[i]][0]])
            {
                flag=1;
                break;
            }
        if (flag)
        {
            puts("-1");
            for (int i=1;i<=sz;i++)
                imp[vir[i]]=0;
            continue;
        }
        sort(vir+1,vir+sz+1,cmp);
        for (int i=2;i<=k;i++)
            vir[++sz]=LCA(vir[i-1],vir[i]);
        sort(vir+1,vir+sz+1);
        sz=unique(vir+1,vir+sz+1)-vir-1;
        sort(vir+1,vir+sz+1,cmp);
        top=cnt=0;
        for (int i=1;i<=sz;i++)
        {
            int x=vir[i];
            head[x]=0;
            while (top&&!(dfn[st[top]]<=dfn[x]&&dfn[x]<=last[st[top]]))
                top--;
            if (top)
                AddEdge(st[top],x);
            st[++top]=x;
        }
        printf("%d\n",dp(vir[1]));
        for (int i=1;i<=sz;i++)
            imp[vir[i]]=0;
    }
    return 0;
}

  		  		      	  	   	    	 	 	