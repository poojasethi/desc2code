#define LLD "%I64d"

#include<iostream>
#include<algorithm>
#include<cstdio>
#include<cstdlib>
#include<cstring>

typedef long long ll;

const int fin=0,maxn=1002,maxk=125;
const int MC=12345;
ll N;
int M,m;
bool vis[27],fun[27],g[27];
int T[maxn],c[maxn],d[maxn];

struct pt{
  int x,y;
  pt(){}
  pt(const int &x,const int &y):x(x),y(y){}
}a[maxn],b[maxn];

struct mat{
  int n,m,a[maxk][maxk];
  mat(){memset(a,0,sizeof(a));}
  mat(const int &n,const int &m):n(n),m(m){memset(a,0,sizeof(a));}
  int& operator()(const int &x,const int &y){return a[x][y];}
}A,D;
mat operator *(mat a,mat b){
  mat c(a.n,b.m);
  for(int i=0;i<a.n;++i)
    for(int j=0;j<b.m;++j)
      for(int k=0;k<a.m;++k)
        c(i,j)=(c(i,j)+a(i,k)*b(k,j))%MC;
  return c;
}
mat pow(mat a,ll n){
  mat b(a.n,a.n);
  for(int i=0;i<a.n;++i)b(i,i)=1;
  while(n){
    if(n&1)b=b*a;
    a=a*a;
    n>>=1;
  }
  return b;
}

int main(){
  if(fin){
    freopen("t.in","r",stdin);
    freopen("t.out","w",stdout);
  }
  char ch;
  int x,y,t,s,i,j,k;
  scanf(LLD" %d\n",&N,&M);
  while(M--){
    scanf("%c %d\n",&ch,&y),x=ch-'A';
    if(y==1)fun[x]=1;
    else b[m++]=pt(x,y);
    vis[x]=1;
  }
  for(M=m,m=i=0;i<M;++i)
    if(!fun[b[i].x])a[m++]=b[i];
  for(T[m]=1,i=m-1;i>=0;--i)
    T[i]=T[i+1]*a[i].y;
  D.n=D.m=T[0];
  for(i=0;i<T[0];++i){
    for(t=i,j=0;j<m;++j)
      c[j]=t/T[j+1],t%=T[j+1];
    for(j=0;j<26;++j)
      if(vis[j]){
        for(s=k=0;k<m;++k)
          s+=(c[k]+(a[k].x==j))%a[k].y*T[k+1];
        D(i,s)=(D(i,s)+1)%MC;
        //printf("%d %d\n",i,s);
      }
  }
  A.n=1,A.m=T[0];
  A(0,0)=1;
  D=pow(D,N);
  A=A*D;
  for(s=0,i=0;i<T[0];++i){
    memset(g,0,sizeof(g));
    for(t=i,j=0;j<m;++j){
      if(t/T[j+1]==0)g[a[j].x]=1;
      t%=T[j+1];
    }
    for(j=0;j<26;++j)
      if(vis[j]&&!fun[j])
        if(!g[j])break;
    if(j==26){
      s=(s+A(0,i))%MC;
      //printf("%d\n",i);
    }
  }
  printf("%d",s);  
  return 0;
}
