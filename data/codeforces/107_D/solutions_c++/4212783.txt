#include<cstdio>
#include<cstring>
#include<algorithm>
#define lim 12345
using namespace std;
typedef int matrix[140][140];
int num[30][30];
int legal[140];
int base[30];
int mod[30];
int cnt[30];
long long c;
int n,m;
matrix a,b;
void mul(matrix a,matrix b)
{	int i,j,k;
	matrix c;
	for (i=0;i<n;++i)
		for (j=0;j<n;++j)
			c[i][j]=0;
	for (i=0;i<n;++i)
		for (j=0;j<n;++j)
			for (k=0;k<n;++k)
				c[i][j]=(c[i][j]+a[i][k]*b[k][j])%lim;
	for (i=0;i<n;++i)
		for (j=0;j<n;++j)
			a[i][j]=c[i][j];
}
int gcd(int x,int y)
{	if (y==0)
		return x;
	return gcd(y,x%y);
}
int work()
{	int i,j,k,res,zt,ans=0;
	base[0]=1;
	for (i=0;i<26;++i)
		base[i+1]=base[i]*mod[i];
	n=base[26];
	for (i=0;i<n;++i)
	{	legal[i]=1;
		for (j=0;j<26;++j)
			if (cnt[j])
			{	res=0;
				zt=i+base[j];
				if ((i/base[j]+1)%mod[j]==0)
					zt-=base[j+1];
				b[i][zt]++;
				for (k=1;k<=cnt[j];++k)
					if ((i/base[j])%num[j][k]==0)
						res=1;
				legal[i]&=res;
			}
	}
	a[0][0]=1;
	for (;c;c>>=1)
	{	if (c&1)
			mul(a,b);
		mul(b,b);
	}
	for (i=0;i<n;++i)
		if (legal[i])
			ans=(ans+a[0][i])%lim;
	return ans;
}
int main()
{	int i,p,x;
	char type[4];
	scanf("%I64d%d",&c,&m);
	for (i=0;i<26;++i)
		mod[i]=1;
	for (i=1;i<=m;++i)
	{	scanf("%s",type);
		p=type[0]-'A';
		scanf("%d",&x);
		mod[p]*=x/gcd(x,mod[p]);
		cnt[p]++;
		num[p][cnt[p]]=x;
	}
	printf("%d\n",work());
}

	  	 			 	 		 			  		 			