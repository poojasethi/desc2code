r=lambda:map(int,raw_input().split())
n,m=r()
k=int(input())
a=[]
a=[r()for i in range(k)]
p=int(input())
if n<m:
    n,m=m,n
    for i in a:
        i[0],i[1]=i[1],i[0]
c=[0]*n
w=[1]*n
for i in a:
    c[i[0]-1]+=1
    w[i[0]-1]*=i[2]
z=(n-1)*(m-1)-k
for i in range(n):
    if (c[i]==m) and (w[i]==1):
        print 0;
        exit(0)
    if (c[i]==m):
        z+=1
print [pow(2,z,p),0][(n+m)&1]
