n,m=map(int,raw_input().split())
if n%2!=m%2:
  print 0
  exit(0)

k=input()
f=[[0]*m for _ in xrange(n)]
for _ in xrange(k):
  x,y,z=map(int,raw_input().split())
  f[x-1][y-1]=z

v=[1]*m
h=[1]*n
for i in xrange(n):
  for j in xrange(m):
    h[i]*=f[i][j]
    v[j]*=f[i][j]
r=map(lambda x:x!=1, v+h)
c=map(lambda x:x==-1, v+h)

if not all(r):
  print 0
  exit(0)

l=input()
s=max(0,(n-1)*(m-1)-(k-c.count(True)))
r=1
for _ in xrange(s):
  r*=2;
  d,r=divmod(r,l)
print r