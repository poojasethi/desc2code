#include <iostream>
#include <algorithm>
using namespace std;

#define MaxN 1005

int n, m, p, k, a[MaxN][MaxN];

int main(){
	ios::sync_with_stdio(false);
	cin >>n >>m >>k;
	int fr = 0;
	if (((n+m) % 2) == 1){
		cout <<0 <<endl;
		return 0;
	}
	for (int i = 0; i < k; i++){
		int x, y, c;
		cin >>x >>y >>c;
		a[x][y] = c;
	}
	cin >>p;
	for (int i = 1; i <= n; i++){
		bool f = 0;
		int h = 1;
		for (int j = 1; j <= m; j++)
			h *= a[i][j];
		if (h == 1){
			cout <<0 <<endl;
			return 0;
		}
		else if (h == -1)
			fr++;
	}
	for (int i=1; i<=m; i++){
		bool f = 0;
		int h = 1;
		for (int j=1; j<=n; j++)
			h *= a[j][i];
		if (h == 1){
			cout <<0 <<endl;
			return 0;
		}
		else if (h == -1)
			fr++;
	}
	int r = 1;
	for (int i = 0; i < (((m-1) * (n-1) )% p) - k + fr; i++){
		r *= 2;
		r %= p;
	}
	cout <<r <<endl;
	return 0;
}
