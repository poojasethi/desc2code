#include<cstdio>
#include<cstring>
using namespace std;
int n,m,k,p,v1[1010],ans,v2[1010],gs1[1010],gs2[1010],i,x,y,z,s;
int main()
{
    scanf("%d%d%d",&n,&m,&k);p=n+m+k-1;
    if((n&1)!=(m&1)){printf("0\n");return 0;}
    memset(v1,-1,sizeof(v2));memset(v2,-1,sizeof(v2));
    for(i=1;i<=k;i++)
    {
        scanf("%d%d%d",&x,&y,&z);
        gs1[x]++;gs2[y]++;v1[x]*=z;v2[y]*=z;
        if(gs1[x]==m){if(v1[x]>0)p--;else{printf("0\n");return 0;}}
        if(gs2[y]==n){if(v2[y]>0)p--;else{printf("0\n");return 0;}}
    }scanf("%d",&s);ans=1;
    for(i=1;i<=n*m-p;i++)ans=ans*2%s;printf("%d\n",ans);
}