#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
using namespace std;
int n, m, k, p, i, j, a, b, c, g, h[1010], t[1010], ans;
int main()
{
	scanf("%d%d%d", &n, &m, &k);
	if (n < m) swap(n, m), p = 1;
	for (i = 1; i <= n; t[i] = 1, i++); 
	for (i = 1; i <= k; i++)
	{
		scanf("%d%d%d", &a, &b, &c);
		if (p) swap(a, b);
		h[a]++, t[a] *= c;
	}    
	scanf("%d", &p);
	if ((n + m) % 2) ans = 0; else ans = 1;
	for (i = 1; i <= n; i++)
		if (!h[i] && !g) {g++; continue;}
	    else if (h[i] == m && t[i] > 0) ans = 0;
	    else for (j = 1; j < m - h[i]; j++) ans = (ans * 2) % p;
	printf("%d\n", ans);
	return 0;
}