#include <cstdio>
using namespace std;
#define mx 1020
int m,n,j,k,l,i,o,p,q,r,z;
int x[mx],y[mx],tx[mx],ty[mx];

int main(){
	scanf("%d%d%d",&m,&n,&o);
	for (int i = 1;i <= o;i ++){
		scanf("%d%d%d",&j,&k,&l);
		x[j] ++; y[k] ++;
		if (tx[j] == 0) tx[j] = l; else tx[j] *= l;
		if (ty[k] == 0) ty[k] = l; else ty[k] *= l;
		if (x[j] == n)
			q |= tx[j] == 1,z ++;
		if (y[k] == m)
			q |= ty[k] == 1,z ++;
	}
	scanf("%d",&r);
	int p = 1;
	q |= (m ^ n) & 1;
	if (q) printf("0\n"); else{
		for (int i = 1;i <= (m - 1) * (n - 1) - o + z;i ++)
			p = p * 2 % r;
		printf("%d\n",p);
	}
}
