#include<cstring>
#include<cstdio>
using namespace std;
int n,m,k,a[1200],b[1200],c[1200],d[1200],ans,i,x,y,p,q;
int main(){
	scanf("%d%d%d",&n,&m,&k);
	if((n+m)&1)return puts("0"),0;
	ans=(n-1)*(m-1)-k;
	for(i=1;i<=n || i<=m;++i)c[i]=d[i]=1;
	for(i=1;i<=k;++i)scanf("%d%d%d",&x,&y,&p),a[x]++,b[y]++,c[x]*=p,d[y]*=p;
	for(i=1;i<=n;++i)if(a[i]==m)
		if(c[i]==1)return puts("0"),0;
		else ans++;
	for(i=1;i<=m;++i)if(b[i]==n)
		if(d[i]==1)return puts("0"),0;
		else ans++;
	scanf("%d",&p);
	q=1;
	for(i=1;i<=ans;++i)q=(q*2)%p;
	printf("%d\n",q);
}
