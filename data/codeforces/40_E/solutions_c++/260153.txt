#include <iostream>
#include <cstdio>
#include <cstdlib>
using namespace std;

typedef long long ll;

const int MAXN = 1000 + 10;
int d[MAXN][MAXN];

int main()
{
	int n, m, k, t=0;
	ll mod;
	cin >> n >> m >> k;
	if(m%2 != n%2)
	{
		cout << 0 << endl;
		exit(0);
	}
	for(int l=0; l<k; l++)
	{
		int i, j;
		cin >> i >> j;
		i--;j--;
		cin >> d[n < m ? i : j][n < m ? j : i];
	}
	cin >> mod;
	if(n > m)
		swap(n, m);
	for(int i=0; i<m; i++)
	{
		int all = 1;
		for(int j=0; j<n; j++)
			all *= (d[j][i]);
		if(all == 1)
		{
			cout << 0 << endl;
			exit(0);
		}
		else if(all == -1)
			t++;
	}
	ll ans = 1;
	ll tr = (n-1)*(m-1)-k+t;
	for(int i=0; i<tr; i++)
		(ans *= 2) %= mod;
	cout << ans << endl;
	return 0;
}
