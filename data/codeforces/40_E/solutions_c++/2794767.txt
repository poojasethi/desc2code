#include <cstdio>
#include <iostream>
int row[10000],col[10000],hr[10000],hc[10000];
int main()
{
	//freopen("input.txt","r",stdin);
	//freopen("output.txt","w",stdout);
	long long int mod,ans; int n,m,i,k,free,x,y,val;
	scanf("%d%d",&n,&m);
	if(n%2 != m%2) {printf("0\n");return 0;}
	scanf("%d",&k); 
	for(i=1;i<=n;i++) row[i] = 1; 
	for(i=1;i<=m;i++) col[i] = 1;
	for(i=1;i<=k;i++)
	{
		scanf("%d%d%d",&x,&y,&val);
		row[x] *= val; col[y] *= val;
		hr[x]++; hc[y]++;	
	}
	std::cin>>mod;
	free = n*m-k-n-m+1;
	for(i=1;i<=n;i++) 
	{
		if(hr[i] == m && row[i] != -1) {printf("0\n");return 0;}
		else if(hr[i] == m) free++;
	}
	for(i=1;i<=m;i++) 
	{
		if(hc[i] == n && col[i] != -1) {printf("0\n");return 0;}
		else if(hc[i] == n) free++;
	}
	for(i=ans=1;i<=free;i++)
		ans = (ans*2)%mod;
	std::cout<<ans;
}