#include<cstdio>
#define N 1005
int n,m,k,x,y,z,oo,cnt,ans=1,c[N],d[N],e[N],f[N],p[N];
int work()
{
	scanf("%d%d%d",&n,&m,&k); if ((n+m)&1) return 0;
	for (int i=1;i<=n || i<=m;i++) e[i]=f[i]=1;
	for (int i=1;i<=k;i++) scanf("%d%d%d",&x,&y,&z),c[x]++,d[y]++,e[x]*=z,f[y]*=z;
	scanf("%d",&oo),cnt=n*m-k-n-m+1;
	for (int i=1;i<=n;i++) if (c[i]==m) if (e[i]==1) return 0; else cnt++;
	for (int j=1;j<=m;j++) if (d[j]==n) if (f[j]==1) return 0; else cnt++;
	for (int i=1;i<=cnt;i++) ans=ans*2%oo; return ans;
}
int main(){printf("%d\n",work()); return 0;}
