#include <cstdio>
#include <algorithm>
using namespace std;
const int maxn = 1010;
int n, m, k, p;
int r[maxn], c[maxn];
int rp[maxn], cp[maxn];
int main() {
	//freopen("x.in", "r", stdin);
	scanf("%d%d%d", &n, &m, &k);
	if ((~ n & 1) ^ (~ m & 1)) {
		puts("0");
		exit(0);
	}
	for (int i = 0; i < k; ++i) {
		int x, y, z;
		scanf("%d%d%d", &x, &y, &z);
		++r[x];
		++c[y];
		if (z == -1) {
			rp[x] ^= 1;
			cp[y] ^= 1;
		}
	}
	scanf("%d", &p);
	int v = (n - 1) * (m - 1) - k;
	for (int i = 1; i <= n; ++i)
		if (r[i] == m) {
			++v;
			if (!rp[i]) {
				puts("0");
				exit(0);
			}
		}
	for (int i = 1; i <= m; ++i)
		if (c[i] == n) {
			++v;
			if (!cp[i]) {
				puts("0");
				exit(0);
			}
		}
	int ans = 1;
	for (int i = 0; i < v; ++i)
		ans = ans * 2 % p;
	printf("%d\n", ans);
}
