#include <bits/stdc++.h>
using namespace std;

const int MAXN = 1005;
int res[MAXN], nowp[MAXN];

int main() {

    int n, m, k, p, d, ans;
    bool revf = false, skipf = true;

    // freopen("D:\\1.in", "r", stdin);
    // freopen("D:\\1.out", "w", stdout);

    scanf("%d%d%d", &n, &m, &k);
    if(n < m) swap(n, m), revf = true;
    for(int i = 1; i <= n; i ++) res[i] = m, nowp[i] = 1;

    while(k --)
    {
        int a, b, c;
        scanf("%d%d%d", &a, &b, &c);
        if(revf) res[b] --, nowp[b] *= c;
        else res[a] --, nowp[a] *= c;
    }
    scanf("%d", &p);

    ans = 1;
    for(int i = 1; i <= n; i ++)
    {
        if(res[i] == m && skipf) { skipf = false; continue; }
        if(res[i] == 0 && nowp[i] == 1){ ans = 0; break; }
        for(int j = 0; j < res[i] - 1; j ++) ans = ans * 2 % p;
    }

    if((n + m) % 2 == 1) ans = 0;

    printf("%d\n", ans);

	return 0;
}
