#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cstring>
#include<cmath>
using namespace std;
int main()
{
int n,m,k,p;
int i,j;
int a,b,c;
long long sum=1;
int l[1005]={0},z[1005];
for(i=0;i<1005;i++)
    z[i]=1;
scanf("%d%d%d",&n,&m,&k);
if(n>=m)
{
    for(i=1;i<=n;i++)
        l[i]=m;
    for(i=0;i<k;i++)
    {
        scanf("%d%d%d",&a,&b,&c);
    l[a]--;z[a]*=c;
    }


}
else
{
    swap(n,m);
     for(i=1;i<=n;i++)
        l[i]=m;
    for(i=0;i<k;i++)
    {
        scanf("%d%d%d",&a,&b,&c);
    l[b]--;z[b]*=c;
    }

}
scanf("%d",&p);
if((n+m)%2==1)
    {printf("0\n");return 0;}
int flag=1;
for(i=1;i<=n;i++)
{
    if(flag&&l[i]==m)
    {
        flag=0;
        continue;
    }
    long long q=1;
    if(l[i]==0&&z[i]==1)
    sum=0;
        else
    for(j=0;j<l[i]-1;j++)
    {sum*=2;sum%=p;}

}
printf("%lld\n",sum);





}

	  	  	    	  										 	    	