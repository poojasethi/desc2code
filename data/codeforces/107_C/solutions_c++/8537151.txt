#include <bits/stdc++.h>

#define ll long long
#define ld long double
#define pii pair<int,int>
#define pll pair<ll,ll>
#define pdd pair<ld,ld>
#define ff first
#define ss second
#define pb push_back
#define mp make_pair
#define MAXINT ((~0) ^ (1 << 31))
#define MAXLL ((~0) ^ ((ll)1 << 63))
#define INF ((int)2e9)
#define INFL ((ll)9e18)
#define FOR(i,j,k) for(int i = j; i < k; i++)
#define REP(i,j,k) for(int i = j; i >= k; i--)
#define setmax(i) const int maxn = (int) i;
#define setmod(i) const int MOD = (int) i;
#define all(a) a.begin(),a.end()
#define int long long

//srand (time(NULL));

using namespace std;

ll n,y,m;
ll s[(1<<16)], dp[(1<<16)], ans[20];

main()
{
    ios_base::sync_with_stdio(0);cin.tie(0);
    
    cin >> n >> y >> m;
    y -= 2000;
    FOR(i,0,m)
    {
	ll a,b;
	cin >> a >> b;
	s[b-1] |= (1<<a-1);
    }

    FOR(i,0,20) ans[i] = -1;

    FOR(i,0,n)
    {
	for( ans[i]=0; ans[i] < n; ans[i]++)
	{
	    FOR(j,0,(1<<n)) dp[j] = 0;
	    dp[0] = 1;
	    FOR(j,0,(1<<n)) 
	    {
		int t = __builtin_popcount(j);
		FOR(k,0,n) if(!(j&(1<<k)))
		{
		    if((ans[k] == -1 || ans[k] == t) && (j&s[k]) == s[k])
		    {
			dp[j | (1<<k)] += dp[j];
		    }
		}
	    }
	    //cout << y << " " << dp[(1<<n)-1] << endl;
	    if(y <= dp[(1<<n)-1])
	    {
		break;
	        //cout << "The times have changed";
	        //return 0;
	    }
	    y -= dp[(1<<n)-1];
	}
	if(ans[i] >= n)
	{
	    cout << "The times have changed";
	    return 0;
	}
    }
    FOR(i,0,n) cout << ans[i] + 1 << " ";
}
