#include<cstdio>
#include<iostream>
#include<cstring>
#include<cmath>
#include<queue>
#include<vector>
#define rep(i,l,r) for(int i=l;i<=r;i++)
#define per(i,r,l) for(int i=r;i>=l;i--)
#define mmt(a,v) memset(a,v,sizeof(a))
#define tra(i,u) for(int i=head[u];i;i=e[i].next)
using namespace std;
typedef long long ll;
const int N=100000+5;
typedef long long ll;
ll f[N];
int st[N],tp,a[N];
int main(){
	//freopen("a.in","r",stdin);
	int n;scanf("%d",&n);
	rep(i,1,n)scanf("%d",&a[i]);
	st[++tp]=-n;
	ll ans=0;
	per(i,n-1,1){
		int k=lower_bound(st+1,st+1+tp,-a[i])-st;
		k=-st[k];
		f[i]=f[k]+(n-i)-(a[i]-k);
		ans+=f[i];
		while(tp&&a[-st[tp]]<=a[i])tp--;
		st[++tp]=-i;
	}
	printf("%I64d\n",ans);
	return 0;
}
	
