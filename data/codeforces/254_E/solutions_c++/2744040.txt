#include <cstdio>
#include <cstring>
#include <vector>
#include <map>
#include <set>
#include <iostream>
#include <algorithm>

#define mp make_pair
#define pb push_back
#define SIZE(A) ((int)A.size())
#define fi first
#define se second
using namespace std;

typedef pair<int,int> ii;

typedef set<ii>::iterator sit;

const int MAXN = 410;

vector<ii> in[MAXN],out[MAXN],ar[MAXN];

int N,M,V,A[MAXN];

int dn[MAXN][MAXN];
ii dad[MAXN][MAXN];

int f(int pr,int k){
	//printf("%d %d\n",pr,k);
	if(k==N+1)	return 0;
	int &rev=dn[pr][k];
	ii &next=dad[pr][k];
	int tot=pr+A[k];
	if(rev!=-1)	return rev;
	tot-=V;
	rev=f(min(tot,A[k]),k+1);
	next=ii(min(tot,A[k]),-1);
	for(int i=0,tmp;i<SIZE(ar[k]) && tot>=ar[k][i].fi;i++)
	{
		//printf("%d %d -> %d -> %d %d\n",pr,k,ar[k][i].se,min(A[k],tot-ar[k][i].fi),k+1);
		tmp=f(min(A[k],tot-ar[k][i].fi),k+1)+i+1;
		if(tmp>rev)
			rev=tmp,next=ii(min(A[k],tot-ar[k][i].fi),i);
		tot-=ar[k][i].fi;
	}
	//printf("%d %d -> %d %d\n",pr,k,rev,next);
	return rev;
}

int main(){
	
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);

	scanf(" %d %d",&N,&V);
	
	for(int i=1;i<=N;i++)
		scanf(" %d",A+i);

	
	scanf(" %d",&M);
	
	for(int i=1,l,r,g;i<=M;i++)
	{
		scanf("%d %d %d",&l,&r,&g);
		for(int j=l;j<=r;j++)
			ar[j].pb(ii(g,i));
		in[l].pb(ii(g,i));
		out[r].pb(ii(g,i));
	}
	
	for(int i=1;i<=N;i++)
		sort(ar[i].begin(),ar[i].end());
	
	memset(dn, -1, sizeof dn);
	
	cout << f(0,1) << endl;
	
	for(int i=1,j=0,tot,say;i<=N;i++){
		say=0;
		tot=j+A[i]-V;
		//printf("(%d %d)\n",tot,dad[j][i].fi);
		printf("%d",dad[j][i].se+1);
		for(int k=0;k<=dad[j][i].se;k++)
			printf(" %d",ar[i][k].se);
		puts("");
		j=dad[j][i].fi;
	}
	
	return 0;
	
}
