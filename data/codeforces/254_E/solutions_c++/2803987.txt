#include <cstdio>
#include <iostream>
#include <vector>
#include <cstring>
#include <algorithm>

#define fi first
#define se second

using namespace std;

typedef pair<int,int> ii;

const int MAXN = 510;
const int inf = 1e9;

vector<ii> v[MAXN];
int N,V;
int M,ar[MAXN];
int dn[MAXN][MAXN*2];
int solve[MAXN][MAXN*2];
int go[MAXN][MAXN*2];

int f(int x,int k){
	
	if(dn[x][k]!=-1) return dn[x][k];
	if(x==N+1) return 0;      
	
	int ans=f( x+1 , min(ar[x]+k-V,ar[x]) );
	go[x][k]=min(ar[x]+k-V,ar[x]);
	solve[x][k]=0;
	int sum = ar[x]+k-V;
	
	for(int i=0;i<v[x].size();i++){
	
		sum-=v[x][i].fi;	
		
		if(sum<0) break;
		
		if( ans < f( x+1,min(sum,ar[x]) ) + i+1 ){
		
			ans = f( x+1,min(sum,ar[x]) ) + i+1;
			go[x][k] = min(sum,ar[x]);
			solve[x][k]=i+1;
		
		}
			
	
	}
	
	//~ printf("x=%d k=%d food:%d ans=%d sol:%d\n",x,k,food,ans);
	
	return dn[x][k]=ans;

}

int main(){
	
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
	
	cin>>N>>V;
	
	for(int i=1;i<=N;i++)
		scanf(" %d",ar+i);
		
	cin>>M;
	
	for(int k=1;k<=M;k++){
	
		int a,b,c;scanf(" %d %d %d",&a,&b,&c);
		
		for(int i=a;i<=b;i++)
			v[i].push_back(ii(c,k));
	
	}	
	
	for(int i=1;i<=N;i++)	
		sort(v[i].begin(),v[i].end());
	
	memset(dn,-1,sizeof dn);
	
	cout << f(1,0) << endl;
	
	for(int i=1,x=0;i<=N;x=go[i][x],i++){
	
		printf("%d ",solve[i][x]);
		
		for(int j=0;j<solve[i][x];j++)
			printf("%d ",v[i][j].se);
		puts("");
	}
	
	return 0;
}
