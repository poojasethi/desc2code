#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<cstring>
#include<cmath>
#include<ctime>
#include<map>
#include<string>
#include<vector>
#include<set>

using namespace std;
#define For(i,l,r) for (int i = l; i <= r; ++i)
#define Cor(i,l,r) for (int i = l; i >= r; --i)
#define Fill(a,b) memset(a,b,sizeof(a))
#define FI first
#define SE second
#define MP make_pair
#define PII pair<int,int>
#define flt double
#define INF (0x3f3f3f3f)
#define MaxN 1020304
#define MaxNode 1020304
#define MD 1000000007
#define update(I,J,b,c,d) { if (f[I][J] < (b)) { f[I][J] = (b); op[I][J] = MP(c,d); } }

int n,v,m,sum[500][500],f[500][500],a[500]; PII A[500][500],op[500][500];
void print(int d,int rem) {
	if (d > 1) print(d - 1,op[d][rem].FI);
	printf("%d",op[d][rem].SE);
	For(i,1,op[d][rem].SE) printf(" %d",A[d][i].SE); cout << endl;
}
	
int main() {
	freopen("input.txt","r",stdin); freopen("output.txt","w",stdout);
	cin >> n >> v;
	For(i,1,n) scanf("%d",&a[i]);
	cin >> m; Fill(A,0);
	For(i,1,m) {
			int l,r,f;
		scanf("%d%d%d",&l,&r,&f);
		For(j,l,r) A[j][++A[j][0].FI] = MP(f,i);
	}
	For(i,1,n) sort(A[i] + 1,A[i] + A[i][0].FI + 1);
	Fill(sum,0); For(i,1,n) For(j,1,A[i][0].FI) sum[i][j] = sum[i][j - 1] + A[i][j].FI; 
	Fill(f,-INF); f[0][0] = 0;
	For(i,0,n - 1) For(j,0,a[i]) if (f[i][j] > -1) {
		For(k,0,A[i + 1][0].FI) {
			if (j - sum[i + 1][k] + a[i + 1] < v) break ;
			update(i + 1,min(a[i + 1],j - sum[i + 1][k] + a[i + 1] - v),f[i][j] + k,j,k);
		}
	}
	int ans = -1, p;
	For(i,0,a[n]) if (ans < f[n][i]) { ans = f[n][i]; p = i; }
	cout << ans << endl;
	print(n,p);
	return 0;
}

