#include <bits/stdc++.h>
#define heap priority_queue
#define pb push_back
#define popb pop_back
#define fr first 
#define mp make_pair
#define sc second
#define inf 1000000007
#define bigmod 1000000007
using namespace std;
typedef pair<int,int> ii;
typedef pair<pair<int,int>,int> iii;
typedef long long int ll;
int A[405];
int D[405][405][2];
int M[405][405];
vector<ii> V[405];
vector<int> C[405];
int n,v,m;
int DoIt(int s,int x,int flag)
{
	if(s==n+1)
		return 0;
	if(D[s][x][flag]!=-1)
		return D[s][x][flag];
	int a=-1,k;	
	for (int i = 0; i <=(int)V[s].size() ; i++)
	{
		if(M[s][i]+v>A[s]+x)
			break;
		int artan,q=M[s][i]+v-x;
		if(q<0)
			q=0;
		artan=A[s]-q;
		if(DoIt(s+1,artan,0)+i>a)
		{
			a=DoIt(s+1,artan,0)+i;
			k=i;
		}	
	}		
	if(flag==1)
	{
		for (int i = 0; i <k ; i++)
			C[s].pb(V[s][i].sc);
		int artan,q=M[s][k]+v-x;
		if(q<0)
			q=0;
		artan=A[s]-q;
		DoIt(s+1,artan,1);	
	}
	return D[s][x][flag]=a;
}
int main()
{
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
	memset(D,-1,sizeof D);
	scanf("%d %d",&n,&v);
	for (int i = 1; i <=n ; i++)
		scanf("%d",&A[i]);
	scanf("%d",&m);	
	for (int i = 1; i <=m ; i++)	
	{
		int x,y,s;
		scanf("%d %d %d",&x,&y,&s);
		for (int j = x; j <=y ; j++)
			V[j].pb(ii(s,i));
	}
	for (int i = 1; i <=n ; i++)
		sort(V[i].begin(),V[i].end());
	for (int i = 1; i <=n ; i++)
		for (int j = 0; j <(int)V[i].size() ; j++)
			M[i][j+1]=M[i][j]+V[i][j].fr;				
	printf("%d\n",DoIt(1,0,1));
	for (int i = 1; i <=n ; i++)
	{
		printf("%d ",(int)C[i].size());
		for (int j = 0; j <(int)C[i].size() ; j++)
			printf("%d ",C[i][j]);
		printf("\n");
	}
}
