//By momo
#include <cstdio>
#include <vector>
#include <cstring>
#include <algorithm>
#define N 403
#define F first
#define S second
#define MP make_pair
#define PB push_back
#define FOR(it, c) for(__typeof((c).begin())it=(c).begin();it!=(c).end();it++)
using namespace std;
typedef pair<int, int> PII;

vector<PII> day[N]; vector<int> pnt[N];
int a[N], dp[N][N], cnt[N][N], prv[N][N];

void upd (int i, int x, int j, int c){
	if(dp[i][x] < dp[i-1][j] + c){
		dp[i][x] = dp[i-1][j] + c;
		cnt[i][x] = c;
		prv[i][x] = j;
	}
}
int main (){
	freopen("input.txt", "r", stdin);
	freopen("output.txt", "w", stdout);
	int n, m, v;
	scanf("%d%d", &n, &v);
	for(int i = 1; i <= n; i++)
		scanf("%d", &a[i]);
	scanf("%d", &m);
	for(int i = 0; i < m; i++){
		int l, r, f;
		scanf("%d%d%d", &l, &r, &f);
		for(int j = l; j <= r; j++)
			day[j].PB(MP(f, i));
	}
	for(int i = 1; i <= n; i++)
		sort(day[i].begin(), day[i].end());
	memset(dp, -1, sizeof(dp));
	dp[0][0] = 0;
	for(int i = 1; i <= n; i++){
		for(int j = 0; j <= 400; j++){
			if(dp[i-1][j] == -1 || j+a[i] < v)
				continue;
			int fd = j + a[i] - v, c = 0;
			int x = min(fd, a[i]);
			upd(i, x, j, c);
			FOR(it, day[i]){
				if(it->F <= fd){
					c++; fd -= it->F;
					x = min(fd, a[i]);
					upd(i, x, j, c);
				}
				else break;
			}
		}
	}
	int ans = 0;
	for(int i = 0; i <= 400; i++)
		if(dp[n][ans] < dp[n][i]) ans = i;
	printf("%d\n", dp[n][ans]);
	for(int i = n, j = ans; i >= 1; i--){
		pnt[i].PB(cnt[i][j]);
		for(int k = 0; k < cnt[i][j]; k++)
			pnt[i].PB(day[i][k].S+1);
		j = prv[i][j];
	}
	for(int i = 1; i <= n; i++)
		FOR(it, pnt[i]) printf("%d%c", *it, it==pnt[i].end()-1?'\n':' ');
}
