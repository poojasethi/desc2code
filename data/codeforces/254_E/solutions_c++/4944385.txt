#include <algorithm>
#include <stdio.h>
#include <vector>
#define  fi        first
#define  se        second
#define  maxn      405
#define  pb        push_back
using    namespace std;
typedef  pair<int,int> pi;

int n,m,k;
int a[maxn];
int dp[maxn][maxn];
int ans[maxn][maxn];
bool mark[maxn][maxn];
vector<pi>v[maxn];

int f(int day , int food)
{
  if(food+a[day]<k)       return 0;
  if(mark[day][food])     return dp[day][food];
  mark[day][food]=true;
  if(food>=k)             dp[day][food]=f(day+1,a[day]);
  else                    dp[day][food]=f(day+1,a[day]+food-k);
  int sum=0,sz=v[day].size();
  for(int i=0,tmp ; i<sz ; i++)
  {
    sum+=v[day][i].fi;
    if(sum+k>food+a[day]) break;
    if(food>=sum+k)       tmp=f(day+1,a[day])+i+1;
    else                  tmp=f(day+1,food+a[day]-k-sum)+i+1;
    if(tmp>dp[day][food])
    {
      ans[day][food]=i+1;
      dp[day][food]=tmp;
    }
  }
  return dp[day][food];
}

int main()
{
  freopen("input.txt","r",stdin);
  freopen("output.txt","w",stdout);
  scanf("%d%d",&n,&k);
  for(int i=1 ; i<=n ; i++)
    scanf("%d",&a[i]);
  scanf("%d",&m);
  for(int i=1,x,y,z ; i<=m ; i++)
  {
    scanf("%d%d%d",&x,&y,&z);
    for(int j=x ; j<=y ; j++)
      v[j].pb(pi(z,i));
  }
  for(int i=1 ; i<=n ; i++)
    sort(v[i].begin(),v[i].end());
  printf("%d\n",f(1,0));
  int curr=0;
  for(int i=1 ; i<=n ; i++)
  {
    int sum=0;
    printf("%d ",ans[i][curr]);
    for(int j=0 ; j<ans[i][curr] ; j++)
    {
      printf("%d ",v[i][j].se);
      sum+=v[i][j].fi;
    }
    printf("\n");
    if(curr>=sum+k) curr=a[i];
    else            curr=curr+a[i]-sum-k;
  }
  return 0;
}
