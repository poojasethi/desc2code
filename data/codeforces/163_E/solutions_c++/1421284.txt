#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

int n,K;
const int N = 1000005;
const int CH = 26;
int chd[N][CH],sz,word[N],fail[N],q[N],sw[300],idx[N],val[N];
int in[N];

void Ins(char *a, int id)
{
    int p = 0;
    for(;*a;a++)
    {
        int c = sw[*a];
        if(!chd[p][c])
        {
            memset(chd[sz],0,sizeof(chd[sz]));
            word[sz] = 0;
            chd[p][c] = sz++;
        }
        p = chd[p][c];
    }
    idx[id] = p;
    word[p]++;
    val[p] = 1;
}

void AC()
{
    int f = 0, r = 0;
    for(int i = 0; i < CH; i++)
        if(chd[0][i])
        {
            fail[chd[0][i]] = 0;
            q[r++] = chd[0][i];
        }
    while(f != r)
    {
        int p = q[f++];
        for(int i = 0; i < CH; i++)
        {
            if(chd[p][i])
            {
                int v = chd[p][i];
                q[r++] = v;
                fail[v] = chd[fail[p]][i];
                val[v] += val[fail[v]];
            }
            else chd[p][i] = chd[fail[p]][i];
        }
    }
}
void sol(char *s)
{
    int p = 0, ret = 0;
    for(;*s; s++)
    {
        int c = sw[*s];
        p = chd[p][c];
        int pp = p;
        while(val[pp])
        {
            ret += word[pp];
            pp = fail[pp];
        }
    }
    printf("%d\n",ret);
}

char s[N];
int main()
{
    for(int i = 0; i < CH; i++)sw['a'+i]=i;
    sz = 1;
    scanf("%d%d",&n,&K);
    for(int i = 0; i < K; i++)
    {
        scanf("%s",s);
        Ins(s,i+1);
        in[i+1] = 1;
    }
    AC();
    int x;
    for(int i = 0; i < n; i++)
    {
        scanf("%s",s);
//      printf("%s\n",s);
        if(s[0]=='+')
        {
            sscanf(s, "+%d", &x);
            if(!in[x])word[idx[x]]++,in[x]=1;
        }
        else if(s[0]=='-')
        {
            sscanf(s, "-%d", &x);
            if(in[x])word[idx[x]]--,in[x]=0;
        }
        else    sol(s+1);
    }

    return 0;
}
