#include<cstdio>
#include<algorithm>
#define ll long long int
using namespace std;
int time[200005];
int an[200005];
struct node
{
  int d,r,id;
}da[200005];
bool cramp(node a,node b)
{
    if (a.d==b.d) return a.r<b.r;
    return a.d<b.d;

}
int main()
{
    int n,m;
    while(~scanf("%d%d",&n,&m))
    {
       for (int i=1;i<=m;i++)
        scanf("%d",&time[i]);
       for (int i=1;i<=n;i++)
        {
            scanf("%d%d",&da[i].d,&da[i].r);
            da[i].id=i;
        }
       sort(da+1,da+n+1,cramp);
       int k=1;
       ll ans=0;
       for (int i=1;i<=n;i++)
       {
           if (da[i].d!=da[i-1].d)
           {
             k=1;
             ans=0;
           }
           else
           {
               if (ans>=da[i].r)
               {
                   an[da[i].id]=k;
                   continue;
               }
               else k++;
           }
           for (k;k<=m;k++)
           {
            ll x=time[k]-da[i].d;
            if (x<0) x=0;
            ans+=x;
            if (ans>=da[i].r) break;
           }
           if (ans<da[i].r){
             da[i].r=0;
           }
           else an[da[i].id]=k;
       }
       printf("%d",an[1]);
       for (int i=2;i<=n;i++)
        printf(" %d",an[i]);
       printf("\n");
    }
}

  	 				    	   	   	  				  	