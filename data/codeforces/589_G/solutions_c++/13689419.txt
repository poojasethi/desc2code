#include <bits/stdc++.h>
#define fi first
#define se second
#define pb push_back
#define m ((b+s)>>1)
#define lb lower_bound
#define ub upper_bound
#define umax(a,b) a=max(a,b)
#define umin(a,b) a=min(a,b)

using namespace std;

typedef long long lint;
typedef pair <lint,lint> ii;
typedef pair <ii,lint> iii;
typedef vector <lint> vi;
typedef vector <ii> vii;

const lint maxn=2e5+20;

lint N,M,day[maxn],t[maxn],sum[maxn],ans[maxn],at;
vector <iii> guys;
vector <ii> v;

lint bs(lint x,lint a,lint b){
	lint sumt=0,sumd=0;

	for(lint j=x;j>0;j-=j&(-j))
		sumd+=day[j] , sumt+=sum[j];
	
	if(sumt-sumd*a < b)
		return 0;

	return 1;
}

int main(){
	scanf("%lld %lld",&N,&M);
	
	for(lint i=1;i<=M;i++){
		scanf("%lld",&t[i]);
		v.push_back(ii(t[i],i));
	}
	
	sort(v.begin(),v.end());
	
	for(lint i=1;i<=M;i++)
		for(lint j=i;j<=M;j+=j&(-j))
			day[j]++ , sum[j]+=t[i];
	
	for(lint i=1;i<=N;i++){
		lint a,b;
		scanf("%lld %lld",&a,&b);
		guys.push_back(iii(ii(a,b),i));
	}
	
	sort(guys.begin(),guys.end());
	
	for(lint i=0;i<N;i++){
		lint a=guys[i].fi.fi , b=guys[i].fi.se;
		
		while(at<v.size() && v[at].fi < a){
			for(lint j=v[at].se;j<=M;j+=j&(-j))
				day[j]-- , sum[j]-=v[at].fi;
			at++;
		}
		
		if(at==v.size()) break;
		
		if(!bs(M,a,b)){
			ans[guys[i].se]=0;
			continue;
		}
		
		lint cur=M;
		
		for(lint k=19;k>=0;k--){
			lint x=cur-(1<<k);
			if(x<=0) continue;
			
			if(bs(x,a,b))
				cur-=1<<k;
		}
		
		ans[guys[i].se]=cur;
	}
	
	for(lint i=1;i<=N;i++)
		printf("%lld ",ans[i]);
	puts("");
	
	return 0;
}
