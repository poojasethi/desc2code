#include <bits/stdc++.h>
#define fi first
#define se second
#define pb push_back
#define mp make_pair

using namespace std;
typedef long long ll;
typedef vector<int> vi;
typedef pair<int,int> ii;
const int INF=0x3f3f3f3f;
const int N=200100;

ll ft[N], cnt[N];
ii t[N]; 
pair<ii,int> vec[N];
int n,m;


void upd(ll vft[], int p, int x) {
	while(p<=m){
		vft[p]+=x;
		p=p+(p&-p);
	}
}
ll que(ll vft[], int p) {
	ll ret=0;
	for(;p;p-=p&-p)ret+=vft[p];
	return ret;
}

int main(void) {

	scanf("%d%d",&n,&m);
	for(int i=0;i<m;i++){
		scanf("%d",&(t[i].fi));
		t[i].se=i+1;
	}

	sort(t, t+m);
	for(int i=0;i<n;i++) {
		scanf("%d%d", &(vec[i].fi.fi), &(vec[i].fi.se));
		vec[i].se=i;
	}
	sort(vec, vec+n);
	int i=m-1;
	vi ans(n,0);

	for(int j=n-1;j>=0;j--) {
		while(i>=0&&t[i].fi>vec[j].fi.fi) {
			upd(ft,t[i].se, t[i].fi);
			upd(cnt,t[i].se, 1);
			i--;
		}

		int lo=1, hi=m+1;
		while(lo!=hi) {
			int mi=(lo+hi)/2;
			ll s=que(ft,mi)-1LL*vec[j].fi.fi*que(cnt,mi);
			if(s<vec[j].fi.se)
				lo=mi+1;
			else hi=mi;
		}
		if(lo<=m)ans[vec[j].se]=lo;
	}
	for(int i=0;i<ans.size();i++)
		cout<<ans[i]<<" \n"[i==n-1];


	return 0;
}
