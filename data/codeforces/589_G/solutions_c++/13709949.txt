#include<iostream>
#include<algorithm>
#include<cstring>
#include<cstdio>
#include<cmath>
#include<vector>
using namespace std;

struct peo
{
  int per;
  int work;
  int pos;
}p[200010];

bool cm(peo a,peo b)
{
  if(a.per == b.per)
    return a.work < b.work;
  return a.per < b.per;
}

int Time[200010];
int fin[200010];

int n,m;

int main()
{
  cin>>n>>m;
  for(int i=1;i<=m;i++)
    scanf("%d",&Time[i]);
  for(int i=1;i<=n;i++)
  {
    scanf("%d%d",&p[i].per,&p[i].work);
    p[i].pos = i;
  }
  sort(p+1,p+n+1,cm);
  long long ans = 0;
  int k = 1;
  for(int Pos = 1;Pos <= n;Pos++)
  {
    if(p[Pos].per != p[Pos-1].per)
    {
      k = 1;
      ans = 0;
    }
    else
    {
      if(ans >= p[Pos].work) { fin[p[Pos].pos] = k;continue;}
      else k++;
    }
    for(;k<=m;k++)
    {
     
      int minus = Time[k] - p[Pos].per;
      if(minus > 0) ans += (long long)minus;
      if(ans >= (long long)p[Pos].work) {fin[p[Pos].pos] = k;break;}
    }
  }
  for(int i=1;i<n;i++)
    printf("%d ",fin[i]);
  printf("%d\n",fin[n]);
}