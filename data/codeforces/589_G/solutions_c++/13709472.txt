#include <bits/stdc++.h>
using namespace std;

#define fru(j,n) for(int j=0; j<(n); ++j)
#define tr(it,v) for(typeof((v).begin()) it=(v).begin(); it!=(v).end(); ++it)
#define x first
#define y second
#define pb push_back
#define ALL(G) (G).begin(), (G).end()

#if 1
	#define DEB printf
#else
	#define DEB(...)
#endif

typedef long long ll;
typedef long long LL;
typedef double D;
typedef pair<int,int> pii;
typedef vector<int> vi;

const int inft = 1000000009;
const int mod = 1000000007;
const int MAXN = 1000006,T=1024*256;

int A[MAXN],ANS[MAXN];
pair<ll,int> drz[2*T];
void add(int co, int p){
	p+=T;
	while(p){
		drz[p].x+=co;
		drz[p].y++;	
		p/=2;
	}
}
pair<ll,int> get(int k,int p=1){
	p+=T;k+=T;
	pair<ll,int> ret(0,0);
	while(p<=k){
		if(p%2==1){ret.x+=drz[p].x;ret.y+=drz[p].y;p++;}
		if(k%2==0){ret.x+=drz[k].x;ret.y+=drz[k].y;k--;}
		p/=2;k/=2;
	}
	return ret;
}
bool ok(int d,int r,int day){
	pair<ll,int> w=get(day);
   return w.x-1LL*w.y*d>=r;	
}
int main() {
	int n,m;
	scanf("%d%d",&n,&m);
	vector<pii> E;
	fru(i,m){
		int a;
		scanf("%d",&a);
		E.pb(pii(a,i+1));
	}
	fru(i,n){
		int a,b;
		scanf("%d%d",&a,&b);
		E.pb(pii(a,-i));
		A[i]=b;
	}
	sort(ALL(E));
	for(int i=E.size()-1;i>=0;i--){
		pii u= E[i];
	//	printf("dodaje %d, %d\n",u.x,u.y);
		if(u.y>0){
			add(u.x,u.y);
		}
		else{
			u.y*=-1;
			int pocz=1,kon=m;
			if(!ok(u.x,A[u.y],kon))ANS[u.y]=0;
			else{
				if(ok(u.x,A[u.y],pocz))ANS[u.y]=pocz;
				else {
					while(pocz<kon-1){
					int med=(pocz+kon)/2;
					if(ok(u.x,A[u.y],med))kon=med;
					else pocz=med;
				}
				ANS[u.y]=kon;
				}
			}
		}
	}
	fru(i,n)printf("%d ",ANS[i]);
	return 0;
}
