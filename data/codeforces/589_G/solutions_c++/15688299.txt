#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 200100;
int Time[N], fin[N];
struct node
{
    int p, w, pos;
}C[N];

bool cmp(node a, node b)
{
    if(a.p != b.p)
        return a.p < b.p;
    return a.w < b.w;
}

int main()
{
    int n, m;
    while (~scanf("%d%d", &n, &m))
    {
        for (int i = 1; i <= m; i++)
            scanf("%d", &Time[i]);
        for (int i = 1; i <= n; i++)
        {
            scanf("%d%d", &C[i].p, &C[i].w);
            C[i].pos = i;
        }
        sort(C, C+n+1, cmp);
        ll ans = 0;
        int k = 1;
        for (int i = 1; i <= n; i++)
        {
            if (C[i].p != C[i-1].p)
            {
                k = 1;
                ans = 0;
            }
            else
            {
                if (ans >= C[i].w)
                {
                    fin[C[i].pos] = k;
                    continue;
                }
                k++;
            }
            for (; k <= m; k++)
            {
                int minn = Time[k] - C[i].p;
                if (minn > 0)
                    ans += 1LL*minn;
                if (ans >= 1LL*C[i].w)
                {
                    fin[C[i].pos] = k;
                    break;
                }
            }
        }
        for (int i = 1; i <= n; i++)
            printf("%d ", fin[i]);
        puts("");
    }
    return 0;
}

	 							 			  	 		  				   		