#include <bits/stdc++.h>

#define ll long long
#define pii pair<ll,ll>
#define ppi pair<pii,ll>
#define x first
#define y second

using namespace std;
const ll maxn=600010;
ll n, m;
ll x;
ll ind;
ll s[maxn];
ll a[maxn];
ll sol[maxn];
pii tmp;

vector <pii> v;
vector <ppi> v2;

void update(ll w,ll x,ll _m){
	for (ll i=w;i<maxn;i+=i&-i){
		if (!_m){
			s[i]+=x;
		}
		else{
			a[i]+=x;
		}
	}
	return ;
}

ll  get(ll  w,ll  _m){
	ll  z=0;
	for (ll  i=w;i>0;i-=i&-i){
		if (!_m){
			z+=s[i];
		}
		else{
			z+=a[i];
		}
	}
	return z;
}

ll  bin_search(ll  ind){
	ll  l=0,r=m,s;
	while (l<r){
		s=(l+r)/2;
		if (get(s+1,0)-(s+1-get(s+1,1))*v2[ind].x.x<v2[ind].x.y){
			l=s+1;
		}
		else{
			r=s;
		}
	}
	if (l==m){
		return 0;
	}
	return (l+1);
}

int main (){
	cin >> n >> m;
//	scanf("%d%d", &n, &m);
	for (ll  i=0;i<m;i++){
		cin >> x;
//		scanf("%d", &x);
		v.push_back(make_pair(x,i));
		update(i+1,x,0);
	}
	for (ll  i=0;i<n;i++){
		cin >> tmp.x >> tmp.y;
//		scanf("%d%d", &tmp.x, &tmp.y);
		v2.push_back(make_pair(tmp,i));	
	}
	sort(v.begin(),v.end());
	sort(v2.begin(),v2.end());
	for (ll  i=0;i<m;i++){
		if (ind<n&&v[i].x>v2[ind].x.x){
			sol[v2[ind].y]=bin_search(ind);
			ind++;
			i--;
			continue;
		}
		update(v[i].y+1,-v[i].x,0);
		update(v[i].y+1,1,1);
	}
	for (ll  i=0;i<n;i++){
		cout << sol[i] << " ";
//		printf("%d ", sol[i]);
	}
//	printf("\n");
	return 0;
}
