#include<cstdio>
#include<cstring>
#include<vector>
#include<algorithm>
#define LL long long
#define lson l,m,rt<<1
#define rson m+1,r,rt<<1|1
using namespace std;
int n,m;
const int N=2e5+5;
int t[N],ans[N];
struct node
{
    int d,r,id;
    bool operator <(const node& b)const
    {
        if(d!=b.d)return d<b.d;
        return r<b.r;
    }
}p[N];
int main()
{
    //freopen("a.txt","r",stdin);
    while(~scanf("%d%d",&n,&m))
    {
        for(int i=1;i<=m;i++)scanf("%d",&t[i]);
        for(int i=1;i<=n;i++)scanf("%d%d",&p[i].d,&p[i].r),p[i].id=i;
        sort(p+1,p+n+1);
        int sum=0;p[0].d=0;int cur=1;
        for(int i=1;i<=n;i++)
        {
            if(p[i].d>p[i-1].d)cur=1,sum=0;
            if(p[i].d==p[i-1].d)
            {
                if(sum>=p[i].r){ans[p[i].id]=cur;continue;}
                cur++;
            }
            while(cur<=m)
            {
                if(t[cur]>p[i].d)sum+=t[cur]-p[i].d;
                if(sum>=p[i].r){ans[p[i].id]=cur;break;}
                cur++;
            }
            if(cur>m)ans[p[i].id]=0;
        }
        for(int i=1;i<=n-1;i++)printf("%d ",ans[i]);printf("%d\n",ans[n]);
    }
    return 0;
}

  	  		  		   	 							   	 			