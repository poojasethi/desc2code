#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<algorithm>
#include<iostream>
#include<queue>
#include<string>
#include<ctime>

using namespace std;

typedef long long ll;

struct Line
{
	ll a,b,c;
}line[100010];

int n,kk,top=0;
int pre[100010],nex[100010];
int sta[100010],ans[100010][2];
bool flag[100010];

bool run()
{
	int a,b,now;
	ll x,y,f;
	top=n;
	memset(flag,0,sizeof(flag));
	srand(time(NULL));
	for(int i=1;i<=500;++i)
	{
		a=rand()%n+1;
		b=rand()%n+1;
		if(flag[a]||flag[b]) continue;
		f=line[a].a*line[b].b-line[b].a*line[a].b;
		if(f==0) continue;
		x=line[a].b*line[b].c-line[a].c*line[b].b;
		y=line[b].a*line[a].c-line[a].a*line[b].c;
		now=nex[n+1];
		memset(sta,0,sizeof(sta));
		while(now!=0)
		{
			ll bbc=line[now].a*x+line[now].b*y+line[now].c*f;
			if(bbc==(ll)0)
				sta[++sta[0]]=now;
			now=nex[now];
		}
		if(sta[0]*kk>=top)
		{
			--kk; top-=sta[0];
			ans[++ans[0][0]][0]=a;
			ans[ans[0][0]][1]=b;
			for(int k=1;k<=sta[0];++k)
			{
				int &e=sta[k];
				flag[e]=true;
				nex[pre[e]]=nex[e];
				pre[nex[e]]=pre[e];
			}
		}
		if(kk<=0||top<=0) break;
	}
	if(top>kk) return false;
	now=nex[n+1];
	while(now!=0)
	{
		if(!flag[now])
		{
			--kk;
			ans[++ans[0][0]][0]=now;
			ans[ans[0][0]][1]=-1;
		}
		now=nex[now];
	}
	printf("YES\n%d\n",ans[0][0]);
	for(int i=1;i<=ans[0][0];++i)
		printf("%d %d\n",ans[i][0],ans[i][1]);
	return true;
}

void init()
{
	cin>>n>>kk;
	for(int i=1;i<=n;++i)
	{
		scanf("%I64d%I64d%I64d",&line[i].a,&line[i].b,&line[i].c);
		nex[i]=i+1;
		pre[i]=i-1;
	}
	nex[n]=0; nex[n+1]=1;
	pre[1]=n+1; pre[n+1]=0;
	if(!run())
		printf("NO");
	return;
}

int main()
{
	//freopen("in.txt","r",stdin);
	//freopen("out.txt","w",stdout);
	init();
	return 0;
}

