#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <ctime>
#include <map>
#define fi first
#define se second
#define PA pair<int,int>
#define VI vector<int>
#define VP vector<PA >
#define mk(x,y) make_pair(x,y)
#define N 200010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int a,s;
} tr[N*4];
int i,j,k,n,m,d,K,r1,r2,an,an1,an2;
int r[N],g[N],h[N],a[N];
map<int,int> w;
inline void update(int x) {
	int y=x*2,z=x*2+1;
	tr[x].s=tr[y].s+tr[z].s;
	tr[x].a=min(tr[y].a,tr[y].s+tr[z].a);
}
void inc(int q,int x,int y,int k,int t) {
	if (x==y) {
		tr[q].s+=t;
		tr[q].a+=t;
		return;
	}
	int mid=(x+y)/2;
	if (k<=mid) inc(q*2,x,mid,k,t);
	else inc(q*2+1,mid+1,y,k,t);
	update(q);
}
int cal(int q,int x,int y,int k,int v) {
	if (tr[q].a>v) return 0;
	if (x==y) return x;
	int mid=(x+y)/2;
	if (k<=mid) return cal(q*2,x,mid,k,v);
	int A=cal(q*2+1,mid+1,y,k,v-tr[q*2].s);
	if (A) return A;
	else return cal(q*2,x,mid,k,v);
}
inline void tepan() {
	for (i=1;i<=n;i=j) {
		for (j=i;j<=n&&a[i]==a[j];j++);
		if (j-i>an) an=j-i,an1=i,an2=j-1;
	}
	printf("%d %d\n",an1,an2);
	exit(0);
}
int main() {
	scanf("%d%d%d",&n,&K,&d);
	For(i,1,n) scanf("%d",&a[i]);
	if (!d) tepan();
	for (i=n;i;i--) {
		if (w.count(a[i])) r[i]=w[a[i]];
		else r[i]=n+1;
		w[a[i]]=i;
		if (i<n) {
			if ((a[i]%d+d)%d==(a[i+1]%d+d)%d) r[i]=min(r[i],r[i+1]);
			else r[i]=i+1;
		}
	}
	For(i,1,n) a[i]/=d;
	for (i=n;i;i--) {
		if (i<n) inc(1,1,n,i+1,-1);
		{
			for (;r1&&a[g[r1]]>=a[i];r1--) {
				if (r1>1) inc(1,1,n,g[r1-1],-(a[g[r1]]-a[g[r1-1]]));
			}
			g[++r1]=i;
			if (r1>1) inc(1,1,n,g[r1-1],a[g[r1]]-a[g[r1-1]]);
		}
		{
			for (;r2&&a[h[r2]]<=a[i];r2--) {
				if (r2>1) inc(1,1,n,h[r2-1],-(a[h[r2-1]]-a[h[r2]]));
			}
			h[++r2]=i;
			if (r2>1) inc(1,1,n,h[r2-1],a[h[r2-1]]-a[h[r2]]);
		}
		int A=cal(1,1,n,r[i]-1,K);
		if (an<=A-i+1) {
			an=A-i+1;
			an1=i,an2=A;
		}
	}
	printf("%d %d\n",an1,an2);
	return 0;
}
