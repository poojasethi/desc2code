#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
class sp{
  public:
  int q;
  sp *w;
  sp(int q1,sp *w1){
   q=q1;w=w1;}
};
sp *a[100000];
int i,g[100000],h[100000],h1[100000],*f[100000];
int l(int q,int e){
  int w=1,r=0,t=g[q]>>1;
  for(;t;t>>=1){
   w<<=1;
   if(e>=t){
    e-=t;
    r+=f[q][w];
    w++;}}
  return r;
}
void m(int q,int w,int e){
  for(w+=g[q];w;w>>=1)
   f[q][w]+=e;
}
void k(int q,int w){
  sp *c;
  h[q]=i;
  h1[q]=g[i];
  g[i]++;
  for(c=a[q];c;c=c->w)
   if(c->q!=w)
    k(c->q,q);
}
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t=1,y=0,c,d[100000],d1[100000];
  scanf("%d",&q);
  for(w=0;w<q;w++){
   a[w]=0;
   h[w]=0;}
  for(w=1;w<q;w++){
   scanf("%d%d",&e,&r);
   e--;r--;
   h[e]++;h[r]++;
   a[e]=new sp(r,a[e]);
   a[r]=new sp(e,a[r]);
   d[w-1]=e;
   d1[w-1]=r;}
  for(w=1;w<q;w++)
   if(h[w]>h[y])
    y=w;
  h1[y]=-1;
  h[y]=0;
  for(sp *c=a[y];c;c=c->w){
   g[t]=0;
   i=t;
   k(c->q,y);
   t++;}
  for(w=1;w<t;w++){
   for(e=4;(g[w]<<1)+1>e;e<<=1);
   f[w]=new int[e];
   for(r=1;r<e;r++)
    f[w][r]=0;
   g[w]=e>>1;}
  for(w=0;w<q-1;w++)
   if(h1[d[w]]<h1[d1[w]]){
    r=d[w];d[w]=d1[w];d1[w]=r;}
  for(scanf("%d",&w);w;w--){
   scanf("%d",&e);
   if(e==1){
    scanf("%d",&r);
    r=d[r-1];
    m(h[r],h1[r],-1);}
   if(e==2){
    scanf("%d",&r);
    r=d[r-1];
    m(h[r],h1[r],1);}
   if(e==3){
    scanf("%d%d",&e,&r);
    e--;r--;
    if(h[e]>h[r]){
     c=e;e=r;r=c;}
    if(h[e]==0){
     if(l(h[r],h1[r]+1)>0)
      printf("-1\n");
     else
      printf("%d\n",h1[r]+1);
     continue;}
    if(h[e]==h[r]){
     if(l(h[e],h1[e]+1)!=l(h[r],h1[r]+1))
      printf("-1\n");
     else
      printf("%d\n",abs(h1[e]-h1[r]));
     continue;}
    if(l(h[e],h1[e]+1)+l(h[r],h1[r]+1)>0)
     printf("-1\n");
    else
     printf("%d\n",h1[e]+h1[r]+2);}}
  return 0;}
