#include<iostream>
#include<vector>
#include<set>
#define mp make_pair
#define x first
#define y second
#define pb push_back
using namespace std;
int n,r,d[100000],f[100001],v[100001];
pair<int,int> p[100000];
vector<int> e[100001];
set<int> q[100001];
inline int fd(int i,int j){return p[j].x==i?p[j].y:p[j].x;}

int main()
{
	#ifndef ONLINE_JUDGE
    freopen("cf.in","rb",stdin);
    freopen("cf.out","wb",stdout);
    #endif
    cin>>n; 
    for(int i=1;i<n;++i)cin>>p[i].x>>p[i].y,e[p[i].x].pb(i),e[p[i].y].pb(i);
    for(r=1;e[r].size()<=2&&r<n;++r);
    v[r]=1;
    for(int i=e[r].size()-1,j,l;i>=0;--i)
	{
		q[j=fd(r,l=e[r][i])].insert(n+1);
		for(int now=j,k=1;;k++)
		{
			d[l]=k,f[now]=j;v[now]=l;
			if(e[now].size()==1)break;
			now=fd(now,l=(v[fd(now,e[now][0])]?e[now][1]:e[now][0]));
		}
	}
	v[r]=0;
	cin>>n;
	for(int a,b,c;n--;)
	{
		cin>>b>>a;
		if(b==3)
		{
			cin>>b;
			if(a==r)swap(a,b);
			if(a==b)cout<<0<<endl;else
			if(b==r)cout<<(*q[f[a]].begin()>d[v[a]]?d[v[a]]:-1)<<endl;
			else 
				if(f[a]==f[b])
				{
					if(d[v[a]]>d[v[b]])swap(a,b);
					cout<<(*q[f[a]].upper_bound(d[v[a]])>d[v[b]]?d[v[b]]-d[v[a]]:-1)<<endl;
				}
				else
					cout<<(*q[f[a]].begin()>d[v[a]]&&*q[f[b]].begin()>d[v[b]]?d[v[a]]+d[v[b]]:-1)<<endl;
		}
		else 
		{
			c=f[p[a].x==r?p[a].y:p[a].x];
			if(b==1)q[c].erase(d[a]);else q[c].insert(d[a]);
		}
	}
    return 0;
}
