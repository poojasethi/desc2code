//In the Name of God

#include<iostream>
#include<map>
#include<vector>
#include<cmath>
#define mp make_pair

using namespace std;

const int M=100100;
int n,q,r,k,N[M],L[M],D[M],C[M],I[M],H[M];
bool V[M];
vector<int> g[M],s[M];
map<pair<int,int>,int> a;

inline void F(int v,int J,int c)
{
  V[v]=1;
  L[c]++;
  D[v]=c;
  for(int i=0;i<g[v].size();i++)
    if(!V[g[v][i]])
      {
	H[g[v][i]]=H[v]+1;
	C[a[mp(v,g[v][i])]]=c;
	I[a[mp(v,g[v][i])]]=J;
	F(g[v][i],J+1,c);
      }
}

inline int S(int v,int fs,int ls,int f,int l,int c)
{
  if(fs==f && ls==l)
    return s[c][v];
  int m=(fs+ls)/2;
  if(l<=m)
    return S(v*2,fs,m,f,l,c);
  if(m<f)
    return S(v*2+1,m+1,ls,f,l,c);
  return S(v*2,fs,m,f,m,c)+S(v*2+1,m+1,ls,m+1,l,c);
}

int main()
{
  ios_base::sync_with_stdio(0);
  cin>>n;
  for(int i=1,v,u;i<n;i++)
    {
      cin>>v>>u;
      g[v].push_back(u);
      g[u].push_back(v);
      a[mp(v,u)]=a[mp(u,v)]=i;
    }
  for(int i=1;i<=n;i++)
    if(g[i].size()>2)
      r=i;
  if(!r)
    for(int i=1;i<=n;i++)
      if(g[i].size()>1)
	r=i;
  if(!r)
    r=1;
  V[r]=1;
  k=g[r].size();
  for(int i=0;i<k;i++)
    {
      L[i]=1;
      I[a[mp(r,g[r][i])]]=1;
      C[a[mp(r,g[r][i])]]=i;
      D[g[r][i]]=i;
      H[g[r][i]]=1;
      F(g[r][i],2,i);
    }
  for(int i=0;i<k;s[i].resize(N[i]*2),i++)
    for(N[i]=1;N[i]<L[i];N[i]*=2);
  cin>>q;
  for(int t,i,j,B,A;q--;)
    {
      cin>>t;
      if(t==1)
	{
	  cin>>i;
	  for(int x=N[C[i]]+I[i]-1;x;s[C[i]][x]--,x/=2);
	}
      else if(t==2)
	{
	  cin>>i;
	  for(int x=N[C[i]]+I[i]-1;x;s[C[i]][x]++,x/=2);
	}
      else if(t==3)
	{
	  cin>>i>>j;
	  if(i==j)
	    {
	    cout<<0<<endl;
	    continue;
	  }
	  if(i==r)
	    A=H[j],
	    B=S(1,1,N[D[j]],1,H[j],D[j]);
	  else if(j==r)
	    A=H[i],
	    B=S(1,1,N[D[i]],1,H[i],D[i]);
	  else if(D[j]!=D[i])
	    A=H[i]+H[j],
	    B=S(1,1,N[D[i]],1,H[i],D[i])+S(1,1,N[D[j]],1,H[j],D[j]);
	  else
	    A=abs(H[i]-H[j]),
	    B=S(1,1,N[D[i]],min(H[i],H[j])+1,max(H[i],H[j]),D[i]);
	  cout<<(!B)*(A+1)-1<<endl;
	}
    }
  return 0;
}
