#include <bits/stdc++.h>
using namespace std;
long long int a[1003][1003],b[1003][1003],ans[10000005],cnt,n,m;
void fun(long long int j,long long int k,char (*c)[1003],long long int val) {
	a[j][k] = val;
	if(j) {
		if(c[j-1][k]=='*')
			cnt++;
		if(c[j-1][k]=='.'&&!a[j-1][k])
			fun(j-1,k,c,val);
	}
	if(k) {
		if(c[j][k-1]=='*')
			cnt++;
		if(c[j][k-1]=='.'&&!a[j][k-1])
			fun(j,k-1,c,val);
	}
	if(c[j][k+1]=='*'&&k<m-1)
		cnt++;
	if(c[j][k+1]=='.'&&k<m-1&&!a[j][k+1])
		fun(j,k+1,c,val);
	if(c[j+1][k]=='*'&&j<n-1)
		cnt++;
	if(c[j+1][k]=='.'&&j<n-1&&!a[j+1][k])
		fun(j+1,k,c,val);
}
int main() {
	long long int i,j,k,l,q;
	char c[1003][1003];
	cin>>n>>m>>q;
	for(i=0;i<n;i++)
		cin>>c[i];
	for(i=1;i<=q;i++) {
		cin>>j>>k;
			cnt=0;
		if(!a[j-1][k-1]) {
			fun(j-1,k-1,c,i);
			ans[i] = cnt;
			cout<<cnt<<endl;
		}
		else
			cout<<ans[a[j-1][k-1]]<<endl;
	}
	return 0;
}
