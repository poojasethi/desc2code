#include <bits/stdc++.h>

using namespace std;

int n, m, k, mark[1000][1000], s = 1, x, y, ans[100000];
char c[1000][1000];

void dfs(int x, int y) {
	mark[x][y] = s;
	for (int i = -1; i < 2; i++)
		for (int j = -1; j < 2; j++)
			if (abs(i + j) % 2 != 0 && c[x + i][y + j] == '*') {
				ans[s]++;
			}
	for (int i = -1; i < 2; i++)
		for (int j = -1; j < 2; j++)
			if (abs(i + j) % 2 != 0 && c[x + i][y + j] == '.' && mark[x + i][y + j] == 0)
				dfs(x + i, y + j);
}

int main() {
	ios_base::sync_with_stdio(0);
	cin >> n >> m >> k;
	for (int i = 0; i < n; i++)
		for (int j = 0; j < m; j++)
			cin >> c[i][j];
	while (k--) {
		cin >> x >> y;
		x--;
		y--;
		if (mark[x][y] != 0) {
			cout << ans[mark[x][y]] << '\n';
			continue;
		}
		else {
			dfs(x, y);
			cout << ans[s] << '\n';
			s++;
		}
	}
	return 0;
}

