#include <iostream>
#include<stdio.h>
#include<cstring>
using namespace std;

int dx[4]={ 0 , 0 , -1 , 1 }, dy[4]={ -1 , 1 , 0 , 0 } , n , m ,k , l , r ;
int vis[1005][1005];
char s[1005][1005];
int Q[100005];
bool valid(int x , int y){
	return x>0&&x<=n&&y>=0&&y<m&&!vis[x][y];
}
int c;  int h;
void DFS(int x, int y){
	if(vis[x][y]==h) return ;
	vis[x][y]=h;
	for(int i=0;i<4;++i){
		int a=x+dx[i], b=y+dy[i];
		if(valid(a,b)&&s[a][b]!='.')
		c++;
		else if(valid(a,b)&&s[a][b]=='.')
		DFS(a,b);
	}
}
int main() {
	scanf("%d%d%d\n",&n,&m,&k);
	for(int i=1;i<=n;++i)scanf("%s",s[i]);  int ans;
	for( h=1;h<=k;++h){
		scanf("%d%d",&l,&r); --r;
		if(!vis[l][r]){
		c=0; DFS(l,r);
		Q[h]=c; ans=c;
		}
		else
		ans=Q[vis[l][r]];
		
		printf("%d\n",ans);
	}
	
	return 0;
}