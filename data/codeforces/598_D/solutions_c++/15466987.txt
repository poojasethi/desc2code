#include <bits/stdc++.h>
#include <cstdio>
using namespace std;
int dirX[] = {-1,0,1,0};
int dirY[] = {0,-1,0,1};
char mus[1001][1001];
int v[1001][1001][4];
int result[100001];
int seen;
void dfs(int x,int y,int i) {
for(int z = 0;z<4;z++) {
v[x][y][z] = i;
}
int nX,nY;
for(int k = 0;k<4;k++) {
nX = x+dirX[k];
nY = y+dirY[k];
if(mus[nX][nY] == '*' && v[nX][nY][k] !=i) {
v[x+dirX[k]][y+dirY[k]][k] = i;
seen++;
} else if(mus[nX][nY] == '.' && v[x+dirX[k]][y+dirY[k]][k] !=i) {
dfs(x+dirX[k],y+dirY[k],i);
}
}
}
int main() {
int m,n,k;
int x,y;
char c;
scanf("%d %d %d\n",&n,&m,&k);
for(int i = 0;i<n;i++) {
for(int j = 0;j<m;j++) {
scanf("%c", &mus[i][j]);
}
scanf("%c",&c);
}
for(int i = 1;i<=k;i++) {
seen = 0;
scanf("%d %d",&x,&y);
x--;
y--;
if(v[x][y][0]) {
seen = result[v[x][y][0]];
} else {
dfs(x,y,i);
result[i] = seen;
}
printf("%d\n",seen);
}
return 0;
}