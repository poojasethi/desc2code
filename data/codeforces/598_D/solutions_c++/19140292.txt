#include<cstdio>
#include<iostream>
#include<map>
#include<cstring>
#define MAXN 1100
using namespace std;
map<int,int>ma;
char a[MAXN][MAXN];
int b[MAXN][MAXN];
int p[MAXN][MAXN];
int k,n,m,ans,di;
void tr(int x,int y)
{
	b[x][y]=di;
	if(a[x][y+1]=='*')ans++;
	if(a[x+1][y]=='*')ans++;
	if(a[x][y-1]=='*')ans++;
	if(a[x-1][y]=='*')ans++;
	if(!b[x][y+1]&&a[x][y+1]=='.')tr(x,y+1);
	if(!b[x+1][y]&&a[x+1][y]=='.')tr(x+1,y);
	if(!b[x][y-1]&&a[x][y-1]=='.')tr(x,y-1);
	if(!b[x-1][y]&&a[x-1][y]=='.')tr(x-1,y);
	return;
}
int main()
{
	ios::sync_with_stdio(false);
	cin>>n>>m>>k;
	for(int i=1;i<=n;i++)
		for(int j=1;j<=m;j++)
			cin>>a[i][j];
	memset(b,0,sizeof(b));
	while(k--)
	{
		int x,y;
		cin>>x>>y;
		if(b[x][y]!=0)
			cout<<ma[b[x][y]]<<endl;
		else
		{
			ans=0;
			di++;
			tr(x,y);
			ma[di]=ans;
			cout<<ans<<endl;
		}
	}
	return 0;
}
						 	  		 	 	  	 		 	   		 	