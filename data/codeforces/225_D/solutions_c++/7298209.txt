#include <iostream>
#include <algorithm>
#include <cstdio>
#include <set>
#include <cstring>
#include <string>

using namespace std;

const int pr=131071;
set<long long>vist;
int n,m,num;
char s[20][20];

class node
{
	public:int x[10],y[10],d;
}q[233333];

int b,f,dx[]={1,-1,0,0},dy[]={0,0,1,-1};

long long ha(const node&a)
{
	long long nu=0;
	for(int i=0;i<num;i++)nu+=23333*nu+233*a.x[i]+a.y[i];
	return nu;
}
int main()
{
	num=0;
	scanf("%d %d",&n,&m);
	for(int i=0;i<n;i++)scanf("%s",s[i]);
	for(int i=0;i<n;i++)
		for(int j=0;j<m;j++)
			if(s[i][j]>=48&&s[i][j]<=57){
                num++;
				q[0].x[s[i][j]-48-1]=i;
				q[0].y[s[i][j]-48-1]=j;
            }
	vist.insert(ha(q[0]));
	for(b=0,f=1;b!=f;++b&=pr)
	{
		for(int i=0,j;i<4;i++)
		{
			int x=q[b].x[0]+dx[i],y=q[b].y[0]+dy[i];
			if(x<0||y<0||x>=n||y>=m)continue;
			for(j=0;j<num-1;j++)
            if(x==q[b].x[j]&&y==q[b].y[j])break;
			if(j<num-1||s[x][y]=='#')continue;
			if(s[x][y]=='@')
			{
				printf("%d\n",q[b].d+1);
				return 0;
			}
			q[f].x[0]=x,q[f].y[0]=y;
			for(j=1;j<num;j++)
				q[f].x[j]=q[b].x[j-1],q[f].y[j]=q[b].y[j-1];
			q[f].d=q[b].d+1;
			long long x2=ha(q[f]);
			if(vist.count(x2))continue;vist.insert(x2);++f&=pr;
		}
	}
	printf("-1\n");
}

		 	 	 	 	 		 	  	 			   	