#include <cstdio>
#include <cstring>
#include <cctype>
#include <algorithm>
#include <set>

using namespace std;

const int MaxL = 262143;

typedef long long LL;

int dx[4]={-1,0,1,0};
int dy[4]={0,1,0,-1};
int n,m,len;
char grid[20][20];
struct Node{
	int x[10],y[10],d;
}q[MaxL+5];
set<LL> hsh;

LL pack(Node &a){
	LL w=0;
	for(int i=0;i<len;i++)
		w+=13131*w+131*a.x[i]+a.y[i];
	return w;
}

int main()
{
	scanf("%d%d",&n,&m);
	for(int i=0;i<n;i++) scanf("%s",grid[i]);
	int l=0,r=1;
	for(int i=0;i<n;i++)
		for(int j=0;j<m;j++) if(isdigit(grid[i][j])){
			q[l].x[grid[i][j]-'0'-1]=i,q[l].y[grid[i][j]-'0'-1]=j;
			len=max(len,grid[i][j]-'0');
		}
	hsh.insert(pack(q[0]));
	for(;l!=r;(++l)&=MaxL){
		for(int i=0;i<4;i++)
		{
			int x=q[l].x[0]+dx[i],y=q[l].y[0]+dy[i],j;
			if(x<0||x>=n||y<0||y>=m) continue;
			for(j=0;j<len-1;j++) if(x==q[l].x[j]&&y==q[l].y[j]) break;
			if(j<len-1||grid[x][y]=='#') continue;
			if(grid[x][y]=='@'){
				printf("%d\n",q[l].d+1);
				return 0;
			}
			q[r].x[0]=x,q[r].y[0]=y;
			for(j=1;j<len;j++) q[r].x[j]=q[l].x[j-1],q[r].y[j]=q[l].y[j-1];
			q[r].d=q[l].d+1;
			LL w=pack(q[r]);
			if(hsh.count(w)) continue;
			hsh.insert(w),(++r)&=MaxL;
		}
	}
	puts("-1");
	return 0;
}
