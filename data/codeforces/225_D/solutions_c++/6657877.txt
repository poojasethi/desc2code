#include<stdio.h>
#include<string.h>
struct snake{
    int bd[9],h,stp;
}q[1500000],u,v;
char mp[16][16];
int vis[16][16][16][16];
int d[4][2]={{1,0},{0,1},{-1,0},{0,-1}};
int len,head,tail,des,n,m;
int bite(snake& x,int nx,int ny){
    int np=((nx<<4)|ny),i,j;
    int snktl=(x.h-1+len)%len;
    for(i=1,j=(x.h+1)%len;i<len;i++,j=(j+1)%len)//做len-1次，从头移开的
        if(x.bd[j]==np&&j!=snktl)return 1;
    return 0;
}
int bfs(){
    int i,xx,yy,nx,ny,sx,sy;
    while(head<tail){
        u=q[head++];
        xx=u.bd[u.h]>>4;yy=u.bd[u.h]&15;
        for(i=0;i<4;i++){
            nx=xx+d[i][0];ny=yy+d[i][1];
            if(nx<0||nx>=n||ny<0||ny>=m||mp[nx][ny]=='#'||bite(u,nx,ny))continue;
            v=u;
            v.h=(v.h-1+len)%len;/*尾消失，其余接上*/
            v.bd[v.h]=(nx<<4)|ny;
            v.stp++;
            if(v.bd[v.h]==des)return v.stp;
            sx=v.bd[(v.h-1+len)%len]>>4;
            sy=v.bd[(v.h-1+len)%len]&15;
            if(vis[sx][sy][nx][ny])continue;
            vis[sx][sy][nx][ny]=1;
            q[tail++]=v;
        }
    }
    return -1;
}
int main(){
    int i,j,cs=1;
    q[0].h=q[0].stp=0;
    while(~scanf("%d%d",&n,&m)){
        for(i=0;i<n;i++)scanf("%s",mp[i]);
        len=head=0;tail=1;
        memset(vis,0,sizeof(vis));
        for(i=0;i<n;i++)
        for(j=0;j<m;j++){
            if(mp[i][j]=='@')des=((i<<4)|j);
            if(mp[i][j]>'0'&&mp[i][j]<='9'){
                len=len>(mp[i][j]-'0')?len:(mp[i][j]-'0');
                q[0].bd[mp[i][j]-'1']=((i<<4)|j);
                //mp[i][j]='.';
            }
        }
        vis[(q[0].bd[(q[0].h-1+len)%len]>>4)][(q[0].bd[(q[0].h-1+len)%len]&15)][q[0].bd[q[0].h]>>4][q[0].bd[q[0].h]&15]=1;
        //头到尾
        printf("%d\n",bfs());
    }
}
