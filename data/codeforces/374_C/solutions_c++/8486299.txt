#include <cstdio>
#include <cstring>
#include <algorithm>
#include <cstdlib>
#include <cmath>
#include <string>
#define For(i,a,n)  for(int i=(a);i<=(n);i++)
#define Forn(i,a,n) for(int i=(a);i>=(n);i--)
using namespace std;

char s[1005][1005];
int n,m,f[1005][1005],v[1005][1005],id[15];
int dx[4]={-1,1,0,0};
int dy[4]={0,0,-1,1};

void setIO(string a){
	 string in=a+".in",out=a+".out";
	 freopen(in.c_str(),"r",stdin);
	 freopen(out.c_str(),"w",stdout);
}

int dfs(int x,int y){
	if(f[x][y])return f[x][y];
	v[x][y]=1;
	int &res=f[x][y];res=1;
	For(i,0,3){
		int vx=x+dx[i],vy=y+dy[i];
		if(id[s[vx][vy]]!=(id[s[x][y]]&3)+1)continue;
		if(v[vx][vy])return res=-1; 
		int an=dfs(vx,vy);
		if(an<0)return res=-1;
		res=max(res,an+1);
	}v[x][y]=0;
	return res;
}

int main(){
	scanf("%d%d",&n,&m);
	id['D']=1;id['I']=2;id['M']=3;id['A']=4; 
	For(i,1,n) scanf("%s",s[i]+1);
	For(i,1,n) For(j,1,m) 
	if(s[i][j]=='D'){
		int tmp=dfs(i,j);
		if(tmp<0)return puts("Poor Inna!"),0;
	}
	int an=-1;
	For(i,1,n) For(j,1,m) an=max(an,f[i][j]/4);
	if(an<=0)return puts("Poor Dima!"),0;
	printf("%d\n",an);
	return 0;
}
