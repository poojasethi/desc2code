#include<iostream>
#include<vector>
using namespace std;
const char w[]="DIMA";
vector<string> table;
int dx[]={-1,0,1,0},dy[]={0,1,0,-1},n,m;
int dp[1000][1000];
int dfs(int x,int y,int count=1){
    if(count>n*m)return -1;
    if(dp[x][y]>0)return dp[x][y];
    int ret=0;
    for(int i=0;i<4;i++){
        int nx=x+dx[i],ny=y+dy[i];
        if(nx<0||n<=nx||ny<0||m<=ny||table[nx][ny]!=w[count%4])continue;
        int sum=dfs(nx,ny,count+1);
        if(sum==-1)return -1;
        ret=max(ret,sum);
    }
    ret++;
    dp[x][y]=ret;
    return ret;
}
int main(){
    cin>>n>>m;
    for(int i=0;i<n;i++){
        string s;
        cin>>s;
        table.push_back(s);
    }
    int ans=0;
    for(int i=0;i<n;i++){
        for(int j=0;j<m;j++){
            if(table[i][j]!='D')continue;
            int sum=dfs(i,j);
            if(sum==-1){
                cout<<"Poor Inna!"<<endl;
                return 0;
            }
            ans=max(ans,sum);
        }
    }
    if(ans<4)cout<<"Poor Dima!"<<endl;
    else cout<<ans/4<<endl; 
    return 0;
}