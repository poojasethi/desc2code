#include<stdio.h>
#include<string.h>
struct node
{
	int r,right,len,in;
	node* fa,*son[26];
	node(){r=-1;fa=NULL;for(int i=0;i<26;i++)son[i]=NULL;}
}*fir,*last,a[2000001];int sz;
node *q[2000001];
void add(int w)
{
	node *np=&a[++sz];np->len=last->len+1;np->right=1;
	node *p=last;
	for(;p&&!p->son[w];p=p->fa)p->son[w]=np;
	if(!p)np->fa=fir;
	else if(p->len+1==p->son[w]->len)np->fa=p->son[w];
	else
	{
		node *q=p->son[w],*nq=&a[++sz];
		*nq=*q;nq->right=0;q->fa=np->fa=nq;nq->len=p->len+1;
		for(;p&&p->son[w]==q;p=p->fa)p->son[w]=nq;
	}
	last=np;
}
char s[1000010],x[2000100];int n,len;
void makeright()
{
	for(int i=2;i<=sz;i++)a[i].fa->in++;
	int l=0,r=0;
	for(int i=1;i<=sz;i++)if(!a[i].in)q[++r]=&a[i];
	while(l<r)
	{
		node *t=q[++l];if(!t->fa)continue;
		t->fa->right+=t->right;
		if(!--t->fa->in)q[++r]=t->fa;
	}
}
int main()
{
	fir=last=&a[++sz];
	scanf("%s",s+1);len=strlen(s+1);
	for(int i=1;i<=len;i++)add(s[i]-'a');
	makeright();
	scanf("%d",&n);
	while(n--)
	{
		scanf("%s",x+1);
		len=strlen(x+1);
		for(int i=len+1;i<len*2;i++)
			x[i]=x[i-len];
		node *now=fir;int t=0,ans=0;
		for(int i=1;i<len*2;i++)
		{
			if(now->son[x[i]-'a'])now=now->son[x[i]-'a'],++t;
			else 
			{
				while(now&&!now->son[x[i]-'a'])now=now->fa;
				if(!now)now=fir,t=0;
				else t=now->len+1,now=now->son[x[i]-'a'];
			}
			if(t==len)
			{
				if(now->r!=n)
				ans+=now->right,now->r=n;
				if(now->fa->len==t-1)now=now->fa;--t;
			}
		}
		printf("%d\n",ans);
	}
}
