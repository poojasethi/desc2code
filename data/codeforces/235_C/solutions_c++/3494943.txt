#include<cstdio>
#include<cstring>
#include<algorithm>
#define fo(i,a,b) for(i=a;i<=b;++i)
using namespace std;
const int mn=2010000;
char s[mn];
int rt[mn],next[mn][30],sa[mn],len[mn],mark[mn];
int cnt[mn];
int n,tt,ans,col=0;
bool cmp(int i,int j){return len[i]>len[j];}
void build()
{
    int i,j,ne,x,y,la=0;
    fo(i,1,n)
    {
        ne=s[i]-96;
        for(x=la,la=++tt;x&&!next[x][ne];x=rt[x])next[x][ne]=la;
        cnt[la]=1,len[la]=i;
        y=next[x][ne];
        if(!y){next[x][ne]=la,rt[la]=0;continue;}
        if(len[y]==len[x]+1)rt[la]=y;
        else
        {
            len[++tt]=len[x]+1;
            fo(j,0,28)next[tt][j]=next[y][j];
            rt[tt]=rt[y],rt[la]=rt[y]=tt;
            for(;x&&next[x][ne]==y;x=rt[x])next[x][ne]=tt;
            if(next[x][ne]==y)next[x][ne]=tt;
        }
    }
}
int main()
{
    scanf("%s",s+1);
    tt=0;
    n=strlen(s+1);
    build();
    int i,Q;
    fo(i,1,tt)sa[i]=i;
    sort(sa+1,sa+1+tt,cmp);
    cnt[0]=1;
    fo(i,1,tt)cnt[rt[sa[i]]]+=cnt[sa[i]];
    scanf("%d",&Q);
    while(Q--)
    {
        ++col;
        scanf("%s",s+1);
        n=strlen(s+1);
        int ne,l=0,r=0;
        fo(i,1,n)s[n+i]=s[i];
        ans=0;
        fo(i,1,n+n-1)
        {
            ne=s[i]-96;
            for(;r&&next[r][ne]==0;r=rt[r]);
            l=min(l,len[r]);
            if(next[r][ne])r=next[r][ne],++l;
            if(l>=n)
            {
                while(len[rt[r]]>=n)
                    r=rt[r];l=len[r];
                if(mark[r]!=col)
                {
                    ans+=cnt[r];
                    mark[r]=col;
                }
            }
        }
        printf("%d\n",ans);
    }
    return 0;
}