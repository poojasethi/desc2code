#include<stdio.h>
#include<string.h>
#include<queue>
#include<iostream>
#include<string>
#include<algorithm>
using namespace std;

const int maxn=2100000;

int ch[maxn][26],len[maxn],fail[maxn],tail,cnt;
int ind[maxn],vis[maxn],num[maxn];

void ins(int c)
{
	int t=tail;
	tail=++cnt;
	len[cnt]=len[t]+1;

	while(t&&!ch[t][c])ch[t][c]=cnt,t=fail[t];
	if(!t&&!ch[t][c])
	{
		ch[0][c]=cnt;
		fail[cnt]=0;
		return;
	}
	if(len[ch[t][c]]==len[t]+1)
		fail[cnt]=ch[t][c];
	else
	{
		int i=++cnt,j=ch[t][c];
		fail[i]=fail[j],fail[j]=fail[tail]=i;
		len[i]=len[t]+1;
		memcpy(ch[i],ch[j],sizeof(ch[0]));

		for(;t&&ch[t][c]==j;t=fail[t])
			ch[t][c]=i;
		if(ch[0][c]==j)
			ch[0][c]=i;
	}
}
char s[2100000];
int cmp(int a,int b)
{
	return len[a]<len[b];
}
int main()
{

#ifndef ONLINE_JUDGE
    freopen("in.txt", "r", stdin);
    //freopen("out.txt", "w", stdout);
#endif


	scanf("%s",s);
	int n,i,j,l;
	l=strlen(s);
	for(i=0;i<l;i++)
		ins(s[i]-'a');
	for(i=1;i<=cnt;i++)
		ind[i]=i;
	sort(ind+1,ind+1+cnt,cmp);
	while(tail)
		num[tail]=1,tail=fail[tail];
	for(i=cnt;i>=1;i--)
		for(j=0;j<26;j++)
			num[ind[i]]+=num[ch[ind[i]][j]];
	scanf("%d",&n);
	int ii=0;
	while(n--)
	{
		ii++;
		scanf("%s",s);
		l=strlen(s);
		int now=0,ll=0,ans=0;

		//l<<=1;

		for(i=0;i<l;i++)
		{
			while(now&&!ch[now][s[i]-'a'])
				now=fail[now],ll=len[now];
			now=ch[now][s[i]-'a'];
			if(now) ll++;
		}

		for(i=0;i<l;i++)
		{
			while(now&&!ch[now][s[i]-'a'])
				now=fail[now],ll=len[now];
			now=ch[now][s[i]-'a'];
			if(now) ll++;
			while(len[fail[now]]>=l) now=fail[now],ll=len[now];
			if(ll>=l&&vis[now]-ii)
			{
				vis[now]=ii;
				ans+=num[now];
			}
		}
		printf("%d\n",ans);
	}
}
