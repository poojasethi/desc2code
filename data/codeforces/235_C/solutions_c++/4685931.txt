#include<cstdio>
#include<cstring>
#define ll long long
#define maxn 1000050
using namespace std;
struct node{
	int t[27];
	int flag,cnt,f,l;
}nd[3*maxn];
char A[maxn],B[maxn];
int n,len,last,tot;
int i,x,ok,tmp,Q,y;
int s[maxn],rk[6*maxn];
ll ans;
void add(int x)
{
	int p=last; tot++;
	for(nd[tot].l=nd[p].l+1;p && !nd[p].t[x];p=nd[p].f)
		nd[p].t[x]=tot;
	last=tot;
	if (!p) nd[tot].f=1;
	else
		{
			int q=nd[p].t[x];
			if (nd[q].l==nd[p].l+1)
				nd[tot].f=q;
			else
				{
					tot++;
					nd[tot]=nd[q];
					nd[tot].l=nd[p].l+1;
					nd[tot-1].f=nd[q].f=tot;
					for(;p && nd[p].t[x]==q;p=nd[p].f)
						nd[p].t[x]=tot;
				}
		}
}
int main()
{
	//freopen("C.in","r",stdin);
	//freopen("C.out","w",stdout);
	scanf("%s",A); n=strlen(A);
	for(tot=last=1,i=0;i<n;i++) add(A[i]-'a');
	for(x=1,i=0;i<n;x=nd[x].t[A[i]-'a'],i++)
		nd[nd[x].t[A[i]-'a']].cnt++;
	for(i=1;i<=tot;i++) s[nd[i].l]++;
	for(i=1;i<=n;i++) s[i]+=s[i-1];
	for(i=1;i<=tot;i++) rk[s[nd[i].l]--]=i;
	for(i=tot;i>=1;i--){
			x=rk[i];
			nd[nd[x].f].cnt+=nd[x].cnt;
	}
	for(scanf("%d\n",&Q);Q--;){
		ok++,ans=0;
		scanf("%s\n",B);
		len=strlen(B);
		for(i=0;i<len-1;i++)
			B[i+len]=B[i];
		for(tmp=0,x=1,i=0;i<2*len-1;i++){
			if (nd[x].t[B[i]-'a'])
				{
					x=nd[x].t[B[i]-'a'];
					tmp++;
				}else
				{
					for(;x && !nd[x].t[B[i]-'a'];)
						x=nd[x].f;
					if (!x) x=1,tmp=0;
					else{
						tmp=nd[x].l+1;
						x=nd[x].t[B[i]-'a'];
					}
				}
			if (tmp>=len && i>=len-1)
				{
					y=x;
					while (!(nd[nd[y].f].l+1<=len))
						y=nd[y].f;
					if (nd[y].flag!=ok)
						ans+=nd[y].cnt,nd[y].flag=ok;
				}
		}
		printf("%I64d\n",ans);
	}
	return 0;
}
