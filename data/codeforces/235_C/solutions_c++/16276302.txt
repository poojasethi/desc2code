#include<bits/stdc++.h>
using namespace std;

struct sam
{int l,par,sr;
 int ch[27];
};
struct sam b[2000010];

int n,m,nq,tot,last,ans;
int q[2000010],w[2000010],next[1000010];
char a[2000010];

void extend(int x)
{int p,q,np,nq;
 p=last;
 np=++tot;
 b[np].sr=1;
 b[np].l=b[p].l+1;
 last=np;
 while(p && b[p].ch[x]==0)
 {	b[p].ch[x]=np;
 	p=b[p].par;
 }
 if(!p)
 	b[np].par=1;
 else
 {	q=b[p].ch[x];
 	if(b[q].l==b[p].l+1)
	 	b[np].par=q;
	else
	{	nq=++tot;
		b[nq].l=b[p].l+1;
		memcpy(b[nq].ch,b[q].ch,sizeof(b[q].ch));
		b[nq].par=b[q].par;
		b[q].par=b[np].par=nq;
		while(p && b[p].ch[x]==q)
		{	b[p].ch[x]=nq;
			p=b[p].par;
		}
	}	
 }
}

void calc()
{int i,j;
 for(i=1;i<=tot;i++) w[b[i].l]++;
 for(i=1;i<=tot;i++) w[i]+=w[i-1];
 for(i=1;i<=tot;i++) q[w[b[i].l]--]=i;
 for(i=tot;i>=1;i--) b[b[q[i]].par].sr+=b[q[i]].sr;
}

int main()
{int i,j,k,p,l;
 
 scanf("%s",a+1);
 n=strlen(a+1);
 tot=last=1;
 for(i=1;i<=n;i++)
 	extend(a[i]-96);
 calc();	
 scanf("%d",&nq);
 for(i=1;i<=nq;i++)
 {	
 	scanf("%s",a+1);
 	m=strlen(a+1);
 	k=0;
 	next[0]=next[1]=0;
 	for(j=2;j<=m;j++)
 	{	while(k && a[k+1]!=a[j]) k=next[k];
	 	if(a[k+1]==a[j])
		 	next[j]=++k;
		else
			next[j]=k;
	}
	if(m%(m-next[m])!=0) k=2*m-1; else k=m+(m-next[m])-1;
	ans=0;
	p=1;
	l=0;
	for(j=1;j<=k;j++)
	{	if(j>m) a[j]=a[j-m];
		while(p && b[p].ch[a[j]-96]==0) 
		{	p=b[p].par;
			l=min(l,b[p].l);
		}
		if(b[p].ch[a[j]-96])
		{	p=b[p].ch[a[j]-96];
			l++;
		}
		while(b[p].par && b[b[p].par].l>=m) p=b[p].par;
		if(l>=m) ans+=b[p].sr;
	}
	printf("%d\n",ans);
 }
 return 0;
}