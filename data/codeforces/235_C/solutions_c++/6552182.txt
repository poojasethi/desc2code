#include <cstdio>
#include <cstring>
#include <algorithm>
#define MAXN 2000001
using namespace std;
int m,size,last,c[MAXN][27],f[MAXN],l[MAXN],v[MAXN],r[MAXN],d[MAXN],q[MAXN];
char s[MAXN];
void add(int x,int &last) {
    int lastnode=last,newnode=++size;l[newnode]=l[lastnode]+1;r[newnode]=1;
	for (;lastnode && c[lastnode][x]==0;lastnode=f[lastnode]) c[lastnode][x]=newnode;
	if (!lastnode) f[newnode]=1;
	else{
	  int nownode=c[lastnode][x];
	  if (l[lastnode]+1==l[nownode]) f[newnode]=nownode;
	  else{
	    int auxnode=++size;l[auxnode]=l[lastnode]+1;
		for (int i=1;i<=26;i++) c[auxnode][i]=c[nownode][i];
		f[auxnode]=f[nownode];f[nownode]=f[newnode]=auxnode;
		for (;lastnode && c[lastnode][x]==nownode;lastnode=f[lastnode]) c[lastnode][x]=auxnode;
	  }
	}
	last=newnode;
}
void getright() {
    int left=0,right=0;
    for (int i=1;i<=size;i++) d[f[i]]++;
	for (int i=1;i<=size;i++) if (!d[i]) q[++right]=i;
	while (left<right) {
	  left++;r[f[q[left]]]+=r[q[left]];
	  if (!--d[f[q[left]]]) q[++right]=f[q[left]];
	}
}
int main() {
    //freopen("input.txt","r",stdin);
	//freopen("output.txt","w",stdout);
	scanf("%s",s+1);int sLen=strlen(s+1);last=size=1;
	for (int i=1;i<=sLen;i++) add(s[i]-'a'+1,last);
	getright();
	scanf("%d",&m);
	for (int flag=1;flag<=m;flag++) {
	  int ans=0;
	  scanf("%s",s+1);sLen=strlen(s+1);
	  for (int i=1;i<=sLen;i++) s[i+sLen]=s[i];
	  for (int i=1,p=1,tmp=0;i<sLen*2;i++) {
	    if (c[p][s[i]-'a'+1]) p=c[p][s[i]-'a'+1],tmp++;
		else{
		  while (p && !c[p][s[i]-'a'+1]) p=f[p];
		  if (!p) p=1,tmp=0;else tmp=l[p]+1,p=c[p][s[i]-'a'+1];
		}
		while (l[f[p]]+1>sLen) {tmp=l[f[p]]+1;p=f[p];}
		if (tmp>=sLen && v[p]!=flag) {ans+=r[p];v[p]=flag;}
	  }
	  printf("%d\n",ans);
	}
	return 0;
}