#include <cstdio>
#include <cstring>
#include <algorithm>

using namespace std;
const int Maxn=2000005;
char S[Maxn],T[Maxn];
int son[Maxn][26],len[Maxn],fa[Maxn],pre[Maxn];
int n,last,cnt,i,j,k,q,sum,ans,r[Maxn],b[Maxn],t[Maxn];

void add(int x){
  int c = S[x]-'a';
  int np = ++cnt, p = last;
  last = np; len[np] = x;
  for (;p&&son[p][c]==0;p=fa[p]) son[p][c] = np;
  if (!p) fa[np] = 1;
  else
  {
  	int q = son[p][c];
  	if (len[p]+1 == len[q]) fa[np] = q;
  	else
  	{
  	  int nq = ++cnt; len[nq] = len[p]+1;
  	  memcpy(son[nq],son[q],sizeof(son[nq]));
  	  fa[nq] = fa[q]; fa[np] = fa[q] = nq;
  	  for (;p&&son[p][c]==q;p=fa[p]) son[p][c]=nq;
  	}
  }
}

int calc_repetend(){  //计算循环节 
  pre[1] = 0;
  for (int i=2,j=0;i<=n;i++){
  	while (j&&T[j+1]!=T[i]) j=pre[j];
  	if (T[j+1]==T[i]) j++;
  	pre[i] = j;
  }
  int ret = n-pre[n];
  if (n%ret) ret = n;
  return ret;
}

int main(){
  //freopen("235C.in","r",stdin);
  //freopen("235C.out","w",stdout);
  scanf("%s",S+1);
  n = strlen(S+1);
  last = ++cnt;
  for (i=1;i<=n;i++) add(i);
  
  for (i=1,j=1;i<=n;i++)
    j=son[j][S[i]-'a'], r[j]++;
  for (i=1;i<=cnt;i++) b[len[i]]++;
  for (i=1;i<=n;i++) b[i]+=b[i-1];
  for (i=1;i<=cnt;i++) t[b[len[i]]--]=i;
  for (i=cnt;i>0;i--)
  	r[fa[t[i]]] += r[t[i]];
  scanf("%d",&q);
  while (q--){
  	scanf("%s",T+1);
  	n = strlen(T+1);
  	k = calc_repetend();
  	for (i=n+1;i<n+k;i++) T[i]=T[i-n];
  	for (i=1,j=1,sum=0,ans=0;i<n+k;i++){
  	  int c = T[i]-'a';
	  for (;j&&son[j][c]==0;sum=len[j=fa[j]]);
	  if (son[j][c]) j = son[j][c], sum++;
	  if (j==0) j=1;
	  if (i>=n && sum>=n){
	  	while (len[fa[j]]>=n)
	  	  sum = len[j=fa[j]];
	    ans += r[j];
	  }
	}
	printf("%d\n",ans);
  }
  return 0;
}