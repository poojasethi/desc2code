#include<cstdio>
#include<cstring>
#include<vector>
#define N 2000005
using namespace std;vector<int>v[N];
int son[N][26],step[N],used[N],size[N],f[N];
int L,T,m,i,tot,last,p,n;
char a[N];long long ans;
void Insert(int ch){
    int p,q,np=++tot;step[np]=step[last]+1;size[np]++;
    for (p=last;p&&!son[p][ch];p=f[p]) son[p][ch]=np;
    last=np;if (!p) {f[np]=1;return;}
    if (step[q=son[p][ch]]==step[p]+1) {f[np]=q;return;}
    int nq=++tot;step[nq]=step[p]+1;
    memcpy(son[nq],son[q],sizeof(son[q]));
    f[nq]=f[q];f[q]=f[np]=nq;
    for (;p&&son[p][ch]==q;p=f[p]) son[p][ch]=nq;
}
void DFS(int k){
    for (int i=0;i<v[k].size();i++)
        DFS(v[k][i]),size[k]+=size[v[k][i]];
}
int main(){
    scanf("%s",a+1);tot=last=1;
    for (i=1;a[i];i++) 
        Insert(a[i]-'a');
    for (i=2;i<=tot;i++)
        v[f[i]].push_back(i);
    DFS(1);scanf("%d",&m);
    for (T=1;T<=m;T++){
        scanf("%s",a+1);L=ans=0;
        n=strlen(a+1);p=1;
        for (i=1;i<=n<<1;i++){
            if (i>n) a[i]=a[i-n];else a[i]-='a';
            if (son[p][a[i]]) L++,p=son[p][a[i]];
            else {
                for (;p&&!son[p][a[i]];p=f[p]);
                L=0;if (!p) {p=1;continue;}
                L=step[p]+1;p=son[p][a[i]];
          }if (L>=n){
            for (;f[p]&&step[f[p]]>=n;p=f[p]);
            if (used[p]!=T) used[p]=T,ans+=size[p];
          }
      }printf("%I64d\n",ans);
  }
}