#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 2100000
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int a[26],l,fa;
} a[N];
int i,j,k,n,m,t,last;
int fa[N][26],head[N],next[N],s[N],dep[N],F[N];
char p[N];
inline void inc(int l,int A) {
	int np=++t,p,q,r;
	for (p=last;p&&!a[p].a[A];p=a[p].fa) a[p].a[A]=np;
	a[np].l=l; last=np; s[np]=1;
	if (!p) a[np].fa=1;
	else {
		q=a[p].a[A];
		if (a[p].l+1==a[q].l) a[np].fa=q;
		else {
			a[r=++t]=a[q];
			a[q].fa=a[np].fa=r;
			a[r].l=a[p].l+1;
			for (;p&&a[p].a[A]==q;p=a[p].fa) a[p].a[A]=r;
		}
	}
}
void dfs(int x) {
	int v,i;
	for (v=head[x];v;v=next[v]) {
		dep[v]=dep[x]+1;
		fa[v][0]=x;
		For(i,1,25) fa[v][i]=fa[fa[v][i-1]][i-1];
		dfs(v);
		s[x]+=s[v];
	}
}
int main() {
	//freopen("235cc.in","r",stdin);
	scanf("%s",p+1);
	m=strlen(p+1);
	t=last=1;
	For(i,1,m) inc(i,p[i]-'a');
	For(i,2,t) next[i]=head[a[i].fa],head[a[i].fa]=i;
	dfs(1);
	scanf("%d",&n);
	For(k,1,n) {
		scanf("%s",p+1);
		m=strlen(p+1);
		For(i,1,m) p[i+m]=p[i];
		int an=0,w=1,chang=0;
		For(i,1,2*m) {
			int A=p[i]-'a';
			for (;w&&!a[w].a[A];w=a[w].fa);
			chang=min(chang,a[w].l);
			if (!w) {
				w=1; continue;
			}
			w=a[w].a[A]; chang++;
			if (chang<m||i<=m) continue;
			int x=w;
			for (j=24;j>=0;j--) if (a[fa[x][j]].l>=m) x=fa[x][j];
			if (F[x]!=k) F[x]=k,an+=s[x];
		}
		printf("%d\n",an);
	}
	return 0;
}
