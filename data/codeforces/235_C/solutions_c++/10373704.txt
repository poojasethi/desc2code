#include<cstdio>
#include<cstring>
using namespace std;
const int NN=2001111;
int son[NN][26],pre[NN],val[NN],sum[NN],b[NN],f[NN],next[NN];
int m,TTT,last;
char s[NN];
void samadd(int x)
{
	int p=last,end=++TTT;
	last=end;
	val[end]=val[p]+1;
	for (;p!=-1&&!son[p][x];p=pre[p]) son[p][x]=end;
	if (p==-1) {pre[end]=0;return;}
	int q=son[p][x];
	if (val[q]==val[p]+1) {pre[end]=q;return;}
	int nq=++TTT;
	val[nq]=val[p]+1;
	pre[nq]=pre[q];
	pre[q]=pre[end]=nq;
	memcpy(son[nq],son[q],sizeof(son[q]));
	for (;p!=-1&&son[p][x]==q;p=pre[p]) son[p][x]=nq;
}
int main()
{
	scanf("%s\n",s+1);
	int len=strlen(s+1);
	pre[0]=-1;
	int i,j;
	for (i=1;i<=len;i++) samadd(s[i]-'a');
	for (i=1;i<=TTT;i++) sum[val[i]]++;
	for (i=2;i<=len;i++) sum[i]+=sum[i-1];
	for (i=TTT;i;i--) b[sum[val[i]]--]=i;
	int x=son[0][s[1]-'a'];
	for (i=1;i<=len;i++,x=son[x][s[i]-'a']) f[x]=1;
	for (i=TTT;i;i--) f[pre[b[i]]]+=f[b[i]];
	for (scanf("%d",&m);m;m--)
	{
		scanf("%s\n",s+1);
		len=strlen(s+1);
		next[1]=0,j=0;
		for (i=2;i<=len;i++)
		{
			while (s[j+1]!=s[i]&&j) j=next[j];
			if (s[j+1]==s[i]) j++;
			next[i]=j;
		}
		int t=len-next[len];
		if (len%t==0) t=len-next[len];
		else t=len;
		for (i=1;i<t;i++) s[i+len]=s[i];
		int ans=0,x=0,now=0;
		for (i=1;i<=len+t-1;i++)
		{
			int t=s[i]-'a';
			while (pre[x]!=-1&&!son[x][t])
				x=pre[x],now=val[x];
			if (son[x][t]) now++,x=son[x][t];
			if (now>len)
			{
				now--;
				if (val[pre[x]]>=now) x=pre[x];
			}
			if (now==len) ans+=f[x];
		}
		printf("%d\n",ans);
	}
	return 0;
}