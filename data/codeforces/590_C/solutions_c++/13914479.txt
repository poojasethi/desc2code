//shjj-590c

#include <iostream>
#include <cstring>
#include <cstdio>
#include <cstdlib>
#include <queue>

using namespace std;

const int N=1000;
const int tx[4]={0,0,1,-1};
const int ty[4]={1,-1,0,0};
struct Dot{int x,y;};
queue <Dot> Q;
int f[3][N+3][N+3],n,m,ans;
bool vis[N+3][N+3];
char s[N+3][N+3];

void Bfs(int t)
{
	memset(f[t],120,sizeof(f[t]));
	for (int i=1;i<=n;i++)
		for (int j=1;j<=m;j++)
			if (s[i][j]-'1'==t)
			{
				Dot Tmp;Tmp.x=i,Tmp.y=j;
				Q.push(Tmp);
				f[t][i][j]=0;
			}
	for (;Q.size();)
	{
		int x=Q.front().x,y=Q.front().y;Q.pop();
		vis[x][y]=0;
		for (int i=0;i<4;i++)
		{
			int x3=x+tx[i],y3=y+ty[i],ff=f[t][x][y]+(s[x3][y3]=='.');
			if (x3<1||x3>n||y3<1||y3>m||s[x3][y3]=='#'||ff>=f[t][x3][y3]) continue;
			f[t][x3][y3]=ff;
			if (vis[x3][y3]) continue;
			Dot Tmp;Tmp.x=x3,Tmp.y=y3;
			Q.push(Tmp);
			vis[x3][y3]=1;
		}
	}
}

int main()
{
	scanf("%d%d",&n,&m);
	for (int i=1;i<=n;i++) scanf("%s",s[i]+1);
	for (int i=0;i<3;i++) Bfs(i);
	ans=2e9;
	for (int i=1;i<=n;i++)
		for (int j=1;j<=m;j++)
			if (f[0][i][j]<2e9&&f[1][i][j]<2e9&&f[2][i][j]<2e9)
			{
				ans=min(ans,f[0][i][j]+f[1][i][j]+f[2][i][j]-(s[i][j]=='.')*2);
			int xx=1;xx--;
			}
	if (ans<2e9) printf("%d",ans);
	else puts("-1");
}