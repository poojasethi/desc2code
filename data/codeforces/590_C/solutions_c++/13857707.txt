#include <queue>
#include <cstdio>
#define F1(x,y,z) for(int x=y;x<z;x++)
#define MAX 9000005
using namespace std;
int n,m,p,l,y[]={1,2,0};
char x[1005][1005];
int d[3][1005][1005],r[]={MAX,MAX,MAX,MAX};
queue<int> q,w;
int k[]={0,0,1,-1,0,0};
int main(){
	scanf("%d%d",&n,&m);
	F1(a,0,n)scanf("%s",x[a]);
	F1(c,0,3){
		F1(a,0,n)F1(b,0,m)if(x[a][b]==49+c){
			q.push(a);
			w.push(b);
			d[c][a][b]=1;
		}
		while(!q.empty()){
			F1(a,0,4){
				p=q.front()+k[a];
				l=w.front()+k[a+2];
				if(p>=0&&p<n&&l>=0&&l<m&&!d[c][p][l]&&x[p][l]!=35){
					if(x[p][l]==49+y[c]&&x[q.front()][w.front()]==49+c)r[c]=0;
					if(x[p][l]==46){
						d[c][p][l]=d[c][q.front()][w.front()]+1;
						q.push(p);
						w.push(l);
					}
				}
			}
			q.pop();
			w.pop();
		}
	}
	F1(a,0,n)F1(b,0,m){
		F1(c,0,3)if(d[c][a][b]&&d[y[c]][a][b])r[c]=min(r[c],d[c][a][b]+d[y[c]][a][b]-2-1);
		if(d[0][a][b]&&d[1][a][b]&&d[2][a][b])r[3]=min(r[3],d[0][a][b]+d[1][a][b]+d[2][a][b]-3-2);
	}
	F1(a,0,3)if(r[a]!=MAX&&r[y[a]]!=MAX)r[3]=min(r[3],r[a]+r[y[a]]);
	printf("%d\n",r[3]==MAX?-1:r[3]);
	//system("pause");
    return 0;
}
