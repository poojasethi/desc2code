#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<cmath>
#include<iostream>
#include<algorithm>
#include<map>
using namespace std;
int i,j,k,l,n,m,s,an,K,X,tot=1,oo,sum;
const int w[4][2]={{0,-1},{1,0},{0,1},{-1,0}};
const int N=1100;
int f[4][N][N];
char st[N][N];
class arr
{
    public:
        int x,y;
}g[N*N];
void work(int now)
{
    int l=0;
    int r=0;
    memset(f[now],2,sizeof(f[now]));
    for (int i=1;i<=n;i++)
        for (int j=1;j<=m;j++)
        {
            if (st[i][j]=='0'+now)
            g[++r].x=i,g[r].y=j,f[now][i][j]=0;
        }
    while (l!=r)
    {
        l=(l+1)%(N*N);
        int x=g[l].x;
        int y=g[l].y;
        for (int i=0;i<4;i++)
        {
            int xx=x+w[i][0];
            int yy=y+w[i][1];
            if ((xx<1)||(xx>n)||(yy<1)||(yy>m)||(st[xx][yy]=='#')) continue;
            int vv;
            if (st[xx][yy]=='.') vv=1;
            else vv=0;
            if (f[now][x][y]+vv<f[now][xx][yy])
            {
                f[now][xx][yy]=f[now][x][y]+vv;
                r=(r+1)%(N*N);
                g[r].x=xx;
                g[r].y=yy;
            }
        }
    }
}
int main()
{
	scanf("%d%d",&n,&m);
	for (int i=1;i<=n;i++)
	scanf("%s",st[i]+1);
	work(1);work(2);work(3);
    an=n*m+10;    
	for (int i=1;i<=n;i++)
	for (int j=1;j<=m;j++)
	if (st[i][j]!='#')
	{
	    int s=f[1][i][j]+f[2][i][j]+f[3][i][j];
	    if (st[i][j]=='.') s-=2;
        an=min(an,s);
	}
	if (an>n*m) printf("-1\n");
	else printf("%d\n",an);
}