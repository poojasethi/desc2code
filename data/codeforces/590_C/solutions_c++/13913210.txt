#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
struct edge{
	int t,next;
}g[8100001];
char ch;
int dis[1100001],b[1100001],i,j,k,n,m,h[1100001],a[1101][1101],tot,ans,q[1100001],flag;
void addedge(int x,int y){
	g[++tot].t=y;g[tot].next=h[x];h[x]=tot;
}
void bfs(int s){
	int l,r,i,j;
	for (i=1;i<=n*m+3;i++) dis[i]=-1;
	q[1]=s;l=0;r=1;dis[s]=0;
	while (l<r){
		j=q[++l];
		for (i=h[j];i;i=g[i].next)
		 if (dis[g[i].t]==-1){
		 	dis[g[i].t]=dis[j]+1;
			if (b[g[i].t]!=-1)b[g[i].t]+=dis[g[i].t];
			q[++r]=g[i].t;
		 }
	}
	if (dis[n*m+1]==-1||dis[n*m+2]==-1||dis[n*m+3]==-1) flag=0;
	for (i=1;i<=n*m;i++)
	 if (dis[i]==-1) b[i]=-1;
}
int main(){
	scanf("%d%d",&n,&m);tot=0;memset(b,0,sizeof(b));flag=1;
	for (i=1;i<=n;i++)
	 for (j=1;j<=m;j++){
	 	for (ch=getchar();ch<=' ';ch=getchar());
	 	if (ch>='1'&&ch<='3') a[i][j]=n*m+ch-'0';
	 	if (ch=='#') a[i][j]=0;
	 	if (ch=='.') a[i][j]=m*(i-1)+j;
	 }
	for (i=1;i<=n;i++)
	 for (j=1;j<=m;j++)
	  if (a[i][j]){
	  	if (i>1&&a[i-1][j]) addedge(a[i][j],a[i-1][j]);
	  	if (i<n&&a[i+1][j]) addedge(a[i][j],a[i+1][j]);
	  	if (j>1&&a[i][j-1]) addedge(a[i][j],a[i][j-1]);
	  	if (j<m&&a[i][j+1]) addedge(a[i][j],a[i][j+1]);
	  }
	bfs(n*m+1);bfs(n*m+2);bfs(n*m+3);
	if (!flag){
		puts("-1");return 0;
	}
	ans=min(b[n*m+1],min(b[n*m+2],b[n*m+3]));
	for (i=1;i<=n;i++)
	 for (j=1;j<=m;j++)
	  if (a[i][j]&&a[i][j]<=n*m&&b[a[i][j]]!=-1) ans=min(ans,b[a[i][j]]);
	printf("%d\n",ans-2);
	return 0;
}