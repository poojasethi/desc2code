#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int q,w;
char a[1000][1001];
int f[1000][1000][3];
int t,y,d1[1000000],d2[1000000];
void l(int e,int r,int c){
 if(((0<=e)&&(e<q))&&((0<=r)&&(r<w)))
  if(a[e][r]!='#')
   if(f[e][r][y]>c){
    f[e][r][y]=c;
    d1[t]=e;
    d2[t]=r;
    t++;
   }
}
int sch(int y1){
  y=y1;
  int e,r,c,v;
  t=0;
  for(e=0;e<q;e++)
   for(r=0;r<w;r++){
    f[e][r][y]=1<<25;
    if(a[e][r]==y+49){
     f[e][r][y]=0;
     d1[t]=e;
     d2[t]=r;
     t++;
    }
   }
  for(e=0,r=t;e<r;r=t)
   for(;e<r;e++){
    c=d1[e];
    v=d2[e];
    l(c,v+1,f[c][v][y]+1);
    l(c,v-1,f[c][v][y]+1);
    l(c+1,v,f[c][v][y]+1);
    l(c-1,v,f[c][v][y]+1);
   }
}
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int e,r,t,c,ans=1<<25,c12=1<<25,c13=1<<25,c23=1<<25;
  cin>>q>>w;
  for(e=0;e<q;e++)
   scanf("%s",a[e]);
  for(e=0;e<3;e++)
   sch(e);
  for(e=0;e<q;e++)
   for(r=0;r<w;r++){
    c12=min(c12,f[e][r][0]+f[e][r][1]-1);
    c13=min(c13,f[e][r][0]+f[e][r][2]-1);
    c23=min(c23,f[e][r][1]+f[e][r][2]-1);
    ans=min(ans,f[e][r][0]+f[e][r][1]+f[e][r][2]-2);
   }
  ans=min(ans,c12+c13);
  ans=min(ans,c12+c23);
  ans=min(ans,c13+c23);
  /*for(c=0;c<3;c++){
   for(e=0;e<q;e++){
    for(r=0;r<w;r++)
     cout<<f[e][r][c]<<" ";
    cout<<"\n";}
   cout<<"-------\n";
  }*/
  if(ans>(1<<24))
   cout<<-1;
  else
   cout<<ans;
  return 0;
}
