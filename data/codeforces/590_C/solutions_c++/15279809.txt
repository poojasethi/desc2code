#include<cstdio>
#include<algorithm>
#define N 1005
using namespace std;
int X[N*N],Y[N*N],flag[N][N],A[N][N],B[N][N],C[N][N];
int n,m,i,j,ans,T;char a[N][N];
const int INF=5e8;
const int dx[4]={0,0,-1,1};
const int dy[4]={1,-1,0,0};
void work(int f[N][N],int ch){
    int h=0,t=0;++T;
    for (int i=1;i<=n;i++)
        for (int j=1;j<=m;j++)
            if (a[i][j]!=ch+'0') f[i][j]=INF;
            else X[++t]=i,Y[t]=j,f[i][j]=0,flag[i][j]=T;
    while (h<t){
        ++h;int x=X[h],y=Y[h];
        for (int d=0;d<4;d++){
            int xx=x+dx[d],yy=y+dy[d];
            if (xx<1||xx>n||yy<1||yy>m) continue;
            if (flag[xx][yy]==T) continue;
            flag[xx][yy]=T;f[xx][yy]=f[x][y]+1;
            if (a[xx][yy]=='.') X[++t]=xx,Y[t]=yy;
      }
  }int res=0;
    for (int _=1;_<=3;_++)
    if (_!=ch){
        int tmp=INF;
        for (int i=1;i<=n;i++)
            for (int j=1;j<=m;j++)
                if (f[i][j]<INF&&a[i][j]==_+'0')
                    tmp=min(tmp,f[i][j]-1);
        res+=tmp;
    }ans=min(ans,res);
}
int main(){
    scanf("%d%d",&n,&m);
    for (i=1;i<=n;i++)
        scanf("%s",a[i]+1);
    ans=INF;work(A,1);
    work(B,2);work(C,3);
    for (i=1;i<=n;i++)
        for (j=1;j<=m;j++)
            if (a[i][j]=='.') 
                ans=min(ans,A[i][j]+B[i][j]+C[i][j]-2);
    printf("%d\n",ans==INF?-1:ans);
}
