#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define mp make_pair
#define pb push_back
#define pll pair<ll,ll>
#define f first
#define s second
vector< pair< ll, int> >d[100011];
ll ans[100011];
ll func(ll t,ll l,ll tm)
{
    ll ans=l-((t-tm)*(t-tm));
    return ans;
}
int main()
{
    int i,j,n;
    scanf("%d",&n);
    for(i=0; i<n; i++)
    {
        ll a,b;
        scanf("%lld %lld",&a,&b);
        d[b].pb(mp(a,i));
    }
    for(i=0;i<=100000;i++)
        sort(d[i].begin(),d[i].end());
    ll pt=0,tm=0;
    for(i=0;i<n;i++)
    {
        while(pt<=100000&&d[pt].size()==0)
            pt++;
        if(pt>tm)
            tm=pt;
        ll mn=LONG_LONG_MAX;
        int loc=-1,id=1000000000;
        //printf("%lld %lld\n",pt,tm);
        for(int j=pt;j<=min(min(tm,100000LL),pt+320);j++)
        {
            if(d[j].size()==0)
                continue;
            pair< ll ,int> l=d[j][0];
            ll y=func(j,l.f,tm);
            if(y<mn||(y==mn&&l.s<id))
            {
                mn=y;
                loc=j;
                id=l.s;
            }
        }
        assert(loc!=-1);
        //printf("%d\n",loc);
        pair<ll,int>p=d[loc][0];
        d[loc].erase(d[loc].begin());
        ans[p.s]=tm+p.f;
        tm+=p.f;
    //    printf("%lld %d\n",p.f,p.s);
    }
    for(i=0;i<n;i++)
        printf("%lld ",ans[i]);
    return 0;
}
