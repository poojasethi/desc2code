#include<bits/stdc++.h>

using namespace std;

#define sd(x) scanf("%d",&x);
#define slld(x) scanf("%lld",&x);
#define LL long long
#define LD long double
#define PB push_back
#define MP make_pair
#define F first
#define S second
#define Fill(a, b) memset(a, b, sizeof(a))
#define INF 2000000009

typedef pair<int,int> PII;
typedef vector<int> VI;

#define N 100010
#define K 500

queue<PII > qu[N];

pair<PII, int> ar[N],br[N];
long long ans[N];

void solve()
{
    int n;
    sd(n);
    for(int i=0;i<n;i++)
    {
        sd(ar[i].F.F);
        sd(ar[i].S);
        ar[i].F.S = i;
        br[i].F.F = ar[i].F.F;
        br[i].S = ar[i].S;
        br[i].F.S = ar[i].F.S;
    }
    sort(ar,ar+n);
    for(int i=0;i<n;i++)
    {
        qu[ar[i].S].push(ar[i].F);
    }
    int curr = 0,j=0,k,idx = -1;
    LL t = 0,val=0,tmpval;
    pair<LL, LL> now;
    for(int i=0;i<n;i++)
    {
        while(curr < N && qu[curr].empty())
        {
            curr++;
        }
        if(curr >= N)break;
        if(t < curr)t = curr;
        j = curr;
        k=0;
        idx = -1;
        val = INF;
        bool chck ;
        while(j<=t && k < K && j < N)
        {
            if(t > 5*N)chck = true;
            else chck = false;
            if(!qu[j].empty())
            {
                if(chck)
                {
                   now = qu[j].front();
                   idx = now.S;
                   break;
                }
                now = qu[j].front();
                tmpval = (t - j);
                if(tmpval<INF)
                    tmpval *= tmpval;
                tmpval = now.F - tmpval;
                //ŝcout<<j<<" "<<curr<<" "<<idx<<" "<<t<<" "<<tmpval<<endl;
                if(tmpval < val)
                {
                    val = tmpval;
                    idx = now.S;
                }
                else if(tmpval == val && now.S < idx)
                {
                    idx = now.S;
                }
            }
            k++;
            j++;
        }//cout<<j<<" fin "<<curr<<" "<<idx<<" "<<t<<" "<<val<<endl;

        if(idx > -1)
        {
            t += br[idx].F.F;
            ans[idx] = t;
            qu[br[idx].S].pop();
        }
    }
    for(int i=0;i<n;i++)
    {
        cout<<ans[i]<<" ";
    }
    cout<<endl;

}

int main()
{
    int t=1;
    //scanf("%d",&t);
    for(int i=1;i<=t;i++)
    {
        solve();
    }
}
