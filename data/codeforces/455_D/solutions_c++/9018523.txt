#include <iostream>
#include <cstdio>
#include <deque>
using namespace std;
const int sz=360;
deque <int> q[sz];
int a[100100],num[360][100100];
int main()
{
	int n;
	scanf("%d",&n);
	for (int i=0; i<n; i++)
	{
		scanf("%d",&a[i]);
		q[i/sz].push_back(a[i]);
		num[i/sz][a[i]]++;
	}
	int last=0,temp;
	int Q;
	scanf("%d",&Q);
	while (Q--)
	{
		int c,l,r,k;
		scanf("%d",&c);
		scanf("%d%d",&l,&r);
		l=(l+last-1)%n;
		r=(r+last-1)%n;
		if (l>r) swap(l,r);
		int u=l/sz,v=r/sz,x=l%sz,y=r%sz;
		if (c==1)
		{
			if (l==r) continue;
			temp=q[v][y];
			q[v].erase(q[v].begin()+y); num[v][temp]--;
			q[u].insert(q[u].begin()+x,temp); num[u][temp]++;
			temp=q[u].back();
			if (q[u].size()>sz) q[u].pop_back(),num[u][temp]--;
			for (int i=u+1; i<=v; i++)
			{
				q[i].push_front(temp); num[i][temp]++;
				temp=q[i].back();
				if (q[i].size()>sz) q[i].pop_back(),num[i][temp]--;
			}
		}
		else
		{
			scanf("%d",&k);
			k=(k+last-1)%n+1;
			last=0;
			if (u==v)
			{
				int id=(u+v)>>1;
				for (int i=x; i<=y; i++) if (q[id][i]==k) last++;
			}
			else
			{
				for (int i=x; i<q[u].size(); i++) if (q[u][i]==k) last++;
				for (int i=0; i<=y; i++) if (q[v][i]==k) last++;
				for (int i=u+1; i<=v-1; i++) last+=num[i][k];
			}
			printf("%d\n",last);
		}
	}
	return 0;
}