#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<set>
#include<queue>
#include<vector>
#define maxn 101000
using namespace std;
int i,j,k,m,n,l,r,last=0,ty;
deque<int> a[210];
const int P=500;
int c[210][maxn];
void rid(int &l){l=(l+last-1)%n+1;}
int main()
{
  cin>>n;
  memset(c,0,sizeof(c));
  for (i=0;i<n;i++)
  {
    scanf("%d",&k);
    int pa=i/P;
    a[pa].push_back(k);
    c[pa][k]++;
  }
  int q;
  cin>>q;
  while (q--)
  {
    scanf("%d%d%d",&ty,&l,&r);rid(l);rid(r);
    if (l>r)swap(l,r);l--;r--;
    int pl=l/P,posl=l-pl*P;
    int pr=r/P,posr=r-pr*P;
    if (ty==1)
    {

      if (pl==pr)
      {
        int x=a[pr][posr];
        a[pr].erase(a[pr].begin()+posr);
        a[pr].insert(a[pr].begin()+posl,x);
      }
      else
      {
        int x=a[pr][posr];
        a[pr].erase(a[pr].begin()+posr);
        c[pr][x]--;
        a[pl].insert(a[pl].begin()+posl,x);
        c[pl][x]++;
        for (int i=pl;i<pr;i++)
        {
          int y=a[i].back();c[i][y]--;
          a[i].erase(a[i].end()-1);
          a[i+1].push_front(y);c[i+1][y]++;
        }
      }
    }
    else
    {
      scanf("%d",&k);rid(k);
      int cnt=0;
      if (pl==pr)
      {
         for (int i=posl;i<=posr;i++)
         if (a[pl][i]==k)
         cnt++;
      }
      else
      {
         for (int i=posl;i<P;i++) if (a[pl][i]==k)cnt++;
         for (int i=pl+1;i<pr;i++)cnt+=c[i][k];
         for (int i=0;i<=posr;i++)if (a[pr][i]==k)cnt++;
      }
      printf("%d\n",last=cnt);
    }
  }
  //system("pause");
  return 0;
}
