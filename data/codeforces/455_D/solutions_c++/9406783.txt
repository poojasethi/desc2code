#include <iostream>
#include <deque>
#include <cmath>
using namespace std;

int cnt[333][100005],sz,n,m;
deque <int> a[333];
int main()
{
  cin >> n;
  sz = sqrt(n + 0.0) + 1;
  for (int i = 0; i < n; ++i){
      int k;
      cin >> k;
      a[i/sz].push_back(k);
      ++cnt[i/sz][k];}
  cin >> m;
  int ans = 0,t,l,r,L,R;
  for (int i = 1; i <= m; ++i){
      cin >> t >> l >> r;
      l = ( (l + ans - 1) % n ) ;
      r = ( (r + ans - 1) % n ) ;
      if (l > r) swap(l,r);
      L = l / sz; R = r / sz;
      if (t == 1){
            int num = a[R][r % sz];
            a[R].erase(a[R].begin() + r % sz);
            cnt[R][num] --;
            a[L].insert(a[L].begin() + l % sz,num);
            cnt[L][num]++;
            while(L < R){
                    num = a[L].back();
                    a[L].pop_back();
                    cnt[L][num]--;
                    ++L;
                    a[L].push_front(num);
                    cnt[L][num]++;}
           }
      else {
           int x;
           cin >> x;
           x = ( ( x + ans - 1) % n ) + 1;
           ans = 0;
           if (L == R){
                 for (int i = l % sz; i <= r % sz; ++i) 
                  if (a[L][i] == x) ans++;
                  }
           else {
                for (int i = l; ; ++i){
                    if (i / sz != L) break;
                    if (a[L][i % sz] == x) ans ++;}
                for (int i = r; ; -- i){
                    if (i / sz != R) break;
                    if (a[R][i % sz] == x) ans++;}
                while (++L < R){
                      ans += cnt[L][x];}
                      }
                cout << ans << endl;}
                      }
      
            
            
            
//  system("pause");
  return 0;
}
