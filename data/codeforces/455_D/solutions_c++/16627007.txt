#include<bits/stdc++.h>
#include<cstdlib>
using namespace std;
const int mx=(int)1e5+5;
int mp[335][mx],bsiz,L[mx],R[mx],a[mx],st[350],lans,n,m ;
int main(){
	scanf("%d",&n);
	bsiz=pow(n,0.618);
	for(int i=1;i<=n;++i)
	{
		scanf("%d",&a[i]);
		L[i]=i-1;
	    R[i]=i+1;
	    mp[(i-1)/bsiz][a[i]]++;
	}
	L[1]=R[n]=-1;
    for(int i=0;i<=n/bsiz;++i) st[i]=i*bsiz+1;
	int l,r,ll,rr,ty,sl,sr,k;
	scanf("%d",&m);
	for(int i=1;i<=m;++i) 
	{
		scanf("%d%d%d",&ty,&l,&r);
		l=(l+lans-1)%n+1,r=(r+lans-1)%n+1;
		if(l>r) swap(l,r);
		if(ty==1&&l==r) continue;
		sl=(l-1)/bsiz,sr=(r-1)/bsiz;
		ll=st[sl],rr=st[sr];
		l-=bsiz*sl,r-=bsiz*sr;
		for(int j=1;j<l;++j) ll=R[ll];
		for(int j=1;j<r;++j) rr=R[rr]; 
		if(ty==1)
		{
			--mp[sr][a[rr]];
			++mp[sl][a[rr]];
			if(ll==st[sl]) st[sl]=rr;
			for(int j=sr;j>sl;--j){
			 st[j]=L[st[j]];	
			 --mp[j-1][a[st[j]]];
			 ++mp[j][a[st[j]]];	
			}
			R[L[rr]]=R[rr];
			L[R[rr]]=L[rr];
			L[rr]=L[ll];
			R[rr]=ll;
			R[L[ll]]=rr;
			L[ll]=rr;
		}
		else{
			scanf("%d",&k);
			k=(k+lans-1)%n+1;
			lans=0;
			if(sl==sr){
				for(int j=ll;j!=R[rr];j=R[j]) if(a[j]==k) lans++;
			}
			else{
				for(int j=L[st[sl+1]];j!=L[ll];j=L[j]) if(a[j]==k) lans++;
				for(int j=st[sr];j!=R[rr];j=R[j]) if(a[j]==k) lans++;
				for(int j=sl+1;j<sr;++j) lans+=mp[j][k]; 
			}
			printf("%d\n",lans);
		} 
	}
	return 0;
} 

//sthlqquxtnpw