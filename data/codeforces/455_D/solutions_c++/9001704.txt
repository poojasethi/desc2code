#include <stdio.h>
#include <iostream>
#include <cstring>
#include <cmath>
#include <deque>
using namespace std;
deque <int> a[350];
int n,q,sz,v,c[350][100005],f,l,r,fl,fr;
inline void get(int &t){
	t=(t+v-1)%n+1;
}
int main( ){
	scanf("%d",&n);
	sz=(int)sqrt(n);
	for (int i=1,x;i<=n;i++){
		scanf("%d",&x);
		a[(i-1)/sz+1].push_back(x);
		c[(i-1)/sz+1][x]++;
	}
	scanf("%d",&q);
	int x;
	while (q--){
		scanf("%d %d %d",&f,&l,&r);
		get(l),get(r);
		if (l>r) swap(l,r);
		fl=(l-1)/sz+1,fr=(r-1)/sz+1;
		if (f==1){
			if (fl==fr){
				int p=(r-1)%sz;
				x=a[fl][p];
				a[fl].erase(a[fl].begin()+p);
				a[fl].insert(a[fl].begin()+(l-1)%sz,x);
			}
			else{
				for (int i=fl;i<fr;i++){
					x=a[i].back(),a[i].pop_back(),c[i][x]--;
					a[i+1].push_front(x),c[i+1][x]++;
				}
				int p=(r-1)%sz+1;
				x=a[fr][p];
				a[fr].erase(a[fr].begin()+p);
				c[fr][x]--;
				a[fl].insert(a[fl].begin()+(l-1)%sz,x);
				c[fl][x]++;
			}
		}
		else{
			scanf("%d",&x);
			get(x);
			v=0;
			if (fl==fr)
				for (int i=(l-1)%sz;i<=(r-1)%sz;i++)
					v+=(a[fl][i]==x);
			else{
				for (int i=(l-1)%sz;i<sz;i++)
					v+=(a[fl][i]==x);
				for (int i=fl+1;i<fr;i++)
					v+=c[i][x];
				for (int i=0;i<=(r-1)%sz;i++)
					v+=(a[fr][i]==x);
			}
			printf("%d\n",v);
		}
	}
	return 0;
}
