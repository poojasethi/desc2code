#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <algorithm>
#include <vector>
#include <queue>
using namespace std;

int		blk,X,Y,x,y,A,L,R,k,i,n,c[350][100005],ans,j,Q,m;
deque<int>	a[350];

int		work(int x) {return (x-1)/blk;}

int		main(){
    	blk=300;	scanf("%d",&n);
   	 	for (i=1; i<=n; i++)
        	scanf("%d",&A),X=work(i),a[X].push_back(A),c[X][A]++;
    	scanf("%d",&m);
    	for (i=1; i<=m; i++){
        	scanf("%d%d%d",&A,&L,&R); L=(L+ans-1)%n; R=(R+ans-1)%n;
        	if (L>R) swap(L,R); L++; R++;
        	X=work(L); Y=work(R);
        	x=(L-1)%blk; y=(R-1)%blk;
        	if (A==1){
            	for (j=X+1; j<=Y; j++){
                	c[j][a[j-1].back()]++;
                	a[j].push_front(a[j-1].back());
            	}
            	for (j=X; j<Y; j++) {c[j][a[j].back()]--;a[j].pop_back();}
            	if (X!=Y) Q=a[Y][y+1]; else Q=a[Y][y];
            	a[Y].erase(a[Y].begin()+y+(X!=Y)); c[Y][Q]--;
            	a[X].insert(a[X].begin()+x,Q);  c[X][Q]++;
        	} else{
            	scanf("%d",&k); k=(k+ans-1)%n+1; ans=0;
            	for (j=X+1; j<Y; j++) ans+=c[j][k];
            	if (X!=Y) {
            		for (j=x; j<blk; j++) ans+=(a[X][j]==k);
            		for (j=0; j<=y; j++) ans+=(a[Y][j]==k);
				} else
              	for (j=x; j<=y; j++) ans+=(a[X][j]==k);
           	 	printf("%d\n",ans);
        	}
    	}
}