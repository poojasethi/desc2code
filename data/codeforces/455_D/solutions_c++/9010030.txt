#include<iostream>
#include<queue>
#include<cstdlib>
using namespace std;
const int nn=350;
const int mm=100001;
deque<int>q[nn];
int n,m,a,x,l,r,k,la,z1,z2,w1,w2,t;
int num[nn][mm];
int main()
{
    cin>>n;
    for(int i=0;i<n;i++)
    {
        cin>>a;
        q[i/nn].push_back(a);
        num[i/nn][a]++;
    }
    cin>>m;
    for(int i=1;i<=m;i++)
    {
        cin>>x>>l>>r;
        l=(l+la-1)%n;
        r=(r+la-1)%n;
        if(l>r)swap(l,r);
        z1=l/nn;z2=r/nn;
        w1=l%nn;w2=r%nn;
        if(x==1)
        {
            if(l==r)continue;
            t=q[z2][w2];
            q[z2].erase(q[z2].begin()+w2);num[z2][t]--;
            q[z1].insert(q[z1].begin()+w1,t);num[z1][t]++;
            t=q[z1].back();
            if(q[z1].size()>nn)q[z1].pop_back(),num[z1][t]--;
            for(int j=z1+1;j<=z2;j++)
            {
                q[j].push_front(t);num[j][t]++;
                t=q[j].back();
                if(q[j].size()>nn)
                {
                    q[j].pop_back();
                    num[j][t]--;
                }
            }
        }
        else
        {
            cin>>k;
            k=(k+la-1)%n+1;
            la=0;
            if(z1==z2)
            {
                for(int j=w1;j<=w2;j++)la+=(q[z1][j]==k);
            }
            else
            {
                for(int j=w1;j<q[z1].size();j++)la+=(q[z1][j]==k);
                for(int j=0;j<=w2;j++)la+=(q[z2][j]==k);
                for(int j=z1+1;j<z2;j++)la+=num[j][k];
            }
            cout<<la<<endl;
        }
    }
    return 0;
}