#include <bits/stdc++.h>
#define N 350
#define M 100000
#define pb push_back
using namespace std; 
//#define DEBUG
deque<int> que[N]; 
int num[N][M]; 
int main()
{
#ifdef DEBUG
    freopen("cf-455D.in", "r", stdin); 
#endif
    int n = 0, a = 0; 
    ios::sync_with_stdio(false); 
    cin >> n; 
    for (int i = 0; i < n; i++)
    {
		cin >> a; 
		que[i / N].pb(a); 
		num[i / N][a]++; 
    }
    int q = 0, x, l, r, k, u, v, y, z, last = 0, tmp; 
    cin >> q; 
    for (int i = 0; i < q; i++)
    {
		cin >> x >> l >> r; 
		l = (l + last - 1) % n; 
		r = (r + last - 1) % n; 
		if (l > r)
		    swap(l, r); 
		u = l / N; 
		v = r / N; 
		y = l % N; 
		z = r % N; 
		if (x == 1)
		{
		    if (l == r)
				continue; 
		    tmp = que[v][z]; 
		    que[v].erase(que[v].begin() + z); 
		    num[v][tmp]--; 
		    que[u].insert(que[u].begin() + y, tmp); 
		    num[u][tmp]++; 
		    tmp = que[u].back(); 
		    if (que[u].size() > N)
		    {
				que[u].pop_back(); 
				num[u][tmp]--; 
			}
		    for (int i = u + 1; i <= v; i++)
			{
				que[i].push_front(tmp); 
				num[i][tmp]++; 
				tmp = que[i].back(); 
				if (que[i].size() > N)
				{
				    que[i].pop_back(); 
				    num[i][tmp]--; 
				}
		    }
		}
		else
		{
		    cin >> k; 
			k = (k + last - 1) % n + 1; 
		    last = 0; 
		    if (u == v)
		    {
				for (int i = y; i <= z; i++)
				{
					last += (que[u][i] == k); 
				}
			}
		    else
		    {
				for (int i = y; i < que[u].size(); i++)
				{
					last += (que[u][i] == k); 
				}
				for (int i = 0; i <= z; i++)
				{
					last += (que[v][i] == k); 
				}
				for (int i = u + 1; i < v; i++)
				{
				    last += num[i][k]; 
				}
		    }
			cout << last << endl; 
		}
    }
    return 0; 
}
