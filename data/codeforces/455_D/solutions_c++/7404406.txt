#include<cstdio>
#include<cstring>
#include<algorithm>
#include<vector>
#include<map>
#define pb push_back
using namespace std;

const int N=100010;
const int G=300;
const int GC=N/G+10;
const int P=507;
int n,m,c,k,t,l,p,lit,x,y,z,ans;
vector<int> a,v[GC];
void C(int&x){x=(x+ans-1)%n+1;}
int s[GC][N];

void A(int i,int x,int t)
{
	v[i].insert(v[i].begin() + x , t);
	s[i][t]++;
}
void D(int i,int x)
{
	t=v[i][x-1];
	v[i].erase(v[i].begin()+ (x-1));
	s[i][t]--;
}
void R()
{
	for(int i=1;i<=c;i++){for(int k=0;k<v[i].size();k++)s[i][v[i][k]]=0,a.pb(v[i][k]); v[i].clear();}
	for(int id=1,i=0;i<n;i+=G,id++)for(int j=i;j<i+G&&j<n;j++)A(id,v[id].size(),a[j]); a.clear();
}
int S(int x,int k)
{
	int i,j,p,ans=0;
	for(p=0,i=1;p+v[i].size()<x;p+=v[i].size(),i++)	ans+=s[i][k];
    for(j=0;j<x-p;j++)ans+=(v[i][j]==k);
	return ans;
}

int main()
{
	scanf("%d",&n);for(int i=1;i<=n;i++)scanf("%d",&x),a.pb(x);
	c=(n/G)+(n%G>0);R();
	
	for(scanf("%d",&m);m;m--)
	{
		scanf("%d",&z);
		if(z==1)
		{
			scanf("%d%d",&x,&y);C(x);C(y);if(x>y)swap(x,y);
			if(x==y)continue;
			int i,p;
			if(++lit>=G)lit=0,R();
            for(p=0,i=1;p+v[i].size()<y;p+=v[i].size(),i++);	 D(i,y-p);
			for(p=0,i=1;p+v[i].size()<x;p+=v[i].size(),i++);	 A(i,x-p-1,t);	
		}
		else
		{
			scanf("%d%d%d",&x,&y,&k);C(x);C(y);C(k);if(x>y)swap(x,y);
			printf("%d\n",ans=S(y,k)-S(x-1,k));
		}
	}
	return 0;
}
