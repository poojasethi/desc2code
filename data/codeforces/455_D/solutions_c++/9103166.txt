#include <map>
#include <set>
#include <list>
#include <ctime>
#include <cmath>
#include <queue>
#include <stack>
#include <bitset>
#include <vector>
#include <cstdio>
#include <string>
#include <cstring>
#include <sstream>
#include <iomanip>
#include <cstdlib>
#include <iostream>
#include <algorithm>
using namespace std;
deque<int> a[405];
int b[405][100005];
int main ( ) {
    int n,i,j,q,x,l,r,m,u,v,y,z,ans=0,t; 
    scanf("%d",&n);
    for (i=0;i<n;i++) {
		scanf("%d",&x);
		a[i/400].push_back(x); 
		b[i/400][x]++; 
    }
    scanf("%d",&q);
    for (i=0;i<q;i++) {
		scanf("%d%d%d",&x,&l,&r);
		l=(l+ans-1)%n;
		r=(r+ans-1)%n;
		if (l>r) swap(l,r);
		u=l/400;v=r/400;
		y=l%400;z=r%400;
		if (x==1) {
		    if (l==r) continue; 
		    t=a[v][z];
		    a[v].erase(a[v].begin()+z);
		    b[v][t]--;
		    a[u].insert(a[u].begin()+y,t);
		    b[u][t]++;
		    t=a[u].back();
		    if (a[u].size()>400) {
				a[u].pop_back();
				b[u][t]--;
			}
		    for (j=u+1;j<=v;j++) {
				a[j].push_front(t);
				b[j][t]++;
				t=a[j].back();
				if (a[j].size()>400) {
				    a[j].pop_back(); 
				    b[j][t]--; 
				}
		    }
		}
		else {
		    scanf("%d",&m);
			m=(m+ans-1)%n+1;
		    ans=0;
		    if (u==v) {
				for (j=y;j<=z;j++) {
					if (a[u][j]==m) ans++;
				}
			}
		    else {
				for (j=y;j<a[u].size();j++) {
					if (a[u][j]==m) ans++;
				}
				for (j=0;j<=z;j++) {
					if (a[v][j]==m) ans++; 
				}
				for (j=u+1;j<v;j++) ans+=b[j][m]; 
		    }
			printf("%d\n",ans);
		}
    }
    return 0; 
}
/*
Sample test(s)

input

7
6 6 2 7 4 2 5
7
1 3 6
2 2 4 2
2 2 4 7
2 2 2 5
1 2 6
1 1 4
2 1 7 3

output

2
1
0
0

input

8
8 4 2 2 7 7 8 8
8
1 8 8
2 8 1 7
1 8 1
1 7 3
2 8 8 3
1 1 4
1 2 7
1 4 5

output

2
0
*/
