#include<cstring>
#include<cstdlib>
#include<cstdio>
#include<cmath>
#include<iostream>
#include<sstream>
#include<fstream>
#include<algorithm>
#include<map>
#include<functional>
#include<utility>
#include<set>
#include<bitset>
#include<queue>
#include<deque>
#include<string>
#include<vector>
#define rep(i,n) for(int i=0;i<n;i++)
#define pb push_back
#define mp make_pair
#define pf push_front
using namespace std;
typedef long long LL;
typedef pair<int,int> pii;
const int B=400;
deque<int> num[B];
int cnt[B][100005];
int n,la;
void init(){
	scanf("%d",&n);
	rep(i,n){
		int x;
		scanf("%d",&x);
		int ttt=i/B;
		num[ttt].pb(x);
		cnt[ttt][x]++;
	}
}
inline void decode(int &i){
	i=(i+la-1)%n;
}
void slove(){
	int q;
	scanf("%d",&q);
	while(q--){
		int f,l,r;
		scanf("%d%d%d",&f,&l,&r);
		decode(l);
		decode(r);
		if(l>r){
			int ttt;
			ttt=r;
			r=l;
			l=ttt;
		}
		if(f==1){
			int x=l/B,y=r/B,u=l-x*B,v=r-y*B;
			int ttt=num[y][v];
			num[y].erase(num[y].begin()+v);
			cnt[y][ttt]--;
			num[x].insert(num[x].begin()+u,ttt);
			cnt[x][ttt]++;
			for(int i=x;i<y;i++){
				num[i+1].insert(num[i+1].begin(),num[i].back());
				cnt[i+1][num[i].back()]++;
				cnt[i][num[i].back()]--;
				num[i].pop_back();
			}
		}
		else{
			int k,ans=0;
			scanf("%d",&k);
			decode(k);
			k++;
			int x=l/B,y=r/B,u=l-x*B,v=r-y*B;
			if(x==y){
				for(int i=u;i<=v;i++)
					ans+=num[x][i]==k;
				printf("%d\n",ans);
				la=ans;
				continue;
			}
			for(int i=u;i<num[x].size();i++)
				ans+=num[x][i]==k;
			for(int i=x+1;i<y;i++)
				ans+=cnt[i][k];
			rep(i,v+1)
				ans+=num[y][i]==k;
			printf("%d\n",ans);
			la=ans;
		}
	}
	return;
}
int main(){
	init();
	slove();
	return 0;
}
