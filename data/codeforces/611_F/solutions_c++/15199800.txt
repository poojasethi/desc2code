#include<cstdio>
#include<iostream>
#include<string>
#include<cmath>
#include<vector>
#include<queue>
#include<algorithm>
#include<set>
#define ll long long
ll mod=1000000007;
using namespace std;
int main()
{
	ll n;
	ll h,w;
	cin>>n>>h>>w;
	string arr;
	cin>>arr;
	ll ans=0;
	ll x=0, y=0;
	ll mx=0, Mx=0, my=0, My=0;
	ll time=0;
	for(int i=0;i<n;++i)
	{
		if(h==0 || w==0)break;
		if(arr[i]=='R')y++;
		else if(arr[i]=='L')y--;
		else if(arr[i]=='U')x--;
		else x++;
		time++;
		if(x<mx)
		{
			mx=x;
			ans+=w*time;
			h--;
		}
		if(x>Mx)
		{
			Mx=x;
			ans+=w*time;
			h--;
		}
		if(y<my)
		{
			my=y;
			ans+=h*time;
			w--;
		}
		if(y>My)
		{
			My=y;
			ans+=h*time;
			w--;
		}
		ans%=mod;
	}
	if(h==0 || w==0)
	{
		cout<<ans<<endl;
		return 0;
	}
	if(x==0 && y==0)
	{
		cout<<"-1\n";
		return 0;
	}
	time=0;
	int l=0;
	bool hor[500003];
	int tm[500003];
	for(int i=0;i<n;++i)
	{
		if(arr[i]=='R')y++;
		else if(arr[i]=='L')y--;
		else if(arr[i]=='U')x--;
		else x++;
		time++;
		if(x<mx)
		{
			mx=x;
			hor[l]=0;
			tm[l]=time;
			l++;
		}
		if(x>Mx)
		{
			Mx=x;
			hor[l]=0;
			tm[l]=time;
			l++;
		}
		if(y<my)
		{
			my=y;
			tm[l]=time;
			hor[l]=1;
			l++;
		}
		if(y>My)
		{
			My=y;
			tm[l]=time;
			hor[l]=1;
			l++;
		}
		ans%=mod;
	}
	ll i=0, q=0;
	while(h!=0 && w!=0)
	{
		ll time=tm[i] + n + (q/l)*n;
		if(hor[i])
		{
			ans+=h*time;
			w--;
		}
		else
		{
			ans+=w*time;
			h--;
		}
		ans%=mod;
		i++;
		q++;
		i%=l;
	}
	cout<<ans<<endl;
	return 0;
}