#include<bits/stdc++.h>
#define N 500005
using namespace std;
const int P=1e9+7;
map<int,int>X,Y;char s[N];
int n,h,w,dx,dy,ret1,ret2,i,x,y,rest,p,q;
int step,num,mxx,mix,mxy,miy,delta,ans;
long long a[N],b[N],INF=1e18;
int main(){
    scanf("%d%d%d",&n,&h,&w);
    scanf("%s",s+1);
    dx=0;dy=0;mxx=mxy=0;mix=miy=1e9;
    for (i=1;i<=n;i++){
        dx-=(s[i]=='U');dx+=(s[i]=='D');
        dy-=(s[i]=='L');dy+=(s[i]=='R');
        if (X.find(dx)==X.end()) X[dx]=i;
        if (Y.find(dy)==Y.end()) Y[dy]=i;
        mxx=max(mxx,dx);mix=min(mix,dx);
        mxy=max(mxy,dy);miy=min(miy,dy);
  }
    for (x=1;x<=h;x++){
        ret1=X[-x];ret2=X[h-x+1];
        if (ret1&&ret2) {a[x]=min(ret1,ret2);continue;}
        if (!ret1&&ret2||ret1&&!ret2){a[x]=ret1+ret2;continue;}
        if (dx==0){a[x]=INF;continue;}
      step=dx<0?x:h-x+1;
      delta=dx<0?-mix:mxx;
      num=(step-delta-1)/abs(dx)+1;
      rest=step-num*abs(dx);
      if (dx<0) rest*=-1;
      a[x]=X[rest]+1ll*num*n;
  }
    for (y=1;y<=w;y++){
        ret1=Y[-y];ret2=Y[w-y+1];
        if (ret1&&ret2) {b[y]=min(ret1,ret2);continue;}
        if (!ret1&&ret2||ret1&&!ret2) {b[y]=ret1+ret2;continue;}
        if (dy==0) {b[y]=INF;continue;}
        step=dy<0?y:w-y+1;
      delta=dy<0?-miy:mxy;
      num=(step-delta-1)/abs(dy)+1;
      rest=step-num*abs(dy);
      if (dy<0) rest*=-1;
      b[y]=Y[rest]+1ll*num*n;
  }
  sort(a+1,a+h+1);
  sort(b+1,b+w+1);
  if (a[h]==INF&&b[w]==INF) return puts("-1"),0;
  a[h+1]=b[w+1]=INF+1;
  for (p=0,q=0;p<h||q<w;ans%=P)
    if (a[p+1]<=b[q+1]) ans+=1ll*(a[++p]%P)*(w-q)%P;
                                else  ans+=1ll*(b[++q]%P)*(h-p)%P;
  //ans-=1ll*h*w%P;if (ans<0) ans+=P;
  printf("%d\n",ans);
}