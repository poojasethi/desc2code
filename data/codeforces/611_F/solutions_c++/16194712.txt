#include <iostream>
#include <cstring>
#include <cstdio>
using namespace std;
const int N = 510000;
const int mod = 1000000007;
char ch[N];
long long n,r,c,up,rig,lef,sum,down,w,d,tot1,tot2;
long long ans1[N],ans2[N];
int main()
{
	while(~scanf("%lld%lld%lld",&n,&r,&c))
	{
		 scanf("%s",ch);
		 up=rig=lef=down=w=d=sum=tot1=tot2=0;
		 for(int i=0;i<n;i++)
		 {
		 	sum=(sum+r*c)%mod; 
			if(r==0||c==0)break;
		 	if(ch[i]=='R')
		 	{
		 	   	d++;
				if(d>rig)
		 	   	{
		 	   		rig=d;
		 	   		c--;
				}
			}
			else if(ch[i]=='L')
			{
				d--;
				if(d<lef)
				{
					lef=d;
					c--;
				}
			}
			else if(ch[i]=='U')
			{
				w++;
				if(w>up)
				{
					up=w;
					r--;
				}
			}
			else
			{
				w--;
				if(w<down)
				{
					down=w;
					r--;
				}
			}
		 }
//		 cout<<sum<<" ha1"<<endl;
         if(r==0||c==0)
         {
         	printf("%d\n",sum);
         	continue;
		 }
		 for(int i=0;i<n;i++)
		 {
		 	sum=(sum+r*c)%mod; 
			if(r==0||c==0)break;
		 	if(ch[i]=='R')
		 	{
		 	   	d++;
				if(d>rig)
		 	   	{
		 	   		rig=d;
		 	   		c--;
		 	   		ans1[tot1++]=i;
		 	   		ans2[tot2++]=-1;
				}
			}
			else if(ch[i]=='L')
			{
				d--;
				if(d<lef)
				{
					lef=d;
					c--;
					ans1[tot1++]=i;
		 	   		ans2[tot2++]=-1;
				}
			}
			else if(ch[i]=='U')
			{
				w++;
				if(w>up)
				{
					up=w;
					r--;
					ans1[tot1++]=i;
		 	   		ans2[tot2++]=1;
				}
			}
			else
			{
				w--;
				if(w<down)
				{
					down=w;
					r--;
					ans1[tot1++]=i;
		 	   		ans2[tot2++]=1;
				}
			}
		 }
//		 cout<<sum<<" ha2   "<<r<<" "<<c<<endl;
//          cout<<tot1<<endl;
		 if(tot1==0)
		 {
		 	printf("-1\n");
		 	continue;
		 }
		 while(1)
		 {
		 	if(r==0||c==0)break;
		 	for(int i=0;i<tot1;i++)
		 	{
		 		if(i==0) 
				sum=(sum+r*c*(ans1[i]+1))%mod;
				else
				sum=(sum+r*c*(ans1[i]-ans1[i-1]))%mod;
		 		if(ans2[i]==1)r--;
		 		else c--;
		 		if(r==0||c==0)break;
			}
//			cout<<sum<<" "<<r<<" "<<c<<endl;
			if(r==0||c==0)break;
			if(ans1[tot1-1]!=n-1)
			{
				sum=(sum+r*c*(n-1-ans1[tot1-1]))%mod;
			}
		 }
		 printf("%lld\n",sum);
	}
	return 0;
}
				    	 			 	 		 	 	 	  	   	