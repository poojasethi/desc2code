#include<cstdio>
#include<cstring>
#include<algorithm>
#include<iostream>
using namespace std;
typedef long long ll;
const int mm=1000000007;
char ch[610001];
bool flag;
ll tmp,ans,cot;
int tx,ty,i,j,k,len,n,m,a[610001],b[610001][4],t1,t2,n1,m1,x1,x2,y1,y2;
ll calc(ll x,ll v,ll a,ll b,ll vx,ll vy){
	ll t1,t2,k,tl,res=0;
	if (!vx||v<0||v>vx||vx-v+1>a) return 0;
	k=1+(a-(vx-v+1))/vx;
	if (!vy) return b*k%mm;
	if (x>vy) t1=b;else t1=b-(vy-x);
	if (t1<=0) return res%mm;
	if (t1-vy*(k-1)<=0) t2=t1%vy,tl=1+t1/vy;else t2=t1-vy*(k-1),tl=k;
	res=(res+(t1+t2)*tl/2)%mm;
	return res%mm;
}
int main(){
//	freopen("a.in","r",stdin);freopen("a.out","w",stdout);
	scanf("%d%d%d",&len,&n,&m);scanf("%s",ch);memset(b,0,sizeof(b));ans=0;
	for (i=tx=ty=0;i<len;i++){
		if (ch[i]=='U') a[i+1]=0,tx--;
		if (ch[i]=='D') a[i+1]=1,tx++;
		if (ch[i]=='L') a[i+1]=2,ty--;
		if (ch[i]=='R') a[i+1]=3,ty++;
	}
	if (tx>0){
		for (i=1;i<=len;i++)
		 if (a[i]<2) a[i]^=1;
	}else tx=-tx;
	if (ty>0){
		for (i=1;i<=len;i++)
		 if (a[i]>1) a[i]^=1;
	}else ty=-ty;
	for (i=1,t1=t2=0;i<=len;i++){
		for (j=0;j<4;j++) b[i][j]=b[i-1][j];
		if (a[i]<2) t1+=(a[i]?1:-1);else t2+=(a[i]==2?-1:1);
		if (t1>0) b[i][1]=max(b[i][1],t1);else b[i][0]=max(b[i][0],-t1);
		if (t2>0) b[i][3]=max(b[i][3],t2);else b[i][2]=max(b[i][2],-t2);
	}
	n1=n-b[len][0]-b[len][1];m1=m-b[len][2]-b[len][3];
	if (n1>0&&m1>0) flag=1,x1=b[len][0]+1,x2=n-b[len][1],y1=b[len][2]+1,y2=m-b[len][3];else flag=0;
	if (flag&&!tx&&!ty){
		puts("-1");return 0;
	}
	for (t1=n1,t2=m1;flag&&t1>0&&t2>0;t1-=tx,t2-=ty){
		tmp=(ll)t1*(ll)t2%mm;
		ans=(ans+tmp*(ll)len%mm)%mm;
	}
	for (i=1,t1=t2=0;i<=len;i++){
		if (!a[i]){
			t1--;
			if (t1<0&&-t1>b[i-1][0]){
				k=m-b[i][2]-b[i][3];
				if (k>0&&n-b[i][1]>=-t1) ans=(ans+(ll)k*(ll)i%mm)%mm;else continue;
				if (flag) ans=(ans+(ll)i*calc(y1-(b[i][2]+1),x1+t1,n1,m1,tx,ty)%mm)%mm;
			}
		}
		if (a[i]==1){
			t1++;
			if (t1>0&&t1>b[i-1][1]){
				k=m-b[i][2]-b[i][3];
				if (k>0&&b[i][0]+1<=n-t1+1) ans=(ans+(ll)k*(ll)i%mm)%mm;else continue;
				if (flag) ans=(ans+(ll)i*calc(y1-(b[i][2]+1),x1-(n-t1+1),n1,m1,tx,ty)%mm)%mm;
			}
		}
		if (a[i]==2){
			t2--;
			if (t2<0&&-t2>b[i-1][2]){
				k=n-b[i][0]-b[i][1];
				if (k>0&&m-b[i][3]>=-t2) ans=(ans+(ll)k*(ll)i%mm)%mm;else continue;
				if (flag) ans=(ans+(ll)i*calc(x1-(b[i][0]+1),y1+t2,m1,n1,ty,tx)%mm)%mm;
			}
		}
		if (a[i]==3){
			t2++;
			if (t2>0&&t2>b[i-1][3]){
				k=n-b[i][0]-b[i][1];
				if (k>0&&b[i][2]+1<=m-t2+1) ans=(ans+(ll)k*(ll)i%mm)%mm;else continue;
				if (flag) ans=(ans+(ll)i*calc(x1-(b[i][0]+1),y1-(m-t2+1),m1,n1,ty,tx)%mm)%mm;
			}
		}
	}
	cout<<ans<<endl;
	return 0;
}