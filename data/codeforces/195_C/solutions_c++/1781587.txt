#include <cstdio>
#include <algorithm>
#include <string>
#include <iostream>
#include <sstream>
using namespace std;
int main(){
  int n;
  cin >> n;
  cin.ignore();
  string etype("");
  int depth = 0;
  int cnt = 0;
  bool flg = false;
  while(n--){
    string tmp;
    getline(cin,tmp);
    if(tmp.length()==0) continue;
    int m = tmp.length();
    for(int i=0;i<m;++i) if(tmp[i] == '(' || tmp[i] == ')' || tmp[i] == ',') tmp[i] = ' ';
    stringstream ss;
    ss<<tmp;
    string t;
    ss >> t;
    if(t=="try"){
      if(etype!="") ++cnt;
      depth++;
    }
    if(t=="throw"){
      ss >> etype;
    }
    if(t=="catch"){
      string f;
      ss >> f;
      if(etype == f && !cnt && !flg){
	flg = true;
	string output("");
	string g;
	while(ss >> g){
	  output+=g;
	  output+=' ';
	}
	for(int i=1;output[i]!='"';++i){
	  cout<<output[i];
	}
	cout << endl;
      }
      --depth;
      if(etype!="" && cnt) --cnt;
    }
  }
  if(!flg) cout << "Unhandled Exception" << endl;
  return 0;
}
