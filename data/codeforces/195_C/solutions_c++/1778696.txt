
#include <iostream>
#include <string>

using namespace std;

int n,m,S[100001];
string A[100001],s,ss,mess,excep;

int main()
{
    cin>>n; getline(cin,s);
    int i,j;
    S[0]=0;
    for (i=0; i<n; i++){
        getline(cin,s);
        j=0;
        while (j<s.length() && s[j]!='t' && s[j]!='c') j++;
        if (j==s.length()) continue;
        if (s[j]=='t' && s[j+1]=='h') break;
        if (s[j]=='t') {S[0]++; S[S[0]]=1;}
        if (s[j]=='c') S[0]--;
    }
    while (s[j]!='(') j++; j++; while (s[j]==' ') j++;
    excep=""; while (s[j]!=' ' && s[j]!=')') {excep=excep+s[j]; j++;}
    for (i=i+1; i<n; i++){
        getline(cin,s);
        //for (j=1; j<=S[0]; j++) cout<<S[j]<<" "; cout<<endl;
        j=0;
        while (j<s.length() && s[j]!='t' && s[j]!='c') j++;
        if (j==s.length()) continue;
        if (s[j]=='t') {S[0]++; S[S[0]]=0;}
        else {
            while (s[j]!='(') j++; j++; while (s[j]==' ') j++;
            ss=""; while (s[j]!=' ' && s[j]!=',') {ss=ss+s[j]; j++;}
            while (s[j]!='"') j++; j++;
            mess=""; while (s[j]!='"') {mess=mess+s[j]; j++;}
            if (S[S[0]]==1) if (ss==excep) {cout<<mess<<endl; return 0;}
            S[0]--;
        }
    }
    cout<<"Unhandled Exception\n";
    return 0;
}

