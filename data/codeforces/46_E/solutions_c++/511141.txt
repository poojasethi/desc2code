#include <cstdio>
#include <iostream>
#define MAX -1501LL*1501LL*10000LL

using namespace std;
long long sol[2][1501];
int n, m, k;
long long solu = MAX, suma;

int main() {

	scanf("%d%d", &n, &m);
	for (int i = 0; i < n; i++) {
		long long best = MAX;
		for (int jj = 0; jj < m; jj++) {
			int j = (i&1) ? m-1-jj : jj;
			sol[i&1][j] = best;
			if (best < sol[1-(i&1)][j]) best = sol[1-(i&1)][j];
		}
		suma = 0LL;
		for (int j = 0; j < m; suma += k, j++) {
			scanf("%d", &k);
			sol[1&i][j] += suma + k;
			if (i == n-1 && sol[i&1][j] > solu) solu = sol[i&1][j];
		}
	}
	printf("%I64d\n", solu);
	
	return 0;
}
