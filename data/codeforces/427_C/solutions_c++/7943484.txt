#include<bits/stdc++.h>

using namespace std;

#define ll long long

ll n,m,k,i,j,x,y;
vector<ll> t;
ll H[100003];
vector<ll> arr[100003],scc[100003],tarr[100003];
ll val[100030];

void f(ll x,ll k){
	if(H[x])
		return ;

	H[x] = 1;

	scc[k].push_back(x);

	for(ll i=0 ; i<tarr[x].size() ; i++)
		f(tarr[x][i],k);
}

void ts(ll x){
	
	if(H[x])
		return ;

	H[x] = 1;

	for(ll i=0 ; i<arr[x].size() ; i++)
		ts(arr[x][i]);

	t.push_back(x);
}

int main(){

	cin >> n;

	for(i=1 ; i<=n ; i++)
		cin >> val[i];

	cin >> m;

	for(i=0 ; i<m ; i++){
		cin >> x >> y;
		arr[x].push_back(y);
		tarr[y].push_back(x);
	}

	for(i=1 ; i<=n ; i++)
		ts(i);

	reverse(t.begin(),t.end());

	memset(H,0,sizeof H);

	ll s=0;

	for(i=0 ; i<n ; i++)
		if(!H[t[i]]){
			f(t[i],s++);
		}

	long long int ans = 1 , top = 0;

	for(i=0 ; i<s ; i++){
		long long int mn = 10000004400,sa=0;
		for(j=0 ; j<scc[i].size() ; j++){
			if(mn > val[scc[i][j]]){
				mn = val[scc[i][j]];
				sa=0;
			}
			if(mn == val[scc[i][j]])
				sa++;
		}
		top += mn;
		ans *= sa;
		ans %= 1000000007;
	}
	cout << top << ' ' << ans << endl;
}

