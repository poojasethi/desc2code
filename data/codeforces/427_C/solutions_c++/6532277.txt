/*
 * checkpoint.cpp
 *
 *  Created on: May 2, 2014
 *      Author: lily
 */

#include <iostream>
#include <vector>
#define modulo 1000000007;
using namespace std;

int i,j,n,m,x,y,viz[100001],ord[100001],nr=0,l=0;
unsigned long long nrp=1,nregal,d[100001],rez=0;
vector<int> a[100001],at[100001];
vector<int> b[100002];
void dfs(int x)
{
	int i;
	viz[x]=1;
	for(i=0;i<a[x].size();++i)
		if(!viz[a[x][i]])
			dfs(a[x][i]);
	ord[++nr]=x;

}
void dfst(int x)
{
	int i;
	viz[x]=0;
	b[l].push_back(x);
	for(i=0;i<at[x].size();++i)
		if(viz[at[x][i]])
			dfst(at[x][i]);

}
int main()
{
	cin>>n;
	for(i=1;i<=n;++i)
		cin>>d[i];

	cin>>m;
	for(i=1;i<=m;++i)
	{
		cin>>x>>y;
		a[x].push_back(y);
		at[y].push_back(x);
	}

	for(i=1;i<=n;++i)
		if(!viz[i])
			dfs(i);
	for(i=n;i>=1;--i)
		if(viz[ord[i]])
		{
			++l;
			dfst(ord[i]);

		}

	for(i=1;i<=l;++i)
	{
		unsigned long long minim=1000000001;
		for(j=0;j<b[i].size();++j)
			if(d[b[i][j]]<minim)
				minim=d[b[i][j]],nregal=1;
			else
				if(d[b[i][j]]==minim)
					++nregal;

		rez+=minim;
		nrp=(nrp*nregal)%modulo;
	}
	cout<<rez<<" "<<nrp<<"\n";
	return 0;
}
