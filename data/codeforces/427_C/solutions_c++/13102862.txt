//In the Name of God

#include<iostream>
#include<vector>
#include<algorithm>
#define int long long

using namespace std;

const int maxn=100100,M=1e9+7;
int n,m;
int a[maxn],p[maxn];
int ans1=0,ans2=1,c,cnt;
vector<int> A,g[maxn],h[maxn];
bool vis[maxn];

void dfs(int v)
{
  vis[v]=true;
  for(int i=0;i<g[v].size();i++)
    if(!vis[g[v][i]])
      dfs(g[v][i]);
  A.push_back(v);
}

void gfs(int v)
{
  vis[v]=false;
  if(a[v]==c)
    cnt++;
  else if(a[v]<c)
    c=a[v],cnt=1;
  for(int i=0;i<h[v].size();i++)
    if(vis[h[v][i]])
      gfs(h[v][i]);
}

main()
{
  cin>>n;
  for(int i=1;i<=n;i++)
    cin>>a[i];
  cin>>m;
  for(int v,u,i=0;i<m;i++)
    {
      cin>>v>>u;
      g[v].push_back(u);
      h[u].push_back(v);
    }
  for(int i=1;i<=n;i++)
    if(!vis[i])
      dfs(i);
  for(int i=0;i<n;i++)
    p[A[i]]=i;
  for(int i=n-1;i>=0;i--)
    if(vis[A[i]])
      {
	c=1000000100;
	cnt=0;
	gfs(A[i]);
	ans1+=c;
	ans2=(ans2*cnt)%M;
      }
  cout<<ans1<<" "<<ans2<<endl;
  return 0;
}
