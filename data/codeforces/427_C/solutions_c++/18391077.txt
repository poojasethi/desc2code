#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
typedef long long ll;

const int N = 100005;
int n, m, x, y, a[N], idx[N], low[N], dfs = 1, cmp, mn[N], freq[N];
bool vis[N];
vector<int> st, g[N];

void tarjan(int u) {
	idx[u] = low[u] = dfs++;
	vis[u] = 1;
	st.push_back(u);
	for(int i=0 ; i<(int)g[u].size() ; ++i) {
		int v = g[u][i];
		if(idx[v] == 0) tarjan(v);
		if(vis[v]) 	low[u] = min(low[u], low[v]);
	}
	if(low[u] == idx[u])  {
		while(true) {
			int v = st.back();
			low[v] = low[u];
			if(a[v] < mn[cmp]) mn[cmp] = a[v], freq[cmp] = 1;
			else if(a[v] == mn[cmp]) ++freq[cmp];
			st.pop_back();
			vis[v] = 0;
			if(u == v) break;
		}
		++cmp;
	}
}

int main(int argc, char **argv) {
	scanf("%d", &n);
	for(int i=1 ; i<=n ; ++i) scanf("%d", a+i);
	scanf("%d", &m);
	while(m--) {
		scanf("%d%d", &x, &y);
		g[x].push_back(y);
	}
	memset(mn, 127, sizeof mn);
	for(int i=1 ; i<=n ; ++i)
		if(idx[i] == 0) tarjan(i);
	ll ans = 1, cost = 0;
	for(int i=0 ; i<cmp ; ++i) {
		cost += mn[i];
		ans = ans * freq[i] % mod;
	}
	cout<<cost<<" "<<ans<<endl;
	return 0;
}
