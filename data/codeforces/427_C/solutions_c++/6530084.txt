#include<cstdio>
#include<iostream>
#include<cstring>
#include<algorithm>
#include<vector>
using namespace std;
int a[100001],dfn[100001],low[100001],st[100001],stnum=0,num;
long long ans2=1,ans1=0;
bool f[100001];
vector<int>g[100001];

void tarjan(int u)
{
	int v,i;
	long long s=0,max1=-1;
	num++;
	low[u]=dfn[u]=num;
	f[u]=true;
	stnum++;
	st[stnum]=u;
	for(i=0;i<g[u].size();i++)
	{
		v=g[u][i];
		if(!dfn[v])
		{
			tarjan(v);
			low[u]=min(low[u],low[v]);
		}
		else if(f[v])low[u]=min(low[u],dfn[v]);
	}
	if(low[u]==dfn[u])
	{
		while(1)
		{
			v=st[stnum];
			stnum--;
			if(a[v]<max1 || max1==-1)
			{
				max1=a[v];
				s=1;
			}
			else if(a[v]==max1)s++;
			f[v]=false;
			if(v==u)break;
		}
		ans1+=max1;
		ans2=ans2*s%1000000007;
	}
}

int main()
{
	int i,j,k,m,n;
	memset(f,false,sizeof(f));
	memset(dfn,0,sizeof(dfn));
	scanf("%d",&n);
	for(i=1;i<=n;i++)
	{
		scanf("%d",&a[i]);
	}
	scanf("%d",&m);
	for(i=1;i<=m;i++)
	{
		scanf("%d%d",&j,&k);
		g[j].push_back(k);
	}
	for(i=1;i<=n;i++)
	{
		if(!dfn[i])tarjan(i);
	}
	cout<<ans1<<" "<<ans2<<endl;
	return 0;
}
