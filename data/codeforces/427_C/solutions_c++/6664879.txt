#include<cstdio>

const int N=100050,M=300050;

int first[N],next[M],to[M],size;
void put(int x,int y){
  next[++size]=first[x];
  first[x]=size;
  to[size]=y;
}
int c[N];
int n,m;
void upmin(int &v,int x){if(x<v)v=x;}
int dfn[N],low[N],vis[N],tot;
int sta[N],top;
long long mod=1000000007;
long long ans=0,ans1=1;
void dfs(int v){
 // printf("dfs %d\n",v);   
  vis[v]=1;   
  dfn[v]=low[v]=++tot;
  sta[++top]=v;
  for(int k=first[v];k;k=next[k]){
    if(vis[to[k]]==2) continue;      
    if(!vis[to[k]]) dfs(to[k]);
    upmin(low[v],low[to[k]]);
  }
  
  if(dfn[v]==low[v]){
    int M=1<<30,A=0;
    for(;sta[top+1]!=v;top--){
     // printf("%d ",sta[top]);
      vis[sta[top]]=2;                  
      if(c[sta[top]]<M) M=c[sta[top]],A=0;
      if(c[sta[top]]==M) A++;
    }
   // printf("\n");
    ans+=M;
    ans1=(ans1*A)%mod;
  }
}

int main(){
  scanf("%d",&n);
  for(int i=1;i<=n;i++)scanf("%d",&c[i]);
  scanf("%d",&m);
  for(int i=1;i<=m;i++){
    int x,y;scanf("%d%d",&x,&y);
    put(x,y);
  }
  for(int i=1;i<=n;i++)
    if(!dfn[i])dfs(i);
  printf("%I64d %I64d\n",ans,ans1);
  //while(1);
}
