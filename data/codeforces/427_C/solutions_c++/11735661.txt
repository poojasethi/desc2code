#include <cstdio>
#include <iostream>
#include <vector>
#include <stack>
using namespace std;
typedef pair<int,int> ii;

const int MOD=1e9+7;
vector<vector<int> > E;
vector<int> low,num,fre,c;
int cnt=0;
long long ans1=0,ans2=1;
stack<int> s;

void dfs(int u){
	s.push(u);
	low[u]=num[u]=++cnt;
	for(unsigned i=0;i<E[u].size();i++){
		int v=E[u][i];
		if(!fre[v]) continue;
		if(num[v]==0){
			dfs(v);
			if(low[v]<low[u]) low[u]=low[v];
		}
		else if(num[v]<low[u]) low[u]=num[v];
	}
	if(low[u]==num[u]){
		int mi=1e9+1,amin=1,v;
		do {
			v=s.top();
			s.pop();
			fre[v]=false;
			if(c[v]<mi){
				mi=c[v];
				amin=1;
			}
			else if(c[v]==mi) amin++;
		}
		while(v!=u);
		ans1+=mi;
		ans2=(ans2*amin)%MOD;
	}
}

int main(){
	//freopen("input.inp","r",stdin);
	int n,m,a,b;
	scanf("%d",&n);
	E.resize(n);
	num.assign(n,0);
	low.resize(n);
	fre.assign(n,true);
	c.resize(n);
	for(int i=0;i<n;i++) scanf("%d",&c[i]);
	scanf("%d",&m);
	while(m--){
		scanf("%d%d",&a,&b);
		a--;b--;
		E[a].push_back(b);
	}
	for(int i=0;i<n;i++) if(num[i]==0) dfs(i);
	cout << ans1 <<' ' << ans2;
}
	      	    		 		 					 	 		 	