#include<bits/stdc++.h>
using namespace std;
long long x,y,n,mini=1e10,cnt,ans=1,w,a,b;
long long v[300001],z,s,arr[300001],q[300001];
vector<long long> ch1[300001],gr[300001],ch2[100001];
int dfs(int ind,int st){
 v[ind]=st;
 if(!st){
  gr[w].push_back(ind);
  for(int i=0;i<ch2[ind].size();i++){
  if(v[ch2[ind][i]]!=st){
   dfs(ch2[ind][i],st);
  }
 }
 }
 else if(st){
 for(int i=0;i<ch1[ind].size();i++){
  if(v[ch1[ind][i]]!=st){
   dfs(ch1[ind][i],st);
  }
 }
    q[s]=ind;
    s++;
   }
}
int main(){
 cin>>x;
 for(int i=0;i<x;i++){
  cin>>arr[i];
 }
 cin>>y;
 for(int i=0;i<y;i++){
  cin>>a>>b;
  ch1[a-1].push_back(b-1);
  ch2[b-1].push_back(a-1);
 }
 for(int i=0;i<x;i++){
  if(!v[i]){
   dfs(i,1);
  }
 }
 for(int i=s-1;i>=0;i--){
 // cout<<q[i]<<" ";
  if(v[q[i]]){
   //cout<<q[i]<<endl;
   dfs(q[i],0);
   w++;
  }
 }
 for(int i=0;i<w;i++){
  for(int j=0;j<gr[i].size();j++){
   if(arr[gr[i][j]]<mini){
    mini=arr[gr[i][j]];
    n=1;
   }
   else if(arr[gr[i][j]]==mini){
    n++;
   }
  }
  cnt+=mini;
  ans*=n;
  ans%=1000000007;
  mini=1e10;
 }
 cout<<cnt<<" "<<ans<<endl;
}