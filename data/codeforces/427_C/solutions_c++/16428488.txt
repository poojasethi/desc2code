#include <bits/stdc++.h>
#define ii pair<int,int> 
#define ll long long int
#define M 1000000007
using namespace std;
vector<int>v1[100100],v2[100100];
vector<ii>v;
int n,m,x,y,p[100100],vis1[100100],vis2[100100],k=0;
ll mi,cnt,res1=0,res2=1;
void dfs1(int i){
	if(vis1[i])return ;
	vis1[i]=1;
	for(int j=0;j<v1[i].size();j++){
		dfs1(v1[i][j]);
	}
	k++;
	v.push_back(ii(k,i));
}
void dfs2(int i){
	if(vis2[i])return ;
	vis2[i]=1;
	if(mi==p[i])cnt++;
	else if(mi>p[i]){
		cnt=1;
		mi=p[i];
	}
	for(int j=0;j<v2[i].size();j++){
		dfs2(v2[i][j]);
	}
}
int main(){
	cin>>n;
	for(int i=1;i<=n;i++)scanf("%d",&p[i]);
	cin>>m;
	for(int i=1;i<=m;i++){
		scanf("%d%d",&x,&y);
		v1[y].push_back(x);
		v2[x].push_back(y);
	}
	for(int i=1;i<=n;i++){
		if(!vis1[i]){
			dfs1(i);
		}
	}
	sort(v.begin(),v.end());
	for(int i=v.size()-1;i>=0;i--){
		if(!vis2[v[i].second]){
			mi=M;
			cnt=0;
			dfs2(v[i].second);
			res2=(res2*cnt)%M;
			res1+=mi;
		}
	}
	cout<<res1<<" "<<res2<<endl;
}