#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 300010
#define int64 long long
#define mo 1000000007
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,x,y,t,K;
int a[N],b[N],c[N],next[N],head[N],id[N],dfn[N],low[N],ff[N],g[N];
int64 an,re;
inline void add(int x,int y) {
	a[++t]=y,next[t]=head[x],head[x]=t;
}
void tarjan(int x) {
	int v;
	dfn[x]=low[x]=++t; g[++*g]=x;
	for (v=head[x];v;v=next[v])
		if (!dfn[a[v]]) tarjan(a[v]),low[x]=min(low[x],low[a[v]]);
		else if (!ff[a[v]]) low[x]=min(low[x],dfn[a[v]]);
	if (low[x]==dfn[x]) {
		id[x]=++K; ff[x]=1; int s=1,mi=c[x];
		for (;(v=g[*g])!=x;(*g)--) {
			id[v]=K; ff[v]=1;
			if (c[v]<mi) mi=c[v],s=1;
			else s+=mi==c[v];
		}
		an+=mi;
		re=re*s%mo;
		(*g)--;
	}
}
int main() {
	scanf("%d",&n);
	For(i,1,n) scanf("%d",&c[i]);
	scanf("%d",&m);
	For(i,1,m) scanf("%d%d",&x,&y),add(x,y);
	t=0; re=1;
	For(i,1,n) if (!dfn[i]) tarjan(i);
	printf("%I64d %I64d\n",an,re);
	return 0;
}
