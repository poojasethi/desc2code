#include <cstdio>
#include <cstdlib>
#include <algorithm>
#define P 1000000007
using namespace std;

int cnt,Cnt,st_cnt,n,m,x,y;
long long a[100001],ans,Ans,sum[100001],num[100001];
int next[600001],ed[600001],son[100001];
int dfn[100001],low[100001],st[100001],inst[100001];

void add(int x,int y)
{
	next[++cnt]=son[x]; son[x]=cnt; ed[cnt]=y;
}

void dfs(int u)
{
	dfn[u]=low[u]=++cnt;
	st[++st_cnt]=u; inst[u]=1;
	for (int j=son[u];j;j=next[j])
	{
		int v=ed[j];
		if (!dfn[v]) 
		{
			dfs(v);
			low[u]=min(low[v],low[u]);
		}
		if (inst[v]) low[u]=min(low[v],low[u]);
	}
	if (dfn[u]==low[u])
	{
		num[++Cnt]=a[u]; sum[Cnt]=1;
		while (st[st_cnt]!=u)
		{
			inst[st[st_cnt]]=0; 
			long long tmp=a[st[st_cnt]];
			if (tmp<num[Cnt]) num[Cnt]=tmp,sum[Cnt]=1;
			else if (tmp==num[Cnt]) sum[Cnt]++;
			st_cnt--;
		}
		inst[u]=0; st_cnt--;
	}
}

int main()
{
	scanf("%d",&n);
	for (int i=1;i<=n;i++) scanf("%I64d",&a[i]);
	scanf("%d",&m);
	for (int i=1;i<=m;i++) scanf("%d%d",&x,&y),add(x,y);
	for (int i=1;i<=n;i++) if (!dfn[i]) dfs(i);
	Ans=1;
	for (int i=1;i<=Cnt;i++) ans+=num[i],Ans=(Ans*sum[i])%P;
	printf("%I64d %I64d\n",ans,Ans);
}

