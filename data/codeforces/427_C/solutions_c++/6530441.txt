//gskhirtladze

#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <vector>

#define P7 1000000007
#define pb push_back

using namespace std;
 

vector < int > g[300010],v[300010];
int a[300010],nxt11,nxt22,i,j,n,mx;
int nxt2[300010],nxt1[300010];
long long ans,m,now,x,y,res;
bool f[300010];

void go(int u)
 {
  f[u]=1;
  for (int i=0; i<g[u].size(); i++)
   if (!f[g[u][i]]) go(g[u][i]);
  nxt1[nxt11]=u;
  ++nxt11;      
 }
 
void solv(int u)
 {
  f[u]=1;
  nxt2[nxt22]=u;
  nxt22++;
  for (int i=0;i<v[u].size();i++)
   if (!f[v[u][i]]) solv(v[u][i]);
 }
 
main()
 {
  scanf("%d",&n);
  for(i=1;i<=n;i++)
   scanf("%d",&a[i]);
  scanf("%d",&m);
  for(i=1;i<=m;i++)
   {
    scanf("%d%d",&x,&y);
    g[x].pb(y);
    v[y].pb(x);
   }
  for(i=1;i<=n;i++)
   if(!f[i]) go(i);
  for(i=1;i<=n;i++)f[i]=0;
  ans=1;
  for(i=1;i<=n;i++)
   if(!f[nxt1[n-i]]) 
    {
     solv(nxt1[n-i]);
     mx=P7;
     now=0;
     for(j=0;j<nxt22;j++) mx=min(mx,a[nxt2[j]]);
     for(j=0;j<nxt22;j++) if(a[nxt2[j]]==mx)now++;
     res+=mx;
     ans=(ans*now)%P7;
     nxt22=0;
    }
  cout<<res<<" "<<ans<<endl;
  }
