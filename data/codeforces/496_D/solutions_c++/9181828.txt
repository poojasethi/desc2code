#include<iostream>
#include<cstdio>
#include<cmath>
using namespace std;
long a1[100002],a2[100002],b1[100002],b2[100002];
long i,j,t,n,m,ans;

void chk(long x)
{
	long l,r,a,b,sa,sb,fl=-1;
	l=r=0;a=b=sa=sb=0;
	while(r<n)
	{
		r+=x-max(a,b);
		if(r>n) return;
		a=a1[r]-a1[l];
		b=a2[r]-a2[l];
		if(a==x)
		{
			sa++;a=b=0;
			l=r;
			fl=1;
		}
		if(b==x)
		{
			sb++;a=b=0;
			l=r;
			fl=0;
		}
	
	}
	if(a||b) return;
	if(fl&&sa>sb)
	{
		b1[++ans]=sa;
		b2[ans]=x;
	}
	if(!fl&&sa<sb)
	{
		b1[++ans]=sb;
		b2[ans]=x;
	}
}
int main()
{
	ans=0;a1[0]=a2[0]=b1[0]=b2[0]=0;
	scanf("%d",&n);
	for(i=1;i<=n;i++)
	{
		scanf("%d",&t);
		a1[i]=a1[i-1];
		a2[i]=a2[i-1];
		if(t-1) a2[i]++;else a1[i]++;
	}
	for(i=n;i;i--)
		chk(i);
	printf("%d\n",ans);
	for(i=1;i<=ans;i++)
	{
		j=i;
		while(b1[j]==b1[j-1]&&b2[j]<b2[j-1])
		{
			t=b2[j];
			b2[j]=b2[j-1];
			b2[j-1]=t;
		}
	}
	for(i=1;i<=ans;i++) printf("%d %d\n",b1[i],b2[i]);
	return 0;
}
