#include <bits/stdc++.h>
using namespace std;
const int N = 1e5+5;
int a[N],u[N],v[N];
int main(){
	int n,x=0,y=0,i,j,su,sv,l,r,temp,k,bu,bv;
	cin>>n;
	for(i=0;i<n;++i){
		cin>>a[i];
		if(a[i]==1)++x;else ++y;
	}
	if(a[n-1]==2){
		for(i=0;i<n;++i)if(a[i]==1)a[i]=2;else a[i]=1;swap(x,y);
	}
	vector<pair<int,int> >ret;
	if(a[0]==1)++u[0];else ++v[0];
	for(i=1;i<n;++i){
		u[i]=u[i-1],v[i]=v[i-1];
		if(a[i]==1)++u[i];else ++v[i];
	}
	for(i=1;i<=x;++i){
		k=0;
		su=0,sv=0;bool is=1;bu=bv=0;
		while(k<n){
			r = min(n-1,k+2*i-1);
			if(u[r]-bu<i && v[r]-bv<i){is=0;break;}
			temp=r;
			if(u[r]-bu>=i){
				l = lower_bound(u,u+n,bu+i)-u;
				temp = min(l,temp);
			}
			if(v[r]-bv>=i)
				l = lower_bound(v,v+n,bv+i)-v,temp = min(temp,l);
			if(u[temp]-bu==i)++su;
			else ++sv;
			k = temp+1;bu = u[temp];bv= v[temp];
		}
		if(is && su>sv)ret.push_back(make_pair(su,i));
	}
	sort(ret.begin(),ret.end());
	cout<<ret.size()<<endl;
	for(i=0;i<ret.size();++i)
		printf("%d %d\n",ret[i].first,ret[i].second);
}
