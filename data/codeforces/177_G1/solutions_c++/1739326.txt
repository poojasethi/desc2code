#include <map>
#include <cstdio>
#include <string>
#include <cstring>
#include <algorithm>

using namespace std;

#define NN 3000
#define max(a, b) ((a) > (b) ? (a) : (b))

int a[6001], f[3001], n, T, mpNext[6001];
char b[6001][6001], e[6001][6001];
char s[6001], c[6001], tmp[6001];

void preMP(char *x, int m){
  int i=0, j=mpNext[0]=-1;
  while (i<m){
    while (j>-1 && x[i]!=x[j])
      j=mpNext[j];
    mpNext[++i]=++j;
  }
}

int MP(char *x, int m, char *y, int n){
  int i, j, ret=0; i=j=0;
  while (j<n){
    while (i>-1 && x[i]!=y[j])
      i=mpNext[i];
    i++; j++;
    if (i>=m){
      ret++;
      i=mpNext[i];
    }
  }
  return ret;
}

int main(){
    map <string, int> mp;
    scanf("%d%d", &n, &T);
    strcpy(b[0], "a"); strcpy(e[0], "a"); a[0]=1;
    strcpy(b[1], "b"); strcpy(e[1], "b"); a[1]=1;
    for (int i=2; i<n; i++){
        strcpy(b[i], b[i-1]); strcat(b[i], b[i-2]);
        strcpy(e[i], e[i-1]); strcat(e[i], e[i-2]);
        a[i]=a[i-1]+a[i-2];
        if (a[i]>NN){
            b[i][NN]='\0';
            strcpy(e[i], e[i]+(a[i]-NN));
            a[i]=NN;
        }
    }

    while (T--){
        scanf("%s", s);
        string st=s;
        int ans=mp[st];
        if (ans>0) {printf("%d\n", ans-1); continue;}

        int len=strlen(s); preMP(s, len);
        if (strcmp(s, "a")==0) f[0]=1; else f[0]=0;
        if (strcmp(s, "b")==0) f[1]=1; else f[1]=0;
        for (int i=2; i<n; i++){
            if (a[i-1]<len) strcpy(c, e[i-1]);
            else strcpy(c, e[i-1]+a[i-1]-len+1);

            if (a[i-2]<len) strcat(c, b[i-2]);
            else {strcpy(tmp, b[i-2]); tmp[len-1]='\0'; strcat(c, tmp);}
            f[i]=(f[i-1]+f[i-2]+MP(s, strlen(s), c, strlen (c))) % 1000000007;
        }
        mp[st]=f[n-1]+1;
        printf("%d\n", f[n-1]);
    }
    return 0;
}
