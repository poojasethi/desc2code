#include<cstdio>
#include<algorithm>
using namespace std;

const int maxn=2000000+10;
bool flag[maxn];
int son[maxn],lnk[maxn],nxt[maxn];
int que[maxn],A[maxn];
int n,m,limit,cnt,res;

int main()
{
    scanf("%d%d%d",&n,&m,&limit);
    for (int i=1,u,v;i<=m;i++)
    {
        scanf("%d%d",&u,&v);
        lnk[i]=v;nxt[i]=son[u];son[u]=i;
        lnk[i+m]=u;nxt[i+m]=son[v];son[v]=i+m;
    }

    for (int i=1;i<=n;i++)
    if (!flag[i])
    {
        que[1]=i;flag[i]=1;int r=1;
        for (int l=1;l<=r;l++)
        for (int j=son[que[l]];j;j=nxt[j])
        if (!flag[lnk[j]])
        {
            flag[lnk[j]]=1;que[++r]=lnk[j];
        }
        if (r==1 || limit==1) cnt++;
        else A[++A[0]]=min(limit,r);
    }
    while (cnt && A[0]) {cnt--;A[A[0]]--;if (A[A[0]]==1) cnt++,A[0]--;}
    if (limit==1) printf("%d\n",max(0,cnt-2));
    else printf("%d\n", max(0,(cnt+1)/2-1));
}
