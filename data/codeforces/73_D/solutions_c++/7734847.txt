#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 2000010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,x,y,a1,a2,K,an,a3;
int f[N],F[N];
int get(int x) {
	return f[x]==x?x:f[x]=get(f[x]);
}
inline bool ju(int x) {
	if (K==1) return a1+a2<=2;
	int A=a3-(a1-1)*2;
	return a2<=A;
}
int main() {
	scanf("%d%d%d",&n,&m,&K);
	For(i,1,n) f[i]=i;
	For(i,1,m) {
		scanf("%d%d",&x,&y);
		f[get(x)]=get(y);
	}
	For(i,1,n) F[get(i)]++;
	For(i,1,n) if (get(i)==i) {
		if (F[i]>1) a1++,a3+=min(K,F[i]);
		else a2++;
	}
	For(an,0,n) if (ju(an)) {
		printf("%d\n",an);
		return 0;
	} else {
		//printf("%d %d %d\n",an,a1,a2);
		if (a2>1) a2-=2,a1++,a3+=2;
		else a1--;
	}
}

