#include<bits/stdc++.h>
using namespace std;

const int N=1001000;
int p[N];
int f(int x){
    return x==p[x]?x:p[x]=f(p[x]);
}
int sz[N],tot[N];

int main(){
    int n,m,K;
    scanf("%d%d%d",&n,&m,&K);
    for(int i=1;i<=n;i++)p[i]=i;
    for(int i=0;i<m;i++){
        int x,y;
        scanf("%d%d",&x,&y);
        int fx=f(x),fy=f(y);
        if(fx!=fy)p[fx]=fy;
    }
    for(int i=1;i<=n;i++){
        int fi=f(i);
        sz[fi]++;
    }
    int pp=0;
    for(int i=1;i<=n;i++){
        if(sz[i]){
            pp++;
            tot[sz[i]]++;
        }
    }
    if(1==K){
        printf("%d\n",max(pp-2,0));
    }
    else{
        for(int i=2;i<=n;i++){
            if(tot[i]){
                tot[1]-=tot[i]*(min(i,K)-2);
            }
        }
        printf("%d\n",max(0,(tot[1]-1)/2));
    }
    return 0;
}

 		 	   			 	 			   	   				 	