#include<stdio.h>
#include<string.h>
int b[1000001];
int look(int r)
{
	if (b[r]<0)
		return r;
	else
		return b[r]=look(b[r]);
}
int a[1000001];
int main()
{
	int n,k,m,i,x,y,z;
	memset(b,-1,sizeof(b));
	scanf("%d %d %d",&n,&m,&k);
	while (m>0)
	{
		m--;
		scanf("%d %d",&x,&y);
		x--;
		y--;
		x=look(x);
		y=look(y);
		if (x!=y)
		{
			b[y]+=b[x];
			b[x]=y;
		}
	}
	m=0;
	for (i=0;i<n;i++)
	{
		if (b[i]<0)
		{
			a[m]=-b[i];
			m++;
		}
	}
	if (k==1)
	{
		if (m==1)
			printf("0\n");
		else
			printf("%d\n",m-2);
	}
	else
	{
		x=y=0;
		for (i=0;i<m;i++)
		{
			if (a[i]==1)
				x++;
			else if (a[i]<=k)
				y+=a[i]-2;
			else
				y+=k-2;
		}
		y+=2;
		z=0;
		while (1)
		{
			if (x<=y)
				break;
			z++;
			x-=2;
		}
		printf("%d\n",z);
	}
	return 0;
}
