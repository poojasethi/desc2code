#include <cstdio>
#include <iostream>
#include <algorithm>
using namespace std;
const int N=1<<19;
typedef long long LL;
struct T
{
  LL a,b;
  T(){}
  T(LL _a,LL _b):a(_a),b(_b){}
}t[N<<1];
void upd(int s,int e,int d,int i=0,int p=1,int w=N)
{
  T& z=t[p];
  if(s<=i&&e>=i+w)z.a+=d,z.b+=d;
  else
  {
    p<<=1,w>>=1;
    if(s<i+w)upd(s,e,d,i,p,w);
    if(e>i+w)upd(s,e,d,i+w,p+1,w);
    z.b=min(t[p].b,t[p+1].b)+z.a;
  }
}
LL qry(int s,int e,int i=0,int p=1,int w=N)
{
  T& z=t[p];
  if(s<=i&&e>=i+w)return z.b;
  else
  {
    LL v=1LL<<60;
    p<<=1,w>>=1;
    if(s<i+w)v=min(v,qry(s,e,i,p,w)+z.a);
    if(e>i+w)v=min(v,qry(s,e,i+w,p+1,w)+z.a);
    return v;
  }
}
int main()
{
  int n,m;
  scanf("%d",&n);
  for(int i=0,a;i<n&&1==scanf("%d",&a);++i)t[N+i].a=t[N+i].b=a;
  for(int i=N;i-->1;)t[i].b=min(t[i*2].b,t[i*2+1].b);
  scanf("%d",&m);
  char s[1024];
  gets(s);
  for(int i=0,a,b,c;i<m&&NULL!=gets(s);++i)
    if(3==sscanf(s,"%d%d%d",&a,&b,&c))a>b?(upd(0,b+1,c),upd(a,n,c)):upd(a,b+1,c);else cout<<(a>b?(min(qry(0,b+1),qry(a,n))):qry(a,b+1))<<endl;
	return 0;
}

 	  		    	 		  		 	 	 	     		