#include <cstdio>
#include <iostream>

using namespace std;

typedef long long int Lint;

const int MAXN=200020;

int N,M;
Lint ar[MAXN];
Lint seg[MAXN*3];
Lint lazy[MAXN*3];

Lint eval( int k , int b , int e ){
	
	if( b==e )
		return seg[k]=ar[b];
	
	return seg[k]=min(eval(k*2,b,(b+e)/2),eval(k*2+1,(b+e)/2+1,e));
}

Lint inc( int k , int b , int e , int a1 , int a2 , int v ){
	
	if( b>a2 || e<a1 )
		return seg[k]+lazy[k];
	if( b>=a1 && e<=a2 ){
		lazy[k]+=v;
		return seg[k]+lazy[k];
	}
	
	seg[k]=min(inc(k*2,b,(b+e)/2,a1,a2,v),inc(k*2+1,(b+e)/2+1,e,a1,a2,v));
	return seg[k]+lazy[k];
}

Lint query( int k , int b , int e , int a1 , int a2 ){
	
	if( b>a2 || e<a1 )
		return 1e15;
	if( b>=a1 && e<=a2 )
		return seg[k]+lazy[k];
	
	return min(query(k*2,b,(b+e)/2,a1,a2),query(k*2+1,(b+e)/2+1,e,a1,a2))+lazy[k];
}

int main(){
	
	scanf(" %d",&N);
	
	for( int i=1 ; i<=N ; i++ )
		scanf(" %I64d",ar+i);
	
	eval(1,1,N);
	
	Lint c;
	char ch;
	
	scanf(" %d",&M);
	
	for( int a,b,i=0 ; i<M ; i++ ){
		
		scanf(" %d %d%c",&a,&b,&ch);
		a++;
		b++;
		
		if( ch==' ' ){
			scanf(" %I64d",&c);
			if( a>b ){
				inc(1,1,N,a,N,c);
				inc(1,1,N,1,b,c);
			}
			else
				inc(1,1,N,a,b,c);
		}
		else{
			if( a>b )
				printf("%I64d\n",min(query(1,1,N,a,N),query(1,1,N,1,b)));
			else
				printf("%I64d\n",query(1,1,N,a,b));
		}
		
	}
	
	return 0;
}
