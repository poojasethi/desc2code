#include<iostream>
#include<algorithm>
#include<vector>
#include<string>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<sstream>
using namespace std;
#define int long long
const int maxn=2*1000*100*6,inf=1ll<<57;
int n,m,l,r,v,a[maxn],minn[maxn],diff[maxn];
string s;
void diffrent(int cnt){
	diff[2*cnt+1]+=diff[cnt];
	diff[2*cnt]+=diff[cnt];
	minn[2*cnt+1]+=diff[cnt];
	minn[2*cnt]+=diff[cnt];
	diff[cnt]=0;
}
void change(int l,int r,int v,int lo=0,int hi=n-1,int cnt=1){
	if(hi<l||r<lo)
		return;
	if(l<=lo&&hi<=r){
		minn[cnt]+=v;
		diff[cnt]+=v;
		return;
	}
	diffrent(cnt);
	int med=(lo+hi)/2;
	change(l,r,v,lo,med,2*cnt);
	change(l,r,v,med+1,hi,2*cnt+1);
	minn[cnt]=min(minn[2*cnt],minn[2*cnt+1]);
}
int mi(int l,int r,int lo=0,int hi=n-1,int cnt=1){
	if(hi<l||r<lo)
		return inf;
	if(l<=lo&&hi<=r)
		return minn[cnt];
	diffrent(cnt);
	int med=(lo+hi)/2;
	return min(mi(l,r,lo,med,2*cnt),mi(l,r,med+1,hi,2*cnt+1));
}
main(){
	ios::sync_with_stdio(false);
	cin>>n;
	for(int i=0;i<n;i++){
		cin>>a[i];
		change(i,i,a[i]);
	}
	cin>>m;
	getline(cin,s);
	while(m--){
		int tt=1;
		getline(cin,s);
		stringstream ss(s);
		for(int i=s.size()-1;i>=0;i--)
			if(s[i]==' ')
				tt++;
		if(tt==3){
			ss>>l>>r>>v;
			if(l<=r)
				change(l,r,v);
			else
				change(l,n-1,v),change(0,r,v);
		}
		else{
			ss>>l>>r;
			if(l<=r)
				cout<<mi(l,r)<<endl;
			else
				cout<<min(mi(l,n-1),mi(0,r))<<endl;
		}
	}
	return 0;
}
