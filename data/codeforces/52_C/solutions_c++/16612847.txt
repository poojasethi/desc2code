#include <bits/stdc++.h>
using namespace std;

#define ll long long

int N, V[1<<18], t[1<<19], l[1<<19], Q, A, B, X, a, i;

int f(int i, int a, int b) {
	if (a == b - 1) t[i] = V[a];
	else t[i] = min(f(2 * i, a, (a + b) / 2), f(2 * i + 1, (a + b) / 2, b));
	return t[i];
}

ll q(int i, int a, int b, int x, int y) {
	if (x >= b || y <= a) return 1e15;
	if (l[i]) {
		t[i] += l[i];
		if (a != b - 1) l[2 * i] += l[i], l[2 * i + 1] += l[i];
		l[i] = 0;
	}
	if (x <= a && y >= b) return t[i];
	return min(q(2 * i, a, (a + b) / 2, x, y), q(2 * i + 1, (a + b) / 2, b, x, y));
}

int u(int i, int a, int b, int x, int y, int v) {
	if (l[i]) {
		t[i] += l[i];
		if (a != b - 1) l[2 * i] += l[i], l[2 * i + 1] += l[i];
		l[i] = 0;
	}
	if (x >= b || y <= a) return t[i];
	if (x <= a && y >= b) {
		t[i] += v;
		if (a != b - 1) l[2 * i] += v, l[2 * i + 1] += v;
	} else t[i] = min(u(2 * i, a, (a + b) / 2, x, y, v), u(2 * i + 1, (a + b) / 2, b, x, y, v));
	return t[i];
}

int main() {
	for (scanf("%d", &N); i < N; i++) scanf("%d", &V[i]);
	for (f(1, 0, N), scanf("%d", &Q); Q--;) {
		scanf("%d%d", &A, &B);
		if (getchar() == ' ') {
			scanf("%d", &X);
			if (A > B) {
				u(1, 0, N, A, N, X);
				u(1, 0, N, 0, B + 1, X);
			} else u(1, 0, N, A, B + 1, X);
		} else {
			if (A > B) printf("%I64d\n", min(q(1, 0, N, A, N), q(1, 0, N, 0, B + 1)));
			else printf("%I64d\n", q(1, 0, N, A, B + 1));
		}
	}
}
