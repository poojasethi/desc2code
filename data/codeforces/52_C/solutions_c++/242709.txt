#include <cstdio>
#include <cstring>
#include <cstdlib>
#include <string>
#include <sstream>
#include <algorithm>

using namespace std;

const int MAX=200005;
const int oo=0x3f3f3f3f;
struct Node{
	int l,r,mi,del;
}seg[MAX<<2];
int val[MAX];

void init(const int& k,const int& l,const int& r){
	seg[k].l=l;
	seg[k].r=r;
	seg[k].del=0;
	seg[k].mi=0;
	if(l==r){
		return;
	}
	int mid=(l+r)>>1;
	init(k<<1,l,mid);
	init(k<<1|1,mid+1,r);
}

void set(const int& k,const int& a,const int& b,const int& v){
	if(seg[k].l>b||seg[k].r<a){
		return;
	}
	if(seg[k].l>=a&&seg[k].r<=b){
		seg[k].del+=v;
		seg[k].mi+=v;
		return;
	}
	set(k<<1,a,b,v);
	set(k<<1|1,a,b,v);
	seg[k].mi=min(seg[k<<1].mi,seg[k<<1|1].mi)+seg[k].del;
}

int read(const int& k,const int& a,const int& b){
	if(seg[k].l>b||seg[k].r<a) return oo;
	if(seg[k].l>=a&&seg[k].r<=b) return seg[k].mi;
	return min(read(k<<1,a,b),read(k<<1|1,a,b))+seg[k].del;
}

int main(){
	int n,m,top;
	int op[5];
	char str[1000];
	string s;
	
	scanf("%d",&n);
	init(1,0,n-1);
	for(int i=0;i<n;i++){
		scanf("%d",&val[i]);
		set(1,i,i,val[i]);
	}
	
	scanf("%d",&m);
	gets(str);
	while(m--){
		gets(str);
		s=str;
		istringstream is(s);
		top=0;
		while(is>>op[top]) top++;
		if(top==2){
			if(op[0]<=op[1]){
				printf("%d\n",read(1,op[0],op[1]));
			}else{
				printf("%d\n",min(read(1,op[0],n-1),read(1,0,op[1])));
			}
		}else{
			if(op[0]<=op[1]){
				set(1,op[0],op[1],op[2]);
			}else{
				set(1,op[0],n-1,op[2]);
				set(1,0,op[1],op[2]);
			}
		}
	}
	
	return 0;
}
