#include <iostream>
#include <cstdio>
#include <sstream>
using namespace std;
typedef long long Int;
#define N (1<<18)
#define INF (1ll<<50)
Int seg[2*N], mseg[2*N];

Int add(Int l,Int r,Int v,Int k=1,Int a=1,Int b=N){
    if(l <= a && b <= r){ seg[k] += v; return mseg[k] + seg[k]; }
    if(b < l || a > r) return mseg[k] + seg[k];
    return seg[k] + (mseg[k]=min(add(l,min(r,(a+b)/2),v,k*2,a,(a+b)/2) , add(max(l,(a+b+1)/2),r,v,k*2+1,(a+b+1)/2,b)));
}

Int getMin(int l,int r,int k=1,int a=1,int b=N){
    if(l <= a && b <= r){ return seg[k] + mseg[k]; }
    if(r < a || l > b) return INF;
    return min( getMin(l,min((a+b)/2,r),k*2,a,(a+b)/2) , getMin(max((a+b+1)/2,l),r,k*2+1,(a+b+1)/2,b) ) + seg[k];
}



int main(){
    int n,Q; scanf("%d\n",&n);
    for(int i = 1 ; i <= n ; i++){
        int a;scanf("%d",&a);
        add(i,i,a);
        
    }
    scanf("%d\n",&Q);
    for(int i = 0 ; i < Q ; i++){
        string str; getline(cin,str);
        stringstream ss(str);
        int a,b,c;
        if(ss >> a >> b >> c){
            //cout << "ADD" << endl;
            a++,b++;
            if(a>b) add(a,n,c) , add(1,b,c);
            else add(a,b,c);
        }else{
            a++,b++;
            if(a>b) cout << min(getMin(a,n),getMin(1,b)) << endl;
            else cout << getMin(a,b) << endl;
        }
    }
}
