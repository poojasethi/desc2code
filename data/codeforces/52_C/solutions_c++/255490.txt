#include <iostream>
#include <cstdio>
#include <vector>
#include <set>
#include <string>
#include <string.h>
#include <algorithm>
#include <sstream>
using namespace std;

const int inf = 1<<30;
int n, m, a, b, c;
char query[300];
int add[1<<19], mn[1<<19];

int find_min(int ind, int l, int r, int a, int b){
	if(b<l || a>r) return inf;
	if(a<=l && b>=r) return mn[ind];
	int m = (l+r)/2;
	return min(find_min(2*ind, l, m, a, b), find_min(2*ind+1, m+1, r, a, b)) + add[ind];
}

void add_elem(int ind, int l, int r, int a, int b, int x){
	if(b<l || a>r) return;
	if(a<=l && b>=r){
		mn[ind]+=x;
		add[ind]+=x;
		return;
	}
	int m=(l+r)/2;
	add_elem(2*ind, l, m, a, b, x);
	add_elem(2*ind+1, m+1, r, a, b, x);

	mn[ind] = min(mn[2*ind], mn[2*ind+1]) + add[ind];
}

int main()
{
#ifdef _DEBUG
	freopen("input.txt","r",stdin);
#endif
	scanf("%d\n", &n);
	for(int i=0; i<n; i++){
		int x;
		cin>>x;
		add_elem(1, 1, n, i+1, i+1, x);
	}
	scanf("%d\n", &m);
	while(m--){
		gets(query);
		stringstream in(query);
		in>>a>>b;
		a++; b++;
		if (in>>c){
			if (a<=b) add_elem(1,1,n,a,b,c);
			else{
				add_elem(1,1,n,1,b,c);
				add_elem(1,1,n,a,n,c);
			}
		}
		else{
			if (a<=b)
				cout<<find_min(1,1,n,a,b);
			else
				cout<<min(find_min(1,1,n,1,b), find_min(1,1,n,a,n));
			cout<<'\n';
		}
	}
	return 0;
}