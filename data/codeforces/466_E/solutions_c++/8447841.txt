#include <cstdio>
#include <cstring>
#define MAXN 100100
int f[MAXN],p[MAXN],bf[MAXN],bo[MAXN];
int Find(int x){return f[x]==x ? x : (f[x]=Find(f[x]));}
void Merge(int x,int y){
    p[x]=y;
    f[x]=Find(y);
}
int main(){
    int t,n,m,q,a,b,k=0;
    scanf("%d%d",&n,&m);
    for(t=1;t<=n;++t) f[t]=t;
    while(m--){
        scanf("%d",&q);
        if(q==1){
            scanf("%d%d",&a,&b);
            Merge(a,b);
        }else if(q==2){
            scanf("%d",&a);
            bo[++k]=a;
            bf[k]=Find(a);
        }else{
            scanf("%d%d",&a,&b);
            t=bo[b];
            while(t!=bf[b]&&t!=a) t=p[t];
            if(t==a) puts("YES");
            else puts("NO");
        }
    }
    return 0;
}
	   					 			  			     	 	  	 	