#include <iostream>
#include <fstream>
#include <algorithm>
#include <cstdio>
#include <cstring>
#include <cmath>
#include <string>
#include <vector>
#include <deque>
#include <queue>
#include <set>
#include <map>
#include <cassert>

#define FOR(i,n) for(int i=0,_n=n;i<_n;i++)
#define FORR(i,s,n) for(int i=s,_n=n;i<_n;i++)
#define mp make_pair
#define pb push_back
#define pii pair<int,int>
#define pli pair<ll,int>
#define vi vector<int>
#define fs first
#define sec second

#define maxn 100002

using namespace std;
typedef long long ll;

const ll MOD = 1000000007LL;

int doc[maxn][2];
int p[maxn][2];

bool f(int poz, int d){
	int t = doc[d][0];
	while(t!=-1){
		if(poz==t)return 1;
		if(p[t][1]>doc[d][1])return 0;
		t = p[t][0];
	}
	return 0;
}

int main(){
	int n,m;
	scanf("%d%d",&n,&m);
	memset(doc,-1,sizeof(doc));
	memset(p,-1,sizeof(p));
	int st_d=1;
	FORR(i,1,m+1){
		int t;
		scanf("%d",&t);
		if(t==1){
			int a,b;
			scanf("%d%d",&a,&b);
			p[a][0]=b;
			p[a][1]=i;
			continue;
		}
		if(t==2){
			int a;
			scanf("%d",&a);
			doc[st_d][0]=a;
			doc[st_d++][1]=i;
		}
		if(t==3){
			int a,b;
			scanf("%d%d",&a,&b);
			if(f(a,b))cout << "YES\n";
			else cout << "NO\n";
		}
	}
	return 0;
}
