#include <iostream>
#include <cstdio>
using namespace std;
int father[100010][2];
int doc[100010][2];

bool sign(int node, int docu)
{
    int a=doc[docu][0];
    int time=doc[docu][1];
    while(father[a][0]!=0 && time>father[a][1])
    {
        if(node==a)
            return true;
        a=father[a][0]; 
    }
    if(node==a)
        return true;
    return false;   
}

int main() {
    int n,m,t,x,y,d=0;
    scanf("%d%d",&n,&m);
    for(int i=1;i<=m;i++)
    {
        scanf("%d",&t);
        if(t==1)
        {
            scanf("%d%d",&x,&y);
            father[x][0]=y;
            father[x][1]=i;
        }
        else if(t==2)
        {
            d++;
            scanf("%d",&x);
            doc[d][0]=x;
            doc[d][1]=i;
        }
        else
        {
            scanf("%d%d",&x,&y);
            if(doc[y][0]==0)
                printf("NO\n");
            else if(sign(x,y))
                printf("YES\n");
            else
                printf("NO\n");
        }
    }
    return 0;
}