#include <iostream>
#include <cstdlib>
#include <algorithm>
#include <vector>
#include <map>
#include <stack>
#include <queue>
#include <limits>
#include <set>
#include <cmath>
#include <iomanip>

using namespace std;
#define pb push_back
#define MAXN 100001
/*#include <fstream>
ifstream fin("input.txt");
ofstream fout("output.txt");*/

pair<int,int> boss[MAXN],pacco[MAXN];
int N,M,op,A,B,conta;

bool dfs(int v,int t)
{
    //cout<<"V: "<<v<<" t: "<<t;
    if(v==A) return true;
    if(boss[v].first==0 || boss[v].second>t) return false;
    return dfs(boss[v].first,t);
}
int main()
{
    ios_base::sync_with_stdio(false);
    cin>>N>>M;
    conta=1;
    for(int i=0;i<M;++i)
    {
        cin>>op;
        if(op==1)
        {
            cin>>A>>B;
            boss[A]=make_pair(B,i);
        }
        else if(op==2)
        {
            cin>>A;
            pacco[conta]=make_pair(A,i);
            conta++;
        }
        else
        {
            cin>>A>>B;

            int x=pacco[B].first,y=pacco[B].second;

            while(x!=0)
            {
                if(x==A) break;
                if(boss[x].second>y) break;
                x=boss[x].first;

            }

            if(x==A) cout<<"YES\n";
            else cout<<"NO\n";
        }
    }

    return 0;
}
