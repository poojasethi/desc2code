#include <iostream>
#include <vector>
#include <algorithm>
#include <set>
#include <string.h>
#include <cstdio>

using namespace std;

#define MAXN 100001

int boss[MAXN], date[MAXN], doc[MAXN], rec[MAXN];

int main(int argc, char *argv[]) {
	int n, m, t, x, y, d, a, b;
	vector<pair<int,int> > query;
	
	cin >> n >> m;
	
	d = 1;
	
	for(int i = 1; i <= n; ++i)
		boss[i] = -1;
	
	for(int i = 0; i < m; ++i) {
		cin >> t;
		switch(t) {
		case 1:
			cin >> x >> y;
			boss[x] = y;
			date[x] = i;
			break;
		case 2:
			cin >> x;
			doc[d] = x;
			rec[d++] = i;
			break;
		case 3:
			cin >> x >> y;
			query.push_back(make_pair(x, y));
		}
	}
	
	for(int i = 0; i < query.size(); ++i) {
		a = doc[query[i].second];
		b = query[i].first;
		while(a != -1 && a != b && date[a] < rec[query[i].second]) {
			a = boss[a];
		}
		if(a == b)
			cout << "YES";
		else
			cout << "NO";
		cout << endl;
	}
	
	return 0;
}

