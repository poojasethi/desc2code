#include <cstdio>
#include <iostream>
#include <algorithm>
#include <vector>
#include <queue>
using namespace std;

int n, m, docCount = 0;
pair<int, int> doc [100005], mas[100005];
long long sum = 0;

bool ans(int a, int b, int c) {
    if(a == b) return true;
    while(true) {
        if(mas[b].second > c) return false;
        if(mas[b].first == a) return true;
        if(mas[b].first == -1) return false; 
        else  b = mas[b].first;
    }
    return false;
}

int main() {
    scanf("%d%d", &n, &m);
    for(int i = 0; i < n; ++i) mas[i].first = -1;
    for(int i = 0; i < m; ++i) {
        int t, a, b;
        scanf("%d", &t);
        switch (t)
        {
        case 1: 
            scanf("%d %d", &a, &b);
            a--; b--;
            mas[a] = make_pair(b, i);
            break;
        case 2: 
            scanf("%d", &a);
            a--; 
            doc[docCount++] = make_pair(a, i);
            break;
        case 3: 
            scanf("%d%d", &a, &b);
            a--; b--;
            ans(a, doc[b].first, doc[b].second) ? printf("YES\n") : printf("NO\n");
            break;
        default:
            break;
        }
    }

    return 0;
}