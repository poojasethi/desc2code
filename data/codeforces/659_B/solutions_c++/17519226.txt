#include <bits/stdc++.h>
using namespace std;
vector<pair<int,string> > ve[100005];
int main() {
	int i,j,k,l,n,m;
	string c,v;
	cin>>n>>m;
	for(i=0;i<n;i++) {
		cin>>c>>j>>k;
		ve[j].push_back(make_pair(-k,c));
	}
	for(i=1;i<=m;i++) {
		sort(ve[i].begin(),ve[i].end());
		if(ve[i].size()>2 && ve[i][1].first==ve[i][2].first)
			cout<<"?\n";
		else
			cout<<ve[i][0].second<<" "<<ve[i][1].second<<endl;
	}
	return 0;
}