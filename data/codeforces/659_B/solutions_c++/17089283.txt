#include <iostream>
#include <cmath>
#include <string>
#include <vector>
#include <algorithm>
using namespace std;

int n, m, reg, sc;
string s;
vector <pair <int, string> > arr[10001];

int main() {
	cin >> n >> m;
	for (int i = 0; i < n ; ++i) {
		cin >> s >> reg >> sc;
		arr[reg - 1].push_back(make_pair(sc, s));
	}
	for (int i = 0; i < m; ++i) {
		sort(arr[i].rbegin(), arr[i].rend());
		if (arr[i].size() > 2 && arr[i][2].first == arr[i][1].first)
			cout << "?" << endl;
		else
			cout << arr[i][0].second << " " << arr[i][1].second << endl;
	}
	return 0;
}