#include<bits/stdc++.h>
using namespace std;
int main(){
int n,m;
cin>>n>>m;
vector<vector<pair<int,string> > >V(m);
for(int i=0;i<n;i++){
    string s;int index,score;
    cin>>s>>index>>score;
    index--;
    V[index].push_back(make_pair(score,s));
}
for(int i=0;i<m;i++){
    sort(V[i].begin(),V[i].end());
    reverse(V[i].begin(),V[i].end());
    if(V[i].size()>2&&(V[i][1].first==V[i][2].first)){
        cout<<"?"<<endl;
    }
    else{
        cout<<V[i][0].second<<" "<<V[i][1].second<<endl;
    }
}

return 0;}
