#include <cstdio>
#include <cstring>

int n,m,p,t;
char s[100010][20];
int a[10010][5];
int l[10010][5];

int main()
{
	memset(a,-1,sizeof(a));
	scanf("%d%d",&n,&m);
	for (int i=0;i<n;i++){
		scanf("%s %d%d",s[i],&p,&t);
		for (int j=0;j<5;j++)
		if (a[p][j]<t){
			for (int k=4;k>j;k--){
				a[p][k]=a[p][k-1];
				l[p][k]=l[p][k-1];
			}
			a[p][j]=t;
			l[p][j]=i;
			break;
		}
	}
	for (int i=1;i<=m;i++){
		if (a[i][1]!=a[i][2]){
			printf("%s %s\n",s[l[i][0]],s[l[i][1]]);
		}
		else printf("?\n");
	}
	return 0;
}