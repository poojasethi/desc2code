#include<bits/stdc++.h>
using namespace std;
int N,X;
int main(){
scanf("%d%d",&N,&X);
vector<vector<pair<int,string> > >V(X+1);
for(int i=0;i<N;i++){
    string s;
    int a,b;
    cin>>s>>a>>b;
    V[a].push_back(make_pair(b,s));
}
for(int i=0;i<X;i++){
    sort(V[i+1].begin(),V[i+1].end());
    reverse(V[i+1].begin(),V[i+1].end());
    if(V[i+1].size()>2&&(V[i+1][1].first==V[i+1][2].first)){
        cout<<'?'<<endl;
    }
    else{
        cout<<V[i+1][0].second<<" "<<V[i+1][1].second<<endl;
    }
}
return 0;}
