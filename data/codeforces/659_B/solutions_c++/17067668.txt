/*
author:arushi
*/

#include <bits/stdc++.h>
using namespace std;

int	main()
{
	vector<vector<pair<int,string> > > vec(100005);
	int n,m;
	scanf("%d %d",&n,&m);
	for(int i=0;i<n;i++)
	{
		string a;
		int x,y;
		cin>>a;
		scanf("%d %d",&x,&y);
		vec[x].push_back(make_pair(y,a));
	}
	for(int i=1;i<=m;i++)
	{
		sort(vec[i].begin(),vec[i].end());
		int k=(int)vec[i].size()-1;
		if(k>1 && vec[i][k-1].first==vec[i][k-2].first)
			cout<<"?\n";
		else
			cout<<vec[i][k].second<<" "<<vec[i][k-1].second<<"\n";			
	}
	return 0;
}
