#include<bits/stdc++.h>
using namespace std;
#define fr first
#define sc second
#define pa pair<int,string>
#define pb push_back
vector < pa > v[1000000];
string s;
int n,m,x,pu;
int main(){
	scanf("%d %d",&n,&m);
	for(int i=1 ; i<=n ; i++){
		cin >> s >> x >> pu;
		v[x].pb(pa(pu,s));
	}
	for(int i=1 ; i<=m ; i++){
		sort(v[i].begin(),v[i].end());
	}
	for(int i=1 ; i<=m ; i++){
		if(v[i].size()!=2 && v[i][v[i].size()-2].fr==v[i][v[i].size()-3].fr){
			printf("?\n");
			continue;
		}
		cout << v[i][v[i].size()-1].sc << " "  << v[i][v[i].size()-2].sc;
		printf("\n");
	}
	return 0;
}
