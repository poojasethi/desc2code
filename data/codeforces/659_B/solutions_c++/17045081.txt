#include <bits/stdc++.h>

using namespace std;

vector< pair< int,string > >v[10101];
int n , m ;

int main()
{
 cin>>n>>m;
 while( n-- ){
  string nm;
  int x , p;

  cin>>nm>>x>>p;

  v[ x ].push_back( make_pair( p , nm ) );

 }
 for(int i=1;i<=m;i++){

  sort( v[i].begin(),v[i].end() );
  reverse(v[i].begin(),v[i].end() );


  if( v[i].size()==2 ){cout<<v[i][0].second<<" "<<v[i][1].second<<endl;continue;}

  if( v[i][1].first == v[i][2].first )cout<<"?"<<endl;
  else   {cout<<v[i][0].second<<" "<<v[i][1].second<<endl;continue;}

 }


    return 0;
}
