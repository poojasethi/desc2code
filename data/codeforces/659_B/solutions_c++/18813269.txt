#include<bits/stdc++.h>
using namespace std;
vector<vector<pair<int, string> > > table;
int main(){
	int n, m, t, score, z = 0;
	string name;
	cin >> n >> m;
	table.resize(m + 1);
	for(int i = 0; i < n; ++i){
		cin >> name >> t >> score;
		t--;
		table[t].push_back(make_pair(-score, name));
	}
	for(int i = 0; i < m; ++i){
		sort(table[i].begin(), table[i].end());
		int size = table[i].size();
		if(size >= 3 && table[i][1].first == table[i][2].first)
			cout << "?" << endl;
		else
			cout << table[i][0].second << " " << table[i][1].second << endl;
	}
	return 0;
}