#include<bits/stdc++.h>
using namespace std;
int main()
{
	int n,m,j,k;
	scanf("%d%d",&n,&m);
	vector< vector < pair<int,string> > > v( m ); 
	string c;
	for(int i=0;i<n;i++)
	{
		cin>>c;
		scanf("%d %d",&j,&k);
		v[j-1].push_back(make_pair(k,c));
	}
	for(int i=0;i<m;i++)
	{
		sort(v[i].begin(),v[i].end());
	}
	for(int i=0;i<m;i++)
	{
		k=v[i].size()-1;
		if(k-2>=0&&(v[i][k-2].first==v[i][k-1].first))
		printf("?\n");
		else
		cout<<v[i][k].second<<" "<<v[i][k-1].second<<"\n";
	}
	return 0;
}