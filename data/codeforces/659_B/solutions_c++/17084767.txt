#include<iostream>
#include<algorithm>
#include<string>
#include<vector>
using namespace std;
#define pp pair<int,string>
#define rp(i,n) for(i=0;i<n;++i)
vector<pp> a[21005];
int n,m;
bool srt(pp a,pp b)
{
	return a.first>b.first;
}
int main()
{
	int i,j;
	string s;
	int x,y;
	cin>>n>>m;
	rp(i,n)
	{
		cin>>s>>x>>y;
		a[x-1].push_back(pp(y,s));
	}
	rp(i,m)
	{
		sort(a[i].begin(),a[i].end(),srt);
		if(a[i].size()>2 && a[i][1].first==a[i][2].first){
			cout<<"?\n";
			continue;
		}
		cout<<a[i][0].second<<" "<<a[i][1].second<<endl;
	}
	return 0;
}
