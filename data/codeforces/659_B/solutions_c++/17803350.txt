#include<bits/stdc++.h>
using namespace std;
int main()
{
    int n,m,i,x,id,a,b,c;
    string s;
    cin>>n>>m;
    vector<vector<pair<int,string> > > p(n+1);
    for(i=0;i<n;i++){
        cin>>s>>id>>x;
        p[id-1].push_back(make_pair(x,s));
    }
    for(i=0;i<m;i++){
        sort(p[i].rbegin(),p[i].rend());
        a=p[i][1].first;
        b=-1;
        if(p[i].size()>2)
            b=p[i][2].first;

        if(a==b)
            cout<<"?"<<endl;
        else
            cout<<p[i][0].second<<" "<<p[i][1].second<<endl;
    }
}
