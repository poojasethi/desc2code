#include<bits/stdc++.h>
using namespace std;
vector < pair<int,string> > V[10001];
int x,y,a,b;
string st;
int main()
{
    scanf("%d %d",&x,&y);
    for(int i=1;i<=x;i++)
    {
        cin>>st>>a>>b;
        V[a].push_back(make_pair(-b,st));
    }
    for(int i=1;i<=y;i++)
    {
        sort(V[i].begin(),V[i].end());
        if((int) V[i].size()>2 && V[i][1].first==V[i][2].first) printf("?\n");
        else cout<<V[i][0].second<<" "<<V[i][1].second<<endl;
    }
}
