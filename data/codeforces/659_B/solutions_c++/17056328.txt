#include <iostream>
#include <cstdio>
#include <vector>
#include <algorithm>
#define F first
#define S second
using namespace std;

int n, m, sz;
string s;
vector<pair<int, string> > v[10005];
int main(){
	int i, t1, t2;
	cin>>n>>m;
	for(i=0; i<n; i++){
		cin>>s>>t1>>t2;
		v[t1].push_back(make_pair(t2, s));
	}
	for(i=1; i<=m; i++){
		sort(v[i].begin(), v[i].end());
		sz = v[i].size();
		if(sz>2 && (v[i][sz-2].F == v[i][sz-3].F)) {
			puts("?");
		} else {
			cout<<v[i][sz-1].S<<' '<<v[i][sz-2].S<<endl;
		}
	}
	return 0;
}
