#include <iostream>
#include <vector>
#include <algorithm>

using namespace std;
const int Maxm = 10 * 1000 + 5;
vector <pair <int,string> > r[Maxm];
int n,m;
int main()
{
	cin >> n >> m;
	string s;
	int t,sc;
	for(int i = 0; i < n; i++)
	{
		cin >> s >> t >> sc;
		t--;
		r[t].push_back(make_pair(800-sc,s));
	}
	for(int i = 0; i < m; i++)
	{
		sort(r[i].begin(),r[i].end());
		if(r[i].size() > 2 && r[i][1].first == r[i][2].first)
			cout << "?" << endl;
		else
			cout << r[i][0].second << " " << r[i][1].second << endl;
	}
	return 0;
}