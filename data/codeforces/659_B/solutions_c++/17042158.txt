
#include<bits/stdc++.h>

typedef long long LL;
using namespace std;
const int M = 1000000007;

int main()
{
LL n,m,i,a,b;

string s;

cin>>n>>m;

set <pair <LL,string > > se[m+1];

for(i=0;i<n;i++)
{
cin>>s>>a>>b;

se[a].insert(make_pair(-b,s));

//cout<<s<<a<<b<<endl;

}

set <pair <LL,string > > :: iterator it1,it2,it3;

for(i=1;i<=m;i++)
{

it1=se[i].begin();

it2=it1;
it2++;

it3=it2;

if(se[i].size()>2)
	it3++;
		

if(se[i].size()>2 && it2->first == it3->first)
	cout<<'?'<<endl;
else
	cout<<it1->second<<' '<<it2->second<<endl;


}



}

