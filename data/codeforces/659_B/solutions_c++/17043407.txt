#include<bits/stdc++.h>
#define ss second
#define ff first

using namespace std;

pair < pair <int,int> ,string> a[100005];

int main()
{
	int n,m;
	
	cin >> n >> m;
	
	for(int i=0;i<n;i++)
		cin >> a[i].ss >> a[i].ff.ff >> a[i].ff.ss;
		
	sort(a,a+n);
	
	for(int i=0;i<n;i++)
	{
		int j=i; 
		
		for(j=i;j<n-1;j++)
			if(a[j].ff.ff!=a[j+1].ff.ff)
				break;
				
		if(i!=j-1 && a[j-2].ff.ss==a[j-1].ff.ss)
			cout << "?" << endl;
		else
			cout << a[j].ss << " " << a[j-1].ss << endl;
			
		i=j;
	}
	
	return 0;
}