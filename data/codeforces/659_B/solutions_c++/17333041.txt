#include <iostream>
#include <string>
#include <vector>
#include <algorithm>

const int MAX = 100000;

using namespace std;
int main(int argc, char const *argv[]) {

  vector<pair<int,string> > v[MAX];
  int n,m;

  cin>>n>>m;

  for(int i=0;i<n;i++){
    string auxs; int auxi,ord;
    cin>>auxs>>ord>>auxi;
    v[ord].push_back(make_pair(-auxi,auxs));
  }

  for(int i = 1;i<=m;i++){

    sort(v[i].begin(),v[i].end());

    if(v[i].size()>2 && v[i][1].first == v[i][2].first) cout<<"?\n";
    else{
      cout<< v[i][0].second <<" "<< v[i][1].second << "\n";
    }
  }

  return 0;
}
