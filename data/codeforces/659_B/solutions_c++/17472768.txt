#include<bits/stdc++.h>
using namespace std;
#define ll long long
ll i,j,m,n,p,q,r,k;
typedef pair<ll,string>pii;
string s;
vector<pii>v[100005];
int main()
{
    cin>>n>>m;
    for(i=1;i<=n;i++)
    {
        cin>>s>>p>>q;
        v[p].push_back(make_pair(q,s));
    }
    for(i=1;i<=m;i++)
    {
        sort(v[i].rbegin(),v[i].rend());
        if(v[i].size()>2&&(v[i][1].first==v[i][2].first))
        cout<<"?\n";
        else
        cout<<v[i][0].second<<" "<<v[i][1].second<<"\n";
    }
}
