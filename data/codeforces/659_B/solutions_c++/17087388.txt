#include <vector>
#include <iostream>
#include <algorithm>
#include <string>
using namespace std;
int main()
{
	vector<pair<int,string> > v[10010];
	long long int n,m;
	cin>>n>>m;
	for (int i=0; i<n; i++)
	{
		int reg,nomre;
		string name;
		cin>>name>>reg>>nomre;
		v[reg].push_back(make_pair(nomre,name));
	}
	for(int i = 1 ; i <= m ; i++) 
	{
		sort(v[i].rbegin(),v[i].rend());
		if(v[i].size()>2 and v[i][1].first == v[i][2].first) cout<<'?'<<endl;
		else cout << v[i][0].second << " " << v[i][1].second << endl;
	}
}
