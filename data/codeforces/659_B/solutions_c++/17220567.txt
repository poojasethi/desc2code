#include<bits/stdc++.h>
using namespace std;

int main(){
    long long a, m, n, i, b;
    string s;
    vector< pair<long long, string> >v[10001];
    cin>>n>>m;
    for(i=0; i<n; i++){
        cin>>s>>a>>b;
        v[a].push_back(make_pair(b, s));
    }
    for(i=1; i<=m; i++){
        sort(v[i].rbegin(), v[i].rend());
        if(v[i].size()>2&&v[i][1].first==v[i][2].first) cout<<"?"<<endl;
        else cout<<v[i][0].second<<" "<<v[i][1].second<<endl;
    }
    return 0;
}
