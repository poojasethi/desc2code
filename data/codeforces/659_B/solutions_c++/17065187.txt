#include<bits/stdc++.h>
using namespace std;
#define mp make_pair
#define pb push_back
int main()
{
	int i,j,n,m,num,r,sum;
	string str;
	cin>>n>>m;
	vector<pair<int,string> >v[n+1];
	while(n--)
	{
		cin>>str>>r>>num;
		v[r-1].push_back(mp(num,str));
	}
	for(i=0;i<m;i++)
	{
		sort(v[i].begin(),v[i].end());
		j=v[i].size();
		if(j>=3)
		{
			if(v[i][j-2].first==v[i][j-3].first)
				cout<<"?\n";
			else
				cout<<v[i][j-1].second<<" "<<v[i][j-2].second<<endl;
		}
		else
				cout<<v[i][j-1].second<<" "<<v[i][j-2].second<<endl;
	}
}
