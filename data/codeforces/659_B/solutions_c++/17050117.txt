#include <bits/stdc++.h>

using namespace std;

int n,m,t,p;
char s[2000];
vector<pair<int,string> > ans[10001];
int main()
{
    scanf(" %d %d",&n,&m);
    for(int i=1;i<=n;++i)
    {
        scanf(" %s %d %d",s,&t,&p);
        ans[t].push_back(make_pair(p,string(s)));
    }
    for(int i=1;i<=m;++i)
    {        sort(ans[i].begin(),ans[i].end(),greater<pair<int,string> >());
        if(ans[i].size()>2&&ans[i][1].first==ans[i][2].first) puts("?");
        else cout<<ans[i][0].second<<' '<<ans[i][1].second<<endl;
    }
    return 0;
}
