#include<bits/stdc++.h>
using namespace std;


#define l long long
#define ii pair<int,string>

vector<ii>v[100009];
int main(){
	l n,m;cin>>n>>m;
	
	for(int i=0;i<n;i++){
		string s;int region,point;
		cin>>s>>region>>point;
		v[region].push_back(ii(point,s));
	}
	for(int i=1;i<=m;i++){
		sort(v[i].rbegin(),v[i].rend());
		if(v[i].size()>2){
				if(v[i][2].first==v[i][1].first){
					cout<<"?"<<endl;
				}
				else cout<<v[i][0].second<<" "<<v[i][1].second<<endl;
		}
		else cout<<v[i][0].second<<" "<<v[i][1].second<<endl;
	}
}