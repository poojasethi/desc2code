n,m = map(int,raw_input().split())
d = {}
for i in range(1,10001):d[i] = []
for i in range(n):
	a,b,c = raw_input().split()
	d[int(b)].append([int(c),a])
for item in d:
	d[item].sort(reverse=True)
for i in range(1,m+1):
	if len(d[i])>2:
		if d[i][1][0]==d[i][2][0]:
			print '?'
		else:
			print d[i][0][1],d[i][1][1]
	else:
		print d[i][0][1],d[i][1][1]

