n,m=map(int,raw_input().split())
d=[[] for i in range(m+1)]
for i in range(n):
    s=raw_input().split()
    d[int(s[1])].append((int(s[2]),s[0]))
for i in range(1,m+1):
    d[i].sort(reverse=True)
    if len(d[i])==2 or d[i][1][0]>d[i][2][0]:
        print d[i][0][1],d[i][1][1]
    else:
        print '?'
