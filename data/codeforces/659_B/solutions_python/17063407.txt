#!/usr/bin/python
import heapq
from sys import stdout
from copy import deepcopy

n,m = map(int,raw_input().split())
team=[[] for i in xrange(m)]
for i in xrange(n):
	name,y,score = map(str,raw_input().split())
	y=int(y)-1
	score=int(score)
	t=(-score,name)
	heapq.heappush(team[y],t)

for i in xrange(m):

	if len(team[i])>2:
		x = heapq.heappop(team[i])
		y = heapq.heappop(team[i])
		z = heapq.heappop(team[i])

		if (x[0]==z[0] or y[0]==z[0]):
			print "?"
			continue
		heapq.heappush(team[i],x)
		heapq.heappush(team[i],y)
		heapq.heappush(team[i],z)


	x = heapq.heappop(team[i])
	y = heapq.heappop(team[i])

	stdout.write(x[1])
	stdout.write(' ')
	stdout.write(y[1])
	stdout.write("\n")
