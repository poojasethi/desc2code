n, m = map(int, raw_input().split())
l = [[] for _ in xrange(m)]

for i in xrange(n):
    s = raw_input().split()

    surname = s[0]
    region = int(s[1]) - 1
    score = int(s[2])

    l[region].append((score, surname))

for i in xrange(m):
    l[i].sort(reverse=True)
    if len(l[i]) > 2 and l[i][1][0] == l[i][2][0]:
        print '?'
    else:
        print l[i][0][1], l[i][1][1]
