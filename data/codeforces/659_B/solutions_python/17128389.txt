mp = lambda: map(int, raw_input().split())
n, m = mp()
R = [[] for _ in xrange(m)]
for _ in xrange(n):
    line = raw_input().split()
    name, region, score = line[0], int(line[1]), int(line[2])
    R[region-1].append((score, name))
for i in xrange(m):
    R[i].sort(reverse=True)
    if len(R[i]) >= 3 and R[i][1][0] == R[i][2][0]:
        print "?"
    else:
        print R[i][0][1], R[i][1][1]

