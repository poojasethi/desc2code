n,m=raw_input().split()
n=int(n)
m=int(m)
listofplayers=[[] for i in xrange(m)]
listoftheirscores=[[] for i in xrange(m)]
for i in xrange(n):
    family,regionid,balls=raw_input().split()
    listofplayers[int(regionid)-1].append(family)
    listoftheirscores[int(regionid)-1].append(int(balls))
for i in xrange(m):
    listofplayers[i]=[j for (k,j) in sorted(zip(listoftheirscores[i],listofplayers[i]),reverse=True)]
    listoftheirscores[i]=sorted(listoftheirscores[i],reverse=True)
for i in xrange(m):
    if len(listoftheirscores[i])>2:
        if listoftheirscores[i][2]==listoftheirscores[i][1]:
            print "?"
        else:
            print listofplayers[i][0],listofplayers[i][1]
    else:
        print listofplayers[i][0],listofplayers[i][1]

    