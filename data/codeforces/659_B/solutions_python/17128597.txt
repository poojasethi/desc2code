import sys
n, m = map(int, sys.stdin.readline().split())
regions = [[] for i in range(m + 1)]
for i in range(n):
    fam, reg, val = sys.stdin.readline().split()
    regions[int(reg)].append((int(val), fam))
for i in range(1, m + 1):
    regions[i].sort(key = lambda x: x[0])
    if len(regions[i]) > 2 and regions[i][-2][0] == regions[i][-3][0]:
        sys.stdout.write('?' + '\n')
    else:
        sys.stdout.write(' '.join([regions[i][-1][1], regions[i][-2][1]]) + '\n')
#!