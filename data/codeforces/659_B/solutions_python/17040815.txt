#!/usr/bin/python

import sys
from math import *

def Ni(): return tuple(map(int, sys.stdin.readline().split()))
def Ns(): return sys.stdin.readline().split()

from collections import defaultdict

byregion = defaultdict(list)
n, m = Ni()
for i in range(n):
    name, region, points = Ns()
    region = int(region) - 1
    points = int(points)
    byregion[region].append((points, name))

for region in xrange(m):
    comp = byregion[region]
    comp.sort(reverse=True)
    if len(comp) == 2:
        print " ".join(map(lambda x : x[1], comp))
    else:
        if min(comp[0][0], comp[1][0]) > comp[2][0]:
            print " ".join(map(lambda x : x[1], comp[:2]))
        else:
            print "?"
