R=lambda:raw_input().split()
n,m=map(int,R())
a=sorted([(int(z),x,int(y)) for x,y,z in [R() for _ in range(n)]])
b=[[] for _ in range(m+1)]
while a:
  z,x,y=a.pop()
  if len(b[y])<2 or z==b[y][-1][1]:
    b[y]+=[(x,z)]
for v in b[1:]:
  if len(v)>2:
    print '?'
  else:
    print v[0][0],v[1][0]