n, m = map(int, raw_input().split())
dict = [[] for _ in xrange(m + 1)]
for _ in xrange(n):
    x, y, z = raw_input().split()
    dict[int(y)].append((int(z), x))
    
for i in xrange(1, m + 1):
    dict[i].sort(reverse = True)
    if len(dict[i]) > 2 and dict[i][1][0] == dict[i][2][0]:
        print "?"
    else:
        print dict[i][0][1], dict[i][1][1]