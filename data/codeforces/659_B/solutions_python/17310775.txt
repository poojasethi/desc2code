n, m = map(int, raw_input().split())
stu = [raw_input().split() for i in range(n)]

regions = []
for i in range(m):
    regions.append([])

for name, r, s in stu:
    r = int(r)
    s = int(s)
    regions[r-1].append((s, name))

for i in regions:
    i.sort()
    i.reverse()
    if len(i) > 2 and i[2][0] in set([i[0][0], i[1][0]]):
        print '?'
    else:
        print i[0][1], i[1][1]
