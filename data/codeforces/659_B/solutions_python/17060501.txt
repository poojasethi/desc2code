res = [[] for i in range(10001)]
n, m = map(int, raw_input().split())
for _ in range(n):
	name, r, pos = raw_input().split()
	res[int(r)].append([name, int(pos)])

for i in res:
	if len(i) <= 1:
		continue

	i.sort(key=lambda x: x[1], reverse=True)
	if len(i) > 2:
		if i[0][1] >= i[1][1] > i[2][1]:
			print i[0][0], i[1][0]
		else:
			print '?'
	else:
		if i[0][1] >= i[1][1]:
			print i[0][0], i[1][0]
		else:
			print '?'