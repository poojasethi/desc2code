n, m = map(int, raw_input().split())
j = [raw_input().split() for i in range(n)]

regions = []
for i in range(m):
    regions.append([])

for name, r, s in j:
    r = int(r)
    s = int(s)
    regions[r-1].append((s, name))

for i in regions:
    i.sort(reverse=True)
    print '?' if len(i) > 2 and i[2][0] in set([i[0][0], i[1][0]]) else i[0][1]+" "+ i[1][1]