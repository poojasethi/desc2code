from collections import defaultdict

n,m = [int(i) for i in raw_input().split(' ')]
x = []
d = defaultdict(list)
for i in range(n):
        n,r,s = raw_input().split(' ')
        s= int(s)
        d[int(r)].append((s,n))
for i in range(1,m+1):
        l = d[i]
        l = sorted(l)[::-1]
        if len(l)>2 and l[1][0]==l[2][0]:
                print "?"
        else:
                print " ".join([t[1] for t in l[:2]])
