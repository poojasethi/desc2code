n,m=map(int,raw_input().split())
ans=[[] for i in xrange(m)]
for i in xrange(n):
	name,team,point=raw_input().split()
	ans[int(team)-1]+=[[int(point),name]]
for i in xrange(m):
	ans[i].sort(reverse=True)
for i in xrange(m):
	if(len(ans[i])==2 or ans[i][1][0]>ans[i][2][0]):
		print ans[i][0][1],ans[i][1][1]
	else:
		print "?"


		
	
	
