
n,m = map(int,raw_input().split())
region_list = [[]for i in xrange(m)]
for i in xrange(n):
	name,region,score = raw_input().split()
	region_list[int(region)-1].append((int(score),name))

for i in xrange(m):
	region_list[i].sort(reverse = True)
	if len(region_list[i])>=3:
		if region_list[i][1][0] == region_list[i][2][0]:
			print '?'
			continue
		else:
			print region_list[i][0][1],region_list[i][1][1]
	else:
		print region_list[i][0][1],region_list[i][1][1]
