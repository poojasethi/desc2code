from collections import defaultdict
n, m = map(int, raw_input().split())
ppl = defaultdict(list)
for _ in xrange(n):
    name, reg, score = raw_input().split()
    score = int(score)
    ppl[(score, reg)].append(name)

keys = reversed(sorted(ppl.keys()))
ans = {}
names = defaultdict(list)

for score, reg in keys:
    if reg in ans:
        continue
    names[reg].extend( ppl[(score, reg)] )
    no = len(names[reg])
    if no > 2:
        ans[reg] = "?"
    elif no == 2:
        ans[reg] = " ".join(names[reg])

for ind in xrange(1, m+1):
    print ans[str(ind)]
