n, m = map(int, raw_input().split())

regions = [[] for i in range(m+1)]

for i in range(n):
    l, r, p = raw_input().split()
    r = int(r)
    p = int(p)
    regions[r].append((l, p))
for region in regions[1:]:
    region.sort(key=lambda x: x[1])
    if len(region) > 2 and region[-2][1] == region[-3][1]:
        print '?'
    else:
        print region[-1][0] + ' ' + region[-2][0]
