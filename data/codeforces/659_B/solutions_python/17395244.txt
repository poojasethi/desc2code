n, m = map(int, raw_input().split())
s = [[] for i in range(0, m)]

for i in range(n): 
	a = raw_input().split()
	s[int(a[1])-1].append([int(a[2]), a[0]])
for x in s:
	x.sort()
	x.reverse()
	if len(x) == 2 or x[1][0] != x[2][0]:
		print x[0][1]+ ' ' +  x[1][1]
	else:
		print '?'
