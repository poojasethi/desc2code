number,region=map(int,raw_input().split())
arr=[[] for i in range(region) ]
for i in range(number):
    a,b,c=raw_input().split()
    b,c=int(b),int(c)
    arr[b-1].append([a,c])

for i in range(region):
    arr[i].sort(key=lambda x: x[1],reverse=True)
    #print(ls[i])
    if len(arr[i])>2 and arr[i][1][1]==arr[i][2][1]:
        print "?"
    else :
        print arr[i][0][0],arr[i][1][0]