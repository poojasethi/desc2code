n=input()
r=lambda:map(int,raw_input().split())
t=r()
v=r()
c=[0]*(10**5+1)
for i in v:
    c[i] += 1

res=[]
m=0
for i in range(n):
    if t[i]:
        j=i
        p=[j+1]
        while c[v[j]] < 2 and v[j]:
            j=v[j]-1
            #print j
            p.append(j+1)
        if len(p) > m:
            m = len(p)
            res = reversed(p)
print m
print ' '.join(map(str, res))
