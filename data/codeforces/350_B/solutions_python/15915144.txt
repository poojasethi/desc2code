def read():return map(int,raw_input().split())
N,a,f=input(),[0]+read(),[0]+read()
s,b,ans,p=[0]*(N+1),[],0,0
for i in f:s[i]+=1
for i in xrange(1,N+1):
    if a[i]:
        t,k=i,0
        while t and s[t]<2:k,t=k+1,f[t]
        if k>ans:ans,p=k,i
print ans
while ans:
    b+=[p]
    ans,p=ans-1,f[p]
b.reverse()
print ' '.join(map(str,b))
