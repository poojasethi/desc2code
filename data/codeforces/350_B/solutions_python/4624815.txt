#!/usr/bin/env python

from collections import Counter


n = int(raw_input())
objects = map(int, raw_input().split())
a = map(int, raw_input().split())

count = Counter(a)
count[0] = 0
ans_path = []
for i, ai in enumerate(a):
    if objects[i] == 0:
        continue
    vi = i
    path = [vi, ]
    while count[a[vi]] == 1:
        vi = a[vi] - 1
        path.append(vi)
    if len(path) > len(ans_path):
        ans_path = path
print len(ans_path)
print ' '.join(reversed(map(lambda x: str(x + 1), ans_path)))
