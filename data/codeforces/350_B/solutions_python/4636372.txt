R=lambda:map(int,raw_input().split())
n=input()
t=[0]+R()
p=[0]+R()
h=[0]*(n+1)
r=h[:]
c=h[:]
for a in p:
  c[a]+=1
for a in range(1,n+1):
  if t[a]:
    x=a
    while x:
      y=(0,p[x])[c[p[x]]<2]
      if h[x]+1>h[y]:
        h[y],r[y]=h[x]+1,x
      x=y
print h[0]
x,y,v=0,h[0],[]
while y:
  v+=[r[x]]
  x=r[x]
  y-=1
print ' '.join(map(str,v))
