n = input()
a = [0]+map(int, raw_input().split())
b = [0]+map(int, raw_input().split())
c = [0]*(n+1)
for i in b:
    c[i] += 1
m = j = x = p = 0

for i in xrange(1, n+1):
    if(a[i]):
#       print 'a[i]:', a[i]
        j, x = i, 0
        while j and c[j] < 2:
#           print 'b[j]:', b[j] 
            x, j = x+1, b[j]
        if(x > m):
            m = x
            p = i

print m 
g = []
while(m):
    g += [p]
    m, p = m-1, b[p]

g.reverse()
print ' '.join(map(str, g)) 