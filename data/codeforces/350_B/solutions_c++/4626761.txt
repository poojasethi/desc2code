#include<stdio.h>
#include<string.h>
#define maxn 100005
int a[maxn],p[maxn],f[maxn],so[maxn]; 
int main()
{
	int N,i,t,s,e,c=0,Max=0;
	scanf("%d",&N);
	memset(f,0,sizeof(f));
	for(i=1;i<=N;i++) scanf("%d",&a[i]);
	for(i=1;i<=N;i++) 
	{
		scanf("%d",&p[i]);
		f[p[i]]++;
	}
	for(i=1;i<=N;i++)
	{
		if(a[i])
		{
			t=p[i];
			s=1;
			while(t && f[t]==1 && !a[t])
			{
				t=p[t];
				s++;
			}
			if(t && f[t]==0) s++;
			if(s>Max)
			{
				Max=s;
				e=i;
			}
		}
	}
	printf("%d\n",Max);
	while(Max--)
	{
		so[c++]=e;
		e=p[e];
	}
	for(i=c-1;i>=0;i--) printf("%d ",so[i]);
	printf("\n");
	return 0;
}

