#include<stdio.h>
#include<iostream>
using namespace std;
int main()
{
	int n,i,j,a[100005],b[100005],s[100005]={0},an[100005],ansi,ans=0,anst=0;
	scanf("%d",&n);
	for(i=1;i<=n;i++)
	{
		scanf("%d",&a[i]);
	}
	for(i=1;i<=n;i++)
	{
		scanf("%d",&b[i]);
		if(b[i])
		s[b[i]]++;
	}
	for(i=1;i<=n;i++)
	{
		if(a[i]==1)
		{
			int x=i;
			anst=0;
			while(b[x]&&s[b[x]]==1)
			{
				x=b[x];
				anst++;
			}
			if(anst>=ans)
			{
				ans=anst;
				ansi=i;
			}
		}
	}
	an[0]=ansi;
	int k=1;
	while(b[ansi]&&s[b[ansi]]==1)
	{
		ansi=b[ansi];
		an[k++]=ansi;
	}
	printf("%d\n%d",k,an[k-1]);
	for(i=k-2;i>=0;i--)
	printf(" %d",an[i]);
	printf("\n");
}
	       			   			   	   		