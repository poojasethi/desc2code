#include<iostream>
#include<vector> 
using namespace std;
int type[100001],a[100001],now[100001];
vector<int> ans,s;
void DFS(int n)
{
    s.push_back(n);
    if(a[n]!=-1&&now[a[n]]==1)DFS(a[n]);
    else if(ans.size()<s.size())ans=s;
    s.pop_back();
} 
int main()
{
    int n;
    cin>>n;
    for(int i=0;i<n;i++)cin>>type[i];
    for(int i=0;i<n;i++)cin>>a[i],a[i]--,now[i]=0;
    for(int i=0;i<n;i++)if(a[i]>=0)now[a[i]]++;
    for(int i=0;i<n;i++)if(type[i]==1)DFS(i);
    cout<<ans.size()<<endl;
    while(!ans.empty())cout<<ans.back()+1<<" ",ans.pop_back();
}