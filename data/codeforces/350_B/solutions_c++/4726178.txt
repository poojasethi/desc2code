#include <cstdio>
#include <cstring>
using namespace std;
const int maxn = 100000+5;
int Type[maxn],a[maxn],cu[maxn];
void out(int v)
{
    int b=a[v];
    if(b==0||cu[b]!=1) ;
    else  out(b);
    printf("%d ",v);
}
int main()
{
    int n;
    scanf("%d",&n);
    for(int i=1;i<=n;i++)
        scanf("%d",&Type[i]);
    memset(cu,0,sizeof(cu));
    for(int i=1;i<=n;i++)
        scanf("%d",&a[i]),cu[a[i]]++;
    int T=0,idx;
    for(int i=1;i<=n;i++)
        if(Type[i]==1){
        int tp=a[i],num=1;
        while(tp&&cu[tp]==1&&Type[tp]==0) num++,tp=a[tp];
        if(num>T) T=num,idx=i;
    }
    printf("%d\n",T);
    out(idx);
    return 0;
}
