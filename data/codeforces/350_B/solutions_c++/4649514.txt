#include <iostream>
#include <stdio.h>
#include <vector>
#include <algorithm>
using namespace std;
int main()
{//freopen("i.txt","r",stdin);
int n; cin>>n;
int a[100005],kol[100005]={0};
vector <int> ans,ans1,g;
for(int i=1;i<=n;i++) {int t;cin>>t;if(t) g.push_back(i);}
for(int i=1;i<=n;i++) {int t; cin>>t; a[i]=t; kol[t]++;}
for(int i=0;i<g.size();i++)
{ans1.clear();
  int i1=g[i];
  ans1.push_back(i1);
  i1=a[i1];
  while (kol[i1]==1&&i1!=0) {ans1.push_back(i1);i1=a[i1];}
  if (ans1.size()>ans.size()) ans=ans1;
}
reverse(ans.begin(),ans.end());
cout<<ans.size()<<endl;
for (int i=0;i<ans.size();i++) cout<<ans[i]<<" ";
return 0;
}
