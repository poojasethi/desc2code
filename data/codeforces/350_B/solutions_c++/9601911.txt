#include<cstdio>
#include<algorithm>
#include<map>
#include<cstring>
#include<vector>
#include<cmath>
#include<string>
#define N 200010
#define M 1010
#define P 1000000007
using namespace std;
int n,i,a[N],b[N],c[N],len[N],tmp;
int dfs(int x)
{	
	if ((b[x]==0)||(c[b[x]]>1))
	return 1;
	else
	return 1+dfs(b[x]);	
}
void out(int x)
{	
	if ((b[x]==0)||(c[b[x]]>1))
	;
	else
	out(b[x]);	
	printf("%d ",x);
}
int main()
{
	scanf("%d",&n);
	for (i=1;i<=n;i++)
	scanf("%d",&a[i]);
	for (i=1;i<=n;i++)
	{
		scanf("%d",&b[i]);
		c[b[i]]++;
	}
	for (i=1;i<=n;i++)
	if (a[i]==1)
	{	
		len[i]=dfs(i);
		if (len[i]>len[tmp]) tmp=i;
	}
	printf("%d\n",len[tmp]);
	out(tmp);
	
} 