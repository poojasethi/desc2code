#include <cstdio>
#define maxn 100111
int s[maxn],d[maxn],g[maxn],t[maxn],n,ans,res;
void dfs(int u,int k)
{    
    if(k>ans)
    {        
        ans=k;
        res=u;
    }
    if(g[u]==0|| d[g[u]]>1)return ;    
    dfs(g[u],k+1);
}
int main()
{
    scanf("%d",&n);
    for(int i=1;i<=n;++i)
        scanf("%d",t+i);
    for(int i=1;i<=n;++i)
    {
        int x;
        scanf("%d",&x);
        g[i]=x;
        s[x]=i;
        ++d[x];
    }
    for(int i=1;i<=n;++i)
        if(t[i]==1)
            dfs(i,1);
    printf("%d\n",ans);
    while(1)
    {
        printf("%d ",res);
        res=s[res];
        if(res==0 || d[res]>1)break;
    }
    puts("");
    return 0;
}
