#include <iostream>
#include <algorithm>
using namespace std;
int a[111111],b[111111],c[111111],n,i,j,k,x,m;
void out(int t)
{
  if (!t || c[t]>1) return;
  out(b[t]);
   cout<<t<<' ';


}

int main()
{
cin>>n;
for (i=1;i<=n;i++) cin>>a[i];
for (i=1;i<=n;i++)
 {
  cin>>b[i];
  c[b[i]]++;
 }

for (i=1;i<=n;i++)
 if (a[i]) {
        x=1;
        int t=b[i];
        while (t)
         {
          if (c[t]>1) break;
          x++;
          t=b[t];
         }

        if (x>m) {m=x;j=i;}
        }

cout<<m<<endl;
out(j);
}
