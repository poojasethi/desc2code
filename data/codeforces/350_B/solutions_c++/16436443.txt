//此题只是题面比较费解。。
#include<cstdio>
#include<vector>
using namespace std;

int n;
int typ[111111];
int nxt[111111], pre[111111];
vector<int>ans;

int main() {
	scanf("%d", &n);
	for(int i=1;i<=n;i++) scanf("%d", &typ[i]);
	for(int i=1;i<=n;i++) {
		int x;
		scanf("%d", &x); //edge x->i
		nxt[x]++;
		pre[i]=x;
	}
	ans.clear();
	for(int i=1;i<=n;i++) {
		if(!typ[i]) continue;
		vector<int> t;
		t.clear();
		for(int p = i;p && nxt[p]<=1;p=pre[p])
			t.push_back(p);
		if(t.size()>ans.size()) ans=t;
	}
	printf("%d\n", ans.size());
	for(int i=(int)ans.size()-1;i>=0;i--)
		printf("%d%c", ans[i], i>0 ? ' ' : '\n');
	
	return 0;
}