#include <stdio.h>
#include <iostream>
#include <vector>

using namespace std;

#define	MAXN	100010

int prev[MAXN], type[MAXN], cnt[MAXN], n;

int main (void) {
	int i, v;
	vector<int> ans, tmp;

	scanf("%d", &n);
	for(i=1; i <= n; i++) scanf("%d", &type[i]);
	for(i=1; i <= n; i++) {
		scanf("%d", &prev[i]);
		if(prev[i]) cnt[prev[i]]++;
	}

	for(i=1; i <= n; i++)
		if(type[i]) {
			v = i;
			tmp.clear();
			while(prev[v] && cnt[prev[v]] <= 1) {
				tmp.push_back(v);
				v = prev[v];
			}
			tmp.push_back(v);
			if(tmp.size() > ans.size()) ans = tmp;
		}

	printf("%d\n%d", ans.size(), ans[ans.size()-1]);
	for(i=1; i < ans.size(); i++) printf(" %d", ans[ans.size()-1-i]);
	printf("\n");

	return 0;
}
