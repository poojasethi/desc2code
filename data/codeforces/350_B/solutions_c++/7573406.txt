#include <iostream>
using namespace std;
int n, m, s, t[100001], a[100001], b[100001], i, j, x;
int main()
{
	cin>>n;
	for (i=1; i<=n; i++) cin>>t[i];
	for (i=1; i<=n; i++) {
		cin>>a[i]; 
		if (a[i]) {
			b[i]++; b[a[i]]++;
		}
	}
	for (i=1; i<=n; i++) if (t[i]) {
		x=1; j=i;
		while (a[j] && b[a[j]]<=2) {
			x++; j=a[j];
		}
		if (x>m) {
			m=x; s=i;
		}
	}
 	x=0; j=s; t[x++]=j;
	while (a[j] && b[a[j]]<=2) {
		j=a[j]; t[x++]=j; 
	}
	cout<<m<<endl;
	while (x>0) cout<<t[--x]<<" ";
	cout<<endl;
	return 0;
}
