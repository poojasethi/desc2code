#include <iostream>
#include <cstdio>

using namespace std;

const int MAXN = 200000;

int n, a[MAXN], used[MAXN], cnt[MAXN], d[MAXN], p[MAXN], pos;

void dfs(int v) {
	used[v] = true;

	if (p[v] && !used[p[v]] && cnt[p[v]] == 1)
		dfs(p[v]);

	d[v] = d[p[v]] + 1;

	return;
}

void print(int v) {
	if (p[v] && cnt[p[v]] == 1)
		print(p[v]);
	
	cout << v << ' ';

	return;
}

int main() {
	cin >> n;

	for (int i = 1; i <= n; i++)
		cin >> a[i];

	for (int i = 1; i <= n; i++) {
		cin >> p[i];
		cnt[p[i]]++;
	}

	for (int i = 1; i <= n; i++)
		if (a[i]) {
			if (!pos)
				pos = i;
			dfs(i);
			if (d[i] > d[pos])
				pos = i;
		}

	cout << d[pos] << endl;

	print(pos);
	return 0;
}