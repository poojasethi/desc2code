#include <iostream>
#include <stdio.h>
#include <vector>
#include <algorithm>
using namespace std;
int a[100005],b[100005];
vector <int> ans,ans1,g;
int n;
int main()
{//freopen("i.txt","r",stdin);
cin>>n;
for(int i=1;i<=n;i++) {int t;cin>>t;if(t) g.push_back(i);}
for(int i=1;i<=n;i++)
 {int t; cin>>t; a[i]=t;
  if(t)
  { if (b[t]==0) b[t]=i;
      else if (b[t]) b[t]=-1;
  }
  }
for(int i=0;i<g.size();i++)
{ans1.clear();
  int i1=g[i];
  ans1.push_back(i1);
  i1=a[i1];
  while (b[i1]>0) {ans1.push_back(i1); i1=a[i1];}
  if (ans1.size()>ans.size()) ans=ans1;
}
reverse(ans.begin(),ans.end());
cout<<ans.size()<<endl;
for (int i=0;i<ans.size();i++) cout<<ans[i]<<" ";
return 0;
}
