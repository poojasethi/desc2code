#include <iostream>

using namespace std;
int n,s,w;
int type[100001];
int trace[100001];
int cal[100001];
int stackm[100001];
int sm;
int main()
{
    w=0;
   cin >> n;
for (int i=0;i<n;i++) cal[i]=0;
for (int i=1;i<=n;i++) {cin >> s;  if (s==1) {type[w]=i;w++;} }
for (int i=1;i<=n;i++) {
    cin >> s;
    cal[s]++;
    trace[i]=s;
}
s=-1;
int h=0;
int k=0;
for (int i=0;i<w;i++)
{
 k=trace[type[i]];
 h=1;
 while (cal[k]==1 && k!=0) {k=trace[k];h++;}
 if (h>s) {sm=i;s=h;}
}
cout << s << "\n";
h=0;
k=trace[type[sm]];
stackm[0]=type[sm];
h=1;
while (cal[k]==1 && k!=0) {stackm[h]=k;k=trace[k];h++;}
for (int i=h-1;i!=-1;i--) { cout << stackm[i]  << " "; }
}
