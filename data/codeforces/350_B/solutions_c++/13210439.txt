#include <bits/stdc++.h>

using namespace std;

int main() {
	int hotels[100001],path[100001];
	int dup[100001]={};
	int n,a,i,j=0,k,hot,c,h;
	cin>>n;
	for(i=0;i<n;i++) {
		cin>>a;
		if(a==1)
			hotels[j++]=i;
	}
	for(i=0;i<n;i++) {
		cin>>path[i];
		dup[path[i]]++;
	}
	hot=0,h=0;
	for(i=0;i<j;i++) {
		k=hotels[i];
		c=1;
		while(path[k]!=0&&dup[path[k]]==1) {
			c++;
			k=path[k]-1;
		}
		if(c>h) {
			h=c;
			hot=hotels[i];
		}
	}
	int find[100001];
	k=hot;
	int l=0;
	while(path[k]!=0&&dup[path[k]]==1) {
			find[l++]=k;
			k=path[k]-1;
	}
	find[l++]=k;
	if(l==0) printf("1\n1\n");
	else {
		printf("%d\n",l);
		for(i=l-1;i>=1;i--) printf("%d ",find[i]+1);
		printf("%d\n",find[i]+1);
	}







	return 0;
}