#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 100010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m;
int type[N],a[N],in[N],g[N],an[N];
inline void dfs(int x) {
	if (!x||in[x]>1) {
		if (*g>*an) {
			memcpy(an,g,sizeof(an));
		}
		return;
	}
	g[++*g]=x;
	dfs(a[x]);
}
int main() {
	scanf("%d",&n);
	For(i,1,n) scanf("%d",&type[i]);
	For(i,1,n) scanf("%d",&a[i]),in[a[i]]++;
	For(i,1,n) if (type[i]) *g=0,dfs(i);
	printf("%d\n",*an);
	for (i=*an;i;i--) printf("%d ",an[i]);
	printf("\n");
	//for(;;);
	return 0;
}
