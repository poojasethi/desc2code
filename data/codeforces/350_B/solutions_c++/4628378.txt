#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
#include <iostream>
using namespace std;
int n;
int a[510000],b[510000];
int ans[510000],sum;
int temp[510000],tot;
int d[510000];
int main()
{
	cin>>n;
	for (int i = 1;i <= n;i++)	
		scanf("%d",&a[i]);
	for (int i = 1;i <= n;i++)
		scanf("%d",&b[i]),d[b[i]]++;
	for (int i = 1;i <= n;i++)
	if (a[i]==1)
	{
		tot=0;
		temp[++tot]=i; 
		for (int j = b[i];d[j]==1&&j;j=b[j])
		temp[++tot]=j;
		if (tot>sum) 
		{
		for (int j = 1;j <= tot;j++)
		ans[j]=temp[j];
		sum=tot;
		}
	}
	cout<<sum<<endl;
	for (int i = sum;i >= 1 ;i--)
	printf("%d ",ans[i]);
	return 0;
}