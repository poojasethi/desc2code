#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<queue>
#include<cstdlib>
using namespace std;
int f[100001];
int t[100001];
int d[100001];
int n;
int maxl;
int a;
void dfs(int k)
{
	if(k == 0 || d[k] > 1)
		return ;
	dfs(f[k]);
	cout << k << " ";
}
int main()
{
	cin>> n;
	for(int i = 1; i <= n; i++)
		cin >> t[i];
	for(int i = 1; i <= n; i++)
	{
		cin >> f[i];
		d[f[i]] ++;
	}
	int l, k;
	for(int i = 1; i <= n; i++)
		if(t[i] == 1)
		{
			l = 1;
			k = f[i];
			while(k != 0 && d[k] == 1)
			{
				k = f[k];
				l ++;
			}
			if(l > maxl)
			{
				maxl = l;
				a = i;
			}
		}
	cout << maxl << endl;
	dfs(a);
	return 0;
}
