#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define N 120000
using namespace std;
int n,num[N],type[N],i,fa[N],f[N],id,bo[N],x;
void dfs(int x){
	if(bo[x])return;
	bo[x]=1;
	if(type[x]==1){
		f[x]=0;
		return;
	}
	if(num[x]==1){
		dfs(fa[x]);
		f[x]=f[fa[x]]+1;
	}
}
int main(){
	scanf("%d",&n);
	for(i=1;i<=n;++i)scanf("%d",&type[i]);
	for(i=1;i<=n;++i)scanf("%d",&x),num[x]++,fa[x]=i;
	memset(f,130,sizeof(f));
	for(i=1;i<=n;++i)if(!bo[i])dfs(i);
	id=1;
	for(i=1;i<=n;++i)if(f[i]>f[id])id=i;
	printf("%d\n",f[id]+1);
	for(i=id;type[i]==0;i=fa[i])printf("%d ",i);
	printf("%d\n",i);
}
