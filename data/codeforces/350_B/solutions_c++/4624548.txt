#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>

using namespace std;

int n,i,j,L,l,t,a[100005],b[100005],f[100005],g[100005],d[100005];

int main()
{	//freopen("B.in","r",stdin);
	//freopen("B.out","w",stdout);
	scanf("%d",&n); for (i=1;i<=n;i++) scanf("%d",&a[i]);
	for (i=1;i<=n;i++) scanf("%d",&b[i]),f[b[i]]++; L=l=0;
	for (i=1;i<=n;i++) if (a[i]==1)
	{	g[l=1]=i;
		while (b[g[l]]!=0&&f[b[g[l]]]<2) t=b[g[l]],g[++l]=t;
		if (L<l) for (L=l,j=1;j<=l;j++) d[j]=g[j];
		}
	printf("%d\n",L); for (j=L;j>1;j--) printf("%d ",d[j]); printf("%d",d[1]);
	return 0;
}
