#include <bits/stdc++.h>

using namespace std;

int n;
int A[100005];
int B[100005];
int C[100005];
vector<int>T,R;

void read()
{
	int i;
	cin >> n;
	for(i=1 ; i<=n ; i++)
		scanf("%d",&A[i]);
	for(i=1 ; i<=n ; i++)
	{
		scanf("%d",&B[i]);
		C[B[i]]++;
	}
}

void solve()
{
	int i,j,k;
	for(i=1 ; i<=n ; i++)
	{
		if(A[i]==1)
		{
			k=i;
			while(C[i]<=1 and i!=0)
			{
				T.push_back(i);
				i=B[i];
			}
			i=k;
			if(T.size()>R.size()) R=T;
			T.clear();
		}
	}
	reverse(R.begin(),R.end());
	cout << R.size() << endl ;
	for(i=0 ; i<R.size() ; i++)
		cout << R[i] << ' ' ;
	cout << endl ;
}

int main()
{
	read();	
	solve();
}
