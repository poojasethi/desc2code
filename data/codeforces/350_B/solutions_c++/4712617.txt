#include <iostream>
#include <algorithm>
using namespace std;
#define MAXN 111111
int N,A[MAXN],D[MAXN],Ans,U;
bool Type[MAXN];
void out(int u)
{
    if(A[u]&&D[A[u]]==1)
        out(A[u]);
    cout<<u<<" ";
}
int main()
{
    cin>>N;
    for(int n=1;n<=N;++n)
        cin>>Type[n];
    for(int n=1;n<=N;++n)
    {
        cin>>A[n];
        if(A[n])
            ++D[A[n]];
    }
    for(int n=1;n<=N;++n)
        if(Type[n])
        {
            int num=1;
            for(int m=n;A[m]&&D[A[m]]==1;m=A[m],++num);
            if(num>Ans)
            {
                Ans=num;
                U=n;
            }
        }
    cout<<Ans<<endl;
    out(U);
    return 0;
}
