#include<iostream>

using namespace std;

struct W 
{
	int prev, v, next;
};
W a[100010];
int main()
{
	int n;
	cin>>n;
	int x;
	for(int i = 1; i <= n; i++)
		cin>>a[i].v;	
	for(int i = 1; i <= n; i++)
	{
		cin>>x;
		a[i].prev = x;
		a[x].next++;
	}
	int maxk = -1;
	int ans[100010];
	for(int i = 1; i <= n; i++)
		if(a[i].v == 1)
		{
			int k = 0;
			int j = i;
			int p[100010], sz = 1;
			while(a[j].next < 2 && j != 0)
			{
				k++;
				p[sz++] = j;
				j = a[j].prev;
			}
			if(maxk < k)
			{
				maxk = k;
				for(int i = 1; i <= maxk; i++)
					ans[i] = p[i];
			}
		}	
	cout<<maxk<<"\n";
	for(int i = maxk; i >= 1; --i)
		cout<<ans[i]<<" ";	

	return 0;
}