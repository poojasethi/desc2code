#include<iostream>
using namespace std;
int a[100001],b[100001];
int c[100001],d[100001];
void func(int k)
{
  if (k==0)return ;
  if(c[b[k]]==1)func(b[k]);
  cout<<k<<" ";
}
int main()
{
    int n,m,k,max=0,s=0,i,j,l=0;
    cin>>n;
    for(i=1;i<=n;i++) cin>>a[i];
    for(i=1;i<=n;i++)
    { 
      cin>>b[i];
      c[b[i]]++;
    }
    for(i=1;i<=n;i++)
    {
      if (a[i])
      {
        j=b[i]; s=1;
        while(c[j]==1 && j)
        {
          j = b[j];
          s++;
        }
        if (s > max) max=s, k=i;
      }
    }
    cout<<max<<endl;
    func(k);
//    getchar(); getchar();
    return 0;
}
