#include<iostream>
#include<stdio.h>
#include<math.h>
#include<algorithm>
#include<queue>
#include<string>
#include<map>
#include<set>
using namespace std;
const int MAXN=222222;
int a[MAXN],name[MAXN],ob[MAXN],du[MAXN],tmp[MAXN];
int main()
{
    int n,i,ans=0,tot,j,now;scanf("%d",&n);for (i=1;i<=n;i++)scanf("%d",&name[i]);for (i=1;i<=n;i++){scanf("%d",&ob[i]);du[ob[i]]++;}
    for (i=1;i<=n;i++)if (name[i]==1){
        tot=1;tmp[1]=i;for (now=ob[i];(du[now]==1)&&(now!=0);now=ob[now]){tot++;tmp[tot]=now;}
        if (tot>ans){for (j=1;j<=tot;j++)a[j]=tmp[j];ans=tot;}
    }
    printf("%d\n",ans);for (i=ans;i>=1;i--)printf("%d ",a[i]);
}

 	   				 	  	  			  		 		