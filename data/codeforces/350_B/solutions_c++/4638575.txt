#include<cstdio>
using namespace std;
int n,dizi[100001],dizi2[100001],mark[100001];
int syc,mmax,ind,t,path[100001];
void rec(int x){
	if(x==0) return;
	//printf("%d\n",x);
	syc++;
	path[t++]=x;
	if(mark[dizi2[x]]==1) rec(dizi2[x]);
	
}
int main( )
{
scanf("%d",&n);
for(int i=1;i<=n;i++) scanf("%d",&dizi[i]);
for(int i=1;i<=n;i++) scanf("%d",&dizi2[i]);
	for(int i=1;i<=n;i++) mark[dizi2[i]]++;
	
for(int i=1;i<=n;i++){
	syc=0;
	t=0;
	if(dizi[i]==1){rec(i); }
	if(syc>mmax){mmax=syc; ind=i;}	
}
t=0;
rec(ind);
printf("%d\n",mmax);
for(int i=t-1;i>=0;i--) printf("%d ",path[i]);
}
