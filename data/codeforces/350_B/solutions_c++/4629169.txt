#include<iostream>
using namespace std;

const int maxn=200000;
int n,d[maxn],a[maxn],b[maxn],l[maxn],q[maxn],id[maxn],h=-1,t=-1;
int main(){
	cin>>n;
	for (int i=1;i<=n;i++){
		cin>>b[i];
		if (b[i] == 1){
			q[++t]=i;
			d[i]=1;
		}
	}
	for (int i=1;i<=n;i++){
		cin>>a[i];
		id[a[i]]++;
	}

	while (h++<t){
		if ((a[q[h]]!=0) && (b[a[q[h]]]!=1) && (d[a[q[h]]]<d[q[h]]+1) && (id[a[q[h]]] == 1)){
			q[++t]=a[q[h]];
			d[a[q[h]]]=d[q[h]]+1;
			l[a[q[h]]]=q[h];
		}
	}

	int ans=0,ansp;
	for (int i=1;i<=n;i++)
		if (d[i]>ans){
			ans=d[i];
			ansp=i;
		}
	cout<<ans<<endl;
	while (b[ansp]!=1){
		cout<<ansp<<" ";
		ansp=l[ansp];
	}
	cout<<ansp<<endl;

	return 0;
}
