#include <cstdio>
#include <algorithm>
using namespace std;

const int N = 100005;

int n, t[N], a[N], d[N];

int dfs(int x, int c) {
	if(!x || d[x] > 1) return c;
	return dfs(a[x], c+1);
}

void print(int x) {
	if(!x || d[x] > 1) return;
	print(a[x]);
	printf("%d ", x);
}

int main() {
	scanf("%d", &n);
	for(int i = 1; i <= n; ++i) scanf("%d", t+i);
	for(int i = 1; i <= n; ++i) {
		scanf("%d", a+i);
		if(a[i]) ++d[a[i]];
	}
	int ans = 0, hotel = -1;
	for(int i = 1; i <= n; ++i) {
		if(t[i]) {
			int cnt = dfs(i, 0);
			if(cnt > ans) {
				ans = cnt;
				hotel = i;
			}
		}
	}
	printf("%d\n", ans);
	print(hotel);
}
