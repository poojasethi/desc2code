#include<stdio.h>
int n;
int a[100004];
int b[100004];
int c[100004];
int max;
int mi[100005];
int path[100005];
int pl;
int main()
{
	int i, j, k;
	scanf("%d",&n);
	for(i=1; i<=n; i++)
		scanf("%d",&b[i]);
	for(i=1; i<=n; i++)
	{
		scanf("%d",&a[i]);
		if(a[i]>0)
			c[a[i]]++;
	}
	for(i=1;i<=n;i++)
	{
		if(b[i]==1)
		{
			j = a[i];
			path[0] = i;
			pl=1;
			k=1;
			while(j>0)
			{
				if(c[j]>1)
					break;
				path[pl] = j;
				pl++;
				j = a[j];
				k++;
			}
			if(max < k)
			{
				max = k;
				for(j=0;j<pl;j++)
				{
					mi[j] = path[j];
				}
			}
		}
	}
	printf("%d\n",max);
	for(i=max-1;i>=0;i--)
		printf("%d ",mi[i]);
	
}