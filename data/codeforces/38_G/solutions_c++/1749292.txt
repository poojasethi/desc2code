#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<climits>
using namespace std;
int n,root,a[100001],c[100001],p[100001],sum[100001],save[100001],link[100001][2];
void update(int key){
    sum[key] = 1 + sum[link[key][0]] + sum[link[key][1]];
    save[key] = max( max( save[link[key][0]],save[link[key][1]] ),a[key] );     
}
void rotate(int &now,int t){
    int tmp = link[now][t];
    link[now][t] = link[tmp][1^t];
    link[tmp][1^t] = now;
    update(now); update(tmp);
    now = tmp;     
}
void insert(int &now,int key){
    if(now){
         int t = 0;
         if( max( a[now],save[link[now][1]] ) <= a[key] && 1 + sum[link[now][1]] <= c[key] )   
              c[key] -= 1 + sum[link[now][1]], insert(link[now][0],key);
         else
              t = 1, insert(link[now][1],key);
         if( p[link[now][t]] > p[now] )
             rotate(now,t);
    }
    else  p[now = key] = rand();   
    update(now);
}
void Pr(int now){
    if(now){
        Pr(link[now][0]); printf("%d ",now); Pr(link[now][1]);        
            
    }     
}
int main(){
    scanf("%d",&n);
    p[0] = INT_MAX; sum[0] = 0; save[0] = INT_MIN;
    for(int i=1;i<=n;i++){
        scanf("%d%d",&a[i],&c[i]);
        insert(root,i);
    }
    Pr(root);
    //system("pause");
    return 0;
}
