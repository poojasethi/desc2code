#include <iostream>
#include <cstdio>
#include <cmath>
using namespace std;
int a[100010],c[100010],km[10000],kn[10000],ktop[100010],kk[100010],
	l[100010],r[100010],i,j,k,n,knum,x,y;
int main()
{
		scanf("%d\n",&n);k=sqrt(n);
		for (i=1;i<=n;++i) scanf("%d%d\n",&a[i],&c[i]);
		km[knum=1]=a[1];kn[1]=ktop[1]=kk[1]=1;l[0]=r[0]=1;l[1]=r[1]=0;
		ktop[0]=kk[0]=1;
		kk[0]=1;a[0]=n+1;
		for (i=2;i<=n;++i)
		{
			for (j=c[i],x=l[0];x && j>=kn[kk[x]] && km[kk[x]]<a[i];x=l[ktop[x]]) j-=kn[kk[x]];
			for (;j && x && a[x]<a[i];j--) x=l[x];
			l[i]=x;r[i]=r[x];l[r[x]]=i;r[x]=i;
			++kn[kk[x]];ktop[i]=ktop[x];kk[i]=kk[x];km[kk[x]]=max(km[kk[x]],a[i]);
			if (!x)
			{
				for (x=r[0];x && ktop[l[x]]==ktop[x];x=r[x]);
				for (x=l[x];x;x=l[x]) ktop[x]=i;ktop[0]=i;
			}
			if (kn[kk[x]]>=k*2)
			{
				x=ktop[x];y=kk[x];km[y]=0;kn[y]=k;
				for (j=1;j<=k;++j,x=r[x]) km[y]=max(km[y],a[x]);
				kn[++knum]=k;y=x;
				for (j=1;j<=k;++j,x=r[x])
					km[knum]=max(km[knum],a[x]),kk[x]=knum,ktop[x]=y;
			}
		}
		for (i=r[0];i;i=r[i]) printf("%d ",i);
}