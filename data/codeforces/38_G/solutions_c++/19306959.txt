#include <cstdio>
#include <algorithm>
#include <vector>
using namespace std;
const int sq=500,maxn=1e5 ;
vector<vector<int> > vv,yadak ;
int nb[sq] ;
int import[maxn+1] ;
void t()
{
	yadak=vv ;
	vv.clear() ;
	for(int i=0;i<sq;i++)
		nb[i]=0 ;
	int maxi=0 ;
	vv.push_back(vector<int>(0)) ;
	for(int i=0;i<yadak.size();i++)
		for(int j=0;j<yadak[i].size();j++)
		{	
			if(vv.back().size()==sq)
			{ 
				nb[vv.size()-1]=maxi ;
				maxi=0;
				vv.push_back(vector<int>(0)) ;
			}
			maxi=max(maxi,yadak[i][j]) ;
			vv.back().push_back(yadak[i][j]) ;
		}
	nb[vv.size()-1]=maxi ;
}
void pushing (int pos,int a,int c)
{	
	nb[pos]=max(nb[pos],a) ;
	vv[pos].push_back(a) ;
	for(int i=vv[pos].size()-1;i>0;i--)
		if(c==0 || a<vv[pos][i-1])
			return ;
		else
		{
			c-- ;
			swap(vv[pos][i],vv[pos][i-1]) ;
		}
}

void add(int pos,int a,int c)
{
	if(nb[pos]>a || vv[pos].size()>c || pos==0)
		pushing(pos,a,c) ;
	else
		add(pos-1,a,c-vv[pos].size()) ;
}
int main()
{
	int n ;
	scanf("%d",&n) ;
	vv.push_back(vector<int>(0)) ;
	for(int i=0;i<n;i++)
	{
		int a,c; 
		scanf("%d %d",&a,&c) ;
		import[a]=i+1 ;
		add(vv.size()-1,a,c) ;
		if(i%sq==260)
			t() ;

	}
	for(int i=0;i<vv.size();i++)
		for(int j=0;j<vv[i].size();j++)
			printf("%d ",import[vv[i][j]]) ;
	
}

