#include<stdio.h>
#include<string.h>
#include<map>
#include<algorithm>
using namespace std;
const int maxn=500050;
int n,m,a[maxn],l[maxn],r[maxn],ans[maxn];
map<int,int> ap;
int ord[maxn];
int tr[maxn];
bool cmp(const int &xx,const int &yy) { return r[xx]<r[yy]; }
int main()
{
	int i,j,k,t;
	memset(tr,3,sizeof(tr));
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;i++)
		scanf("%d",&a[i]);
	for(i=0;i<m;i++)
		ord[i]=i,scanf("%d%d",&l[i],&r[i]);
	sort(ord,ord+m,cmp);
	for(i=0,j=1;i<m;i++)
	{
		t=ord[i];
		while(j<=r[t])
		{
			if(ap.count(a[j]))
				for(k=ap[a[j]];k;k-=k&-k)
					tr[k]=min(tr[k],j-ap[a[j]]);
			ap[a[j]]=j;
			j++;
		}
		for(k=l[t],ans[t]=1e6;k<=n;k+=k&-k)
			ans[t]=min(ans[t],tr[k]);
	}
	for(i=0;i<m;i++)
		printf("%d\n",ans[i]==1e6?-1:ans[i]);
	return 0;
}
