#include <bits/stdc++.h>
using namespace std;
const int N = 5e5+17;
int n,m,a[N],c[N],ans[N];
pair<int,pair<int,int> >q[N];
#define bit(x) x&(-x)
map<int,int>hash;
int main(){
	scanf("%d%d",&n,&m);int i,j,k;
	for(i=1;i<=n;++i)scanf("%d",&a[i]);
	for(i=1;i<=m;++i)scanf("%d%d",&q[i].second.first,&q[i].first),q[i].second.second=i,q[i].second.first*=-1;
	sort(q+1,q+1+m);
	memset(c,0x3f,sizeof(c));
	int x=1,r,ret;
	for(i=1;i<=m;++i){
		r= q[i].first;
		while(x<=r){
			if(hash.find(a[x])!=hash.end()){
				k=hash[a[x]];
				c[k]= min(c[k],x-k);
				for(j=k;j>=1;j-=bit(j))
					c[j]=min(c[j],c[k]);
			}
			hash[a[x]]=x;
			++x;
		}
		ret=0x3f3f3f3f;
		for(j=-q[i].second.first;j<=n;j+=bit(j))
			ret=min(ret,c[j]);
		ans[q[i].second.second]= ret==0x3f3f3f3f ? -1 : ret;
	}
	for(i=1;i<=m;++i)
		printf("%d ",ans[i]);
	putchar('\n');
}
