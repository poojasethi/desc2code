#include "bits/stdc++.h"
using namespace std;
int n, m;
const int maxn = 5e5 + 5;
int ans[maxn], order[maxn], l[maxn], r[maxn];
int res[maxn], tr[maxn];
const int INF = 0x3f3f3f3f;
map<int, int> mp;

void read()
{
    scanf("%d%d", &n, &m);
    int i, j;
    for(i = 1; i <= n; ++i)
        scanf("%d", &ans[i]);
    for(i = 1; i <= m; ++i) {
        order[i] = i;
        scanf("%d%d", &l[i], &r[i]);
    }
}

bool cmp(int a, int b)
{
    return r[a] < r[b];
}

void pre()
{
    sort(order + 1, order + 1 + m, cmp);
    memset(res, 0x3f, sizeof(res));
    memset(tr, 0x3f, sizeof(tr));
}

void solve()
{
    int i, j, k;
    for(i = j = 1; i <= m; ++i) {
        int o = order[i];
        while(j <= r[o]) {
            if(mp.count(ans[j])) {
                int pos = mp[ans[j]];
                for(k = pos; k; k -= k&-k) {
                    tr[k] = min(tr[k], j - pos);
                }
            }
            mp[ans[j]] = j;
            ++j;
        }
        for(k = l[o]; k <= r[o]; k += k&-k) {
            res[o] = min(res[o], tr[k]);
        }
    }
    for(i = 1; i <= m; ++i)
        printf("%d\n", res[i] == INF? -1: res[i]);
}

int main()
{
    read();
    pre();
    solve();
    return 0;
}
