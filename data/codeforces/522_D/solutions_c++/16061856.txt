#include<bits/stdc++.h>
#define st first
#define nd second
#define mp make_pair
#define pb push_back
#define endl '\n'
#define endll puts("")
#define mod 1000000007
#define mp3(x,y,z) mp(x,mp(y,z))
#define pii pair<int,int>  
#define orta ((bas+son)/2)
#define sol (root+root)
#define sag (root+root+1)
#define inf mod
using namespace std;
typedef long long ll;
const int N = 5e5+3;
vector< pii > V[N];
map<int,int> MP;
int n,m,i,j,k,l,s,t,d,u,ii,jj,x,y,z,h[N],hh[N],st[4*N];
int f(int x,int y,int root,int bas,int son)
{
	if(x>son or y<bas)return inf;
	if(x<=bas and y>=son)return st[root];
	return min(f(x,y,sol,bas,orta),f(x,y,sag,orta+1,son));
}
void up(int x,int root,int bas,int son)
{
	if(x>son or x<bas)return ;
	st[root]=min(st[root],z);
	if(bas==son)return;
	up(x,sol,bas,orta);
	up(x,sag,orta+1,son);
}
int main()
{
	cin>>n>>m;
	for(i=1;i<=n;i++)
		scanf("%d",h+i);
	for(i=1;i<=m;i++)
	{
		scanf("%d%d",&x,&y);
		V[y].pb(mp(x,i));
	}
	for(i=1;i<4*N;i++)st[i]=inf;
	for(i=1;i<=n;i++)
	{
		u=V[i].size();
		if(MP[h[i]])
		{
			z=i-MP[h[i]];
			up(MP[h[i]],1,1,n);
		}
		MP[h[i]]=i;
		for(j=0;j<u;j++)
		{
			x=f(V[i][j].st,i,1,1,n);
			hh[V[i][j].nd]=(x==inf?-1:x);
		}
		
	}
	for(i=1;i<=m;i++)
		printf("%d\n",hh[i]);

}
