#include <bits/stdc++.h>
using namespace std;

const int MAXN = 5e5+100 , inf = 1<<20;

map < int , int > last;
int N,M,ar[MAXN],srt[MAXN],l[MAXN],r[MAXN],fnw[MAXN],ans[MAXN];

bool comp( const int &x , const int &y ){
	return r[x] < r[y];
}

int main(){
	
	scanf("%d%d",&N,&M);
	
	for( int i=1 ; i <= N ; i++ )
		scanf("%d",&ar[i]);
	
	for( int i=1 ; i <= M ; i++ )
		scanf("%d%d",&l[i],&r[i]) , srt[i] = i;
	
	sort( srt+1 , srt+M+1 , comp );
	
	memset( fnw , 1 , sizeof fnw );
	
	for( int i=1,j=0,k,tmp ; i <= M ; i++ ){
		
		k = srt[i];
		
		while( j < r[k] ){
			
			j++;
			
			if( last[ar[j]] ){
				
				tmp = last[ar[j]];
				
				for( int idx = tmp ; idx ; idx &= idx-1 )
					fnw[idx] = min( fnw[idx] , j-tmp );
			}
			
			last[ar[j]] = j;
		}
		
		ans[k] = inf;
		
		for( int idx = l[k] ; idx <= N ; idx += idx & -idx )
			ans[k] = min( ans[k] , fnw[idx] );
		
	}
	
	for( int i=1 ; i <= M ; i++ )
		if( ans[i] >= N )
			printf("-1\n");
		else
			printf("%d\n",ans[i]);
	
	return 0;
}
