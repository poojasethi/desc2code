#include <bits/stdc++.h>
#define rep(i, a, b) for(int i = (int)a; i < (int)b; i++)
#define red(i, a, b) for(int i = a; i > b; i--)
#define RED true
#define BLACK false
#define pb push_back
#define mk make_pair
#define fi first
#define se second
using namespace std;
typedef pair<int, int> ii;
typedef long long ll;
typedef pair<ii, int> iii;
typedef vector<int> vi;
const int N = 5e5 + 7;
const int M = 1e9;
const int inf = 1e9 + 7;
const ll base = 1e18;
const double pi = acos(-1);
const double ep = 1e-9;


int L[N];
map<int, int> gt;
int a[N], ans[N];
vector<iii> q;
int n, m;

int main(){
    //freopen("in.txt", "r", stdin);
    cin >> n >> m;
    rep(i, 0, n)
        scanf("%d", &a[i + 1]);
    rep(i, 0, m){
        int u, v;
        scanf("%d%d", &u, &v);
        q.push_back(mk(mk(v, u), i));
    }
    rep(i, 1, n + 1) L[i] = inf;
    sort(q.begin(), q.end());
    for(int i = 0, j = 1; i < m; i++){
        while (j <= q[i].fi.fi){
            if (gt.count(a[j])){
                int pre = gt[a[j]];
                for(int t = pre; t > 0; t -= t & -t)
                    L[t] = min(L[t], j - pre);
            }
            gt[a[j]] = j;
            j++;
        }
        int res = inf;
        for(int t = q[i].fi.se; t <= n; t += t & -t)
            res = min(res, L[t]);
        ans[q[i].se] = res;
    }
    rep(i, 0, m)
        if (ans[i] == inf) puts("-1");
        else printf("%d\n", ans[i]);
}