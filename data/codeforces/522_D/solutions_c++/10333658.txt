#include "bits/stdc++.h"
using namespace std;
const int maxn = 5e5 + 5;
const int INF = 0x3f3f3f3f;
int n, m;
int ans[maxn], order[maxn], l[maxn], r[maxn];
int res[maxn];
map<int , int> mp;
int tr[maxn];

bool cmp(int a, int b)
{
    return r[a] < r[b];
}

int main()
{
    int i, j;
    scanf("%d%d", &n ,&m);
    for(i = 1; i <= n; ++i) {
        scanf("%d", &ans[i]);
    }
    for(i = 1; i <= m; ++i) {
        scanf("%d%d", &l[i], &r[i]);
        order[i] = i;
    }

    memset(tr, 0x3f, sizeof(tr));
    memset(res, 0x3f, sizeof(res));
    sort(order + 1, order + 1 + m, cmp);
    for(i = j = 1; i <= m; ++i) {
        int o = order[i];
        while(j <= r[o]) {
            if(mp[ans[j]]) {
                int pos = mp[ans[j]];
                for(int k = pos; k; k -= k&-k)
                    tr[k] = min(tr[k], j - pos);
            }
            mp[ans[j]] = j;
            ++j;
        }
        for(int k = l[o]; k <= r[o]; k += k&-k)
            res[o] = min(res[o], tr[k]);
    }
    for(i = 1; i <= m; ++i)
        printf("%d\n", res[i] == INF? -1: res[i]);
}
