#include<bits/stdc++.h>

using namespace std;

#define inf 1000000009
#define tm (tl + tr >> 1)
#define N 500005

vector < pair < int , int > > V[N];

map < int , int > last;

int s[4*N],A[N],T[N],n,q,i,j,pos,l,r,ddd;

int qry(int v, int tl, int tr){
	if(tl > r || tr < l)
		return inf;
	if(tl >= l && tr <= r)
		return s[v];
   return min( qry(v*2, tl, tm) , qry(v*2+1, tm+1, tr) );
}
void up(int v, int tl, int tr){
	if(tl == tr){
		s[v] = ddd;
		return;
	}
	if(pos <= tm)
		up(v*2, tl, tm);
	else
		up(v*2+1, tm+1, tr);		
	s[v] = min( s[v*2] , s[v*2+1] );
}

int main(){

	cin >> n >> q;

	for(i=1;i<=n;i++)
	    scanf("%d",&A[i]);

	for(i=1;i<=q;i++){
		scanf("%d%d",&l,&r);
		V[r].push_back( make_pair(l,i) );
	}

	fill(s , s+4*N, inf);

	for(i=1;i<=n;i++){

		if(last[ A[i] ]){
			pos = last[ A[i] ];
			ddd = i - last[ A[i] ];
			up(1,1,n);
		}

		last[ A[i] ] = i;

		for(j=0;j<V[i].size();j++){
			l = V[i][j].first;  r = i;
			T[ V[i][j].second ] = qry(1,1,n);
		}
	}

	for(j=1;j<=q;j++)
		cout << (T[j] == inf ? -1 : T[j]) << endl;
	
	return 0;
}
