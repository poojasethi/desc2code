#include <bits/stdc++.h>
using namespace std;
int a[1048576], b[524288];
map<int, int> last;
int L, R;
int query(int id, int l, int r) {
  if (l > R || r < L || a[id] == 99999999) return 99999999;
  if (L <= l && r + a[id] <= R) return a[id];
  if (l == r) return 99999999;
  int mid = (l + r) / 2;
  if (mid + 1 + a[id] > R) return query(id * 2, l, mid);
  return min(query(id * 2, l, mid), query(id * 2 + 1, mid + 1, r));
}
int main() {
  int n, q;
  scanf("%d %d", &n, &q);
  for (int i = 0; i < n; i++) {
    scanf("%d", &b[i]);
    if (last.find(b[i]) != last.end()) {
      a[524288 + last[b[i]]] = i - last[b[i]];
    }
    last[b[i]] = i;
    a[524288 + i] = 99999999;
  }
  for (int i = n; i < 524288; i++) {
    a[i] = 99999999;
  }
  n = 524288;
  for (int i = n - 1; i; i--) {
    a[i] = min(a[2 * i], a[2 * i + 1]);
  }
  for (int i = 0; i < q; i++) {
    scanf("%d %d", &L, &R);
    int x = query(1, 1, n);
    printf("%d\n", x == 99999999 ? -1 : x);
  }
  return 0;
}
