#include<stdio.h>
#include<map>
#include<algorithm>
#define pb push_back
#define N 500005
using namespace std;
map<int,int>Hash;int n,m,i,x,k;
int L[N],R[N],a[N],id[N],f[N],ans[N];
int cmp(const int &A,const int &B){return R[A]<R[B];}
void add(int x,int s){for (;x;x-=x&-x) f[x]=min(f[x],s);}
int ask(int x){int s=n+1;for (;x<=n;x+=x&-x) s=min(f[x],s);return s;}
int main(){
    scanf("%d%d",&n,&m);
    for (i=1;i<=n;i++){
        scanf("%d",&x);
        if (Hash.find(x)!=Hash.end())
            a[i]=Hash[x];
        Hash[x]=i;f[i]=n+1;
  }for (i=1;i<=m;i++)
    scanf("%d%d",&L[i],&R[i]),id[i]=i;
  sort(id+1,id+m+1,cmp);
    for (i=1;i<=n;i++){
    if (a[i]) add(a[i],i-a[i]);
    for (;k<m&&R[id[k+1]]<=i;)
            ++k,ans[id[k]]=ask(L[id[k]]);
  }for (i=1;i<=m;i++)
    printf("%d\n",ans[i]==n+1?-1:ans[i]);
}