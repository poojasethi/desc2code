#include <bits/stdc++.h>

#define mp make_pair
#define st first
#define nd second
#define pb push_back

using namespace std;

typedef long long ll;
typedef pair< ll,ll > pll;
typedef pair< int,int > pii;

const int inf = 1000000000, N = 500000;

int n, m, fen[N+5], ans[N+5];
vector< pair<pii, int> > v;
vector<pii> pre;
map<int, int> Map;

int que(int x) {
	int mn = inf;

	for (; x; x -= x & -x)
		mn = min(mn, fen[x]);
	
	return mn;
}

void upd(int x, int t) {
	for (; x <= n; x += x & -x)
		fen[x] = min(fen[x], t);
}

int main()
{
	int x, y;

	scanf("%d %d", &n, &m);

	for (int i = 1; i <= n; i++) {
		scanf("%d", &x);
	
		pre.pb( mp(Map[x], i) );
		Map[x] = i;
	}

	sort(pre.begin(), pre.end());

	for (int i = 1; i <= m; i++) {
		scanf("%d %d", &x, &y);

		v.pb( mp(mp(x, y), i) );
	}

	sort(v.begin(), v.end());

	for (int i = 1; i <= n; i++)
		fen[i] = inf;

	for (int i = m - 1, j = n - 1; i >= 0; i--) {
		for (; j >= 0 && pre[j].st >= v[i].st.st; j--)
			upd(pre[j].nd, pre[j].nd - pre[j].st);

		ans[v[i].nd] = que(v[i].st.nd);
	}
		
	for (int i = 1; i <= m; i++)
		printf("%d\n", ans[i] < inf ? ans[i] : -1);
	
	return 0;
}
