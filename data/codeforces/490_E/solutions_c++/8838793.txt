#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t,c,c1,v,v1,y=2000000000,s[100000];
  char a[100000][10];
  cin>>q;
  for(w=0;w<q;w++)
   scanf("%s",a[w]);
  for(w=q-1;w>=0;w--){
   v=c=0;c1=1;
   for(e=0;a[w][e];e++);
   for(r=e-1;r>=0;r--){
    if(a[w][r]!='?')
     v+=(a[w][r]-48)*c1;
    c1*=10;}
   if(c>=y){
    cout<<"NO";
    return 0;}
   c=0;
   for(r=0;r<e;r++){
    c1/=10;
    v%=c1;
    c*=10;
    if(a[w][r]!='?'){
     c+=a[w][r]-48;
     continue;}
    for(v1=9;v1>=0;v1--)
     if((c+v1)*c1+v<y){
      c+=v1;
      break;}
    if((r==0)&&((v1==0)&&(e>1))){
     cout<<"NO";
     return 0;}}
   if(c>=y){
    cout<<"NO";
    return 0;}
   s[w]=y=c;}
  cout<<"YES\n";
  for(w=0;w<q;w++)
   printf("%d\n",s[w]);
  return 0;}
