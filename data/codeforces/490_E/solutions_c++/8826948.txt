#include<iostream>
#include<cstdio>
using namespace std;
int a[100010];
string s;
int n;
int main() {
//    freopen("test.inp","r",stdin);
    cin >> n;
    int prev=0;
    for(int i=1;i<=n;i++) {
        cin >> s;
        int first=1;
        int p=0;
        for(int j=0;j<s.size();j++) {
            if (s[j]=='?') {
                int tmp,lc=1;
                for(int c=first;c<=9;c++) {
                    tmp=p*10+c;
                    for(int z=j+1;z<s.size();z++) if (s[z]=='?') tmp=tmp*10+9; else tmp=tmp*10+s[z]-'0';
                    if (tmp>prev) {
                        p=p*10+c;
                        lc=0;
                        break;
                    }
                }
                if (lc) { cout << "NO"; return 0; }
            } else p=p*10+s[j]-'0';
            first=0;
        }
        if (p<=prev) { cout << "NO"; return 0; }
        a[i]=p;
        prev=p;
    }
    cout << "YES" << endl;
    for(int i=1;i<=n;i++) cout << a[i] << endl;
}
