#include<cstdio>
#include<cstring>
char s[100010][9];
int n, i, l[100010], a[100010], j;
int gets(int x)
{
    int sum = 0;
    for (int i = 1; i <= l[x]; i++)
        sum = sum * 10 + (s[x][i] == '?' ? 9 : s[x][i] - '0');
    return sum;
}
int main()
{
    scanf("%d", &n);
    for (i = 1; i <= n; i++)
        scanf("\n%s", s[i] + 1), l[i] = strlen(s[i] + 1);
    for (j = 1; j <= l[1]; j++)
        if (s[1][j] == '?') s[1][j] = (j == 1 ? '1' : '0');
    a[1] = gets(1);
    for (i = 2; i <= n; i++)
    {
        if (gets(i) <= a[i - 1]) {printf("NO\n"); return 0;}
        for (j = 1; j <= l[i]; j++)
            if (s[i][j] == '?')
                for (int k = 0; k <= 9; k++)
                {
                    if (j == 1 && !k) continue;
                    s[i][j] = k + '0';
                    if (gets(i) > a[i - 1]) break;
                }
        a[i] = gets(i);
    }
    printf("YES\n");
    for (i = 1; i <= n; i++) printf("%d\n", a[i]);
    return 0;
}