#include<cstdio>
#include<cstring>
const int N=100005;

char str[N][10];
int len[N];

void fill(char *s){
//	puts(s+1);
	for(int i=0;s[i]!='\0';i++){
		if(s[i]=='?'){
			if(i==0)s[i]='1';
			else s[i]='0';
		}
	}
}

bool dfs(char *s1,char *s2,int d,int l){
	if(d>=l)return false;
	if(s1[d]=='?'){
		s1[d]=s2[d];
		if(dfs(s1,s2,d+1,l))
			return true;
		if(s2[d]!='9') {
			s1[d]++;return true;
		}
		s1[d]='?';
		return false;
	}else{
		if(s1[d]==s2[d]) return dfs(s1,s2,d+1,l);
		else if(s1[d]<s2[d])return false;
		else return true;
	}
}

int main()
{
	int n;
	scanf("%d",&n);
	for(int i=1;i<=n;i++){
		scanf("%s",str[i]+1);
//		puts(str[i]+1);
		len[i]=strlen(str[i]+1);
	}
//	puts(str[1]+1);
	fill(str[1]+1);
	int ans_flag=1;
	for(int i=2;i<=n;i++){
		if(len[i]<len[i-1]){
			ans_flag=0;break;
		}else if(len[i]==len[i-1]){
			if(!dfs(str[i]+1,str[i-1]+1,0,len[i])){
				ans_flag=0;break;
			}
			fill(str[i]+1);
		}else{
			fill(str[i]+1);
		}
	}
	if(ans_flag){
		puts("YES");
		for(int i=1;i<=n;i++)
			puts(str[i]+1);
	}else{
		puts("NO");
//		for(int i=1;i<=n;i++)
//					puts(str[i]+1);
	}
	return 0;
}

  		  	 			    						 		  		 		