#include <bits/stdc++.h>

using namespace std;
#define Rep(i, a) for(int i = 0; i < (a); i++)
#define For(i, a, b) for(int i = (a); i <= (b); i++)
#define sz(a) (int)(a.size())

int n;
int pow10[9];
int a[111111];
string s[111111];

int main(){
	cin >> n;
	For(i, 1, n)
		cin >> s[i];
	a[0] = 0;
	pow10[0] = 1;
	For(i, 1, 8){
		pow10[i] = pow10[i-1]*10;
	}
	For(i, 1, n){
		int maxv = 0;
		Rep(j, sz(s[i])){
			if(s[i][j] == '?') maxv = maxv*10 + 9;
			else maxv = maxv*10 + (s[i][j] - '0');
		}
		Rep(j, sz(s[i])){
			if(s[i][j] == '?'){
				For(k ,(j == 0 ? 1:0), 9){
					if(maxv - pow10[sz(s[i]) - j - 1]*(9-k) > a[i-1]){
						maxv -= pow10[sz(s[i]) - j - 1]*(9-k);
						break;
					}
				}
			}
		}
		if(maxv > a[i-1]) a[i] = maxv;
		else{
			cout << "NO" << "\n";
			return 0;
		}
	}
	cout << "YES" << "\n";
	For(i, 1, n){
		cout << a[i] << "\n";
	}
}
