#include <iostream>
using namespace std;
const int MAX = 100005;
string s[MAX];
string best(string s)
{
	if (s[0] == '?')
		s[0] = '1';
	for (int i = 1; i < s.size(); i++)
		if (s[i] == '?')
			s[i] = '0';
	return s;
}
int main()
{
	ios::sync_with_stdio(false);
	int n;
	cin >> n;
	for (int i = 0; i < n; i++)
		cin >> s[i];
	s[0] = best(s[0]);
	for (int i = 1; i < n; i++)
	{
		if (s[i - 1].size() > s[i].size())
		{
			cout << "NO" << endl;
			return 0;
		}
		if (s[i - 1].size() < s[i].size())
		{
			s[i] = best(s[i]);
			continue;
		}
		string res = "BAD";
		for (int j = 0; j < s[i].size(); j++)
		{
			if (s[i][j] == '?')
			{
				if (s[i - 1][j] != '9')
				{
					s[i][j] = (char)(s[i - 1][j] + 1);
					res = best(s[i]);
				}
				s[i][j] = s[i - 1][j];
			}
			else
			{
				if (s[i - 1][j] < s[i][j])
				{
					res = best(s[i]);
					break;
				}
				if (s[i - 1][j] > s[i][j])
					break;
			}
		}
		if (res == "BAD")
		{
			cout << "NO" << endl;
			return 0;
		}
		s[i] = res;
	}
	cout << "YES" << endl;
	for (int i = 0; i < n; i++)
		cout << s[i] << endl;
	return 0;
}
