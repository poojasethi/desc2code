#include<stdio.h>
#include<string.h>
char s[20];
int last = 0,ans[100500],ten[] = {1,10,100,1000,10000,100000,1000000,10000000,100000000};

int calc(int x,int num)
{
	int i,sum = 0;
	char temp[10];
	for(i = 0;i < num;i++)
	{
		temp[i] = x%10 + '0';
		x /= 10;
	}
	for(i = 0;i < strlen(s);i++)
	{
		if(s[i] == '?')
		{
			sum = sum*10+temp[--num]-'0';
		}
		else
		{
			sum = sum*10+s[i]-'0';
		}
	}
	return sum;
}

int search()
{
	int num = 0,i;
	for(i = 0;i < strlen(s);i++)
	{
		if(s[i] == '?')
		{
			num++;
		}
	}
	int l = 0,r = ten[num]-1;
	if(s[0] == '?')
	{
		l = ten[num-1];
	}
	int flag = -1;
	while(l <= r)
	{
		int mid = (l+r)/2;
		if(calc(mid,num) > last)
		{
			flag = mid;
			r = mid-1;
		}
		else
		{
			l = mid+1;
		}
	}
	if(flag == -1)
	{
		return -1;
	}
	else
	{
		return calc(flag,num);
	}
}

int main()
{
	int T,i;
	scanf("%d",&T);
	for(i = 0;i < T;i++)
	{
		scanf("%s",s);
		ans[i] = search();
		if(ans[i] == -1)
		{
			printf("NO\n");
			return 0;
		}
		else
		{
			last = ans[i];
		}
	} 
	printf("YES\n");
	for(i = 0;i < T;i++)
	{
		printf("%d\n",ans[i]); 
	}
}
 	  	  						 		  	 					  			