#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <cmath>
using namespace std;
int n;
const int MAXN = 100010;
char shu[MAXN][9];
int ans[MAXN];

int tran(char *x){
	int ans=0;
	for(int i=0;i<strlen(x);i++)
	{
		if(x[i]=='?') ans=ans*10+9;
		else
			ans = ans*10+x[i]-'0';
	}
	return ans;
}
int main()
{
	scanf("%d",&n);
	getchar();
	int pre=0;
	for(int i=0;i<n;i++){
		scanf("%s",shu[i]);
		if(i) pre=ans[i-1];
		getchar();
		if(tran(shu[i])<=pre){
			cout<<"NO"<<endl;
			return 0;
		}
		else{
			int len = strlen(shu[i]);
			for(int k=0;k<len;k++){
				if(shu[i][k]=='?'){
					int j=0;
					if(k==0) j=1;
					for(;j<10;j++){
						shu[i][k] = j+'0';
						if(tran(shu[i])>pre){
							break;
						}
					}
				}
			}
		}
		ans[i] = tran(shu[i]);
	}
	cout<<"YES"<<endl;
	for(int i=0;i<n;i++){
		cout<<ans[i]<<endl;
	}
	cout<<endl;
	return 0;
}
	  	    				  	 		 	  		  			