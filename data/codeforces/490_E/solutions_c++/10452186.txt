#include<iostream>
using namespace std;

void M(string &s){
	if (s[0]=='?') s[0] = '1';
	for (int i=1 ; i<s.size() ; i++)
		if (s[i]=='?')
			s[i] = '0';
}

const int maxn = 110 * 1000;

int n;
string s[maxn], s2[maxn];
			
int main(){
	ios::sync_with_stdio(0);
	cin >> n;
	for (int i=0 ; i<n ; i++){
		cin >> s[i];
		s2[i] = s[i];
	}	

	M(s[0]);	
			
	for (int i=1 ; i<n ; i++){
		int t1 = s[i-1].size();
		int t2 = s[i].size();
		if (t2 < t1){
			cout << "NO" << endl;
			return 0;
		}else if (t1 < t2){
			M(s[i]);
		}else{
			for (int j=0 ; j<s[i].size() ; j++)
				if (s[i][j] == '?')
					s[i][j] = '9';
			if (s[i] <= s[i-1]){
				cout << "NO" << endl;
				return 0;
			}
			for (int j=0 ; j<s[i].size() ; j++){
				if (s2[i][j]!='?') continue;
				while(1){
					if (s[i][j]=='0' || (s[i][j]=='1' && !j)) break;
					s[i][j]--;
					if (s[i] <= s[i-1]){
						s[i][j]++;
						break;
					}	
				}		
			}	
		}
	}
	cout << "YES" << endl;
	for (int i=0 ; i<n ; i++)
		cout << s[i] << endl;
}
