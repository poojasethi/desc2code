#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<iostream>
using namespace std;

int pre,ten[10],a[100005];
char num[105];
int GetNum(int x)
{
	int len=strlen(num),ret=0,mul=1;
	for(int i=len-1;i>=0;i--)
	{
		if(num[i]=='?') 
		{
			ret+=(x%10)*mul;
			x/=10;
		}
		else ret+=mul*(num[i]-'0');
		mul*=10;
	}
	return ret;
}
int BS(int l,int r)
{
	if(r-l<=1) 
	{
		if(GetNum(l)>pre) return GetNum(l);
		if(GetNum(r)>pre) return GetNum(r);
		return -1;
	}
	int m=(l+r)/2;
	if(GetNum(m)>pre) return BS(l,m);
	return BS(m+1,r);
 }
int main()
{
	ten[0]=1;
	for(int i=1;i<=9;i++) ten[i]=ten[i-1]*10;
	int n,t,ret;
	cin>>n;
	int c=0;
	while(n--)
	{
		t=0;
		cin>>num;
		for(int i=0;i<strlen(num);i++) if(num[i]=='?') t++;
		if(t==0) ret=GetNum(0);
		else ret=num[0]=='?'?BS(ten[t-1],ten[t]-1):BS(0,ten[t]-1);
		if(ret<=pre) {cout<<"NO"<<endl;return 0;}
		pre=ret;
		a[c++]=ret;
	}
	cout<<"YES"<<endl;
	for(int i=0;i<c;i++) printf("%d\n",a[i]);
	return 0;
}