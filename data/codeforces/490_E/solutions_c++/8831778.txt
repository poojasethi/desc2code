#include<cstdio>
#include<map>
#include<string>
#include<cstring>
#include<iostream>
#include<cmath>
#include<vector>
#include<set>
#include<queue>
#include<algorithm>
#include<string>
using namespace std;

typedef long long ll;
typedef pair<int,int>P;
const int size=110003;

int n,Ans[size],pre;
char ch[size][10];
int ex[size];

int dfs(int p,int i,int n,int num,int bas){
    if(num+ex[n-p]<=bas)return 0;
    if(p==n){
        if(num>=bas){
            Ans[i]=num;return 1;
        }return 0;
    }
    if(ch[i][p]!='?')return dfs(p+1,i,n,num+(ch[i][p]-'0')*ex[n-p-1],bas);
    for(int c=(p>0?0:1);c<10;c++){
        if(dfs(p+1,i,n,num+c*ex[n-p-1],bas))return 1;
    }
    return 0;
}

int work(){
    ex[0]=1;
    for(int i=1;i<12;i++)ex[i]=ex[i-1]*10;
    int bas=1;
    for(int i=0;i<n;i++){
        if(dfs(0,i,strlen(ch[i]),0,bas)==0)return 0;
        bas=Ans[i]+1;
    }
    return 1;
}

int main(){
    cin>>n;
    for(int i=0;i<n;i++)cin>>ch[i];
    if(work()){
        cout<<"YES\n";
        for(int i=0;i<n;i++)cout<<Ans[i]<<endl;
    }
    else cout<<"NO\n";
}
