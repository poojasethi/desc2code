#include<stdio.h>
#include<string.h>
#include<algorithm>
using namespace std;
const int maxn=100050,maxl=10;
int n,l[maxn];
char a[maxn][maxl];
int f[maxl];
int main()
{
#ifndef ONLINE_JUDGE
	freopen("data.in","r",stdin);
#endif
	int i,j;
	scanf("%d",&n);
	for(i=1;i<=n;i++)
	{
		scanf("%s",a[i]);
		l[i]=strlen(a[i]);
		if(l[i]<l[i-1]) { printf("NO\n");return 0; }
		if(l[i]>l[i-1])
		{
			for(j=0;j<l[i];j++)
				if(a[i][j]=='?') a[i][j]=!j+'0';
		}
		else
		{
			int cur=0;
			bool z=0;
			while(cur<l[i]&&(a[i][cur]=='?'||a[i][cur]>=a[i-1][cur]))
			{
				if(a[i][cur]!='?'&&a[i][cur]>a[i-1][cur]) { z=1;break; }
				cur++;
			}
			if(!z)
			{
				for(j=cur-1;j>=0;j--)
					if(a[i][j]=='?'&&a[i-1][j]!='9') { a[i][j]=a[i-1][j]+1;break; }
				if(j==-1) { printf("NO\n");return 0; }
			}
			else j=cur;
			for(;j>=0;j--)
				if(a[i][j]=='?') a[i][j]=a[i-1][j];
			for(j=0;j<l[i];j++)
				if(a[i][j]=='?') a[i][j]=!j+'0';
		}
	}
	printf("YES\n");
	for(i=1;i<=n;i++)
		printf("%s\n",a[i]);
	return 0;
}
