#include <algorithm>
#include <iostream>
#include <cstdio>
int f[30010],b[30010],c[30010],l[30010],r[30010],ans[30010],i,j,n,m,q;
struct abc{int x,y;}a[30010];
bool comp(abc a,abc b){return a.x<b.x;}
int main()
{
		scanf("%d%d\n",&n,&m);
		for (i=1;i<=n;++i) scanf("%d",&a[i].x),a[i].y=i;
		for (f[1]=f[2]=1,i=3;i<=n;++i) f[i]=(f[i-1]+f[i-2])%m;
		std::sort(a+1,a+n+1,comp);
		scanf("\n%d\n",&q);
		for (i=1;i<=q;++i) scanf("%d%d\n",&l[i],&r[i]);
		for (i=1;i<=n;++i)
			for (j=1;j<=q;++j)
			if (l[j]<=a[i].y && a[i].y<=r[j] && a[b[j]].x!=a[i].x)
			{
				b[j]=i;ans[j]=(ans[j]+a[i].x%m*f[++c[j]])%m;
			}
		for (i=1;i<=q;++i) printf("%d\n",ans[i]);
}