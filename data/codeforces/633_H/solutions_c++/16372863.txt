#include <bits/stdtr1c++.h>

#define MAX 30010
#define clr(ar) memset(ar, 0, sizeof(ar))
#define read() freopen("lol.txt", "r", stdin)
#define dbg(x) cout << #x << " = " << x << endl

using namespace std;

int MOD = 1000000007;
tr1::unordered_map <int, int> mp;
unsigned short counter[MAX] = {0};
int n, m, q, h, ar[MAX], temp[MAX], lol[MAX], fib[MAX];

int main(){
    int i, j, k, l, r;

    while (scanf("%d %d", &n, &MOD) != EOF){
        h = 0, mp.clear();
        for (fib[0] = fib[1] = 1, i = 2; i < MAX; i++) fib[i] = (fib[i - 1] + fib[i - 2]) % MOD;

        for (i = 0; i < n; i++){
            scanf("%d", &ar[i]);
            temp[i] = ar[i];
        }

        temp[n] = -1;
        sort(temp, temp + n);
        for (i = 0; i < n; i++){
            if (temp[i] != temp[i + 1]){
                lol[h] = temp[i] % MOD;
                mp[temp[i]] = h++;
            }
        }
        for (i = 0; i < n; i++) ar[i] = mp[ar[i]];

        scanf("%d", &q);
        while (q--){
            scanf("%d %d", &l, &r);
            k = 0, l--, r--;

            long long res = 0;
            for (i = l; i <= r; i++) counter[ar[i]]++;
            for (i = 0; i < h; i++){
                if (counter[i]){
                    res += (lol[i] * fib[k++]);
                    counter[i] = 0;
                }
            }

            printf("%lld\n", res % MOD);
        }
    }
    return 0;
}