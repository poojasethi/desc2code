#include<iostream>
#include<algorithm>
#include<bits/stdc++.h>
using namespace std;
pair<int,int> a[30005];
int ans[30005],step[30005],f[30005],l[30005],r[30004],last[30005];
int main(){
    int n,m;
    cin>>n>>m;
    for (int i=1;i<=n;i++){
        cin>>a[i].first;
        a[i].second=i;
    }
    sort(a+1,a+1+n);
    f[0]=1;
    f[1]=1;
    for (int i=2;i<=n;i++)
     f[i]=(f[i-1]+f[i-2])%m;
     int q;
     cin>>q;
     for (int i=1;i<=q;i++){
        cin>>l[i]>>r[i];
        last[i]=-1;
     }
     for (int i=1;i<=n;i++){
        int d=a[i].first%m;
        for (int j=1;j<=q;j++)
        {
            if (a[i].second<l[j]||a[i].second>r[j]) continue;
            if (a[i].first==last[j])continue;
            ans[j]=(ans[j]+f[step[j]++]*d)%m;
             last[j]=a[i].first; 
         }
     }
     for (int i=1;i<=q;i++) cout<<ans[i]<<endl;
     return 0;
      
}
