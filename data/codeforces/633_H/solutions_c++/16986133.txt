#include <cstdio>
#include <algorithm>
#include <utility>
using namespace std;

int n, m, q, l, r, a[30005], f[30005] = {0, 1}, hs[30005], mp[30005], aa[30005];
pair<int, int> b[30005];

int main() {
	scanf("%d %d", &n, &m);
	for (int i = 2; i <= 30000; ++i) f[i] = (f[i - 1] + f[i - 2]) % m;
	for (int i = 1; i <= n; ++i) {
		scanf("%d", a + i);
		b[i] = make_pair(a[i], i);;
	}
	sort(b + 1, b + 1 + n);
	b[0].first = -1;
	for (int i = 1, num = 0; i <= n; ++i) hs[b[i].second] = b[i].first == b[i - 1].first ? num : ++num;
	scanf("%d", &q);
	for (int k = 1; k <= q; ++k) {
		scanf("%d %d", &l, &r);
		for (int i = l; i <= r; ++i)  {
			mp[hs[i]] = k;
			aa[hs[i]] = a[i];
		}
		int ans = 0;
		for (int i = 1, cnt = 1; i <= n; ++i) if (mp[i] == k) ans = (ans + aa[i] % m * f[cnt++]) % m;
		printf("%d\n", ans);		
	}
	return 0;
}
  		   		 	  	 	  									  		