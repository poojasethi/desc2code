#include <iostream>
#include <algorithm>

using namespace std;

int r[510], c[510], mem[100010];

int is_prime( int x )
{
	for( int i = 2 ; i * i <= x ; i ++ )
		if( x % i == 0 )
			return 0;
	return 1;
}

int f( int x )
{
	int &ret = mem[x];
	if( ret )
		return ret;
	while( x == 1 || !is_prime( x ) )
		x ++, ret ++;
	return ret;
}

int main()
{
	int n, m, x;
	cin >> n >> m;
	for( int i = 1 ; i <= n ; i ++ )
		for( int j = 1 ; j <= m ; j ++ )
		{
			cin >> x;
			r[i] += f( x );
			c[j] += f( x );
		}
	cout << min( *min_element( r+1 , r+n+1 ) , *min_element( c+1 , c+m+1 ) ) << endl;
	return 0;
}
