#include <iostream>
#include <algorithm>
// #include <brain>
#define W(x,y,z) for(x; y; z)

using namespace std;
bool t[100100] = { true, true };
int a[500], b[500], n, m, i, j, x;

int main()
{
	W(i = 2, i * i < 100100, ++i) if (!t[i])
		W(j = i * i, j < 100100, j += i) t[j] = true;
	cin >> n >> m;
	W(i = 0, i < n, ++i) W(j = 0, j < m, ++j)
	{
		int k = 0;
		W(cin >> x, t[x + k], ++k);
		a[i] += k;
		b[j] += k;
	}
	cout << min(*min_element(a, a + n), *min_element(b, b + m)) << endl;
}