#include<iostream>
#include<cmath>
const int N=100005;
using namespace std;
int a[N],q[501][501];
int main()
{
int n,i,j,m,ans,k,x,x1,l;
cin>>n>>m;
for (i=1; i<=n; i++)
for (j=1; j<=m; j++)
cin>>q[i][j]; a[1]=2;
for (i=100003; i>=2; i--)
{
for (j=2; j<=(int)sqrt(i); j++)
if (i%j==0) {a[i]=k;goto m1;}
k=i;a[i]=i;
m1:;
}
ans=N+5; 
for (i=1; i<=n; i++)
{
x=0;
for (j=1; j<=m; j++)
{
x+=a[q[i][j]]-q[i][j];
if (i==1) 
{
x1=0;
for (l=1; l<=n; l++)
x1+=a[q[l][j]]-q[l][j];
if (ans>x1) ans=x1;
}
}
if (ans>x) ans=x;
}
cout<<ans;
return 0;
}
