#include<iostream>
#include<string>
#include<algorithm>
#include<cmath>
using namespace std;
int v[100005];
int n,m,i,p[100005],c,j,next[100005],k,w[505][505],s,ans=100000000;
int main()
{
	p[c++]=2;
	for(i=3;i<100005;i+=2)
	{
		if(v[i]) continue;
		p[c++]=i;
		for(j=3*i;j<100005;j+=i<<1)
		{
			v[j]=1;
		}
	}
	k=0;
	for(i=1;i<=100005;i++)
	{
		while(p[k]<i) k++;
		next[i]=p[k]-i;
	}
	cin>>n>>m;
	for(i=1;i<=n;i++)
	{
		s=0;
		for(j=1;j<=m;j++)
		{
			cin>>w[i][j];
			s+=next[w[i][j]];
		}
		if(s<ans)ans=s;
	}
	for(i=1;i<=m;i++)
	{
		s=0;
		for(j=1;j<=n;j++)
		{
			s+=next[w[j][i]];
		}
		if(s<ans)ans=s;
	}
	cout<<ans;
}
