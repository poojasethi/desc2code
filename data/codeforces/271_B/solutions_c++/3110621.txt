#include<stdio.h>
#include<algorithm>
using namespace std;
#define X 1000100
bool su[X];
int s[X/10],top;
void make(){
	int i,j;
	for(i=2;i<X;i++)
		if(!su[i]){
			s[top++]=i;
			for(j=i+i;j<X;j+=i)
				su[j]=1;
			}
}
int g[510][510];
int main(){
	int i,j,n,m,x,y;make();
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;i++)
		for(j=1;j<=m;j++){
			scanf("%d",&x);
			y=lower_bound(s,s+top,x)-s;
			x=s[y]-x;
			g[i][j]=x;
		}
	for(i=1;i<=n;i++)
		for(j=1;j<=m;j++){
			//printf("%d ",g[i][j]);
			g[0][j]+=g[i][j];
			g[i][0]+=g[i][j];
		}
	x=99999999;
	for(i=1;i<=n;i++)x=min(x,g[i][0]);
	for(j=1;j<=m;j++)x=min(x,g[0][j]);
	printf("%d\n",x);
	return 0;
}
	
	
