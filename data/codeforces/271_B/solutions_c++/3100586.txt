#include<stdio.h>
#include<iostream>
using namespace std;
int a,s,d[101001],f[501][501],g,h,j,k,l,i,n,m;
main(){
cin>>n>>m;
d[1]=1;
for(i=2;i<101000;i++){
if(d[i]!=0)continue;
for(a=2*i;a<101000;a=a+i){
d[a]=1;
}}
//for(i=2;i<100000;i++){
//if(d[i]==0) cout<<i<<" ";}
for(i=0;i<n;i++){
for(a=0;a<m;a++){
cin>>k;
for(j=k;j<101000;j++){
if(d[j]==0) {f[i][a]=j-k;break;}//cout<<f[i][a]<<" ";
}
}}
for(i=0;i<n;i++){
for(a=0;a<m;a++){
l=l+f[i][a];
}
if(l<h || s==0) {h=l;s=1;}
l=0;}


for(i=0;i<m;i++){
for(a=0;a<n;a++){
l=l+f[a][i];
}
if(l<h || s==0) {h=l;s=1;}
l=0;}

cout<<h;
//system("pause");
}
