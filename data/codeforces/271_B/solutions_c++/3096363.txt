#include <iostream>
#include <algorithm>
using namespace std;
int p[110000];
int d[2][501];
int main( void )
{
  int lastp = 2;
  for( int i=2; i<110000; i++ ){
    if( p[i] >= 0 ){
      for( int j=i; j<110000; j+=i )
        p[j]=-1;
      lastp = p[i] = i;
    }
  }
  for( int i=lastp; i>=0; i-- ){
    if( p[i] <= 0 ) p[i] = lastp;
    else lastp = p[i];
  }
  int n,m,a;
  cin >> n >> m;
  for( int i=0; i<n; i++ ) for( int j=0; j<m; j++ ){
    cin >> a;
    d[0][i] += p[a] - a;
    d[1][j] += p[a] - a;
  }
  int ret = min( *min_element( d[0], d[0]+n ),
                 *min_element( d[1], d[1]+m ) );
  cout << ret << endl;
  return 0;
}
