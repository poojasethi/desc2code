#include <iostream>
#include <cmath>
using namespace std;
const int N=100003;
int d[N+1],n,m, b[501][501],s,sum;
bool f[N+1];
int main(){
	cin>> n>> m;
	for (int i=0;i<n;i++)
		for (int j=0; j<m; j++)
			cin>>b[i][j];
	for (int i=2; i<=sqrt(N);i++){
		if (!f[i])
			for (int j=i*i;j<N;j+=i)
				f[j]=true;
	}
	d[1]=1;
	for (int i=N; i>=0; i--)
		if (f[i])
			d[i]=d[i+1]+1;
	sum=100000;
	for (int i=0;i<n; i++){
		s=0;
		for (int j=0;j<m; j++)
			s+=d[b[i][j]];
		if(s<sum)
			sum=s;
	}
	for (int i=0;i<m; i++){
		s=0;
		for (int j=0;j<n; j++)
			s+=d[b[j][i]];
		if(s<sum)
			sum=s;
	}
	cout<< sum;
	return 0;
}