//In the Name of God

#include<iostream>
#include<set>
#define int long long

using namespace std;

int n,m,x,k,c[512],r[512],ans=1e13+13;
bool mark[200200];
set<int> s;

main()
{
  for(int i=2;i<=200000;i++)
    if(!mark[i])
      {
	s.insert(i);
	for(int j=i*i;j<=200000;j+=i)
	  mark[j]=true;
      }
  cin>>n>>m;
  for(int i=0;i<n;i++)
    for(int j=0;j<m;j++)
      {
	cin>>x;
        k=(*s.lower_bound(x))-x;
	c[j]+=k;
	r[i]+=k;
      }
  for(int i=0;i<n;i++)
    ans=min(ans,r[i]);
  for(int j=0;j<m;j++)
    ans=min(ans,c[j]);
  cout<<ans<<endl;
  return 0;
}
