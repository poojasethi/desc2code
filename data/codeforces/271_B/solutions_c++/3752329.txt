#include <cstdio>
#include <iostream>
#include <string>
#include <algorithm>
#include <cstdlib>
#include <map>
#include <set>
#include <queue>
#include <cmath>
#define PI acos(-1.0)
#define MAXN 150000
using namespace std;
int n,m,a[505][505],r[505],c[505];
bool p[150005];
int main(){
	p[0]=p[1]=1;
	for(int i=2; i*i<=MAXN; ++i)
		if (!p[i])
			for(int j=i*i; j<=MAXN; j+=i) p[j]=1;
	scanf("%d%d",&n,&m);
	for(int i=1; i<=n; ++i)
		for(int j=1; j<=m; ++j)
			scanf("%d",&a[i][j]);
	for(int i=1; i<=n; ++i)
		for(int j=1; j<=m; ++j){
			int k;
			for(k=0; p[k+a[i][j]]; ++k);
			r[i]+=k;
			c[j]+=k;
		}
	printf("%d\n",min(*min_element(r+1,r+n+1),*min_element(c+1,c+m+1)));
	return 0;
}
