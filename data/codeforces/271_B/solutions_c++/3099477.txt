#include<iostream>
using namespace std;
bool b[100005]={0};
int i,j;
int main()
{
for(i=2;i<=400;++i)
{
if(b[i]==0)
{
for(j=i+i;j<=100003;j+=i)
b[j]=1;
}
}
b[0]=1,b[1]=1;
int i,j,min=1000000000,n,m,cnt=0,ans,k;
cin>>n>>m;
int a[n][m],c[n][m];
for(i=0;i<n;++i)
{
for(j=0;j<m;++j)
cin>>a[i][j];
}
for(i=0;i<n;++i)
{
for(j=0;j<m;++j)
{
cnt=0;
for(k=a[i][j];k<=100003;++k)
{
if(b[k]==0)
{
c[i][j]=cnt;
break;
}
cnt++;
}
}
}
for(i=0;i<n;++i)
{
ans=0;
for(j=0;j<m;++j)
{
ans=ans+c[i][j];
}
if(min>ans)
min=ans;
}
for(j=0;j<m;++j)
{
ans=0;
for(i=0;i<n;++i)
{
ans=ans+c[i][j];
}
if(min>ans)
min=ans;
}
cout<<min<<endl;

return 0;
}