#include<iostream>
#include<cstdio>
using namespace std;

int i,j,s[200000],a[600][600],ans,sum,p,n,m;
bool used[200000];

int main()
{
	for (used[1]=true,i=2;i<=110000;i++)
	if (!used[i])	for (j=2*i;j<=110000;j+=i)	used[j]=true;
	for (i=110000;i;i--)
	{
		if (!used[i])	p=i;
		s[i]=p-i;
	}
	scanf("%d%d",&n,&m);
	for (i=1;i<=n;i++)
	for (j=1;j<=m;j++)	scanf("%d",&a[i][j]);
	for (ans=2000000000,i=1;i<=n;i++)
	{
		sum=0;
		for (j=1;j<=m;j++)	sum+=s[a[i][j]];
		ans=min(ans,sum);
	}
	for (i=1;i<=m;i++)
	{
		sum=0;
		for (j=1;j<=n;j++)	sum+=s[a[j][i]];
		ans=min(ans,sum);
	}
	printf("%d\n",ans);
}
