#include <cstdio>
using namespace std;
#define N 100100
int main(){
  int a[N]={},i=1,j,p=2,m,n,b[500][500],k;
  a[1]=1;
  do{
    while(a[i])i++;
    for(j=i*i;j<N;j+=i)a[j]=1;
    i++;
  }while (i*i<N);
  for(i=p=4;i<N-50;){
    while(a[i])i++;
    for(j=p;j<i;j++)a[j]=i-j;
    p=++i;
  }
  scanf("%d%d",&n,&m);
  for(i=0;i<n;i++)
    for(j=0;j<m;j++)
      scanf("%d",&b[i][j]);
  for(i=0;i<n;i++){
    for(p=j=0;j<m;j++)p+=a[b[i][j]];
    if((p<k)||(i==0))k=p;
  }
  for(j=0;j<m;j++){
    for(p=i=0;i<n;i++)p+=a[b[i][j]];
    if(p<k)k=p;
  }
  printf("%d ",k);
  return 0; 
}
