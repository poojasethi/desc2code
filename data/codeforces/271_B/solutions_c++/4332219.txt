#include <iostream>

using namespace std;
int n,m,i,j,x,sol,p[100100],L[501],C[501];
int main()
{
    p[0]=p[1]=1;
    for(n=2;n*n<=100050;n++)
        if(!p[n])
            for(m=n*n;m<=100050;m+=n)p[m]=1;
    for(n=100050;n>=0;n--)
    {
        x*=p[n];
        p[n]=x++;
    }
    cin>>n>>m;
    for(i=1;i<=n;i++)
        for(j=1;j<=m;j++)
        {
            cin>>x;
            L[i]+=p[x];
            C[j]+=p[x];
        }
    sol=L[1];
    for(i=1;i<=n;i++)sol=sol<L[i]?sol:L[i];
    for(j=1;j<=m;j++)sol=sol<C[j]?sol:C[j];
    cout<<sol;
    return 0;
}
