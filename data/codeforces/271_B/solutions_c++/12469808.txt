#include<stdio.h>
#define MIN(x,y) (x<y ? (x) : (y))
int a,H[2000000],asal[2000000],i,j,n,min=10000000,top,arr[600][600],m;
int f(int x){
	int i=x-1;
	while(!asal[++i]);
	return i-x;

}

int main(){
	scanf("%d %d",&n,&m);
	for(i=2;i<=100007;i++){
		if(H[i]) continue;
		asal[i] = 1;
		for(j=i*2;j<=100007;j+=i)
			H[j]=1;
	}
	for(i=1;i<=n;i++)
		for(j=1;j<=m;j++){
			scanf("%d",&a);
			arr[i][j] = f(a);
		}
	for(i=1;i<=n;i++){
		top=0;
		for(j=1;j<=m;j++)
			top+=arr[i][j];
		min = MIN(top,min);
	}

	
	for(i=1;i<=m;i++){
		top=0;
		for(j=1;j<=n;j++)
			top+=arr[j][i];

		min = MIN(top,min);
	}
	printf("%d\n",min);

}
