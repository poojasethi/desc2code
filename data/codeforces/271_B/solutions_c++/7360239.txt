#include <bits/stdc++.h>

using namespace std;

bool prime(int n)
{
    for(int i = 2 ; i <= sqrt(n) ; i += 1 + (i & 1))
        if(!(n % i))    return false;
    return n > 1;
}

int main()
{
    ios_base::sync_with_stdio(0);
    int r , c ;
    cin >> r >> c;
    vector <int> row(r , 0) , col(c , 0);
    for(int i = 0 ; i < r ; i++)
    {
        for(int a = 0 , x ; a < c ; a ++)
        {
            cin >> x;
            while(!prime(x ++))
                row[i] ++ , col[a] ++;
        }
    }
    sort(row.begin() , row.end());
    sort(col.begin() , col.end());
    cout << min(row[0] , col[0]);
}
