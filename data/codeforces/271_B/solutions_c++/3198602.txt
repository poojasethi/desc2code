#include <iostream>
using namespace std;

const int maxn=100004;

int b[maxn];
int n,m,a[500][500],i,j,k,c[1111];
int main()
{
    b[1]=true;
    for (i=2;i<maxn;++i)
     if (!b[i])
      for (j=i+i;j<maxn;j+=i)
       b[j]=true;
    cin>>n>>m;
    for (i=0;i<n+m;c[i]=0,++i);
    for (i=0;i<n;++i)
     for (j=0;j<m;++j)
     {
         a[i][j]=0;
         cin>>k;
         while (b[k])
         {
             ++k;
             ++a[i][j];
         }
         c[i]+=a[i][j];
         c[n+j]+=a[i][j];
     }
    k=0x7fffffff;
    for (i=0;i<n+m;++i)
     if (c[i]<k) k=c[i];
    cout<<k<<endl;
    return 0;
}