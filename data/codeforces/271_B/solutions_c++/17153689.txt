#include<bits/stdc++.h>
using namespace std;
bool p[100050];
void sieve(){
	p[0]=p[1]=true;
	for(int i=2;i*i<100050;i++){
		if(p[i]==false){
			for(int j=i+i;j<100050;j+=i)
				p[j]=true;
		}
	}
}
int f(int n){
	int i=n;
	while(p[i])
		i++;
	return i-n;
}
int main()
{
	sieve();
	int m,n;
	cin>>m>>n;
	int mat[m][n];
	int row[m]={0}, col[n]={0};
	int a;
	for(int i=0;i<m;i++)
		for(int j=0;j<n;j++){
			cin>>mat[i][j];
			a=f(mat[i][j]);
			row[i]+=a;
			col[j]+=a;
		}
	cout<<min(*min_element(row,row+m),*min_element(col,col+n))<<endl;
	return 0;
	
}
		   	  	 		  		 	  	 	 	  	 		