#include<cstdio>
#include<algorithm>
#include<cmath>
#define REP(i,j) for (int i=1;i<=j;++i)
using namespace std;
const int maxn=100006;
int n,m,map[502][502],p[maxn],q[maxn],l[502],r[502];

int main(){
	scanf("%d%d",&n,&m);
	REP(i,n) REP(j,m) scanf("%d",&map[i][j]);
	p[1]=1;
	REP(i,maxn)
		if (!p[i]) for (int j=2;j<=maxn/i;++j) p[i*j]=1;
	int las=0;
	for (int j=maxn;j;--j) {
		if (!p[j]) las=j;
		q[j]=las;
	}
	REP(i,n) REP(j,m) l[i]+=q[map[i][j]]-map[i][j],r[j]+=q[map[i][j]]-map[i][j];
	int ans=~0U>>1;
	REP(i,n) ans=min(ans,l[i]);
	REP(j,m) ans=min(ans,r[j]);
	printf("%d\n",ans);
	return 0;
}
