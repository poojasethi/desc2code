import bisect
MAX = 10**5+10
x =[True] * MAX
for i in range(2, MAX):
    if x[i]:
        for j in range(i*2, MAX, i):
            x[j] = False
ps = [i for i in range(2, MAX) if x[i]]
I = lambda:map(int, raw_input().split())
n,m=I()
r,c=[0]*n,[0]*m
for i in range(n):
    a = I()
    for j in range(m):
        k = bisect.bisect_left(ps, a[j])
        r[i] += ps[k]-a[j]
        c[j] += ps[k]-a[j]
    if r[i] == 0:
        print 0
        exit()
print min(min(r), min(c))