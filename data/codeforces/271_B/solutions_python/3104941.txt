M=110000
p=[0,0]+[1]*M
for i in range(2,M):
  if p[i]:
    for j in range(i*i,M,i):p[j]=0;
u=M
for i in reversed(range(M)):
  if p[i]:u=i
  p[i]=u-i
R=lambda:map(int,raw_input().split())
n,m=R()
a=[R() for _ in range(n)]
t=10**10
for v in a:
  t=min(t,sum(map(lambda x:p[x],v)))
for v in zip(*a):
  t=min(t,sum(map(lambda x:p[x],v)))
print t
