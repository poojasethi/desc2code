x,y=map(int,raw_input().split())
Maxprimos = 100100
primos=[True]*Maxprimos
primos[0]=False
primos[1]=False
marked={}
for i in range(2,Maxprimos):
    if primos[i]:#Los vamos a marcar
        for j in range(i+i,Maxprimos,i):
            primos[j]=False
matriz=[]
for i in range(x):
    matriz.append(map(int,raw_input().split()))
    for j in range(len(matriz[i])):
        z = matriz[i][j]
        if z not in marked:
            while not primos[z]:
                z+=1
                marked[matriz[i][j]]=z
            matriz[i][j]=(z-matriz[i][j])#pasos para volver el numero primo
        else:
            matriz[i][j]=(marked[matriz[i][j]]-matriz[i][j])
            
row=[]
col=[]

for i in range(x):#para filas
    temp=sum(matriz[i])
    row.append(temp)
for i in range(y):
    tempCol=[]
    for j in range(x):
        tempCol.append(matriz[j][i])
    temp=sum(tempCol)
    col.append(temp)
rowMin=min(row)
colMin=min(col)
print min(colMin,rowMin)