lm=100018;p=[1,1]+[0]*lm
for i in range(2,lm):p[i*i::i]=[1]*(lm/i-i+1)
for i in range(lm,0,-1):p[i]*=p[i+1]+1
I=lambda _:map(int,raw_input().split());n,m=I(0);M=map(I,[0]*n)
print min(sum(p[i]for i in r)for r in M+zip(*M))