from bisect import *

p = [x for x in range(2, 111111) if all(x % y > 0 for y in range(2, int(x ** 0.5) + 1))]
n, m = map(int, raw_input().split())
a = [map(int, raw_input().split()) for _ in range(n)]

F = lambda b : min(sum(p[bisect_left(p, x)] - x for x in r) for r in b)

print min(F(a), F(zip(*a)))