import bisect
MAX = 10**5 + 10
sushu = [True] * MAX
for i in range(2, MAX):
	if sushu[i]:
		for j in range(i * 2, MAX, i):
			sushu[j] = False
sushu = [i for i in range(2, MAX) if sushu[i]]
read = lambda : map(int, raw_input().split())
n, m = read()
r, c = [0] * n, [0] * m
for i in range(n):
	a = read()
	for j in range(m):
		k = bisect.bisect_left(sushu, a[j])	
		r[i] += sushu[k] - a[j]
		c[j] += sushu[k] - a[j]
print min(min(r), min(c))
