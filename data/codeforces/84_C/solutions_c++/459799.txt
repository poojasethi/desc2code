#include<cstdio>
#include<algorithm>
using namespace std;

#define x first
#define y second
#define sqr(x) ((x)*(x))

const int maxn=200000+10;
pair<pair<int,int>,int> p[maxn],q[maxn];
int res[maxn];
int n,m;

bool inside(pair<int,int> a,pair<int,int> b)
{
    return sqr(a.x-b.x)+sqr(b.y)<=sqr(a.y);
}

void renew(int &a,int b) {if (a==-1) a=b;else a=min(a,b);}

int main()
{
    scanf("%d",&n);
    for (int i=0,x,r;i<n;i++)
    {
        scanf("%d%d",&x,&r);
        p[i]=make_pair(make_pair(x,r),i);
        res[i]=-1;
    }
    scanf("%d",&m);
    for (int i=0,x,y;i<m;i++)
    {
        scanf("%d%d",&x,&y);
        q[i]=make_pair(make_pair(x,y),i+1);
    }
    sort(p,p+n);
    sort(q,q+m);
    for (int i=0,j=0;i<m;i++)
    {
        while (j<n && p[j].x.x+p[j].x.y<q[i].x.x) j++;
        if (j<n && inside(p[j].x,q[i].x)) renew(res[p[j].y],q[i].y);
        if (j+1<n && inside(p[j+1].x,q[i].x)) renew(res[p[j+1].y],q[i].y);
    }
    int cnt=0;
    for (int i=0;i<n;i++) cnt+=(res[i]>=0);
    printf("%d\n",cnt);
    for (int i=0;i<n;i++) printf("%d%c",res[i],i==n-1?'\n':' ');
}
