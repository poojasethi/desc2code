#include <map>
#include <set>
#include <cmath>
#include <stack>
#include <queue>
#include <string>
#include <vector>
#include <fstream>
#include <sstream>
#include <stdio.h>
#include <string.h>
#include <iostream>
#include <algorithm>
using namespace std;
#define li		long long
#define rep(i,to)	for(li i=0;i<((li)to);i++)
#define pb		push_back
#define sz(v)		((li)v.size())


li ans[100005];
int main(){
#define P pair<pair<li,li>,li>
	vector< P > pos;
	li n;
	cin>>n;
	rep(i,100005) ans[i]=-1;
	rep(i,n){
		li a,b;
		cin>>a>>b;
		pos.pb(make_pair(make_pair(a,b),i));
	}
	sort(pos.begin(),pos.end());
	li m,cnt=0;;
	cin>>m;
	rep(i,m){
		li a,b;
		cin>>a>>b;
		vector< P >::iterator it;
		it=upper_bound(pos.begin(),pos.end(),make_pair(make_pair(a,0ll),0ll));
		vector< P > its;
		if(it!=pos.end()) its.pb(*it);
		if(it!=pos.begin()){
			it--;
			its.pb(*it);
		}
		rep(j,sz(its)){
			pair<pair<li,li>,li> now=its[j];
			pair<li,li> p=now.first;
			if(b*b+(a-p.first)*(a-p.first)<=p.second*p.second && ans[now.second]==-1){
				ans[now.second]=i+1;
				cnt++;
			}
		}
	}
	cout<<cnt<<endl;
	rep(i,n) cout<<ans[i]<<" ";
	cout<<endl;
}
