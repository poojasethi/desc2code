#include <bits/stdc++.h>

using namespace std;

vector<int> points[42000];
pair<int, int> targets[20000];
int firsthit[20000];
int cnt = 0;

void doIt(int x, int y, int n){
    int len = points[x+21000].size();
    double r,d;
    for(int i = 0; i<len; i++){
        r = (double)targets[points[x+21000][i]].second;
        d = sqrt((double)((targets[points[x+21000][i]].first - x)*(targets[points[x+21000][i]].first - x))+(double)(y*y));
        if(d<=r && firsthit[points[x+21000][i]]==-2) firsthit[points[x+21000][i]] = n, cnt++;
    }
}

int main(){
    int n;
    cin>>n;
    int x,r,y;
    for(int i = 0; i<n; i++){
        cin>>x>>r;
        targets[i] = make_pair(x,r);
        for(int j = x-r; j<=x+r; j++) points[j+21000].push_back(i);
        firsthit[i] = -2;
    }
    int m;
    cin>>m;
    for(int i = 0; i<m; i++){
        cin>>x>>y;
        doIt(x,y,i);
    }
    cout<<cnt<<endl;
    for(int i = 0; i<n; i++) cout<<firsthit[i]+1<<" ";
    return 0;
}
