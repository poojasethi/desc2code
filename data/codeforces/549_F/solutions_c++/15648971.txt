#include <stdio.h>
#include <string.h>
#include <algorithm>
#include <math.h>
#include <stdlib.h>
#include <vector>
using namespace std;
const int maxn=1000010,inf=0x7fffffff;
int num[maxn],n,mod,st[maxn],top,l[maxn],r[maxn],sum[maxn];
long long ans;
vector<int>f[maxn];
void get_range()
{
	top=0;
	num[n+1]=inf;
	l[1]=0;
	for(int i=1;i<=n+1;i++)
	{
		while(top>0&&num[i]>=num[st[top]])
		{
			int j=st[top--];
			r[j]=i;
			l[j]=st[top];
		}
		l[i]=st[top];
		st[++top]=i;
	}
}
int calculate(int x,int l,int r)
{
	int a= (upper_bound(f[x].begin(),f[x].end(),r)-f[x].begin()),
		b=	(lower_bound(f[x].begin(),f[x].end(),l)-f[x].begin());
	return a-b;
}
int main()
{
	while(scanf("%d%d",&n,&mod)==2)
	{
		for(int i=1;i<=n;i++)
			scanf("%d",&num[i]),sum[i]=(sum[i-1]+num[i])%mod;
		for(int i=0;i<=n;i++)
			f[i].clear();
		f[0].push_back(0);
		for(int i=1;i<=n;i++)
			f[sum[i]].push_back(i);
		get_range();
		ans=0;
		for(int i=1;i<=n;i++)
			if(i-l[i]<r[i]-i)
				for(int j=l[i];j<i;j++)
					ans+=calculate((sum[j]+num[i])%mod,i,r[i]-1);
			else
				for(int j=i;j<r[i];j++)
					ans+=calculate((sum[j]-num[i]%mod+mod)%mod,l[i],i-1);
		printf("%lld\n",ans-n);
	}
	return 0;
}

         