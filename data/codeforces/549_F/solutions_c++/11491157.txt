#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int p,a[300001],s[300001],d[1000000],f[1000000];
long long ans=0;
void l(int q,int w){
  if(q>=w)
   return;
  int t=q+(w-q)/2,y=a[t],u=s[t]-s[t-1],e=t-1,r=t+1,c;
  if(u<0)
   u+=p;
  d[0]=f[u]=1;
  while((q<=e)||(r<=w))
   if((q<=e)&&((r>w)||(a[e]<a[r]))){
    if(y<a[e]){
     y=a[e];
     u=s[e]-s[e-1];
     if(u<0)
      u+=p;}
    c=s[t-1]-s[e-1];
    if(c<0)
     c+=p;
    d[c]++;
    c=p+u-c;
    if(c<0)
     c+=p;
    if(c>=p)
     c-=p;
    ans+=f[c];
    e--;}
   else{
    if(y<a[r]){
     y=a[r];
     u=s[r]-s[r-1];
     if(u<0)
      u+=p;}
    c=s[r]-s[t-1];
    if(c<0)
     c+=p;
    f[c]++;
    c=p+u-c;
    if(c<0)
     c+=p;
    if(c>=p)
     c-=p;
    ans+=d[c];
    r++;}
  for(e=t-1;e>=q;e--){
   c=s[t-1]-s[e-1];
   if(c<0)
    c+=p;
   d[c]=0;}
  for(e=t;e<=w;e++){
   c=s[e]-s[t-1];
   if(c<0)
    c+=p;
   f[c]=0;}
  l(q,t-1);
  l(t+1,w);
}
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t;
  scanf("%d%d",&q,&p);
  for(w=0;w<p;w++)
   d[w]=f[w]=0;
  s[0]=0;
  for(w=1;w<=q;w++){
   scanf("%d",&a[w]);
   s[w]=(a[w]+s[w-1])%p;}
  l(1,q);
  printf("%I64d",ans);
  return 0;}
