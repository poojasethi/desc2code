/*************************************

状态:Unsubmitted[次过]
开始:2016年2月6号12:31
完成:2016年2月6号
题目:yura and developers
出处:cf549f
分类:分治
思路:
总结:

*************************************/
#include<stdio.h>
const int N=300001,K=1000001;
int k,a[N],pre[N],cnt[K];
long long ans=0;
void umax(int&max,int u)
{ if(u>max)max=u; }
void work(int L,int R)
{
	if(L==R)return;
	int M=(L+R)/2,l,r,m=0;
	work(L,l=M);
	work(r=M+1,R);
	while(L<=l)
	{
		while(a[l]>=a[r]&&r<=R)
			cnt[(pre[r++]-pre[M]%k+k)%k]++;
		while(L<=l&&(r>R||a[l]<a[r]))
			umax(m,a[l]),
			ans+=cnt[(k-(pre[M]-pre[--l]-m)%k)%k];
	}
	for(int i=M+1;i<=R;i++)
		cnt[(pre[i]-pre[M]%k+k)%k]=0;
	l=M,r=M+1,m=0;
	while(r<=R)
	{
		while(a[l]<a[r]&&L<=l)
			cnt[(pre[M]-pre[--l]%k+k)%k]++;
		while(r<=R&&(a[l]>=a[r]||L>l))
			umax(m,a[r]),
			ans+=cnt[(k-(pre[r++]-pre[M]-m)%k)%k];
	}
	for(int i=M;i>=L;i--)
		cnt[(pre[M]-pre[i-1]%k+k)%k]=0;
}
int main()
{
	int n,i;
	scanf("%d%d",&n,&k);
	for(i=1;i<=n;i++)
		scanf("%d",&a[i]),
		pre[i]=(pre[i-1]+a[i])%k;
	work(1,n);
	printf("%I64d",ans);
	return 0;
}
                                                   