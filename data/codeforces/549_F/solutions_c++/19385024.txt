#include <bits/stdc++.h>

using namespace std;

#define NN 310000
#define inf 0x3f3f3f3f
#define eps 1e-8
#define eprintf(...) fprintf(stderr, __VA_ARGS__)

typedef pair<int, int> pii;
typedef long long INT;

int N, K, a[NN], sum[NN];
int cnt[1100000];

INT solve(int st, int en) {
	if (en<=st+1) return 0;
	int mid=(st+en)/2;
	INT ans=solve(st, mid)+solve(mid, en);
	
	int i, j, mx;
	for (i=mid-1, j=mid, mx=0; i>=st; i--) {
		mx=max(mx, a[i]);
		while (j<en && a[j]<=mx) {
			cnt[sum[++j]]++;
		}
		int t=((sum[i]+mx)%K+K)%K;
		ans+=cnt[t];
	}
	while (j>mid) cnt[sum[j--]]--;
	
	for (i=mid-1, j=mid, mx=0; j<en; j++) {
		mx=max(mx, a[j]);
		while (i>=st && a[i]<mx) {
			cnt[sum[i--]]++;
		}
		int t=((sum[j+1]-mx)%K+K)%K;
		ans+=cnt[t];
	}
	while (i<mid-1) cnt[sum[++i]]--;
	
	return ans;
}

int main() {
	scanf("%d%d", &N, &K);
	for (int i=0; i<N; i++) scanf("%d", &a[i]);
	
	sum[0]=0;
	for (int i=0; i<N; i++) sum[i+1]=(sum[i]+a[i])%K;
	
	printf("%I64d\n", solve(0, N));
	
	return 0;
}
                   