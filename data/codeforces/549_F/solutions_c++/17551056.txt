#include<algorithm>
#include<iostream>
#include<cstdlib>
#include<cstring>
#include<cstdio>
#include<vector>
#include<cmath>
#include<queue>
#include<ctime>
#include<set>
#include<map>
#include<bitset>
#define N 300040
#define M 1000010 
#define LL long long
using namespace std;
vector<int>f[M];
int sum[N],a[N],c[N];
int L[N],R[N],pre[N],nxt[N];
long long ans;
int n,k;
bool cmp(int x,int y)
{
	return a[x]<a[y]||(a[x]==a[y]&&x<y);
}
void pre_()
{
	for(int i=1;i<=n;i++)
	{
		c[i]=i;
		pre[i]=i-1;
		nxt[i]=i+1;
	}
	sort(c+1,c+n+1,cmp);
	for(int i=1;i<=n;i++)
	{
		int p=c[i];
		L[p]=pre[p];
		R[p]=nxt[p];
		pre[nxt[p]]=pre[p];
		nxt[pre[p]]=nxt[p];
	}
	
}
int ask(int l,int r,int k)
{
	//cout<<l<<" "<<r<<" "<<k<<endl;
	return upper_bound(f[k].begin(),f[k].end(),r)-lower_bound(f[k].begin(),f[k].end(),l);
}
int main()
{
	scanf("%d%d",&n,&k);
	f[0].push_back(0);
	for(int i=1;i<=n;i++)
	{
		scanf("%d",&a[i]);
		sum[i]=(sum[i-1]+a[i])%k;
		f[sum[i]].push_back(i);
	}
	pre_();
	for(int i=1;i<=n;i++)
	{
		//cout<<i<<" "<<L[i]<<" "<<R[i]<<endl;
		if(i-L[i]<R[i]-i)
		{
			for(int j=L[i];j<i;j++)
				ans+=ask(i,R[i]-1,(sum[j]+a[i])%k);
		}
		else
		{
			for(int j=i;j<R[i];j++)
			{
				int x=ask(L[i],i-1,(sum[j]-a[i]%k+k)%k);
				//cout<<i<<" "<<j<<" "<<x<<endl;
			    ans+=x;
			}
		}
	}
	cout<<ans-n;
	return 0;
}