#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define N 1010
using namespace std;
const int d[4][2]={1,0, 0,1, -1,0, 0,-1};
int a[N][N],bo[N][N][4],ans,n,m,i,j,s,t,totals,k;
void dfs(int x,int y,int s,int len){
	bool f=0;
	for(int i=0;i<4;++i)if(!bo[x][y][i]){
		if(!a[x+d[i][0]][y+d[i][1]])continue;
		bo[x][y][i]=bo[x+d[i][0]][y+d[i][1]][(i+2)%4]=1;
		totals-=2;
		int l;
		if(s==i)l=len+1;
		else l=1,ans=__gcd(ans,len);
		dfs(x+d[i][0],y+d[i][1],i,l);
		f=1;
	}
	if(!f)ans=__gcd(ans,len);
}
int main(){
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;++i)
		for(j=1;j<=m;++j)scanf("%d",&a[i][j]);
	for(i=1;i<=n;++i)
		for(j=1;j<=m;++j)if(a[i][j]){
			s=0;
			for(k=0;k<4;++k)if(a[i+d[k][0]][j+d[k][1]]==1)
				s++;
			totals+=s;
			if(!s)return puts("-1"),0;
			if(s&1)t++;
		}
	if(t!=0 && t!=2)return puts("-1"),0;
	ans=0;
	for(i=1;i<=n;++i)
		for(j=1;j<=m;++j)if(a[i][j]){
			dfs(i,j,10,0);
			goto V;
		}
	V:;
	if(totals || ans<=1)puts("-1");
	else for(i=2;i<=ans;++i)if(ans%i==0)printf("%d ",i);
}
