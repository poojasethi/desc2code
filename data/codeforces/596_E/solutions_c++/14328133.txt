#include <cstdio>
#include <cstring>
#include <string>
#include <cmath>
#include <vector>
#include <stack>
#include <algorithm>

using namespace std;

#define MAXN 40010
#define INF 0x3f3f3f3f
#define MAX(a,b) (a>b?a:b)
#define MIN(a,b) (a<b?a:b)
#define ABS(m) (m<0?-m:m)
#define mo 1000000007
typedef long long LL;

int n,m,q,lp,ll,next[MAXN],pre[MAXN];
int f[10][2],sta[MAXN],num[MAXN];
char table[201][201],s[1000010];
bool loop[MAXN][10];
bool vis[MAXN],mark[MAXN];
vector<char> line[MAXN];
vector<int> loop_line[MAXN];
vector<int> adj[MAXN];

void find_loop(int u)
{
    if(vis[u]){
        loop[++lp][table[u/m][u%m]-'0']=true;
        num[u]=lp; pre[u]=sta[sta[0]];
        for(int i=sta[0];sta[i]!=u;--i){
            loop[lp][table[sta[i]/m][sta[i]%m]-'0']=true;
            num[sta[i]]=lp; pre[sta[i]]=sta[i-1];
        }
        return;
    }
    vis[u]=true; sta[++sta[0]]=u;
    if(!mark[next[u]]) find_loop(next[u]);
    vis[u]=false; mark[sta[sta[0]--]]=true;

}

void find_line(int u,int loop_num)
{
    int i,cnt=0;
    sta[++sta[0]]=table[u/m][u%m];
    for(i=adj[u].size()-1;i>=0;--i){
        if(adj[u][i]==pre[u]) continue;
        find_line(adj[u][i],loop_num); ++cnt;
    }
    if(!cnt&&sta[0]>1){
        loop_line[loop_num].push_back((++ll));
        for(int i=sta[0];i>1;--i) line[ll].push_back(sta[i]);
    }
    --sta[0];
}



void Init()
{
    int i,j,x,y;
    scanf("%d%d%d",&n,&m,&q);
    for(i=0;i<n;++i) scanf("%s",table[i]);
    for(i=0;i<10;++i) scanf("%d%d",f[i],f[i]+1);
    for(i=0;i<n;++i)
        for(j=0;j<m;++j){
            x=i+f[table[i][j]-'0'][0];
            y=j+f[table[i][j]-'0'][1];
            if(x<0||x>=n||y<0||y>=m) x=i,y=j;
            next[i*m+j]=x*m+y;
            adj[x*m+y].push_back(i*m+j);
        }
    for(i=0;i<n;++i)
        for(j=0;j<m;++j){
            if(mark[i*m+j]) continue;
            find_loop(i*m+j);
        }
    for(i=0;i<n;++i)
        for(j=0;j<m;++j){
            if(!num[i*m+j]) continue;
            find_line(i*m+j,num[i*m+j]);
        }
}

void Query()
{
    int i,j,k,l,p,t;
    for(i=1;i<=q;++i){
        scanf("%s",s);
        for(j=1;j<=lp;++j){
            for(k=strlen(s)-1;k>=0&&loop[j][s[k]-'0'];--k);
            if(k<0) break;
            for(l=loop_line[j].size()-1;l>=0;--l){
                for(p=line[loop_line[j][l]].size()-1,t=k;p>=0&&t>=0;--p)
                    if(s[t]==line[loop_line[j][l]][p]) --t;
                if(t<0) break;
            }
            if(l>=0) break;
        }
        printf("%s\n",j>lp?"NO":"YES");
    }
}

int main()
{
    Init();
    Query();
    return 0;
}
