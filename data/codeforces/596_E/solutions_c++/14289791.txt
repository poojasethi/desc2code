#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
#include <cstring>
using namespace std;
class sp{
  public:
  int q;
  sp *w;
  sp(int q1,sp *w1){
   q=q1;w=w1;
  }
};
char a[200][200],str[1000001];
int opt1[40000],opt2[40000];
int sizestr,f1[10],f2[10];
int f[40000];
int mask[40000],d[1000001];
int k(int w){
  if(f[w]!=w)
   f[w]=k(f[w]);
  return f[w];
}
sp *a1[40000];
int q,w,s[40000];
void l(int e,int r,int t){
  s[e*w+r]=t;
  int v=e*w+r,c1,c2,v1;
  c1=e+f1[a[e][r]];
  c2=r+f2[a[e][r]];
  if(((0<=c1)&&(c1<q))&&((0<=c2)&&(c2<w))){
   if(s[c1*w+c2]==-1)
    l(c1,c2,t+1);
   v1=k(c1*w+c2);
   if((s[v1]>0)&&(s[v1]<t))
    v=v1;
  }
  if(v!=e*w+r){
   mask[v]|=mask[e*w+r];
   f[e*w+r]=v;
  }
  s[e*w+r]=-2;
}
int chek(int e,int r,bool b){
  int v=0;
  for(sp *c=a1[e*w+r];c;c=c->w){
   v=max(v,chek(opt1[c->q],opt2[c->q],0));
  }
  if((str[v]>=48)&&(  ((1<<(str[v]-48))&mask[e*w+r])>0  ))
   v++;
  if((b)&&(  (d[v]&mask[e*w+r])==d[v]  ))
   v=sizestr;
  return v;
}
int main(){
  #ifdef Vlad_kv
  freopen("input.txt","r",stdin);
  freopen("output.txt","w",stdout);
  #endif
  int e,r,t,o,c,v,c1,c2;
  cin>>q>>w>>o;
  for(e=0;e<q;e++){
   scanf("%s",a[e]);
   for(r=0;r<w;r++){
    a[e][r]-=48;
    opt1[e*w+r]=e;
    opt2[e*w+r]=r;
    f[e*w+r]=e*w+r;
    a1[e*w+r]=0;
    mask[e*w+r]=1<<a[e][r];
    s[e*w+r]=-1;
   }
  }
  for(e=0;e<10;e++)
   cin>>f1[e]>>f2[e];
  for(e=0;e<q;e++)
   for(r=0;r<w;r++)
    if(s[e*w+r]==-1)
     l(e,r,1);
  for(e=0;e<q;e++)
   for(r=0;r<w;r++){
    c1=e*w+r;
    c=e+f1[a[e][r]];
    v=r+f2[a[e][r]];
    c2=c*w+v;
    if(((0<=c)&&(c<q))&&((0<=v)&&(v<w))){
     c1=k(c1);
     c2=k(c2);
     if(c1!=c2){
      a1[c2]=new sp(c1,a1[c2]);
      s[c1]=1;
     }
    }
   }
  int ans;
  for(;o;o--){
   scanf("%s",str);
   sizestr=strlen(str);
   d[sizestr]=0;
   for(e=sizestr-1;e>=0;e--)
    d[e]=d[e+1]|(1<<(str[e]-48));
   ans=0;
   for(e=0;e<q;e++)
    for(r=0;r<w;r++)
     if((k(e*w+r)==e*w+r)&&(s[e*w+r]<0))
      ans=max(ans,chek(e,r,1));
   if(ans==sizestr)
    cout<<"YES\n";
   else
    cout<<"NO\n";
  }
  return 0;
}
