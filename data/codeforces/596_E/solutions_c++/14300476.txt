#include <iostream>
#include <cstdio>
#include <list>

using namespace std;

int a[13];
int b[13];
int d[210][210];
string z[210];
int c[210][210]; // kilk vhidnyk reber
int e[210][210];
int r[210][210][210];
bool res[210];
char buff[300];
int main()
{
    int n,m,q;
    gets(buff);
    sscanf(buff,"%d%d%d",&n,&m,&q);
    for(int i=0;i<n;i++)
    {
        gets(buff);
        for(int j=0;j<m;j++)
            d[i][j] = buff[j] - '0';
    }
    for(int i=0;i<10;i++)
        cin >> a[i]>>b[i];
    for(int i=0;i<q;i++)
        cin >> z[i];

    for(int i=0;i<n;i++)
    for(int j=0;j<m;j++)
    {
        int dd = d[i][j];
        int x = i + a[dd];
        int y = j + b[dd];
        if(x>=0 && x<n && y>=0 && y<m)
            c[x][y]++;
    }

    list<pair<int,int> > l;
    for(int i=0;i<n;i++)
    for(int j=0;j<m;j++)
        if(c[i][j]==0) l.push_back(make_pair(i,j));

    while(l.begin()!=l.end())
    {
        int x = l.front().first;
        int y = l.front().second;
        int dd = d[x][y];
        for(int k=0;k<q;k++)
        {
            int pos = r[x][y][k];
            if(pos < z[k].size() && z[k][pos] == dd+'0') r[x][y][k]++;
            if(r[x][y][k]==z[k].size()) res[k] = true;
        }
        l.pop_front();

        int xx = x + a[dd];
        int yy = y + b[dd];

        if(xx<0 || xx>=n || yy<0 || yy>=m){e[x][y]=1; continue;}
        c[xx][yy]--;
        if(c[xx][yy]==0) l.push_back(make_pair(xx,yy));
        for(int k=0;k<q;k++)
            r[xx][yy][k] = max(r[xx][yy][k],r[x][y][k]);
    }
    for(int i=0;i<n;i++)
    for(int j =0;j<m;j++)
    if(c[i][j]+e[i][j])
    {
        bool t[11];
        for(int k=0;k<11;k++)
            t[k] = false;
        int x = i;
        int y = j;
        t[d[x][y]] = true;
        while(c[x][y])
        {
            for(int k=0;k<q;k++)
                r[i][j][k] = max(r[i][j][k],r[x][y][k]);
            int dd = d[x][y];
            t[dd] = true;
            c[x][y] = 0;
            x = x + a[dd];
            y = y + b[dd];
        }
        for(int k=0;k<q;k++)
        {
            int pos = r[i][j][k];
            while(true)
            {
                if(pos==z[k].size() || !t[z[k][pos]-'0']) break;
                pos++;
            }
            if(pos==z[k].size()) res[k] = true;
        }
    }
    for(int i=0;i<q;i++)
        if(res[i]) cout <<"YES"<<endl; else cout <<"NO"<<endl;
    return 0;
}
