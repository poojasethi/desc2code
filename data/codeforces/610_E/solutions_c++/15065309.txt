#include <cstdio>
#include <iostream>
#include <cstring>
#include <algorithm>
#include <cmath>
#include <vector>
#include <queue>
using namespace std;
const int N=2E5+5;
const int inf=1E9;
struct map{
    int mi,ma;
}tr[N*4];
int n,m,k,f[20][20],pre,ans,x,l,r,t,y;
char s[N],q[20],ch;
bool o[N];

void add(int p,int l,int r,int x,int k)
{
    if (x>r||x<l) return;
    if (l==r)
    {
        if (k==1) tr[p].mi=tr[p].ma=l; else tr[p].mi=inf,tr[p].ma=0;
        return;
    }
    int mid=(l+r)/2;
    add(p*2,l,mid,x,k); add(p*2+1,mid+1,r,x,k);
    tr[p].mi=min(tr[p*2].mi,tr[p*2+1].mi);
    tr[p].ma=max(tr[p*2].ma,tr[p*2+1].ma);
}

int get(int p,int l,int r,int x,int y,int k)   // k==1 max 
{
    if (x>r||y<l) return k?0:inf;
    if (x<=l&&y>=r) return k?tr[p].ma:tr[p].mi;
    int mid=(l+r)/2;
    int u=get(p*2,l,mid,x,y,k),v=get(p*2+1,mid+1,r,x,y,k);
    return k?max(u,v):min(u,v);
}


void del(int x)
{
    add(1,1,n,x,0);
    pre=get(1,1,n,1,x,1);
    if (pre) f[s[pre]-'a'][s[x]-'a']--;
}

int main()
{
    cin>>n>>m>>k;
    scanf("\n%s",s+1);
    memset(o,true,sizeof(o));
    for (int i=1;i<=n;i++) 
    {
        add(1,1,n,i,1);
        if (i!=1) f[s[i-1]-'a'][s[i]-'a']++;
    }
    for (int i=1;i<=m;i++)
    {
        cin>>t;
        if (t==1)
        {
            scanf("%d%d %c",&l,&r,&ch);
            bool o=0;
            while (1)
            {
                x=get(1,1,n,1,r,1);
                if (x<l) break;
                if (!o)
                {
                    o=1;
                    y=get(1,1,n,x+1,n,0);
                    if (y<=n) f[s[x]-'a'][s[y]-'a']--;
                }
                del(x);
            }
            x=get(1,1,n,1,l-1,1);
            y=get(1,1,n,r+1,n,0);
            if (!o&&x&&y<=n) 
                f[s[x]-'a'][s[y]-'a']--;
            s[l]=s[r]=ch;
            add(1,1,n,l,1);
            if (x!=l-1&&l>1) s[l-1]=s[x],add(1,1,n,l-1,1);
            if (l-1) f[s[x]-'a'][ch-'a']++;
            add(1,1,n,r,1);
            if (r+1!=y&&r<n) s[r+1]=s[y],add(1,1,n,r+1,1);
            if (y<=n) f[ch-'a'][s[y]-'a']++;
        } else
        {
            scanf(" %s",q+1);
            ans=n;
            for (int u=1;u<=k;u++)
                for (int v=u+1;v<=k;v++) ans-=f[q[u]-'a'][q[v]-'a'];
            cout<<ans<<endl;
        }
    }
}
