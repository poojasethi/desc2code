#include <cstdio>
#include <cstdlib>
#include <ctime>
#include <cstring>
#include <cmath>
#include <algorithm>
#define Mod 1000000007
using namespace std;
int f[1000005][2][2];
char str[1000005];
int n;
int dfs(int x, int last, int now)
{
    if (x == n) return now == 0;
    if (f[x][last][now] != -1) return f[x][last][now];
    f[x][last][now] = 0;
    for (int next = 0; next <= 1; next ++)
    {
        int tmp = last + next;
        char get;
        if (now) get = '*';
        else get = tmp + '0';
        if (str[x] != get && str[x] != '?') continue;
        f[x][last][now] += dfs(x + 1, now, next);
        if (f[x][last][now] >= Mod) f[x][last][now] -= Mod;
    }
    return f[x][last][now];
}
int main( )
{
    memset(f, -1, sizeof(f));
    scanf("%s", str);
    n = strlen(str);
    printf("%d\n", (dfs(0, 0, 0) + dfs(0, 0, 1)) % Mod);
    return 0;
}
