#include <cstdio>
#include <cstring>

#define N 1000000
#define M 1000000007

unsigned a[5][2], n, i, c, x, y = 1;
char s;

int main()
{
	s = getchar();

	switch(s)
	{
		case '?': c = 15; break;
		case '0': c = 1; break;
		case '1': c = 2; break;
		case '2': c = 4; break;
		case '*': c = 8; break;
	}

	if (c & 1)
		a[0][y] = 1;
	if (c & 2)
		a[2][y] = 1;
	if (c & 8)
		a[4][y] = 1;

	while ((s = getchar()) != '\n')
	{
		a[0][x] = 0, a[1][x] = 0, a[2][x] = 0, a[3][x] = 0, a[4][x] = 0;
		switch(s)
		{
			case '?': c = 15; break;
			case '0': c = 1; break;
			case '1': c = 2; break;
			case '2': c = 4; break;
			case '*': c = 8; break;
		}
		if (c & 1)
			a[0][x] = (a[0][y] + a[1][y]) % M;
		if (c & 2)
		{
			a[1][x] = a[4][y];
			a[2][x] = (a[0][y] + a[1][y]) % M;
		}
		if (c & 4)
			a[3][x] = a[4][y];
		if (c & 8)
			a[4][x] = (a[2][y] + a[3][y] + a[4][y]) % M;
		x ^= 1, y ^= 1;
	}

	printf("%d\n", (a[0][y] + a[1][y] + a[4][y]) % M);

	return 0;
}
