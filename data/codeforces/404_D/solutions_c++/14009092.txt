#include<bits/stdc++.h>
using namespace std;
#define mod  1000000007
long long int dp[1000001][5];
char str[1000001];
int main()
{
    string s;
    
    long long int i,l;
    cin>>s;
    l=s.length();
    for(i=1;i<=l;i++)
    str[i]=s[i-1];
//  cout<<l<<endl;
    dp[0][0]=1;
    dp[0][2]=1;
    for(i=1;i<=l;i++)
    {
        if(str[i]=='?' || str[i]=='0')
        {
            dp[i][0]=(dp[i-1][1]+dp[i-1][0])%mod;
        }
        if(str[i]=='?'||str[i]=='1')
        {
            dp[i][1]=dp[i-1][4]%mod;
            dp[i][2]=(dp[i-1][0]+dp[i-1][1])%mod;
        }
        if(str[i]=='?' || str[i]=='2')
        {
            dp[i][3]=dp[i-1][4]%mod;
        }
        if(str[i]=='?' || str[i]=='*')
        {
            dp[i][4]=(dp[i-1][4]+dp[i-1][2]+dp[i-1][3])%mod;
        }
    }
    cout<<(dp[l][0]+dp[l][1]+dp[l][4])%mod;
    return 0;
}   