#include"stdio.h"
#include"string.h"
#define MOD 1000000007LL
long long DP[1000005][5], N;
char s[1000005];
int main() {
	scanf("%s", s + 1);
	N = strlen(s + 1);
	DP[0][0] = DP[0][2] = 1;
	for (int i = 1; i <= N; i++) {
		if (s[i] == '?' || s[i] == '0') DP[i][0] = (DP[i-1][0] + DP[i-1][1]) % MOD;
		if (s[i] == '?' || s[i] == '1') {
			DP[i][1] = DP[i-1][4];
			DP[i][2] = (DP[i-1][0] + DP[i-1][1]) % MOD;
		}
		if (s[i] == '?' || s[i] == '2') DP[i][3] = DP[i-1][4];
		if (s[i] == '?' || s[i] == '*') DP[i][4] = (DP[i-1][2] + DP[i-1][3] + DP[i-1][4]) % MOD;
	}
	printf("%I64d", (DP[N][0] + DP[N][1] + DP[N][4]) % MOD);
}
       	  		     	     	   	 	