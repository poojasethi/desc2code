#include<bits/stdc++.h>
using namespace std;
const int Maxn=1e6+6;
const int Mod=1e9+7;
#define ll long long

ll dp[Maxn][3];
char s[Maxn];

int main()
{
	scanf("%s",s);
	if(s[0]=='*')
	  dp[0][2]=1;
	else if(s[0]=='?')
	  dp[0][0]=1,dp[0][1]=1,dp[0][2]=1;
	else if(s[0]=='0')
	  dp[0][0]=1;
	else if(s[0]=='1')
	  dp[0][1]=1;

	int l=strlen(s);
	for(int i=1;i<l;i++)
	{
		if(s[i]=='*')
		  dp[i][2]=(dp[i-1][2]+dp[i-1][1])%Mod;
		else if(s[i]=='?')
		{
			dp[i][2]=(dp[i-1][1]+dp[i-1][2])%Mod;	//��*
			dp[i][0]=dp[i-1][0];					//��0
			//��1
			dp[i][1]=dp[i-1][0];
			dp[i][0]=(dp[i][0]+dp[i-1][2])%Mod;
			//��2
			dp[i][1]=(dp[i][1]+dp[i-1][2])%Mod;
		}
		else if(s[i]=='0')
		  dp[i][0]=dp[i-1][0];
		else if(s[i]=='1')
		  dp[i][1]=dp[i-1][0],dp[i][0]=dp[i-1][2];
		else if(s[i]=='2')
		  dp[i][1]=dp[i-1][2];
	}

	ll ans=(dp[l-1][0]+dp[l-1][2])%Mod;
	cout<<ans<<endl;
	return 0;
}
