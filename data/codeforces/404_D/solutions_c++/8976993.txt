#include<iostream>
#include<algorithm>
#include<cmath>

#define MOD 1000000007

using namespace std;

const int N = 1*1000*1000+100;
string s;
long long int dp[N][3];
int n;

int main()
{
	cin >> s;
	dp[0][0] = 1;
	if (s[0] == '*' || s[0] == '?')
        dp[0][1] = 1;
	n = (int)s.length();
	for (int i = 1; i <= n; i++)
	{
		if (s[i-1] == '?')
		{
			dp[i][0] = (dp[i-1][0]+dp[i-1][2])%MOD;
			dp[i][1] = (dp[i-1][0]+dp[i-1][2])%MOD;
			dp[i][2] = (dp[i-1][1]+dp[i-1][2])%MOD;
		}
		else if (s[i-1] == '0')
			dp[i][0] = dp[i-1][0];
		else if (s[i-1] == '1')
		{
			dp[i][0] = dp[i-1][2];
			dp[i][1] = dp[i-1][0];
		}
		else if (s[i-1] == '2')
			dp[i][1] = dp[i-1][2];
		else
			dp[i][2] = (dp[i-1][1]+dp[i-1][2])%MOD;
	}
	cout << (dp[n][0]+dp[n][2])%MOD;
	return 0;
}
