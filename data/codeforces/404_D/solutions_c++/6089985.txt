#include <cstring>
#include <cstdio>
typedef long long LL;
const int N = 1000010,p = 1000000007;
LL a0,a1b,a1f,a2,as,A0,A1b,A1f,A2,As;
char s[N];
int main() {
    a1b = a2 = 1;
    scanf("%s",s);
    int l = strlen(s);
    for (int i = 0;i < l;i++) {
        A2 = A1b = as;
        A0 = A1f = a1b+a0;
        As = a1f+as+a2;
        a0 = A0%p;a1b = A1b%p;a1f = A1f%p;a2 = A2%p;as = As%p;
        if (s[i] == '0') a1b = a1f = a2 = as = 0;
        if (s[i] == '1') a0 = as = a2 = 0;
        if (s[i] == '2') a0 = a1b = a1f = as = 0;
        if (s[i] == '*') a0 = a1b = a1f = a2 = 0;
    }
    printf("%I64d\n",(a1b+a0+as)%p);
    return 0;
}
