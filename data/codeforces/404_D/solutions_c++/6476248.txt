#include<iostream>
#include<algorithm>
#include<cstring>
#include<ctime>
#include<cmath>
#include<string>
#include<cstdio>
#include<vector>
using namespace std;

typedef long long LL;
const LL MOD = 1000000007;
LL dp[2][5] = {1,0,1,0,0,0,0,0,0,0};

int main() {
    int x = 0; char op;
    while((op = getchar()) != '\n') {
        memset(dp[1-x], 0, sizeof(dp[1-x]));
        if(op == '0' || op == '?')    //0
            dp[1-x][0] = (dp[x][0] + dp[x][1]) % MOD;

        if(op == '1' || op == '?')
            dp[1-x][1] = dp[x][4],    //1左边有雷
            dp[1-x][2] = (dp[x][0] + dp[x][1]) % MOD;  //1右边有雷

        if(op == '2' || op == '?')
            dp[1-x][3] = dp[x][4];    //2

        if(op == '*' || op == '?')   //雷
            dp[1-x][4] = (dp[x][3] + dp[x][2] + dp[x][4]) % MOD;
        x = 1 - x;
    }
    printf("%d\n", (dp[x][0] + dp[x][1] + dp[x][4]) % MOD);
    return 0;
}

			 	  		  	      		     	