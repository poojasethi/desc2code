#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std ; 

const int maxn = 1111111 ; 
const int mod = 1000000007 ; 

char a[1111111] ; 
__int64 dp[maxn][5] ; 

int main()
{
	int i , j , n,  m;  
	scanf("%s" , a+1) ; 
	memset( dp , 0 , sizeof(dp)) ; 
	dp[0][0] = dp[0][1] = 1 ; 
	int len  = strlen( a+1 ) ; 
	//printf("fuck\n") ; 
	for( i = 1 ; i <= len ; i++ ){
		if( a[i] == '0' || a[i] == '?'){
			dp[i][0] = ( dp[i][0] + dp[i-1][0])  %mod; 
		}
		if( a[i] == '1' || a[i] == '?'){
			dp[i][1] = (dp[i][1] + dp[i-1][0] ) %mod; 
			dp[i][0] = (dp[i][0] + dp[i-1][2] ) % mod ; 
		}
		if( a[i] == '2' || a[i] == '?' ){
			dp[i][1] = (dp[i][1] +dp[i-1][2]) % mod  ; 
		}
		if( a[i] == '*' || a[i] == '?'){
			dp[i][2] = ( dp[i][2] +dp[i-1][3] + dp[i-1][1]) %mod ; 
			dp[i][3] = ( dp[i][3] +dp[i-1][3] + dp[i-1][1]) %mod ; 	
		}
	}
	int ans  = ( dp[len][0] + dp[len][2] ) %mod ; ; 
	printf("%d\n" , ans ) ; 
	return 0 ; 	
}