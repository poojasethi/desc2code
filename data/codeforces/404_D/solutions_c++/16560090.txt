#include<bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

#define mod 1000000007
#define LL long long

using namespace std;

int dp[5],dp2[5]; //0, *1, _1, 2, *
int mtx[5][5]={
  {1,1,0,0,0},
  {0,0,0,0,1},
  {1,1,0,0,0},
  {0,0,0,0,1},
  {0,0,1,1,1}};
char c;

int main(){
  memset(dp,0,sizeof(dp));
  dp[0]=dp[2]=1;
  while(scanf("%c",&c)!=EOF){
    if(c=='\n'){
      int res=0;
      FI(i,0,4) if(i%4<2) res=(res+dp[i])%mod;
      printf("%d\n",res);
      return 0;
    }
    FI(i,0,4){
      dp2[i]=0;
      FI(j,0,4) dp2[i]=(dp2[i]+mtx[i][j]*dp[j])%mod;
    }
    if(c!='?' && c!='0') dp2[0]=0;
    if(c!='?' && c!='1') dp2[1]=dp2[2]=0;
    if(c!='?' && c!='2') dp2[3]=0;
    if(c!='?' && c!='*') dp2[4]=0;
    FI(i,0,4) dp[i]=dp2[i];
  }
}