#include<iostream>
#include<cstdio>
using namespace std;
const int mod=1e9+7;
int dp[3]={1,1,0};

int main(){
	int t[3];
	char c;
	while((c=getchar())!='\n'){
		t[0]=t[1]=t[2]=0;
		if(c=='0'||c=='?')
			t[0]+=dp[0];
		if(c=='1'||c=='?'){
			t[0]+=dp[2];
			t[1]+=dp[0];
		}
		if(c=='2'||c=='?')
			t[1]+=dp[2];
		if(c=='*'||c=='?')
			t[2]+=dp[1]+dp[2];
		for(int i=0;i<3;i++)
			dp[i]=t[i]%mod;
	}
	cout<<(dp[0]+dp[2])%mod<<endl;
	return 0;
}
