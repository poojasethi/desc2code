//By LH
#include<cstdio>
#include<cstring>
#include<iostream>
using namespace std;

const int MOD = 1000000007;
 
char s[1000005];
int n, f[1000005][3];

int main()
{
	int i;
	
	scanf("%s", s);
	n = strlen(s); 
	memset(f, 0, sizeof(f));
	if (s[0] == '0' || s[0] == '?') f[0][0] = 1;
	if (s[0] == '1' || s[0] == '?') f[0][1] = 1;
	if (s[0] == '*' || s[0] == '?') f[0][2] = 1;
	for (i = 1; i < n; i++)
	{
		if (s[i] == '0' || s[i] == '?') f[i][0] = (f[i][0] + f[i-1][0])%MOD;
		if (s[i] == '1' || s[i] == '?')
		{
			f[i][1] = (f[i][1] + f[i-1][0])%MOD;
			f[i][0] = (f[i][0] + f[i-1][2])%MOD;
		}
		if (s[i] == '2' || s[i] == '?') f[i][1] = (f[i][1] + f[i-1][2])%MOD;
		if (s[i] == '*' || s[i] == '?') f[i][2] = (f[i-1][1] + f[i-1][2])%MOD; 
	}
	printf("%d\n",(f[n-1][0]+f[n-1][2])%MOD);
	return 0;
}