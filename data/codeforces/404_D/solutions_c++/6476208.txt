#include <cstdio>
#include <cstring>

using namespace std ;

typedef long long LL ;

const LL MOD = 1000000007 ;

int main() {

    LL dp[5] = { 1 , 1 , 0 , 0 , 0 };
    LL t[5] ;

    char c ;
    while( ( c = getchar() ) != '\n' ) {

        for( int i = 0 ; i < 5 ; i ++ ) t[i] = 0 ;

        if( c == '0' || c == '?' ) {
            t[0] += dp[0] + dp[2] ;
        }
        if( c == '1' || c == '?' ) {
            t[1] += dp[0] + dp[2] ;
            t[2] += dp[4] ;
        }
        if( c == '2' || c == '?' ) {
            t[3] += dp[4] ;
        }
        if( c == '*' || c == '?' ) {
            t[4] += dp[1] + dp[3] + dp[4] ;
        }

        for( int i = 0 ; i < 5 ; i ++ ) dp[i] = t[i] % MOD ;

//        printf("%c  : " , c ) ;
//        for( int i = 0 ; i < 5 ; i ++ ) printf("%d  " , dp[i] ) ;
//        printf("\n") ;

    }

    printf("%lld\n" , ( dp[0] + dp[2] + dp[4] ) % MOD ) ;

    return 0 ;
}

 	  			 	 			  	 	  		 	 	