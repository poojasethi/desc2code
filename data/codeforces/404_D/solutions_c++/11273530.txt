#include<stdio.h>
#include<string.h>
#define mod 1000000007
int dp[1000011][5];
int main()
{
    char s[1000011];
 
    int i;
    s[0]='9';
	scanf("%s",s+1);
	memset(dp,0,sizeof(dp));
   dp[0][1]=1;
   dp[0][3]=1;
 
    int	len=strlen(s)-1;
    int ans=0;

	for(i=1;i<=len;i++)
	{
		if(s[i]=='?'||s[i]=='0')
		dp[i][1]=(dp[i-1][1]+dp[i-1][0])%mod;
		if(s[i]=='?'||s[i]=='*')
		dp[i][2]=((dp[i-1][3]+dp[i-1][4])%mod+dp[i-1][2]%mod)%mod;
		if(s[i]=='?'||s[i]=='1')
		{
		dp[i][3]=(dp[i-1][0]+dp[i-1][1])%mod;
		dp[i][0]=dp[i-1][2];
		}
	if(s[i]=='?'||s[i]=='2')
		dp[i][4]=dp[i-1][2];
	}
	
		if(s[len]=='?'||s[len]=='0')
			ans=(ans+dp[len][1])%mod;
		if(s[len]=='?'||s[len]=='*')
			ans=(ans+dp[len][2])%mod;
		if(s[len]=='?'||s[len]=='1')
		ans=(ans+dp[len][0])%mod;
		 printf("%d\n",ans%mod);
}