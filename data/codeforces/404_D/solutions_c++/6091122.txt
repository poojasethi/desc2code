#include<stdio.h>
#include<string.h>
#include<algorithm>
using namespace std;
const int mod=1000000007;
long long dp[3]={1,1,0};
int main()
{
#ifndef ONLINE_JUDGE
	freopen("data.in","r",stdin);
#endif
	int i,j;
	long long t[3];
	char ci;
	while((ci=getchar())!='\n')
	{
		memset(t,0,sizeof(t));
		if(ci=='0'||ci=='?')
			t[0]+=dp[0];
		if(ci=='1'||ci=='?')
			t[0]+=dp[2],t[1]+=dp[0];
		if(ci=='2'||ci=='?')
			t[1]+=dp[2];
		if(ci=='*'||ci=='?')
			t[2]+=dp[1]+dp[2];
		for(j=0;j<3;j++)
			dp[j]=t[j]%mod;
		//for(j=0;j<3;j++) printf("%d ",dp[j]); printf("\n");
	}
	printf("%I64d\n",(dp[0]+dp[2])%mod);
	return 0;
}
