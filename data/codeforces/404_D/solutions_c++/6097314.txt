#include<iostream>
#include<string>
#include<cstdio>
using namespace std;
const int mod = 1000000007;

int main(){
   long long r[3] = { 1, 1, 0 };
    char ch;
     while((ch=getchar())!='\n'){
        long long l[3] = {0,0,0};
        if (ch=='0'||ch=='?')
            l[0]+=r[0];
        if (ch=='1'||ch=='?'){
            l[0]+=r[2];
                l[1]+=r[0];
        }
        if (ch=='2'||ch=='?')
            l[1]+=r[2];
        if (ch=='*'||ch=='?')   
            l[2]+=r[1]+r[2];

        for (int i=0; i<3; ++i)
            r[i] = l[i] % mod;   
    }
    cout << (r[0] + r[2])%mod <<endl;
    return 0;
}
        