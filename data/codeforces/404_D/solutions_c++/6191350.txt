#include <cstdio>
#include <cstring>
using namespace std;

const int MOD = 1e9 + 7;

char ch;
long long a, b, c, d, e;
int main() {
    a = c = 1;

    while (true) {
        ch = getchar();
        if (ch != '*' && ch != '0' && ch != '1' && ch != '2' && ch != '?')
            break;
        
        long long pa = a, pb = b, pc = c, pd = d, pe = e;
        a = b = c = d = e = 0;
        
        if (ch == '0' || ch == '?')
            a = (pa + pb) % MOD;
                if (ch == '1' || ch == '?')
        {
            b = pe;
            c = (pa + pb) % MOD;
        }
            if (ch == '2' || ch == '?')
            d = pe;
        if (ch == '*' || ch == '?')
            e = (pc + pd + pe) % MOD;
    }
    printf("%d", (a + b + e) % MOD);
    return 0;
}