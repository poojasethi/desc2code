#include <cstdio>
#include <cstring>

using namespace std;

const int maxn = 1000000 + 10;
const int mod = 1000000000 + 7;

char s[maxn];

int main()
{
    while(scanf("%s", s) == 1) {
        long long d[] = {1, 1, 0};
        for(int i = 0; s[i]; i++) {
            long long t[] = {0, 0, 0};
            if(s[i] == '0' || s[i] == '?') t[0] += d[0];
            if(s[i] == '1' || s[i] == '?') {
                t[1] += d[0];
                t[0] += d[2];
            }
            if(s[i] == '2' || s[i] == '?') t[1] += d[2];
            if(s[i] == '*' || s[i] == '?') t[2] += d[2] + d[1];
            for(int j = 0; j < 3; j++) d[j] = t[j] % mod;
        }
        printf("%I64d\n", (d[0] + d[2]) % mod);
    }
    return 0;
}

