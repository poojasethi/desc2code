#include<iostream>
#include<cstring>
#include<cstdio>
using namespace std;
#define prt(k) cout<<#k"="<<k<<endl
#define err puts("=====");
int n;
#define ll long long
const ll mod=1e9+7;
#define N 1000006
int dp[N][6];
string s;
int pre[N];
int a[N];
int main()
{
    memset(dp,0,sizeof dp);
    while(cin>>s)
    {
        int dp[3]={1,1,0};
        int t[3];
        n=s.size();
        for(int i=0;i<n;i++)
        {
            t[0]=t[1]=t[2]=0;
            char c=s[i];
            if(c=='0'||c=='?')
            {
                t[0]+=dp[0];

            }
            if(c=='1'||c=='?')
            {
                t[0]+=dp[2];
                t[1]+=dp[0];
            }    ;
            if(c=='2'||c=='?')
                t[1]+=dp[2];
            if(c=='*'||c=='?')
                t[2]+=dp[1]+dp[2];
            for(int i=0;i<3;i++)
                dp[i]=t[i]%mod;
        }
        cout<<(dp[0]+dp[2])%mod<<endl;
    }
}
