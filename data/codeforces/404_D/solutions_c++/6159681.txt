#include <cstdio>
#include <cstring>
#include <iostream>
#define MAXN 1000010
#define MOD 1000000007
using namespace std;
int f[MAXN][5];
char n[MAXN];
int main(){
	n[0]='#';
	while(~scanf("%s",n+1)){
		memset(f,0,sizeof(f));
		f[0][0]=f[0][1]=1;
		int lens=strlen(n)-1;
		for(int i=1;i<=lens;i++){
			if(n[i]=='?'||n[i]=='0'){
				f[i][0]=(f[i-1][2]+f[i-1][0])%MOD;
			}
			if(n[i]=='?'||n[i]=='1'){
				f[i][1]=(f[i-1][0]+f[i-1][2])%MOD;
				f[i][2]=f[i-1][4];
			}
			if(n[i]=='?'||n[i]=='2'){
				f[i][3]=f[i-1][4];
			}
			if(n[i]=='?'||n[i]=='*'){
				f[i][4]=((f[i-1][4]+f[i-1][1])%MOD+f[i-1][3])%MOD;
			}
		}
		int res=0;
		if(n[lens]=='?'||n[lens]=='0')res=(res+f[lens][0])%MOD;
		if(n[lens]=='?'||n[lens]=='1')res=(res+f[lens][2])%MOD;
		if(n[lens]=='?'||n[lens]=='*')res=(res+f[lens][4])%MOD;
		printf("%d\n",res);
	}
}

   		 			   	 	  	 			    	