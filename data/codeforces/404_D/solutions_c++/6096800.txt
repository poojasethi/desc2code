#include<cstdio>
#include<cstring>
#include<algorithm>

using namespace std;

int dp[1000005][4];
int mod=1e9+7;
int h[1000];

int main()
{
	h['0']=0;
	h['1']=1;
	h['2']=1;
	h['*']=2;
	char str[1000005];
	scanf("%s",str);
	int len=strlen(str);
	//str[len]='0';str[len+1]='\0';
	if(str[0]=='?') dp[0][0]=dp[0][1]=dp[0][2]=1;
	else{
		if(str[0]!='2')
		dp[0][h[str[0]]]=1;
	}

	for(int i=1;str[i];i++){
		if(str[i]=='?'){
			for(int j=0;j<3;j++){
				if(j==0 || j==1) dp[i][j]=(dp[i-1][0]+dp[i-1][2])%mod;
				else dp[i][j]=(dp[i-1][1]+dp[i-1][2])%mod;
			}
		}
		else{
			if(str[i]=='0') dp[i][0]=dp[i-1][0];
			else if(str[i]=='1') dp[i][1]=dp[i-1][0],dp[i][0]=dp[i-1][2];
			else if(str[i]=='2') dp[i][1]=dp[i-1][2];
			else dp[i][2]=(dp[i-1][1]+dp[i-1][2])%mod;
			
		}
		/*for(int j=0;j<3;j++)
			printf("dp[%d][%d]= %d\n",i,j,dp[i][j]);//*/
	}
	int ans=(dp[len-1][0]+dp[len-1][2])%mod;
	printf("%d\n",ans);
	return  0;
}
