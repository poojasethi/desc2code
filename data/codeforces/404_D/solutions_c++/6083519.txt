#include <bits/stdc++.h>
#define maxn 1000020
#define MOd 1000000007

using namespace std;

char ar[maxn];
int a,dn[maxn][4][4];

bool s( int a , int b , int c ) {
	int t=0;
	if( a == 3 ) t++;
	if( c == 3 ) t++;
	if( b == t || b == 3 ) return 1;
	return 0;
}

int f( int n , int b2 , int b1 ) {
	int top = 0 , t = 0;
	if( n == a+2 ) return 1;
	
	if( dn[n][b2][b1] != -1 ) return dn[n][b2][b1];
	
	if( ar[n] == '?' ) {
		for(int i=0;i<4;i++)
			if( s( b2 , b1 , i ) || n == 1 ) top += f( n+1 , b1 , i ) , top %= MOd;
	}
	else {
		int i;
		if( ar[n] == '*' ) i = 3;
		else i = ar[n] - '0';
		if( s( b2 , b1 , i ) || n == 1 ) top += f( n+1 , b1 , i );
	}

	return dn[n][b2][b1] = top % MOd;
}

int main()
{
	scanf(" %s",ar+1);

	a = strlen( ar+1 );
	ar[a+1] = ar[a+2] = '0';

	for(int i=1;i<=a+1;i++)
		for(int j=0;j<4;j++)
			for(int k=0;k<4;k++)
				dn[i][j][k] = -1;
	
	printf("%d\n",f( 1 , 0 , 0 ) % MOd);
	
	return 0;
}
