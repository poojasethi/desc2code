#include<iostream>
#include<string>
using namespace std;
const int mod = 1000000007;

int main(){
	string s;
	cin>>s;

	long long r[3] = { 1, 1, 0 };
	for (int i=0; i<(int)s.size(); ++i){

		long long l[3] = {0,0,0};

		if (s[i]=='0'||s[i]=='?')
			l[0]+=r[0];
		if (s[i]=='1'||s[i]=='?'){
			l[0]+=r[2];
			l[1]+=r[0];
		}
		if (s[i]=='2'||s[i]=='?')
			l[1]+=r[2];
		if (s[i]=='*'||s[i]=='?')	
			l[2]+=r[1]+r[2];

		for (int i=0; i<3; ++i)
			r[i] = l[i] % mod;
	}	
	
	cout << (r[0] + r[2])%mod <<endl;
	return 0;
}
		