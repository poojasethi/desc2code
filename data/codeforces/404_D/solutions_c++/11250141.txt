#include <iostream>
#include <string>

using namespace std;

const long MAX_N = 1000001;
const long long M = 1000000007;

string s;
long n;
long long d[MAX_N][5];
long long ans;

int main () {
    cin >> s;

    n = s.size();
    d[0][0] = 1; d[0][1] = 1;

    for (long i = 1; i <= n; i++) {
        char c = s[i - 1];
        if (c == '0' || c == '?') {
            d[i][0] = d[i - 1][0] + d[i - 1][2];
        }
        if (c == '1' || c == '?') {
            d[i][1] = d[i - 1][0] + d[i - 1][2];
            d[i][2] = d[i - 1][4];
        }
        if (c == '2' || c == '?') {
            d[i][3] = d[i - 1][4];
        }
        if (c == '*' || c == '?') {
            d[i][4] = d[i - 1][1] + d[i - 1][3] + d[i - 1][4];
        }
        for (short j = 0; j < 5; j++) d[i][j] %= M;
    }

    ans = (d[n][0] + d[n][2] + d[n][4]) % M;

    cout << ans;

    return 0;
}