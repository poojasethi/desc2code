#include <iostream>
#include <cstring>
#include <cstdio>

using namespace std;
#define maxn 1000100
char s[maxn];
typedef long long ll;
ll dp[2][5];
#define mod 1000000007 
int main(int argc, char const *argv[])
{
	scanf("%s", s);
	int len = strlen(s);
	int pre = 1, now = 0;
	dp[now][0] = 1;
	dp[now][1] = 1;
	for (int i = 0; i < len; i ++){
		swap(pre,now);
		for (int j = 0; j < 4; j ++) {
			dp[now][j] = 0;
			dp[pre][j] %= mod;
		}
		if (s[i] == '0' || s[i] == '?'){
			dp[now][0] += dp[pre][0];
		}	
		if (s[i] == '1' || s[i] == '?'){
			dp[now][0] += dp[pre][2];
			dp[now][1] += dp[pre][0];
		}
		if (s[i] == '2' || s[i] == '?'){
			dp[now][1] += dp[pre][2]; 
		}

		if (s[i] == '*' || s[i] == '?'){
			dp[now][2] += dp[pre][1] + dp[pre][2]; 
		}
		
	}
	cout << (dp[now][0] + dp[now][2]) % mod << endl;
	return 0;
}