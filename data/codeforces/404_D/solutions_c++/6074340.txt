#include <iostream>
#include <cstdio>
#include <algorithm>
#include <cmath>
#include <cstring>
using namespace std;

const int mo = 1000000007;

int n, x, y;
int f[2][3];
char s[1100000];

int main()
{
	scanf("%s", s); n = strlen(s);
	f[1][0] = 1; f[1][1] = 1;
	for (int i = 0; i < n; i++) {
		x = i % 2; y = 1 - x;
		for (int j = 0; j < 3; j++) f[x][j] = 0;
		if (s[i] == '0') {
			f[x][0] = (f[x][0] + f[y][0]) % mo;
		}
		if (s[i] == '1') {
			f[x][0] = (f[x][0] + f[y][2]) % mo;
			f[x][1] = (f[x][1] + f[y][0]) % mo;
		}
		if (s[i] == '2') {
			f[x][1] = (f[x][1] + f[y][2]) % mo;
		}
		if (s[i] == '?') {
			f[x][0] = (f[x][0] + f[y][0]) % mo;
			f[x][0] = (f[x][0] + f[y][2]) % mo;
			f[x][1] = (f[x][1] + f[y][0]) % mo;
			f[x][1] = (f[x][1] + f[y][2]) % mo;
			f[x][2] = (f[y][1] + f[y][2]) % mo;
		}
		if (s[i] == '*') {
			f[x][2] = (f[y][1] + f[y][2]) % mo;
		}
	} 
	int ans = (f[x][0] + f[x][2]) % mo;	
	cout << ans << endl;
    return 0;
}
