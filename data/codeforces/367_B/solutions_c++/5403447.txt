#include <cstdio>
#include <iostream>
#include <map>
#include <cmath>
#include <algorithm>
#include <ctime>
#define MAXN 200010
#define MOD 1000000009
using namespace std;
typedef long long ll;

ll A,B,P;
ll Ar[MAXN];
ll Br[MAXN];
ll Dn[MAXN];
ll Sum;
ll Res,Rr[MAXN];
map<ll,ll> Hash;

int main(){
	srand(time(NULL));
	cin >> A >> B >> P;

	for(int i=1;i<=A;i++)
		cin >> Ar[i];

	for(int i=1;i<=B;i++){
		cin >> Br[i];
		if(Hash.find(Br[i]) == Hash.end())
			Hash[Br[i]]=rand();
		Sum=Sum+Hash[Br[i]];
	}

	for(int i=1;i<=A;i++){
		if(Hash.find(Ar[i]) == Hash.end())
			Ar[i]=1;
		else
			Ar[i]=Hash[Ar[i]];
	}

	for(int i=1;i<=A;i++){
		Dn[i]=Ar[i];
		if(i-P>=1)
			Dn[i]=Dn[i]+Dn[i-P];
		if(Dn[i] - Dn[max(0LL,i-B*P)] == Sum)
			Rr[++Res]=i-(B-1)*P;
	}

	sort(Rr+1,Rr+Res+1);

	cout << Res << endl;
	for(int i=1;i<=Res;i++)
		cout << Rr[i] << " ";
	printf("\n");

	return 0;
}