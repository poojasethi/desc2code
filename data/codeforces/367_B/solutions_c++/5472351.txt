#include <stdio.h>
#include <map>
#include <vector>
#include <algorithm>
using namespace std;
#define N 200010
int a[N], b[N];
map<int, int> x, y;
void Inc(int v, int delt) {
  y[v] += delt;
  if (y[v] == 0) y.erase(v);
}

int main() {
  int n, m, p;
  b[0] = 0;
  scanf("%d%d%d", &n, &m, &p);
  if (1 + 1ll*(m-1)*p > n) {
    printf("0\n");
    return 0;
  }
  int i, j, k;
  for (i = 1; i <= n; ++i) {
    scanf("%d", &a[i]);
  }
  for (i = 0; i < m; ++i) {
    int t;
    scanf("%d", &t);
    x[t]++;
  }
  for (i = 1; i <= p; ++i) {
    y = x;
    for (j = i; j <= n; j += p) {
      Inc(a[j], -1);
      int k = j - m * p;
      if (k >= 1) Inc(a[k], 1);
      if (k+p>0 && y.empty()) {
        b[++b[0]] = k+p;
      }
    }
  }
  sort(b+1,b+b[0]+1);
  printf("%d\n", b[0]);
  for (i = 1; i <= b[0]; ++i) printf("%d%c", b[i], i==b[0]?'\n':' '); 
  return 0;
}