#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <map>
#define N 200010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,s,p;
map<int,int>M,b;
int a[N],an[N];
int main() {
	scanf("%d%d%d",&n,&m,&p);
	For(i,1,n) scanf("%d",&a[i]);
	For(i,1,m) scanf("%d",&k),b[k]++;
	For(i,1,p) {
		M.clear(); s=0;
		for (j=i,k=1;j<=n;j+=p,k++) {
			if (k>m) {
				int A=a[j-p*m];
				M[A]--;
				if (b.count(A)&&M[A]<b[A]) s--;
			}
			int A=a[j];
			M[A]++;
			if (b.count(A)&&M[A]<=b[A]) s++;
			if (s==m) an[++*an]=j-(m-1)*p;
		}
	}
	sort(an+1,an+*an+1);
	printf("%d\n",*an);
	For(i,1,*an) printf("%d ",an[i]);
	printf("\n");
	//for(;;);
	return 0;
}
