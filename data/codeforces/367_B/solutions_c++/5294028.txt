#include <cstdio>
#include <iostream>
#include <algorithm>
#include <cstring>
#include <vector>
#include <map>
#define MAXN 202020
using namespace std;
typedef long long LL;
int n,m,P;
int ar[MAXN];
map <int,int> tt;
map <int,int> pp;
vector <int> vec;
int main()
{
	scanf(" %d %d %d",&n,&m,&P);
	for(int i=0;i<n;i++) scanf(" %d",&ar[i]);
	for(int i=0;i<m;i++)
	{
		int x;
		scanf(" %d",&x);
		tt[x]++;
	}
	for(int i=0;i<P;i++)
	{
		if(i+LL(m-1)*P >= n) break;
		int DIF=m;
		pp.clear();
		for(int j=i;j<n;j+=P)
		{
			pp[ar[j]]++;
			if(pp[ar[j]] > tt[ar[j]]) DIF++;
			else DIF--;
			if(j-LL(m)*P >= 0)
			{
				int x=j-m*P;
				pp[ar[x]]--;	
				if(pp[ar[x]] < tt[ar[x]]) DIF++;
				else DIF--;
			}
			if(!DIF)
			{
				vec.push_back(j-(m-1)*P);
			}
		}
	}
	printf("%d\n",vec.size());
	sort(vec.begin(),vec.end());
	for(int i=0;i<vec.size();i++) printf("%d ",vec[i]+1);
	printf("\n");
	return 0;
}
