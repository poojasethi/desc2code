#include<bits/stdc++.h>

using namespace std;

#define sgmn int v, int tl, int tr
#define tm   (tl + tr >> 1)
#define sol  v*2, tl, tm
#define sag  v*2+1, tm+1, tr
#define N 200005

map < int , unsigned > H,M;

int Asd[N],A[N],B[N],n,m,p,x,i,j,s,asd;

bool T[N];

int main(){

	cin >> n >> m >> p;

	for(i=1;i<=n;i++)
		scanf("%d",&A[i]);

	for(i=m;i--;){
		scanf("%d",&x);
		M[x]++;
	}

	for(i=1;i<=n;i++){

		if(T[i])
			continue;

		H.clear();
		x = 0;

		for(s=1,j=i ; j<=n ; j+=p,s++){

			T[j] = 1;

			B[s] = A[j];

			if(s > m && H[ B[s-m] ]-- <= M[ B[s-m] ])  x--;

			if(         ++H[ A[j] ] <= M[ A[j] ] )     x++;

			if(x == m)
				Asd[++asd] = j - (m-1) * p;
		}
	}
	
	sort(Asd + 1 , Asd + asd + 1);

	cout << asd << endl;

	for(i=1;i<=asd;i++)
		cout << Asd[i] << " ";

	return 0;
}
