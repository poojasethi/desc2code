#include <cstdio>
#include <map>
#include <algorithm>
#define REP(i,n) for (int i=1;i<=n;++i)
#define FOR(i,n) for (__typeof(n.begin())i=n.begin();i!=n.end();++i)
using namespace std;

const int MAXN=200020;
int n,m,p,x,num,sum;
int a[MAXN];
int ans[MAXN];
map<int,int> goal,now;

void Move(int k,int d) {
	if (now[k]==goal[k]) ++num;
	now[k]+=d;
	if (now[k]==goal[k]) --num;
}

int main() {
	scanf("%d%d%d",&n,&m,&p);
	REP(i,n) {scanf("%d",&a[i]);goal[a[i]]=0;}
	REP(i,m) {scanf("%d",&x);++goal[x];}
	sum=0;
	FOR(i,goal) if (i->second) ++sum;
	REP(i,p) {
		now.clear();
		num=sum;
		int l=i;
		for (int r=l;r<=n;r+=p) {
			Move(a[r],1);
			if (((r-l)/p+1)>m) {Move(a[l],-1);l+=p;}
			if (!num) ans[++ans[0]]=l;
		}
	}
	printf("%d\n",ans[0]);
	sort(ans+1,ans+ans[0]+1);
	REP(i,ans[0]) printf("%d ",ans[i]);
	return 0;
}
