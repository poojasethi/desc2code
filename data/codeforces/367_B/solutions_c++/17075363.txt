#include<stdio.h>
#include<string.h>
#include<algorithm>
#include<iostream>
#include<map>
#define INF 0x3f3f3f3f
#define ull unsigned long long
#define ll long long
#define IN __int64
#define N 200010
#define M 1000000007
using namespace std;
int a[N];int ans[N];
int n,m,p;
map<int,int>A,B;
void ins(int x,int t)
{
	B[x]+=t;
	if(!B[x])
		B.erase(x);
}
int main()
{
	int x,i,j,k;
	scanf("%d%d%d",&n,&m,&p);
	if(1ll*(m-1)*p+1>n)
		printf("0\n");
	else
	{
		for(i=1;i<=n;i++)
			scanf("%d",&a[i]);
		for(i=1;i<=m;i++)
		{
			scanf("%d",&x);
			A[x]++;
		}
		int kk=0;
		for(i=1;i<=p;i++)
		{
			B.clear();
			for(j=i;j<=n;j+=p)
			{
				ins(a[j],1);
				k=j-m*p;
				if(k>0)
					ins(a[k],-1);
				k=j-(m-1)*p;
				if(k>0&&B==A)
					ans[++kk]=k;
			}
		}
		sort(ans+1,ans+kk+1);
		printf("%d\n",kk);
		for(i=1;i<=kk;i++)
			printf("%d ",ans[i]);
//		printf("%d\n",ans[kk]);
	}
	return 0;	
}
 		 	  		   			 	 				 		 	 	