#include<cstdio>
#include<cstring>
#include<map>
#include<algorithm>
using namespace std;
typedef long long ll;
#define rep(i,n) for (int i=0;i<n;++i)
const int N=400005;
map<int,int> H;
int n,m,p,l,r,s,tot,T,a[N],b[N],c[N],ans[N];
int get(){int v; scanf("%d",&v); if (!H[v]) H[v]=++tot; return H[v];}
void add(int x){if (c[x]++<0) --s; else ++s;}
void del(int x){if (c[x]-->0) --s; else ++s;}
int main()
{
	scanf("%d%d%d",&n,&m,&p);
	rep(i,n) a[i]=get(); rep(i,m) b[i]=get(),--c[b[i]];
	rep(i,p){
		l=i,r=i,s=m;
		rep(j,m-1){add(a[r]),r+=p; if (r>=n) break;}
		while (r<=n){
			 add(a[r]),r+=p;
			 if (!s) ans[T++]=l;
			 del(a[l]),l+=p;
		}
		while (l<=n) del(a[l]),l+=p;
	}
	printf("%d\n",T); sort(ans,ans+T);
	rep(i,T) printf("%d ",ans[i]+1);
	return 0;
}
