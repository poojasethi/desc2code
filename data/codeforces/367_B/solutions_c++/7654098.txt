#include<cstdio>
#include<algorithm>
#include<map>
#define N 200005
using namespace std;
map<int,int>T,P;int ans[N],a[N],b[N];
int n,m,p,i,j,cnt,start,S,ok,tot;
inline void dfs(int k,int num)
{
  int A=++P[a[k]],B=T[a[k]];
  ok=ok+(A==B)-(A==B+1);
  if (num>m) A=--P[a[start]],B=T[a[start]],ok=ok+(A==B)-(A+1==B),start+=p;
  if (num>=m&&ok==tot) ans[++cnt]=start;
  if (k+p<=n) dfs(k+p,num+1);
}
int main()
{
  scanf("%d%d%d",&n,&m,&p);
  for (i=1;i<=n;i++) 
    scanf("%d",&a[i]);
  for (i=1;i<=m;i++) 
    scanf("%d",&b[i]),tot+=((++T[b[i]])==1);
  for (S=1;S<=p;S++)
    P.clear(),ok=0,dfs(start=S,1);
  printf("%d\n",cnt);
  sort(ans+1,ans+cnt+1);
  for (i=1;i<=cnt;i++)
    printf("%d ",ans[i]);
  return 0;
}
