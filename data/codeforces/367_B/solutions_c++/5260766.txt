#include <cstdio>
#include <vector>
#include <map>
#include <algorithm>
using namespace std;

const int N=200005;

int n,m,p,a[N],b[N];
vector<int> v;

int main() {
	scanf("%d%d%d",&n,&m,&p);
	for(int i=0; i<n; ++i) scanf("%d",a+i);
	for(int i=0; i<m; ++i) scanf("%d",b+i);
	for(int i=0; i<p && i+(m-1LL)*p<n; ++i) {
		int q=i,x=i,cnt=0;
		map<int,int> mp;
		for(int j=0; j<m; ++j,x+=p) {
			mp[b[j]]--;
			mp[a[x]]++;
		}
		map<int,int>::iterator it=mp.begin();
		for(; it!=mp.end(); ++it) {
			if(it->second) ++cnt;
		}
		if(!cnt) v.push_back(q);
		for(; x<n; x+=p) {
			int& h=mp[a[q]];
			if(!h) cnt++;
			else if(h==1) cnt--;
			h--;
			q+=p;
			int& t=mp[a[x]];
			if(!t) cnt++;
			else if(t==-1) cnt--;
			t++;
			if(!cnt) v.push_back(q);
		}
	}
	sort(v.begin(),v.end());
	printf("%d\n",v.size());
	for(size_t i=0; i<v.size(); ++i) {
		printf("%d%c",v[i]+1,i+1<v.size()?' ':'\n');
	}
}
