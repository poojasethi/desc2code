#include <map>
#include <cstdio>
#include <algorithm>
using namespace std;

map<int,int> A,B;
int N,M,P,a[200005],b[200005];

void ins(int x,int t)
{
	B[x]+=t;
	if (!B[x]) B.erase(x);
}

int main()
{
	scanf("%d%d%d",&N,&M,&P);
	if (1ll*(M-1)*P+1>N) {puts("0"); return 0;}
	for (int i=1; i<=N; i++) scanf("%d",&a[i]);
	for (int i=1,x; i<=M; i++) scanf("%d",&x),A[x]++;
	for (int i=1; i<=P; i++)
	{
		B=A;
		for (int j=i,k; j<=N; j+=P)
		{
			ins(a[j],-1),k=j-M*P;
			if (k>0) ins(a[k],1);
			if (k+P>0&&!B.size()) b[++b[0]]=k+P;
		}
	}
	sort(b+1,b+b[0]+1),printf("%d\n",b[0]);
	for (int i=1; i<=b[0]; i++) printf("%d%c",b[i],i==b[0]?'\n':' ');
}