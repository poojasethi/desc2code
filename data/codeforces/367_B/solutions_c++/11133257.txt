#include <cstdio>
#include <iostream>
#include <cmath>
#include <algorithm>
#include <cstring>
#include <map>
using namespace std;
typedef long long LL;
map<LL,LL> mpa,mpb;
void work(LL x,LL w)
{
	mpa[x]+=w;
	if (!mpa[x]) mpa.erase(x);
}
LL n,m,p;
LL a[200005];
LL x;
LL ans0;
LL ans[200005];
int main()
{	
	scanf("%I64d%I64d%I64d",&n,&m,&p);
	mpa.clear();mpb.clear();
	for (int i=1;i<=n;++i)
		scanf("%I64d",&a[i]);
	for (int i=1;i<=m;++i)
	{
		scanf("%I64d",&x);
		mpb[x]++;
	}
	for (int i=1;i<=p;++i)
	{
		mpa=mpb;
		if (i+(m-1)*p>n) break;
		for (int j=1;j<=m;++j)
			work(a[i+(j-1)*p],-1);
		if (!mpa.size()) 
		{
			++ans0;
			ans[ans0]=i;
		}
		for (int j=i+m*p;j<=n;j+=p)
		{
			work(a[j],-1);
			work(a[j-m*p],1);
			if (!mpa.size())
			{
				++ans0;
				ans[ans0]=j-m*p+p;
			}
		}
	}
	sort(ans+1,ans+ans0+1);
	printf("%I64d\n",ans0);
	for (int i=1;i<=ans0;++i)
		printf("%I64d ",ans[i]);
	return 0;
}
   				 		 	 	 		 	 	  		  	 		