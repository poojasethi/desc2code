#include<cstdio>
#include<algorithm>
#include<cstring>
#include<map>
#define rep(i,x,y) for(int i=x;i<=y;++i)
#define dep(i,x,y) for(int i=x;i>=y;--i)
#define LL long long
using namespace std;
#define N 2000005

int n,m,p,a[N],x,cnt,ans[N],len;
map<int,int> Q,b;

int main(){
//	freopen("1.in","r",stdin);
//	freopen("1.out","w",stdout);
	
	scanf("%d%d%d",&n,&m,&p);
	rep(i,1,n) scanf("%d",a+i);
	rep(i,1,m) scanf("%d",&x),b[x]++;
	rep(s,1,p){
		if((LL)s+(LL)(m-1)*p>n) break;
		
		Q.clear();
		cnt=0;
		for(int i=s,c=1;c<=m;i+=p,c++)
			if(Q[a[i]]++==b[a[i]]) ++cnt;
			
		for(int i=s+(m-1)*p;i<=n;i+=p){
			if(!cnt)
				ans[++len]=i-(m-1)*p;
			if(--Q[a[i-(m-1)*p]]==b[a[i-(m-1)*p]]) --cnt;
			if(Q[a[i+p]]++==b[a[i+p]]) ++cnt;
		}
	}
	sort(ans+1,ans+1+len);
	printf("%d\n",len);
	rep(i,1,len) printf("%d ",ans[i]);
}
