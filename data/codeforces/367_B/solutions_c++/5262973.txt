#include <cstdio>
#include <map>

#define N 200000

int n, m, p, i, j, k, c, q = 0, a[N], b[N], t;
long long s;
bool f;
std::map<int, int> w[N], v;
std::map<int, int>::iterator it;

int main()
{
	scanf("%d%d%d", &n, &m, &p);

	s = (long long) p * (m - 1);

	if (n < s)
	{
		puts("0");
		return 0;
	}

	for (i = 0; i < n; i ++)
		scanf("%d", &b[i]);

	for (i = 0; i < m; i ++)
	{
		scanf("%d", &k);
		++ v[k];
	}

	k = n - p * (m - 1);
	c = p * (m - 1);

	for (i = 0; i < n; i ++)
	{
		t = i % p;
		j = i - c;
		if (j < 0)
			j %= p;
		if (j < 0)
			j += p;
		if (j >= p && !-- w[t][b[j - p]])
				w[t].erase(b[j - p]);
		++ w[t][b[i]];
		if (j <= k && w[t] == v)
			a[q ++] = j + 1;
	}

	printf("%d\n", q);

	for (i = 0; i < q; i ++)
		printf("%d ", a[i]);

	return 0;
}
