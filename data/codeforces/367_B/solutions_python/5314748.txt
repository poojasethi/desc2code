R=lambda:map(int,raw_input().split())
n,m,p=R()
a=R()
b={}
for x in R():b[x]=b.get(x,0)+1
v=[]
for i in range(p):
  h,t=i-p,i
  c={}
  while t<n:
    x=a[t]
    c[x]=c.get(x,0)+1
    while c[x]>b.get(x,0):
      h+=p
      c[a[h]]-=1
    if m==(t-h)/p:v+=[h+p+1]
    t+=p
print len(v)
print ' '.join(map(str,sorted(v)))