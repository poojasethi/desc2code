#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define int64 long long
#define N 1000010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m;
int64 X,Y,mo,s,K;
int a[N];
struct ww {
	int a[2][2];
	inline ww operator * (const ww &A) {
		ww B={};
		int i,j,k;
		For(i,0,1)For(j,0,1)For(k,0,1) B.a[i][k]=(1ll*a[i][j]*A.a[j][k]+B.a[i][k])%mo;
		return B;
	}
} b,c;
int main() {
	scanf("%d%I64d%I64d%d",&n,&X,&Y,&mo);
	For(i,1,n) scanf("%d",&a[i]),s+=a[i];
	if (n==1) {
		printf("%d\n",a[1]%mo);
		return 0;
	}
	b=(ww){s%mo,(a[1]+a[n])%mo};
	c=(ww){3,0,-1,1};
	for (K=X;K;K>>=1) {
		if (K&1) b=b*c;
		c=c*c;
	}
	int ans_1=b.a[0][0];
	b=(ww){a[n-1]%mo,a[n]%mo};
	c=(ww){0,1,1,1};
	for (K=X;K;K>>=1) {
		if (K&1) b=b*c;
		c=c*c;
	}
	int ans_2=b.a[0][1];
	b=(ww){ans_1,(a[1]+ans_2)%mo};
	c=(ww){3,0,-1,1};
	for (K=Y;K;K>>=1) {
		if (K&1) b=b*c;
		c=c*c;
	}
	int ans_3=b.a[0][0];
	if (ans_3<0) ans_3+=mo;
	printf("%d\n",ans_3);
	return 0;
}
