#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <iostream>
#include <algorithm>
#define oo 2000005
using namespace std;
typedef long long LL;

LL h[2][2],ret[2][2],c[2][2];
LL a[oo];
LL n,x,y,modn,s,t;
pair<LL,LL>vt;

void Matrix(LL a[][2],LL b[][2])
{
	memset(c,0,sizeof(c));
	for (int i=0;i<2;++i)
	for (int k=0;k<2;++k)
	if (a[i][k])
	for (int j=0;j<2;++j)
	c[i][j]+=a[i][k]*b[k][j];
	for (int i=0;i<2;++i)
	for (int j=0;j<2;++j) a[i][j]=c[i][j]%modn;
}

LL Quick_sum(LL x,LL y)
{
	memset(h,0,sizeof(h));
	h[0][0]=3,h[1][0]=h[1][1]=1;	
	memset(ret,0,sizeof(ret));
	ret[0][0]=ret[1][1]=1;
	for (;y;y>>=1){
		if (y&1) Matrix(ret,h);
		Matrix(h,h);
	}
	return (ret[0][0]+x*ret[1][0])%modn;
}

void fib(LL y)
{
	memset(h,0,sizeof(h));
	h[0][0]=h[0][1]=h[1][0]=1;
	memset(ret,0,sizeof(ret));
	ret[0][0]=ret[1][1]=1;
	for (;y;y>>=1){
		if (y&1) Matrix(ret,h);
		Matrix(h,h);
	}

	vt.first=(ret[0][0]+ret[1][0])%modn;
	vt.second=(ret[0][1]+ret[1][1])%modn;
}

int main()
{
//	freopen("input.txt","r",stdin);
//	freopen("output.txt","r",stdin);

	cin>>n>>x>>y>>modn;
	for (int i=1;i<=n;++i){
		scanf("%I64d",&a[i]);
		s=(s+a[i])%modn;
	}
	t=(a[1]+a[n])%modn;
	if (x) s=(s*Quick_sum(0,x)%modn-t*Quick_sum(-1,x)%modn+t)%modn;
	
//	cout<<(s+modn)%modn<<endl;

	if (y){
		if (x){
			fib(x-1);
			t=(a[1]+vt.first*a[n]+vt.second*a[n-1])%modn;
		}else t=(a[1]+a[n])%modn;
		
//		cout<<t<<endl;

		s=(s*Quick_sum(0,y)%modn-t*Quick_sum(-1,y)%modn+t)%modn;
	}
	
	cout<<(s+modn)%modn<<endl;
	return 0;
}