#include <cstdio>
#include <cstring>
#include <vector>
#include <algorithm>
#include <string>
#include <iostream>
#include <set>
using namespace std;

string a[1005], b[1005];
int t[1005];
set<pair<string, string> > ans;

int main(void) {
	int n, d;
	cin >> n >> d;
	for(int i=0;i<n;i++)
		cin >> a[i] >> b[i] >> t[i];
	for(int i=0;i<n;i++)
		for(int j=i+1;j<n;j++)
			if(a[i]!=a[j] && a[i]==b[j] && b[i]==a[j]) {
				if(t[j]>t[i] && t[j]<=t[i]+d) {
					ans.insert(make_pair(min(a[i],a[j]), max(a[i],a[j])));
				}
			}
	cout << ans.size() << endl;
	for(set<pair<string, string> >::iterator it=ans.begin();
			it!=ans.end();it++)
		cout << it->first << ' ' << it->second << endl;
	return 0;
}

