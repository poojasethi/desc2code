#include <map>
#include <cstdio>
#include <iostream>
#include <algorithm>
using namespace std;

const int N = 1010;

pair<string,string> ans[N];
string a[N],b[N];
int n,d,i,j,cnt,t[N];

int main()
{
	//freopen("a.in", "r", stdin);
	//freopen("a.out", "w", stdout);
	cin >> n >> d;
	for (i = 1; i <= n; i++)
	{
		cin >> a[i] >> b[i] >> t[i];
		for (j = i-1; t[i] - t[j] <= d && j > 0; j--)
		if (t[i] != t[j] && a[j] == b[i] && b[j] == a[i]) {
			ans[cnt++] = make_pair(min(a[i],b[i]),max(a[i],b[i]));
			break;
		}
	}
	sort(ans, ans + cnt);
	cnt = unique(ans, ans + cnt) - ans;
	cout << cnt << endl;
	for (i = 0; i < cnt; i++)
		cout << ans[i].first << " " << ans[i].second << endl;
}
