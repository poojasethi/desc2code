#include<set>
#include<iostream>
using namespace std;
typedef pair<string,string> pss;
string a[1010],b[1010];
set<pss> S;
int N,d,t[1010];
main(){
    cin>>N>>d;
    for(int i=0;i<N;++i)
        cin>>a[i]>>b[i]>>t[i];
    for(int i=0;i<N;++i)
    for(int j=i+1;j<N;++j)
        if (a[i]==b[j]&&a[j]==b[i]&&t[j]>t[i]&&t[j]-t[i]<=d)
            S.insert(pss(min(a[i],a[j]),max(b[i],b[j])));
    cout<<S.size();
    for(typeof(S.begin())i=S.begin();i!=S.end();++i)
        cout<<endl<<i->first<<' '<<i->second;
}