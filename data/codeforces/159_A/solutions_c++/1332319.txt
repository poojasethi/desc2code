#include <iostream>
#include <cstdio>
#include <string>
#include <cmath>
using namespace std;

const int N = 1009;
string s[N], q[N];
int t[N], u[N];
int i, n, d, j, x, ans;

int main ()  {

	cin >> n >> d;

	for (i = 0; i < n; i++) {
		cin >> s[i] >> q[i] >> t[i];
		for (j = i - 1; j >= 0; j--) {
			x = abs(t[i] - t[j]);
			if (q[i] == s[j] && q[j] == s[i] && 0 < x && x <= d) 
				u[i] = 1;			
		}
		for (j = i - 1; j >= 0; j--) {
			if (q[i] == s[j] && q[j] == s[i] && u[j])
				u[i] = 0;
			if (q[i] == q[j] && s[i] == s[j] && u[j])
				u[i] = 0;
		}
		ans += u[i];
	}
	cout << ans << '\n';
	for (i = 0; i < n; i++)
		if (u[i])
			cout << s[i] << " " << q[i] << '\n';

		

}