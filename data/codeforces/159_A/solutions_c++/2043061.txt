#include <iostream>
#include <string>
#include <map>
#include <set>
#include <algorithm>
#include <vector>
using namespace std;
#define tr(c,i) for(typeof(c.begin())i=c.begin();i!=c.end();++i)
#define mp make_pair
int main()
{
	int n,d;
	while (cin>>n>>d) {
		set<pair<string,string> > res;
		map<pair<string,string>, vector<int> > x;
		for (int i=0;i<n;++i) {
			string a, b;
			int t;
			cin>>a>>b>>t;
			if (x.find(mp(b,a))!=x.end()) {
				tr(x[mp(b,a)],j) {
					int p=t-*j;
					if (0<p && p<=d) {
						res.insert(mp(min(a,b),max(a,b)));
						break;
					}
				}
			}
			x[mp(a,b)].push_back(t);
		}
		cout<<res.size()<<endl;
		tr(res,i) cout<<i->first<<' '<<i->second<<endl;
	}
	return 0;
}
