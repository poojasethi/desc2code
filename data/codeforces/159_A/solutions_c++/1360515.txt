#include <cstdio>
#include <string>
#include <iostream>
#include <map>
#define N 1005
#define FI(a, b, c) for(int a = b; a <= c; a++)
using namespace std;

int n, d, P, t[N];
string a[N], b[N], C[N], D[N];
bool f[N][N];
map<string, map<string, bool> > m;

int main(){
    scanf("%d %d", &n, &d);
    FI(i, 1, n){
        cin >> a[i] >> b[i] >> t[i];
        FI(j, 1, i - 1) if(a[i] == b[j] && a[j] == b[i] && t[i] > t[j] && t[i] - t[j] <= d && !m[a[i]][b[i]]){
            m[a[i]][b[i]] = m[b[i]][a[i]] = 1;
            C[P] = a[i];
            D[P++] = b[i];
        }
    }
    printf("%d\n", P);
    FI(i, 0, P - 1) cout << C[i] << ' ' << D[i] << '\n';
    scanf("\n");
}
