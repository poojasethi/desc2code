#include <iostream>
#include <vector>
#include <set>
using namespace std;
int main()
{ int n, d, i, j;
cin>>n>>d;
vector <pair <pair <string, string>, int> >V(n);
set <pair <string, string> >P;
for (i=0; i<n; i++)
{string x, y; int t;
cin>>x>>y>>t;
V[i].first=make_pair(x,y);
V[i].second=t;
pair <string, string>K=make_pair(y, x);
for (j=i-1; j>=0; j--)
{if (V[j].second+d<t) break;
if(V[j].second == t) continue;
if (V[j].first ==K )if (x<y) P.insert (V[i].first);
                        else  P.insert (K);}

}
set <pair <string, string> >::iterator p;
n=P.size();
cout<<n<<endl;
if (n) for (p=P.begin(); p!=P.end(); p++)
cout<<(*p).first<<" "<<(*p).second<<endl;

return 0;
}
