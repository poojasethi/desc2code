#include<iostream>
#include<cstdio>
#include<cstring>
#include<string>
#include<algorithm>
#include<cmath>
#include<map>
#include<set>
using namespace std;
int t[1005];
string s[1005],c[1005];
set<pair<string,string> > ss;
int main()
{
	int n,d,i,j;
    cin>>n>>d;
    for(i=0;i<n;++i)
		cin>>s[i]>>c[i]>>t[i];
    for(i=0;i<n;++i)
		for(j=i+1;j<n;++j)
			if(t[j]-t[i]>d)
				break;
			else if(t[j]-t[i]>0&&s[i]==c[j]&&s[j]==c[i])
				ss.insert(make_pair(min(s[i],c[i]),max(s[i],c[i])));
    cout<<ss.size()<<endl;
    for(set<pair<string,string> >::iterator it=ss.begin();it!=ss.end();++it)
		cout<<it->first<<" "<<it->second<<endl;
    return 0;
}