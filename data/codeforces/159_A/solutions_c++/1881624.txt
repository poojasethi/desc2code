#include<iostream>
using namespace std;
int abs(int a)
{
  return (a<0)?-a:a;
}
int main()
{
  string a[1001],b[1001],c[1001],d[1001];
  int n,i,p,k=0,j,t=0,q[1001];
  bool f=0;
  cin>>n>>p;
  for(i=0;i<n;i++) cin>>a[i]>>b[i]>>q[i];
  for(i=0;i<n;i++)
  for(j=i+1;j<n;j++)
  if (a[i]!="")
  {
     if (a[i]==b[j]&&b[i]==a[j]&&abs(q[i]-q[j])<=p&&abs(q[i]-q[j])!=0)
     {
       c[k]=a[i]; d[k++]=b[i]; a[j]="";
       break;
     }
  }
  for(i=0;i<k;i++)
  for(j=i+1;j<k;j++)
  if (c[i]!="")
  if (c[i]==c[j]&&d[i]==d[j]||c[i]==d[j]&&d[i]==c[j]){ c[j]=""; t++;}
  cout<<k-t<<endl;
  for(i=0;i<k;i++) if (c[i]!="")cout<<c[i]<<" "<<d[i]<<endl;
//  system("pause");
  return 0;
}
