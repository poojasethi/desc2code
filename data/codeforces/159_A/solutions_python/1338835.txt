n, d = map(int, raw_input().split())
ret = set()
tmp = {}
mm = set()
for i in range(n):
    a, b, t = raw_input().split()
    t = int(t)
    if not a in tmp:
        tmp[a] = []
    tmp[a].append((b, t))
    if b in tmp:
        for x in tmp[b]:
            u = t - x[1]
            if x[0] == a and u > 0 and u <= d:
                if (a, b) not in ret and (b, a) not in ret:
                    ret.add((a, b))
print(len(ret))
for key in ret:
    print(key[0] + " " + key[1])
