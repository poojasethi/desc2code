n,d=map(int,raw_input().split())
ans=set()
a=[]
for _ in xrange(n):
    s,r,t=raw_input().split()
    t=int(t)
    a.append((s,r,t))

for i in xrange(0,n):
    for j in xrange(i+1,n):
        if a[j][0]==a[i][1] and a[j][1]==a[i][0] and 0<a[j][2]-a[i][2]<=d and (a[i][1],a[i][0]) not in ans:
            ans.add((a[i][0],a[i][1]))
print len(ans)
for x in ans:
    print x[0],x[1]