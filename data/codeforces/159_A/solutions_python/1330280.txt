s = raw_input()
s = s.split()
n = int(s[0])
d = int(s[1])

A = []
B = []
T = []

A1 = set()

for i in range(0,n):
    s = raw_input()
    s = s.split()
    A.append(s[0])
    B.append(s[1])
    T.append(int(s[2]))

for i in range(0,n):
    j = i
    while((j<n) and (T[j]-T[i]<=d)):
        if((A[i]==B[j]) and (B[i]==A[j])):
            if(T[i]!=T[j]):
                A1.add((min(A[i],B[i])+' '+max(A[i],B[i])))
                break
        j+=1

print len(A1)
for i in A1:
    print i
