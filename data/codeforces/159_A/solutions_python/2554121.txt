n, g = map(int, raw_input().split())
l = [raw_input().split() for _ in range(n)]
r = set((min(a, b), max(a, b)) for a, b, u in l for c, d, v in l if a == d and b == c and 0 < abs(int(u) - int(v)) <= g)
print len(r)
print '\n'.join(a + ' ' + b for a, b in r)