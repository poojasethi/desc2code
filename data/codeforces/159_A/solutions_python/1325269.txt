n, d = map(int, raw_input().split())
res = []
a = [raw_input().split() for _ in xrange(n)]
for i in xrange(n):
    a[i][2]=int(a[i][2])
    for j in xrange(i):
        if a[i][0] == a[j][1] and a[i][1] == a[j][0] and 0<a[i][2]-a[j][2]<=d:
            if a[i][0]>a[i][1]: res.append((a[i][1], a[i][0]))
            else: res.append((a[i][0], a[i][1]))
res = set(res)
print len(res)
for u, v in res: print u, v
