n, m = map(int, raw_input().split())
d = {}
r = set()
for _ in range(n):
	a, b, t = raw_input().split()
	t = int(t)
	d[(a, b)] = d.get((a, b), []) + [t]
	if any(0 < t - v <= m for v in d.get((b, a), [])):
		r.add((min(a, b), max(a, b)))
print len(r)
print '\n'.join(a + ' ' + b for a, b in r)