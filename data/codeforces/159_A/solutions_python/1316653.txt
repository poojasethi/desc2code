(n,d) = map(int,raw_input().split())

a = []
friends = []
for i in xrange(n):
    str = raw_input().split()
    str[2] = int(str[2])
    a.append(str)

for i in a:
    for j in a:
        if (0<j[2]-i[2]<=d) & (i[0]==j[1]) & (j[0]==i[1]):
            if i[0]<i[1]:
                fr = [i[0],i[1]]
            else:
                fr = [i[1],i[0]]
            if friends.count(fr)==0:
                friends.append(fr)

print len(friends)
for i in friends:
    print i[0],i[1]