from bisect import *

n, d = map(int, raw_input().split())
di = {}
for _ in xrange(n):
    ma, mb, time = raw_input().split()
    key = (ma, mb)
    di.setdefault(key, [])
    di[key].append(int(time))

ans = set([])
for key, val in di.items():
    try: a = di[key[1], key[0]]
    except: continue
    for i in val:
        f = bisect_right(a, i) 
        if f < len(a) and a[f] - i <= d:
            ans.add(tuple(sorted(key)))
            break
print len(ans)
for x in ans: print ' '.join(x)
