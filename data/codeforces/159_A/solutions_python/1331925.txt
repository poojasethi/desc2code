n,k=map(int,raw_input().split())
ok=[]
d={}
for i in range(n):
    a1,a2,a3=raw_input().split()
    if (a1+"+"+a2) in ok or (a2+"+"+a1) in ok:
        continue
    a3=int(a3)
    if (a2+"+"+a1) in d:
        for j in d[a2+"+"+a1]:
            if j-a3<=k and j-a3>=-k and j!=a3:
                ok.append(a1+"+"+a2)
                break
    tmp=d.get((a1+"+"+a2),[])
    tmp.append(a3)
    d[a1+"+"+a2]=tmp

print len(ok)
for i in ok:
    a1,a2=i.split("+")
    print a1+" "+a2
