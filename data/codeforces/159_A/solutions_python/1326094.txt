n, d = [int(x) for x in raw_input().split()]
history = []
friends = []
for i in xrange(n):
	a, b, tS = [x for x in raw_input().split()]
	t = int(tS)
	j = -1
	while (abs(j) <= len(history)) and (t - history[j][2] <= d):
		if (t - history[j][2] > 0) and (history[j][0] == b) and (history[j][1] == a):
			if (min(a, b), max(a, b)) not in friends:
				friends.append((min(a, b), max(a, b)))
		j -= 1
	history.append((a, b, t))

print len(friends)
for i in friends:
	print ' '.join(i)
