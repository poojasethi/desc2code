n,d=map(int,raw_input().split())
a=[raw_input().split() for _ in range(n)]
for x in a: x[2]=int(x[2])
c={}
s={}
i=j=u=0
while i<n:
  while u<i and a[u][2]<a[i][2]-d:
    c[(a[u][0],a[u][1])]-=1
    u+=1
  while j<n and a[i][2]==a[j][2]: j+=1
  for k in xrange(i,j):
    if c.get((a[k][1],a[k][0])):
      s[(min(a[k][0],a[k][1]),max(a[k][0],a[k][1]))]=1
  for k in xrange(i,j):
    x=(a[k][0],a[k][1])
    c[x]=(c.get(x) or 0)+1
  i=j
print len(s)
for k in s.keys(): print k[0],k[1]
