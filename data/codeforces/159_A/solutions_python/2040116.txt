I=raw_input
n,d=map(int,I().split())
import collections 
f=collections.defaultdict(list)
R=[]
for i in range(n):
    s,r,t = I().split()
    t = int(t)
    f[(s,r)] += [t]
    g = f[(r,s)]
    for T in g:
        if t - T <=d and t-T and (s,r) not in R and (r,s) not in R :
            R +=[(s,r)]

print str(len(R))
for a,b in R:
    print a+" "+b  