n, d = map(int, raw_input().split())

res = set()
pairs = []
for i in xrange(n):
    a, b, t = raw_input().split()
    t = int(t)
    for p in pairs:
        if p[0] == b and p[1] == a and 0 < t - p[2] <= d:
            res.add(tuple(sorted([a,b])))
            break
    pairs.append((a, b, t))


print len(res)
for pair in res:
    print pair[0], pair[1]

