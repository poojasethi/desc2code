#!/usr/bin/env python

if __name__ == "__main__":
    n, d = map(int, raw_input().split())
    res = set()
    messages = {}
    cur_t = 0;
    queue = []
    for i in range(n):
        a, b, t = raw_input().split()
        t = int(t)
        if cur_t != t:
            for at, bt in queue:
                messages[(at, bt)] = cur_t
            del queue[:]
            cur_t = t
        if (b, a) in messages and t - messages[(b, a)] <= d:
            if a < b:
                res.add((a, b))
            else:
                res.add((b, a))
        queue.append((a, b))
    print(len(res))
    print("\n".join(map(lambda x: " ".join(x), res)))
