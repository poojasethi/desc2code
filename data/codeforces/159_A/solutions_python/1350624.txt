#!/usr/bin/env python

n, d = map(int, raw_input().split(' '))

answer = set()
pairs = []

for i in range(n):
    s, r, t = raw_input().split()
    t = int(t)
    for p in pairs:
	if p[0] == r and p[1] == s and 0 < t - p[2] <= d:
	    answer.add(tuple(sorted([s, r])))
	    break
    pairs.append((s, r, t))

print len(answer)
for a in answer:
    print a[0], a[1]
