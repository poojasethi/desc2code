from sys import stdin as I

v = []
rv = []
n, d = [int(part) for part in I.readline().split()]
for i in xrange(n):
    a, b, t = I.readline()[:-1].split()
    t = int(t)
    v.append((a, b, t))
    j = i - 1
    while j >= 0 and (t - v[j][2]) <= d:
        if t > v[j][2] and v[j][0] == b and v[j][1] == a:
            rv.append(sorted([a, b]))
        j -= 1
                
rv = set(tuple(item) for item in rv)
print len(rv)
for a, b in rv:
    print a, b
