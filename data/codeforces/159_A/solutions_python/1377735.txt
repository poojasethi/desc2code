from collections import defaultdict

[n, k] = map(int, raw_input().split())
pairs = defaultdict(list)
res = set()

for i in xrange(n):
  [a, b, t] = raw_input().split()
  t = int(t)
  pairs[a, b].append(t)
  if (b, a) in pairs:
    for s in pairs[b, a]:
      if 0 < t - s <= k:
        res.add((min(a, b),max(a, b)))
  
print len(res)
for r, r1 in res:
  print r, r1
