n,d=map(int,raw_input().split())
a=list()
for i in xrange(n):
    s=raw_input().split()
    s[2]=int(s[2])
    a.append(s)
r=set()
for fr1,to1,tm1 in a:
    for fr2,to2,tm2 in a:
        if (fr1==to2) and (fr2==to1) and (fr1!=fr2) and (0<abs(tm1-tm2)<=d):
            r.add(frozenset([fr1,fr2]))
print len(r)
for i in r:
    print " ".join(map(str,i)) 
           
            
        
        

