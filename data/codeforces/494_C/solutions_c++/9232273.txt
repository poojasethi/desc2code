#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define db double
#define N 100010
#define M 5010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int l,r;
	db p;
	int base,s;
} a[N];
int i,j,k,n,m;
int b[N],f[N],g[N];
db v[M][M];
inline bool cc1(const ww &a,const ww &b) {
	return (a.r-a.l)<(b.r-b.l);
}
inline bool cc2(const int &A,const int &B) {
	return a[A].l<a[B].l;
}
inline void get(int x,int y) {
	int i,_=m+1;
	int l=max(a[x].base,a[y].base);
	int r=max(a[x].base+a[x].s,a[y].base+a[y].s);
	int len=r-l;
	For(i,l,r) {
		int A=i-a[x].base,B=i-a[y].base;
		if (A>a[x].s) v[_][i-l]=v[y][B];
		else if (B>a[y].s) v[_][i-l]=v[x][A];
		else v[_][i-l]=1-(1-v[x][A])*(1-v[y][B]);
	}
	a[x].base=l;
	a[x].s=len;
	For(i,0,len) v[x][i]=v[_][i];
}
inline void work(int x,db p) {
	int i,len=a[x].s+1;
	v[x][len]=0;
	a[x].s=len;
	for (i=len;i;i--) v[x][i]+=(v[x][i-1]-v[x][i])*p;
}
int main() {
	scanf("%d%d",&n,&m);
	For(i,1,n) scanf("%d",&b[i]);
	For(i,1,m) scanf("%d%d%lf",&a[i].l,&a[i].r,&a[i].p);
	a[++m]=(ww){0,n,0};
	sort(a+1,a+m+1,cc1);
	a[0].s=0;
	For(i,1,m) {
		int s=0;
		For(j,1,i-1) if (!f[j]&&a[i].l<=a[j].l&&a[j].r<=a[i].r)
			f[j]=1,g[++s]=j;
		sort(g+1,g+s+1,cc2);
		a[i].base=-N;
		int last=a[i].l;
		g[s+1]=0; a[0].l=a[i].r+1;
		For(j,1,s+1) {
			int A=g[j];
			if (last<a[A].l) {
				int ma=0;
				For(k,last,a[A].l-1) ma=max(ma,b[k]);
				a[0].base=ma; v[0][0]=1;
				get(i,0);
			}
			if (!A) break;
			get(i,A);
			last=a[A].r+1;
		}
		work(i,a[i].p);
	}
	db ans=a[m].base;
	v[m][a[m].s+1]=0;
	For(i,0,a[m].s) ans+=(v[m][i]-v[m][i+1])*i;
	printf("%.12lf\n",ans);
	return 0;
}
