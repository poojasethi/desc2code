#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int f[5001],f1[5001];
double g[5001];
void qs(int q,int w){
  int e=q,r=w,y=q+(rand()%(w-q+1)),t=f1[y]-f[y];
  double y1;
  do{
  while(f1[e]-f[e]<t)e++;
  while(f1[r]-f[r]>t)r--;
  if(e<=r){
   y=f[e];f[e]=f[r];f[r]=y;
   y=f1[e];f1[e]=f1[r];f1[r]=y;
   y1=g[e];g[e]=g[r];g[r]=y1;
   e++;r--;}
  }while(e<=r);
  if(q<r)qs(q,r);
  if(e<w)qs(e,w);
}
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t=0,c,v,v1,y,a[100000],a1[100000],d[100000];
  double c1,c2,*s[100000];
  bool h[100000];
  cin>>q>>y;
  for(w=0;w<q;w++){
   h[w]=0;
   d[w]=1;}
  h[0]=1;
  for(w=0;w<q;w++){
   scanf("%d",&a1[w]);
   t=max(t,a1[w]);}
  for(w=0;w<q;w++)
   a1[w]=max(0,a1[w]-t+5001);
  for(w=0;w<y;w++){
   cin>>f[w]>>f1[w]>>g[w];
   f[w]--;
   f1[w]--;
   h[f[w]]=1;}
  f[y]=0;
  f1[y]=q-1;
  g[y]=0;
  y++;
  qs(0,y-1);
  for(w=0;w<q;w++)
   if(h[w]){
    s[w]=new double[10002];
    for(e=0;e<10002;e++)
     s[w][e]=0;
    s[w][a1[w]]=1;}
  for(w=0;w<y;w++){
   e=f[w];r=f1[w]-e+1;
   while(d[e]<r){
    c=e+d[e];
    if(h[c]){
     c1=c2=1;
     for(v=10001;v;v--){
      c1-=s[e][v];
      c2-=s[c][v];
      s[e][v]=s[e][v]*c2+s[c][v]*c1+s[e][v]*s[c][v];}}
    else
     for(v=1;v<a1[c];v++){
      s[e][a1[c]]+=s[e][v];
      s[e][v]=0;}
    d[e]+=d[c];}
   for(v=10000;v;v--){
    s[e][v+1]+=s[e][v]*g[w];
    s[e][v]*=1-g[w];}}
  c1=t;
  for(v=5001;v<10002;v++)
   c1+=(v-5001)*s[0][v];
  cout<<(int)c1<<".";
  for(w=0;w<7;w++){
   c1-=(int)c1;
   c1*=10;
   cout<<(int)c1;}
  return 0;}
