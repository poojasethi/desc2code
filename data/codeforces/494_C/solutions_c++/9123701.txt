#include<iostream>
#include<cstdio>
#include<cmath>
#include<cstring>
#include<algorithm>
using namespace std;
#define N 110000
#define M 5100
double f[M][M],g[M];
int b[N],c[N],d[M],n,m,v[M],next[M],head[M],num=0;
struct rec{
       int x,y;
       double p;
}a[M];
bool cmp(rec a,rec b){
     return a.x<b.x || a.x==b.x && a.y>b.y;
     }
int lowbit(int x){return x&(-x);}
void add(int x,int w){
     for(;x<=n;x+=lowbit(x))c[x]=max(c[x],w);     
}
int find(int x,int y){
    int ans=0;
    while(x<=y){
      if(y-x+1>=lowbit(y))ans=max(ans,c[y]),y-=lowbit(y);
      else ans=max(ans,b[y]),y--;
    }
    return ans;
}
void updata(int v,int u){
     for(int i=0;i<=m;i++)
       if(d[v]+i>=d[u])f[u][d[v]+i-d[u]]*=f[v][i];
}
void Add(int x,int y){
     v[++num]=y;next[num]=head[x];head[x]=num;
     }
void dfs(int u){
     for(int i=0;i<=m;i++)f[u][i]=1;
     for(int i=head[u];i;i=next[i]){
       dfs(v[i]);
       updata(v[i],u);
     }
     for(int i=0;i<=m;i++)g[i]=0;
     g[1]=f[u][0]*a[u].p;
     g[0]=f[u][0]*(1-a[u].p);
     for(int i=1;i<=m;i++){
       g[i+1]+=(f[u][i]-f[u][i-1])*a[u].p;
       g[i]+=(f[u][i]-f[u][i-1])*(1-a[u].p);
       }
     for(int i=1;i<=m;i++)g[i]+=g[i-1];
     for(int i=0;i<=m;i++)f[u][i]=g[i];
  //   printf("%d\n",u);
   //  for(int i=0;i<=m;i++)printf("%.2lf ",g[i]);printf("\n");
}
int main(){
    scanf("%d%d",&n,&m);
    for(int i=1;i<=n;i++){
      scanf("%d",&b[i]);
      add(i,b[i]);
      }
    for(int i=1;i<=m;i++)scanf("%d%d%lf",&a[i].x,&a[i].y,&a[i].p);
    m++;
    a[m].x=1;
    a[m].y=n;
    a[m].p=0;
    sort(a+1,a+m+1,cmp);
    for(int i=1;i<=m;i++)d[i]=find(a[i].x,a[i].y);
  //  for(int i=1;i<=m;i++)cout<<a[i].x<<" "<<a[i].y<<" "<<d[i]<<" "<<a[i].p<<endl;
    for(int i=2;i<=m;i++)
      for(int j=i-1;j;j--)
        if(a[j].x<=a[i].x && a[j].y>=a[i].y){
                          Add(j,i);
                         // cout<<j<<" "<<i<<endl;
                          break;
                          }
    dfs(1);
    double ans=f[1][0]*d[1];
    for(int i=1;i<=m;i++)ans+=(f[1][i]-f[1][i-1])*(d[1]+i);
    printf("%.7lf\n",ans);
    return 0;
}
