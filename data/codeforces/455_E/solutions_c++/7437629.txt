#include <iostream>
#include <vector>
#include <algorithm>
#include <cmath>

using namespace std;

int n,m;
int a[1000000];
int suma[1000000];
vector<pair<int,int> > vq[1000000];
int sol[1000000];
int ia[1000000];
int entra[1000000];
int i1=0;
int i2=-1;

void desplaza()
{
  ia[i2-1]=ia[i2];
  i2--;
  entra[i2]=1;
}

int main()
{
  cin>>n;
  for (int i=1;i<=n;i++) {
    cin>>a[i];
    suma[i]=a[i]+suma[i-1];
  }
  cin>>m;
  for (int i=0;i<m;i++) {
    int x,y;
    cin>>x>>y;
    vq[y].push_back(pair<int,int> (x,i));
  }
  for (int i=1;i<=n;i++) {
    i2++;
    ia[i2]=i;
    entra[i2]=1;
    while (i1<i2) {
      if (a[ia[i2-1]]>=a[ia[i2]])
	desplaza();
      else {
	int inf=0;
	int sup=ia[i2-1]+1;
	while (inf+1<sup) {
	  int med=(inf+sup)/2;
	  if (suma[ia[i2]]-suma[ia[i2-1]]+a[ia[i2-1]]*(ia[i2-1]-med+1)>=a[ia[i2]]*(ia[i2]-med+1))
	    sup=med;
	  else
	    inf=med;
	}
	entra[i2]=sup;
	if (entra[i2]<=entra[i2-1])
	  desplaza();
	else break;
      }
    }
    /*
    for (int k=i1;k<=i2;k++)
      cout<<"("<<ia[k]<<","<<entra[k]<<")";
    cout<<endl;
    */
    vector<pair<int,int> > &v=vq[i];
    for (int j=0;j<int(v.size());j++) {
      int y=v[j].first;
      int iq=v[j].second;
      int inf=i1;
      int sup=i2+1;
      while (inf+1<sup) {
	int med=(inf+sup)/2;
	if (entra[med]<=i-(y-1))/*(i-entra[med]>=y-1)*/ inf=med;
	else sup=med;
      }
      int inda=ia[inf];
      sol[iq]=suma[i]-suma[inda]+a[inda]*(y-(i-inda));
      //cout<<iq<<" "<<inf<<" "<<ia[inf]<<" "<<sol[iq]<<endl;
    }
  }
  for (int i=0;i<m;i++)
    cout<<sol[i]<<endl;
}
