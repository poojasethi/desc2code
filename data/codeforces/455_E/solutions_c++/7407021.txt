#include<iostream>
#include<cstdio>
#include<string>
#include<string.h>
#include<algorithm>
#include <time.h>
#include<list>
#include<vector>
using namespace std;
#define rep(i,a,b) for(int i=(a);i<(b);++i)
#define rrep(i,a,b) for(int i=(a);i>=(b);--i)
#define clr(a,x) memset(a,x,sizeof(a))
const int maxn=100000+5;
int sum[maxn];
int a[maxn];
int l[maxn],h[maxn];
inline int min(int a,int b) { return a<b?a:b; }
inline int max(int a,int b) { return a>b?a:b; }

void Getinput()
{
    freopen("in.txt","w",stdout);
    int n=100000; printf("%d\n",n);
    rep(i,1,n+1) printf("%d ",i);
    puts("");
    int m=100000; printf("%d\n",m);
    while(m--) printf("%d %d\n",n,n);
}

int main()
{
    //Getinput(); return 0;
    //freopen("in.txt","r",stdin);
    ios::sync_with_stdio(false);
    int n; cin>>n;
    a[0]=11111;
    rep(i,1,n+1) {
        l[i]=h[i]=i;
        cin>>a[i]; sum[i]=sum[i-1]+a[i];
        while(h[i]-1>=1&&a[h[i]-1]>=a[i]) h[i]=h[h[i]-1];
        if(a[i]>=a[i-1]) l[i]=l[i-1];
    }
    rep(i,2,n+1) {
        if(l[i]!=i) continue;
        l[i]=max(1,h[i]-1);
    }
    l[1]=0;
    int m,x,y,L,R; cin>>m;
    int ans;
    while(m--) {
        cin>>x>>y;
        L=y-x+1,R=y;
        int id=R;
        ans=sum[R]-sum[L-1];
        while(id>=L) {
            ans=min(ans,sum[R]-sum[id-1]+(id-L)*a[id]);
            id=l[id];
        }
        printf("%d\n",ans);
    }
}
