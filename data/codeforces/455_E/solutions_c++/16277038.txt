#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#include<iostream>
using namespace std;
typedef long long LL;
inline void readi(int &x);
const int maxn=100005;
int n,m;
int a[maxn],sum[maxn],st[maxn],top;
int head[maxn],next[maxn],adj[maxn];
LL ans[2000005];

inline double val(int x,int y)
{return double((sum[x]-sum[y]+(double)y*a[y]-(double)x*a[x])/(a[x]-a[y]));}


int main()
{
	readi(n);
	for(int i=1;i<=n;i++)
		readi(a[i]),sum[i]=sum[i-1]+a[i];
	readi(m);
	for(int x,y,i=1;i<=m;i++)
	{
		readi(x),readi(y);
		adj[i]=x;next[i]=head[y];head[y]=i;
	}
	int low,high,mid;
	for(int i=1;i<=n;i++)
	{
		for(;top&&a[i]<=a[st[top]];top--);
		for(;top>1&&val(st[top],i)>=val(st[top-1],i);top--);
		st[++top]=i;
		for(int j=head[i];j;j=next[j])
		{
			low=0,high=top;
			while(low+1<high)
			{
				mid=low+high>>1;
				if(st[mid]+adj[j]>=i)high=mid;
				else low=mid;
			}
			low=high-1,high=top;
			while(low+1<high)
			{
				mid=low+high>>1;
				if(val(st[mid],st[mid+1])<=adj[j]-i)high=mid;
				else low=mid;
			}
			ans[j]=sum[i]-sum[st[high]]+(LL)(adj[j]-i+st[high])*a[st[high]];
		}
	}
	for(int i=1;i<=m;++i)
		printf("%I64d\n",ans[i]);
	return 0;
}

inline void readi(int &x)
{char c;while(c=getchar(),c<'0'||c>'9');
x=c^'0';while(c=getchar(),c>='0'&&c<='9')x=x*10+(c^'0');}
