//In the name of God

#include <bits/stdc++.h>
using namespace std;
#define nor(x) ((x)+l)
#define rnor(x) ((x)-l)
#define left(x) ((x)*2)
#define right(x) (((x)*2)+1)
typedef long long lol;
const int MAXN=2e5+100;
int fs[MAXN*4],fc[MAXN*4],a[MAXN],ans[MAXN],l,n,q;
vector <pair <int,int> > v[MAXN];

void relax(int s,int e,int ind)
{
  int mid=(s+e)/2;
  if(fc[ind]!=-1)
    {
      int f=fc[ind];
      fc[left(ind)]=fc[right(ind)]=f;
      fs[left(ind)]=fs[ind];
      fs[right(ind)]=(mid-s)*f+fs[ind];
      fc[ind]=-1;
      fs[ind]=0;
    }
  else
    {
      fs[left(ind)]+=fs[ind];
      fs[right(ind)]+=fs[ind];
      fs[ind]=0;
    }
}

void add(int s,int e,int ind,int x,int y,int val)
{
  if(s>=y or e<=x)
    return;
  if(s>=x and e<=y)
    {
      fs[ind]+=val;
      return;
    }
  relax(s,e,ind);
  int mid=(s+e)/2;
  add(s,mid,left(ind),x,y,val);
  add(mid,e,right(ind),x,y,val);
}

void change(int s,int e,int ind,int x,int y,int val)
{
  if(s>=y or e<=x)
    return;
  if(s>=x and e<=y)
    {
      fs[ind]=(s-x)*val;//a
      fc[ind]=val;//d
      return;
    }
  relax(s,e,ind);
  int mid=(s+e)/2;
  change(s,mid,left(ind),x,y,val);
  change(mid,e,right(ind),x,y,val);
}

int fin(int s,int e,int ind,int x)
{
  if(s>x or e<=x)
    return 0;
  if(s+1==e)
    return fs[ind];
  relax(s,e,ind);
  int mid=(s+e)/2;
  return (fin(s,mid,left(ind),x)+
          fin(mid,e,right(ind),x));
}

inline bool check(int x,int j) {return a[j]*x<=fin(0,MAXN,1,nor(x-1))+a[j];}

void calc(int j)
{
  int s=1,e=n+1;
  while(e-s>1)
    {
      int mid=(s+e)/2;
      if(check(mid,j))
	s=mid;
      else
	e=mid;
    }
  int z=s;
  add(0,MAXN,1,nor(0),nor(n),a[j]);
  l--;
  change(0,MAXN,1,nor(0),nor(z+1),a[j]);
  for(int i=0;i<v[j].size();i++)
    ans[v[j][i].second]+=fin(0,MAXN,1,nor(v[j][i].first));
}

int main()
{
  ios::sync_with_stdio(false);
  memset(fc,-1,sizeof fc);
  cin>>n;
  for(int i=0;i<n;i++)
    cin>>a[i];
  l=MAXN-n-2;
  cin>>q;
  for(int i=0;i<q;i++)
    {
      int x,y;
      cin>>x>>y;
      y--;
      v[y].push_back({x,i});
    }
  for(int i=0;i<n;i++)
    calc(i);
  for(int i=0;i<q;i++)
    cout<<ans[i]<<endl;
  return 0;
}
