#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
class sp{
  public:
  int q;
  sp *w;
  sp(int q1,sp *w1){
   q=q1;w=w1;}
};
sp *a[200000];
int s[200000];
void l(int q,long long &c,long long &v){
  long long e,r,e1,r1;
  c=0;
  v=-(((long long)1)<<60);
  sp *c1;
  for(c1=a[q];c1;c1=c1->w){
   l(c1->q,e,r);
   e1=max(c+e,v+r);
   r1=max(c+r,e+v);
   c=e1;
   v=r1;}
  v=max(v,c+s[q]);
}
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t;
  cin>>q;
  for(w=0;w<q;w++){
   a[w]=0;
   scanf("%d%d",&e,&s[w]);
   e--;
   if(e>=0)
    a[e]=new sp(w,a[e]);}
  long long c,v;
  l(0,c,v);
  cout<<max(c,v);
  return 0;}
