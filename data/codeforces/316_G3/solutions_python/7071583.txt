#include <cstdio>
#include <cstring>
#include <iostream>

using namespace std;

const int MaxN = 1100000;

struct Node{
	int nxt[27];
	int len,cnt;
	int fa;
}pool[MaxN];
int TAIL=1,tail=1,op=1;
int cnt[MaxN][11],l[11],r[11],n,L,tot;
int q[MaxN],d[MaxN],S,T;
char st[MaxN];

void extend(int c,int len,int t){
	int p=tail,np=tail=++TAIL;
	pool[np].len=len;cnt[np][t]++;
	for(;p && !pool[p].nxt[c];p=pool[p].fa) pool[p].nxt[c]=np;
	if(!p) pool[np].fa=op;
	else{
		if(pool[pool[p].nxt[c]].len==pool[p].len+1) pool[np].fa=pool[p].nxt[c];
		else{
			int q=pool[p].nxt[c],r=++TAIL;pool[r]=pool[q];
			pool[r].len=pool[p].len+1;pool[q].fa=pool[np].fa=r;
			for(;p && pool[p].nxt[c]==q;p=pool[p].fa) pool[p].nxt[c]=r;
		}
	}
}

int check(int pos){
	if(!cnt[pos][0]) return 0;
	for(int i=1;i<=n;i++) if(l[i]>cnt[pos][i] || r[i]<cnt[pos][i]) return 0;
	return 1;
}
int main()
{
	scanf("%s%d",st+1,&n);L=strlen(st+1);
	for(int i=1;i<=n;i++) scanf("%s%d%d",st+L+2,&l[i],&r[i]),L+=strlen(st+L+2)+1;
	for(int i=1;i<=L;i++) st[i] ? extend(st[i]-'a'+1,i,tot) : extend(0,i,++tot);
	for(int i=1;i<=TAIL;i++) d[pool[i].fa]++;
	for(int i=1;i<=TAIL;i++) if(!d[i]) q[++T]=i;
	long long ans=0;
	for(S=1;S<=T;S++){
		int x=q[S],y=pool[x].fa; ans+=(pool[x].len-pool[y].len)*check(x);
		cnt[y][0]|=cnt[x][0];for(int i=1;i<=n;i++) cnt[y][i]+=cnt[x][i];
		if(!--d[y]) q[++T]=y;
	}
	cout << ans << endl;
	return 0;
}
