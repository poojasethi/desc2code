#include<bits/stdc++.h>
using namespace std;

const int N=1001000;
struct State{
    State *pre,*go[27];
    int step,s[11];
    void clear(){
        pre=0;step=0;
        memset(s,0,sizeof(s));
        memset(go,0,sizeof(go));
    }
}*root,*last;

State statePool[N],*b[N],*cur;
int c[N];

void init(){
    cur=statePool;
    root=last=cur++;
    root->clear();
}

void extend(int w,int idx){
    State *p=last;
    State *np=cur++;
    np->clear();
    np->step=p->step+1;
    if(~idx)np->s[idx]++;
    while(p&&!p->go[w]){
        p->go[w]=np;
        p=p->pre;
    }
    if(0==p){
        np->pre=root;
    }
    else{
        State *q=p->go[w];
        if(p->step+1==q->step){
            np->pre=q;
        }
        else{
            State *nq=cur++;
            nq->clear();
            memcpy(nq->go,q->go,sizeof(q->go));
            nq->step=p->step+1;
            nq->pre=q->pre;
            q->pre=nq;
            np->pre=nq;
            while(p&&p->go[w]==q){
                p->go[w]=nq;
                p=p->pre;
            }
        }
    }
    last=np;
}

char s[N];
int L[100],R[100];
int main(){
    init();
    scanf("%s",s);
    for(int i=0;s[i];i++){
        extend(s[i]-'a',0);
    }
    int n;
    scanf("%d",&n);
    for(int i=1;i<=n;i++){
        extend(26,-1);
        scanf("%s%d%d",s,&L[i],&R[i]);
        for(int j=0;s[j];j++){
            extend(s[j]-'a',i);
        }
    }

    int len=0;
    for(State *p=statePool;p<cur;p++){
        c[p->step]++;
        len=max(len,p->step);
    }
    for(int i=1;i<=len;i++){
        c[i]+=c[i-1];
    }
    for(State *p=cur-1;p>=statePool;p--){
        b[--c[p->step]]=p;
    }

    long long ret=0;
    for(int i=cur-statePool-1;i;i--){
        State *p=b[i];
        bool judge=true;
        for(int i=0;i<=n;i++){
            p->pre->s[i]+=p->s[i];
        }
        if(!p->s[0])continue;
        for(int i=1;i<=n;i++){
            if(p->s[i]<L[i]||p->s[i]>R[i]){
                judge=false;
                break;
            }
        }
        if(!judge)continue;
        ret+=p->step-p->pre->step;
    }
    printf("%I64d\n",ret);
    return 0;
}

 	  				 	   		 						       	