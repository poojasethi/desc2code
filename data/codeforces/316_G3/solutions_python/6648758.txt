#include <bits/stdc++.h>
using namespace std;

const int N = 1000010;
struct sannode
{
    int l,c[11];
    sannode *ch[27],*f;
    sannode() {
        memset(c,0,sizeof(c));
    }
}e[N],*tail,*head,*tmp,*a[N];

int cnt;
void add(int c,int len)
{
    if(c < 0) c = 26;
    sannode *p = tail,*np = &e[cnt ++];
    np->l = len;
    for(; p && !p->ch[c]; p = p->f) p->ch[c] = np;
    tail = np;
    if(!p) np->f = head;
    else {
        if(p->ch[c]->l == p->l + 1) np->f = p->ch[c];
        else {
            sannode *q = p->ch[c],*r = &e[cnt ++];
            *r = *q;
            r->l = p->l + 1;
            q->f = np->f = r;
            for(; p && p->ch[c] == q; p = p->f) p->ch[c] = r;
        }
    }
}
    
char s[12][N];
int c[N];

void topo_sort()
{
    for(int i = 0; i < cnt; i ++) c[i] = 0;
    for(int i = 0; i < cnt; i ++) c[e[i].l] ++;
    for(int i = 1; i < cnt; i ++) c[i] += c[i - 1];
    for(int i = 0; i < cnt; i ++) a[-- c[e[i].l]] = &e[i];
}

int L[15],R[15];
int main()
{
    tmp = tail = head = &e[cnt ++];
    scanf("%s",s[0]);
    int n = strlen(s[0]);
    int cc = 0;
    for(int i = 0; i <= n; i ++) add(s[0][i] - 'a',++ cc);
    scanf("%d",&n);
    for(int i = 1; i <= n; i ++) {
        scanf("%s%d%d",s[i],&L[i],&R[i]);
        int len = strlen(s[i]);
        for(int j = 0; j <= len; j ++) add(s[i][j] - 'a',++ cc);
    }
    topo_sort();
    for(int i = 0; i <= n; i ++) {
        for(int j = 0; s[i][j]; j ++) {
            tmp = tmp->ch[s[i][j] - 'a'];
            tmp->c[i] ++;
        }
        tmp = tmp->ch[26];
    }
    for(int i = cnt - 1; i > 0; i --) 
        for(int j = 0; j <= n; j ++) a[i]->f->c[j] += a[i]->c[j];
    long long ans = 0;
    for(int i = 1; i < cnt; i ++) {
        bool flag = true;
        for(int j = 1; j <= n; j ++) {
            if(a[i]->c[j] >= L[j] && a[i]->c[j] <= R[j]) continue;
            else flag = false;
        }
        if(flag && a[i]->c[0]) ans += a[i]->l - a[i]->f->l;
    }
    cout << ans << endl;
    return 0;
}


  			  	   	 				    	  	 	