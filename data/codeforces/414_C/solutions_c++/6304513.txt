#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
typedef long long ll;
ll ans[(1<<22)+1],f[23][2],tmp;
int i,j,k,n,m,tot,a[(1<<21)+1],b[(1<<21)+1],st,c[(1<<21)+1];
ll calc(int l,int r,int d,int flag){
	int i,j,k,m;
	ll res;
	if (d==n) return 0;
	m=(l+r)>>1;
	res=calc(l,m,d+1,flag);res+=calc(m+1,r,d+1,flag);
	for (i=l,j=m+1,k=l;i<=m||j<=r;){
		if ((i>m||a[j]<a[i])&&j<=r){
			b[k++]=a[j++];
		}else{
			b[k++]=a[i++];res+=j-m-1;
		}
	}
	for (i=l;i<=r;i++) a[i]=b[i];
	f[d][flag]+=res;
	return res;
}
void work(int x,int s,int t,ll now){
	if (x>n){
		ans[s]=now;return;
	}
	work(x+1,s,t,now);
	work(x+1,s+(1<<x),t^1,now+f[x][t^1]-f[x][t]);
}
int main(){
	scanf("%d",&n);tot=1<<n;memset(f,0,sizeof(f));
	for (i=1;i<=tot;i++) scanf("%d",&c[i]);
	for (i=1;i<=tot;i++) a[i]=c[i];
	calc(1,tot,0,0);
	for (i=1;i<=tot;i++) a[i]=c[tot-i+1];
	calc(1,tot,0,1);
	work(0,0,0,f[0][0]);
	scanf("%d",&m);
	for (i=1,st=0;i<=m;i++){
		scanf("%d",&k);k=n-k;
		st^=(1<<k);
		printf("%I64d\n",ans[st]);
	}
	return 0;
}