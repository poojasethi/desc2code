#include <cstdio>
#include <algorithm>
using namespace std;
int a[1 << 21];
long long b[2][30];
int s[30];
int main() {
	int n, m, q;
	long long ans = 0;
	scanf("%d", &n);
	for (int i = 0; i < 1 << n; i++) {
		scanf("%d", &a[i]);
	}
	for (int i = 0; i < n; i++) {
		for (int j = 0; j < 1 << (n - i); j += 2) {
			int ii = 1 << i;
			int lst = ii * j, rst = lst + ii, lt = lst, rt = rst;
			for (int k = 0; k < ii; k++) {
				while (a[lst+k] > a[rt] && rt < rst + ii) {
					++rt;
				} 
				b[0][i+1] += rt - rst;
				while (a[rst+k] > a[lt] && lt < lst + ii) {
					++lt;
				}
				b[1][i+1] += lt - lst;
			}
			inplace_merge(a+lst, a+rst, a+rst+ii);
		}
		ans += b[0][i+1];
	}
	scanf("%d", &m);
	while (m--) {
		scanf("%d", &q);
		for (int i = 0; i <= q; i++) {
			ans -= b[s[i]][i];
			s[i] = 1 - s[i];
			ans += b[s[i]][i];
		}
		printf("%I64d\n", ans);
	}
	return 0;
}
