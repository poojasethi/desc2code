#include <cstdio>
#include <iostream>
#include <string>
#include <map>
#include <vector>
#include <sstream>
#include <algorithm>
using namespace std;

typedef long long ll;

const int N=100005;

int n,m;
int a[N],b[N],s[N];

void dfs(ll i,int L)
{
	if (L==4) return;
	b[i*10+4]=1;
	b[i*10+7]=1;
//	printf("%d\n",i*10+4);
//	printf("%d\n",i*10+7);
	dfs(i*10+4,L+1);
	dfs(i*10+7,L+1);
}

void add(int i,int z)
{
	while (i<=n)
	{
		s[i]+=z;
		i+=i&-i;
	}
}

int ask(int i)
{
	int ret=0;
	while (i)
	{
		ret+=s[i];
		i-=i&-i;
	}
	return ret;
}

int main()
{
//  freopen("input.txt","r",stdin);
//	freopen("output.txt","w",stdout);

	dfs(0,0);
	scanf("%d%d\n",&n,&m);
	for (int i=1;i<=n;++i)
    {
        scanf("%d",&a[i]);
        if (b[a[i]]) add(i,1);
    }
	scanf("\n");
	for (int i=1;i<=m;++i)
	{
		char c[10];
		int l,r;
		scanf("%s%d%d",c,&l,&r);
//		printf("%s %d %d\n",c,l,r);
		if (c[0]=='c')
		{
			int ans=ask(r)-ask(l-1);
			printf("%d\n",ans);
		} else
		{
			int z;
			scanf("%d",&z);
			for (int j=l;j<=r;++j)
			{
				if (b[a[j]]) add(j,-1);
				a[j]+=z;
				if (b[a[j]]) add(j,1);
			}
		}
		scanf("\n");
	}

	return 0;
}
