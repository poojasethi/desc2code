#include<cstdio>
int n,m,a[100010],c[100010],lucky[10010];
char op[10];
int lowbit(int x){
    return x&(-x);
}
void dfs(int x){
    if(x>10000)return;
    lucky[x]=1;
    dfs(x*10+4);dfs(x*10+7);
}
void add(int x,int w){
    for(int i=x;i<=n;i+=lowbit(i))c[i]+=w;
}
int sum(int x){
    int res=0;
    for(int i=x;i>0;i-=lowbit(i))res+=c[i];
    return res; 
}
int main(){
    dfs(4);dfs(7);
    scanf("%d%d",&n,&m);
    for(int i=1;i<=n;++i){
        scanf("%d",&a[i]);
        if(lucky[a[i]])add(i,1);
    }
    for(int l,r,w,i=1;i<=m;++i){
        scanf("%s%d%d",op,&l,&r);
        if(op[0]=='c'){
            printf("%d\n",sum(r)-sum(l-1));
        }
        else{
            scanf("%d",&w);
            for(int j=l;j<=r;++j){
                if(lucky[a[j]])add(j,-1);
                a[j]+=w;
                if(lucky[a[j]])add(j,1);
            }
        }
    }
    return 0;
} 
