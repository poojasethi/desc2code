#include <iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#define INF 1000000007
using namespace std;
int d[100001],s[400001],mark[400001],ju[10001];
int lowbit(int n)
{
    return n&-n;
}
void initj(int cu,int j)
{
    if(cu==4)
    {
        ju[j]=1;
        return;
    }
    initj(cu+1,j*10+4);
    initj(cu+1,j*10+7);
    if(!j)initj(cu+1,0);
}

int sum(int a)
{
    int c=0;
    while(a)
    {
        c+=s[a];
        a-=lowbit(a);
    }
    return c;
}
void add(int a,int b,int n)
{
    for(int i=a;i<=n;i+=lowbit(i))
    {
        s[i]+=b;
    }
}
int main()
{
    memset(ju,0,sizeof(ju));
    initj(0,0);
    ju[0]=1;
    int n,m;
    scanf("%d%d",&n,&m);
    for(int i=1;i<=n;i++)
    {
        scanf("%d",d+i);
        if(ju[d[i]])add(i,1,n);
    }
    while(m--)
    {
        char ss[10];
        scanf("%s",ss);
        if(ss[0]=='c')
        {
            int a,b;
            scanf("%d%d",&a,&b);
            printf("%d\n",sum(b)-sum(a-1));
        }
        else 
        {
            int a,b,c;
            scanf("%d%d%d",&a,&b,&c);
            for(int i=a;i<=b;i++)
            {
                d[i]+=c;
                if(ju[d[i]]-ju[d[i]-c])add(i,ju[d[i]]-ju[d[i]-c],n);
            }
        }
    }
    return 0;
}
 						    	 	 	    		