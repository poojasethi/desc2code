#include <iostream>
#include <cstdio>
#include <cstring>
using namespace std;
#define N 100010
#define cl memset

int a[N],c[N];
bool lucky[N];

inline int lowbit(int x){
	return x & (-x);
}
inline void add(int p,int n,int m){
	while(p<=n){
		c[p] += m; p += lowbit(p);
	}
}
inline int sum(int m){
	int res = 0;
	while(m){
		res += c[m]; m -= lowbit(m);
	}
	return res;
}
inline bool check(int n){
	while(n){
		if(n%10 != 4 && n%10 != 7)  
			return false;
		n /= 10;
	}
	return true;
}

int main(){
	int n,m;
	while(scanf("%d%d",&n,&m)!=EOF){
		cl(c,0,sizeof(c));
		cl(lucky,false,sizeof(lucky));
		for(int i = 1; i <= 100000; i++)
			lucky[i] = check(i);

		for(int i = 1; i <= n; i++){
			scanf("%d",&a[i]);
			if(lucky[a[i]]) add(i,n,1);
		}
		while(m--){
			char op[10];
			int x,y,d;
			scanf("%s%d%d",op,&x,&y);
			if(op[0] == 'c'){
				printf("%d\n",sum(y)-sum(x-1));
			}
			else{
				scanf("%d",&d);
				for(int i = x; i <= y; i++){
					bool _ok = lucky[a[i]];
					bool ok = lucky[a[i]+=d];
					if(!_ok && ok) add(i,n,1);
					if(_ok && !ok) add(i,n,-1);
				}
			}
		}
	}
	return 0;
}