#include<iostream>
#include<cstring>
#include<cstdio>
#include<algorithm>
#include<vector> 
#define FOR(i,a,b) for (int i=(a),_b=(b);i<=_b;++i)
#define DOW(i,b,a) for (int i=(b),_a=(a);i>=_a;i--)
#define pb push_back
#define mp make_pair
#define fi first
#define se second

using namespace std;
typedef pair<int,int> PII;

const double eps = 1e-10;
const int inf = 1000000009;
int i, j, k, m, n, l;
int ans;

bool upd(bool& fx, int& x, int y) {
	if (!fx) {
		x = y;
		fx = true;
		return true;		
	}
	return x == y;
}

void solve2(int d, int a1, int a2, int b1, int b2, int& c1, int& c2) {
	vector<int> z; z.pb(a1); z.pb(a2 - d); z.pb(b1); z.pb(b2 - d); sort(z.begin(), z.end());
	c1 = (z[0] + z.back()) / 2;
	c2 = c1 + d;
}

int best;
vector<PII> solution;

void solve(const vector<PII>& w) {
	vector<PII> v = w;
	sort(v.begin(), v.end());
	best = -1;

	do {
		vector<int> index(4);
		FOR(i,0,3) {
			FOR(j,0,3) if (v[i] == w[j]) index[i] = j;
		}
		FOR(mask,0,15) {
			bool good = true;
			int x1 = 0, y1 = 0, x2 = 0, y2 = 0;
			bool fx1 = false, fx2 = false, fy1 = false, fy2 = false;
			FOR(i,0,3) if (mask&(1<<i)) {
				if (i == 0 || i == 2) good &= upd(fy1, y1, v[i].second);
				else good &= upd(fy2, y2, v[i].second);
			} else {
				if (i == 0 || i == 1) good &= upd(fx1, x1, v[i].first);
				else good &= upd(fx2, x2, v[i].first);
			}
			if (!good) continue;
			if (fx1 && fx2 && x1 >= x2) continue; 
			if (fy1 && fy2 && y1 >= y2) continue;
			if (fx1 && fx2 && fy1 && fy2 && x2 - x1 != y2 - y1) continue;
			if (fx1 && fx2 && fy1 && !fy2) upd(fy2, y2, x2 - x1 + y1);
			else if (fx1 && fx2 && !fy1 && fy2) upd(fy1, y1, x1 - x2 + y2); 
			else if (fx1 && !fx2 && fy1 && fy2) upd(fx2, x2, y2 - y1 + x1);
			else if (!fx1 && fx2 && fy1 && fy2) upd(fx1, x1, y1 - y2 + x2);

			if (fx1 && fx2 && fy1 && fy2) {
				
			} else if (fx1 && fx2) {
				solve2(x2 - x1, v[0].second, v[1].second, v[2].second, v[3].second, y1, y2); 
			} else if (fy1 && fy2) {
				solve2(y2 - y1, v[0].first, v[2].first, v[1].first, v[3].first, x1, x2); 
			} else {
				throw 12;
			}
			int mx = 0;
			mx = max(mx, abs(v[0].first - x1) + abs(v[0].second - y1));
			mx = max(mx, abs(v[1].first - x1) + abs(v[1].second - y2));
			mx = max(mx, abs(v[2].first - x2) + abs(v[2].second - y1));
			mx = max(mx, abs(v[3].first - x2) + abs(v[3].second - y2));
			if (best == -1 || mx < best) {
				best = mx;
				solution.resize(4);
				solution[index[0]] = PII(x1, y1);
				solution[index[1]] = PII(x1, y2);
				solution[index[2]] = PII(x2, y1);
				solution[index[3]] = PII(x2, y2);
			}
		}
		next_permutation(index.begin(), index.end());
	} while (next_permutation(v.begin(), v.end()));

}

int main(){	
	//freopen("input.inp","r",stdin);
	//freopen("output.out","w",stdout);
	scanf("%d",&n);

	while (n--) {	
		vector<PII> v;
		int x, y;
		FOR(i,1,4){
			scanf("%d%d",&x,&y);
			v.pb(PII(x, y));
		}
		solve(v);
		if (best == -1) {
			printf("-1\n");
		} else {
			printf("%d\n",best);
			FOR(i,0,3) printf("%d %d\n",solution[i].first,solution[i].second);
		}
	}
	
	return 0;
}
