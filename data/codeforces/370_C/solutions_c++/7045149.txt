#include <stdio.h>
#include <iostream>
#include <algorithm>
using namespace std;
int a[5005];
int main()
{
	int n, m, i, ans;
	while(scanf("%d%d", &n, &m) == 2){
		for(i = 0;i < n;i ++)
			scanf("%d", &a[i]);
		sort(a, a + n);
		for(i = ans = 0;i < n;i ++)
			ans += (a[i] != a[(i + n / 2) % n]);
		printf("%d\n", ans);
		for(i = 0;i < n;i ++)
			printf("%d %d\n", a[i], a[(i + (n / 2)) % n]);
	
	}
	return 0;
}

	 			   	 	 		 		 		 	  	