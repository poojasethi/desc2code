#include<iostream>
#include<algorithm>
using namespace std;
int num[10001];
int n,m;
int main(){
	cin>>n>>m;
	for(int i=1;i<=n;i++){
		cin>>num[i];
		num[i+n] = num[i];
	}
	sort(num+1,num+1+n*2);
	int cnt = 0;
	for(int i=1;i<=n;i++){
		if(num[i] != num[i+n]){
			cnt ++;
		}
	}
	cout<<cnt<<endl;
	for(int i=1;i<=n;i++){
		if(i%2==1) cout<<num[i]<<" "<<num[n+i]<<endl;
		else cout<<num[n+i]<<" "<<num[i]<<endl;
	}
	return 0;
} 