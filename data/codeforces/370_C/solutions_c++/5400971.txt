#include <iostream>
#include <algorithm>
#include <cstdio>

using namespace std;

int c[5005];
int cnt[5005];

int main()
{
	int n,m;
	cin>>n>>m;
	for(int i=0;i<n;++i)
	{
		cin>>c[i];
		++cnt[c[i]];
	}
	sort(c,c+n);
	int Max=0,res;
	for(int i=1;i<=m;++i)
		if(cnt[i]>Max) Max=cnt[i];
	if(Max*2>n) res=(n-Max)*2;
	else res=n;
	cout<<res<<endl;
	for(int i=0;i<n;++i)
		cout<<c[i]<<" "<<c[(i+Max)%n]<<endl;
	return 0;
}
