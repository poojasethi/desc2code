#include <stdio.h>
#include <algorithm>
using namespace std;

#define f1(i,n) for (int i=1; i<=n; i++)

typedef pair<int, int> ii;
#define X first
#define Y second

int n, m;
ii a[12309];

main(){
    scanf("%d%d", &n, &m);
    f1(i,n) { scanf("%d", &a[i].X); a[i].Y=i; }
    sort(a+1, a+n+1);
    f1(i,n) a[i+n]=a[i];

    int half=(n+1)/2, r=0;
    f1(i,n) if (a[i].X!=a[i+half].X) r++;
    printf("%d\n", r);
    f1(i,n) printf("%d %d\n", a[i].X, a[i+half].X); 
}