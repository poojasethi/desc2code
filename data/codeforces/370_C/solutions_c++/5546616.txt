#include <bits/stdc++.h>

using namespace std;

#define FOR(i,a,b) for(i=a;i<b;i++)
#define PB push_back
#define S(n)	scanf("%d",&n)
#define Sd(n)	scanf("%lf",&n)
#define P(n)	printf("%d\n",n)

	
using namespace std;
int main()
{
	int n,m,i,j;
	cin>>n>>m;
	int arr[n];
	FOR(i,0,n)
		cin>>arr[i];
	sort(arr,arr+n);
	
	int res=0;
	FOR(i,0,n)
		if((arr[(i+n/2)%n])!=arr[i])
			res++;
	P(res);
	FOR(i,0,n)
		cout<<arr[i]<<" "<<arr[(i+n/2)%n]<<"\n";

	return 0;
}