#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
int ans,n,m,a[5005];
int main(){
    scanf("%d%d",&n,&m);
    for(int i=0;i<n;++i)scanf("%d",a+i);
    sort(a,a+n);
    ans=n;
    for(int i=0;i<n;++i)
        if(a[i]==a[(i+n/2)%n])ans--;
    printf("%d\n",ans);
    for(int i=0;i<n;++i)
        printf("%d %d\n",a[i],a[(i+n/2)%n]);
    return 0;
}
