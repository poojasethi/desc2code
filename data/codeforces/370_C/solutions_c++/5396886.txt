#include<iostream>
#include<cstdio>
#include<algorithm>
using namespace std;

const int N=5006;
int a[N];
int cnt[446];
int c[N];
int  main()
{
	int  n,m;
	cin>>n>>m;
	for(int i=0;i<n;i++)
		cin>>a[i],cnt[a[i]]++;
	int b=0;
	for(int i=0;i<=m;i++)
		b=max(b,cnt[i]);
	sort(a,a+n);
	for(int i=b;i<n;i++)
		c[i-b]=a[i];
	for(int i=0;i<b;i++)
		c[n-b+i]=a[i];
	int ans=0;
	for(int i=0;i<n;i++)
		ans+=(a[i]!=c[i]);
	cout<<ans<<endl;
	for(int i=0;i<n;i++)
		cout<<a[i]<<' '<<c[i]<<endl;
}
