n , m = map(int,raw_input().split())

left , right = [] , []

for i in map(int,raw_input().split()):
	left.append(i)
	right.append(i)


left = sorted(left)
right = sorted(right)[::-1]
start , cont = 0 , 0

for i in xrange(n):
	if left[i] == right[i]:
		for j in xrange(start,n):
			if right[j] != right[i] and right[i] != left[j]:
				right[j] , right[i] = right[i] , right[j]
				start = j
				cont += 1
				break
	else:
		cont += 1

print cont
for i in xrange(n):
	print left[i] , right[i]
