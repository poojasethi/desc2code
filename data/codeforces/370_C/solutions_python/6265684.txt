#!/usr/bin/env python
n, m = map(int, raw_input().split())
c = map(int, raw_input().split())

cnt = {}
for x in c:
	if x not in cnt:
		cnt[x] = 0
	else:
		cnt[x] += 1

c = sorted(sorted(c), key = lambda x: cnt[x], reverse = True)

d = len(filter(lambda x: x == c[0], c))

result = zip(c, c[d:] + c[:d])
print len(filter(lambda (x, y): x != y, result))
for x, y in result:
	print x, y