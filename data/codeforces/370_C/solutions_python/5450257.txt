r = lambda: map(int, raw_input().split())
n, m = r()
a = r()
cnt = {}
for p in a:
    cnt[p] = cnt.get(p, 0) + 1
x = sorted(cnt.items(), key = lambda x: x[1], reverse = True)
y = x[1:] + [x[0]]

xx, yy = [], []
for p1, p2 in zip(x, y):
    for _ in xrange(p1[1]):
        xx.append(p1[0])
    for _ in xrange(p2[1]):
        yy.append(p2[0])
print sum(x != y for x, y in zip(xx, yy))
for x, y in zip(xx, yy):
    print x, y
