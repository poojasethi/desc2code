n,m=map(int,raw_input().split())
a=map(int,raw_input().split())
dic=dict()
for c in a:
    dic[c]=dic.get(c,0)+1
a=sorted(a,lambda x,y:y-x if dic[y]-dic[x]==0 else dic[y]-dic[x])
l=[]
off=dic[a[0]]
cnt=0
f=0
for i in xrange(n):
    x=a[i]
    y=a[(i+off)%n]
    if x!=y:
        cnt+=1
    l.append((a[i],y))
print cnt

for p in l:
    print p[0],p[1]
    
