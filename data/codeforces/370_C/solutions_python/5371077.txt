from collections import Counter
N,M = map(int,raw_input().split())
#print N,M
C = sorted(map(int,raw_input().split()))
#print C
counts =  Counter(C)
colors = counts.keys()
color_count = len(colors)
max_repeat_val = counts.most_common(1)[0][1]
max_repeated_cols = len([i for i in counts.values()  if i == max_repeat_val]) 
#print counts , colors, color_count, max_repeat_val, max_repeated_cols
left = C
right = [0]*N
if color_count == 1 :
	max_diff_colors = 0
	right = C
else :# max_repeated_cols == 1 :
	max_diff_colors = min(N,2*(N-max_repeat_val))
	for i in xrange(N) : 
		right[i] = C[(i+max_repeat_val)%N]
	
print max_diff_colors
for i in xrange(N) :
	print left[i],right[i]
