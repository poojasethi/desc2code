In=lambda:map(int,raw_input().split())
n,m=In()
a=In()
a.sort()
x,y=a,a[n/2:]+a[:n/2]
ans=sum([1 if p!=q else 0 for (p,q) in zip(x,y)])
print ans
for i in range(n):print str(x[i])+' '+str(y[i])
