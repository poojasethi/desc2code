n, m = (int(s) for s in raw_input().split())

c = [int(s) for s in raw_input().split()]
c.sort()

tot = 0
ans = [(c[i], c[(i + n / 2) % n]) for i in range(n)]
for i in ans:
	if i[0] != i[1]:
		tot += 1

print tot
for i in ans:
    print i[0], i[1]
