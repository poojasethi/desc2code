from collections import defaultdict
def main():
    n, m = map(int,raw_input().split())
    a = map(int, raw_input().split())
    G = defaultdict(int)
    for i in a:
        G[i] += 1
    c = []
    for a, b in sorted(G.items(), key=lambda x: x[1], reverse=True):
        c += [a] * b
    l = G[c[0]]
    d = c[l:] + c[:l]
    print sum(1 for i in range(n) if c[i] != d[i])
    for i in range(n):
        print c[i], d[i]



if __name__ == '__main__':
    main()
