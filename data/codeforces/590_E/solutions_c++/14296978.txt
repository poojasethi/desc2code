#include <iostream>
#include <cstring>
#include <cstdio>
#include <cstdlib>

using namespace std;

const int N=750,M=10000000;
int a[M+3][2],fail[M+3],It[M+3],q[M+3],To[M+3],Tn;
int f[N+3],St[N+3],Ed[N+3],len[N+3],n,ans;
bool b[N+3][N+3],vis[N+3],_vis[N+3],use[N+3][2];
char s[M+3];

void Insert(int w3,int len,int x)
{
    int w=0;
    for (int i=1;i<=len;i++,w3++)
    {
        if (!a[w][s[w3]-'a']) a[w][s[w3]-'a']=++Tn;
        w=a[w][s[w3]-'a'];
    }
    It[w]=x;
}

void Ac_Build()
{
    q[0]=0;
    int l=0,r=0;
    for (int i=0;i<2;i++)
        if (a[0][i]) q[++r]=a[0][i];
    for (;l<r;)
    {
        int x=q[++l];
        if (It[fail[x]]) To[x]=fail[x];
          else To[x]=To[fail[x]];
        for (int i=0;i<2;i++)
            if (a[x][i])
            {
                q[++r]=a[x][i];
                fail[a[x][i]]=a[fail[x]][i];
            }
            else a[x][i]=a[fail[x]][i];
    }
}

bool find(int w)
{
    for (int i=1;i<=n;i++)
        if (b[w][i]&&!vis[i])
        {
            vis[i]=1;
            if (!f[i]||find(f[i])) return f[i]=w,1;
        }
    return 0;
}

void Mak(int x,int y)
{
    if (use[x][y]) return;
    use[x][y]=1;
    for (int i=1;i<=n;i++)
    {
        if (!y&&b[x][i]) Mak(i,1);
        if (y&&f[x]==i) Mak(i,0);
    }
}

int main()
{
    scanf("%d",&n);
    for (int i=1;i<=n;i++)
    {
        St[i]=Ed[i-1]+1;
        scanf("%s",s+St[i]);
        len[i]=strlen(s+St[i]);
        Ed[i]=Ed[i-1]+len[i];
        Insert(St[i],len[i],i);
    }
    Ac_Build();
    
    for (int i=1;i<=n;i++)
        for (int j=St[i],w3=a[0][s[j]-'a'];j<=Ed[i];j++,w3=a[w3][s[j]-'a'])
        {
            int w=w3;
            for (;w&&!b[i][It[w]];w=To[w]) if (It[w]) b[i][It[w]]=1;
        }
    for (int i=1;i<=n;i++)
        for (int j=i;j<=n;j++) swap(b[i][j],b[j][i]);
    for (int i=1;i<=n;i++) b[i][i]=0;
    for (int i=1;i<=n;i++)
    {
        memset(vis,0,sizeof(vis));
        if (find(i)) ans++;
            else _vis[i]=1;
    }
    for (int i=1;i<=n;i++)
        if (_vis[i]) Mak(i,0);
    memset(vis,0,sizeof(vis));
    for (int i=1;i<=n;i++)
    {
        if (!_vis[i]&&!use[i][0]) vis[i]=1;
        if (f[i]&&use[i][1]) vis[i]=1;
    }
    printf("%d\n",n-ans);
    for (int i=1;i<=n;i++)
        if (!vis[i]) printf("%d ",i);
}
