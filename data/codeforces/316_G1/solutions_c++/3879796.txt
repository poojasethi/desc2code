#include <iostream>
#include <string>
#include <set>
using namespace std;
set<int> st[10],st_c[10];
set<string> ans;
set<int>::iterator it;
int main(){
	string s;
	int n;
	cin >> s >> n;
	int m=s.size();
	string p[10]={};
	int l[10]={},r[10]={};
	for(int i=0;i<n;i++){
		cin >> p[i] >> l[i] >> r[i];
	}
	for(int i=0;i<m;i++){
		string sub;
		for(int k=0;k<n;k++){
			for(int j=0;j<p[k].size();j++){
				st[k].insert(j);
			}
		}
		for(int j=i;j<m;j++){
			sub+=s[j];
			bool flag=true;
			for(int k=0;k<n;k++){
				int cnt=0;
				for(it=st[k].begin();it!=st[k].end();it++){
					if(s[j]==p[k][(*it)]){
						cnt++;
						if( (*it)+1!=p[k].size() ) st_c[k].insert((*it)+1);
					}
				}
				st[k]=st_c[k];
				st_c[k].clear();
				if( cnt<l[k] || r[k]<cnt ) flag=false;
			}
			if(flag){
				ans.insert(sub);
			}
		}
	}
	cout << ans.size();
	return 0;
}