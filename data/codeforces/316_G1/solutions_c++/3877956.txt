#include<iostream>
#include<cstdio>
#include<vector>
#include<string>
#include<queue>
#include<cstring>
#include<map>
#include<cmath>
#include<algorithm>
using namespace std;
#define  ll long long
#define inf 0x3fffffff
#define MOD 1000000000
#define N 1000000
map<string,bool> flag;
string str,subs;
string ch[20];
int len[20],l[20],r[20];
int main()
{
	int ln;
	cin>>str;
	ln = str.length();
	int n,ans = 0;
	cin>>n;
	for(int i=0;i<n;i++) { cin>>ch[i]>>l[i]>>r[i]; len[i] = ch[i].length(); }
	for(int i=0;i<ln;i++)
		for(int j=1;i+j<=ln;j++)
		{
			subs = str.substr(i,j);
			if(!flag[subs])
			{

		
			flag[subs] = true;
			bool ok = true;
			for(int k=0;k<n;k++)
			{
				int cnt = 0;
				for(int t = 0;t+j<=len[k];t++)
				{
					int s;
					for(s=0;s<j;s++)
						if(subs[s]!=ch[k][t+s]) break;
					if(s==j) cnt++;
				}
				if(cnt>=l[k]&&cnt<=r[k]) continue;
				else 
				{
					ok = false;
					break;
				}
			}
			if(ok) ans++;
			}

		}
		printf("%d\n",ans);
}


