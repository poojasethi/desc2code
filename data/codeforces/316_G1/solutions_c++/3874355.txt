#include<cstring>
#include<cstdio>
#include<string>
#include<set>
using namespace std;
const int N = 50010;
int n,ans,f,m,tot;
int l[N],r[N];
char s[N],st[N],p[10][N];
set<string> h;

int calc(int i)
{
    char *c=p[i];
    int ret=0;
    while (c=strstr(c,st))
    {
        ret++, c++;
    }
    return ret>=l[i]&&ret<=r[i];
}

int main()
{
    scanf("%s%d",s,&n);
    for (int i=0;i<n;i++)
        scanf("%s%d%d",p[i],l+i,r+i);
    m=strlen(s);
    for (int i=0;i<m;i++)
    {
        tot=0;
        for (int j=i;j<m;j++)
        {
            f=1;
            st[tot]=s[j];
            st[++tot]=0;
            if (h.count(st)) continue;
            for (int k=0;k<n;k++)
                if (f&=calc(k),!f) break;
            ans+=f;
            h.insert(st);
        }
    }
    printf("%d\n",ans);
}