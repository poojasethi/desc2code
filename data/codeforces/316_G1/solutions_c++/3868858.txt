#include<iostream>
#include<stdio.h>
#include<string.h>
#include<cmath>
#include<algorithm>
using namespace std;

int ans,i,j,n,len,m,num,k,l[20],r[20];
string ss,p[20],s[21000],pp;
bool ok;

int main()
{
	cin>>ss;
	cin>>n;
	for (i=1;i<=n;i++) cin>>p[i]>>l[i]>>r[i];
	
	len=ss.size();
	for (i=0;i<=len;i++)
	for (j=i;j<=len;j++) 
	{
		m++;
		s[m]=ss.substr(i,j-i+1);
	}
	ans=0;
	sort(s+1,s+m+1);
	for (i=1;i<=m;i++)
		if (s[i]!=s[i-1])
		{
			ok=true;
			for (j=1;j<=n;j++)
			{
				num=0;
				pp=p[j];
				k=pp.find(s[i]);
				while (k>=0)
				{
					num++;
					pp[k]='`';	
					k=pp.find(s[i]);	
				}
				if (!((num<=r[j])&&(num>=l[j]))) 
				{
					ok=false;
					break;
				}
			}
			if (ok) 
			{
				ans++;
			//	cout<<s[i]<<endl;
			}
		}
	cout<<ans<<endl;

return 0;	
}
