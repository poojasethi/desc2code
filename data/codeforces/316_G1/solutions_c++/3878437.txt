#include<map>
#include<cmath>
#include<cstdio>
#include<cstring>
#include<string.h>
#include<iostream>

using namespace std;

map <string, bool> was;
string s, t, tt, p[11];
int i, j, sz, n, jj, u, d[2020], ans, sum, l[2020], r[2020], res, k;

int main()
{
//	freopen("a.in", "r", stdin);	freopen("a.out", "w", stdout);
	getline(cin, s);
	sz = s.size();
	cin >> n;
	for (i=0; i<n; ++i) cin >> p[i] >> l[i] >> r[i];
	for (i=0; i<sz; ++i)
	for (j=i; j<sz; ++j)
	{
		t = ""; res = 0;		
		for (k=i; k<=j; ++k) t += s[k];
		for (k=0; k<n; ++k)
		{
			ans = 0;
			tt = t + "#" + p[k];
			for (u=1; u<tt.size(); ++u)
			{
				jj = d[u-1];
				while (jj > 0 && tt[u] != tt[jj]) jj = d[jj-1]; 
				if (tt[u] == tt[jj]) jj++;
				d[u] = jj;
				if (d[u] == t.size()) ans++;
			}
			if (l[k] <= ans && ans <= r[k]) res++;
		}
		if (res == k && !was[t]) sum++, was[t] = true;
	}
	cout << sum;
	return 0;
}
