#include<stdio.h>
#include<string.h>
#include<set>
#include<string>
using namespace std;

char s[210],ms[20][210];
int L[12],R[12],n;

int cot(int l,int r)
{
    int i,j,ans,m;
    for(i=1;i<=n;i++)
    {
        ans=0;
        m=strlen(ms[i]);
        for(j=0;j<=m-(r-l+1);j++)
            if(strncmp(ms[i]+j,s+l,r-l+1)==0) ans++;
        if(ans<L[i]||ans>R[i]) break;
    }
    return i>n;
}
set <string> C;
int main()
{
    char ch;
    int i,k,m,ans;
    while(scanf("%s",s)!=EOF)
    {
        ans=0;C.clear();
        m=strlen(s);
        scanf("%d",&n);
        for(i=1;i<=n;i++)
            scanf("%s%d%d",ms[i],&L[i],&R[i]);
        for(k=1;k<=m;k++)
        {
            for(i=0;i<=m-k;i++)
            {
                if(cot(i,i+k-1)){
                    ch=s[i+k];s[i+k]=0;
                    C.insert(s+i);
                    s[i+k]=ch;
                }
            }
        }
        printf("%d\n",C.size());
    }
    return 0;
}
