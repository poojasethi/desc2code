#include <cstdio>
#include <cstring>
#include <map>
using namespace std;
#define LL long long
#define OP begin()
#define ED end()
char s[2222];
int n;
char p[22][2222];
int l[22],r[22];
map<LL,int>S,P[22];
map<LL,int>::iterator mt;
void play(char *s,map<LL,int>&S){
	S.clear();
	int len=strlen(s);
	int i,j;
	for(i=0;i<len;i++){
		LL now=0;
		for(j=i;j<len;j++){
			now=now*31+(s[j]-'a'+1);
			S[now]++;
		}
	}
}
int main(){
	int i,j;
	while(~scanf("%s",s)){
		scanf("%d",&n);
		for(i=1;i<=n;i++)scanf("%s%d%d",p[i],&l[i],&r[i]);
		play(s,S);
		for(i=1;i<=n;i++)play(p[i],P[i]);
		int tot=0;
		for(mt=S.OP;mt!=S.ED;++mt){
			LL hh=(*mt).first;
			int flag=1;
			for(i=1;i<=n;i++)if(P[i][hh]<l[i]||P[i][hh]>r[i])flag=0;
			tot+=flag;
		}
		printf("%d\n",tot);
	}
	return 0;
}
