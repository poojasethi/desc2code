#include <algorithm>
#include <iostream>
#include <utility>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <queue>
#include <cmath>
#include <map>
#include <set>
using namespace std;
#define pb push_back
#define mp make_pair
#define fs first
#define sc second
#define abs(a) ((a)<0?-(a):(a))
#define sqr(a) ((a)*(a))
int pf[2400]={0},l[14],r[14];
string t[14];
set<string> stt;
int main()
{
// freopen("*.in","r",stdin);
// freopen("*.out","w",stdout);
 string s,st;getline(cin,s);int ls=s.length();
 int k,i,f,g,h,j,o=0;scanf("%d\n",&k);
 for(i=0;i<k;i++)
 {char c;scanf("%c",&c);
  while(c!=' '){t[i]+=c;scanf("%c",&c);}
  scanf("%d%d\n",&l[i],&r[i]);
 }
 for(i=0;i<ls;i++)
 {st.clear();
  for(f=i;f<ls;f++)
  {st+=s[f];
   if(stt.count(st)==0)
   {stt.insert(st);
    bool log2=1;
    for(g=0;g<k;g++)
    {int kol=0;
     for(h=0;h+f-i<t[g].length();h++)
     {bool log=1;
      for(j=0;j<f-i+1;j++)if(t[g][h+j]!=st[j]){log=0;break;}
      if(log){kol++;}
     }
     if(!(kol>=l[g]&&kol<=r[g])){log2=0;break;}
    }
    if(log2){o++;}
   }
  }
 }
 printf("%d",o);
}