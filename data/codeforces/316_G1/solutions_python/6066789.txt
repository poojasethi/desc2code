#include <cstdio>
#include <cstring>
#include <set>
using namespace std;
#define OP begin()
#define ED end()
char s[2222];
int n;
char p[22][2222];
int l[22],r[22];
multiset<int>S,P[22];
void play(char *s,multiset<int>&S){
	S.clear();
	int len=strlen(s);
	int i,j;
	for(i=0;i<len;i++){
		int now=0;
		for(j=i;j<len;j++){
			now=now*31+(s[j]-'a'+1);
			S.insert(now);
		}
	}
}
int main(){
	int i,j;
	while(~scanf("%s",s)){
		scanf("%d",&n);
		for(i=1;i<=n;i++)scanf("%s%d%d",p[i],&l[i],&r[i]);
		play(s,S);
		for(i=1;i<=n;i++)play(p[i],P[i]);
		int tot=0;
		set<int>SS(S.OP,S.ED);
		set<int>::iterator mt;
		for(mt=SS.OP;mt!=SS.ED;++mt){
			int hh=*mt;
			int flag=1;
			for(i=1;i<=n;i++){
				int k=P[i].count(hh);
				if(k<l[i]||k>r[i])flag=0;
				if(!flag)break;
			}
			tot+=flag;
		}
		printf("%d\n",tot);
	}
	return 0;
}
