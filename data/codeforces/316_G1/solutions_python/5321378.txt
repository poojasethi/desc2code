#include<iostream>
#include<cstdio>
#include<cstring>
#include<algorithm>
#include<set>
#include<string>
using namespace std;
string p[20],s,t;
int l[20],r[20],f[100010],n,i,j,k,q,x,cnt,temp;
set<string> ans;
int main()
{
    cin>>s>>n;
    for(i=1;i<=n;i++) cin>>p[i]>>l[i]>>r[i];
    for(i=0;i<s.size();i++)
        for(j=i;j<s.size();j++)
        {
            t=s.substr(i,j-i+1);
            for(k=1;k<t.size();k++)
            {
                for(x=f[k];x&&t[k]!=t[x];x=f[x]);
                f[k+1]=x+(t[k]==t[x]);
            }
            for(k=1,temp=0;k<=n;k++)
            {
                for(q=x=cnt=0;q<p[k].size();q++)
                {
                    for(;x&&p[k][q]!=t[x];x=f[x]);
                    x+=(p[k][q]==t[x]);
                    if(x==t.size()) cnt++;
                }
                if(cnt<l[k]||cnt>r[k]) {temp=1; break;}
            }
            if (!temp) ans.insert(t);
        }
    cout<<ans.size()<<endl;
    return 0;
}