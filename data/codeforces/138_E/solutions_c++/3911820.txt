#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<vector>
using namespace std;
char c[505];
int a[505],b[505];
vector <int> occ[30];
int vlu[100005];
int lp,sz;
int fnc(int j,int z)
{
    if(z == sz)
        return lp;
    if(z >= 0)
    return occ[c[j]-'a'][z];
    return -1;
}
char str[100005];
int main()
{
    //freopen("in.in","r",stdin);
    int i,k,l,r;
    scanf("%s",str);
    scanf("%d%d%d",&k,&l,&r);
    int zr=0;
    for(i=0;i<k;i++)
    {
        scanf("%c",&c[i]);
        while(c[i] == ' '|| c[i] == '\n')
            scanf("%c",&c[i]);
        scanf("%d%d",&a[i],&b[i]);
        if(a[i] == 0)
        zr++;
    }
    
    
    for(i=0;i<k;i++)
    {
     //printf("%c\n",c[i]);
    }
    int n=strlen(str);
    int j,m,st,en;
    long long rs=0,sm=0;
    for(i=0;i<n;i++)
    {
        lp=i;
        vlu[i]=zr;
        occ[str[i]-'a'].push_back(i);
        if(l <= vlu[i] && vlu[i] <= r)
            sm++;              

             for(j=0;j<k;j++)
             {
                //printf("%c %c\n",c[j],str[i]);
                    if(c[j] != str[i])continue;  
                    sz=occ[c[j]-'a'].size();    
                    st = fnc(j,sz-(b[j]+2));
                    en = fnc(j,sz-(b[j]+1));
                    //printf("%d %d\n",st,en);              
                    for(m=st+1;m<=en;m++)
                    {
                        if(l <= vlu[m] && vlu[m] <= r)
                           sm--;              
                        vlu[m]--;
                        if(l <= vlu[m] && vlu[m] <= r)
                           sm++;
                    }
                    st = fnc(j,sz-(a[j]+1));
                    en = fnc(j,sz-(a[j]));              
                    //printf("%d %d\n",st,en);       
                    for(m=st+1;m<=en;m++)
                    {
                      if(l <= vlu[m] && vlu[m] <= r)
                           sm--; 
                      vlu[m]++;
                      if(l <= vlu[m] && vlu[m] <= r)
                           sm++;
                    }
            }
                //printf("%d\n",sm);
                rs+=sm;
    }
    printf("%lld\n",rs);
}