#include <cstdio>
#include <cstring>
#define MaxK 510
#define MaxLen 100010
int numL[MaxK],numS[MaxK],L[MaxK],S[MaxK],SatNum[MaxLen];
int i,j,K,len,Left,Right,l[MaxK],r[MaxK];
long long Ans,Answer;
char s[MaxLen],c[MaxK];
char Endl[10];
int main()
{
  scanf("%s",s+1);
  scanf("%d%d%d",&K,&Left,&Right);
  for (i=1;i<=K;++i)
  {
    gets(Endl);
    scanf("%c%d%d",&c[i],&l[i],&r[i]);
    L[i]=S[i]=1;
  }
  len=strlen(s+1);
  for (i=1;i<=len;++i)
  {
    SatNum[i]=0;
    if (Left<=SatNum[i]&&SatNum[i]<=Right)
      ++Ans;
    for (j=1;j<=K;++j)
      if (s[i]==c[j]||l[j]==0)
      {
        /*if (l[j]<=1&&1<=r[j]) 
        {
          ++SatNum[i];
          if (SatNum[i]==Right+1) --Ans;
          if (SatNum[i]==Left) ++Ans;
        }*/
        if (s[i]==c[j])
        {
          ++numL[j];
          ++numS[j];
        }
        for (;numL[j]>r[j]&&L[j]<=i;++L[j])
        {
          numL[j]-=(s[L[j]]==c[j]);
          --SatNum[L[j]];
          if (SatNum[L[j]]==Left-1) --Ans;
          if (SatNum[L[j]]==Right) ++Ans;
        }
        for (;numS[j]>=l[j]&&S[j]<=i;++S[j])
        {
          numS[j]-=(s[S[j]]==c[j]);
          ++SatNum[S[j]];
          if (SatNum[S[j]]==Left) ++Ans;
          if (SatNum[S[j]]==Right+1) --Ans;
        }
      }
      /*else if (l[j]<=0&&0<=r[j])
      {
        ++SatNum[i];
        if (SatNum[i]==Left) ++Ans;
        if (SatNum[i]==Right+1) --Ans;
      }*/
    /*for (j=1;j<=i;++j)
      printf("%d ",SatNum[j]);
    printf("\n");*/
    //printf("%d %d\n",L[1],S[1]);
    Answer+=Ans;
  }
  printf("%I64d\n",Answer);
  return 0;
}
