#include <iostream>
#include <sstream>
#include <algorithm>
#include <vector>
#include <queue>
#include <stack>
#include <map>
#include <set>
#include <bitset>
#include <cstdio>
#include <cstring>
#include <cstdlib>
#include <cmath>
#include <climits>
typedef long long LL;
using namespace std;

char s[110000],c[510][10];
int sum[510][110000],a[510],cnt[510],p[510],q[510],l[510],r[510];

void add(int x){
    --cnt[a[x]]; ++cnt[++a[x]];
}   

void sub(int x){
    --cnt[a[x]]; ++cnt[--a[x]];
}

int main(){
    scanf("%s",s+1);
    int N=strlen(s+1),M,L,R;
    scanf("%d%d%d",&M,&L,&R);
    int i,j;
    for (i=1;i<=M;i++)scanf("%s%d%d",c[i],&l[i],&r[i]);
    LL ans=0;
    for (j=1;j<=N;j++){
        ++cnt[0];
        for (i=1;i<=M;i++){
            sum[i][j]=sum[i][j-1]+(s[j]==*c[i]);
            //int &p=::p[i],&q=::q[i];
            if (sum[i][j]>=l[i]){
                if (!p[i] && !q[i]){
                    p[i]=q[i]=1; add(1);
                }
                while (sum[i][j]-sum[i][p[i]-1]>r[i]) sub(p[i]++);
                while (q[i]<j && sum[i][j]-sum[i][q[i]]>=l[i]) add(++q[i]);
            }
        }
        //cout << j << ":" << endl;
        //for (i=1;i<=M;i++) cout << p[i] << ' ' << q[i] << endl;
        //cout << endl;
        //for (i=1;i<=N;i++) cout << a[i] << ' ';
        //cout << endl;
        for (i=L;i<=R;i++) ans+=cnt[i];
    }
    printf("%I64d\n",ans);
}

   	  	  			   			     	