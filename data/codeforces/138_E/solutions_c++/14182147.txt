#include <cstdio>
#include <cstring>
#include <cctype>
const int N=100005,K=505;
long long ans;
int n,k,L,R,now,f[N];
char s[N];
char c[K*2];
int num[K*2],cnt[K*2],loc[K*2],w[K*2];
int main(){
	scanf("%s",s+1);
	n=strlen(s+1);
	scanf("%d%d%d",&k,&L,&R);
	for(int i=0;i<k;i++){
		while(!isalpha(c[i*2]=getchar()));
		c[i*2+1]=c[i*2];
		scanf("%d",&num[i*2]);
		w[i*2]=1;
		scanf("%d",&num[i*2+1]);
		num[i*2+1]++;
		w[i*2+1]=-1;
	}
	k*=2;
	for(int i=1;i<=n;i++){
		f[i]=0;
		if(f[i]>=L&&f[i]<=R) now++;
		for(int j=0;j<k;j++){
			if(c[j]==s[i]) cnt[j]++;
			for(;loc[j]<=i&&cnt[j]>=num[j];loc[j]++){
				if(s[loc[j]]==c[j]) cnt[j]--;
				if(loc[j]){
					if(f[loc[j]]>=L&&f[loc[j]]<=R) now--;
					f[loc[j]]+=w[j];
					if(f[loc[j]]>=L&&f[loc[j]]<=R) now++;
				}
			}
		}
		ans+=now;
	}
	printf("%I64d\n",ans);
}
