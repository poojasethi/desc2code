#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#include<functional>
#include<iostream>
#include<cmath>
#include<cstring>
#include<cctype>
#include<ctime>
using namespace std;
#define For(i,n) for(int i=1;i<=n;i++)
#define Fork(i,k,n) for(int i=k;i<=n;i++)
#define ForD(i,n) for(int i=n;i;i--)
#define Rep(i,n) for(int i=0;i<n;i++)
#define Forp(x) for(int p=pre[x];p;p=next[p])
#define MAXN (100000+10)
#define MAXK (500+10)
#define MAXDy (26)
struct seg
{
    int l,r;
    seg():l(0),r(0){}
}line;
int n,m,k,L,R,l[MAXK],r[MAXK],a[MAXN]={0};
char s[MAXN],c[MAXK];
int su[MAXDy][MAXN]={0},p[MAXDy]={0},tot=0;
long long ans=0;
bool check(int i,int j)
{
    int t=0;
//  if (s[i]==c[j]) t++;//cout<<t<<' '<<s[i]<<' '<<c[j]<<' ';
    if (l[j]<=t&&t<=r[j]) return 1;return 0;
}
void add(int l,int r,int c)
{
//    cout<<':'<<l<<' '<<r<<' '<<c<<endl;
    Fork(i,l,r)
    {
        if (L<=a[i]&&a[i]<=R) tot--;
        a[i]+=c;
        if (L<=a[i]&&a[i]<=R) tot++;
    }
}
int main()
{
    scanf("%s\n",s+1);s[0]=' ';n=strlen(s)-1;
    scanf("%d%d%d\n",&m,&L,&R);
    For(i,m) scanf("%c%d%d\n",&c[i],&l[i],&r[i]);
    For(i,n) su[s[i]-'a'][++su[s[i]-'a'][n+1]]=i;
    For(i,n)
    {
        p[s[i]-(int)'a']++;//cout<<tot<<' ';
        /* un L 原来满足要求 */
        For(j,m) if (!l[j]) a[i]++;
        if (L<=a[i]&&a[i]<=R) tot++;//cout<<tot<<' ';
        /*
        For(j,m) a[i]+=check(i,j);//,cout<<a[i]<<' ';
        if (L<=a[i]&&a[i]<=R) tot++;//cout<<tot<<' ';
        */
        For(j,m)
        {
            if (c[j]^s[i]) continue;
            if (p[s[i]-'a']-1>=r[j]) add(su[s[i]-'a'][p[s[i]-(int)'a']-r[j]-1]+1,su[s[i]-'a'][p[s[i]-(int)'a']-r[j]],-1);
            if (l[j]&&p[s[i]-'a']-1>=l[j]-1) add(su[s[i]-'a'][p[s[i]-'a']-l[j]]+1,su[s[i]-'a'][p[s[i]-'a']-l[j]+1],1);
        }
        ans+=(long long)tot;
        /*
        cout<<tot<<' '<<endl;
        For(j,i) cout<<a[j]<<' ';cout<<endl;*/
    }
    cout<<ans<<endl;
    return 0;
}
