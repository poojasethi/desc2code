#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>

#define ll long long
#define inf 1e9
#define eps 1e-10
#define md
#define N 100010
using namespace std;
char st[N],s[N];
int L[N],R[N],g[26][N],c[30],b[N];
int main()
{
	//freopen("letter.in","r",stdin); freopen("letter.out","w",stdout);
	int K,left,right;
	scanf("%s%d%d%d",st+1,&K,&left,&right);
	int n=strlen(st+1);
	for (int i=1;i<=K;i++) scanf("%s%d%d",s+i,&L[i],&R[i]);
	ll ans=0; int tot=0;
	for (int i=1;i<=n;i++)
	{
		int ch=st[i]-'a';
		g[ch][++c[ch]]=i; int a=c[ch];
		for (int j=1;j<=K;j++)
		  if (s[j]==st[i])
		  {
		  	if (a-L[j]>=0)
		  	{
		  		for (int k=g[ch][a-L[j]]+1;k<=min(g[ch][a-L[j]+1],i-1);k++)
		  		{
		  			if (b[k]==right) tot--; b[k]++; if (b[k]==left) tot++;
		  		}
		  	}
		  	if (a-R[j]>=0)
		  	{
		  		for (int k=(a==R[j]?1:g[ch][a-R[j]-1]+1);k<=min(g[ch][a-R[j]],i-1);k++)
		  		{
		  			if (b[k]==left) tot--; b[k]--; if (b[k]==right) tot++;
		  		}
		  	}
		  }
		for (int j=1;j<=K;j++)
		  if (s[j]==st[i])
		  {
		  	if (L[j]<=1&&1<=R[j]) b[i]++;
		  }
		  else
		  {
		  	if (L[j]<=0&&0<=R[j]) b[i]++;
		  }
		if (left<=b[i]&&b[i]<=right) tot++;
		ans+=tot;
	}
	printf("%I64d\n",ans);
	return 0;
}
		  			

