#include <cstdio>
#include <cstring>
#include <algorithm>
#include <cstdlib>
#include <string>
#include <cmath>
#include <vector>
#define For(i,a,n) for(int i=(a);i<=(n);i++)
#define Forn(i,a,n) for(int i=(a);i>=(n);i--)
using namespace std;
 
char str[100005];
char T[100005][5];int L[100005],R[100005],dR[100005],dL[100005];
int Ql,Qr,n,m,ans,Now[100005];
int sum[35][100005],nowans,a[100005];
long long an;
 
void add(int x,int delta){
    if(Ql<=a[x] && a[x]<=Qr) nowans--;
    a[x]+=delta;
    if(Ql<=a[x] && a[x]<=Qr) nowans++;
}
 
int main(){
    scanf("%s",str+1);
    n=strlen(str+1);
    scanf("%d%d%d",&m,&Ql,&Qr);
    For(i,1,m){
        scanf("%s%d%d",T[i]+1,&L[i],&R[i]);
        dL[i]=1;dR[i]=0;
    }nowans=0;
    For(i,1,n){
        For(j,0,25) sum[j][i]=sum[j][i-1];
        sum[str[i]-'a'][i]++;
    }
    For(x,1,n){
        if(Ql==0) nowans++;
        For(i,1,m){
            int t=T[i][1]-'a';
            while(dR[i]<x && sum[t][x]-sum[t][dR[i]]>=L[i]){
                ++dR[i];add(dR[i],1);
            }
            while(dL[i]<=x && sum[t][x]-sum[t][dL[i]-1]>R[i]){
                add(dL[i],-1);++dL[i];
            }
        }an+=nowans;
    }
    printf("%I64d\n",an);
    return 0;
}