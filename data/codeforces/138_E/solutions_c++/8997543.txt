#include<cstdio>
#include<cstring>
#define C c[j]
#define N 100005
#define M 505
using namespace std;
int f[N][26],l[M],r[M],pl[M],pr[M],appear[N];
char c[N],a[N],opt[5];int res,m,L,R,i,j,n;long long ans;
inline void work(int x,int mi)
{
  res-=(appear[x]>=L&&appear[x]<=R);
  appear[x]+=mi;
  res+=(appear[x]>=L&&appear[x]<=R);
}
int main()
{
  scanf("%s",a+1);n=strlen(a+1);
  for (i=1;i<=n;i++) 
  {
    memcpy(f[i],f[i-1],sizeof(f[i-1]));
    f[i][a[i]-=97]++;
  }
  scanf("%d%d%d",&m,&L,&R);
  for (i=1;i<=m;i++) 
  {
    scanf("%s%d%d",opt,&l[i],&r[i]);
    c[i]=opt[0]-97;
    pl[i]=0;//最大值r[i]的边界 -->第pl[i]位出现的正好是r[i],左侧无解 
    pr[i]=0;//最小值l[i]的边界 -->第pr[i]位出现的正好是l[i],右侧无解 
  }
  for (i=1;i<=n;i++)
  {
    res+=(!L);
    for (j=1;j<=m;j++)
    {
      while (pr[j]+1<=i&&f[i][C]-f[pr[j]][C]>=l[j]) work(++pr[j],1);
      while (pl[j]+1<=i&&f[i][C]-f[pl[j]][C]>r[j]) work(++pl[j],-1);
    }
    ans+=res;
  }
  printf("%I64d",ans);
  return 0;
}
