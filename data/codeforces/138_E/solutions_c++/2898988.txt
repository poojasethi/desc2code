#include<iostream>
#include<cstdio>
#include<cstring>
using namespace std;

const int maxn = 100010, maxk = 510;
char dat[maxn];
int n, k, l, r;
char cons[maxk];
int low[maxk], hi[maxk];

void init()
{
	scanf("%s", dat);
	n = strlen(dat);
	scanf("%d%d%d", &k, &l, &r);
	static char str[10];
	for (int i = 0; i < k; i++)
	{
		scanf("%s%d%d", str, &low[i], &hi[i]);
		cons[i] = str[0];
	}
}

void work()
{
	static int cnt[maxn], left[maxk], right[maxk];
	int nowans = 0;
	
	for (int i = 0; i < k; i++)
	{
		int chcnt = 0;
		for (left[i] = -1; left[i] < n && chcnt < low[i]; left[i]++)
			if (dat[left[i] + 1] == cons[i]) chcnt++;
		for (right[i] = left[i]; right[i] < n && chcnt <= hi[i]; right[i]++)
			if (dat[right[i] + 1] == cons[i]) chcnt++;
		left[i] = max(left[i], 0);
		
		for (int j = left[i]; j < right[i]; j++) cnt[j]++;
	}
	for (int i = 0; i < n; i++)
		if (cnt[i] >= l && cnt[i] <= r) nowans++;
		
		
	long long ans = 0;
	for (int i = 0; i < n; i++)
	{
		ans += nowans;
		
		if (cnt[i] >= l && cnt[i] <= r) nowans--;		
		for (int j = 0; j < k; j++)
		{
			if (dat[i] == cons[j])
			{
				if (right[j] < n)
				{
					if (right[j] > i)
						if (cnt[right[j]] == r) nowans--;
						else if (cnt[right[j]] + 1 == l) nowans++;
					cnt[right[j]++]++;
				}
				while (right[j] < n && dat[right[j]] != cons[j])
				{
					if (cnt[right[j]] == r) nowans--;
					else if (cnt[right[j]] + 1 == l) nowans++;
					cnt[right[j]++]++;
				}
				if (low[j])
				{
					if (left[j] < n)
					{
						if (left[j] > i)
							if (cnt[left[j]] == l) nowans--;
							else if (cnt[left[j]] - 1 == r) nowans++;
						cnt[left[j]++]--;
					}
					while (left[j] < n && dat[left[j]] != cons[j])
					{
						if (cnt[left[j]] == l) nowans--;
						else if (cnt[left[j]] - 1 == r) nowans++;
						cnt[left[j]++]--;
					}
				}
			}
			left[j] = max(left[j], i + 1);
			right[j] = max(right[j], i + 1);
		}	
	}
	
	printf("%I64d\n", ans);
}

int main()
{
	init();
	work();
	return 0;
}
