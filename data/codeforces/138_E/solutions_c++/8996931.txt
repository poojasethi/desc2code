#include <cstdio>
#include <cstring>

#define rep(i,j,k) for (int i=j;i<=k;++i)

using namespace std;

typedef long long LL;

const int K=500,N=(int)1e5;

LL ans,ret;
char t[N+10];
int k,L,R,n,c[K+10],l[K+10],r[K+10],be[K+10],en[K+10],s[N+10],ok[N+10],cnt[26][N+10];

inline void dec(int x){
	ret-=L<=ok[x]&&ok[x]<=R;
	ok[x]--;
	ret+=L<=ok[x]&&ok[x]<=R;
}

inline void inc(int x){
	ret-=L<=ok[x]&&ok[x]<=R;
	ok[x]++;
	ret+=L<=ok[x]&&ok[x]<=R;
}

int main(){
	scanf("%s%d%d%d",t+1,&k,&L,&R);
	n=strlen(t+1);
	rep(i,1,n) cnt[s[i]=t[i]-'a'][i]=1;
	rep(i,0,25) rep(j,2,n) cnt[i][j]+=cnt[i][j-1];
	rep(i,1,k) scanf("%s%d%d",t,&l[i],&r[i]),c[i]=t[0]-'a',be[i]=en[i]=1;
	rep(i,1,n){
		if (!L) ret++;
		rep(j,1,k){
			while (be[j]<=i && cnt[c[j]][i]-cnt[c[j]][be[j]-1]>r[j]) dec(be[j]++);
			while (en[j]<=i && cnt[c[j]][i]-cnt[c[j]][en[j]-1]>=l[j]) inc(en[j]++);
		}
		ans+=ret;
	}
	printf("%I64d\n",ans);
	return 0;
}