#include<cstdio>
#include<cstring>
#define For(i,n) for(int i=1;i<=n;i++)
#define FOR(i,a,b) for(int i=a;i<=b;i++)
#define N 100010
typedef long long ll;
int k,L,R,tot,n,x,a[N],c[510],l[510],r[510],p[26][N],e[26];
char s[N],ch[2];
ll ans;
void Modify(int l,int r,int d)
{
	FOR(i,l,r)
	{
		if (a[i]>=L && a[i]<=R) tot--;
		a[i]+=d;
		if (a[i]>=L && a[i]<=R) tot++;
	}
}
int main()
{
	scanf("%s",s+1);
	scanf("%d%d%d\n",&k,&L,&R);
	For(i,k)
	{
		scanf("%s%d%d",&ch,&l[i],&r[i]);
		c[i]=ch[0]-'a';
	}
	n=strlen(s+1);
	For(i,n) 
	{
		if (!L) tot++;
		x=s[i]-'a';
		p[x][++e[x]]=i;
		For(j,k)
		{
			if (c[j]==x)
			{
				if (e[x]>=l[j] && l[j]) 
					Modify(p[x][e[x]-l[j]]+1,  p[x][e[x]-l[j]+1],1);
				if (e[x]>r[j])  
					Modify(p[x][e[x]-r[j]-1]+1,p[x][e[x]-r[j]],-1);
			}
			if (!l[j]) Modify(i,i,1);
		}
		ans+=tot;
	}
	printf("%I64d\n",ans);
	return 0;
}
