#include <bits/stdc++.h>

#define mp make_pair
#define st first
#define nd second
#define pb push_back

using namespace std;

typedef long long ll;
typedef pair< ll,ll > pll;
typedef pair< int,int > pii;

const int inf = 1000000000, N = 100000;

int k, n, m, a[N+5], cmd[N+5], x[N+5], y[N+5], mxAs[N+5];
vector<pii> add[N+5];
vector< pair<double, int> > upd;

int main()
{
	scanf("%d %d %d", &n, &m, &k);

	for (int i = 1; i <= n; i++) {
		scanf("%d", a+i);
	}

	for (int i = 1; i <= m; i++) {
		scanf("%d %d %d", cmd+i, x+i, y+i);
		
		if (cmd[i] == 1 && y[mxAs[x[i]]] < y[i])
			mxAs[x[i]] = i;
		else if (cmd[i] == 2)
			add[x[i]].pb( mp(y[i], i) );
		else if (cmd[i] == 3)
			upd.pb( mp(y[i], i) );
	}

	for (int i = 1; i <= n; i++) {
		if (y[mxAs[i]] > a[i])
			add[i].pb( mp(y[mxAs[i]] - a[i], mxAs[i]) );

		sort(add[i].begin(), add[i].end());

		double sum = a[i];

		for (int j = add[i].size()-1; j >= 0; j--) {
			upd.pb( mp((sum+add[i][j].st) / sum, add[i][j].nd) );	
			sum += add[i][j].st;
		}
	}
	
	sort(upd.rbegin(), upd.rend());
	
	cout << min(k, (int) upd.size()) << endl;
	
	vector<pii> ans;

	for (int i = 0; i < min(k, (int) upd.size()); i++) {
		ans.pb( mp(cmd[upd[i].nd], upd[i].nd) );
	}
	
	sort(ans.begin(), ans.end());

	for (int i = 0; i < ans.size(); i++)
		cout << ans[i].nd << " ";
	cout << endl;


	return 0;
}
