#include<bits/stdc++.h>

using namespace std;

#define st first
#define nd second
#define mp make_pair
#define pb push_back
#define sol (root+root)
#define sag (root+root+1)
#define orta ((bas+son)/2)
#define ll long long
#define pii pair<int,int>
#define int ll

const int N=1e5+5;
const int mod=1e9+7;
const int inf=1e9+7;

int n,k,m,i,x,y,z,add,cnt,ind,j;
int H[N];
int A[N];

vector<pair<pii,int> > V[N];
vector<pair<pair<pair<double,int>,int>,int> > all;

vector<int> ans1,ans2,ans3;

main(){

	scanf("%lld %lld %lld",&k,&n,&m);

	for(i=1 ; i<=k ; i++)
		scanf("%lld",A+i);

	for(i=1 ; i<=n ; i++){
		scanf("%lld %lld %lld",&x,&y,&z);
		if(x==1 or x==2){
			if(x==1){
				if(z>A[y])
					add=z-A[y];
				else continue;
			}
			else add=z;
			V[y].pb(mp(mp(add,x),i));
		}
		else all.pb(mp(mp(mp((double)z,x),i),y));
	}

	for(i=1 ; i<=k ; i++){
		sort(V[i].rbegin(),V[i].rend());
		for(j=0 ; j<V[i].size() ; j++){
			add=V[i][j].st.st;
			x=V[i][j].st.nd;
			ind=V[i][j].nd;
			all.pb(mp(mp(mp(((double)A[i]+add)/A[i],x),ind),i));
			A[i]+=add;
		}
	}

	sort(all.rbegin(),all.rend());

	for(i=0 ; i<(int)all.size() ; i++){
		if(all[i].st.st.nd==1 and H[all[i].nd])
			continue;
		if(cnt==m)
			break;
		cnt++;
		if(all[i].st.st.nd==1){
			H[all[i].nd]=1;
			ans1.pb(all[i].st.nd);
		}
		else if(all[i].st.st.nd==2)
			ans2.pb(all[i].st.nd);
		else
			ans3.pb(all[i].st.nd);
	}

	printf("%lld\n",(int)(ans1.size()+ans2.size()+ans3.size()));

	for(i=0 ; i<ans1.size() ; i++)
		printf("%lld ",ans1[i]);
	for(i=0 ; i<ans2.size() ; i++)
		printf("%lld ",ans2[i]);
	for(i=0 ; i<ans3.size() ; i++)
		printf("%lld ",ans3[i]);
}
