#include<iostream>
#include<cstdio>
#include<algorithm>
#include<vector>
using namespace std;
typedef pair<int,int> PII;
typedef pair<double,int> PDI;
typedef long long LL;
const int L_N=1e5+10;
PII ass[L_N];
vector<PII> sum[L_N];
vector<PDI> all;
int K,N,M,a[L_N],type[L_N];
int main(){
   // freopen("in.txt","r",stdin);
    scanf("%d %d %d",&K,&N,&M);
    for(int i=1;i<=K;i++) scanf("%d",a+i);
    for(int i=1;i<=N;i++){
        int t,w,b; scanf("%d %d %d",&t,&w,&b);
        type[i]=t;
        if(t==1){
            if(b>ass[w].first) ass[w]=PII(b,i);
        }
        if(t==2) sum[w].push_back(PII(b,i));
        if(t==3) all.push_back(PDI(b,i));
    }
    for(int i=1;i<=K;i++) if(ass[i].first>a[i]){
        ass[i].first-=a[i];
        sum[i].push_back(ass[i]);
    }
    for(int i=1;i<=K;i++){
        sort(sum[i].rbegin(),sum[i].rend());
        LL tmp=a[i];
        for(int j=0;j<sum[i].size();j++){
            double s=sum[i][j].first;
            all.push_back(PDI((tmp+s)/tmp,sum[i][j].second));
            tmp+=sum[i][j].first;
        }
    }
    
    int m=min((int)all.size(),M);
    sort(all.rbegin(),all.rend());
    printf("%d\n",m);
    for(int i=0;i<m;i++) if(type[all[i].second]==1) printf("%d ",all[i].second);
    for(int i=0;i<m;i++) if(type[all[i].second]==2) printf("%d ",all[i].second);
    for(int i=0;i<m;i++) if(type[all[i].second]==3) printf("%d ",all[i].second);
}