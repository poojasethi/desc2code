#include <bits/stdc++.h>
#define rep(i,a,b) for (int i=a;i<=b;i++)
#define drep(i,a,b) for (int i=a;i>=b;i--)
#define D double
#define LL long long
#define pb push_back
#define LD long double
#define mp make_pair
using namespace std;
const int N=120000;
vector<pair<LL,int> > add[N];
vector<pair<pair<LL,LL>,int> > all;
pair<LL,int> ass[N];
LL a[N];
int n,m,p,T[N];
inline int cmp(const pair<pair<LL,LL>,int> &a,const pair<pair<LL,LL>,int> &b)
{
	return (LD)a.first.first*(LD)b.first.second>(LD)a.first.second*(LD)b.first.first;
}
int main()
{
	//freopen("D.in","r",stdin);
	scanf("%d%d%d",&n,&m,&p);int ty,x;LL y;
	rep(i,1,n) scanf("%lld",&a[i]);
	rep(i,1,m)
	{
		scanf("%d%d%lld",&T[i],&x,&y);
		if (T[i]==1) ass[x]=max(ass[x],mp(y,i));
		else if (T[i]==2) add[x].pb(mp(y,i));
		else all.pb(mp(mp(y,1),i));
	}
	rep(i,1,n) if (ass[i].first>a[i]) add[i].pb(mp(ass[i].first-a[i],ass[i].second));
	rep(i,1,n)
	{
		sort(add[i].begin(),add[i].end(),greater<pair<LL,int> >());
		LL cur=a[i];
		for (int j=0;j<add[i].size();j++) all.pb(mp(mp(cur+add[i][j].first,cur),add[i][j].second)),cur+=add[i][j].first;
	}
	p=min(p,(int)all.size());
	sort(all.begin(),all.end(),cmp);
	printf("%d\n",p);
	rep(i,0,p-1) if (T[all[i].second]==1) printf("%d ",all[i].second);
	rep(i,0,p-1) if (T[all[i].second]==2) printf("%d ",all[i].second);
	rep(i,0,p-1) if (T[all[i].second]==3) printf("%d ",all[i].second);
	puts("");
}
