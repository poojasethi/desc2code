#include<bits/stdc++.h>
#define st first
#define nd second
#define mp make_pair
#define pb push_back
#define endl '\n'
#define endll puts("")
#define mod 1000000007
#define mp3(x,y,z) mp(x,mp(y,z))
#define pii pair< int , int > 
#define orta ((bas+son)/2)
#define sol (root+root)
#define sag (root+root+1)
using namespace std;
typedef long long ll;
const int N = 1e5+3;
int n,a,b,m,i,j,k,l,s,t,d,u,ii,jj,x,y,z,der[N],h[N],hh[N],ata[N][20];
vector<int>V[N];
vector<int> vs[N],vf[N];
void dfs(int x)
{
	if(!d)
		h[x]=++t;
	else
	{
		der[x]=s;vs[s].pb(h[x]);vf[s].pb(hh[x]);
	}
	for(int i=0;i<V[x].size();i++)
	{
		s++;
		dfs(V[x][i]);
		s--;
	}
	if(!d)
		hh[x]=t;
}
int main()
{
	cin>>n;
	endll;
	for(i=1;i<=n;i++)
	{
		scanf("%d",&ata[i][0]);
		V[ata[i][0]].pb(i);
	}
	for(j=1;j<20;j++)
		for(i=1;i<=n;i++)
			ata[i][j]=ata[ata[i][j-1]][j-1];

	dfs(0);d=1;dfs(0);
	cin>>m;
	while(m--)
	{
		scanf("%d%d",&x,&y);
		a=x;b=y;
		for(i=19;i>=0;i--)
			if((1<<i)&b)
				a=ata[a][i];

		if(!a)
		{printf("0 ");continue;}
		t=lower_bound(vs[der[x]].begin(),vs[der[x]].end(),h[a])-vs[der[x]].begin();
		l=lower_bound(vf[der[x]].begin(),vf[der[x]].end(),hh[a]+1)-vf[der[x]].begin();
		printf("%d ",l-t-1);
	}
}
