#include<cstdio>
#include<vector>
#include<algorithm>
using namespace std;
const int N=1e5+1;
int parent[20][N];
vector<int> e[N],c[N];
int f[17][N],d[N],l[N],r[N],t;
void go(int p,int lv){
	d[p]=lv;
	c[lv].push_back(t);
	l[p]=t++;
	for(int i=0;i<e[p].size();i++) go(e[p][i],lv+1);
	r[p]=t;
}
int main(){
	int n,m,v,p;
	scanf("%d",&n);
	for(int i=1;i<=n;i++) scanf("%d",f[0]+i);
	for(int i=1;i<=n;i++) e[f[0][i]].push_back(i);
	go(0,0);
	for(int i=1;i<17;i++)
		for(int j=1;j<=n;j++)
			f[i][j]=f[i-1][f[i-1][j]];
	scanf("%d",&m);
	for(int i=0;i<m;i++){
		scanf("%d%d",&v,&p);
		vector<int> &u=c[d[v]];
		for(int j=16;j>=0;j--) if((p>>j)&1) v=f[j][v];
		printf("%d%c",v==0?0:lower_bound(u.begin(),u.end(),r[v])-lower_bound(u.begin(),u.end(),l[v])-1,
		i<m-1?' ':'\n');
	}
	return 0;
}
