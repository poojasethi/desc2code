#include <cstdio>
#include <cstring>
#define maxn 1000 + 10

int n,m,k;
bool key[2][maxn][maxn] = {0};
int a[maxn] = {0},b[maxn] = {0};
int fa[2][maxn] = {0};

int whe[maxn] = {0};
char name[maxn][20] = {'\0'},str[20] = {'\0'};

int getfa( bool t, int i ) { return( fa[t][i] == i ? i : fa[t][i] = getfa(t,fa[t][i]) ); }

void work( bool t, int i )
{
	int j,k,p;
	for( j = 1 ; j <= m ; ++j )
		if( key[t][i][j] && ( getfa(t,a[j]) == i || getfa(t,b[j]) == i ) )
			{
				if( getfa(t,a[j]) == i )
					k = getfa(t,b[j]);
				else k = getfa(t,a[j]);
				if( i != k )
					{
						fa[t][k] = i;
						for( p = 1 ; p <= m ; ++p )
							key[t][i][p] |= key[t][k][p];
						j = 0;
					}
			}
}

int main()
{
	int i,j,c,p,s,t;
	bool flag = 1;

	scanf("%d%d%d",&n,&m,&k);
	for( i = 1 ; i <= m ; ++i )
		scanf("%d%d",&a[i],&b[i]);
	for( i = 1 ; i <= k ; ++i )
		{
			scanf("%s%d",name[i],&whe[i]);
			scanf("%d",&p);
			for( j = 1 ; j <= p ; ++j )
				{
					scanf("%d",&c);
					key[0][whe[i]][c] |= 1;
				}
		}
	for( i = 1 ; i <= n ; ++i )
		fa[0][i] = i;
	for( i = 1 ; i <= n ; ++i )
		work(0,getfa(0,i));

	for( i = 1 ; i <= k ; ++i )
		{
			scanf("%s%d",str,&t);
			for( s = 1 ; s <= k ; ++s )
				if( !strcmp(name[s],str) )
					break;

			if( getfa(0,t) != getfa(0,whe[s]) )
				flag = 0;
			scanf("%d",&p);
			for( j = 1 ; j <= p ; ++j )
				{
					scanf("%d",&c);
					if( !key[0][getfa(0,whe[s])][c] )
						flag = 0;
					key[1][t][c] |= 1;
				}
		}
	for( i = 1 ; i <= n ; ++i )
		fa[1][i] = i;
	for( i = 1 ; i <= n ; ++i )
		work(1,getfa(1,i));
	for( i = 1 ; i <= n ; ++i )
		if( getfa(0,i) == i )
			{
				p = getfa(1,i);
				for( j = 1 ; j <= m ; ++j )
					if( key[0][i][j] != key[1][p][j] )
						flag = 0;
			}

	if( flag )
		printf("YES\n");
	else printf("NO\n");

	return(0);
}
