#include<cstdio>
#include<algorithm>
#include<vector>
#include<string>
#include<map>
#include<iostream>
#define pii pair<int,int>
#define A first
#define B second
using namespace std;
int n,m,k,h[1001],no[1001],tmp1,tmp2,tag[1001],sv[1001],tmp3,svh[1001],tag2[1001];
pii d[1001];
map <string,int> M;
string s;
int H(int x){
    if(h[x] != x) h[x] = H(h[x]);
    return h[x];
}
int main(){
    scanf("%d%d%d",&n,&m,&k);
    for(int i=1;i<=n;i++) h[i] = i;
    for(int i=1;i<=m;i++){
        scanf("%d%d",&d[i].A,&d[i].B);
    }
    for(int i=1;i<=k;i++){
        cin>>s; scanf("%d%d",&no[i],&tmp1); 
        M[s] = no[i];
        for(int j=0;j<tmp1;j++){
            scanf("%d",&tmp2); sv[tmp2] = no[i];
        }
    }
    tmp1 = 1;
    while(tmp1){
        tmp1 = 0;
        for(int i=1;i<=m;i++){
            if(tag[i] != 1 && (H(d[i].A) == H(sv[i]) || H(d[i].B) == H(sv[i]))){
                    h[H(d[i].A)] = H(d[i].B); 
                    tmp1 = 1; tag[i] = 1;
            }
        }
    }
    int chk = 1;
    for(int i=1;i<=k;i++){
        int id;
        cin>>s; scanf("%d%d",&tmp1,&tmp2);
        id = M[s];
        if(H(id) != H(tmp1)) chk = 0;
        for(int i=0;i<tmp2;i++){
            scanf("%d",&tmp3);
            if(H(id) != H(sv[tmp3])) chk = 0;
            sv[tmp3] = tmp1;
        }
    }
    for(int i=1;i<=n;i++) h[i] = i;
    tmp1 = 1;
    while(tmp1){
        tmp1 = 0;
        for(int i=1;i<=m;i++){
            if(tag2[i] != 1 && (H(d[i].A) == H(sv[i]) || H(d[i].B) == H(sv[i]))){
                    h[H(d[i].A)] = H(d[i].B); tmp1 = 1;
                    tag2[i] = 1;
            }
        }
    }
    for(int i=1;i<=n;i++) 
        if(tag[i] != tag2[i]) chk = 0;
    printf(chk == 0 ? "NO" : "YES");
    return 0;
}