#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
#include<algorithm>
#include<string>
#define st first
#define po second
using namespace std;
const int MAXN=5005;
pair<string,int> peo[MAXN],peo2[MAXN];
int a[MAXN],b[MAXN],f[MAXN],x[MAXN],y[MAXN],z[MAXN];
int n,m,t;
int getfa(int x){return f[x]==x?x:f[x]=getfa(f[x]);}
void work(int *a)
{
    for(int i=1;i<=n;i++)f[i]=i;
    bool flag=true;
    while(flag)
    {
        flag=false;
        for(int i=1;i<=m;i++)
            if(!a[i]&&(getfa(x[i])==getfa(z[i])||getfa(y[i])==getfa(z[i])))
                f[getfa(x[i])]=getfa(y[i]),a[i]=flag=true;
    }
}
int main()
{
    scanf("%d%d%d",&n,&m,&t);
    for(int i=1;i<=m;i++)
        scanf("%d%d",&x[i],&y[i]);
    for(int i=1;i<=t;i++)
    {
        int tot,q;
        cin>>peo[i].st;
        scanf("%d%d",&peo[i].po,&tot);
        for(int j=1;j<=tot;j++)
            scanf("%d",&q),z[q]=peo[i].po;
    }
    sort(peo+1,peo+1+t);
    work(a);
    for(int i=1;i<=t;i++)
    {
        int tot,q;
        cin>>peo2[i].st;
        scanf("%d%d",&peo2[i].po,&tot);
        for(int j=1;j<=tot;j++)
        {
            scanf("%d",&q);
            if(getfa(z[q])!=getfa(peo2[i].po))
            {
                printf("NO\n");
                return 0;
            }
            z[q]=peo2[i].po;
        }
    }
    sort(peo2+1,peo2+1+t);
    for(int i=1;i<=t;i++)
        if(getfa(peo[i].po)!=getfa(peo2[i].po))
        {
            printf("NO\n");
            return 0;
        }
    work(b);
    for(int i=1;i<=n;i++)
        if(a[i]!=b[i])
        {
            printf("NO\n");
            return 0;
        }
    printf("YES\n");
    return 0;
}