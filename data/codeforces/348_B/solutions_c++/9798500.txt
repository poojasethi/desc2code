#include <iostream>
#include <stdio.h>
#include <stdlib.h>
#include <vector>
using namespace std;
#define MAXN 100010
typedef long long ll;
int n;
int num[MAXN];
vector<int> G[MAXN];
ll x,sum=0,lcm=1;
ll gcd(ll a,ll b)
{
    return b==0 ? a : gcd(b, a%b);
}

void dfs(int cur=1, ll div=1LL, int fa=-1)
{
    if(div>x)
    {
        cout<<sum;
        exit(0);
        return;
    }
    if(num[cur] || G[cur].size()<=1 && cur!=1) // ��Ҷ�ӽڵ�
    {
        x=min(x, num[cur]*div);
		lcm=div*lcm/gcd(lcm,div);
        return;
    }
    for(int i=0; i<G[cur].size(); i++)
    {
        if(G[cur][i]!=fa)
            dfs(G[cur][i], div*(ll)(G[cur].size()-1*(cur!=1)),cur);
    }
}
int main()
{
    //freopen("in.txt","r", stdin);

    cin>>n;
    for(int i=1; i<=n; i++)
    {
        scanf("%d", &num[i]);
        sum+=(ll)num[i];
    }
    x=sum;
    for(int i=1; i<=n-1; i++)
    {
        int u,v;
        scanf("%d %d", &u, &v);
        G[u].push_back(v);
        G[v].push_back(u);
    }
    dfs();
	cout<<sum-x+x%lcm;

    return 0;
}
