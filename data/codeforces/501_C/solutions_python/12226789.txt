from itertools import *

n = int(raw_input())
s      = [0]*n
deg    = [0]*n
parent = [0]*n
for i in xrange(n):
  deg[i],s[i] = map(int, raw_input().split())

edges = []
leaves = [i for i,x in enumerate(deg) if x==1]

while leaves:
  v = leaves.pop()
  if deg[v] == 1:
    parent[v] = s[v]
    s[parent[v]] ^= v
    deg[parent[v]] -= 1
    deg[v] -= 1
    if deg[parent[v]] == 1:
      leaves.append(parent[v])
    edges.append((v,parent[v]))

print len(edges)
for a,b in edges:
  print a,b