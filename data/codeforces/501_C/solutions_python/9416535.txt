n,d,s,q,su=input(),[],[],[],0
for i in range(0,n):
    a,b=map(int,raw_input().split(' '))
    d.append(a)
    s.append(b)
    su+=a
    if(a==1):
        q.append(i)
print su/2
lenth=len(q)
ll=0
while ll<lenth:
    t=q[ll]
    if(d[t]==1):
        print t,s[t]
        s[s[t]]^=t
        d[s[t]]-=1
        if(d[s[t]]==1):
            q.append(s[t])
            lenth+=1
    ll+=1
