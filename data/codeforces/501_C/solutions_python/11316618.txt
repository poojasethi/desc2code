n,d,s,l,sm = input(),[],[],[],0
for i in range(n):
    a,b=map(int,raw_input().split())
    d.append(a)
    s.append(b)
    if a==1:l.append(i)
    sm+=a
print sm/2
while l:
    v=l.pop()
    if d[v]==1:
        print v,s[v]
        s[s[v]]^=v;d[s[v]]-=1
        if d[s[v]]==1:l.append(s[v])