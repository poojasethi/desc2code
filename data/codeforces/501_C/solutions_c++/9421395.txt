#include <bits/stdc++.h>


#define Max 65555
#define ff first
#define ss second

using namespace std;

int d[Max],s[Max];
int main(){
	int n=0;
	
	queue < int > v;
	int sum=0;
	cin >> n;
	for( int i=0;i<n;i++){
		cin >> d[i] >> s[i];	
		sum+=d[i];
		if( d[i] == 1 )
			v.push(i);	
	}
	cout << sum/2 << endl;
	
	while( !v.empty() ){
		int a=v.front();
		v.pop();
		int b=s[a];
		if( d[a] == 0 )
			continue;
		cout << a << " " << b << endl;;
		d[b]--;
		if( d[b] == 1 )
			v.push(b);
		s[b] ^= a;
	}
	return 0;
}
