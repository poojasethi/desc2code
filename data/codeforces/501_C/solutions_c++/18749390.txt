#include<bits/stdc++.h>
#define newl '\n'
using namespace std;
const int N=(1<<16)+8;
int a[N][2],n;long long sm;
void f(int x)
{
	if(a[x][0]!=1) return ;
	int b=a[x][1];
	cout<<x<<" "<<b<<newl;
	a[x][0]--;a[x][1]^=b;
	a[b][0]--;a[b][1]^=x;
	f(b);
}
int main()
{
	ios::sync_with_stdio(false);cin.tie(0);
	int i;
	cin>>n;
	for(i=0;i<n;i++)
	cin>>a[i][0]>>a[i][1],sm+=a[i][0];
    cout<<sm/2<<newl;
    for(i=0;i<n;i++)
    	f(i);
	return 0;
}