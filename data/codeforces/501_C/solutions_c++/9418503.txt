#include<bits/stdc++.h>
using namespace std;
#define lim 100014
int main()
{
  queue<int> q;
  int vis[lim]={0},n,degree[100000],s[lim];
  cin>>n;
  int su=0;
  for(int i=0;i<n;i++)
  {
    cin>>degree[i]>>s[i];
	su+=degree[i];
	if(degree[i]==1)
	q.push(i);
  }
  cout<<su/2<<endl;
  while(!q.empty())
  {
    int s1=q.front();
	q.pop();
	if(degree[s1]!=1)continue;
	if(vis[s1]==1)continue;
	vis[s1]=1;
	cout<<s1<<" "<<s[s1]<<endl;
	degree[s1]--;
	degree[s[s1]]--;
	
	s[s[s1]]^=s1;
	if(degree[s[s1]]==1)
	q.push(s[s1]);
  }
}