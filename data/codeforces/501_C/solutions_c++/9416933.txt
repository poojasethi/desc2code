#include<cstdio>
#include<iostream>
using namespace std;
int xo[1<<17],d[1<<17],q[1<<17];
void link(int a,int b){
   cout<<a<<" "<<b<<endl;
   d[a]--,d[b]--;
   xo[a]=0;
   xo[b]^=a;
}
int main(){
	int n,sum=0,front=1,rear=0;
	scanf("%d",&n);
	for(int i=0;i<n;i++){
		scanf("%d%d",&d[i],&xo[i]);
		if(d[i]==1) q[++rear]=i;
		sum+=d[i];
	}
	//cout<<"sasi"<<endl;
	printf("%d\n",sum/2);
	while(front<=rear){
		int a=q[front++];
		int b=xo[a];
		if(d[a]==1){
		link(a,b);
		if(d[b]==1){
			q[++rear]=b;
		}
	}
	}
}
