#include <bits/stdc++.h>
using namespace std;
int n;
queue<int> h;
int a[66000];
int k[66000];
int main()
{ ios_base::sync_with_stdio(false);
	cin >> n;  int kk=0;
	for(int x=0;x<n;++x)
		{ cin >> a[x] >> k[x]; kk+=a[x]; if(a[x]==1) h.push(x); }
			cout << kk/2 << endl;
	while(h.size())
	{
		int u=h.front(); h.pop();  if(a[u]){ cout << u << " " << k[u] << endl; a[u]--;
		if(--a[k[u]]==1)  { k[k[u]]^=u; h.push(k[u]); } else k[k[u]]^=u; }
	}
}