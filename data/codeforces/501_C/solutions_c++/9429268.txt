#include<bits/stdc++.h>
#define lli long long int
using namespace std;
int main()
{
lli n;
cin>>n;
queue<lli>q;
vector<lli>deg,sxr;
lli ed=0;
for(lli i=0;i<n;i++)
{
lli dg,sx;
cin>>dg>>sx;
ed+=dg;
deg.push_back(dg);
sxr.push_back(sx);
if(dg==1)q.push(i);
}
cout<<ed/2<<endl;
while(!q.empty())
{
lli tn=q.front();
if(deg[tn]==1)
{
cout<<tn<<' '<<sxr[tn]<<endl;
deg[sxr[tn]]--;
sxr[sxr[tn]]^=tn;
if(deg[sxr[tn]]==1)q.push(sxr[tn]);
}
q.pop();
}
return 0;
}
