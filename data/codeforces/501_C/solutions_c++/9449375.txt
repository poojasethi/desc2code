//就是从叶子开始按类似拓扑排序的顺序一条条边剥下来
#include<cstdio>

int n, l, r, tot;
int s[111111], v[111111], q[111111];

int main() {
	scanf("%d", &n);
	l=r=0;
	for(int i=0;i<n;i++) {
		scanf("%d%d", &s[i], &v[i]);
		if(s[i]==1)
			q[r++] = i;
		tot += s[i];
	}
	printf("%d\n", tot/2);
	while(l<r) {
		int cur = q[l++];
		if (!s[cur]) continue;
		int nxt = v[cur];
		printf("%d %d\n", cur, nxt);
		s[nxt]--;
		v[nxt] ^= cur;
		if(s[nxt]==1)
			q[r++] = nxt;
	}

	return 0;
}