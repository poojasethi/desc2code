#include <iostream>
#define MAXN 100000
using namespace std;
int n;
int de[MAXN], s[MAXN];
void com(int u) {
	if (de[u] != 1) return;
	int v = s[u];
	cout << u << " " << v << endl;
	de[u]--;
	de[v]--;
	s[u] ^= v;
	s[v] ^= u;
	com(v);
}
int main() {
	cin >> n;
	int sum_d = 0;
	for (int i = 0; i < n; i++) {
		cin >> de[i] >> s[i];
		sum_d += de[i];
	}
	sum_d /= 2;
	cout << sum_d  << endl;
	for (int i = 0; i < n; i++) {
		com(i);
	}
	return 0;
}