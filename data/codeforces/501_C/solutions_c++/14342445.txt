#include<cstdio>
using namespace std;
int n,i,a[100010],b[100010],q[100010],l,r,tot;
//copied....
int main()
{
	scanf("%d",&n);
	for(i=0;i<n;i++)
	{
		scanf("%d%d",&a[i],&b[i]);
		if(a[i]==1)q[++r]=i;tot+=a[i];
	}printf("%d\n",tot/2);
	for(l=1;l<=r;l++)
	if(a[q[l]]==1)
	{
		printf("%d %d\n",q[l],b[q[l]]);
		a[b[q[l]]]--;b[b[q[l]]]^=q[l];
		if(a[b[q[l]]]==1)q[++r]=b[q[l]];
	}
}
