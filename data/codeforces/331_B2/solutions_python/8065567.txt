#include <stdio.h>

#define M 300300

int n, a[M], x, y, ss[M], inv[M];

void add(int k, int r){
	while(k<=n){
		ss[k]+=r; k+=k&-k;
	}
}

int sum(int k){
	int res = 0;
	while(k){
		res += ss[k]; k -= k&-k;
	}
	return res;
}

int sum(int x, int y){
	return sum(y) - sum(x) + 1;
}

void run1(){printf("%d\n",sum(x, y));}

void run2(){
	int t = a[x];
	if(t<n && inv[t+1]>x && inv[t+1]<=y)add(t+1, 1);
	if(t>1 && inv[t-1]>x && inv[t-1]<=y)add(t, -1);
	t = a[y];
	if(t<n && inv[t+1]<y && inv[t+1]>x)add(t+1, -1);
	if(t>1 && inv[t-1]<y && inv[t-1]>x)add(t, 1);
	t = a[x];
	int tt = a[y];
	a[x] = tt; a[y] = t;
	inv[t] = y; inv[tt] = x;
}

void init(){
	int m = 0;
	add(1, 1);
	for(int i=2;i<=n;i++)if(inv[i]<inv[i-1])add(i, 1);
}

int main(){
	//freopen("in.txt","r",stdin);
	//freopen("1.out","w",stdout);
	scanf("%d",&n);
	for(int i = 1; i <= n; i++)scanf("%d",&a[i]), inv[a[i]] = i;
	init();
	int q, type;
	scanf("%d",&q);
	while(q--){
		scanf("%d %d %d\n",&type, &x, &y);
		if(type == 1)run1();
		else run2();
	}
	return 0;
}
