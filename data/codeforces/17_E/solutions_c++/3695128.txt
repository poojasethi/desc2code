#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
#include<algorithm>
#define LL long long
using namespace std;
const LL MAXN=4e+6+5;
const LL mod=51123987;
char s[MAXN];
LL rad[MAXN];
LL a[MAXN];
LL b[MAXN],sb[MAXN];
int n;
int main()
{
	scanf("%d",&n);
	scanf("%s",s);
	for(int i=n-1;i>=0;i--)
	{
		s[i*2+1]=s[i];
		s[i*2+2]='#';
	}
	s[0]='?';s[n<<1]='*';
	for(int i=1,j=0,k;i<(n<<1);)
	{
		while(s[i-j-1]==s[i+j+1])j++;
		rad[i]=j;
		for(k=1;k<=j&&rad[i-k]!=rad[i]-k;k++)
			rad[i+k]=min(rad[i-k],rad[i]-k);
		i+=k;
		j=max(j-k,0);
	}
	for(int i=1;i<=(n<<1)-1;i++)
		if(s[i]!='#')
		{
			a[(i+rad[i]-1)/2+1]--;
			a[i/2]++;
			b[(i-rad[i])/2]++;
			b[i/2+1]--;
		}
		else
			if(rad[i])
			{
				a[(i+rad[i]-1)/2+1]--;
				a[(i+1)/2]++;
				b[(i-rad[i])/2]++;
				b[(i-1)/2+1]--;
			}
	LL suma=0,sumb=0,sumc=0;
	for(int i=0;i<n;i++)
	{
		suma+=a[i];a[i]=suma;a[i]%=mod;
		sumb+=b[i];b[i]=sumb;b[i]%=mod;
		sumc+=a[i];sb[i]=sumc;sb[i]%=mod;
	}
	LL ans=0;
	for(int i=1;i<n;i++)
	{
		ans+=sb[i-1]*b[i];
		ans%=mod;
	}
	printf("%I64d",(sb[n-1]*(sb[n-1]-1)/2-ans)%mod);
	return 0;
}
 		    	  					 	      	 	