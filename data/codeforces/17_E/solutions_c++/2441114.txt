#include<cstdio>
#include<cstring>
#include<algorithm>
#include<cstdlib>

using namespace std;
#define LL long long
const int maxn = 4500000;
const int maxp = 51123987;
char s[maxn];
int pl[maxn],n,m1[maxn],m2[maxn],f1[maxn],f2[maxn];

int main(){
	//freopen("17E.in","r",stdin);
	//freopen("17E.out","w",stdout);
	scanf("%d\n",&n);
	s[1]='1';
	for (int i=1;i<=n;i++){
		s[2*i]=getchar();
		s[2*i+1]='#';
	}
	s[2*n+1]='2';
	int mxl=0,dt=0;
	for (int i=1;i<=2*n+1;i++){
		if (mxl>=i)
			pl[i]=min(pl[dt-(i-dt)],mxl-i);
		if (i+pl[i]>=mxl){
			while (pl[i]<i&&i+pl[i]<=2*n+1&&s[i+pl[i]]==s[i-pl[i]]) pl[i]++;
			pl[i]--;
			mxl=i+pl[i];
			dt=i;
		}
	}
	for (int i=2;i<=2*n;i++){
		if (i%2==0){
			int ts=(pl[i])/2;
			m1[i/2-ts]++;m1[i/2+1]--;
			m2[i/2]++;m2[i/2+ts+1]--;
		}else{
			int ts=(pl[i]+1)/2;
			m1[i/2-ts+1]++;m1[i/2+1]--;
			m2[i/2+1]++;m2[i/2+ts+1]--;
		}
	}
	int ans=0;
	for (int i=1;i<=n;i++){
		f1[i]=(f1[i-1]+m1[i])%maxp;
		f2[i]=(f2[i-1]+m2[i])%maxp;
	}
	for (int i=1;i<=n;i++)
		f2[i]=(f2[i-1]+f2[i])%maxp;
	for (int i=1;i<=n;i++)
		ans=(ans+(LL)f1[i]*f2[i-1]%maxp)%maxp;
	ans=((LL)f2[n]*(f2[n]-1)/2%maxp-ans)%maxp+maxp;
	printf("%d\n",ans%maxp);
	return 0;
}
