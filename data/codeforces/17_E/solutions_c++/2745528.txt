#include<cstdio>
#include<iostream>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<algorithm>
using namespace std;
long long i,j,k,l,n,m,s,an,ans,sum;
const long long N=4100000;
const int pp=51123987;
long long lef[N],f[N],rig[N];
char a[N];
int main()
{
    scanf("%I64d",&n);
    getchar();
    for (long long i=1;i<=n;i++)
    scanf("%c",&a[2*i]);
    a[0]='A';
    a[2*n+2]='B';
    k=0;
    long long mm=0;
    for (long long i=1;i<=2*n;i++)
    {
        if (i<mm) f[i]=min(mm-i,f[2*k-i]);
        else f[i]=1;
        while (a[i+f[i]]==a[i-f[i]]) f[i]++;
        lef[(i-f[i])/2+1]++;
        lef[i/2+1]--;
        rig[(i+1)/2]++;
        rig[(f[i]+i)/2]--;
        sum=(sum+f[i]/2)%pp;
        if (f[i]+i>mm) {k=i;mm=f[i]+i;}
    }
    for (long long i=1;i<=n;i++)
    {
        lef[i]+=lef[i-1];
        lef[i]%=pp;
        rig[i]+=rig[i-1];
        rig[i]%=pp;
    }
    for (long long i=1;i<=n;i++)
    {
        rig[i]+=rig[i-1];
        rig[i]%=pp;
        ans+=lef[i]*rig[i-1]%pp;
        ans%=pp;
    }
    ans=sum*(sum-1)/2%pp-ans;
    ans%=pp;
    if (ans<0) ans+=pp;
       printf("%I64d",ans);
    return 0;
}
