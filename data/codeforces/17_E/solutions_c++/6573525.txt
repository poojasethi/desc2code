#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define md 51123987
#define N 4000010
int n,m,f[N],l[N],r[N],ans;
char a[N],b[N];
using namespace std;
int main(){
    scanf("%d%s",&n,a);
    m=0;
    b[m++]='$';
    int sl=strlen(a);
    for(int i=0;i<sl;++i){
        b[m++]='#';
        b[m++]=a[i];
    }
    b[m++]='#';
    b[m]=0x00;
    --m;
    //printf("%s\n",b);
    int mp=0,mv=0;
    memset(f,0,sizeof(f));
    for(int i=1;i<=m;++i){
        f[i]=mv>i?min(f[2*mp-i],mv-i):1;
        while(b[i+f[i]]==b[i-f[i]])++f[i];
        if(i+f[i]>mv)mv=i+f[i],mp=i;
    }
    memset(l,0,sizeof(l));
    memset(r,0,sizeof(r));
    ans=0;
    for(int i=1;i<m;++i){
        ++l[i-f[i]+1];
        --l[i+1];
        ++r[i];
        --r[i+f[i]];
        (ans+=(f[i]/2))%=md;
    }
    ans=1ll*ans*(ans-1)/2 %md;
    //printf("ans:%d\n",ans);
    int sum=0;
    //for(int i=1;i<=m;++i)printf("%d ",l[i]);puts("");
    //for(int i=1;i<=m;++i)printf("%d ",r[i]);puts("");
    for(int i=1;i<=m;++i){
        l[i]+=l[i-1];
        r[i]+=r[i-1];
        if(i%2==0){
            (ans-=(1ll*sum*l[i]%md))%=md;
            (sum+=r[i])%=md;
        }
        //printf("ans:%d\n",ans);
    }
    (ans+=md)%=md;
    printf("%d\n",ans);
    return 0;
}
