#include<iostream>
#include<algorithm>
#include<cstdio>
#include<cstdlib>
#include<cstring>

typedef long long ll;

using std::max;

const int fin=0,maxn=2000010;
const int MC=51123987;
int n;
char s[maxn];
int a[maxn*2],d[maxn*2];
int f[maxn],g[maxn];

void pre(){
  int i,j=0;
  for(i=1;i<=n;++i)a[i*2]=s[i];
  a[0]=1,a[2*n+2]=2;
  for(i=1;i<=2*n+1;++i){
    if(j+d[j]>i&&d[2*j-i]<j+d[j]-i)
      d[i]=d[2*j-i];
    else{
      d[i]=max(j+d[j]-i,1);
      while(a[i-d[i]]==a[i+d[i]])++d[i];
      j=i;
    }
  }
}

void sol(){
  int i,l,r,x,y;
  int sum=0,ans=0,s=0;
  for(i=2*n;i>1;--i){
    if((i&1)==1&&d[i]==1)continue;
    if(i&1)r=i-1>>1,x=i+1>>1;else r=x=i>>1;
    l=i-d[i]+2>>1,y=i+d[i]-2>>1;
    ++f[l],--f[r+1],++g[x],--g[y+1];
    sum=(sum+y-x+1)%MC;
  }
  sum=((ll)sum*(sum-1+MC))%MC;
  sum=((ll)sum*((MC+1)/2))%MC;
  for(i=2;i<=n;++i)
    f[i]+=f[i-1],g[i]+=g[i-1];
  for(i=n;i;--i){
    ans=((ll)s*g[i]+ans)%MC;
    s=(s+f[i])%MC;
  }
  ans=(sum-ans+MC)%MC;
  printf("%d\n",ans);
}

int main(){
  if(fin){
    freopen("t.in","r",stdin);
    freopen("t.out","w",stdout);
  }
  scanf("%d\n%s",&n,s+1);
  pre();
  sol();
  return 0;
}
