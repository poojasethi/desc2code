#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
const ll Mod=51123987;
int n,f[4000010],mx;
ll sum,s1[4000010],s2[4000010],s3[4000010];
char s[4000010];
int main(){
	scanf("%d",&n);
	if(n==1){
	 printf("0\n");return 0;	
	}
	s[0]='#';char c=getchar();
	for(int i=1;i<=n;i++){
		while(c<'a'||c>'z') c=getchar();
		s[2*i-1]=c;s[2*i]='#';
		c=getchar();
	}
	f[1]=2;mx=2;
	for(int i=2;i<=2*n-1;i++){
	 f[i]=max(min(f[max(2*mx-i,1)],f[mx]+mx-i),1);
	 while(i-f[i]>=0&&i+f[i]<=2*n&&s[f[i]+i]==s[i-f[i]]) f[i]++;
	 if(f[i]+i>f[mx]+mx) mx=i;
	}
	for(int i=1;i<=n;i++)
	 sum+=(f[2*i-1]+1)/2,sum+=f[2*i]/2,sum=sum-sum/Mod*Mod;
	sum=(sum*(sum-1)/2)%Mod;
	memset(s1,0,sizeof(s1));
	memset(s2,0,sizeof(s2));
	for(int i=1;i<=n;i++)
	 s1[i-f[2*i]/2+1]++,s1[i-(f[2*i-1]+1)/2+1]++,s1[i+1]-=2;
	for(int i=0;i<=n-1;i++)
	 s2[i+1]+=2,s2[i+f[2*i]/2+1]--,s2[i+(f[2*i+1]+1)/2+1]--;
	for(int i=1;i<=n;i++) s1[i]+=s1[i-1],s2[i]+=s2[i-1];
	s3[0]=0;
	for(int i=1;i<=n;i++) s3[i]=(s3[i-1]+s2[i])%Mod;
	ll js=0;
	for(int i=1;i<=n;i++)
	 js+=s1[i]*s3[i-1],js=js-js/Mod*Mod;
	printf("%I64d\n",(sum-js+Mod)%Mod);
	return 0;
}