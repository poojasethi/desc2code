#include<cstdio>
#include<cstring>
const int N=4000005,oo=51123987;
char s[N],a[N];
int n,m,k,f[N],c[N],q[N],sum,ans,x,y,z;
int main()
{
	scanf("%d%s",&n,s+1),f[0]=1;
	for (int i=1;i<=n;i++) a[++m]=' ',a[++m]=s[i]; a[++m]=' ';
	for (int i=1;i<=m;i++)
		if (i<f[k]+k && f[k+k-i]+i<f[k]+k) f[i]=f[k+k-i];
		else{
			f[i]=i<f[k]+k?f[k]+k-i:0;
			for (;i-f[i] && i+f[i]<=m && a[i+f[i]]==a[i-f[i]];f[i]++);
			if (i+f[i]>k+f[k]) k=i;
			}
	for (int i=1;i<=m;i++) c[i]++,c[i+f[i]]--,q[i-f[i]]++,q[i]--,sum=(sum+f[i]/2)%oo;
	x=c[0],y=q[0],z=x,ans=1LL*sum*(sum-1)/2%oo;
	for (int i=1;i<=m;i++){
		x=(x+c[i])%oo,y=(y+q[i])%oo;
		if (i&1) ans=(ans-1LL*z*y)%oo; else z=(z+x)%oo;
		}
	printf("%d\n",(ans+oo)%oo); return 0;
}
