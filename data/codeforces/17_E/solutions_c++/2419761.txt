#include<cstdio>
#include<cstring>
#include<algorithm>
#define fo(i,a,b) for(i=a;i<=b;++i)
using namespace std;
const int mn=4010000,mo=51123987;
int st[mn],ed[mn],sum[mn],p[mn];
int n,l=0,ans;
char s[mn],t[mn];
void solve()
{
    int i,j=0,k=0,t;
    fo(i,0,l-1)
    {
        t=0;
        if(i<=j)t=min(j-i,p[2*k-i]);
        while(i-t-1>=0&&i+t+1<l&&s[i-t-1]==s[i+t+1])++t;
        p[i]=t;
        if(i+t>j)k=i,j=i+t;
    }
}
int main()
{
    scanf("%d",&n);
    scanf("%s",t);
    int i,j,k;
    fo(i,0,n-1)s[l++]='*',s[l++]=t[i];
    s[l++]='*';
    solve();
    fo(i,0,n-1)
    {
        k=(p[i*2+1]+1)/2;
        ++st[i-k+1],--st[i+1],++ed[i],--ed[i+k];
        k=p[i*2+2]/2;
        ++st[i-k+1],--st[i+1],++ed[i+1],--ed[i+k+1];
    }
    fo(i,1,n)st[i]+=st[i-1],ed[i]+=ed[i-1];
    sum[0]=0;
    fo(i,1,n)sum[i]=(sum[i-1]+ed[i-1])%mo;
    ans=(long long)sum[n]*(long long)(sum[n]-1)/2%mo;
    fo(i,0,n-1)ans=(ans-(long long)st[i]*(long long)sum[i]%mo)%mo;
    printf("%d\n",(ans+mo)%mo);
    return 0;
}
