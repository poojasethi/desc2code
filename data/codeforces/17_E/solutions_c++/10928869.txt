#include<cstdio>
#include<algorithm>
#define M 51123987LL
using namespace std;

char s[4000100],st[4000100];
int p[4000100];
long long a[4000100],b[4000100],c[4000100];
int main(){
	int n;scanf("%d",&n);
	scanf("%s",st);
	for(int i=0;i<n;i++)
		s[i<<1]='#',s[(i<<1)+1]=st[i];
	s[n*2]='#';s[n*2+1]='\0';
	int m=n*2+1;
	int r=0,id;
	for(int i=0;i<m;i++){
		if(r>i)p[i]=min(p[2*id-i],r-i);
		while(i>p[i] && i+p[i]<m && s[i+p[i]+1]==s[i-p[i]-1])p[i]++;
		if(p[i]+i>r){
			r=p[i]+i;
			id=i;
		}
	}
	for(int i=0;i<n;i++){
		a[i-(p[i*2+1]+1)/2+1]++;
		a[i+1]--;
		b[i]++;
		b[i+(p[i*2+1]+1)/2]--;
		
		a[i-p[i*2+2]/2+1]++;
		a[i+1]--;
		b[i+1]++;
		b[i+p[i*2+2]/2+1]--;
	}
	for(int i=1;i<=n;i++)
		a[i]+=a[i-1],b[i]+=b[i-1],c[i]=(c[i-1]+b[i-1])%M;
	long long ans=0;
	ans=c[n]*(c[n]-1)/2;ans%=M;
	for(int i=0;i<n;i++){
		ans-=c[i]*a[i];
		ans%=M;
	}
	ans+=M;ans%=M;
	printf("%I64d\n",ans);
	return 0;
}
 		 	 		 				 	 	  	  		   			