#include<cstdio>
#define MAXN 4100000

int ans[MAXN],Mod(51123987),n,s[MAXN],t,
	Cnt1[MAXN],Cnt2[MAXN],Ans;

char Chr;

struct pt{int l,r;}	p[MAXN];

void reads()
{	for(n=0;(Chr=getchar())<'a';);
	for(s[2*(n++)]=Chr-'a';(Chr=getchar())>='a';s[2*(n++)]=Chr-'a');
}

int main()
{	int i,j,k,L,R,M;
	scanf("%*d");
	reads();
	for(i=1;i<n;i++)s[2*i-1]=30;
	n=2*n-1;
	for(i=k=0;i<n;i++)
	if(i>=k+ans[k]||i+ans[2*k-i]>=k+ans[k])
	{	for(ans[i]=(k+ans[k]-i>0)?(k+ans[k]-i):0;i+ans[i]<n&&i-ans[i]>=0&&s[i+ans[i]]==s[i-ans[i]];ans[i]++);
		k=i;
	}
	else ans[i]=ans[2*k-i];
	for(i=0;i<n;i++)
	{	L=i-ans[i]+1;
		R=i+ans[i]-1;
		L=(L+1)/2;
		R=R/2;
		if(L<=R)p[t++]=(pt){L,R};
	}
	n=(n+1)/2;
	for(i=0;i<t;i++)
	{	Cnt1[p[i].l]++;
		Cnt1[(p[i].l+p[i].r)/2+1]--;
		Cnt2[p[i].l]++;
		Cnt2[(p[i].l+p[i].r)/2+1]--;
        Cnt2[(p[i].l+p[i].r+1)/2+1]--;
		Cnt2[p[i].r+2]++;
	}
	L=R=M=0;
	for(i=0;i<n;i++)
	{	L=(L+Cnt1[i])%Mod;
		M=(M+Cnt2[i])%Mod;
		R=(R+M)%Mod;
		Ans=(Ans+1ll*L*(R-L)+1ll*L*(L-1)/2)%Mod;
	}
	Ans=(Ans+Mod)%Mod;
	printf("%d\n",Ans);
	return 0;
}
