#include<cstdio>
const int n=2000005;
const int oo=51123987;
int N,Max,p,Ans,i,l,r,midl,midr,Num;
int A[4*n],B[4*n],g[2*n];
char s[2*n],S[n];
int main()
{
	scanf("%d",&N);
	scanf("%s",S);
	N=2*N+1;
	for(i=0;i<=N;i++) s[i]=' ';
	for(i=0;i<N/2;i++) s[2*(i+1)]=S[i];
	for(i=1;i<=N;++i)
	{
		if(i<=Max&&g[2*p-i]<Max-i) g[i]=g[2*p-i];
		else
		{
			if(i<=Max) g[i]=Max-i;
			else g[i]=0;
			for(;i-g[i]-1>0&&i+g[i]+1<=N&&s[i-g[i]-1]==s[i+g[i]+1];++g[i]);
			if(i+g[i]>Max) Max=i+g[i],p=i;
		}
		midl=i/2,midr=(i+1)/2;
		l=i-g[i],r=i+g[i];
		if(s[l]==' ') ++l;
		if(s[r]==' ') --r;
		l/=2,r/=2;
		if(l>r) continue;
		++A[l],--A[midl+1],++B[midr],--B[r+1];
		Num=(Num+r-midr+1)%oo;
	}
	N/=2;
	for(i=1;i<=N;++i)
		A[i]=(A[i]+A[i-1])%oo,B[i]=(B[i]+B[i-1])%oo;
	for(i=1;i<=N;++i)
	{
		B[i]=(B[i]+B[i-1])%oo;
		Ans=((long long)Ans+(long long)A[i]*(long long)B[i-1])%oo;
	}
	Ans=((long long)Num*(long long)(Num-1)/2+oo-Ans)%oo;
	printf("%d\n",Ans);
	return 0;
}
