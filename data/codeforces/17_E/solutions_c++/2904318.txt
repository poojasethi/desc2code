#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
using namespace std;

typedef long long LL;
const int maxn = 4000005, mod = 51123987;
int f[maxn], a[maxn], b[maxn];
char s[maxn];
int l, n;

int main() {
    int i, j, k; LL ans, sum;
    scanf("%d", &l); n = l + l + 1;
    for (i = 1; i <= l; ++i) scanf(" %c", s + i + i);
    for (i = j = 1; i <= n; i += k, j = max(1, j - k)) {
        while (j < i && i + j <= n && s[i - j] == s[i + j]) ++j;
        for (k = 1, f[i] = j; k < f[i] && f[i] - k != f[i - k]; ++k)
            f[i + k] = min(f[i - k], f[i] - k);
    }
    for (i = 1, ans = 0; i <= n; ++i) {
        ++a[(i - f[i]) / 2 + 1]; --a[i / 2 + 1];
        ++b[(i + 1) / 2]; --b[(i + f[i]) / 2];
        ans += f[i] / 2;
    }
    for (i = 1; i <= l; ++i)
        a[i] += a[i - 1], b[i] += b[i - 1];
    ans %= mod; ans = ans * (ans - 1) / 2 % mod;
    for (i = 1, sum = 0; i <= l; ++i) {
        ans = (ans - sum * a[i]) % mod;
        sum = (sum + b[i]) % mod;
    }
    printf("%d\n", (ans + mod) % mod);
    return 0;
}

