#include<cstdio>
#include<algorithm>
#include<cstring>
#include<map>
using namespace std;

const int N=55,M=250000;
int a[N],b[N],c[N],l[N],r[N];
int n,m;

map<int,int> v[N];
int s,t,tot;

const int inf=1<<29;
const int P=10050,E=60050;
int first[P],next[E],to[E],f[E],size=1;
void put(int x,int y,int fl){ 
  next[++size]=first[x];
  first[x]=size;
  to[size]=y;f[size]=fl;
  next[++size]=first[y];
  first[y]=size;
  to[size]=x;f[size]=0;
}
bool upmin(int &x,int y){if(y<x){x=y;return true;}return false;}
int Flow=0;
int now[P],his[P],pre[P],d[P],num[P];
int sap(){
  for(int i=1;i<=tot;i++) now[i]=first[i];
  num[0]=tot;pre[s]=s;
  for(int i=s,aug=inf,tmp=0;d[s]<tot;){
    tmp=0;his[i]=aug;
    for(int &k=now[i];k;k=next[k])
      if(f[k]&&d[i]==d[to[k]]+1){
        tmp=1;upmin(aug,f[k]);
        pre[to[k]]=i;i=to[k];
        if(i==t){
          for(;i!=s;)
            i=pre[i],f[now[i]]-=aug,f[now[i]^1]+=aug;
          Flow+=aug;aug=inf;
        }
        break;
      }
    if(tmp)continue;  
    int mind=tot,k1;
    for(int k=first[i];k;k=next[k])
      if(f[k])
        if(upmin(mind,d[to[k]]))
          k1=k;
    if(!--num[d[i]]) break;    
    num[d[i]=mind+1]++;
    now[i]=k1;
    aug=his[i=pre[i]];
  }
  return Flow;
}

int main(){
  scanf("%d%d",&n,&m);
  s=++tot,t=++tot;
  for(int i=1;i<=n;i++)scanf("%d%d%d",&a[i],&b[i],&c[i]);
  for(int i=1;i<=n;i++){
    scanf("%d%d",&l[i],&r[i]);
    for(int j=l[i]-1;j<=r[i];j++)
      v[i][j]=++tot;
    put(s,v[i][l[i]-1],inf);
    put(v[i][r[i]],t,inf);  
    for(int j=l[i];j<=r[i];j++)
      put(v[i][j-1],v[i][j],M-a[i]*j*j-b[i]*j-c[i]);
  }
  for(int i=1;i<=m;i++){
    int x,y,d;scanf("%d%d%d",&x,&y,&d);
    for(int j=l[x]-1;j<=r[x];j++)
      if(j-d>=l[y]-1&&j-d<=r[y])
        put(v[x][j],v[y][j-d],inf);
  }
  printf("%d\n",n*M-sap());
}
