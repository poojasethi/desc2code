#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <algorithm>
using namespace std;
int e[1000005],next[1000005],head[1000005],ll[1000005],n,Q,T,S,a[55],b[55],c[55];
int A,B,C,l[55],r[55],m[55][205],d[1000005],dv[1000005],cnt,i,o,j,ans;
const int INF=200000007;
const int oo=402000;
int sap(int x,int flow)
{
    if (x==T) return flow;
    int now=head[x],DFS=0;
    while (now!=0)
    {
          if (ll[now] && d[e[now]]+1==d[x]) 
          {
                      int P=sap(e[now],min(ll[now],flow-DFS));
                      ll[now]-=P; DFS+=P;
                      if (now % 2==0) ll[now-1]+=P; else ll[now+1]+=P;
                      if (DFS==flow) return DFS;
          }
          now=next[now];
    }
    if (d[S]==cnt+2) return DFS;
    dv[d[x]]--;
    if (dv[d[x]]==0) d[S]=cnt+2;
    d[x]++;
    dv[d[x]]++;
    return DFS;
}
void add(int a,int b,int c,int d)
{
     e[a]=c;
     next[a]=head[b];
     head[b]=a;
     ll[a]=d;
}
int main()
{
   scanf("%d%d",&n,&Q);
   S=n*203; T=S+1;
   for (i=1; i<=n; i++) scanf("%d%d%d",&a[i],&b[i],&c[i]);
   for (i=1; i<=n; i++)
   {
       scanf("%d%d",&l[i],&r[i]);
       m[i][l[i]+100]=++cnt;
       add(++o,S,cnt,INF);
       add(++o,cnt,S,0);
       for (j=l[i]; j<=r[i]; j++) 
       {
           m[i][j+101]=++cnt;
           add(++o,m[i][j+100],cnt,oo-(j*j*a[i]+j*b[i]+c[i]));
           add(++o,cnt,m[i][j+100],0);
       }
       add(++o,m[i][r[i]+101],T,INF);
       add(++o,T,m[i][r[i]+101],0);
   }
   while (Q--)
   {
         scanf("%d%d%d",&A,&B,&C);
         for (i=l[A]-1; i<=r[A]; i++)
           if (i-C+101>=0 && i-C+101<=204 && m[B][i-C+101]!=0)
           {
                            add(++o,m[A][i+101],m[B][i-C+101],INF);
                            add(++o,m[B][i-C+101],m[A][i+101],0);
           } 
   }
   cnt=T-2;
   ans=oo*n;
   dv[1]=T;
   while (d[S]<cnt+2) ans-=sap(S,INF*2);
   cout<<ans;
   return 0;
}