#include<bits/stdc++.h>
using namespace std;
const int N=3e5+10;

int unr[N];
int upd[N];

int main(){
    ios_base::sync_with_stdio(false);cin.tie(0);
    fill(upd , upd+N , -1);
    int n , q;cin >> n >> q;
    vector<int > v;
    int mxt=0 , cnt=0 , ans=0;
    for(int i=0 ; i<q ; i++){
	int t , d;cin >> t >> d;
	if(t == 1){
	    unr[d] ++;
	    v.push_back( d );
	    ans ++;
	}
	if(t == 2){
	    ans -= unr[d];
	    unr[d] = 0;
	    upd[d] = v.size()-1;
	}
	if(t == 3){
	    if(d > mxt){
		for(int i=mxt ; i<d ; i++){
		    if( upd[ v[i] ] < i ){
			unr[ v[i] ] --;
			ans --;
		    }
		}
	    }
	    mxt = max(mxt , d);
	}
	cout << ans << "\n";

    }
}
