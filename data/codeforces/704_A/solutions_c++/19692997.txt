#include<cstdio>
const int N=400010;
int n,Q,m,i,fin,op,x,q[N],f[N],tm[N],v[N],ans;
int main(){
  scanf("%d%d",&n,&Q);
  fin=1;
  for(i=1;i<=Q;i++){
    scanf("%d%d",&op,&x);
    if(op==1){
      q[++m]=x;
      tm[m]=i;
      f[x]++;
      ans++;
    }
    if(op==2){
      ans-=f[x];
      f[x]=0;
      v[x]=i;
    }
    if(op==3){
      while(fin<=x){
        if(tm[fin]>v[q[fin]])f[q[fin]]--,ans--;
        fin++;
      }
    }
    printf("%d\n",ans);
  }
  return 0;
}