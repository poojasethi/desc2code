#include <iostream>
#include <vector>
#define f first
#define s second
#define PII pair <int , int>
#define pb push_back
using namespace std;
const int maxn = 5000 + 152 , inf = 1e9 ;
int n , m , dis[maxn] ;
vector <int> v[2][maxn] ;
PII p[maxn] ;
bool mark[2][maxn] ;
void dfs (int x , int y){
	mark[x][y] = 1;
	for (int i=0 ; i<v[x][y].size() ; i++)
		if (!mark[x][v[x][y][i]])
			dfs(x , v[x][y][i]);
}
int main (){
	cin >> n >> m ;
	fill (dis , dis+n , inf);
	for (int i=0 ; i<m ; i++){
		cin >> p[i].f >> p[i].s ;
		v[0][p[i].f].pb(p[i].s);
		v[1][p[i].s].pb(p[i].f);
	}
	dfs (0 , 1);
	dfs (1 , n);
	for (int i=0 ; i<=n ; i++)
		for (int j=0 ; j<m ; j++)
			if (mark[0][p[j].f] && mark[1][p[j].s]){
				dis[p[j].f] = min (dis[p[j].f] , dis[p[j].s]+2);
				dis[p[j].s] = min (dis[p[j].s] , dis[p[j].f]-1);
			}
	for (int j=0 ; j<m ; j++)
		if (mark[0][p[j].f] && mark[1][p[j].s] && (dis[p[j].f] > dis[p[j].s]+2 || dis[p[j].s] > dis[p[j].f]-1)){
			cout << "No" << endl ;
			return 0;
		}
	cout << "Yes" << endl ;
	for (int i=0 ; i<m ; i++)
		if (!mark[0][p[i].f] || !mark[1][p[i].s])
			cout << 1 << endl ;
		else
			cout << max (dis[p[i].f]-dis[p[i].s] , 1) << endl ;
	return 0;
}
