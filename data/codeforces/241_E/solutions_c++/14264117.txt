#include<iostream>
#define X first
#define Y second
using namespace std;
int n,m;
const int N=1010;
pair<int,int> e[6*N];
int d[N];
const int inf=1<<30;
bool graph[N][N];
int s[N],t[N];
bool f()
{
    for(int i=1;i<=n;i++)
        d[i]=inf;
    d[1]=0;
    for(int i=0;i<=n+10;i++)
        for(int j=0;j<m;j++)
            if(s[e[j].X] && t[e[j].Y])
                d[e[j].Y]=min(d[e[j].Y],d[e[j].X]+2),
                d[e[j].X]=min(d[e[j].X],d[e[j].Y]-1);
    for(int i=0;i<m;i++)
        if(s[e[i].X] && t[e[i].Y])
            if(d[e[i].Y]-d[e[i].X]!=1 && d[e[i].Y]-d[e[i].X]!=2)
                return false;
    return true;
}
int main()
{
    cin>>n>>m;
    for(int i=0;i<m;i++)
        cin>>e[i].X>>e[i].Y,
        graph[e[i].X][e[i].Y]=true;
    s[1]=1;
    for(int i=2;i<=n;i++)
        for(int j=1;j<i;j++)
            if(s[j] && graph[j][i])
                s[i]=true;
    t[n]=1;
    for(int i=n-1;i>=1;i--)
        for(int j=i+1;j<=n;j++)
            if(t[j] && graph[i][j])
                t[i]=true;
    if(!f())
        cout<<"No"<<endl;
    else
    {
        cout<<"Yes"<<endl;
        for(int i=0;i<m;i++)
            if(!s[e[i].X] || !t[e[i].Y])
                cout<<1<<endl;
            else
                cout<<d[e[i].Y]-d[e[i].X]<<endl;
    }
    return 0;
}
