#include <iostream>
#include <cstring>
#include <cstdio>
#include <algorithm>
#include <cmath>
using namespace std;
#define N 5050
int n,m,ln[N][2],h[N],dis[N];bool b[N],c[N];
inline int Read()
 {
    int x=0;char y;
    do y=getchar(); while (y<'0'||y>'9');
    do x=x*10+y-'0',y=getchar(); while (y>='0'&&y<='9');
    return x;
 }
void DFS(int x)
 {
    b[x]=1;
    for (int i=1;i<=m;i++)
     if (ln[i][0]==x&&!b[ln[i][1]]) DFS(ln[i][1]);
 }
void DSF(int x)
 {
    c[x]=1;
    for (int i=1;i<=m;i++)
     if (ln[i][1]==x&&!c[ln[i][0]]) DSF(ln[i][0]);
 }
int main()
 {
    n=Read();m=Read();
    for (int i=1;i<=m;i++)
      ln[i][0]=Read(),ln[i][1]=Read();
    DFS(1);DSF(n);
    for (int i=1;i<=n;i++)
     for (int j=1;j<=m;j++)
      if (b[ln[j][0]]&&c[ln[j][1]])
        h[ln[j][0]]=min(h[ln[j][0]],h[ln[j][1]]-1),
        h[ln[j][1]]=min(h[ln[j][1]],h[ln[j][0]]+2);
    for (int i=1;i<=m;i++)
     {
        dis[i]=h[ln[i][1]]-h[ln[i][0]];
        if (b[ln[i][0]]&&c[ln[i][1]]&&dis[i]!=1&&dis[i]!=2)
          {puts("No");return 0;}
        if (dis[i]!=2) dis[i]=1;
     }
    puts("Yes");
    for (int i=1;i<=m;i++) printf("%d\n",dis[i]);
    return 0;
 }