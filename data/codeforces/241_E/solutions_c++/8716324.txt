#include<cstdio>
#include<vector>
#include<cstring>
using namespace std;
vector<int> v[1005],g[1005];
int x[5005],y[5005],dis[5005];
int r[2005],s[1005];
bool vis[1005],v1[1005],v2[1005];
void Dfs1(int x)
{
	v1[x]=1;
	for(int i=0;i<v[x].size();i++)
		if(!v1[v[x][i]])
			Dfs1(v[x][i]);
}
void Dfs2(int x)
{
	v2[x]=1;
	for(int i=0;i<g[x].size();i++)
		if(!v2[g[x][i]])
			Dfs2(g[x][i]);
}
int main()
{
	int n,m;
	scanf("%d%d",&n,&m);
	for(int i=1;i<=m;i++)
		scanf("%d%d",&x[i],&y[i]),
		v[x[i]].push_back(y[i]),
		g[y[i]].push_back(x[i]);
	Dfs1(1);Dfs2(n);
	memset(dis,63,sizeof(dis));
	dis[r[1]=1]=0;
	for(int i=0,t=1;i!=t;)
	{
		int x=r[++i==2000?i=0:i];
		vis[x]=0;
		if(++s[x]>n)return puts("No"),0;
		for(int j=0;j<v[x].size();j++)
			if(v1[v[x][j]]&&v2[v[x][j]]&&dis[v[x][j]]>dis[x]+2)
			{
				dis[v[x][j]]=dis[x]+2;
				if(!vis[v[x][j]])
					vis[r[++t==2000?t=0:t]=v[x][j]]=1;
			}
		for(int j=0;j<g[x].size();j++)
			if(v1[g[x][j]]&&v2[g[x][j]]&&dis[g[x][j]]>dis[x]-1)
			{
				dis[g[x][j]]=dis[x]-1;
				if(!vis[g[x][j]])
					vis[r[++t==2000?t=0:t]=g[x][j]]=1;
			}
	}
	puts("Yes");
	for(int i=1;i<=m;i++)
		if(v1[x[i]]&&v2[y[i]])
			printf("%d\n",dis[y[i]]-dis[x[i]]);
		else
			puts("1");
}