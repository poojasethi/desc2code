#include <bits/stdc++.h>

using namespace std;

const int N = 5010;

vector<int> g1[N],g2[N];
int n,m;
int u[N],v[N];
int d[N],vis1[N],vis2[N];

void dfs1(int u){
	vis1[u]=1;
	for(vector<int> :: iterator p=g1[u].begin();p!=g1[u].end();p++) if(!vis1[*p])
		dfs1(*p);
}
void dfs2(int u){
	vis2[u]=1;
	for(vector<int> :: iterator p=g2[u].begin();p!=g2[u].end();p++) if(!vis2[*p])
		dfs2(*p);
}
inline void ckmin(int &a,int b){b<a ? a=b,1 : 0;}

int main()
{
	scanf("%d%d",&n,&m);
	for(int i=1;i<=m;i++) scanf("%d%d",&u[i],&v[i]),g1[u[i]].push_back(v[i]),g2[v[i]].push_back(u[i]);
	dfs1(1);dfs2(n);
	for(int i=1;i<=n+m;i++)
		for(int j=1;j<=m;j++) if(vis1[u[j]] && vis2[v[j]])
			ckmin(d[v[j]],d[u[j]]+2),ckmin(d[u[j]],d[v[j]]-1);
	bool flg=1;
	for(int i=1;i<=m && flg;i++)
		if(vis1[u[i]] && vis2[v[i]] && (d[v[i]]-d[u[i]]<1 || d[v[i]]-d[u[i]]>2))
			flg=0;
	puts(flg?"Yes":"No");
	if(flg){
		for(int i=1;i<=m;i++)
			if(vis1[u[i]] && vis2[v[i]]) printf("%d\n",d[v[i]]-d[u[i]]);
			else puts("1");
	}
	return 0;
}
