#include<cstdio>
#include<cstring>
using namespace std;
const int maxn=1005;
const int maxe=5005;
int n,m;
int lx[maxn],rx[maxn],d[maxn];
int u[maxe],v[maxe];
int main(){
	scanf("%d%d",&n,&m);
	for(int i=0;i<m;i++){
		scanf("%d%d",&u[i],&v[i]);
		--u[i];--v[i];
	}
	lx[0]=true;rx[n-1]=true;
	for(int i=0;i<n;i++){
		bool update=false;
		for(int j=0;j<m;j++){
			int u=::u[j],v=::v[j];
			if(lx[u]&&!lx[v]){
				lx[v]=true;
				update=true;
			}
			if(!rx[u]&&rx[v]){
				rx[u]=true;
				update=true;
			}
		}
		if(!update)break;
	}
	bool ok=false;
	for(int i=0;i<n;i++){
		bool update=false;
		for(int j=0;j<m;j++){
			int u=::u[j],v=::v[j];
			if(!lx[u]||!rx[v])continue;
			if(d[u]+1>d[v]){
				d[u]=d[v]-1;
				update=true;
			}
			if(d[u]+2<d[v]){
				d[v]=d[u]+2;
				update=true;
			}
		}
		if(!update){
			ok=true;
			break;
		}
	}
	if(ok){
		puts("Yes");
		for(int i=0;i<m;i++){
			int u=::u[i],v=::v[i];
			if(d[v]-d[u]>2||d[v]-d[u]<1)printf("%d\n",1);
			else printf("%d\n",d[v]-d[u]);
		}
	}
	else puts("No");
	return 0;
}