#include <bits/stdc++.h>
using namespace std;
int n, m;
int u[5500], v[5500], next[5500];
int head[1100];
int a[5500], b[5500], d[1100];
bool dfs(int u)
{
	int f = (n == u);
	for(int i = head[u]; i; i = next[i])
		if(a[i])
			a[i] - 1 ? f = 1 : 0;
		else
		{
			a[i] = (b[i] = dfs(v[i])) + 1;
			if(b[i]) f = 1;
		}
	return f;
}

int main()
{
#ifdef ACM_TEST
	freopen("in.txt", "r", stdin);
//  freopen("in.txt", "w", stdout);
#endif
	int i, j, f;
	scanf("%d%d", &n, &m);
	for(i = 1; i <= m; i++)
	{
		scanf("%d%d", u + i, v + i);
		next[i] = head[u[i]];
		head[u[i]] = i;
	}
	dfs(1);
	f = 1, j = 0;
	for(i = 2; i <= n; i++)d[i] = 1e9;
	d[1] = 0;
	while(f)
	{
		f = 0;
		if(++j > n)
		{
			puts("No");
			return 0;
		}
		for(i = 1; i <= m; i++)
			if(b[i])
			{
				if(d[v[i]] > d[u[i]] + 2) f = 1, d[v[i]] = d[u[i]] + 2;
				if(d[u[i]] > d[v[i]] - 1) f = 1, d[u[i]] = d[v[i]] - 1;
			}
	}
	puts("Yes");
	for(i = 1; i <= m; i++)
		if(b[i])
			printf("%d\n", d[v[i]] - d[u[i]]);
		else
			printf("1\n");
	return 0;
}

    	 		 			 		 	  	 	    	 		