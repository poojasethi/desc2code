#include<bits/stdc++.h>

using namespace std;

#define st first
#define nd second
#define mp make_pair
#define pb push_back
#define sol (root+root)
#define sag (root+root+1)
#define orta ((bas+son)/2)
#define ll long long
#define pii pair<int,int>
#define type(x) __typeof((x).begin())
#define foreach(it, x) for(type(x) it = (x).begin(); it != (x).end(); it++)

const int N=5e3+5;
const int mod=1e9+7;
const int inf=1e9+7;

int n,m,i,bek;
int a[N],b[N],dist[N],vL[N],vR[N];

main(){

	scanf("%d %d",&n,&m);

	for(i=1 ; i<=m ; i++)
		scanf("%d %d",a+i,b+i);

	fill(dist+1,dist+n+1,inf);

	dist[1]=0;
	
	vL[1]=1;
	vR[n]=1;

	for(int i=1 ; i<=n ; i++)
		for(int j=1 ; j<=m ; j++){
			if(vL[a[j]] and !vL[b[j]])
				vL[b[j]]=1;
			if(vR[b[j]] and !vR[a[j]])
				vR[a[j]]=1;
		}

	for(int i=1 ; i<=n ; i++){
		bek=0;
		for(int j=1 ; j<=m ; j++){
			int a=::a[j],b=::b[j];
			if(vL[a] and vR[a] and vL[b] and vR[b]){
				if(dist[a]+2<dist[b]){
					dist[b]=dist[a]+2;
					bek=1;
				}
				if(dist[a]>dist[b]-1){
					dist[a]=dist[b]-1;
					bek=1;
				}
			}
		}
		if(!bek)
			break;
	}

	if(!bek){
		puts("Yes");
		for(int i=1 ; i<=m ; i++){
			int x=dist[b[i]]-dist[a[i]];
			if(x!=1 and x!=2)
				x=1;
			printf("%d\n",x);
		}
	}
	else
		puts("No");

}
