#include<cstdio>
#include<vector>
#define pb push_back
#define fo(i,a,b) for(int i=a;i<=b;++i)
using namespace std;
const int mn=1010,mm=mn*5,inf=1<<30;
int D[mn];
int a[mm],b[mm];
int n,m;
bool flag,P[mn],v1[mn],v2[mn],*v;
vector<int>e0[mn],e1[mn],*e;
void slack(int i,int j,int v)
{
    if(D[i]+v>D[j])
        D[j]=D[i]+v,flag=1;
}
void dfs(int r)
{
    v[r]=1;
    for(int p=0;p<e[r].size();++p)
        if(!v[e[r][p]])dfs(e[r][p]);
}
int main()
{
    scanf("%d%d",&n,&m);
    fo(i,1,m)
    {
        scanf("%d%d",a+i,b+i);
        e0[a[i]].pb(b[i]),e1[b[i]].pb(a[i]);
    }
    fo(i,1,n)D[i]=-inf;
    D[1]=0;
    e=e0,v=v1;
    dfs(1);
    e=e1,v=v2;
    dfs(n);
    fo(i,1,n)P[i]=v1[i]&&v2[i];
    fo(j,1,n+1)
    {
        flag=0;
        fo(i,1,m)
            if(P[a[i]]&&P[b[i]])slack(a[i],b[i],1),slack(b[i],a[i],-2);
        if(!flag)break;
    }
    flag=0;
      fo(i,1,m)
        if(P[a[i]]&&P[b[i]])slack(a[i],b[i],1),slack(b[i],a[i],-2);
    if(flag)
    {
        puts("No");
        return 0;
    }
    puts("Yes");
    fo(i,1,m)
    {
        if(P[a[i]]&&P[b[i]])
            printf("%d\n",D[b[i]]-D[a[i]]);
        else printf("1\n");
    }
    return 0;
}