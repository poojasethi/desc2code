#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<vector>
using namespace std;
int i,j,k,l,n,m,x[12000],y[12000],dis[12000],tim,pj,X,Y,vis[1200][2];
vector <int> q[2][1200];
void dfs(int x,int o){
	if(vis[x][o])return;
	vis[x][o]=1;
	for(int i=0;i<q[o][x].size();++i)dfs(q[o][x][i],o);
}
int main(){
	scanf("%d%d",&n,&m);
	for(i=1;i<=m;++i){
		scanf("%d%d",&x[i],&y[i]);
		q[0][x[i]].push_back(y[i]);
		q[1][y[i]].push_back(x[i]);
	}
	dfs(1,0);
	dfs(n,1);
	for(i=2;i<=n;++i)dis[i]=1e9;
	pj=1;
	while(pj){
		pj=0;
		tim++;
		if(tim==n+1){
			printf("No\n");
			return 0;
		}
		for(i=1;i<=m;++i)if(vis[X=x[i]][0]&&vis[Y=y[i]][1]){
			if(dis[Y]>dis[X]+2)dis[Y]=dis[X]+2,pj=1;
			if(dis[X]>dis[Y]-1)dis[X]=dis[Y]-1,pj=1;
		}
	}
	printf("Yes\n");
	for(i=1;i<=m;++i)if(vis[x[i]][0]&&vis[y[i]][1])
		printf("%d\n",dis[y[i]]-dis[x[i]]);
	else printf("1\n");
//	for(;;);
}

