#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <vector>
#define N 5010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,x,y;
int a[N],b[N],gg[N],F[N],f[N],g[N*100],ff[N];
vector<int> zh[N],fan[N];
void Dfs(int x) {
	if (F[x]) return;
	int i;
	F[x]=1; f[x]=x==n;
	for (i=0;i<zh[x].size();i++) {
		int A=zh[x][i];
		Dfs(A);
		f[x]|=f[A];
	}
}
inline void fail() {
	printf("No\n");
	exit(0);
}
int main() {
	scanf("%d%d",&n,&m);
	For(i,1,m) {
		scanf("%d%d",&x,&y);
		zh[x].push_back(y);
		fan[y].push_back(x);
		a[i]=y,b[i]=x;
	}
	Dfs(1);
	{
		int l,r;
		g[l=r=1]=1;
		for (;l<=r;l++) {
			int A=g[l];
			ff[A]=0;
			for (i=0;i<zh[A].size();i++) {
				int B=zh[A][i];
				if (f[B]&&gg[B]<=gg[A]) {
					gg[B]=gg[A]+1;
					if (!ff[B]) ff[B]=1,g[++r]=B;
				}
			}
			for (i=0;i<fan[A].size();i++) {
				int B=fan[A][i];
				if (f[B]&&gg[B]<gg[A]-2) {
					if (B==1) fail();
					gg[B]=gg[A]-2;
					if (!ff[B]) ff[B]=1,g[++r]=B;
				}
			}
		}
	}
	For(i,1,m) if (f[b[i]]&&f[a[i]]&&gg[b[i]]+2<gg[a[i]]) fail();
	printf("Yes\n");
	For(i,1,m) printf("%d\n",!f[a[i]]||!f[b[i]]?1:gg[a[i]]-gg[b[i]]);
	return 0;
}
