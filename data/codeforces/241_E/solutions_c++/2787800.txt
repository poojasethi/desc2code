//By momo
#include<cstdio>
#include<vector>
#include<algorithm>
#define N 5010
#define INF 999999999
#define FOR(it,c) for(__typeof((c).begin())it=(c).begin();it!=(c).end();it++)
using namespace std;
bool vst[2][N];
vector<int> G[N], rG[N];
void dfs(int p){
	vst[0][p] = 1;
	FOR(it, G[p]) if(!vst[0][*it]) dfs(*it);
}
void rdfs(int p){
	vst[1][p] = 1;
	FOR(it, rG[p]) if(!vst[1][*it]) rdfs(*it);
}
int n, m, a[N], b[N], dis[N];
int main(){
	scanf("%d%d", &n, &m);
	for(int i = 0; i < m; i++){
		scanf("%d%d", &a[i], &b[i]);
		G[a[i]].push_back(b[i]);
		rG[b[i]].push_back(a[i]);
	}
	dfs(1); rdfs(n);
	for(int i = 0; i < n; i++){
		bool upd = 0;
		for(int j = 0; j < m; j++){
			int u = a[j], v = b[j];
			if(vst[0][u] && vst[1][v]){
				if(dis[u] > dis[v]-1) dis[u] = dis[v]-1, upd = 1;
				if(dis[v] > dis[u]+2) dis[v] = dis[u]+2, upd = 1;
			}
		}
		if(upd == 1 && i == n-1) return puts("No"), 0;
	}
	puts("Yes");
	for(int i = 0; i < m; i++){
		if(vst[0][a[i]] && vst[1][b[i]])
			printf("%d\n", dis[b[i]]-dis[a[i]]);
		else puts("1");
	}
}
