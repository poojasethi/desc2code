/**
Problem : codeforces 241e
**/
#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
const int MAXV = 11010;
const int INF = 1010101010;
int n,m,d[MAXV],fv[MAXV],ev[MAXV];
bool s[MAXV],t[MAXV];

int min(int a,int b){return (a<b)?a:b;}
bool solve(){
    for (int i=0;i<m;i++)   d[i] = INF;
    d[1] = 0;
    for (int k=0;k<2*n;k++)
        for (int i=0;i<m;i++)   if (s[fv[i]] && t[ev[i]]){
            d[ev[i]] = min(d[ev[i]],d[fv[i]]+2);
            d[fv[i]] = min(d[fv[i]],d[ev[i]]-1);
        }
    for (int i=0;i<m;i++)   if (s[fv[i]] && t[ev[i]]){
        int dx = d[ev[i]] - d[fv[i]];
        if (dx != 1 && dx != 2) return false;
    }
    return true;
}

int main(){
    scanf("%d%d",&n,&m);
    for (int i=0;i<m;i++) scanf("%d%d",&fv[i],&ev[i]);
    memset(s,false,sizeof(s));
    memset(t,false,sizeof(t));
    s[1] = true; t[n] = true;
    for (int i=2;i<=n;i++)
        for (int j=0;j<m;j++)   if (ev[j]==i && s[fv[j]]) s[i] = true;
    for (int i=n-1;i>=1;i--)
        for (int j=0;j<m;j++)   if (fv[j]==i && t[ev[j]]) t[i] = true;
    if (!solve()) puts("No");
    else{
        puts("Yes");
        for (int i=0;i<m;i++)   if (s[fv[i]] && t[ev[i]])
            printf("%d\n",d[ev[i]]-d[fv[i]]);
        else puts("1");
    }
    return 0;
}
