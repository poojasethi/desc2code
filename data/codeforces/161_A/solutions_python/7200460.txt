n,m,x,y = [int(c) for c in raw_input().split()]
A = [int(c) for c in raw_input().split()]
B = [int(c) for c in raw_input().split()]
A = list(enumerate(A,1))
B = list(enumerate(B,1))
A.sort(key=lambda x:x[1])
B.sort(key=lambda x:x[1])
ar = []
i,j = 0,0
while i < n and j < m:
	ia,a = A[i]
	ib,b = B[j]
	if a-x<=b<=a+y:
		ar.append([ia,ib])
		i,j = i+1,j+1
	elif a-x>b:
		j += 1
	else:
		i += 1
print len(ar)
print '\n'.join(' '.join(map(str,x)) for x in ar)