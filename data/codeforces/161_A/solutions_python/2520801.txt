n, m, x, y = map(int, raw_input().split())
t = map(int, raw_input().split())
a = sorted((t[i], i + 1) for i in range(n))
t = sorted(map(int, raw_input().split()))
b = sorted((t[i], i + 1) for i in range(m))
c = []
i = 0
j = 0
while i < n and j < m:
	if b[j][0] < a[i][0] - x:
		j = j + 1
	elif a[i][0] + y < b[j][0]:
		i = i + 1
	else:
		c.append((a[i][1], b[j][1]))
		i = i + 1
		j = j + 1
print len(c)
print '\n'.join(' '.join(map(str, x)) for x in c)