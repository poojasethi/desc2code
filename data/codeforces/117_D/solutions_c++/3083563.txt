#include <iostream>

using namespace std;

typedef long long LL;

LL n,m,Mod,l,r,u,v;
LL calc(LL a,LL d,LL n,LL l,LL r)
{
	if ( v < a || u>a+d*(n-1))
        return 0;
    if (l==1 && r==n)
	{
		if (u<=a)
            l=1;
        else
            l=(u-a-1)/d+2;
		if (v>=a+d*(n-1))
            r=n;
        else
            r=(v-a)/d+1;
		LL x=a*2+(l+r-2)*d;
		LL y=r-l+1;
		if(x%2==0)
            x/=2;
        else
            y/=2;
		return ((x % Mod) * (y%Mod))%Mod;
	}
	LL mid=(n+1)/2;
	if (r<=mid)
        return calc(a,d*2,mid,l,r)% Mod;
	if (l>mid)
        return calc(a+d,d*2,n-mid,l-mid,r-mid)%Mod;
	return ( calc(a,d*2,mid,l,mid) + calc(a+d,d*2,n-mid,1,r-mid) )%Mod;
}
int main()
{
    cin >> n>>m>>Mod;
    for(int i=0;i<m;i++)
    {
        cin>>l>>r>>u>>v;
        cout<<calc(1,1,n,l,r)<<endl;
    }
    return 0;
}
