#include <cstdio>
#include <iostream>
using namespace std;

typedef long long LL;

LL n,x,mod,y,u,v,res;
int m;

LL query(LL l,LL r,LL a,LL d,LL x,LL y)
{
    if (a>v || a+(r-l)*d<u) return 0;
    if (l==x && r==y)
    {
    	LL le,la;
        if (u>a) le=((u-a-1)/d+1)*d+a;else le=a;
        la=min(((v-a)/d)*d+a,a+(r-l)*d);
        res=(res+(le+la)*((la-le)/d+1)/2 %mod)%mod;
        LL t1=le+la,t2=(la-le)/d+1;
        if (t1%2==0) t1/=2;else t2/=2;
        t1=t1%mod;t2=t2%mod;
		return t1*t2 %mod;
    }
    LL mid=(l+r)/2;
    if (x>mid) return query(mid+1,r,a+d,d+d,x,y);
    if (y<=mid) return query(l,mid,a,d+d,x,y);
    return (query(l,mid,a,d+d,x,mid)+query(mid+1,r,a+d,d+d,mid+1,y))%mod;
}

int main()
{
  //  freopen("in.txt","r",stdin);
    cin>>n>>m>>mod;
    for (int i=1;i<=m;i++)
    {
        cin>>x>>y>>u>>v;
        cout<<query(1,n,1,1,x,y)<<endl;
    }
    return 0;
}
