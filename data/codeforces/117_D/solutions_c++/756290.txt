#include <iostream>
using namespace std;
#define FOR(i,a,b) for (int i=a;i<=b;i++)

typedef long long LL;
LL n,m,l,r,u,v,MOD;

LL get(LL a,LL b,LL v){
        if (v<a) return 0;
        //cout<<a<<' '<<b<<' '<<v<<' ';
        LL n=(v-a)/b+1;
        //cout<<n<<' ';
        v=a+a+(n-1)*b;
        //cout<<v<<' ';
        if (!(n%2)) n=n/2;else v=v/2;
        v=v%MOD;n=n%MOD;
        //cout<<v*n<<endl;
        return v*n%MOD;
}

LL query(LL l,LL r,LL a,LL b,LL x,LL y){
        if (x>r||y<l) return 0;
        //cout<<l<<' '<<r<<' '<<a<<' '<<b<<endl;
        if (x<=l&&r<=y) return (get(a,b,v)-get(a,b,u-1))%MOD;
        LL mid=(l+r)>>1;
        return (query(l,mid,a,b+b,x,y)+query(mid+1,r,a+b,b+b,x,y))%MOD;
}

int main(){
        cin>>n>>m>>MOD;
        FOR(i,1,m){
                cin>>l>>r>>u>>v;
                if (v>n) v=n;
                if (u>v) cout<<0<<endl;else cout<<(query(1,n,1,1,l,r)+MOD)%MOD<<endl;
        }
}
