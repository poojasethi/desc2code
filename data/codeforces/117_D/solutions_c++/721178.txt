#include <cstdio>
#include <algorithm>
using namespace std;

long long n,m,mo,l,r,u,v;

long long cal(long long a,long long b,long long c) {
  a-=b;
  if (a<0) a=-1; else a=a>>c;
  long long B=b+a*(1ll<<c);
  long long s;
  if ((++a)&1) s=((B+b)/2%mo)*(a%mo);
          else s=((B+b)%mo)*(a/2%mo);
  return s%mo;
}

long long cal(long long ll,long long rr,long long c,int d) {
  if (u>n) return 0;
  long long ans=0;
  if (l>ll || r<rr) {
    long long m=(ll+rr)>>1;
    if (l<=m) ans+=cal(ll,m,c,d+1);
    if (r>m) ans+=cal(m+1,rr,c+(1ll<<d),d+1);
    if (ans>=mo) ans-=mo;
  } else {
    ans=cal(v,c,d)-cal(u-1,c,d);
    if (ans<0) ans+=mo;
  };
  return ans;
}

int main() {
  scanf("%I64d%I64d%I64d",&n,&m,&mo);
  while (m--) {
    scanf("%I64d%I64d%I64d%I64d",&l,&r,&u,&v);
    v=min(v,n);
    long long ans=cal(1,n,1,0);
    printf("%I64d\n",ans%mo);
  };
  return 0;
}
