#include<cstdio>
#include<cstdlib>
#include<cstring>
#define D puts("!");
typedef __int64 big;
big P,n,m,L,R,u,v;
big get(big up,big sx,big d)
{
   if(up<sx)return 0LL;
   big xs=(up-sx)/d+1LL;
   big mx=sx+d*xs-d;
   if(xs&1)return (((sx+mx)/2)%P)*(xs%P)%P;
   return ((sx+mx)%P)*(xs/2%P)%P;
}
big query(big l,big r,big sx,big d)
{
   if(u>n)return 0;
   if(l>=L&&r<=R)return (get(v,sx,1LL<<d)-get(u-1,sx,1LL<<d)+P)%P;
   big mid=l+r>>1;
   big ans=0;
   if(L<=mid)ans+=query(l,mid,sx,d+1);
   if(mid<R)ans+=query(mid+1,r,sx+(1LL<<d),d+1);
   return ans%P;
}
int main()
{
   scanf("%I64d%I64d%I64d",&n,&m,&P);
   while(m--)
   {
      scanf("%I64d%I64d%I64d%I64d",&L,&R,&u,&v);if(v>n)v=n;
      printf("%I64d\n",query(1LL,n,1LL,0LL));
   }
}
