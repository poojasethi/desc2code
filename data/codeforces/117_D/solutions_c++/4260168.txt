//In the name of God
#include <iostream>
using namespace std;

typedef long long ll;
typedef pair<ll, ll> pll;

ll mod, n;
int m;

pll func(ll b, ll e, ll l, ll r, ll u, ll v) {
	v = min(v, e - b);
	u = max(u, 0ll);
	if (v < u || e < l || r < b)
		return pll(0, 0);
	if (l <= b && e <= r) {
		ll x, y;
		if (v & 1)
			x = ((v + 1) / 2 % mod) * (v % mod) % mod;
		else
			x = (v / 2 % mod) * ((v + 1) % mod) % mod;
		if (u & 1)
			y = ((u - 1) / 2 % mod) * (u % mod) % mod;
		else
			y = (u / 2 % mod) * ((u - 1) % mod) % mod;
		return pll((x - y + mod) % mod, (v - u + 1) % mod);
	}
	ll m = b + e >> 1;
	pll x = func(b, m, l, r, u + (u & 1) >> 1, v >> 1);
	x.first *= 2;
	pll y = func(m + 1, e, l, r, u >> 1, v - (v & 1 ^ 1) >> 1);
	y.first = y.first * 2 + y.second;
	return pll((x.first + y.first) % mod, (x.second + y.second) % mod);
}
int main() {
	ios_base::sync_with_stdio(false);
	cin >> n >> m >> mod;
	while (m--) {
		ll l, r, u, v;
		cin >> l >> r >> u >> v;
		l--, r--, u--, v--;
		pll res = func(0, n - 1, l, r, u, v);
		cout << (res.first + res.second) % mod << '\n';
	}
	return 0;
}
