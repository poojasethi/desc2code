#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<string>
#include<cctype>
#include<algorithm>
#include<complex>
#include<vector>
#include<queue>
#include<set>
#include<map>

using namespace std;

typedef long long LL;

LL N, M, Mod, l, r, u, v, ans;

void Solve(LL nl, LL nr, LL first, LL d) {
     if (l <= nl && r >= nr) {
        LL t1 = max(u, first), t2 = min(v, first + (nr - nl) * d);
        if (t1 > t2) return;
        if ((t1 - first) % d) t1 += (d - (t1 - first) % d);
        if ((t2 - first) % d) t2 -= ((t2 - first) % d);
        if (t1 <= t2) ans = (ans + (t1 + t2) % Mod * (((t2 - t1) / d + 1) % Mod) % Mod) % Mod;
        return;
     }
     LL Mid = (nl + nr) >> 1;
     if (l <= Mid) Solve(nl, Mid, first, d * 2);
     if (r > Mid) Solve(Mid + 1, nr, first + d, d * 2);
}

int main() {

    scanf("%I64d%I64d%I64d", &N, &M, &Mod); Mod *= 2;
    while (M--) {
          ans = 0; scanf("%I64d%I64d%I64d%I64d", &l, &r, &u, &v);
          Solve(1, N, 1, 1);
          printf("%I64d\n", ans / 2);
    }

    return 0;

}
