#include <iostream>

#define lli long long int

using namespace std;

lli n,m,mod,u,v;

lli find( lli a,lli b,lli x ){
	lli t = (x+b)/a;
	if( t%2==0 )	return (t/2%mod*((t+1)%mod)%mod*(a%mod)%mod-t%mod*(b%mod)%mod+mod)%mod;
	else		return ((t+1)/2%mod*(t%mod)%mod*(a%mod)%mod-t%mod*(b%mod)%mod+mod)%mod;
}

lli query( lli bas,lli son,lli x,lli y,lli a,lli b ){
	if( son<x or y<bas )	return 0;
	if( x<=bas and son<=y )	return (find( a,b,v )-find( a,b,u-1 )+mod)%mod;
	lli orta=(bas+son)/2;
	return (query( bas,orta,x,y,a*2,a+b )+query( orta+1,son,x,y,a*2,b ))%mod;
}

int main(){

	ios_base::sync_with_stdio( false );

	cin >> n >> m >> mod;
	
	lli l,r;
	
	while( m-- ){
		cin >> l >> r >> u >> v;
		if( u>n ){
			cout << 0 << endl;
			continue;
		}
		v = min( v,n );
		cout << query( 1,n,l,r,1,0 ) << endl;
	}

}
