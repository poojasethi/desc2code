#include<stdio.h>
#include<string.h>
#include<algorithm>
using namespace std;
long long n,m,mod,l,r,u,v;
long long query( long long l,long long r,long long a,long long d,long long n ){
    if( l<=1&&r>=n ){
        long long s,t;
        if( a>v||( a+( n-1 )*d )<u ) return 0;
        if( a>=u ) s=1;
        else if( ( u-a )%d ) s=( u-a )/d+2;
        else s=( u-a )/d+1;
        if( ( a+( n-1 )*d )<=v ) t=n;
        else t=( v-a )/d+1;
        if( ( t-s+1 )%2 ) return ( ( 2*a+( s+t-2 )*d )/2%mod )*( (t-s+1)%mod );
        else return ( 2*a+( s+t-2 )*d%mod )*( ( t-s+1 )/2%mod );
    }
    long long mid=( n+1 )/2,ret=0;
    if( l<=mid ) ret+=query( l,min( mid,r ),a,2*d,mid );    
    if( r>mid ) ret+=query( max( mid+1,l )-mid,r-mid,a+d,2*d,n-mid );    
    return ret%mod;
}
int main( void ){
    scanf( "%I64d%I64d%I64d",&n,&m,&mod );
    for( int i=0;i<m;i++ ){        
        scanf( "%I64d%I64d%I64d%I64d",&l,&r,&u,&v );
        printf( "%I64d\n",query( l,r,1,1,n ) );
    }
}
