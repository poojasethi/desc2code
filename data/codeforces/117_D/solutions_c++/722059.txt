#include <iostream>
#include <cstdio>
using namespace std;
typedef long long ll;
int mod,Q;
ll  n,s,e,l,h;
inline int go (const ll &from , const ll &to , const ll &st , const ll &step){
    if (e<from || to<s)
        return 0;
    if (s<=from && to<=e){
        ll en  = st + ((n-st)/step) * step; 
        if (en<l || h<st)
            return 0;
        ll beg = (l<=st) ? st : st + ((l-st+step-1)/step)*step;
        ll fin = (en<=h) ? en : st + ((h-st)/step)*step;
        if (beg>fin)
            return 0;
        ll siz = ((fin-beg)/step + 1);
        ll sum=-1;
        if (siz%2==0)
            sum = (((siz/2)%mod) * ((siz-1)%mod))%mod;
        else
            sum = ((siz%mod) * ((siz/2)%mod))%mod;

        return (((beg%mod) * (siz%mod)) + (step%mod) * sum)%mod;
    }

    ll mid = (from+to)/2;
    return (go(from,mid,st,step<<1) + go(mid+1,to,st+step,step<<1))%mod;
}   

int main(){
    scanf ("%I64d%d%d" , &n , &Q , &mod);
    for (int i=1; i<=Q; i++){       
        scanf ("%I64d%I64d%I64d%I64d" , &s, &e, &l, &h);
        printf ("%d\n" , go(1,n,1,1));
    }
    return 0;
}