#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
int n,m,d00[4000010],d01[4000010],d10[4000010],d11[4000010],lazy[4000010];
char ch[10];
void update(int t){
    d10[t]=max(max(d10[t<<1],d11[t<<1])+d00[(t<<1)+1],d11[t<<1]+d10[(t<<1)+1]);
    d11[t]=d11[t<<1]+d11[(t<<1)+1];
    d01[t]=max(max(d01[t<<1],d00[t<<1])+d11[(t<<1)+1],d00[t<<1]+d01[(t<<1)+1]);
    d00[t]=d00[t<<1]+d00[(t<<1)+1];
}
void build(int t,int l,int r){
    if(l==r){
        char ch=getchar();
        while(ch!='4'&&ch!='7')ch=getchar();
        d01[t]=d00[t]=ch=='4';
        d10[t]=d11[t]=ch=='7';
        return;
    }
    int mid=(l+r)>>1;
    build(t<<1,l,mid);
    build((t<<1)+1,mid+1,r); 
    update(t);
}
void add(int t){
    swap(d00[t],d11[t]);
    swap(d10[t],d01[t]);
    lazy[t]^=1;
}
void change(int t,int l,int r,int x,int y){
    if(x<=l&&r<=y){
        add(t);
        return;
    }
    if(lazy[t]){
        add(t<<1);
        add((t<<1)+1);
        lazy[t]=0;
    }
    int mid=(l+r)>>1;
    if(x<=mid)change(t<<1,l,mid,x,y);
    if(y>mid)change((t<<1)+1,mid+1,r,x,y);
    update(t);
}
int main(){
    scanf("%d%d",&n,&m);
    build(1,1,n);
    for(int i=1,x,y;i<=m;++i){
        scanf("%s",ch);
        if(ch[0]=='c')printf("%d\n",max(d01[1],d11[1]));
        else{
            scanf("%d%d",&x,&y);
            change(1,1,n,x,y);
        }
    }
    return 0;
}
