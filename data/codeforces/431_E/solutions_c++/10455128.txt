#include <bits/stdc++.h>

#define fi first
#define se second
#define o ((b+e)/2)

using namespace std;

typedef long long int Lint;
typedef pair <Lint,Lint> ii;
Lint N,M,T[110000],ar[110000],cnt,memo[250000],K;
ii Q[110000],F[250000];
map <Lint,Lint> used;
vector <Lint> v;

void get_ans( Lint x ){
	int b=1,e=K;
	Lint sm=0,res=-1,sz=0;
	while( b <= e ){
		Lint sum=0;
		Lint size=0;
		for( int i=o ; i ; i-=(i&-i) ) sum+=F[i].fi,size+=F[i].se;
		//~ if( o == 1 && N==1e4 ) cout << sum << ' ' << memo[o]*size << ' ' << x << endl;
		if( memo[o]*size-sum <= x ){ res=o; b=o+1; sz=size; sm=sum;}
		else e=o-1;
	}
	x-=memo[res]*sz-sm;
	//~ if( N == 1e4 ) cout << res << ' ' << sz << ' ' << F[1].fi << ' ' << F[1].se*memo[1] << ' ' << b << ' ' << e << endl;
	printf("%.5lf\n",memo[res]+(double)x/sz);
}

int main(){
	
	cin >> N >> M;
	
	for( int i=1 ; i<=N ; i++ ) scanf(" %d",&ar[i]),v.push_back( ar[i] );
	
	for( int i=1,type,a,b ; i<=M ; i++ ){
		scanf(" %d",&type);
		if( type == 1 ){
			scanf(" %d %d",&a,&b);
			T[i]=1;
			Q[i]=ii( a , b );
			v.push_back( b );
		}else{
			Lint t;
			scanf(" %I64d",&t);
			Q[i]=ii( t , 0 );
		}
	}
	
	sort( v.begin() , v.end() );
	for( int i=0 , prev=-1 ; i<(int)v.size() ; i++ ) if( v[i] != prev ){ prev=v[i]; used[v[i]]=++cnt; memo[cnt]=v[i]; }
	K=cnt;
	for( int i=1 ; i<=N ; i++ ){
		ar[i]=used[ar[i]];
		for( int j=ar[i] ; j<=K ; j+=(j&-j) ) F[j]=ii( F[j].fi+memo[ar[i]] , F[j].se+1 );
	}
	
	for( int z=1 ; z<=M ; z++ ){
		int type=T[z];
		Lint a=Q[z].fi,b=Q[z].se;
		if( type == 1 ){
			b=used[b];
			Lint k=memo[ar[a]];
			for( int j=ar[a] ; j<=K ; j+=(j&-j) ) F[j]=ii( F[j].fi-k , F[j].se-1 );
			ar[a]=b; k=memo[b];
			for( int j=ar[a] ; j<=K ; j+=(j&-j) ) F[j]=ii( F[j].fi+k , F[j].se+1 );
		}else	get_ans( a );
	}
	
	
	
	return 0;
	
}
