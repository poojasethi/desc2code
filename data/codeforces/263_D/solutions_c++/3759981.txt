#include <cstdio>
#include <vector>
#include <algorithm>
using namespace std;

const int MAXN = 100000 + 86;

vector <int> e[MAXN];
vector <int> x;
bool v[MAXN], v0[MAXN], ok;

void dfs(int r) {
	if (ok) return;
	v[r] = true;	
	x.push_back(r);
	for (int i=0; i<e[r].size(); ++i) if (!v[e[r][i]]) dfs(e[r][i]);
	ok = true;
}

int main() {
	int n, m, k;

	scanf("%d%d%d", &n, &m, &k);
	for (int i=0,a,b; i<m; ++i) {
		scanf("%d%d", &a, &b), --a, --b;
		e[a].push_back(b), e[b].push_back(a);
	}
	dfs(0);
	for (int i=0,s=x.back(); i<e[s].size(); ++i) v0[e[s][i]] = true;
	for (int i=0; ; ++i) if (v0[x[i]]) {
		printf("%d\n", x.size()-i);
		for (int j=i; j<x.size(); ++j) printf("%d%s", x[j]+1, j==x.size()-1?"\n":" ");
		break;
	}

	return 0;
}
