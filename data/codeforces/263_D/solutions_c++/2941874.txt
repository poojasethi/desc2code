#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <vector>

#define MAXN 100002

using namespace std;

int N, M, K;
vector<int> ar[MAXN];
int visit[MAXN];
int dad[MAXN];

void found(int now, int dest)
{
	cout << now;
	if(now != dest)
	{
		cout << " ";
		found(dad[now], dest);
	}
	else
		cout << endl;
}

void dfs(int pos, int depth)
{
	visit[pos]=depth;
	int s= ar[pos].size(), adj;
	for(int i=0; i < s; i++)
	{
		adj= ar[pos][i];
		if(!visit[adj])
		{
			dad[adj]= pos;
			dfs(adj, depth+1);
		}
		else if(depth - visit[adj] + 1 >= K)
		{
			cout << depth - visit[adj] + 1 << endl;
			found(pos, adj);
			exit(0);
		}
	}
}

int main()
{
	int a, b;
	cin >> N >> M >> K;
	K++;
	for(int i=0; i < M; i++)
	{
		cin >> a >> b;
		ar[a].push_back(b);
		ar[b].push_back(a);
	}
	dad[1]= -1;
	dfs(1, 1);	
	return 0;
}