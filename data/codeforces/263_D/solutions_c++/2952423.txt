#include<iostream>
#include<vector>
using namespace std;
int n,m,k,x,y;
vector<int> a[100009];
int ans[100009],br,l2,used[100009],nom[100009];
void dfs(int vrah)
{
    used[vrah]=1;
    if(l2==1)return;
    br++;
    nom[vrah]=br;
    ans[br]=vrah;
    int l=0,mn=999999;
    for(int i=0;i<a[vrah].size();i++)
    {
        if(used[a[vrah][i]]==0)dfs(a[vrah][i]),l=1;
        else mn=min(mn,nom[a[vrah][i]]);
    }
    
    if(l2==1)return;
    cout<<br-mn+1<<endl;
    for(int i=mn;i<=br;i++)cout<<ans[i]<<" ";
    cout<<endl;
    l2=1;
}
int main()
{
    cin>>n>>m>>k;
    for(int i=1;i<=m;i++)
    {
        cin>>x>>y;
        a[x].push_back(y);
        a[y].push_back(x);
    }
    dfs(1);
}