#include<iostream>
#include<cstring>
#include<cstdio>
#include<algorithm>
#include<vector>
using namespace std;
#define N 100010
#define pb push_back
vector<int>e[N];
int n,m,K,r;
bool vis[N];
int V[N];
bool f=1;
int dfs(int u,int k)
{
	V[u]=k;
	vis[u]=1;
	int t;
	for(int s=e[u].size(),i=0; i<s && f; i++)
		if( V[e[u][i]] ){
			if( k-V[e[u][i]] >= K ){
				printf("%d\n",k-V[e[u][i]]+1);
				printf("%d ",u);	f=0;
				return e[u][i];
			}
		}
		else if( !vis[e[u][i]] && (t=dfs(e[u][i],k+1)) ){
			printf("%d ",u);
			return u==t?0:t;
		}
	vis[u]=0;
	return 0;
}

int main()
{
	int i,j,u,v;
	scanf("%d%d%d",&n,&m,&K);
	while(m--){
		scanf("%d%d",&u,&v);
		e[u].pb(v);	e[v].pb(u);
	}
	dfs(1,1);
	return 0;
}
