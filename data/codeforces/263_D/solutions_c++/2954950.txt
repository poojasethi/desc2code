#include <iostream>
#include <vector>

#define rep(i,n) for(int i=0;i<n;i++)

using namespace std;

int n,m,k,t1,t2,p,i,j,cnt,ma,mv=10000000;
int f[100010];
vector<int> v[100010],c;

int main(){

  cin>>n>>m>>k;

  rep(ii,m){
    cin>>t1>>t2;t1--;t2--;
    v[t1].push_back(t2);
    v[t2].push_back(t1);
  }
  c.push_back(0); 
  f[0] = ++cnt; p = 0;

  while(1){

    for(i=0;i<v[p].size();i++){
      if(!f[v[p][i]])break;
    }
    if(i==v[p].size()){
      rep(i,v[p].size())mv = min(mv,f[v[p][i]]);
      mv--;
      cout<<c.size()-mv<<endl;
      for(int i=mv;i<c.size();i++)cout<<c[i]+1<<" ";
      cout<<endl;
      return 0;
    }
    else {
      p = v[p][i];
      c.push_back(p); f[p]=++cnt;
    }
  }
  

}