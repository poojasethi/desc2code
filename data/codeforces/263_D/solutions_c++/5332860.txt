#include <cstdio>
#include <vector>
using namespace std;
int main(void) {
  vector<int>g[100100];
  int n,m,k;
  scanf("%d%d%d",&n,&m,&k);
  for(int i=0,a,b;i<m&&2==scanf("%d%d",&a,&b);++i)g[a].push_back(b),g[b].push_back(a);
  int s[100100]={0,1},v[100100]={0,1};
  for(int u=0;;++u){
    int a=s[u];
    for(int i=g[a].size();i-->0;){
      int b=g[a][i];
      if(v[b]){
        if(u-v[b]>=k){
          printf("%d\n",u-v[b]+1);
          for(int j=v[b];j<=u;++j)printf("%d ",s[j]);
          return 0;
        }
      }
      else{
        s[v[b]=u+1]=b;
        break;
      }
    }
  }
}