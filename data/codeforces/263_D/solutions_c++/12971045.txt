//In the Name of God

#include<iostream>
#include<vector>
#include<cstdlib>

using namespace std;

const int maxn=100100;
int n,m,k;
int dis[maxn],d[maxn];
bool vis[maxn];
vector<int> g[maxn];

void dfs(int v)
{
  vis[v]=true;
  for(int i=0;i<g[v].size();i++)
    if(!vis[g[v][i]])
      dis[g[v][i]]=dis[v]+1,d[g[v][i]]=v,dfs(g[v][i]);
    else if(dis[v]-dis[g[v][i]]>=k)
      {
	cout<<dis[v]-dis[g[v][i]]+1<<endl;
	for(int x=v;x!=d[g[v][i]];x=d[x])
	  cout<<x<<" ";
	cout<<endl;
	exit(0);
      }
}

int main()
{
  cin>>n>>m>>k;
  for(int i=0,v,u;i<m;i++)
    {
      cin>>v>>u;
      g[v].push_back(u);
      g[u].push_back(v);
    }
  dfs(1);
  exit(0);
}
