#include <iostream>
#include <cstdio>
#include <vector>
using namespace std;

const int Maxn=100010;
int n,m,k;
int x,y,cnt;
vector <int> e[Maxn];
int vis[Maxn],rem[Maxn];

int dfs(int v)
{
    vis[v]=++cnt;
    rem[cnt]=v;
    for(int i=0; i<e[v].size(); i++)
        if(!vis[e[v][i]]) {dfs(e[v][i]);break;}
    return 0;
}

int main()
{
    scanf("%d %d %d",&n,&m,&k);
    for(int i=1; i<=m; i++)
    {
        scanf("%d %d",&x,&y);
        e[x].push_back(y);e[y].push_back(x);
    }
    dfs(1);
    int t=0x7fffffff;
    for(int i=0; i<e[rem[cnt]].size(); i++)
        t=min(t,vis[e[rem[cnt]][i]]);
    printf("%d\n",cnt-t+1);
    for(int i=t; i<=cnt; i++) printf("%d ",rem[i]);
    return 0;
}
