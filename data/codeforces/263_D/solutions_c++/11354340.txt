# include <bits/stdc++.h>

using namespace std;

const int maxn = 1e5 + 10;
int n, m, k;
int mark[maxn];
int h[maxn];
bool f;
vector <pair<int,int> > c;
vector <int> adj[maxn];

void dfs(int v){
	mark[v] = 1;
	for(int i=0 ; i<adj[v].size() ; i++){
		int u = adj[v][i];
		if(!f && mark[u]==1 && h[v] - h[u] >= k){
			for(int j=1 ; j<=n ; j++)
				if(h[j] >= h[u] && mark[j] == 1)
					c.push_back(make_pair(h[j] , j));
			f = 1;
		}
		if(!mark[u]){
			h[u] = h[v] + 1;
			dfs(u);
		}
	}
}

int main(){
	cin >> n >> m >> k;
	for(int i=0 ; i<m ; i++){
		int fi, se;
		cin >> fi >> se;
		adj[fi].push_back(se);
		adj[se].push_back(fi);
	}

	dfs(1);	

	sort(c.begin() , c.end());
	cout << c.size() << endl;
	for(int i=0 ; i<c.size() ; i++)
		cout << c[i].second <<" ";
	cout << endl;

	return 0;
}
