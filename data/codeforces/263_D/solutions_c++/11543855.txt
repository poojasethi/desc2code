#include<iostream>
#include<math.h>
#include<algorithm>
#include<stdio.h>
#include<map>
#include<vector>
#include<set>
#include<iomanip>
#define F first
#define S second
#define P system("PAUSE");
#define H return 0;
#define pb push_back
using namespace std;
const long long A=100000000000000LL,N=228228;

vector<long long> a[N],o;
long long x,y,t,e=A,k,p,i,j,n,m,d[N];

void rec(long long v){
	t++,o.pb(v),d[v]=t;
	int ok=0;
	for(int i=0;i<a[v].size();i++)if(!d[a[v][i]] && !ok)rec(a[v][i]),ok=1;
	if(!ok)for(int i=0;i<a[v].size();i++)e=min(e,d[a[v][i]]);
}

int main(){
	cin>>n>>m>>k;
	while(m--)scanf("%d%d",&x,&y),x--,y--,a[x].pb(y),a[y].pb(x);
	rec(0);
	while(d[o[p]]!=e)p++;	
	cout<<o.size()-p<<"\n";
	for(i=p;i<o.size();i++)cout<<o[i]+1<<" ";
}
