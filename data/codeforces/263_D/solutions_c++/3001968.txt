#include <iostream>
#include <vector>

using namespace std;

vector <int> a[100100], f;
int n, m, k, p[100100] = {}, x1, x2;

int main(){
    cin >> n >> m >> k;
    while (m--){
        cin >> x1 >> x2;
        a[--x1].push_back(--x2);
        a[x2].push_back(x1);
    }

    f.push_back(0); p[0] = 1;
    for (int u = 2; ; u++){
        int v = f[f.size() - 1], r = a[v][0];
        for (int i = 1; i < a[v].size(); i++)
            if (p[a[v][i]] < p[r]) r = a[v][i];
        if (p[r]) {
            r = p[r] - 1;
            cout << f.size() - r << endl;
            for (; r < f.size(); r++) cout << f[r] + 1 << " ";
            return 0;
        } else {
            f.push_back(r); p[r] = u;
        }
    }
}
