#include<bits/stdc++.h>
using namespace std;
int n,m,k;
#define vi vector<int> 
#define vii vector<vi >

vii es;

const int maxm = 100005;
int perm[maxm], g[maxm];

void dfs(int v, int cur) {
	perm[cur]=v;
	g[v]=cur;
	for(int it=0;it < es[v].size();it++) {
		int u = es[v][it];
		if(g[u]==-1) {
			dfs(u,cur+1);
			return;
		}
		if(cur-g[u]>=k) {
			printf("%d\n",cur-g[u]+1);
			for(int i=g[u];i<=cur;i++)
				printf("%d ",perm[i]+1);
			printf("\n");
			return;
		}
	}
}

int main() {
	cin >> n >> m >> k;
	es = vii(n);
	for(int i=0;i<m;i++) {
		int s,t;
		scanf("%d %d",&s,&t);
		--s,--t;
		es[s].push_back(t);
		es[t].push_back(s);
	}
	memset(g,-1,sizeof(g[0])*n);
	dfs(0,0);
	return 0;
}	
