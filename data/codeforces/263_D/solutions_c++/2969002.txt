#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <vector>
#include <string.h>
using namespace std;
#define N 100005


	int
main ( )
{
	vector<int>adj[N];
	int v[N] = {0,1};
	int s[N] = {0,1};

	int i,len,m,n,k,x,y,u=0;
	scanf("%d%d%d",&n,&m,&k);
	for(i=0;i<m;++i) {
		scanf("%d%d",&x,&y);
		adj[x].push_back(y);
		adj[y].push_back(x);
	}
	
	for(u=0;;u++) {
		int a = s[u];
		for(i=0,len = adj[a].size(); i < len;++i) {
			int b = adj[a][i];
			if(v[b]) {
				if(u-v[b] >= k) {
					printf("%d\n",u - v[b] + 1);
					for(int j=v[b];j<=u;++j) printf("%d ",s[j]);
					return 0;
				}
			} else {
				s[v[b]=u+1] = b;
				break;
			}
		}
	}

	return 0;
}		 		/* ----------  end of function main  ---------- */
 		/* ----------  end of function main  ---------- */
