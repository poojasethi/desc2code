#include <cstdlib>
#include <iostream>
#include <fstream>
#include <vector>
#pragma comment(linker, "/STACK:8000000") 

using namespace std;

vector < vector<int> > a(100005);

int w,t,i,n,m,k,st[100005],p[100005];
bool ok;

void dfs(int v,int dp)
{
 int i,j;
 st[v]=dp;
 p[0]++;
 p[p[0]]=v;
 for (i=0;i<a[v].size();i++)
 { 
	if (ok) break;
	if (st[a[v][i]]==0) dfs(a[v][i],dp+1); else
	if (dp-st[a[v][i]]+1>k)
	{
		ok=true;
		printf("%d\n",dp-st[a[v][i]]+1);
		for (j=st[a[v][i]];j<=dp;j++) printf("%d ",p[j]);
		}
	if (ok) break;
 }
 st[v]=0;
 p[0]--;
}


int main()
{
 scanf("%d %d %d",&n, &m, &k);
 for (i=1;i<=m;i++)
 {
	scanf("%d %d", &w, &t);
	a[w].push_back(t);
	a[t].push_back(w);
}
 //cout<<h<<"!!! "<<t<<endl;
 ok=false;
 p[0]=0;
 dfs(1,1); 
}
