#include<cstdio>
#include<vector>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

int main(){
	int n,m,k; scanf("%d%d%d",&n,&m,&k);
	static vector<int> G[100000];
	rep(i,m){
		int u,v; scanf("%d%d",&u,&v); u--; v--;
		G[u].push_back(v);
		G[v].push_back(u);
	}

	static int seq[100000],inv[100000];
	rep(u,n) inv[u]=-1;
	inv[0]=0;
	int u=0;
	for(int t=1;;t++){
		rep(i,G[u].size()){
			int v=G[u][i];
			if(inv[v]!=-1){
				int len=t-inv[v];
				if(len>=k+1){
					printf("%d\n",len);
					for(int j=inv[v];j<t;j++) printf("%d ",seq[j]+1);
					return 0;
				}
			}
			else{
				seq[t]=u=v;
				inv[v]=t;
				break;
			}
		}
	}

	return 0;
}
