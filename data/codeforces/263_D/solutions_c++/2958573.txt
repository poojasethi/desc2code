#define X 100010
#include<stdio.h>
#include<iostream>
#include<vector>
using namespace std;
typedef vector<int> E;
E e[X],as;
bool f[X];
int dfs(int a){
	int i,n;
	n=e[a].size();
	for(i=0;i<n;i++)
	    if(!f[e[a][i]]){
	        f[e[a][i]]=1;
	        as.push_back(e[a][i]);
			return dfs(e[a][i]);
		}
	return a;
}
int main(){
	int i,j,n,m,k,a,b,u;
	scanf("%d%d%d",&n,&m,&k);
	for(i=0;i<m;i++){
	    scanf("%d%d",&a,&b);
	    e[a].push_back(b);
	    e[b].push_back(a);
	}
	as.push_back(1);
	f[0]=f[1]=1;
	u=dfs(1);
	for(i=1;i<=n;i++)f[i]=0;
	n=e[u].size();
	for(i=0;i<n;i++)f[e[u][i]]=1;
	n=as.size();
	for(i=0;i<n;i++)if(f[as[i]])break;
	printf("%d\n",n-i);
	for(;i<n;i++)
	    printf("%d ",as[i]);
	puts("");
	return 0;
}
