# include <vector>
# include <stdio.h>
# include <algorithm>

using namespace std;

int a,b,c,x,y,an,tp;

int vs[100009];

vector<vector<int> >v(100009);

void kel(int z)
{
//	printf("\n%d %d",z,vs[z]);
	
	
	for(int i=0;i<(int)v[z].size();i++)
	{
		if(vs[v[z][i]]==0)
		{vs[v[z][i]]=vs[z]+1; kel(v[z][i]);}
		
		else if(vs[z]-vs[v[z][i]]>=c && vs[v[z][i]]>0)
		{printf("%d\n%d ",vs[z]-vs[v[z][i]]+1,z);tp=1;an=v[z][i];return;}
		
		if(z==an)
		{printf("%d",z);exit(0);}
		
		if(tp==1)
		{printf("%d ",z);return;}
	}
}

int main()
{
	scanf("%d %d %d",&a,&b,&c);
	
	for(int i=0;i<b;i++)
	{
		scanf("%d %d",&x,&y);
		
		v[x].push_back(y);
		v[y].push_back(x);
	}
/*	
	for(int i=1;i<=a;i++)
	{
		printf("\n");
		
		for(int j=0;j<(int)v[i].size();j++)
		printf("%d ",v[i][j]);
	}
*/	
	vs[1]=1;
	kel(1);
	
	getchar();
	getchar();
}
