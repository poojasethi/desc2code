#include<iostream>
#include<math.h>
#include<algorithm>
#include<stdio.h>
#include<map>
#include<vector>
#include<set>
#define F first
#define S second
#define P system("PAUSE");
#define H return 0;
#define pb push_back
using namespace std;
const long long A=100000000000000LL,N=1228;

long long r,o=A,i,j,n,m,k,a[N][N];

long long check(long long v){
	long long i,j,k=0,_k;
	for(j=0;j<m;j++){
		_k=0;
		for(i=0;i<n;i++)_k+=a[i][v]==a[i][j];
		k+=min(_k,n-_k);
	}
	return k;		
}

void rec(long long v){
	if(v==n){
		o=min(o,check(m));
		return;
	}
	a[v][m]=1,rec(v+1);
	a[v][m]=0,rec(v+1);
}

int main(){
	cin>>n>>m>>r;
	for(i=0;i<n;i++)for(j=0;j<m;j++)cin>>a[i][j];
	if(n>r){
		for(j=0;j<m;j++)o=min(o,check(j));	
	}else rec(0);
	if(o>r)cout<<-1;else cout<<o;
}
