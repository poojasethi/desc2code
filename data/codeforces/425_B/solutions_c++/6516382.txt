//gskhirtladze

#include<iostream>
#include<stdio.h>

using namespace std;

int n,m,k,i,j,q,a[240][240];
int now,a1,a2,bit,ans;
int c[12];

void put(int ans)
 { if (ans > k) ans=-1; cout<<ans<<endl; }
main()
 {
  cin>>n>>m>>k;
  for (i=1;i<=n;i++)
   for (j=1;j<=m;j++)
    cin>>a[i][j];
  ans=k+1;
  for (i=1;i<=n;i++,ans=min(ans,now),now=0)
   for (j=1;j<=n;j++,now+=min(a1,a2),a1=a2=0)
    for (q=1;q<=m;q++)
     if (a[i][q] != a[j][q])  a1++; else a2++;
  for (i=1;i<=m;i++,ans=min(ans,now),now=0)
   for (q=1;q<=m;q++,now+=min(a1,a2),a1=a2=0)
    for (j=1;j<=n;j++)
     if (a[j][i] != a[j][q])  a1++; else a2++;
  if (n > k || m > k) { put(ans); return 0; }
  for (bit=0;bit<(1<<m);bit++,ans=min(ans,now),now=0)
   {
    for (i=0;i<m;i++)
     c[i+1]=((bit&(1<<i))>0),now+=(c[i+1] != a[1][i+1]);
    for (j=2;j<=n;j++,now+=min(a1,a2),a1=a2=0)
     for (q=1;q<=m;q++)
      if (c[q] != a[j][q])  a1++; else a2++;
   }
  put(ans);
 } 
