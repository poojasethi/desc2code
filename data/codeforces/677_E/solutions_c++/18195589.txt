#include<bits/stdc++.h>

using namespace std;

#define pii pair<int,int>
#define ll long long
#define N (int)(1e5+10)
#define mod 1000000007
#define mp make_pair
#define pb push_back
#define nd second
#define st first
#define inf mod
#define endl '\n'
#define sag (sol|1)
#define sol (root<<1)
#define ort ((bas+son)>>1)
#define bit(x,y) ((x>>y)&1)

vector< pii > v;
int i,j,k,n,m,x,y,z;
char a[1005][1005];
int H[2005][2005],l;
int A[1005][1005][3][9];
int yon[8][2] = {0,-1,-1,-1 ,-1,0 ,-1,1 ,0,1 ,1,1 ,1,0 ,1,-1};

bool cmp(pii x, pii y){
	int t1 = min(x.st,y.st);
	x.st -= t1; y.st -= t1;
	int t2 = min(x.nd,y.nd);
	x.nd -= t2; y.nd -= t2;
	if(!y.st and !y.nd)
		return 0;

	if(!x.st and !x.nd)
		return 1;

	if(x.st and y.nd)
		return H[y.nd][x.st];
	return !H[x.nd][y.st];
}

int main(){
	cin >> n;

	int p = 0;

	for(i=1 ; i<=n ; i++)
		for(j=1 ; j<=n ; j++){
			scanf(" %c",&a[i][j]);
			p |= a[i][j]-'0';
			if(a[i][j] != '0'){
				for(k=0 ; k<3 ; k++){
					A[i][j][0][k] += A[i+yon[k][0]][j+yon[k][1]][0][k]+(a[i][j]=='2');
					A[i][j][1][k] += A[i+yon[k][0]][j+yon[k][1]][1][k]+(a[i][j]=='3');
					A[i][j][2][k] += A[i+yon[k][0]][j+yon[k][1]][2][k]+(a[i][j]=='1');
				}
			}
		}
	
	if(!p){
		puts("0");
		return 0;
	}

	for(i=1 ; i<=n ; i++)
		for(j=n ; j>=1 ; j--){
			if(a[i][j] != '0'){
				for(k=3 ; k<5 ; k++){
					A[i][j][0][k] += A[i+yon[k][0]][j+yon[k][1]][0][k]+(a[i][j]=='2');
					A[i][j][1][k] += A[i+yon[k][0]][j+yon[k][1]][1][k]+(a[i][j]=='3');
					A[i][j][2][k] += A[i+yon[k][0]][j+yon[k][1]][2][k]+(a[i][j]=='1');
				}
			}
		}

	for(i=n ; i>=1 ; i--)
		for(j=n ; j>=1 ; j--){
			if(a[i][j] != '0'){
				for(k=5 ; k<6 ; k++){
					A[i][j][0][k] += A[i+yon[k][0]][j+yon[k][1]][0][k]+(a[i][j]=='2');
					A[i][j][1][k] += A[i+yon[k][0]][j+yon[k][1]][1][k]+(a[i][j]=='3');
					A[i][j][2][k] += A[i+yon[k][0]][j+yon[k][1]][2][k]+(a[i][j]=='1');
				}
			}
		}

	for(i=n ; i>=1 ; i--)
		for(j=1 ; j<=n ; j++){
			if(a[i][j] != '0'){
				for(k=6 ; k<8 ; k++){
					A[i][j][2][k] += A[i+yon[k][0]][j+yon[k][1]][2][k]+(a[i][j]=='1');
					A[i][j][0][k] += A[i+yon[k][0]][j+yon[k][1]][0][k]+(a[i][j]=='2');
					A[i][j][1][k] += A[i+yon[k][0]][j+yon[k][1]][1][k]+(a[i][j]=='3');
				}
			}
		}

	pii t;

	for(i=1 ; i<=n ; i++)
		for(j=1 ; j<=n ; j++){
			if(a[i][j]=='0')
				continue;
			int mn = inf;
			t = mp(0,0);
			t.st -= (a[i][j] == '2')*3;
			t.nd -= (a[i][j] == '3')*3;
			for(k=0 ; k<8 ; k+=2)
				mn = min(mn,A[i][j][0][k] + A[i][j][1][k] + A[i][j][2][k]);
			for(k=0 ; k<8 ; k+=2){
				t.st += A[i][j][0][k] - A[i+mn*yon[k][0]][j+mn*yon[k][1]][0][k];
				t.nd += A[i][j][1][k] - A[i+mn*yon[k][0]][j+mn*yon[k][1]][1][k];
			}
			v.pb(t);
			t = mp(0,0);
			t.st -= (a[i][j] == '2')*3;
			t.nd -= (a[i][j] == '3')*3;
			mn = inf;
			for(k=1 ; k<8 ; k+=2)
				mn = min(mn,A[i][j][0][k] + A[i][j][1][k] + A[i][j][2][k]);
			for(k=1 ; k<8 ; k+=2){
				t.st += A[i][j][0][k] - A[i+mn*yon[k][0]][j+mn*yon[k][1]][0][k];
				t.nd += A[i][j][1][k] - A[i+mn*yon[k][0]][j+mn*yon[k][1]][1][k];
			}
			v.pb(t);
		}

	double l=0;
	ll ans = 1;
	for(i=1 ; i<=2000 ; i++){
		l += log2(3);
		for(j=0 ; j<=min((int)l,2000) ; j++)
			H[i][j] = 1;
	}

	sort(v.begin(),v.end(),cmp);

	t = v.back();

	for(i=0 ; i<t.st ; i++)
		ans = ans*2%mod;
	for(i=0 ; i<t.nd ; i++)
		ans = ans*3%mod;

	cout << ans << endl;

}
