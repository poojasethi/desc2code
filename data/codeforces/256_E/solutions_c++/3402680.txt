#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
typedef long long ll;
const int mm=777777777;
struct segnode{
	int l,r,ls,rs;
	ll v[3][3];
}t[200001];
bool a[3][3];
int i,j,k,n,m,tot;
void update(int p){
	memset(t[p].v,0,sizeof(t[p].v));
	for (int i=0;i<3;i++)
	 for (int j=0;j<3;j++)
	  for (int k=0;k<3;k++)
	   for (int l=0;l<3;l++)
		if (a[k][l]) t[p].v[i][j]+=t[t[p].ls].v[i][k]*t[t[p].rs].v[l][j],t[p].v[i][j]%=mm;
}
void mt(int l,int r){
	int p=++tot;t[p].l=l;t[p].r=r;
	if (l<r){
		int m=(l+r)>>1;
		t[p].ls=tot+1;mt(l,m);
		t[p].rs=tot+1;mt(m+1,r);
		update(p);
	}else{
		memset(t[p].v,0,sizeof(t[p].v));
		for (int i=0;i<3;i++) t[p].v[i][i]=1;
		t[p].ls=t[p].rs=0;
	}
}
void change(int p,int x,int d){
	if (!t[p].ls){
		memset(t[p].v,0,sizeof(t[p].v));
		if (d) t[p].v[d-1][d-1]=1;else for (int i=0;i<3;i++) t[p].v[i][i]=1;
		return;
	}
	int m=(t[p].l+t[p].r)>>1;
	change(x<=m?t[p].ls:t[p].rs,x,d);
	update(p);
}
int query(){
	ll res=0;
	for (int i=0;i<3;i++)
	 for (int j=0;j<3;j++) res+=t[1].v[i][j],res%=mm;
	return res;
}
int main(){
	scanf("%d%d",&n,&m);tot=0;
	for (i=0;i<3;i++)
	 for (j=0;j<3;j++) scanf("%d",&k),a[i][j]=k==1;
	mt(1,n);
	for (i=1;i<=m;i++){
		scanf("%d%d",&j,&k);change(1,j,k);
		printf("%d\n",query());
	}
	return 0;
}
