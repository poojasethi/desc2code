#include<cstdio>
#include<algorithm>
#include<map>
#include<cstring>
#include<vector>
#include<cmath>
#include<iostream>
#include<string>
#define N 1000010
#define M 1010
#define P 777777777
using namespace std;
int l[N],r[N],f[5][5],ans;
long long s[N][4][4];
int n,m,a,b,i,j,k;
void updata(int x)
{
	int i,j,k,l;
	for (i=1;i<=3;i++)
	for (j=1;j<=3;j++)
	s[x][i][j]=0;
	
	for (i=1;i<=3;i++)
	for (l=1;l<=3;l++)
	for (j=1;j<=3;j++)
	for (k=1;k<=3;k++)
	if (f[j][k])
	s[x][i][l]=(s[x][i][l]+s[2*x][i][j]*s[2*x+1][k][l])%P;
}
void build(int x,int a,int b)
{
	int m,i;
	l[x]=a;r[x]=b;
	if (b-a>1)
	{
		m=(a+b)>>1;
		build(2*x,a,m);
		build(2*x+1,m,b);
		updata(x);
	}
	else
	{
		for (i=1;i<=3;i++)
		s[x][i][i]=1;
	}
}
void change(int x,int a,int b,int c)
{
	int i,j;
	if ((a<=l[x])&&(r[x]<=b))
	{
		for (i=1;i<=3;i++)
		for (j=1;j<=3;j++)
		s[x][i][j]=0;
		if (c==0)
		for (i=1;i<=3;i++)
		s[x][i][i]=1;
		else
		s[x][c][c]=1;
		return;
	}
	int m=(l[x]+r[x])>>1;
	if (a<m) change(2*x,a,b,c);
	if (m<b) change(2*x+1,a,b,c);
	updata(x);
}
int main()
{
	cin>>n>>m;
	for (i=1;i<=3;i++)
	for (j=1;j<=3;j++)
	cin>>f[i][j];
	build(1,0,n);
		ans=0;
		for (j=1;j<=3;j++)
		for (k=1;k<=3;k++)
		ans=(ans+s[1][j][k])%P;

	for (i=1;i<=m;i++)
	{
		cin>>a>>b;
		change(1,a-1,a,b);
		ans=0;
		for (j=1;j<=3;j++)
		for (k=1;k<=3;k++)
		ans=(ans+s[1][j][k])%P;
		printf("%d\n",ans);
	}
} 
	 	 	   						 	  	   	 	 	 	 	