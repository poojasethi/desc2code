#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cmath>
#include <iostream>
#include <algorithm>
#include <vector>
#include <queue>
#include <set>
#include <map>
using namespace std;
typedef long long ll;
typedef double db;
typedef pair<int,int> pii;
#define y1 y1_

const int mo=777777777,inf=(int)1e9;
const ll linf=(ll)1e18;
int n,m,X,D,w[4][4],t[77777*4][4][4];
void build(int cur,int beg,int end){
	if(end-beg==1){
		for(int x=1;x<=3;x++)
			t[cur][x][x]=1;
		return;
	}
	int mid=beg+end>>1;
	build(cur<<1,beg,mid);
	build(cur<<1|1,mid,end);
	for(int a=1;a<=3;a++)
		for(int b=1;b<=3;b++)
			for(int x=1;x<=3;x++) if(w[b][x])
				for(int y=1;y<=3;y++)
					(t[cur][a][y]+=1LL*t[cur<<1][a][b]*t[cur<<1|1][x][y]%mo)%=mo;
}
void modify(int cur,int beg,int end){
	if(end-beg==1){
		for(int x=1;x<=3;x++)
			for(int y=1;y<=3;y++)
				t[cur][x][y]=(D?x==D&&y==D:x==y);
		return;
	}
	int mid=beg+end>>1;
	if(X<=mid)
		modify(cur<<1,beg,mid);
	else
		modify(cur<<1|1,mid,end);
	for(int a=1;a<=3;a++)
		for(int y=1;y<=3;y++){
			t[cur][a][y]=0;
			for(int b=1;b<=3;b++)
				for(int x=1;x<=3;x++) if(w[b][x])
					(t[cur][a][y]+=1LL*t[cur<<1][a][b]*t[cur<<1|1][x][y]%mo)%=mo;
		}
}
int main(){
	scanf("%d%d",&n,&m);
	for(int a=1;a<=3;a++)
		for(int b=1;b<=3;b++)
			scanf("%d",&w[a][b]);
	build(1,0,n);
	while(m--){
		scanf("%d%d",&X,&D);
		modify(1,0,n);
		int ans=0;
		for(int x=1;x<=3;x++)
			for(int y=1;y<=3;y++)
				(ans+=t[1][x][y])%=mo;
		printf("%d\n",ans);
	}
	scanf("\n");
}
