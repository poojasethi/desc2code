// by Î¾

#include <cctype>
#include <cstdio>

#define o c=getchar()
#define rep(i) for(long long i=1;i<=3;++i)

using namespace std;

long long n,Q,T,W,lastans,leaf[77779],t[77779*4][4][4],F[4][4];

inline void in(long long &x){
    char c;while(!isdigit(o));for(x=0;isdigit(c);o)x=x*10-48+c;
}

inline void update(long long u){
    long long v=u<<1,w=u<<1|1;
    rep(i)rep(j)t[u][i][j]=0;
    rep(i)rep(j)if(t[v][i][j])rep(k)if(F[j][k])rep(p)if(t[w][k][p])
    (t[u][i][p]+=t[v][i][j]*t[w][k][p])%=777777777;
}

void build(long long u,long long l,long long r){
    if(l==r){
        leaf[l]=u;
        rep(i)t[u][i][i]=1;
        return;
    }
    long long mid=l+r>>1;
    build(u<<1,l,mid);
    build(u<<1|1,mid+1,r);
    update(u);
}

int main(){
    in(n);in(Q);
    for(long long i=1;i<=3;++i)for(long long j=1;j<=3;++j)in(F[i][j]);
    build(1,1,n);
    while(Q--){
        in(T);in(W);
        T=leaf[T];
        if(W){
            rep(i)rep(j)t[T][i][j]=0;
            t[T][W][W]=1;
        }else rep(i)t[T][i][i]=1;
        for(T>>=1;T;T>>=1)update(T);
        lastans=0;
        rep(i)rep(j)(lastans+=t[1][i][j])%=777777777;
        printf("%I64d\n",lastans);
    }
}