#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
using namespace std;
#define mod 777777777
#define N 77780
#define lc (now<<1)
#define rc ((now<<1|1))
#define rep(i,u,v) for (int i=(u);i<=(v);i++)
struct node{
    int l,r;
    long long a[4][4];
}t[4*N];
int n,m;
int ok[4][4];
void updata(int now){
    rep(i,1,3)
        rep(j,1,3){
            t[now].a[i][j]=0;
            rep(c,1,3)
                rep(r,1,3){
                    if (!ok[c][r])continue;
                    t[now].a[i][j]=(t[now].a[i][j]+t[lc].a[i][c]*t[rc].a[r][j])%mod;
                }
        }
}
void bt(int now,int l,int r){
    t[now].l=l;t[now].r=r;
    if (l==r){
        memset(t[now].a,0,sizeof(t[now].a));
        rep(i,1,3)t[now].a[i][i]=1;
        return;
    }
    int mid=(l+r)>>1;
    bt(lc,l,mid);bt(rc,mid+1,r);
    updata(now);
}
void change(int now,int ed,int d){
    if (t[now].l==ed&&t[now].r==ed){
        memset(t[now].a,0,sizeof(t[now].a));
        if (!d){
            rep(i,1,3)t[now].a[i][i]=1;
        }
        else t[now].a[d][d]=1;
        return;
    }
    int mid=(t[now].l+t[now].r)>>1;
    if (ed<=mid)change(lc,ed,d);
    else change(rc,ed,d);
    updata(now);
}
int main(){
    scanf("%d%d",&n,&m);
    rep(i,1,3)
        rep(j,1,3)
            scanf("%d",&ok[i][j]);
    bt(1,1,n);
    int x,d;
    while (m--){
        cin>>x>>d;
        change(1,x,d);
        long long ans=0;
        rep(i,1,3)
            rep(j,1,3)
                ans=(ans+t[1].a[i][j])%mod;
        cout<<ans<<endl;
    }
}