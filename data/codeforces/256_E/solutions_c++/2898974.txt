#include<cstdio>
#include<cstring>
#define fo(i,a,b) for(i=a;i<=b;++i)
const int mn=101000,mo=777777777;
int f[mn*4][3][3],n,Q;
int O[3][3];
void clr(int c[][3],int v)
{
    memset(c,0,36);
    if(v!=-1)c[v][v]=1;
    else c[0][0]=c[1][1]=c[2][2]=1;
}
void mul(int a[][3],int b[][3],int c[][3])
{
    int i,j,u,v;
    long long res;
    fo(i,0,2)
        fo(j,0,2)
        {
            res=0;
            fo(u,0,2)
                fo(v,0,2)
                    if(O[u][v])res+=(long long)a[i][u]*b[v][j];
            c[i][j]=res%mo;
        }
}
void build(int p,int l,int r)
{
    if(l==r)
    {
        clr(f[p],-1);
        return;
    }
    int m=(l+r)/2;
    build(p+p,l,m);
    build(p+p+1,m+1,r);
    mul(f[p+p],f[p+p+1],f[p]);
}
void add(int p,int l,int r,int k,int v)
{
    if(l==r)
    {
        clr(f[p],v);
        return;
    }
    int m=(l+r)/2;
    if(k<=m)add(p+p,l,m,k,v);
    else add(p+p+1,m+1,r,k,v);
    mul(f[p+p],f[p+p+1],f[p]);
}
int main()
{
    scanf("%d%d",&n,&Q);
    int i,j,k,ans;
    fo(i,0,2)
        fo(j,0,2)
            scanf("%d",O[i]+j);
    build(1,1,n);
    while(Q--)
    {
        scanf("%d%d",&i,&j);
        add(1,1,n,i,j-1);
        ans=0;
        fo(i,0,2)
            fo(j,0,2)
                ans=(ans+f[1][i][j])%mo;
        printf("%d\n",ans);
    }
    return 0;
}