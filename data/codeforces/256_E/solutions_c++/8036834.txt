#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 100000
#define mo 777777777
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int a[4][4];
} tr[N*4];
int i,j,k,n,m,x,y;
int a[10][10];
inline void update(int x) {
	int y=x*2,z=x*2+1,i,j,k,u;
	For(i,1,3)For(j,1,3) tr[x].a[i][j]=0;
	For(i,1,3)For(j,1,3)For(u,1,3) if (a[j][u]) For(k,1,3)
		tr[x].a[i][k]=(1ll*tr[y].a[i][j]*tr[z].a[u][k]+tr[x].a[i][k])%mo;
}
void build(int q,int x,int y) {
	if (x==y) {
		int i;
		For(i,1,3) tr[q].a[i][i]=1;
		return;
	}
	int mid=(x+y)/2;
	build(q*2,x,mid);
	build(q*2+1,mid+1,y);
	update(q);
}
void change(int q,int x,int y,int k,int t) {
	if (x==y) {
		int i;
		if (!t) For(i,1,3) tr[q].a[i][i]=1;
		else {
			For(i,1,3) tr[q].a[i][i]=0;
			tr[q].a[t][t]=1;
		}
		return;
	}
	int mid=(x+y)/2;
	if (k<=mid) change(q*2,x,mid,k,t);
	else change(q*2+1,mid+1,y,k,t);
	update(q);
}
int main() {
	scanf("%d%d",&n,&m);
	For(i,1,3)For(j,1,3) scanf("%d",&a[i][j]);
	build(1,1,n);
	For(i,1,m) {
		scanf("%d%d",&x,&y);
		change(1,1,n,x,y);
		int an=0;
		For(j,1,3)For(k,1,3) an=(an+tr[1].a[j][k])%mo;
		printf("%d\n",an);
	}
	return 0;
}
