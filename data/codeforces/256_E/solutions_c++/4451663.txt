#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<cstring>
using namespace std;
const int mo=777777777;
int i,j,k,ans,t[77777*4][3][3],x,y,v[3][3],n,m;
void modify(int p,int x){
	if(!x)for(int i=0;i<=2;++i)t[p][i][i]=1;
	else for(int i=0;i<=2;++i)t[p][i][i]=(i+1==x);
}
void renew(int p){
	int x=p<<1,y=x+1,i,j,k,l;
	for(i=0;i<=2;++i)
		for(j=0;j<=2;++j)t[p][i][j]=0;
	for(i=0;i<=2;++i)
		for(j=0;j<=2;++j)if(v[i][j])
			for(k=0;k<=2;++k)
				for(l=0;l<=2;++l)t[p][k][l]=( (long long)t[x][k][i]*t[y][j][l]+t[p][k][l])%mo;
}
void build(int p,int l,int r){
	int mid=l+r>>1;
	if(l==r){
		modify(p,0);
		return;
	}
	build(p<<1,l,mid);
	build((p<<1)+1,mid+1,r);
	renew(p);
}
void change(int p,int l,int r){
	int mid=l+r>>1;
	if(l==r){
		modify(p,y);
		return;
	}
	if(x<=mid)change(p<<1,l,mid);
	else change((p<<1)+1,mid+1,r);
	renew(p);
}
int main(){
	scanf("%d%d",&n,&m);
	for(i=0;i<=2;++i)
		for(j=0;j<=2;++j)scanf("%d",&v[i][j]);
	build(1,1,n);
	for(i=1;i<=m;++i){
		scanf("%d%d",&x,&y);
		change(1,1,n);
		ans=0;
		for(j=0;j<=2;++j)
			for(k=0;k<=2;++k)ans=(ans+t[1][j][k])%mo;
		printf("%d\n",ans);
	}
}

