#include <cstdio>
#include <cstring>
#define LL long long
#define REP(i,n) for (int i=1;i<=n;++i)
using namespace std;

const int maxn=100010;
const LL mo=777777777ll;
struct SSS{int l,r,m,w;} t[maxn<<2];
int n,m,k,x,wwww,ans,arr[maxn],a[maxn<<2][4][4];

void Update(int p) {
	int p0=t[p].w;
	int p1=t[p<<1].w;
	int p2=t[(p<<1)+1].w;
	memset(a[p0],0,sizeof(a[p0]));
	REP(i,3) REP(j,3) REP(k,3)
		a[p0][i][k]=(int)(((LL)a[p0][i][k]+(LL)a[p1][i][j]*(LL)a[p2][j][k])%mo);
}

void Build(int p,int l,int r) {
	t[p].l=l; t[p].r=r;
	t[p].m=(l+r)>>1;
	t[p].w=++wwww;
	if (l==r)
		REP(i,3) REP(j,3)
			a[t[p].w][i][j]=a[0][i][j];
	else {
		Build(p<<1,l,t[p].m);
		Build((p<<1)+1,t[p].m+1,r);
		Update(p);
	}
}

void Work(int p,int x,int y) {
	memset(a[p],0,sizeof(a[p]));
	REP(i,3) REP(j,3)
		if ((a[0][i][j])&&((!x)||(i==x))&&((!y)||(j==y))) a[p][i][j]=1;
}

void Modify(int p) {
	if (t[p].l==t[p].r)
		Work(t[p].w,arr[k],arr[k+1]);
	else {
		if (k<=t[p].m) Modify(p<<1);
		else Modify((p<<1)+1);
		Update(p);
	}
}

int main() {
	scanf("%d%d",&n,&m);
	REP(i,3) REP(j,3) scanf("%d",&a[0][i][j]);
	if (n>1) Build(1,1,n-1);
	for (;m;--m) {
		scanf("%d %d",&k,&x);
		if (n==1) {printf("%d\n",x?1:3);continue;}
		arr[k]=x;
		if (k<n) Modify(1);
		--k;
		if (k) Modify(1);
		ans=0;
		REP(i,3) REP(j,3)
			ans=(ans+a[t[1].w][i][j])%(int)mo;
		printf("%d\n",ans);
	}
	return 0;
}
