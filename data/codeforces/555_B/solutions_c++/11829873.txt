#include<cstdio>
#include<iostream>
#include<algorithm>
#include<cmath>
#include<cstring>
#include<queue>
using namespace std;
#define mp make_pair
#define f first
#define s second
#define lim 200001
#define ll long long
ll n,m,i,j,x;
ll X[lim],Y[lim],M[lim];
pair<pair<ll,ll>,ll> A[lim];
pair<ll,ll> R[lim];
priority_queue<pair<ll,ll> > P;
int main()
{
  scanf("%I64d%I64d",&n,&m);
  for(i=0;i<n;i++)
    scanf("%I64d%I64d",&X[i],&Y[i]);
  for(i=0;i+1<n;i++)
    A[i]=mp(mp(X[i+1]-Y[i],Y[i+1]-X[i]),i);
  n--;
  sort(A,A+n);
  for(i=0;i<m;i++)
  {
    scanf("%I64d",&R[i].f);
    R[i].s=i+1;
  }
  sort(R,R+m);
  for(i=j=0;i<m;i++)
  {
    for(x=R[i].f;j<n && A[j].f.f<=x;j++)
      P.push(mp(-A[j].f.s,A[j].s));
    if(!P.empty())
      if(-P.top().f<x)
      {
        printf("No\n");
        return 0;
      }
      else
      {
        M[P.top().s]=R[i].s;
        P.pop();
      }
  }
  if(P.empty() && j==n)
  {
    printf("Yes\n");
    for(i=0;i<n;i++)
      printf("%I64d ",M[i]);
  }
  else
    printf("No\n");
  return 0;
}
