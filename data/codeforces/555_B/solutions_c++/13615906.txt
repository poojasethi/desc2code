#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
		pair<pair<ll,ll>,ll> bridge[200009];
		set< pair<ll,ll> > mdata;
int main()
	{
		ll n,m,l,r,L,R,temp;
		set< pair<ll,ll> >::iterator it;
		cin>>n>>m;
		ll ans[n-1];
		for(ll i=0;i<n;++i)
			{
				cin>>L>>R;
				if(i)	bridge[i]=make_pair(make_pair(R-l,L-r),i);
				l=L;
				r=R;
			}
		for(ll i=0;i<m;++i)
			{
				cin>>temp;
				mdata.insert(make_pair(temp,i));
			}
		sort(bridge+1,bridge+n);

		for(ll i=1;i<n;i++)
    {
        it=mdata.lower_bound(make_pair(bridge[i].first.second,0));
        if(it==mdata.end()||it->first>bridge[i].first.first)
        {
            puts("No");
            return 0;
        }
        ans[bridge[i].second]=it->second;
        mdata.erase(it);
    }
	puts("Yes");
    for(ll i=1;i<n;i++) cout<<ans[i]+1 << " ";
		  return 0;
	}
				 	  	    		 	 			 	 		   	