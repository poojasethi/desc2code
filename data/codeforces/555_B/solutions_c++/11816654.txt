#include<bits/stdc++.h>
#define pb push_back
#define mp make_pair
#define ff first
#define ss second
#define all(a) a.begin(), a.end()
#define mod 1000000007

using namespace std;
typedef long long LL;
typedef vector<int> VI;
typedef vector< vector<int> > VVI;
typedef pair< LL, LL > PII;

LL ans[200010],L[200010],R[200010];
vector< pair<PII,LL> > v;
set<PII> S;

int main()
{
	ios_base::sync_with_stdio(false);
	cin.tie(NULL);

	int n,m; cin>>n>>m;
	for(int i=0; i<n; i++) cin>>L[i]>>R[i];
	for(int i=0; i<m; i++)
	{
		LL l; cin>>l;
		S.insert(mp(l,i));
	}
	for(int i=1; i<n; i++) v.pb(mp(mp(L[i]-R[i-1],R[i]-L[i-1]),i-1));
	sort(all(v));
	for(int i=n-2; i>=0; i--)
	{
		set<PII>::iterator it;
		LL idx,l,r; idx = v[i].ss; l = v[i].ff.ff; r = v[i].ff.ss;
		//cout<<idx<<" "<<l<<" "<<r<<endl;
		it = S.upper_bound(mp(r,m));
		if(it == S.begin() || (--it)->ff < l) {cout<<"No\n"; return 0;}
		ans[idx] = it->ss;
		//cout<<it->ff<<" "<<it->ss<<endl;
		S.erase(it);
	}
	cout<<"Yes\n";
	for(int i=0; i<n-1; i++) cout<<ans[i]+1<<" ";
	cout<<"\n";
	return 0;
}
