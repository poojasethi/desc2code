#include<bits/stdc++.h>
using namespace std;
#define max 200005
#define f first 
#define s second 
pair<pair<long long int,long long int>,int> arr[max];
set<pair<long long int,int> >bri;
set<pair<long long int,int> >::iterator it;
int ans[max];
int main(){
	int n,m;
	long long int l,r,x,y;
	cin>>n>>m>>l>>r;
	for(int i=0;i<n-1;i++)
	{
		cin>>x>>y;
		arr[i]=make_pair(make_pair(x-r,y-l),i);
		l=x;
		r=y;
	}
	for(int i=0;i<m;i++){
		cin>>x;
		bri.insert(make_pair(x,i));
	}
	sort(arr,arr+n-1);
	for(int i=n-2;i>=0;i--){
		it=bri.upper_bound(make_pair(arr[i].f.s,m));
		if(it==bri.begin() || (--it)->f < arr[i].f.f){
			cout<<"No"<<endl;
			return 0;
		}
		ans[arr[i].s]=it->s;
		bri.erase(it);
	}
	cout<<"Yes"<<endl;
	for(int i=0;i<n-1;i++)
		cout<<ans[i]+1<<" ";
	cout<<"\n";
	return 0;
}
