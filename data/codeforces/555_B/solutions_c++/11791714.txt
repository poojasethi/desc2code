#include <cstdio>
#include <utility>
#include <set>
#include <algorithm>
using namespace std;
long long l[200010], r[200010];
typedef pair<long long, long long> PI;
pair<PI, int> a[200010];
pair<long long, int> q[200010];
typedef set<pair<long long, int> > S;
S s;
int ans[200010];
int main() {
	int n, m;
	scanf("%d%d", &n, &m);
	for (int i = 0; i < n; i++) {
		scanf("%I64d%I64d", &l[i], &r[i]);
	}
	for (int i = 0; i < m; i++) {
		long long x;
		scanf("%I64d", &x);
		q[i] = make_pair(x, i);
	}
	for (int i = 0; i < n - 1; i++) {
		a[i] = make_pair(make_pair(r[i+1] - l[i], l[i+1] - r[i]), i);
	}
	sort(a, a + n - 1);
	sort(q, q + m);
	int j = 0;
	for (int i = 0; i < n - 1; i++) {
		long long x = a[i].first.first;
		while (j < m && q[j].first <= x) {
			s.insert(q[j]);
			++j;
		}
		S::iterator it = s.lower_bound(make_pair(a[i].first.second, -1));
		if (it == s.end()) {
			puts("No");
			return 0;
		}
		ans[a[i].second] = it->second;
		s.erase(it);
	}
	puts("Yes");
	for (int i = 0; i < n - 1; i++) {
		printf("%d ", ans[i] + 1);
	}
	puts("");
	return 0;
}
