#include<bits/stdc++.h>
using namespace std;

pair<pair<long long,long long>,int> p[200005];
set<pair<long long,int> > mp;
int s[200005];

int main()
{
	int n,m,i;
	long long l1,r1,l2,r2;
	set<pair<long long,int> >::iterator k;
	for(scanf("%d%d%I64d%I64d",&n,&m,&l1,&r1),i=1;i<n;i++)
	{
		scanf("%I64d%I64d",&l2,&r2);
		p[i]=make_pair(make_pair(r1-l2,l1-r2),i);
		l1=l2;r1=r2;
	}
	for(i=1;i<=m;i++)
		scanf("%I64d",&l1),mp.insert(make_pair(l1,i));
	sort(p+1,p+n);
	for(i=1;i<n;i++)
	{
		l1=-p[i].first.first;r1=-p[i].first.second;
		k=mp.lower_bound(make_pair(r1,1<<30));
		if(k==mp.begin())
			return puts("No");
		k--;
		if(k->first<l1)
			return puts("No");
		s[p[i].second]=k->second;
		mp.erase(k);
	}
	for(puts("Yes"),i=1;i<n;i++)
		printf("%d ",s[i]);
	return 0;
}
