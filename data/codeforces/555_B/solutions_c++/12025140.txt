#include <cstdio>
#include <iostream>
#include <algorithm>
#include <set>
using namespace std;
long long l[200005], r[200005];
int ans[200005];
pair<pair<long long,long long>,int> d[200005];
set< pair<long long,int> >s;

int main()
{
    int n, m;
    scanf("%d%d",&n,&m);
    for(int i=0;i<n;i++)
    	scanf("%lld%lld",&l[i],&r[i]);
    for(int i=0;i<m;i++){
    	long long a;
        scanf("%lld",&a);
        s.insert(make_pair(a,i));
    }
    for(int i=1;i<n;i++){
        d[i].first.first=r[i]-l[i-1];
        d[i].first.second=l[i]-r[i-1];
        d[i].second=i;
    }
    sort(d+1,d+n);
    bool flag=true;
    set< pair<long long,int> >::iterator it;
    for(int i=1;i<n;i++){
        it=s.lower_bound(make_pair(d[i].first.second,0));
        if(it==s.end()||it->first>d[i].first.first)
        {
        	flag=false;
            printf("No\n");
            break;
        }
        ans[d[i].second]=it->second+1;
        s.erase(it);
    }
    if(flag){
    	printf("Yes\n");
    	for(int i=1; i<n-1;i++)
    		printf("%d ",ans[i]);
    	printf("%d\n",ans[n - 1]);
	}
}
	 	 										   			  		 		