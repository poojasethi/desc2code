#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 100010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,r,l,s;
int a[N],g[N],h[N],pre[N],f[N];
inline void get() {
	r=0;
	For(i,1,n) {
		int A=lower_bound(h+1,h+r+1,a[i]-s)-h-1;
		if (A) pre[i]=max(pre[i],g[A]);
		for (;r&&h[r]>=a[i];r--);
		g[++r]=i; h[r]=a[i];
	}
}
int main() {
	scanf("%d%d%d",&n,&s,&m);
	For(i,1,n) scanf("%d",&a[i]);
	get();
	For(i,1,n) a[i]=-a[i];
	get();
	memset(f,120,sizeof(f));
	f[0]=0;
	int Last=0;
	l=1,r=0;
	For(i,1,n) {
		int zuo=i-m;
		if (zuo>=Last) {
			for (;r>=l&&f[g[r]]>=f[zuo];r--);
			g[++r]=zuo;
		}
		for (;Last<pre[i];Last++) {
			if (Last>zuo) continue;
			if (l<=r&&g[l]==Last) l++;
		}
		if (l<=r) f[i]=f[g[l]]+1;
	}
	if (f[n]>1e9) printf("-1\n");
	else printf("%d\n",f[n]);
	return 0;
}
