#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 200010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int l,r;
} f1[N];
int i,j,k,n,m,an;
int a[N],b[N],g[N],f[N],l[N],r[N],c[N];
inline void pre() {
	For(i,1,n) l[i]=i-1,r[i]=i+1;
	for (i=n;i;i--) {
		int A=a[i];
		f1[i].r=c[r[A]];
		f1[i].l=c[l[A]];
		r[l[A]]=r[A];
		l[r[A]]=l[A];
	}
}
inline bool ju(int y,int x,int a[N]) {
	int A=!f1[x].l?0:a[y-(x-f1[x].l)];
	int B=!f1[x].r?N:a[y-(x-f1[x].r)];
	return A<a[y]&&a[y]<B;
}
inline void work() {
	for (i=2,j=0;i<=n;i++) {
		for (;j&&!ju(i,j+1,a);j=f[j]);
		if (ju(i,j+1,a)) j++;
		f[i]=j;
	}
	int last=0;
	j=0;
	For(i,1,m) {
		for (;j&&!ju(i,j+1,b);j=f[j]);
		if (ju(i,j+1,b)) j++;
		if (j==n) {
			an++;
			j=f[j];
		}
	}
	printf("%d\n",an);
}
int main() {
	scanf("%d%d",&n,&m);
	For(i,1,n) scanf("%d",&k),a[k]=i,c[i]=k;
	For(i,1,m) scanf("%d",&k),b[k]=i;
	pre();
	work();
	//for(;;);
	return 0;
}
