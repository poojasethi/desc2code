#include<map>
#include<cstdio>
#include<iostream>
using namespace std;

#define maxn 200007

int N,M,ar[maxn],key[maxn],lw[maxn],bg[maxn],go[maxn];

map<int,int> use;

void oku()
{   scanf("%d %d",&N,&M);
    for(int i=1,s;i<=N;i++){ scanf("%d",&s); key[s]=i;}
    for(int i=1,s;i<=M;i++){ scanf("%d",&s); ar[s]=i;}
}

void pre()
{   map<int,int> ::iterator it;
    for(int i=1;i<=N;i++)
    {   use[key[i]]=i;
        it=use.upper_bound(key[i]);
        if(it!=use.end())
           bg[i]=it->second;
        it--;
        if(it!=use.begin())
        {   it--;
            lw[i]=it->second;
        }
    }
}

void islem()
{   pre();
    for(int i=2;i<=N;i++)
    {   go[i]=1;
        for(int j=go[i-1];j;j=go[j])
        {   if((key[i]>key[i-(j+1-lw[j+1])]||!lw[j+1])&&(key[i]<key[i-(j+1-bg[j+1])]||!bg[j+1]))
            {   go[i]=j+1; break;
            }
        }
    }
    int i=1,j=1,ces=0;
    for(j=1;j<=M;j++)
    {   while(!((ar[j]>ar[j-(i-lw[i])]||!lw[i])&&(ar[j]<ar[j-(i-bg[i])]||!bg[i]))) i=go[i-1]+1;
        i++;
        if(i>N) {ces++; i=go[i-1]+1;}
    }
    printf("%d\n",ces);
}

int main()
{   oku();
    islem();
    return 0;
}
