#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<algorithm>
#define N 210000
using namespace std;
int n,m,d[N],a[N],b[N],pre[N],next[N],fail[N],p,i,ans;
bool match(int a[N],int i,int b[N],int j){
	int low=pre[i]==0?-10000:b[j-(i-pre[i])];
	int high=next[i]==0?10000000:b[j-(i-next[i])];
	return b[j]>low && b[j]<high;
}
int main(){
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;++i)scanf("%d",&d[i]),a[d[i]]=i;
	for(i=1;i<=n;++i)next[d[i]]=d[i+1],pre[d[i]]=d[i-1];
	for(i=1;i<=m;++i)scanf("%d",&d[i]),b[d[i]]=i;
	for(i=n;i>=1;--i){
		next[pre[i]]=next[i];
		pre[next[i]]=pre[i];
	}
	fail[0]=-1;
	for(i=1;i<=n;++i){
		for(p=fail[i-1];p!=-1 && !match(a,p+1,a,i);p=fail[p]);
		fail[i]=p+1;
	}
	
	p=0;
	for(i=1;i<=m;++i){
		for(;p!=-1 && !match(a,p+1,b,i);p=fail[p]);
		p++;
		if(p==n){
			ans++;
			p=fail[p];
		}
	}
	printf("%d\n",ans);
}
