#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<iostream>
#include<algorithm>
using namespace std;
const int N=200100;
int n,m;
int a[N],b[N],c[N],l[N],r[N],x[N],y[N],p[N];
int main()
{
	scanf("%d%d",&n,&m);
	for(int i=1;i<=n;++i)
		scanf("%d",&a[i]),c[a[i]]=i,l[i]=i-1,r[i]=i+1,x[i]=y[i]=-1;
	for(int i=1,q;i<=m;++i)
		scanf("%d",&q),b[q]=i;
	for(int i=n;i>0;--i)
	{
		if ( l[c[i]]>0    ) x[i]=i-a[l[c[i]]],r[l[c[i]]]=r[c[i]];
		if ( r[c[i]]<=n ) y[i]=i-a[r[c[i]]],l[r[c[i]]]=l[c[i]];
	}
	p[0]=p[1]=0;
	for(int i=2;i<=n;++i)
	{
		int j=p[i-1];
		while ( j>0 && ( (x[j+1]>0 && c[i-x[j+1]]>c[i]	)||  (y[j+1]>0 && c[i-y[j+1]]<c[i] )) ) j=p[j];
		p[i]=j+1;
	}
	int ans=0;
	for(int i=1,j=0;i<=m;++i)
	{
		while ( j>0 && ( x[j+1]>0 && b[i-x[j+1]]>b[i] || y[j+1]>0 && b[i-y[j+1]]<b[i] ) ) j=p[j];
		++j;
		if ( j==n ) ++ans,j=p[j];
	}
	cout<<ans<<endl;
	return 0;
}