#include <cstdio>
#include <cstring>
using namespace std;
const int PPP=1000000007;
#define MN 200001
int N,M,Ans;
int A[MN],B[MN],b[MN],P[MN],t,tt;
int m( int a, int b, int c) {return a*P[c]+b;}
#define NN 262144
int T[NN<<1],S[NN<<1];
int l,r;
void upd( int k) 
{
    l=k<<1;r=l^1;
    S[k]=S[l]+S[r];
    T[k]=m(T[l],T[r],S[r]);
}
void ins( int k, int t, int s)
{
    S[k+=NN]+=s;
    T[k]=S[k]*PPP*t;
    for (k>>=1;k;k>>=1) upd(k);
}
int main()
{
    scanf("%d%d",&N,&M);
    P[0]=1;
    for (int i=1;i<MN;i++) P[i]=P[i-1]*PPP;
    for (int i=1;i<=N;i++) scanf("%d",A+i),t=m(t,A[i]*PPP,1),tt=m(tt,PPP,1);
    for (int i=1;i<=M;i++) scanf("%d",B+i),b[B[i]]=i;
    for (int i=1;i<=M;i++)
    {
        ins(b[i],i,1);
        if (i>N) ins(b[i-N],i-N,-1);
        if (i>=N&&T[1]-tt*(i-N)==t) Ans++;
    }
    printf("%d\n",Ans);
}