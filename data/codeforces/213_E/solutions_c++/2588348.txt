#include<cstdio>
#include<cstring>
#include<iostream>

using namespace std;

const int maxn = 300000;
const int maxp = 1000000009;
static int S[maxn],P[maxn];
static int n,m,A[maxn],B[maxn];
static int C1[maxn*2],C2[maxn*2];
void ins(int t,int l,int r,int x,int y){
	if (x<l||r<x) return;
	if (l==r){
		C1[t]+=y;
		C2[t]=C1[t]*S[x];
		return;
	}
	int mid=l+r>>1;
	ins(t*2+1,l,mid,x,y);
	ins(t*2+2,mid+1,r,x,y);
	C1[t]=C1[t*2+1]+C1[t*2+2];
	C2[t]=C2[t*2+1]*P[C1[t*2+2]]+C2[t*2+2];
}
int main(){
//	freopen("213E.in","r",stdin);
//	freopen("213E.out","w",stdout);
	scanf("%d%d",&n,&m);P[0]=1;
	int tot=0,ky=0;
	for (int i=1;i<=n;i++){
		scanf("%d",&S[i]);
		A[S[i]]=i;P[i]=P[i-1]*maxp;
		tot+=P[i-1];
	}
	for (int i=1;i<=n;i++) ky=ky*maxp+S[i];
	for (int i=1;i<=m;i++){
		scanf("%d",&S[i]);
		B[S[i]]=i;
	}
	for (int i=1;i<n;i++)
		ins(0,1,m,B[i],1);
	int pri=0;
	for (int i=0;i+n<=m;i++){
		ins(0,1,m,B[i+n],1);
		if (C2[0]==ky+i*tot)pri++;
		ins(0,1,m,B[i+1],-1);
	}
	printf("%d\n",pri);
	return 0;	
}
