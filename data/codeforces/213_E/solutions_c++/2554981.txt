#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
using namespace std;
typedef unsigned int ui;
const int MM=10000007,
    maxn=200010;
ui sum[maxn*4],h[maxn*4],po[maxn],hash,dn;
int ans,n,m,a[maxn],b[maxn],p[maxn];
void add(int t,int l,int r,int p,int d){
    if(l==r){
        sum[t]+=d;
        h[t]=sum[t]*b[p];
    }
    else{
        int mid=(l+r)/2;
        if(p<=mid)add(t*2,l,mid,p,d);
        else add(t*2+1,mid+1,r,p,d);
        sum[t]+=d;
        h[t]=h[t*2]*po[sum[t*2+1]]+h[t*2+1];
    }
}
int main(){
    //freopen("AC.in","r",stdin);
    //freopen("AC.out","w",stdout);
    scanf("%d%d",&n,&m);
    hash=ans=dn=0;
    for(int i=1;i<=n;i++){
        scanf("%d",a+i);
        hash=hash*MM+a[i];
        dn=dn*MM+1;
    }
    for(int i=1;i<=m;i++){
        scanf("%d",b+i);
        p[b[i]]=i;
    }
    for(int i=po[0]=1;i<=m;i++)po[i]=po[i-1]*MM;
    for(int i=1;i<=m;i++){
        add(1,1,m,p[i],1);
        if(i>n){
            add(1,1,m,p[i-n],-1);
            hash+=dn;
        }
        if(i>=n&&hash==h[1])ans++;
    }
    cout<<ans<<endl;
    return 0;
}
