#include<cstdio>
#include<algorithm>
#define LL long long
using namespace std;
const LL n=200005,Base=100003,oo=19990007;
LL N,M,i,j,Ans,X,p,S;
LL A[n],B[n],C[n],D[n],E[n],f[4*n],s[4*n];
void Modify(LL t,LL l,LL r,LL x,LL y)
{
	LL mid=(l+r)/2;
	if(l==r)
	{
		if(!y) f[t]=s[t]=0;
		else f[t]=B[l],s[t]=1;
		return;
	}
	if(x<=mid) Modify(2*t,l,mid,x,y);
	else Modify(2*t+1,mid+1,r,x,y);
	f[t]=(f[2*t]+f[2*t+1]*E[s[2*t]])%oo;
	s[t]=s[2*t]+s[2*t+1];
}
int main()
{
	scanf("%I64d%I64d",&N,&M);
	if(N>M)
	{
		printf("0\n");
		return 0;
	}
	for(i=1;i<=N;++i) scanf("%I64d",&A[i]),C[A[i]]=i;
	for(i=1;i<=M;++i) scanf("%I64d",&B[i]),D[B[i]]=i;
	E[0]=1;
	for(i=1;i<=N;++i) E[i]=E[i-1]*Base%oo;
	for(i=0;i<N;++i) S=(S+E[i])%oo;
	for(i=1;i<=N;++i) X=(X+A[i]*E[i-1])%oo;
	for(i=1;i<=N;++i) Modify(1,1,M,D[i],1);
	if(f[1]==X) ++Ans;
	for(i=N+1;i<=M;++i)
	{
		Modify(1,1,M,D[i-N],0);
		Modify(1,1,M,D[i],1);
		if((f[1]+oo-S*(i-N)%oo)%oo==X) ++Ans;
	}
	printf("%I64d\n",Ans);
	return 0;
}
