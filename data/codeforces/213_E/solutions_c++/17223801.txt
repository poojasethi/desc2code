#include<bits/stdc++.h>

using namespace std;

#define pii pair<int,int>
#define ll long long
#define N (int)(2e5+10)
#define mod 1000000007
#define mp make_pair
#define pb push_back
#define nd second
#define st first
#define inf mod
#define endl '\n'
#define sag (sol|1)
#define sol (root<<1)
#define ort ((bas+son)>>1)
#define bit(x,y) ((x>>y)&1)

int St[4*N],pw[N],a[N],h1,h2,h3;
int H[N],n,m,i,ans,b[N],S[4*N],wh[N],d;

void upd(int root,int bas,int son,int x,int t){
	if(bas > x or son < x)
		return ;

	if(bas == son){
		S[root] = t;
		St[root] = b[bas]*t;
		return;
	}

	upd(sol,bas,ort,x,t);
	upd(sag,ort+1,son,x,t);

	S[root] = S[sol] + S[sag];

	St[root] = St[sol]*pw[S[sag]] + St[sag];
}

int main(){
	cin >> n >> m;

	pw[0] = 1;

	for(i=1 ; i<=n ; i++)
		pw[i] = pw[i-1]*1453;

	for(i=1 ; i<=n ; i++){
		scanf("%d",a+i);
		h1 = h1*1453 + a[i];
		h2 = h2*1453 + 1;
	}
	for(i=1 ; i<=m ; i++){
		scanf("%d",b+i);
		wh[b[i]] = i;
		if(b[i] <= n)
			upd(1,1,m,i,1);
	}
	if(St[1] == h1)
		ans++;
	for(d=1 ; d<=m-n ; d++){
		upd(1,1,m,wh[d],0);
		upd(1,1,m,wh[d+n],1);
		if(St[1]-h2*d == h1)
			ans++;
	}

	cout << ans << endl;
}
