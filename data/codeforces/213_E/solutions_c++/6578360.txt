#include<cstdio>
#include<cstdlib>
#include<cstring>
#define H 19931225
#define N 200050
int n,m,a[N],b[N],pw[N],w[N],ha,dn,ans,v[N<<2],h[N<<2];
void add(int x,int l,int r,int p,int d){
    if(l==r){
        v[x]+=d;
        h[x]=b[p]*v[x];
        return;
    }
    int m=(l+r)/2;
    if(p<=m)add(x*2,l,m,p,d);
    else add(x*2+1,m+1,r,p,d);
    v[x]=v[x*2]+v[x*2+1];
    h[x]=h[x*2]*pw[v[x*2+1]]+h[x*2+1];
}
int main(){
    while(~scanf("%d%d",&n,&m)){
        memset(v,0,sizeof(v));
        memset(h,0,sizeof(h));//**** must zero it if  use push up too
        for(int i=1;i<=n;++i)scanf("%d",a+i);
        for(int i=1;i<=m;++i)scanf("%d",b+i);
        for(int i=pw[0]=1;i<=n;++i)pw[i]=pw[i-1]*H;
        ha=dn=0;
        ans=0;
        for(int i=1;i<=n;++i)ha=ha*H+a[i],dn=dn*H+1;
        for(int i=1;i<=m;++i)w[b[i]]=i;
        for(int i=1;i<=m;++i){
            add(1,1,m,w[i],1);
            if(i>n){
                add(1,1,m,w[i-n],-1);
                ha+=dn;
            }
            if(h[1]==ha)++ans;
        }
        printf("%d\n",ans);
    }
    return 0;
}
