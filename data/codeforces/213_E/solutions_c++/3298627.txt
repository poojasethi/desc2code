#include <cstdio>

#define maxn 400040

int n,m,i,j,x,a[maxn],b[maxn],c[maxn],lower[maxn],fwt[maxn],k,f[maxn],ans;

inline int query(int j){
	int rt=0;
	for(;j;j&=(j-1))rt+=fwt[j];
	return rt;
}

inline void change(int j,int x){
	for(;j<=n+m;j=(j|(j-1))+1)fwt[j]+=x;
}

int main (int argc, char * const argv[]) {
//	freopen("in.txt","r",stdin);
	scanf("%d%d",&n,&m);
	for(i=1;i<=n;i++){
		scanf("%d",&x);
		a[x]=i;
	}
	for(i=1;i<=m;i++){
		scanf("%d",&x);
		b[x]=i;
	}
	for(i=1;i<=n;i++){lower[i]=query(a[i]);change(a[i],1);}
	for(i=1;i<=n+m;i++)fwt[i]=0;
	for(i=1;i<=n+m;i++)if(i<=n)c[i]=a[i];else c[i]=b[i-n];
	for(i=2;i<=n+m;i++){
		k=f[i-1];
		if(i==n+1){
			k=0;
			for(j=0;j<=n+m;j++)fwt[j]=0;
		}
		while(k==n||(k>0&&lower[k+1]!=query(c[i]))){
			for(j=i-k;j<i-f[k];j++)change(c[j],-1);
			k=f[k];
		}
		f[i]=k+1;
		change(c[i],1);
		if(f[i]==n)++ans;		
	}
	printf("%d\n",ans);
    return 0;
}
