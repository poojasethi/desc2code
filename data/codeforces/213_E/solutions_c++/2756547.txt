#include <cstring>
#include <cstdio>
using namespace std;

const int base=100007,maxn=1000000;
int dx,hash,cnt[maxn],pow[maxn],num[maxn],pos[maxn];
int a[maxn],b[maxn],n,m,ans;

void modify(int t, int l, int r, int x, int flag)
{
	if (l==r)
	{
		if (flag) cnt[t]=1, num[t]=b[l];
		else cnt[t]=0, num[t]=0; 
		return;
	}
	int mid=(l+r)>>1;
	if (x<=mid) modify(t+t,l,mid,x,flag);
	else modify(t+t+1,mid+1,r,x,flag);
	num[t]=num[t+t]*pow[cnt[t+t+1]]+num[t+t+1];
	cnt[t]=cnt[t+t]+cnt[t+t+1];
}

int main()
{
	pow[0]=1; 
	for (int i=1; i<=200000; i++) pow[i]=pow[i-1]*base;
	scanf("%d%d",&n,&m);
	for (int i=1; i<=n; i++)
	{
		scanf("%d",&a[i]); hash=hash*base+a[i];
		dx+=pow[i-1];
	}
	for (int i=1; i<=m; i++)
		scanf("%d",&b[i]), pos[b[i]]=i;
		
	for (int i=1; i<=n; i++) modify(1,1,m,pos[i],1);
	if (num[1]==hash) ans++;
	
	for (int i=n+1; i<=m; i++)
	{
		modify(1,1,m,pos[i-n],0);
		modify(1,1,m,pos[i],1);
		hash+=dx; if (num[1]==hash) ans++;
	}
	printf("%d\n",ans);
	//for (;;);
}
