#include<bits/stdc++.h>
using namespace std;

int n,m,tot,ans,seed=314159;
int a[200010],b[200010],w[200010];
long long pw[200010];

struct unit
{long long c[200010];
 void change(int i,long long x)
 {	while(i<=m)
	{	c[i]+=x;
		i+=i&(-i);
	}
 }
 long long query(int i)
 {	long long ret=0;
  	while(i>0)
  	{	ret+=c[i];
  		i-=i&(-i);
  	}
  	return ret;
 }
};
struct unit t1,t2;

int main()
{int i,j;
 long long s=0,s1=0;
 
 scanf("%d%d",&n,&m);
 for(i=1;i<=n;i++) scanf("%d",&a[i]);
 for(i=1;i<=m;i++) 
 {	scanf("%d",&b[i]);
 	w[b[i]]=i;
 }
 pw[0]=1;
 for(i=1;i<=m;i++) pw[i]=pw[i-1]*seed;
 for(i=1;i<=n;i++) s+=pw[a[i]]*i;
 for(i=1;i<=n;i++) 
 {	t1.change(w[i],1);
 	t2.change(w[i],pw[i]);
 }
 for(i=1;i<=n;i++) s1+=pw[i]*t1.query(w[i]);
 for(i=1;i<=m-n+1;i++)
 {	if(s==s1) ans++;
 	s=s*seed;
 	if(i+n<=m)
	{	s1-=t2.query(m)-t2.query(w[i]);
		t2.change(w[i],-pw[i]);
		s1-=pw[i]*t1.query(w[i]);
		t1.change(w[i],-1);
		s1+=t2.query(m)-t2.query(w[i+n]);
 		t2.change(w[i+n],pw[i+n]);
 		t1.change(w[i+n],1);
 		s1+=pw[i+n]*t1.query(w[i+n]);
 	}
 } 
 printf("%d\n",ans);
 return 0;
}