#include<iostream>
#include<cstdio>
#include<cstring>
using namespace std;
const int maxn=200002;
int a[maxn],b[maxn],f[2][maxn],c[maxn],next[maxn];
int n,m,s;

void add(int p,int i,int k){
  for (;i<=m;i+=i&(-i)) f[p][i]+=k;
}

int sum(int p,int i){
  int s=0;
  for (;i>0;i-=i&(-i)) s+=f[p][i];
  return s;
}

int main(){
  int i,j,k;
  scanf("%d%d",&n,&m);
  for (i=1;i<=n;i++){
    scanf("%d",&k);
    a[k]=i;
  }
  for (i=1;i<=m;i++){
    scanf("%d",&k);
    b[k]=i;
  }
  c[1]=1;
  add(0,a[1],1);
  j=0;
  for (i=2;i<=n;i++){
    add(0,a[i],1);
    c[i]=sum(0,a[i]);
    add(1,a[i],1);
    while (j && c[j+1]!=sum(1,a[i])){
      for (k=i-j;k<=i-next[j]-1;k++) add(1,a[k],-1);
      j=next[j];
    }
    next[i]=++j;
  }
  memset(f,0,sizeof(f));
  j=0;
  for (i=1;i<=m;i++){
    add(1,b[i],1);
    while (j && c[j+1]!=sum(1,b[i])){
      for (k=i-j;k<=i-next[j]-1;k++) add(1,b[k],-1);
      j=next[j];
    }
    j++;
    if (j==n){
      s++;
      for (k=i+1-j;k<=i-next[j];k++) add(1,b[k],-1);
      j=next[j];
    }
  }
  printf("%d\n",s);
  return 0;
}


/*ncjdsbncsnpphbhfqeodrfkgcsppdaqqogmntrhjccekpdhdhc*/