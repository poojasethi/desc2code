#include<cstdio>
#include<cstring>
const int t=200005;
#define ms(s) memset((s),0,sizeof (s))
int nxt[t],x[t],s[t],a[t],b[t],r[t];
int q;
void ins(int i,int c){
	for (;i<=q;i+=i&-i) s[i]+=c;
}
int cnt(int i){
	int ans=0;
	for (;i;i-=i&-i) ans+=s[i];
	return ans;
}
int main(){
	int n,m,i,j,k,ans;
//	freopen("213e.in","r",stdin);
//	freopen("213e.out","w",stdout);
	scanf("%d%d",&n,&m);
	ms(s),q=n;
	for (i=1;i<=n;i++) a[scanf("%d",&j),j]=i;
	for (r[n+1]=-1,i=1;i<=n;i++){
		r[i]=cnt(a[i]);
		ins(a[i],1);
	}
	for (i=1;i<=m;i++) b[scanf("%d",&j),j]=i;
	ms(s);
	for (nxt[1]=j=0,i=2;i<=n;i++){
		for (;cnt(a[i])!=r[j+1];j=nxt[j])
			for (k=i-j;k<i-nxt[j];k++) ins(a[k],-1);
		ins(a[i],1);
		nxt[i]=++j;
	}
	ms(s),q=m;
	for (j=ans=0,i=1;i<=m;i++){
		for (;cnt(b[i])!=r[j+1];j=nxt[j])
			for (k=i-j;k<i-nxt[j];k++) ins(b[k],-1);
		ins(b[i],1);
		if (++j==n) ans++;
	}
	printf("%d\n",ans);
	return 0;
}
