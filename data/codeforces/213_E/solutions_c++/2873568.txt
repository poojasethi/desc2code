#include<cstdio>
#include<cstring>
#define MAXN 210000

int n,m,a[MAXN],_a[MAXN],b[MAXN],_b[MAXN],ca[MAXN],Next[MAXN],c[MAXN],Ans;

void Add(int x,int y){for(;x<=m;x+=x&-x)c[x]+=y;}

int Sum(int x){int y(0);
for(;x;x&=x-1)y+=c[x];
return y;}

int main()
{
	int i,j,k,l;
	scanf("%d",&n);
	scanf("%d",&m);
	for(i=1;i<=n;i++)
	{
		scanf("%d",a+i);
		_a[a[i]]=i;
	}
	for(i=1;i<=m;i++)
	{
		scanf("%d",b+i);
		_b[b[i]]=i;
	}
	for(i=1;i<=n;i++)
	{
		Add(_a[i],1);
		ca[i]=Sum(_a[i]);
	}
	memset(c,0,sizeof c);
	for(i=1,j=0;i<=n;)
	if(!j||Sum(_a[i])==ca[j])
	{
		Next[++i]=++j;
		if(i<=n)Add(_a[i],1);
	}
	else
	{
		j=Next[k=j];
		for(l=1;l<=k-j;l++)
			Add(_a[i-k+l],-1);
	}
	memset(c,0,sizeof c);
	Add(_b[1],1);
	for(i=1,j=1;i<=m;)
	if(j!=n+1&&(!j||Sum(_b[i])==ca[j]))
	{
		++i,++j;
		if(i<=m)Add(_b[i],1);
	}
	else
	{
		if(j==n+1)Ans++;
		j=Next[k=j];
		for(l=1;l<=k-j;l++)
			Add(_b[i-k+l],-1);
	}
	if(j==n+1)Ans++;
	printf("%d\n",Ans);
	return 0;
}
