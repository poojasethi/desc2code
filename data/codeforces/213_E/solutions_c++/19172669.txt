#include<cstdio>
#define ll __int64
#define kl k<<1
#define kr k<<1|1
const int h1=2357;
const int h2=9997;
const int N=200001; 
int b[N];
int f[N<<2];
ll ha1,ha2;
ll p1[N],p2[N];
ll t1[N<<2],t2[N<<2];
void update(int L,int R,int x,int c,int v,int k)
{
	if(L==R)
	{
		f[k]=c;
		t1[k]=c*v;
		t2[k]=c*v;
	}
	else
	{
		int mid=(L+R)>>1;
		if(x<=mid)update(L,mid,x,c,v,kl);
		else update(mid+1,R,x,c,v,kr);
		f[k]=f[kl]+f[kr];
		t1[k]=t1[kl]*p1[f[kr]]+t1[kr];
		t2[k]=t2[kl]*p2[f[kr]]+t2[kr];
	}
}
int main()
{
	ll d1,d2;
	int i,n,m,v,ans=0;
	scanf("%d%d",&n,&m);
	d1=d2=0;
	ha1=ha2=0;
	p1[0]=p2[0]=1;
	for(i=1;i<=n;i++)
	{
		scanf("%d",&v);
		ha1=ha1*h1+v;
		ha2=ha2*h2+v;
		d1+=p1[i-1];
		d2+=p2[i-1];
		p1[i]=p1[i-1]*h1;
		p2[i]=p2[i-1]*h2;
	}
	for(i=1;i<=m;i++)
	{
		scanf("%d",&v);
		b[v]=i;
	}
	for(i=1;i<=m;i++)
	{
		update(1,m,b[i],1,i,1);
		if(i>=n)
		{
			if(t1[1]==ha1&&t2[1]==ha2)ans++;
			ha1+=d1,ha2+=d2;
			update(1,m,b[i-n+1],0,i-n+1,1);
		}
	}
	printf("%d\n",ans);
	return 0;
}
 			     			 			   		   	 	 	