#include<iostream>
#include<vector>
#include<sstream>
#include<algorithm>
#include<numeric>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<complex>
#include<set>
#include<map>
#include<queue>
#include<cassert>

using namespace std;

#define rep(i,n) for(int i=0;i<n;i++)
#define rp(i,c) rep(i,(c).size())
#define fr(i,c) for(__typeof((c).begin()) i=(c).begin();i!=(c).end();i++)
#define pb push_back
#define mp make_pair
#define all(c) (c).begin(),(c).end()
#define dbg(x) cerr<<#x<<" = "<<(x)<<endl

typedef vector<int> vi;
typedef vector<string> vs;
typedef long long ll;
typedef pair<ll,ll> pi;

const int inf=1<<28;
const double INF=1e12,EPS=1e-9;

int n,m,k,prev[50][51][101];
ll dp[50][51][101];
pair<pi,pi> sub[50];
ll a[50],b[50];

void run()
{
	scanf("%d%d%d",&n,&m,&k);
	rep(i,m){
		scanf("%I64d%I64d%I64d",&sub[i].second.first,&sub[i].second.second,&sub[i].first.first);
		sub[i].first.second=i+1;
	}
	sort(sub,sub+m);
	rep(i,m)a[i]=sub[i].second.first, b[i]=sub[i].second.second;
	
	rep(i,50)rep(j,51)rep(k,101)dp[i][j][k]=-(1ll<<60);
	
	rep(i,m)rep(j,b[i]-a[i]+1)dp[i][1][j]=a[i]+j;
	for(int j=1;j<n;j++)rep(i,m)rep(h,101)if(dp[i][j][h]>=0){
		ll x=a[i]+h;
		rep(l,m)if(sub[i].first.first<sub[l].first.first){
			ll y=x+k, z=x*k;
			if(a[l]<=y&&y<=b[l] && dp[l][j+1][y-a[l]]<dp[i][j][h]+y)
				dp[l][j+1][y-a[l]]=dp[i][j][h]+y, prev[l][j+1][y-a[l]]=i*200+h;
			if(a[l]<=z&&z<=b[l] && dp[l][j+1][z-a[l]]<dp[i][j][h]+z)
				dp[l][j+1][z-a[l]]=dp[i][j][h]+z, prev[l][j+1][z-a[l]]=i*200+h;
		}
	}
	
	ll mx=-(1ll<<60); int mi,mj;
	rep(i,m)rep(j,101)if(mx<dp[i][n][j])mx=dp[i][n][j], mi=i, mj=j;
	
	if(mx==-(1ll<<60)){
		puts("NO"); return;
	}
	
	int ans[50]; ll ansx[50];
	rep(l,n){
		ans[n-1-l]=sub[mi].first.second;
		ansx[n-1-l]=mj+a[mi];
		mi=prev[mi][n-l][mj];
		mj=mi%200; mi/=200;
	}
	
	puts("YES");
	rep(i,n)printf("%d %I64d\n",ans[i],ansx[i]);
}

int main()
{
#ifndef ONLINE_JUDGE
	int cs=3;rep(i,cs)
#endif
	run();
}
