#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
char ch;
int i,j,k,n,m,a[111],f[2][1<<21],q[2][1<<21],now,pre,lim,c[2],ts[1<<21],st,v,w,b[21][2],tz;
bool cmp(int a,int b){
	return a>b;
}
int main(){
	scanf("%d",&n);
	for (i=1;i<=n;i++) scanf("%d",&a[i]);
	sort(a+1,a+1+n,cmp);
	scanf("%d",&m);
	for (i=1;i<=m;i++){
		for (ch=getchar();ch!='b'&&ch!='p';ch=getchar());
		b[i][0]=(ch=='b'?0:1);
		scanf("%d",&b[i][1]);
	}
	lim=1<<m;now=0;pre=1;c[now]=1;q[now][1]=lim-1;f[now][lim-1]=tz=0;memset(ts,0,sizeof(ts));
	for (i=m;i;i--){
		now^=1;pre^=1;c[now]=0;tz++;
		for (j=1;j<=c[pre];j++){
			st=q[pre][j];
		 	for (k=1;k<=m;k++)
			 if ((st>>(k-1))&1){
			 	w=st-(1<<(k-1));v=f[pre][st];
			 	if (b[i][0]) v+=(b[i][1]==1?1:-1)*a[k];
				if (ts[w]<i) ts[w]=i,q[now][++c[now]]=w,f[now][w]=v;else f[now][w]=(b[i][1]==1?max(f[now][w],v):min(f[now][w],v));
			 }
		}
	}
	printf("%d\n",f[now][0]);
	return 0;
}