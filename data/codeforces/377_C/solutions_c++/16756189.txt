#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
using namespace std;
int n,m,a[108],ac[25],te[25],f[1<<20+1][21];
bool ff[1<<20+1][21];
char c,d;
bool cmp(int x,int y){return x>y;}
int wk(int x,int y){
	if(ff[x][y]) return f[x][y];
	if(y==m) return 0;
	int g;
	if(ac[y+1]) for(int i=1;i<=m;i++)
	if((x|(1<<i))!=x) {g=x|(1<<i);ff[x][y]=1;
	return f[x][y]=wk(g,y+1)+a[i]*te[y+1];}
	if(!ac[y+1]) for(int i=1;i<=m;i++)
	if((x|(1<<i))!=x){g=x|(1<<i);
	if(!ff[x][y]) f[x][y]=wk(g,y+1),ff[x][y]=1;
	else if(te[y+1]==1) 
	f[x][y]=max(f[x][y],wk(g,y+1));
	else f[x][y]=min(f[x][y],wk(g,y+1));
	}
	return f[x][y];
}
int main(){
	cin>>n;
	for(int i=1;i<=n;i++)
	cin>>a[i];
	cin>>m;
	for(int i=1;i<=m;i++)
	cin>>c>>d,ac[i]=c=='p',te[i]=(d=='1')*2-1;
	sort(a+1,a+n+1,cmp);
	memset(ff,0,sizeof ff);
	cout<<wk(0,0)<<endl;
	return 0;
}
  		  	  	 			  	  				  	 		