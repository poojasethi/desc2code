/* **********************************************
Author      : wuyiqi
Created Time: 2013-8-21 9:08:41
File Name   : ABBYY_D.cpp
*********************************************** */

#include <cstdio>
#include <cstring>
typedef long long lld;
const int N = 33;

int dir[N][N];
lld T[N][N][4];
int dx[] = {
    0,0,-1,1
};
int dy[] = {
    1,-1,0,0
};
int get_dir(char ch) {
    if(ch == 'U') return 0;
    if(ch == 'D') return 1;
    if(ch == 'L') return 2;
    if(ch == 'R') return 3;
}
int b;
bool ingrid(int x,int y) {
    return 0 <= x && x <= b && 0 <= y && y <= b;
}
void dfs(int x,int y,int d,lld t) {
    if(dir[x][y] != -1) d = dir[x][y];
   // printf("d=%d\n",d);
    if(T[x][y][d]!=-1) {
        t %= (T[x][y][d]-t);
    } else {
        T[x][y][d] = t;
    }
    if(t == 0) {
        printf("%d %d\n",x,y);
        return  ;
    }
    int tx = x + dx[d] , ty = y + dy[d];
    if(!ingrid(tx,ty)) {
        printf("%d %d\n",x,y);
    } else {
        dfs(tx,ty,d,t-1);
    }
}
int main()
{
    int n,x1,y1,x2,y2;
    scanf("%d%d",&n,&b);
    memset(dir,-1,sizeof(dir));
    for(int i = 1; i <= n; i++) {
        scanf("%d%d%d%d",&x1,&y1,&x2,&y2);
        if(x1 < x2) {
            for(int j = x1; j <= x2; j++) dir[j][y1] = 3;
        }
        if(x1 > x2) {
            for(int j = x1; j >= x2; j--) dir[j][y1] = 2;
        }
        if(y1 < y2) {
            for(int j = y1; j <= y2; j++) dir[x1][j] = 0;
        }
        if(y1 > y2) {
            for(int j = y1; j >= y2; j--) dir[x1][j] = 1;
        }
    }
    int q,x,y;
    scanf("%d",&q);
    while(q--) {
        lld t;
        char ch[5];
        scanf("%d%d%s%I64d",&x,&y,ch,&t);
        memset(T,-1,sizeof(T));
        dfs(x,y,get_dir(ch[0]),t);
    }
    return 0;
}
