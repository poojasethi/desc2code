#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <ctime>
#define fi first
#define se second
#define PA pair<int,int>
#define VI vector<int>
#define VP vector<PA >
#define mk(x,y) make_pair(x,y)
#define N 30010
#define inf 1000000000
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,u;
int a[N],f[N],g[N],h[N],w[N];
int main() {
	scanf("%d%d",&n,&m);
	For(i,1,n) scanf("%d",&a[i]),a[i]+=a[i-1];
	int ma=-inf,mi=inf;
	For(i,0,n) {
		if (!i) f[i]=g[i]=-inf;
		else {
			int zhi=a[i];
			f[i]=-(zhi-ma);
			g[i]=zhi-mi;
		}
		ma=max(ma,a[i]);
		mi=min(mi,a[i]);
	}
	//For(i,1,n) printf("%d %d\n",f[i],g[i]);
	For(i,2,m-1) {
		For(j,0,n) h[j]=w[j]=-inf;
		int ma0,ma1,Ma0,Ma1;
		ma0=ma1=Ma0=Ma1=-inf;
		For(j,1,n) {
			int zhi=a[j];
			h[j]=max(ma0,ma1-2*zhi);
			w[j]=max(Ma0,Ma1+2*zhi);
			
			ma0=max(ma0,f[j]);
			Ma0=max(Ma0,g[j]);
			ma1=max(ma1,Ma0+2*zhi);
			Ma1=max(Ma1,ma0-2*zhi);
		}
		For(j,0,n) f[j]=h[j],g[j]=w[j];
	}
	{
		int an=-inf;
		int ma0,ma1,Ma0,Ma1;
		ma0=ma1=Ma0=Ma1=-inf;
		For(j,1,n) {
			int zhi=a[j];
			an=max(an,ma1+zhi);
			an=max(an,Ma1-zhi);
			
			ma0=max(ma0,f[j]);
			Ma0=max(Ma0,g[j]);
			ma1=max(ma1,ma0-zhi);
			Ma1=max(Ma1,Ma0+zhi);
		}
		printf("%d\n",an);
	}
	return 0;
}
