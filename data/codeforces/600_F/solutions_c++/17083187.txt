#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
#define fo(i,a,b) for(int i=a;i<=b;i++)
#define fd(i,a,b) for(int i=a;i>=b;i--)
#define maxn 1005
using namespace std;

int A,B,m;

int d[maxn * 2];

int link[maxn][maxn],link1[maxn][maxn];

int id[maxn][maxn];

int ans[maxn * maxn];

int pri;

int main(){
	scanf("%d%d%d",&A,&B,&m);
	fo(i,1,m) {
		int x,y;
		scanf("%d%d",&x,&y);
		pri=max(pri,max(++d[x],++d[y+A]));
		id[x][y]=i;
		int cx=1,cy=1;
		while (link[x][cx]) cx++;
		while (link1[y][cy]) cy++;
		if (cx==cy) {
			link[x][cx]=y;
			link1[y][cy]=x;
			continue;
		}
		int l=x,r=y;
        link[l][cx]=r;
    	while (1){
            int tmp=link1[r][cx];
            link1[r][cx]=l;
            link1[r][cy]=tmp;
         	if (!tmp) break;
            int tmp0=link[tmp][cy];
			link[tmp][cy]=r;
            link[tmp][cx]=tmp0;
            if (!tmp0) break;
            l=tmp;
			r=tmp0;
        }
	}
	printf("%d\n",pri);
	fo(i,1,A) {
		fo(j,1,pri) {
			if (!link[i][j]) continue;
			ans[id[i][link[i][j]]]=j;
		}
	}
	fo(i,1,m) printf("%d ",ans[i]);
	return 0;
}
