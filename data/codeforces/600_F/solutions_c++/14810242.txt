#include<cstdio>
#include<algorithm>
#include<cstring>
#include<climits>
using namespace std;
#define For(i,a,b) for(int i=(a);i<=(b);i++)
#define Forn(i,a,b) for(int i=(a);i>=(b);i--)
#define NC getchar
inline int read(){
    int x=0,f=1;char c=NC();for(;c<'0'||c>'9';c=NC())if(c=='-')f=-1;
    for(;c>='0'&&c<='9';c=NC())x=x*10+c-'0';return x*f;
}
#define N 1010
int na,nb,m;
int l[N][N],r[N][N],color[N*N];
int id[N][N],ans;
int main(){
    na=read(),nb=read(),m=read();
    For(i,1,m){
        int x=read(),y=read();
        int u=1,v=1;
        for(;l[u][x];u++);for(;r[v][y];v++);
        id[x][y]=i;
        if(u==v)l[u][x]=y,r[v][y]=x;
        else{
            l[u][x]=y;
            for(;;){
                int tmp1=r[u][y];
                r[u][y]=x,r[v][y]=tmp1;
                if(!tmp1)break;
                int tmp2=l[v][tmp1];
                l[u][tmp1]=tmp2,l[v][tmp1]=y;
                if(!tmp2)break;
                x=tmp1,y=tmp2;
            }
        }
    }
    for(int i=1;i<=max(na,nb);i++)
        for(int j=1;j<=na;j++)
            if(l[i][j])color[id[j][l[i][j]]]=i,ans=max(ans,i);
    printf("%d\n",ans);
    for(int i=1;i<=m;i++)printf("%d ",color[i]);
}