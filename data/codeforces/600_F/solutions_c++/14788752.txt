#include <bits/stdc++.h>
#define mn 100100
#define mm 2010
using namespace std;
int x[mn], y[mn], deg[mn], color[mn];
int usada[mm][mm], n1,n2,m, ans;

int fix (int k, int aim, int c) {

    int a = x[k], b = y[k], t, c2;
    if(aim != a) {
        a = y[k];
        b = x[k];
    }
    c2 = color[k];
    usada[b][c2] = 0;
    color[k] = c;
    usada[a][c] = k;
    t = usada[b][c];
    usada[b][c] = k;
    if(t != 0) fix(t, b, c2);


}

int paint (int k) {

    int a = x[k], b = y[k], t, c1 = 0, c2 = -1;

    for(int i=1;i<=ans; i++) {
        if(usada[a][i] == 0) c1 = i;
        if(usada[b][i] == 0) c2 = i;
        if(c2 == c1) break;
    }
    color[k] = c1;
    t = usada[b][c1];
    usada[a][c1] = k;
    usada[b][c1] = k;
    if(t != 0 && c1 != c2)  fix(t, b, c2); //t -> aresta pintada com c1 em b, tem que liberar c1 e pintar essa aresta com c2


}

int main () {

    scanf("%d %d %d", &n1, &n2, &m);
    ans = 0;
    memset(deg, 0, sizeof(deg));
    for(int i=1; i<=m; i++) {
        scanf("%d %d", &x[i], &y[i]);
        y[i] += n1;
        deg[x[i]]++;
        deg[y[i]]++;
        ans = max(ans, deg[x[i]]);
        ans = max(ans, deg[y[i]]);
        paint(i);
    }

    printf("%d\n", ans);
    for(int i=1;i<=m; i++) {
        printf("%d ", color[i]);
    }
    printf("\n");


}
