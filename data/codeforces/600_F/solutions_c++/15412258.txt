#include <bits/stdc++.h>
#define N 1005
using namespace std;
int cntl[N],cntr[N];
int used[10050],Asize,Bsize;
int colorA[1005][1005],colorB[1005][1005];
int ans[100005];
int u[100100],v[100100];
int ansize,S;
int j,m,cnt,tmp,ptr;
vector<int> A[1005],B[1005];

int main(){
    cin>>Asize>>Bsize>>m;
    memset(colorA, 0, sizeof(colorA));
    memset(colorB, 0, sizeof(colorB));
    for(int i=1;i<=m;i++){
        int a,b;
        cin>>u[i]>>v[i];
        a=u[i],b=v[i];
        S=max(S,max(++cntl[a],++cntr[b]));

        int co;
        for(co=1;colorA[a][co]!=0 && co<=S;co++){}

        //colorA[a][co]=colorB[b][co]=i;
        //ans[i]=co;
        int t1 = a, t2 = b;
        int t=i;
        int tmp ;

        for(int flag=1; ; flag^=1){
            //cout << "in" << endl;
            if(flag){
                ans[t]=co;
                 //printf("ans[%d] = %d\n" ,t, ans[t]);
                tmp = colorB[t2][co];
                colorA[t1][co]=colorB[t2][co]=t;
                t = tmp;
                t1 = u[tmp];
                colorA[t1][co]=0;
                for(co=1;colorB[t2][co]!=0 && co<=S;co++){}

                if(colorA[t1][co]==0){
                    colorA[t1][co]=colorB[t2][co]=tmp;
                    ans[tmp]=co;
                    break;
                }
            }
            else {
                ans[t]=co;
                 //printf("ans[%d] = %d\n" ,t, ans[t]);
                tmp = colorA[t1][co];
                colorA[t1][co]=colorB[t2][co]=t;
                t = tmp;
                t2 = v[tmp];
                colorB[t2][co]=0;
                for(co=1;colorA[t1][co]!=0 && co<=S;co++){}

                if(colorB[t2][co]==0){
                    colorB[t2][co]=colorA[t1][co]=tmp;
                    ans[tmp]=co;
                    break;
                }
            }

        }
    }
    cout << S << endl;
   for(int i=1;i<=m;i++)
        printf("%d ", ans[i]);
}
