#include <cstdlib>
#include <cstdio>
#include <algorithm>
#include <vector>
#include <queue>
#include <cmath>
#include <stack>
#include <map>
#include <set>
#include <deque>
#include <cstring>
#include <functional>
#include <climits>
#include <list>
#include <ctime>
#include <complex>
 
#define F1(x,y,z) for(int x=y;x<z;x++)
#define F2(x,y,z) for(int x=y;x<=z;x++)
#define F3(x,y,z) for(int x=y;x>z;x--)
#define F4(x,y,z) for(int x=y;x>=z;x--)
#define pb push_back
#define LL long long
#define co complex<double>
 
#define MAX 100005
#define AMAX 1500
#define MOD 1000000007

#define f(c,d) ((1<<(c))*(d))

using namespace std;

int n,m,k,ta,tb,i,ans[MAX],tc;
vector<int> va[2][1005],vb[2][1005],vc[2][1005],vd[2][1005],ve,vf;

int main(){
	scanf("%d%d%d",&n,&m,&k);
	F1(a,0,k){
		scanf("%d%d",&ta,&tb);
		ta--;
		tb--;
		va[0][ta].pb(tb);
		va[1][tb].pb(ta);
		vb[0][ta].pb(a);
		vb[1][tb].pb(a);
		vd[0][ta].pb(va[1][tb].size()-1);
		vd[1][tb].pb(va[0][ta].size()-1);
		ans[a]=-1;
	}
	F1(a,0,n)i=max(i,(int)va[0][a].size());
	F1(a,0,m)i=max(i,(int)va[1][a].size());
	F1(a,0,n)F1(b,0,i)vc[0][a].pb(-1);
	F1(a,0,m)F1(b,0,i)vc[1][a].pb(-1);
	F1(a,0,n)F1(b,0,va[0][a].size()){
		tc=-1;
		ta=-1;
		tb=-1;
		F1(c,0,i){
			if(vc[0][a][c]==-1&&vc[1][va[0][a][b]][c]==-1){
				tc=c;
				break;
			}else if(vc[1][va[0][a][b]][c]==-1)ta=c;
			else if(vc[0][a][c]==-1)tb=c;
		}		
		if(tc!=-1)tb=tc;
		else if(ta==-1||tb==-1)while(1){}
		ve.clear();
		vf.clear();
		ve.pb(a);
		vf.pb(b);
		while(1){
			tc=vc[ve.size()%2][va[1-ve.size()%2][ve.back()][vf.back()]][(ve.size()&1)?tb:ta];
			if(tc==-1)break;
			ve.pb(va[1-ve.size()%2][ve.back()][vf.back()]);
			vf.pb(tc);
		}
		F1(c,0,ve.size())if(ans[vb[c%2][ve[c]][vf[c]]]!=-1){				
			vc[c%2][ve[c]][ans[vb[c%2][ve[c]][vf[c]]]]=-1;
			vc[1-c%2][va[c%2][ve[c]][vf[c]]][ans[vb[c%2][ve[c]][vf[c]]]]=-1;
		}
		F1(c,0,ve.size()){
			ans[vb[c%2][ve[c]][vf[c]]]=(c&1)?ta:tb;
			vc[c%2][ve[c]][(c&1)?ta:tb]=vf[c];
			vc[1-c%2][va[c%2][ve[c]][vf[c]]][(c&1)?ta:tb]=vd[c%2][ve[c]][vf[c]];
		}		
	}
	printf("%d\n",i);
	F1(a,0,k)printf("%d%c",ans[a]+1,a==k-1?'\n':' ');
	//system("pause");
    return 0;
}
