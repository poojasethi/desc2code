#include<cmath>
#include<cstdio>
#include<cstring>
#include<cstdlib>
#include<iostream>
#include<algorithm>

#ifdef WIN32
#define orz "%I64d"
#else
#define orz "%lld"
#endif
#define N 1010
#define M 100010

using namespace std;
typedef long long LL;

int id[N][N],na,nb,m,match[2][N][N],ans,col[M];
int link(int d,int x,int y,int col1,int col2)
{
    int nt=match[d^1][col1][y];
    match[d][col1][x]=y;
    match[d^1][col1][y]=x;
    if (nt==0)
        return match[d^1][col2][y]=0,0;
    else
        link(d^1,y,nt,col2,col1);
    return 0;
}
int main()
{
    scanf("%d%d%d",&na,&nb,&m);
    for (int i=1;i<=m;i++)
    {
        int x,y,c1=1,c2=1;
        scanf("%d%d",&x,&y);
        id[x][y]=i;
        while (match[0][c1][x]) c1++;
        while (match[1][c2][y]) c2++;
        if (c1==c2)
            match[0][c1][x]=y,match[1][c2][y]=x;
        else
            link(0,x,y,c1,c2);
    }
    for (int i=1;i<=max(na,nb);i++)
        for (int j=1;j<=na;j++)
            if (match[0][i][j]) col[id[j][match[0][i][j]]]=i,ans=max(ans,i);
    printf("%d\n",ans);
    for (int i=1;i<=m;i++)
        printf("%d ",col[i]);
    return 0;
}
