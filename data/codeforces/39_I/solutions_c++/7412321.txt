#include<cstdio>
#include<algorithm>
#include<vector>
using namespace std;
vector<int> e[100001];
int n,m,LV[100001],ans = -1;
int dfs(int now,int lv){
    LV[now] = lv;
    for(int i=0;i<e[now].size();i++)
        if(LV[e[now][i]] == -1)
            dfs(e[now][i],lv+1);
}
int main(){
    scanf("%d%d",&n,&m);
    for(int i=1;i<=n;i++) LV[i] = -1;
    for(int i=0,u,v;i<m;i++){
        scanf("%d%d",&u,&v);
        e[u].push_back(v);
    }
    dfs(1,0);
    for(int i=1;i<=n;i++) 
        for(int j=0;j<e[i].size();j++){
            int sv = abs(LV[e[i][j]]-LV[i]-1);
            if(sv != 0 && LV[i] != -1 && LV[e[i][j]] != -1)
                ans = (ans == -1 ? sv : __gcd(ans,sv));
        }
    int n_ans = 0; 
    for(int i=1;i<=n;i++) 
        if(LV[i]%ans == 0 && LV[i] != -1) 
            n_ans++;
    printf("%d\n%d\n",ans,n_ans);
    for(int i=1;i<=n;i++)
        if(LV[i]%ans == 0 && LV[i] != -1)
            printf("%d ",i);
    return 0;
}