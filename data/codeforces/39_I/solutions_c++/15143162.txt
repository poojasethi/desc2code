#include <map>
#include <set>
#include <cmath>
#include <stack>
#include <queue>
#include <string>
#include <vector>
#include <fstream>
#include <sstream>
#include <stdio.h>
#include <string.h>
#include <iostream>
#include <algorithm>
using namespace std;
#define li       	long long int
#define rep(i,to)	for(li i=0;i<((li)(to));i++)
#define pb       	push_back
#define sz(v)    	((li)v.size())
#define bit(n)   	(1ll<<(li)(n))

#define MAX 100005
li depth[MAX];
vector<li> E[MAX];
int main(){
	rep(i,MAX) depth[i]=-1;
	li n,m,a,b,S=-1;
	cin>>n>>m;
	rep(i,m){
		cin>>a>>b;
		E[a-1].pb(b-1);
	}
	queue<li> q;
	q.push(0);
	depth[0]=0;
	while(sz(q)){
		li tmp=q.front();
		q.pop();
		rep(i,sz(E[tmp])){
			if(depth[E[tmp][i]]==-1){
				depth[E[tmp][i]]=depth[tmp]+1;
				q.push(E[tmp][i]);
			}else{
				li d=abs(depth[E[tmp][i]]-(depth[tmp]+1));
				S=(S==-1)?d:__gcd(S,d);
			}
		}
	}
	vector<li> ans;
	rep(i,n)if(depth[i]!=-1 && depth[i]%S==0) ans.pb(i);
	cout<<S<<endl<<sz(ans)<<endl;
	rep(i,sz(ans)) cout<<ans[i]+1<<" "; cout<<endl;
}
