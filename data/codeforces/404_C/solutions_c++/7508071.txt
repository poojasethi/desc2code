#include<cstdio>
#include<algorithm>
#define N 1000005
using namespace std;
struct arr{int d,id;}a[N];
int A[N],B[N],q[N],h,t,cnt,i,n,L;
inline int cmp(const arr &a,const arr &b){return a.d<b.d;}
inline void bfs()
{
  h=0;t=1;
  while (h<t&&t<n)
  {
    int k=++h;
    int num=L-(k!=1);
    while ((num--)&&t<n)
    {
      if (a[t+1].d>a[k].d+1) break;
      if (a[t+1].d<a[k].d+1) return;
      t++;cnt++;
      A[cnt]=a[k].id;
      B[cnt]=a[t].id;
    }
  }
}
int main()
{
  scanf("%d%d",&n,&L);
  for (i=1;i<=n;i++) 
    scanf("%d",&a[i].d),a[i].id=i;
  sort(a+1,a+n+1,cmp);
  if (a[1].d||!a[2].d) {puts("-1");return 0;}
  bfs();
  if (t<n) puts("-1");
  else 
  {
    printf("%d\n",cnt);
    for (i=1;i<=cnt;i++)
      printf("%d %d\n",A[i],B[i]);
  }
  return 0;
}  
