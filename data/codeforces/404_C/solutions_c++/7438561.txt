#include <cstdio>
#include <cstring>
#include <map>
#include <stack>
#include <algorithm>
#include <vector>
#include <queue>
#include <iostream>
using namespace std;
#define N 105000
int n,m,flag;
pair<int,int> p[N];
int f[N];


int main() {
	scanf("%d%d",&n,&m);
	int d;
	for(int i=1;i<=n;i++) {
		scanf("%d",&d);
		p[i] = make_pair(d,i);
	}
	sort(p+1,p+n+1);

	int l=1,r=2,cnt = 0;
	while(r<=n){
		while((cnt==m || p[l].first+1!=p[r].first) && p[l].first<p[r].first) l++,cnt=1;
//		printf("%d %d %d\n",l,p[l].second,p[l].first);
		if(p[l].first+1!=p[r].first) break;
		int u=p[l].second,v=p[r].second;
		f[v]=u;
		cnt++;
		r++;
	}
	if(p[1].first>0 || r<=n) puts("-1");
	else{
		printf("%d\n",n-1);
		for(int i=1;i<=n;i++)
			if(f[i])	printf("%d %d\n",f[i],i);
	}
	return 0;
}
