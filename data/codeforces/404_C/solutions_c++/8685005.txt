#include <stdio.h>
const int maxn = 1000001;
int d[maxn];
int c[maxn];
int a[maxn];
int next_id[maxn];
int id[maxn];
int co[maxn];
int main(){
	int n,k;
	scanf("%i %i",&n,&k);
	for(int i = 1; i <= n; i ++){
		scanf("%i",&d[i]);
		next_id[i] = id[d[i]];
		id[d[i]] = i;
		c[d[i]] ++;
		co[i] = k - 1;
	}
	co[id[0]] = k;
	if(c[0] > 1 || c[0] == 0 || c[1] > k){
		puts("-1");
		return 0;
	}
	for(int i = 2; i < n; i ++){
		if(c[i]){
			if(c[i - 1] == 0 || (c[ i ] + c[i - 1] - 1) / c[i-1] >= k){
				puts("-1");
				return 0;
			}
		}
	}
	printf("%i\n", n - 1);
	for(int i = 1; i <= n; i ++){
		if(d[i] != 0){
			int in = id[d[i] - 1];
			if(co[in] == 0)
				in = id[d[i] - 1] = next_id[in];
			co[in] --;
			printf("%i %i\n", i, in);
		}
	}
	return 0;
}