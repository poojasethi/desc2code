#include<cstdio>
#include<algorithm>
#include<cstring>
using namespace std;
#define FOR(i,l,r) for(int i=l;i<=r;i++)
#define FILL(a,b) memset(a,b,sizeof(a))
#define INF 1000000000
#define N 1200001
int n,m,k,e,t[N];
struct node{
	int x,d;
}p[N],q[N];
bool cmp(node a,node b){
	return a.d < b.d;
}
int main(){
	scanf("%d%d",&n,&k);
	FOR(i,1,n)scanf("%d",&p[i].d),p[i].x=i;
	sort(p+1,p+n+1,cmp);
	if(p[1].d != 0){
		puts("-1");
		return 0;
	}
	int j=1;
	FOR(i,2,n){
		while((t[p[j].x] >= k || p[j].d + 1 != p[i].d)&& j<=n)j++;
		if(t[p[j].x] >= k || p[j].d + 1 != p[i].d || j>n){
			puts("-1");
			return 0;
		}
		t[p[j].x]++; t[p[i].x]++;
		q[++e].d=p[i].x; q[e].x=p[j].x;
	}
	printf("%d\n",e);
	FOR(i,1,e)printf("%d %d\n",q[i].d,q[i].x);
	return 0;
}