#include<bits/stdc++.h>
using namespace std;
#define ULL unsigned long long
#define LL long long
#define INF 0x3f3f3f3f
#define rep(i,n) for(int i = 0; i < n; ++i)
#define Rep(i,n) for(int i = 1; i <= n; ++i)

vector<int>vec[100100];
int cur[100100], cnt[100100], x[100100], y[100100];

int main()
{
	int k, n;
	cin >> n >> k;
	int d;
	Rep(i, n) {
		scanf("%d", &d);
		vec[d].push_back(i);
	}
	if(vec[0].size() != 1) {
		puts("-1");
		return 0;
	}
	int tot = 0;
	Rep(d, n) {
		rep(i, vec[d].size()) {
			while(cur[d-1] < vec[d-1].size() && cnt[vec[d-1][cur[d-1]]] == k) ++cur[d-1];
			if(cur[d-1] >= vec[d-1].size()) {
				puts("-1");
				return 0;
			}
			++cnt[x[tot]=vec[d-1][cur[d-1]]];
			++cnt[y[tot++]=vec[d][i]];
		}
	}
	cout << n-1 << endl;
	rep(i, n-1) printf("%d %d\n", x[i], y[i]);
	return 0;
}
