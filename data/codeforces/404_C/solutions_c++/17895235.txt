#include <bits/stdc++.h>
#define MAXN 100000
#define ri(n) scanf("%lld",&n)
#define rii(n,m) scanf("%lld %lld",&n,&m)
#define FOR(i,l,r) for(int i=l;i<r;i++)
using namespace std;

long long N, K, n;
vector<long long> A[MAXN];

int main() {
	rii(N,K); K--;
	FOR(i,1,N+1) {ri(n); A[n].push_back(i);}
	if(A[1].size()>K+1 || A[0].size()!=1)        {printf("-1\n"); return 0;}
	FOR(i,1,N-1) if(A[i+1].size()>A[i].size()*K) {printf("-1\n"); return 0;}
	printf("%I64d\n",N-1);
	FOR(i,1,MAXN) {
		FOR(j,0,A[i].size()) {
			printf("%I64d %I64d\n",A[i-1][j%A[i-1].size()],A[i][j]);	
		}
	}
}