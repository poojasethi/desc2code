#include <bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

using namespace std;

int n,k,cnt[100005],d[100005];

vector<int> V[100005];
int p[100005];

void fail(){
  printf("-1\n");
  exit(0);
}

int main(){
  scanf("%d %d",&n,&k);
  FI(i,1,n){
    scanf("%d",&d[i]);
    cnt[d[i]]++;
    V[d[i]].push_back(i);
  }
  if(cnt[0]!=1 || cnt[1]>k) fail();
  FI(i,2,n-1){
    if(!cnt[i-1] && cnt[i]) fail();
    if(cnt[i]){
      if(1+(cnt[i]+cnt[i-1]-1)/cnt[i-1]>k) fail();
    }
  }
  printf("%d\n",n-1);
  FI(i,1,n-1){
    FI(j,0,cnt[i]-1){
      printf("%d %d\n",V[i][j],V[i-1][p[i-1]]);
      p[i-1]++;
      if(p[i-1]==cnt[i-1]) p[i-1]=0;
    }
  }
  return 0;
}