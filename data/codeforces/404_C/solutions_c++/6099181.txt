#include<stdio.h>
#include<algorithm>
using namespace std;
const int N=100005;
struct node{
	int d,id,num;
}t[N];
int cmp(node a,node b){
	return a.d<b.d;
}
int e1[N],e2[N];
int main(){
	int n,k;
	scanf("%d%d",&n,&k);
	int loc=-1,num=0;
	for(int i=1;i<=n;i++){
		scanf("%d",&t[i].d);
		t[i].id=i;
		t[i].num=0;
	}
	sort(t+1,t+1+n,cmp);
	int goal=1,p=1,cnt=0;
	if(t[1].d!=0){
		goal=0;
		goto out;
	}
	for(int i=2;i<=n;i++){
more:;
		if(p>i){
			goal=0;
			goto out;
		}
		if(t[i].d==t[p].d+1&&t[p].num<k){//能连接
			e1[cnt]=t[i].id;
			e2[cnt++]=t[p].id;
			t[i].num++;
			t[p].num++;
		}
		else{
			p++;
			goto more;
		}
	}
	//printf("%d\n",n-1);
out: ;
	if(goal==0){
		printf("-1\n");
		return 0;
	}
	printf("%d\n",cnt);
	for(int i=0;i<cnt;i++)
		printf("%d %d\n",e1[i],e2[i]);
	return 0;
}