#include <stdio.h>
#include <vector>
using namespace std;
#define TT 100000+2
vector<int> p[TT];
vector<pair<int,int> >q;
int main ( ) {
	int n,k;
	scanf("%d%d",&n,&k);
		int d,max=0;
		for (int i=1;i<=n;i++) {
			scanf("%d",&d);
			p[d].push_back(i);
			if (d>max)
			max=d;
		}
		if (p[0].size( )!=1) {
			printf("-1\n");
			return 0;
		}
		for (int j=1;j<=max;j++) {
			int m,s=0;
			if (j>1)
			m=1;
			else
			m=0;
			for (int z=0;z<p[j].size( );z++) {
				if (m==k) {
					if (j>1)
					m=1;
					else
					m=0;
					s++;
				}
				if (s==p[j-1].size( )) {
					printf("-1\n");
					return 0;
				}
				q.push_back(make_pair(p[j-1][s],p[j][z]));
				m++;
				
			}
		}
		printf("%d\n",n-1);
		for (int b=0;b<q.size( );b++)
		printf("%d %d\n",q[b].first,q[b].second);
	return 0;
}

 	 	    	  	 	 		   	 	