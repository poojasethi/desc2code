#include <cstdio>
#include <vector>

using namespace std;

int n, k, len;
vector<int> dis[1000010];
vector<pair<int,int> > ans;

void init() {
	scanf("%d%d",&n,&k);
	for (int i = 1; i <= n; i++) {
		int tmp;

		scanf("%d", &tmp);
		dis[tmp].push_back(i);
		len = max(len, tmp);
	}
}

void solve() {
	if (dis[0].size() != 1) {
		printf("-1");
		return;
	}

	for (int i = 1; i <= len; i++)  {
		int edge = (i != 1), total = 0;

		for (int j = 0; j < dis[i].size(); j++) {
			if (edge == k) {
				edge = (i != 1);
				total++;
			}

			if (total == dis[i-1].size()) {
				printf("-1\n");
				return;
			}

			ans.push_back(make_pair(dis[i-1][total], dis[i][j]));
			edge++;
		}
	}

	printf("%d\n", ans.size());
	for (int i = 0; i < ans.size(); i++)
		printf("%d %d\n", ans[i].first, ans[i].second);
}

int main() {
	init();
	solve();
}
