#include <cstdio>
#include <map>
#include <vector>
using namespace std;

typedef pair<int,int> P;
const int MAX_N = 1e6+5;
int n,k;
vector<P> ans;
vector<int> v[MAX_N];

int main(){
	scanf("%d%d", &n, &k);
	int m=0;
	for(int i=1;i<=n;++i){
		int t; 
		scanf("%d",&t);
		v[t].push_back(i);
		m=max(m,t);
	}
	if(v[0].size()>1){
		printf("-1\n");
		return 0;
	}
	
	for(int i=1;i<=m;++i){
		int edge=(i!=1),cnt=0;
		for(int j=0; j<v[i].size();++j){
			
			if(edge == k){
				edge=(i!=1);
				cnt++;
			}
			if(cnt==v[i-1].size()){
				printf("-1\n");
				return 0;
			}
			ans.push_back(P(v[i-1][cnt], v[i][j]));
			edge++;
		}		
	}
	printf("%d\n", n-1);
	for(int i=0;i<ans.size();++i){
		printf("%d %d\n", ans[i].first, ans[i].second);
	}
	
	return 0;
}
