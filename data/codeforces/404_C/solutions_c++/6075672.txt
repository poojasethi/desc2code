#include <iostream>
#include <vector>
using namespace std;
typedef long long ll;
vector<ll> a[1000001];
ll n,k;
vector<pair<ll,int> > e;
int main(){
	cin.sync_with_stdio(false);
	cin >> n >> k;
	for(ll i = 0; i < n; ++i){
		ll t; cin >> t;
		a[t].push_back(i+1);
	}
	if(a[0].size()>1){
		cout << "-1\n";
		return 0;
	}
	for(ll i = 1; i <= 1000000; ++i){
		if(a[i].size()>(k-1+(i==1))*a[i-1].size()){
			cout << "-1\n";
			return 0;
		}
		int m = 0;
		for(int j = 0; j < a[i-1].size(); ++j){
			for(int l = 0; l < (k-1+(i==1)); ++l){
				if(m==a[i].size())
					break;
				e.push_back(make_pair(a[i-1][j],a[i][m]));
				m++;
			}
		}

	}
	cout.sync_with_stdio(false);
	cout << e.size() << '\n';
	for(int i = 0; i < e.size(); ++i)
		cout << e[i].first << ' ' << e[i].second << '\n';
}
