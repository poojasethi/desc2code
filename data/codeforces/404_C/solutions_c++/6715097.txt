#include<iostream>
#include<algorithm>
#include<vector>
#include<map>
using namespace std;
#define ll long long
vector<int> v[1000005];
vector<pair<int,int> > e;
int main(){
    ll k,n;
    cin>>n>>k;
    for(int i=0; i<n; i++){
        int d;
        cin>>d;
        v[d].push_back(i);
    }
    if(v[0].size()!=1){
        cout<<-1;
        return 0;
    }
    for(int i=1; i<n;i++){
        if(v[i].size() > v[i-1].size()*k){
            cout<<-1;
            return 0;
        }
        for(int j=0; j <v[i].size(); j++)
            e.push_back(make_pair(v[i][j], v[i-1][j/k]));
        if(i==1)
            --k;// edg to father
    }
    cout<< e.size()<<endl;
    for(int i=0; i<e.size(); i++)
        cout<<e[i].first+1<<" "<<e[i].second+1<<endl;
    return 0;
}
