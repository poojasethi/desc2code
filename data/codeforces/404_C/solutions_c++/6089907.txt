	#include<iostream>
	#include<vector>
	#include<cstdio>
	using namespace std;
	
	vector<int> a[100000];
	
	int main()
	{
		int n,k;
	
		cin>>n>>k;
	
		int max=-1;
		for(int i=0;i<n;i++)
		{
			int temp;
			scanf("%d",&temp);
	
			if(temp>max)
				max=temp;
	
			a[temp].push_back(i);
		}
	
		//int prev=a[0].size();
		
		if(a[0].size()!=1 || a[1].size()> k)
		{
			cout<<-1;
			return 0;
		}
		
		
		for(int i=2;i<=max;i++)
		{
			if((long long)a[i].size() > (long long)(k-1)*a[i-1].size())
			{
				cout<<-1;
				return 0;
			}
		}
	
	
	
	
	
	
		cout<<n-1<<endl;
	
		
		for(int i=1;i<=max;i++)
		{
			int x=0;
	
			for(int j=0;j<a[i].size();j++)
			{
				printf("%d %d\n",a[i-1][x] +1,a[i][j] +1);
				x=(x+1)%a[i-1].size();
			}
		}
	
		return 0;
	
	
	}
