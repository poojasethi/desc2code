#include<bits/stdc++.h>

using namespace std;

int main()
{
	int n,k;
	cin>>n>>k;
	vector<vector<int> > dists(n);
	int count[n];
	for(int i=0;i<n;++i)count[i]=0;
	int cd;
	for(int i=0;i<n;++i)
	{
		cin>>cd;
		dists[cd].push_back(i+1);
		count[cd]++;
	}
	bool isposs=true;
	int prev;
	if(count[0]!=1)isposs=false;
	else{
		prev=1;
		for(int dist=1;dist<n && isposs;++dist)
		{
			if((long long)(count[dist])>(long long)(k-1)*(prev) ){if (!((long long)(count[dist])<=(long long)(k)*prev && dist==1)){isposs=false;}}
			prev=count[dist];		
		}
	}
	if(!isposs)
	{
		cout<<"-1\n";
	}
	else
	{
		cout<<(n-1)<<endl;
		int pc,c;
		int psize;
		for(int i=1;i<n && count[i]!=0;i++)
		{
			c=0;
			psize=count[i-1];
			pc=dists[i-1][c];
			for(int j=0;j<dists[i].size();++j)
			{
				cout<<pc<<" "<<dists[i][j]<<endl;
				c++;
				pc=dists[i-1][c%psize];
			}
		}
	}
	return 0;
}
