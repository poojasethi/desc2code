#include <bits/stdc++.h>
#define fi first
#define se second
#define maxn 110000

using namespace std;

typedef long long int Lint;
typedef pair<Lint,Lint> ii;
ii ar[maxn];
Lint N,K,tut[maxn],asd[maxn];

int main(){
	Lint mx=0,ans=0;
	scanf(" %I64d %I64d",&N,&K);
	for(int i=1;i<=N;i++){
		scanf(" %I64d",&ar[i].fi);
		ar[i].se=i;
		tut[ar[i].fi]++;
		mx=max(ar[i].fi,mx);
	}
	sort(ar+1,ar+1+N);
	if(ar[2].fi==0)
		ans=1;
	for(int i=1;i<=mx;i++)
		if(i==1 && tut[0]*K<tut[i])
			ans=1;
		else if(i!=1 && tut[i-1]*(K-1)<tut[i])
			ans=1;
	if(ans){
		printf("-1\n");
		return 0;
	}
	for(int i=1;i<=N;i++)
		tut[ar[i].fi]=i;
	printf("%I64d\n",N-1);
	for(int i=1,qw=0;i<=mx;i++){
		qw=0;
		for(int j=tut[i-1]+1;j<=tut[i];j++){
			if(asd[tut[i-1]-qw]>=K)
				qw++;
			asd[tut[i-1]-qw]++;
			asd[j]++;
			printf("%I64d %I64d\n",ar[tut[i-1]-qw].se,ar[j].se);
		}
	}
	return 0;
}
