#include<bits/stdc++.h>

using namespace std;

vector < int > V[100005];
 
long long W[100005],n,k,x,i,j,l,s;

int main(){

	cin >> n >> k;

	for(i=1;i<=n;i++){
		cin >> x;
		V[x].push_back(i);
	}

	for(i=1;i<=n;i++)
		if(V[i].size() > V[i-1].size() * (k-1) + (i==1) || V[0].size() != 1){
			cout << -1;
			return 0;
		}

	cout << n-1 << endl;

	for(i=0;i<=n;i++)
		for(s=j=0;j<V[i].size();j++)
			for(l=1;l<=k;l++){
				if(s == V[i+1].size() || W[ V[i][j] ] == k)
					break;
				cout << V[i][j] << " " << V[i+1][s++] << endl;
				W[ V[i][j] ]++; W[ V[i+1][s-1] ]++;
			}

	return 0;
}
