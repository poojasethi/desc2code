#include"stdio.h"
#include"algorithm"
#include"string.h"
#include"vector"
using namespace std;
vector<int>v[111111];
int vis[111111];
struct dis{
	int x,i;
}d[111111]; 
bool cmp1(dis a,dis b)
{
	return a.x<b.x;
}
int main()
{
	int n,k,i,ling=0,j,key=1,m;
	m=0;
	scanf("%d%d",&n,&k);
	for(i=1;i<=n;i++)
	{scanf("%d",&d[i].x);
	d[i].i=i;
	if(d[i].x==0){ling++;}
	}
	if(ling!=1){printf("-1\n");return 0;}
	sort(d+1,d+n+1,cmp1);
	for(i=1;i<=n;i++)
	{v[i].clear();
	vis[i]=0;}
	j=1;
	for(i=2;i<=n;i++)
	{
		if(d[i].x<=d[j].x){key=0;break;}
		if((d[i].x-d[j].x==1)&&(vis[d[j].i]<k&&vis[d[i].i]<k))
		{
			vis[d[i].i]++;
			vis[d[j].i]++;
			v[d[j].i].push_back(d[i].i);
			m++;
		}
		else {j++;i--;}
	}
	if(!key){printf("-1\n");return 0;}
	printf("%d\n",m);
	for(i=1;i<=n;i++)
	{
		for(j=0;j<v[i].size();j++)
		{
			printf("%d %d\n",i,v[i][j]);
		}
	}
	
}
 			   			 			 	 	