#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<cmath>
#include<algorithm>
#include<iostream>
using namespace std;
int i,j,k,l,n,m,s,an,sum,tot,len,K;
const int N=110000;
int a[N],num[N],f[N],anx[N],any[N];
bool com(const int &o,const int &p)
{
	return a[o]<a[p];
}
int main()
{
	scanf("%d%d",&n,&K);
	for (int i=1;i<=n;i++)
	scanf("%d",&a[i]),num[i]=i;
	sort(&num[1],&num[n+1],com);
	if (a[num[1]]!=0) {printf("-1\n");return 0;}
	int i;
	int l=1;
	for (i=2;i<=n;i++)
	{
		int x=num[i];
		while ((l<=i)&&((a[num[l]]!=a[x]-1)||(f[num[l]]==K))) l++;
		if (l>i)  {printf("-1\n");return 0;}
		anx[++an]=num[l],any[an]=x;
		f[num[l]]++;f[x]++;
	}
	printf("%d\n",an);
	for (int i=1;i<=an;i++)
	printf("%d %d\n",anx[i],any[i]);
	return 0;
}
	
		
