#include<stdio.h>
#include<algorithm>
using namespace std;
const int maxn=4100,maxb=12,mod=1000000007;
int n,K,A[maxn],des;
int dp[maxn][maxn]={0},dp2[maxn][maxn]={0},ans=0;
int cnt(int x) { return (!x||x&1)?0:cnt(x>>1)+1; }
void Mod(int &x)
{
	if(x>=mod) x%=mod;
}
void DP(int d,int x)
{
	int i,t;
	for(i=0;i<maxn;i++)
		if(dp[d][i])
		{
			t=(cnt(x)>cnt(i)?x:i+x);
			dp[d+1][t]+=dp[d][i];
			if(t>=des) dp2[d+1][t]+=dp[d][i];
			else dp2[d+1][t]+=dp2[d][i];
			Mod(dp[d+1][t]);
			Mod(dp2[d+1][t]);
		}
}
int main()
{
#ifndef ONLINE_JUDGE
	freopen("data.in","r",stdin);
	freopen("data.out","w",stdout);
#endif
	int i,j;
	scanf("%d%d",&n,&K);
	des=1<<(--K);
	dp[0][0]=1;
	for(i=0;i<n;i++)
	{
		scanf("%d",&A[i]);
		if(A[i]) DP(i,A[i]>>1);
		else DP(i,1),DP(i,2);
	}
	//for(i=0;i<=n;i++) { for(j=0;j<maxn;j++) printf("%d ",dp[i][j]); printf("\n"); }
	for(i=0;i<maxn;i++)
		ans+=dp2[n][i],Mod(ans);
	printf("%d\n",ans);
	return 0;
}
