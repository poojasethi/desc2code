#include <iostream>
#include <vector> 
#include <algorithm>
#include <math.h>
#include <set>

using namespace std;

enum {LEN = 5001};
enum {mod = 1000000007};

long long n, a[LEN], p[LEN][LEN], k, cnt;

int main() {
//	freopen("input.txt", "r", stdin);
//	freopen("output.txt", "w", stdout);
	cin >> n >> k;
	p[0][0] = 1;
	for (long long i = 0; i < n; i++) {
		cin >> a[i];
		for (long long j = 0; j < (1 << (k - 1)); j++) {
			if (p[i][j]) {
				p[i][j] %= mod;
				if (a[i] != 4) {
					p[i + 1][j + 1] += p[i][j];
				}
				if (a[i] != 2) {
					if (j % 2 == 0)
						p[i + 1][j + 2] += p[i][j];
					else
						p[i + 1][2] += p[i][j];
				}
			}
		}
	}
	long long res = 0;
	for (long long i = 0; i <= n; i++) {
		if (p[i][1 << (k - 1)]) {
			cnt = p[i][1 << (k - 1)];
			for (long long j = i + 1; j <= n; j++) {
				if (!a[j - 1]) {
					cnt *= 2;
					cnt %= mod;
				}
			}
			res += cnt;
			res %= mod;
		}
	}
	cout << res;
	return 0;
}




		