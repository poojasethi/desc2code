#include <iostream>
#include <cstdio>
using namespace std;
long long to[200000],ne[200000],fi[100001],a[100001],f[100001][2][2],
	u[100001],i,n,x,y,tot=0;
void add(long long x,long long y)
{
	to[++tot]=y;ne[tot]=fi[x];fi[x]=tot;
}
void dp(long long x)
{
	u[x]=0;
	long long s1=0,s2=0,s3=0,s4=0,s5=0;
	f[x][0][0]=f[x][0][1]=f[x][1][0]=f[x][1][1]=a[x];
	for (long long i=fi[x];i;i=ne[i])
	if (u[to[i]])
	{
		dp(to[i]);
		f[x][1][1]=max(f[x][1][1],max(f[to[i]][1][1],max(s2+f[to[i]][0][1],
			max(max(s4+f[to[i]][0][1],s3+f[to[i]][0][0]),
				max(s5+f[to[i]][0][0],s1+f[to[i]][1][0]))+a[x])));
		s3=max(s3,max(s1+f[to[i]][0][1],s2+f[to[i]][0][0]));
		s4=max(s4,s1+f[to[i]][0][0]);
		f[x][0][0]=max(f[x][0][0],f[to[i]][0][0]+a[x]);
		f[x][0][1]=max(f[x][0][1],max(f[to[i]][0][1],s4+a[x]));
		f[x][1][0]=max(f[x][1][0],max(s3,f[to[i]][1][0])+a[x]);
		s1=max(s1,f[to[i]][0][0]);
		s2=max(s2,f[to[i]][0][1]);
		s5=max(s5,f[to[i]][1][0]);
	}
	f[x][0][1]=max(f[x][0][1],f[x][0][0]);
	f[x][1][0]=max(f[x][1][0],f[x][0][1]);
	f[x][1][1]=max(f[x][1][1],f[x][1][0]);
}
int main()
{
		scanf("%I64d\n",&n);
		for (i=1;i<=n;++i) scanf("%I64d",&a[i]),u[i]=1;scanf("\n");
		for (i=1;i<n;++i)
		{
			scanf("%I64d%I64d\n",&x,&y);
			add(x,y);add(y,x);
		}
		dp(1);
		printf("%I64d\n",f[1][1][1]);
}