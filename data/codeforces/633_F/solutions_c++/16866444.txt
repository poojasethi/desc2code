#include <bits/stdc++.h>
#define filein(t) freopen(t, "r", stdin)
#define fileout(t) freopen(t, "w", stdout)
#define f first
#define s second
#define cs 137771
#define ll long long
#define mp make_pair
#define BIT(i, j) ((j >> i) & 1)
#define N 200005
#define NN 200005
#define ln 1e9+1
#define oo 1000000007
#define Pa pair < double, int >
#define PD pair < double, int >
#define Line pair < Pa, ll >
#define PP pair < ll, Pa >
#define Pii pair < Pa, Pa >

using namespace std;

vector < int > a[N];
ll Val[N], DP[N][5], n, ans;

void DFS(int u, int pre)
{
    DP[u][1] = DP[u][2] = Val[u];
    ll Ma = 0;
    for(int i=0; i<a[u].size(); i++)
    {
        int v = a[u][i];
        if(v == pre)    continue;
        DFS(v, u);
        ans = max(ans, DP[u][3] + DP[v][1]);
        ans = max(ans, DP[v][3] + DP[u][1]);
        ans = max(ans, DP[u][2] + DP[v][2]);
        DP[u][3] = max(DP[u][3], max(DP[v][2] + DP[u][1], Ma + DP[v][1] + Val[u]));
        DP[u][3] = max(DP[u][3], DP[v][3] + Val[u]);
        DP[u][2] = max(DP[u][2], max(DP[v][2], DP[u][1] + DP[v][1]));
        DP[u][1] = max(DP[u][1], DP[v][1] + Val[u]);
        Ma = max(Ma, DP[v][2]);
    }
}

int main()
{
   // filein("inp.txt");  fileout("out.txt");
    int u, v;
    cin >> n;
    for(int i=1; i<=n; i++)
        cin >> Val[i];
    for(int i=1; i<n; i++)
    {
        cin >> u >> v;
        a[u].push_back(v);
        a[v].push_back(u);
    }
    DFS(1, 0);
    ans = max(ans, max(DP[1][2], DP[1][1]));
    ans = max(ans, DP[1][3]);
    cout << ans;
}
