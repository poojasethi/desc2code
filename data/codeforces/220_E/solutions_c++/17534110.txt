#include<bits/stdc++.h>
#define st first
#define nd second
#define pb push_back
#define mp make_pair
#define mod 1000000007
#define endl '\n'
#define endll puts("")
#define mp3(x,y,z) mp(x,mp(y,z))
#define inf mod
#define pii pair<int,int>
#define ort (bas+son>>1)
#define sol (root+root)
#define sag (sol+1)
using namespace std;
typedef long long ll;
const int N = 2e5+3;
int n,m,i,j,l,r,d,u,ii,jj,h[N];
ll st[N][3],k,t,hh[N],x,y,z,s;
map<int,int> MP;
ll f(int x,int d)
{
	ll t=0;
	for(;x;x-=x&-x)
		t+=st[x][d];
	return t;
}
void up(int x,int d,int k)
{
	for(;x and x<=s;x+=x&-x)
		st[x][d]+=k;
}
int main()
{
	cin>>n>>k;
	for(i=1;i<=n;i++)
	{
		scanf("%d",h+i);
		hh[i]=h[i];
	}
	sort(hh+1,hh+1+n);
	for(i=1;i<=n;i++)
		if(hh[i]!=hh[i-1])
			MP[hh[i]]=++s;
	for(i=n;i;i--)
	{
		hh[i]=hh[i+1]+f(MP[h[i]]-1,0);
		up(MP[h[i]],0,1);
	}
	r=1;
	for(i=1;i<n;i++)
	{
		up(MP[h[i]],1,1);
		while(1)
		{
			x=hh[1]-y-z;
			if(i==r)
				r++;
			else if(x<=k)
			{
				if(r<=n)
					t+=n-r+1;
				if(r-i>1)
				{
					y-=hh[i+1]-hh[i+2]-f(MP[h[i+1]]-1,2);
					z-=f(s,1)-f(MP[h[i+1]],1);
					up(MP[h[i+1]],2,-1);
				}
				x=hh[1]-y-z;
				break;
			}
			else
			{
			
				y+=hh[r]-hh[r+1];
				z+=f(s,1)-f(MP[h[r]],1);
				up(MP[h[r]],2,1);
				r++;
				x=hh[1]-y-z;
			}
		}
	}
	cout<<t<<endl;
}
