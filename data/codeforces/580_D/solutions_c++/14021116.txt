#include <bits/stdc++.h>
using namespace std;

typedef long long ll;
const int maxn = 18;
int n, m, k, x, y, c, a[maxn], G[maxn][maxn];
ll ans, d[1<<maxn][maxn];

int count(int s) {
	int res=0;
	for(; s; s >>= 1) res += (s & 1);
	return res;
}

int main() {
	scanf("%d%d%d", &n, &m, &k);
	for(int i=0; i < n; i++) {
		scanf("%d", &a[i]);	
		d[1<<i][i]=a[i];
	}
	for(; k--;) {
		scanf("%d%d%d", &x, &y, &c);
		G[--x][--y]=c;
	}
	for(int i=0; i < (1<<n); i++)
		for(int j=0; j < n; j++) {
			if(!(i >> j & 1)) continue;
			for(int k=0; k < n; k++) {
				if(i >> k & 1) continue;
				d[i|1<<k][k]=max(d[i|1<<k][k], d[i][j]+a[k]+G[j][k]);
			}
			if(count(i) == m) ans=max(ans, d[i][j]);
		}
	printf("%I64d\n", ans);
	return 0;
}
	  				    	 					 	 							  	