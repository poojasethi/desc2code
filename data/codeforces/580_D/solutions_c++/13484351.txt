#include <cstdio>
#include <algorithm>
#include <iostream>
#include <cstring>
#define int long long
using namespace std;
int i,j,k,dp[(1<<18)+8][19],n,m,mat[19][19],d[19],res,a,b,c;
int f(int x,int y){
	if(x==0)
	return 0;
	if(dp[x][y]!=-1)
	return dp[x][y];
	int i,j,k,res=0;
	for(i=0;i<n;i++)
	   if(x&(1<<i))
	   res=max(res,f(x^(1<<i),i)+mat[i][y]+d[i]);
	return dp[x][y]=res;
} 
main(){
	memset(dp,-1,sizeof dp);
	scanf("%d %d %d",&n,&m,&k);
	for(i=0;i<n;i++)
	scanf("%d",&d[i]);
	for(i=0;i<k;i++){
		scanf("%d %d %d",&a,&b,&c);
		a--,b--;
		mat[b][a]=c;
	}
	for(i=0;i<(1<<n);i++)
	if(__builtin_popcount(i)==m)
	res=max(res,f(i,n));
	printf("%lld\n",res);
	return 0;
}
