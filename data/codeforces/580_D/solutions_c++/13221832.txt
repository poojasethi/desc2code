#include <bits/stdc++.h>

using namespace std;
typedef long long ll;
const ll oo=10000000000007;
int n,m,k;
ll a[300000][20];
ll b[20];
ll kk[20][20];


ll f(ll ma ,ll last)
{
   
ll x=0;
for(int i=0;i<n;i++) if(ma&(1<<i)) x++;
if(x==m) return 0;

    ll & ret =a[ma][last];
    if(ret!=-1)  return ret;
  ll u=-1;
  for(int i=0;i<n;i++)
   {
       if((ma&(1<<i))) continue;

       u=max(u,  f((ma|(1<<i)),i)+kk[last][i] +b[i]     );



   }



return ret=u;

}



int main(){

ll  i,x,y,c;
memset(a,-1,sizeof(a));
memset(kk,0,sizeof(kk));
cin>>n>>m>>k;
for(i=0;i<n;i++) cin>>b[i];

for(i=0;i<k;i++)
{
    cin>>x>>y>>c;

   kk[x-1][y-1]=c;



}

cout<<f(0,19);




    return 0;
}