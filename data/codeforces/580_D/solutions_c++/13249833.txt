#include<bits/stdc++.h>
using namespace std;
typedef long long ll;
ll r[20][20],sat[20],n,m,k,mem[1<<18][18];
ll solve(int mask,int cur,int c)
{
    if(c==m)   return sat[cur];
    mask&=~(1<<cur);
    ll &ret=mem[mask][cur];
    if(ret!=-1) return ret;
    ret=0;
    for(int i=0;i<n;i++) if(mask&(1<<i))
        ret=max(ret,r[cur][i]+sat[cur]+solve(mask,i,c+1));
    return ret;
}
int main()
{
    ios_base::sync_with_stdio(false);
    cin.tie(0);
    cout.tie(0);
    ll ans=0;
    cin>>n>>m>>k;
    memset(mem,-1,sizeof mem);
    for(int i=0;i<n;i++)   cin>>sat[i];
    for(int i=0;i<k;i++)
    {
        int a,b;
        cin>>a>>b;
        cin>>r[--a][--b];
    }
    for(int i=0;i<n;i++)
        ans=max(ans,solve((1<<n)-1,i,1));
    cout<<ans;
    return 0;
}