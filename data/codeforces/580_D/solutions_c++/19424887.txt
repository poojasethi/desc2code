#include<bits/stdc++.h>
#define rep(i,a,b) for(int i = int(a); i < int(b) ; i++)

using namespace std;

long long g[20][20], pd[1<<19][20];
//g[i][j] = custo de satisfacao
int n, m, k;
int c[20];
long long solve(int mask, int ult){
	if((__builtin_popcount(mask))== m) return 0;
	if(pd[mask][ult] != -1) return pd[mask][ult];
	long long ans = 0;
	rep(i, 0, n){
		if((mask >> i) & 1) continue;
		ans = max(ans, c[i] + g[ult][i] +solve(mask | (1 << i), i));
	}
	return pd[mask][ult] = ans;
}
int main(){
	cin>>n>>m>>k;
	rep(i, 0, n)
		cin>>c[i];
	rep(i, 0, k){
		long long  a, b, cs;
		cin>>a>>b>>cs;
		a--;
		b--;
		g[a][b] = cs;
	}
	memset(pd, -1, sizeof(pd));
	long long  ans = 0;
	rep(i, 0, n){
		ans = max(ans, c[i] + solve(1<<i, i));
	}
	cout<<ans<<endl;
	return 0;
}

