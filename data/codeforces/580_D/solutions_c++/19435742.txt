#include<stdio.h>
#include<string.h>
#include<math.h>
#include<algorithm>
using namespace std;
#define ll long long int

ll dp[1<<19][20],ans;
ll n,m,k,a[20],c[20][20],x,y,z;

ll dfs(int xuan,int pre,int mm)
{
	if(mm==m)return 0;
	if(dp[xuan][pre]!=-1)return dp[xuan][pre];
	ll anss=0;
	for(int i=0;i<n;i++){
		if(xuan&(1<<i))continue;
		anss=max(anss,dfs(xuan^(1<<i),i,mm+1)+a[i]+c[pre][i]);
	}
	return dp[xuan][pre]=anss;
}

int main()
{
	memset(dp,-1,sizeof(dp));
	scanf("%lld%lld%lld",&n,&m,&k);
	for(int i=0;i<n;i++){
		scanf("%lld",&a[i]);
	}
	while(k--){
		scanf("%lld%lld%lld",&x,&y,&z);
		c[x-1][y-1]=z;
	}
	printf("%lld\n",dfs(0,19,0));
	return 0;
} 
  		  	  		 		 	 	 		 	 		  	 	