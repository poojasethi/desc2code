#include<bits/stdc++.h>
using namespace std;
#define int long long
int dp[1<<20][20];
int a[20],n,m,k,x,y,c,msk,cost[20][20],ans,g;
 main(){
	cin>>n>>m>>k;
	for(int i=0;i<n;i++)
		cin>>a[i], dp[1<<i][i]=a[i];
	for(int i=0;i<k;i++)
		cin>>x>>y>>c, cost[x-1][y-1]=c;
/*		for(int i=0;i<n;i++,cout<<endl)
			for(int j=0;j<n;j++)
				cout<<cost[i][j]<<" ";*/
	for(int mask=0;mask<(1<<n);mask++){
		for(int i=0;i<n;i++){
			if(mask & 1<<i){
				msk=mask^(1<<i);
				for(int j=0;j<n;j++)
					if(msk &(1<<j))
	dp[mask][i]=max(dp[mask][i],dp[msk][j]+a[i]+cost[j][i]);
			}
	
			if(__builtin_popcount((int)mask)==m)
			ans=max(ans,dp[mask][i]) ,g=mask;
	}
	}
//	cout<<g<<endl;
	cout<<ans<<endl;
	return 0;
}
