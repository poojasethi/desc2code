#include <bits/stdc++.h>

using namespace std;
#define f(i, n) for (int i = 0; i < (int)(n); i++)
typedef long long ll;
int st(int n,int i){return n|(1<<i); }
bool gt(int n,int i){return (n>>i)&1; }
int n,m,r;
int c[22][22];
int a[22];
ll mem[1<<18][20];
ll dp(int mask,int l){
if(__builtin_popcount(mask)==m)return 0;

ll &ans=mem[mask][l];
if(ans!=-1)return ans;
ans=0;
f(i,n){

    int ms=mask;
if(!gt(mask,i)){

        ms=st(mask,i);
ans=max(ans,dp(ms,i)+a[i]+c[l][i]);}
}

return ans;
}

int main()
{
    memset(mem,-1,sizeof mem);
    int x,y,z;
     cin>>n>>m>>r;
     f(i,n)cin>>a[i];
     f(i,r){cin>>x>>y>>z;
     c[x-1][y-1]=z;}

     cout<<dp(0,19);
    return 0;
}
