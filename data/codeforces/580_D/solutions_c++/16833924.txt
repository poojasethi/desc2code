#include <iostream>
#define maxn 100005
using namespace std;
int n,m,t;
long long dp[262144+2][20];
int g[20][20];
int p[20];
int a,b,c;
long long ans;
int main(){
	cin>>n>>m>>t;
	for (int i=1;i<=n;++i)
		cin>>p[i];
	for (int i=1;i<=t;++i){
		cin>>a>>b>>c;
		g[a][b]=c;
	}
	for (int j=1;j<=n;++j)
		dp[1<<(j-1)][j]=p[j];
	for (int i=1;i<=(1<<n);++i){
		for (int j=1;j<=n;++j){
			if (i&(1<<(j-1))){
				for (int k=1;k<=n;++k)
					if ((i-(i&(1<<(j-1))))&(1<<(k-1)))
						dp[i][j]=max(dp[i-(i&(1<<(j-1)))][k]+g[k][j]+p[j],dp[i][j]);
			}
		}
	}
	for (int i=1;i<=(1<<n);++i)
		for (int j=1;j<=n;++j){
			if (i&(1<<(j-1))){
				int temp=0;
				for (int k=1;k<=n;++k)
					if (i&(1<<(k-1))) ++temp;
				if (temp==m) ans=max(ans,dp[i][j]);
			}
		}
	cout<<ans<<"\n";
	return 0;
}
 		 		   				 		  	   	