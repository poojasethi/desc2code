#include <bits/stdc++.h>
#define ll long long
#define pii pair<int,int>
#define fr first
#define sc second
using namespace std;
int n,m,k;
int a[20];
ll c[20][20];
ll dp[(1<<18)][20];
ll f(ll s,int h,int p){
    if(h == m){
        return 0;
    }
    if(dp[s][p] != -1)return dp[s][p];
    ll maxx = 0;
    for(int i=0 ; i<n ; i++){
        if(((1<<i)&s) == 0){

            maxx = max(maxx,c[p][i+1] + a[i+1] + f(s|(1<<i),h+1,i+1));
        }
    }
    return dp[s][p] = maxx;
}

int main() {
    int x,y,z;

    cin>>n>>m>>k;
    memset(dp,-1,sizeof(dp));
    for(int i=1 ; i<=n ; i++)cin>>a[i];
    for(int i=0 ; i<k ; i++){
        cin>>x>>y>>z;
        c[x][y] = z;
    }
    cout<<f(0,0,0);
	return 0;
}
