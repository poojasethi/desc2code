#include <bits/stdc++.h>
using namespace std;
#define N 20
#define ll long long

ll c[N];
ll a[N][N];
ll n,m,k;
ll dp[(1<<20)][20];

ll rec(int val,int pre,int count)
{
    if(count==m)
        return 0ll;
    if(dp[val][pre]!=-1)
        return dp[val][pre];
    
    ll curr = 0ll;
    for(int i=1;i<=n;i++)
    {
        if(val&(1<<i))
            continue;
        curr = max(curr,c[i] + a[pre][i] + rec(val|(1<<i),i,count +1 ));    
    }
    return dp[val][pre] = curr;
}


int main()
{
    memset(dp , -1 , sizeof dp);
    cin>>n>>m>>k;
    for(int i=1;i<=n;i++)
        cin>>c[i];
    while(k--)
    {
        ll x,y;
        ll z;
        cin>>x>>y>>z;
        a[x][y] = z;
        
    }
    cout<<rec(0,0,0)<<endl;
    return 0;   
    
}