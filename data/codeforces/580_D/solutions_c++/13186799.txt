#include <bits/stdc++.h>
#define ll long long 
using namespace std;

ll DP[1<<18][18];
int rules [18][18], bitsOn[1<<18];

int main(){

	int n, m, k;
	cin>>n>>m>>k;
	for (int i = 0; i < n; ++i)
	{
		cin>>rules[i][i];
	}
	for (int i = 0; i<k ;i++){
		int x, y;
		cin>>x>>y;
		cin>>rules[x-1][y-1];
	}
	for (int i = 1; i<1<<n;i++){
		for(int j = 0; i>= (1<<j); j++){
			if ((1<<j) & i ){
				bitsOn[i]++;
				int rem = i ^ (1<<j);
				DP[i][j] = rules[j][j];
				for (int k = 0;k<n;k++){
					if ((1<<k)&rem)
						DP[i][j] = max (DP[i][j], DP[rem][k] + rules[j][k] + rules[j][j]);
				}
			}
			//cout<<DP[i][j]<<" ";
		}
		//cout<<endl;
	}
	long long ans = 0;
	for (int i = 0;i<(1<<n);i++){
		if (bitsOn[i] == m){
			for (int j = 0;j<n;j++){
				ans = max(ans, DP[i][j]);
			}
		}
	}
	cout<<ans<<endl;

}
