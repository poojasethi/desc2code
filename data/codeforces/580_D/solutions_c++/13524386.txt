#include<iostream>
#include<algorithm>
#include<string.h>
using namespace std;
typedef long long LL;
LL dp[1<<18][18];
LL c[18][18],s[18];
int n,k,m;
LL f(int b, int i) {
  LL& res=dp[b][i];
  if(res!=-1)return res;
  int ct=0;
  for(int j=0;j<n;j++) if(b&(1<<j)) ct++;
  if(ct==m) return res=0;
  for(int j=0;j<n;j++) if(!(b&(1<<j))) {
    res = max(res, s[j]+c[i][j]+f(b|(1<<j), j));
  }
  return res;
}
int main() {
  memset(dp, -1, sizeof(dp));
  cin>>n>>m>>k;
  for(int i=0;i<n;i++) cin>>s[i];
  for(int i=0;i<k;i++) {
    LL x,y,z;
    cin>>x>>y>>z;
    c[x-1][y-1]=z;
  }
  LL res=0;
  for(int i=0;i<n;i++) res = max(res, s[i]+f(1<<i, i));
  cout<<res<<endl;
  return 0;
}
