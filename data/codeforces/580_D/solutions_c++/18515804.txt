#include <iostream>
#include <cstdio>
#include <cstring>

typedef long long ll;

using namespace std;

int Num;

const long long inf=999999999;

long long dp[1<<18][20];
long long a[22],mat[22][22];
int n,m,k;
long long dfs(int x,int y,int z)
{
    if(dp[x][y] !=-1) return dp[x][y];
    dp[x][y]=0;
    if(z==m) return dp[x][y];
    for(int i=0;i<n;i++)
    {
        if( ((x >> i) & 1) == 0)
        {
            dp[x][y]=max(dp[x][y], dfs( x | (1<<i) , i , z+1 )+mat[y][i]+a[i]);
        }
    }
    return dp[x][y];
}
int main()
{
    memset(dp,-1,sizeof(dp));
   cin>>n>>m>>k;
    for(int i=0;i<n;i++)
        cin>>a[i];
    for(int i=0;i<k;i++)
    {
        int x,y;
        long long c;
        cin>>x>>y>>c;
        mat[x-1][y-1]+=c;
    }
    cout<<dfs(0,n+1,0);
}

 	     			  	 	   		  	  		  		