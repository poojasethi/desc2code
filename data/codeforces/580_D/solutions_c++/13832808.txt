#include <iostream>
#include <cstring>
#include <algorithm>
using namespace std;
typedef long long LL;
int n,m,k,s[18],g[18][18];
LL v[18][1<<18];
LL go(int a,int b,int c=0){
  LL& r=v[max(0,a)][b];
  if (r<0){
    r=0;
    if(c<m)for(int i=0;i<n;++i)if((1<<i)&b)
      r=max(r,(a<0?0:g[a][i])+s[i]+go(i,b^(1<<i),c+1));
  }
  return r;
}
int main(void) {
  cin>>n>>m>>k;
  for(int i=0;i<n;++i)cin>>s[i];
  for(int i=0,x,y,z;i<k&&cin>>x>>y>>z;++i)g[x-1][y-1]=z;
  memset(v,0xff,sizeof(v));
  cout<<go(-1,(1<<n)-1)<<endl;
}
