#include <cstdio>
#include <cstring>

using namespace std;

typedef long long ll;

ll n,m,k,a,b,c,val[20],arr[20][20],dp[20][1048577];

inline ll max(ll a,ll b){return (a>b)?a:b;}

ll cari(ll a,ll b){
	if (dp[a][b]!=-1) return dp[a][b];
	ll c=b,d=0;
	while (c){
		if (c&1) d++;
		c/=2;
	}
	if (d==m) return dp[a][b]=0;
	dp[a][b]=0;
	for (int i=1;i<=n;i++){
		if ((b&(1<<i))==0){
			dp[a][b]=max(dp[a][b],cari(i,b|(1<<i))+arr[a][i]);
		}
	}
	return dp[a][b];
}

int main(){
	scanf("%I64d %I64d %I64d",&n,&m,&k);
	for (int i=1;i<=n;i++) scanf("%I64d",&val[i]);
	for (int i=1;i<=k;i++){
		scanf("%I64d %I64d %I64d",&a,&b,&c);
		arr[a][b]+=c;
	}
	for (int i=1;i<=n;i++) arr[0][i]=val[i];
	for (int i=1;i<=n;i++){
		for (int j=1;j<=n;j++) arr[i][j]+=val[j];
	}
	memset(dp,-1,sizeof(dp));
	printf("%I64d\n",cari(0,0));
}