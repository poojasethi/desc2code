#include<cstdio>
#include<algorithm>
using namespace std;
long long dp[1000000][23],ans;
int c[23][23],a[23],m,n,fr,bk,val,k,t;
int main(){
	scanf("%d%d%d",&n,&m,&k);
	for(int i=0;i<n;i++)
		scanf("%d",&a[i]);
	while(k--){
		scanf("%d%d%d",&fr,&bk,&val);
		c[fr-1][bk-1]=val;
		
	}
	for(int i=0;i<n;i++)dp[1<<i][i]=a[i];
	for(int msk=0;msk<(1<<n);msk++){
		for(int i=0;i<n;i++){
			if(msk&(1<<i)){
				for(int j=0;j<n;j++){
					if(!(msk&(1<<j))){
						dp[msk|(1<<j)][j]=max(dp[msk|(1<<j)][j],dp[msk][i]+c[i][j]+a[j]);
					}
				}
			}
		}
	}
	for(int i=0;i<(1<<n);i++){
		t=0;
		for(int j=0;j<n;j++){
			if((1<<j)&i)t++;
		}
		if(t==m)for(int j=0;j<n;j++)ans=max(ans,dp[i][j]);
	}
	printf("%I64d\n",ans);
} 