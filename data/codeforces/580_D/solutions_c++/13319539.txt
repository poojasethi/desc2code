#include <bits/stdc++.h>
using namespace std;

#define ll long long int 
#define ten5 100001
#define mp make_pair
#define pb push_back
#define N 1048576

bool done[N][20]; 
ll dp[N][20];
ll a[20];
ll c[20][20];
int n,m,k;


ll solveDP(int d, int mask, int last){
	if (d==m) return 0;
	if(done[mask][last]) return dp[mask][last];
	done[mask][last] = true;
	for(int i=0; i<n; i++){
		if(mask&(1<<i)){
			dp[mask][last] = max(dp[mask][last], solveDP(d+1,mask-(1<<i),i) + a[i] + c[last][i]);
		}
	}
	return dp[mask][last];
}

int main(){
	cin >> n >> m >> k;
	for(int i=0; i<n; i++)
		cin >> a[i];

	for(int i=0; i<k; i++){
		int x,y; ll cc;
		cin >> x >> y >> cc;
		x--; y--;
		c[x][y] = cc;
	}
	int mask= (1<<n) - 1;
	cout << solveDP(0, mask, n) << endl;
}