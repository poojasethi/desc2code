#include<bits/stdc++.h>

using namespace std;
const int N = 20;
typedef long long LL;
int a[N], d[N][N], calc[1 << N];
LL f[1 << N][N];

int main(){
	int n, m, k, x, y, z;
	LL ans = 0;
	scanf("%d%d%d", &n, &m, &k);
	for (int i = 0; i < n; i++) scanf("%d", &a[i]);
	for (int i = 0; i < k; i++) scanf("%d%d%d", &x, &y, &z), d[x - 1][y - 1] = z;
	for (int i = 1; i < 1 << n; i++) calc[i] = calc[i >> 1] + (i & 1);
	for (int i = 1; i < 1 << n; i++)
		for (int j = 0; j < n; j++)
			if ((i >> j) & 1){
				int k = i ^ (1 << j);
				if (!k) f[i][j] = a[j];
				for (int l = 0; l < n; l++)
					if ((k >> l) & 1)
						f[i][j] = max(f[i][j], f[k][l] + a[j] + d[l][j]);
				if (calc[i] == m) ans = max(ans, f[i][j]);
			}
	printf("%I64d\n", ans);
}
