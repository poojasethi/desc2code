# include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define MAX 20
int n,m,k;
int a[MAX];
int e[MAX][MAX];
ll dp[1<<MAX][MAX];
int main()
{
cin>>n>>m>>k;
memset(dp,-1,sizeof dp);
for(int i=0;i<n;i++){
    cin>>a[i];
    dp[1<<i][i]=a[i];
}
for(int i=0;i<k;i++){
    int x,y,c; cin>>x>>y>>c;
    x--, y--;
    e[x][y]=c;
}
ll ans=0;
for(int b=0;b<(1<<n);b++){
    for(int u=0;u<n;u++){
        if(dp[b][u]==-1)continue;
        if(__builtin_popcount(b)==m)
            ans=max(ans,dp[b][u]);
        for(int v=0;v<n;v++){
            if((b&(1<<v))==0){
                int w=e[u][v];
                dp[b|(1<<v)][v]=max(dp[b|(1<<v)][v],dp[b][u]+a[v]+w);
            }
        }
    }
}
cout<<ans<<'\n';
return 0;
}
