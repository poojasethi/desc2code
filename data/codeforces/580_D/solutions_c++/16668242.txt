#include<stdio.h>
#include<string.h>
#include<algorithm>>
using namespace  std;
int t,b,i,j,k,n,m,x,y,s,w[19];
long long a[19],f[262144][19],c[19][19],ans;
int main()
{memset(f,0,sizeof(f));
memset(c,0,sizeof(c));
scanf("%d %d %d",&n,&m,&k);
t=1;
for (i=1;i<=n;i++)
 {scanf("%I64d",&a[i]);
  f[t][i]=a[i]; w[i]=t; t*=2; }
for (i=1;i<=k;i++)
 { scanf("%d%d",&x,&y); scanf("%I64d",&c[x][y]); }
for (i=1;i<=t-2;i++)
 for (j=1;j<=n;j++)
  {if ( (w[j] & i)==0 ) continue;
   for (k=1;k<=n;k++)
    {if ((w[k] & i)!=0) continue;
     f[i+w[k]][k]=max(f[i+w[k]][k],f[i][j]+a[k]+c[j][k]); }
  }
ans=0;
for (i=1;i<=t-1;i++)
 { s=0; for (j=1;j<=n;j++) if ( (w[j] & i)!=0 ) s++;
   if (s!=m) continue;
   for (j=1;j<=n;j++) ans=max(ans,f[i][j]); }
printf("%I64d",ans);
return 0;}
 		  		  	  	   	 		    	 	   	