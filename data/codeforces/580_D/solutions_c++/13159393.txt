#include <cstdio>
#include <algorithm>

using std::max;

int n,m,k,x,y,a[19];
int c[19][19];
long long ans,f[19][262144];

int main()
{
	scanf("%d%d%d",&n,&m,&k);
	for (int i=0;i<n;++i) scanf("%d",a+i);
	while (k--)
	{
		scanf("%d%d",&x,&y);
		scanf("%d",&c[--x][--y]);
	}
	for (int i=0;i<n;++i) f[i][1<<i]=a[i];
	int S=1<<n;
	for (int s=0,t;s<S;++s)
	{
		int cnt=0;
		for (int i=0;i<n;++i) cnt+=s>>i&1;
		for (int i=0;i<n;++i) if (s>>i&1)
		{
			if (cnt==m) ans=max(ans,f[i][s]);
			for (int j=0;j<n;++j)
			{
				if (!(s>>j&1))
				{
					t=s|1<<j;
					f[j][t]=max(f[j][t],f[i][s]+a[j]+c[i][j]);
				}
			}
		}
	}
	printf("%I64d\n",ans);
	return 0;
}
