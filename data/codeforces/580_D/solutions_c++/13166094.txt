#include<bits/stdc++.h>

#define MAXN 1000005
#define ll long long
#define mp make_pair
using namespace std;

ll n,m,k;
ll s[20];
ll inc[20][20];
ll c;
ll dp[MAXN][20];

ll solver(ll mask,ll fin,ll cant){
	if(cant==m){
		return 0;
	}
	cant++;
	if(dp[mask][fin]!=-1){
		return dp[mask][fin];
	}
	ll sol=0;
	ll temp=0;
	for(ll i=0;i<n;i++){
		if(!(mask & (1<<i) )){
			temp=inc[fin][i]+s[i];
			temp+=solver((mask | (1<<i) ),i,cant);
		}
		sol=max(sol,temp);
	}
	dp[mask][fin]=sol;
	return sol;
}
int main() {
	cin>>n>>m>>k;
	memset(dp,-1,sizeof(dp));
	for (ll i = 0; i < n; ++i) {
		cin>>s[i];
	}
	ll a,b;
	for (ll i = 0; i < k; ++i) {
		cin>>a>>b>>c;
		a--;
		b--;
		inc[a][b]=c;
	}
	ll sol=solver(0,n+1,0);
	cout<<sol<<endl;
}
