#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
ll dp[(1<<20)+5][21],a[21][21],c[21],n;
ll rec(int mask,int prev,int m){
    if(m<=0)return 0;
    if(prev!=-1 && dp[mask][prev]!=-1)return dp[mask][prev];
    ll ret=0;
    for(int i=0;i<n;i++){
        if(((mask>>i)&1)==0){
            ll cur=rec((mask|(1<<i)),i,m-1)+c[i];
            if(prev!=-1)cur+=a[prev][i];
            ret=max(ret,cur);
        }
    }
    if(prev!=-1)dp[mask][prev]=ret;
    return ret;
}
int main(){
    memset(dp,-1,sizeof(dp));
    ll m,k;
    cin >>n>>m>>k;
    for(int i=0;i<n;i++)cin>>c[i];
    for(int i=0;i<k;i++){
        ll u,v,w;
        cin>>u>>v>>w;
        a[u-1][v-1]=w;
    }
    cout<<rec(0,-1,m)<<endl;
    return 0;
}
