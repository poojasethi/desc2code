#include <iostream>
#include <cstdio>
#include <cstring>
using namespace std;
const int MAXN=19;
int n,m,k,a,b,c,co,val[MAXN],adj[MAXN][MAXN];
long long dp[1<<MAXN][MAXN];
long long query(int bitmask,int curr,int ate)
{
    long long int &ans=dp[bitmask][curr];
    if (ans!=-1)return ans;
    if (ate==m)return ans=0;
    ans=0;
    for (int i=1;i<=n;i++)
    {
        if (bitmask&(1<<i))continue;
        ans=max(ans,query(bitmask|(1<<i),i,ate+1)+val[i]+adj[curr][i]);
    }
    return ans;
}
int main()
{
    memset(dp,-1,sizeof(dp));
    scanf("%i%i%i",&n,&m,&k);
    for (int i=1;i<=n;i++)scanf("%i",&val[i]);
    while (k--)
    {
        scanf("%i%i%i",&a,&b,&c);
        adj[a][b]=c;
    }
    printf("%lli\n",query(0,0,0));
}
