#include <bits/stdc++.h>

using namespace std;

#define N 19

long long memo[N][1 << N];
int arr[N], mtx[N][N];
int n, m, k;

long long solve(int msk, int p) {
  if(!m) return arr[p];
  long long &ret = memo[p][msk];
  if(ret != -1) return ret;
  ret = 0;
  for(int i = 0; i < n; ++i) {
    if((msk >> i) & 1) continue;
    --m;
    ret = max(ret, solve(msk | (1 << i), i + 1) + mtx[p][i + 1]);
    ++m;
  }
  ret += arr[p];
  return ret;
}

int main() {
  memset(memo, -1, sizeof memo);
  cin >> n >> m >> k;
  for(int i = 1; i <= n; ++i) cin >> arr[i];
  for(int i = 0, u, v, x; i < k; ++i) cin >> u >> v >> x, mtx[u][v] = x;
  cout << solve(0, 0);
  return 0;
}
