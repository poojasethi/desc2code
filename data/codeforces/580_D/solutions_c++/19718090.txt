#include<stdio.h>
#include<string.h>

#define N 20

typedef long long ll;

ll dp[(1<<N)-1][N],n,m,k,a[N][N],p[N];

ll max(ll a,ll b){return a>b?a:b;}

ll cnt_bit(ll x){
  ll ans=0;
  while(x>0)
    x=x&(x-1),ans++;
  return ans;
}

ll solve(ll i,ll st,ll u){
  if(dp[st][u]!=-1)
    return dp[st][u];
  if(i>=m)
    return 0;
  ll ans=-1;
  for(ll v=1;v<=n;v++)
    if(!((st>>v)&1))
      ans=max(ans,solve(i+1,st|(1<<v),v)+a[u][v]+p[v]);
  return dp[st][u]=ans;
}

int main(){
  scanf("%I64d%I64d%I64d",&n,&m,&k);
  for(ll i=1;i<=n;i++)
    scanf("%I64d",&p[i]);
  for(ll i=1,u,v,w;i<=k;i++){
    scanf("%I64d%I64d%I64d",&u,&v,&w);
    a[u][v]=w;
  }
  memset(dp,-1,sizeof(dp));
  printf("%I64d\n",solve(0,0,0));
  return 0;
}

