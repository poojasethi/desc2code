#include<cstdlib>
#include<cstdio>
#include<algorithm>

using namespace std;

const int N=32;
const int M=524288;

int a[N];
int s[N][N];
long long f[M][N];
int n,m,i,j,k,u,v,w,t,c;
long long ans;

int main(){
	scanf("%d%d%d",&n,&m,&k);
	for(i=1;i<=n;i++){
		scanf("%d",&a[i]);
		f[1<<i>>1][i]=a[i];
	}
	for(i=1;i<=k;i++){
		scanf("%d%d%d",&u,&v,&w);
		s[v][u]=w;
	}
	w=(1<<n)-1;
	for(i=0;i<=w;i++)
		for(j=1;j<=n;j++)
			if(i&(1<<j>>1)){
				for(t=1;t<=n;t++)
					if(i&(1<<t>>1) && j!=t)
						f[i][j]=max(f[i][j],f[i^(1<<j>>1)][t]+a[j]+s[j][t]);
			}
	for(i=0;i<=w;i++){
		t=i;
		c=0;
		while(t){
			c+=t&1;
			t>>=1;
		}
		if(c==m)
			for(j=1;j<=n;j++)ans=max(ans,f[i][j]);
	}
	printf("%I64d\n",ans);
	return 0;
}
