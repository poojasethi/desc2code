#include <iostream>
using namespace std;

#define ll long long
#define INF 1000000000000000000LL
int arr1[18];
int arr2[18][18];
ll dp[262144][18];

int setbits(int n){
	int ans=0;
	while(n>0){
		n-=(n&(-n));
		ans++;
	}
	return ans;
}

int main(){
	int n,m,k;
	cin>>n>>m>>k;
	for(int i=0;i<n;i++)
		cin>>arr1[i];
	while(k--){
		int x,y,c;
		cin>>x>>y>>c;
		arr2[x-1][y-1]=c;
	}
	for(int i=1;i<(1<<n);i++){
		for(int j=0;j<n;j++){
			dp[i][j]=-INF;
			if((i&(1<<j))){
				if((i&(i-1))==0)
					dp[i][j]=arr1[j];
				else{
					for(int k=0;k<n;k++)
						dp[i][j]=max(dp[i][j],dp[i-(1<<j)][k]+arr1[j]+arr2[k][j]);
				}
			}
		}
	}
	ll ans=0;
	for(int i=1;i<(1<<n);i++)
		if(setbits(i)==m)
			for(int k=0;k<n;k++)
				ans=max(ans,dp[i][k]);
	cout<<ans<<endl;
}