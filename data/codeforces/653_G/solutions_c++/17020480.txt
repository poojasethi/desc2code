#include <set>
#include <map>
#include <cmath>
#include <ctime>
#include <bitset>
#include <string>
#include <vector>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <cassert>
#include <iomanip>
#include <iostream>
#include <algorithm>
#define PR pair
#define fi first
#define se second
#define mk make_pair
#define pb push_back
#define md ((L+R)>>1)
#define For(i,x,y)   for(int i=(int)(x);i<=(int)(y);i++)
#define Rep(i,x,y)   for(int i=(int)(x);i< (int)(y);i++)
#define Forn(i,x,y)  for(int i=(int)(x);i>=(int)(y);i--)
#define CH	         ch=getchar()
#define Exit(...)    printf(__VA_ARGS__),exit(0)
#define dln()        fprintf(stderr,"\n")
#define dprintf(...) fprintf(stderr,__VA_ARGS__)
using namespace std;
typedef double	  db;
typedef long long ll;
typedef PR<int,int> PII;
const	int inf=2e9;
const	ll Inf=1e10;
const	int P=1e9+7;
const	int N=500005;

inline int IN(){
	int x=0;int ch=0,f=0;
	for(CH;ch!=-1&&(ch<48||ch>57);CH)  f=(ch=='-');
	for(;ch>=48&&ch<=57;CH) x=(x<<1)+(x<<3)+ch-'0';
	return f?(-x):x;
}

int Pow(int x,int y,int p){
	int a=1;
	for(;y;y>>=1,x=(ll)x*x%p) if(y&1) a=(ll)a*x%p;
	return a;
}

int n,a[N],f[N],C[N];
vector<int> ind[N];

int main(){
	scanf("%d",&n);
	For(i,1,n){
		int val=IN();
		for(int i=2;i*i<=val;i++){
			if(val%i)continue;
			int c=0;
			for(;val%i==0;val/=i,c++);
			ind[i].pb(c);
		}
		if(val>1){
			ind[val].pb(1);
		}
	}
	C[0]=1;
	For(i,1,n-1) C[i]=(ll)C[i-1]*(n-i)%P*Pow(i,P-2,P)%P;
	f[1]=Pow(2,n-1,P)-1;
	if(f[1]<0) f[1]+=P;
	For(i,2,n) f[i]=(0ll+f[i-1]-C[i-1]-C[i-2]+P+P)%P;
	int ans=0;
	For(i,1,300000){
		if(!ind[i].size())continue;
		sort(ind[i].begin(),ind[i].end());
		Rep(j,0,ind[i].size()) ans=(ans+(ll)ind[i][ind[i].size()-1-j]*f[j+1])%P;
	}
	printf("%d\n",ans);
	return 0;
}


