#include <set>
#include <map>
#include <cmath>
#include <cstdio>
#include <vector>
#include <cstring>
#include <iostream>
#include <algorithm>

using namespace std;

#define pb push_back
#define mp make_pair
#define x first
#define y second

typedef long long ll;
typedef pair<int,int> pii;
typedef vector<int> vi;
typedef vector<pii> vpii;

template <class T>
void read(T &x)
{
	char ch;
	for (ch=getchar();(ch<'0'||ch>'9')&&ch!='-';) ch=getchar();
	x=0;int t=1;if (ch=='-') {ch=getchar();t=-1;}
	for (;ch>='0'&&ch<='9';ch=getchar()) x=x*10+ch-'0';
	x*=t;
}

const int N=300000;
const int mod=1000000007;

int a[N+10],s[N+10],w[25],fac[N+10],inv[N+10],pow2[N+10];
bool nprime[N+10];

int power(int x,int y)
{
	if (!y) return 1;
	int tmp=power(x,y>>1);
	tmp=ll(tmp)*tmp%mod;
	if (y&1) tmp=ll(tmp)*x%mod;
	return tmp;
}

int cc(int n,int m)
{
	if (n<m) return 0;
	return ll(fac[n])*inv[m]%mod*inv[n-m]%mod;
}

int calc(int x,int y,int z)
{
	int tmp=0;
	if (x)
	{
		int s=0;
		for (int i=y+z;i;i--)
		{
			s=(cc(y+z,i)+s)%mod;
			tmp=(ll(s)*cc(x,i)%mod*i+tmp)%mod;
		}
	}
	if (z)
	{
		int s=pow2[x+y];
		for (int i=0;i<=z;i++)
		{
			s=(s-cc(x+y,i))%mod;
			tmp=(ll(s)*cc(z,i)%mod*i+tmp)%mod;
		}
	}
	return (tmp+mod)%mod;
}

int main()
{
	#ifndef ONLINE_JUDGE
		freopen("input.txt","r",stdin);
		freopen("output.txt","w",stdout);
	#endif
	memset(nprime,0,sizeof(nprime));
	int cnt=0;
	for (int i=2;i<=N;i++)
	{
		if (!nprime[i]) a[++cnt]=i;
		for (int j=1;j<=cnt;j++)
		{
			if (i*a[j]>N) break;
			nprime[i*a[j]]=1;
			if (i%a[j]==0) break;
		}
	}
	int n;read(n);
	for (int i=1;i<=n;i++)
	{
		int x;read(x);s[x]++; 
	}
	fac[0]=1;for (int i=1;i<=n;i++) fac[i]=ll(fac[i-1])*i%mod;
	inv[0]=1;for (int i=1;i<=n;i++) inv[i]=power(fac[i],mod-2);
	pow2[0]=1;for (int i=1;i<=n;i++) pow2[i]=pow2[i-1]*2%mod;
	int ans=0;
	for (int i=1;i<=cnt;i++)
	{
		ll t=a[i];int k=1;w[0]=n;
		while (t<=N)
		{
			w[k]=0;
			for (int j=t;j<=N;j+=t) w[k]+=s[j];
			t*=a[i];k++;
		}
		w[k]=0;
		for (int i=0;i<k;i++) ans=(ans+calc(n-w[i],w[i]-w[i+1],w[i+1]))%mod;
	}
	printf("%d\n",ans);
	return 0;
}
