#include <cstdlib>
#include <cstdio>
#include <algorithm>
#include <vector>
#include <queue>
#include <cmath>
#include <stack>
#include <map>
#include <set>
#include <deque>
#include <cstring>
#include <functional>
#include <climits>
#include <list>

#define F1(x,y,z) for(int x=y;x<z;x++)
#define F2(x,y,z) for(int x=y;x<=z;x++)
#define F3(x,y,z) for(int x=y;x>z;x--)
#define F4(x,y,z) for(int x=y;x>=z;x--)
#define W(x) while(x-->0)
#define SI(x) scanf("%d",&x)
#define pb push_back
#define LL long long

#define MAX 100005

#define f(c,d) ((1<<(c))*(d))

using namespace std;

struct w{
	int r,g,i,gi,gl,gr,no;
} ww[MAX];

bool com1(const w& a,const w& b){
	return a.g<b.g;
}

bool com2(const w& a,const w& b){
	return a.r<b.r;
}

struct e{
	int r,i,gl,gr;
};

bool operator<(const e& a,const e& b){
	return a.r>b.r;
}

int n,k,q;
int r[MAX];
int gl[MAX],gr[MAX],gi[MAX];
int x[18][MAX];
int y[18][MAX];
int ta,tb,tc,td;
vector<e> ee;
int ans[MAX];

int f1(int a,int b,int c,int d){
	if(f(c,d)==a&&f(c,d+1)==b)return x[c][d];
	c--;
	d=d*2+1;
	if(b<=f(c,d))return f1(a,b,c,d-1);
	if(a>=f(c,d))return f1(a,b,c,d);
	return f1(a,f(c,d),c,d-1)+f1(f(c,d),b,c,d);
}

int f2(int a,int b,int c,int d){
	if(f(c,d)==a&&f(c,d+1)==b)return y[c][d];
	c--;
	d=d*2+1;
	if(b<=f(c,d))return f2(a,b,c,d-1);
	if(a>=f(c,d))return f2(a,b,c,d);
	return max(f2(a,f(c,d),c,d-1),f2(f(c,d),b,c,d));
}


int main(){
	SI(n);
	SI(k);
	F1(a,0,n)SI(r[a]);
	F1(a,0,n){
		ww[a].r=r[a];
		SI(ww[a].g);
		ww[a].i=a;
	}
	sort(ww,ww+n,com1);
	F1(a,0,n)ww[a].gi=gi[ww[a].i]=a;
	F1(a,0,n){
		if(a==0)ww[a].gr=0;
		else ww[a].gr=max(a,ww[a-1].gr);
		while(ww[a].gr+1<n&&ww[ww[a].gr+1].g-ww[a].g<=k)ww[a].gr++;
	}
	F4(a,n-1,0){
		if(a==n-1)ww[a].gl=n-1;
		else ww[a].gl=min(a,ww[a+1].gl);
		while(ww[a].gl-1>=0&&ww[a].g-ww[ww[a].gl-1].g<=k)ww[a].gl--;
	}
	sort(ww,ww+n,com2);
	F1(a,0,n){
		int b=a;
		while(b+1<n&&ww[a].r==ww[b+1].r)b++;
		F2(c,a,b){
			gl[ww[c].i]=ww[c].gl;
			gr[ww[c].i]=ww[c].gr;
			ta=ww[c].gi;
			F1(d,0,18){
				x[d][ta]++;
				ta>>=1;
			}
		}
		F2(c,a,b)ww[c].no=f1(ww[c].gl,ww[c].gr+1,17,0);
		a=b;
	}
	SI(q);
	F1(a,0,q){
		SI(ta);
		SI(tb);
		ta--;
		tb--;
		tc=max(gl[ta],gl[tb]);
		td=min(gr[ta],gr[tb]);
		if(tc<=td)ee.pb((e){max(r[ta],r[tb]),a,tc,td});
	}
	sort(ee.begin(),ee.end());
	ta=n-1;
	F1(a,0,ee.size()){
		while(ta>=0&&ww[ta].r>=ee[a].r){
			tb=ww[ta].gi;
			F1(b,0,18){
				y[b][tb]=max(y[b][tb],ww[ta].no);
				tb>>=1;
			}
			ta--;
		}
		ans[ee[a].i]=f2(ee[a].gl,ee[a].gr+1,17,0);
	}
	F1(a,0,q)printf("%d\n",ans[a]?ans[a]:-1);
	//system("pause");
    return 0;
}
