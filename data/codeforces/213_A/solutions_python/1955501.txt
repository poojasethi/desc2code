from re import *
from sys import stderr
def readint():
    return int(raw_input())
def readfloat():
    return float(raw_input())
def readarray(N, foo=raw_input):
    return [foo() for i in xrange(N)]
def readlinearray(foo=int):
    return map(foo, raw_input().split())

n = readint()

ci = map(lambda i: i-1, readlinearray())

aij = map(lambda t: set(map(lambda i: i-1, readlinearray()[1:])), xrange(n))

def get(completed, current):
    res = 0
    ok = True
    while ok:
        ok = False
        for i in xrange(n):
            if i not in completed and ci[i] == current and len(aij[i].difference(completed)) == 0:
                ok = True
                completed.add(i)
                res += 1
    if len(completed) == n:
        return res
    return res + 1 + get(completed, (current+1) % 3) 

print min(get(set(), 1), get(set(), 2), get(set(), 0))
