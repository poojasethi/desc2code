#!/usr/bin/python

n = int(raw_input())

comp = raw_input()
comp = map(lambda i: int(i) - 1, comp.split())
mdep = list(range(n));

for i in range(n):
	mdep[i] = raw_input()
	mdep[i] = map(lambda i: int(i) - 1, mdep[i].split())
	mdep[i].pop(0)

min_time = float("inf");

for pos in range(3):
	time = 0
	games = range(n)
	dep = [d[:] for d in mdep]
	while len(games) > 0:
		need_to_reiterate = 1
		while need_to_reiterate:
			need_to_reiterate = 0
			for game in games:
				if comp[game] == pos and len(dep[game]) == 0:
					#print("len(dep[",game,"]) = ", len(dep[game]), "comp[",game,"] = ",comp[game], "pos = ",pos)
					for d in dep:
						if game in d:
							d.remove(game)
					games.remove(game)
					time = time+1
					#print("Removed game ", game)
					need_to_reiterate = 1
		if len(games) > 0:
			pos = (pos+1)%3
			time = time+1

		
	min_time = min(min_time, time) 

print(min_time);

