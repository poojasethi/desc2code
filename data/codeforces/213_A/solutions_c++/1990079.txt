#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

int n,a[205];
int d1[205][205],cnt1[205],d[205][205],cnt[205];

int main() {
	scanf("%d",&n);
	for (int i=0; i<n; i++) {
	    scanf("%d",&a[i]);
		a[i]--;
	}
	memset(d1,0,sizeof(d1));
	memset(cnt1,0,sizeof(cnt1));
	int ti,b;
	for (int i=0; i<n; i++) {
		scanf("%d",&ti);
		for (int j=0; j<ti; j++) {
			scanf("%d",&b);
			d1[i][b-1] = 1;
			cnt1[i]++;
		}
	}
	int ret = (1<<20);
	for (int st=0; st<3; st++) {
		int at = st;
		int com = 0,cur = 0;
		memcpy(d,d1,sizeof(d));
		memcpy(cnt,cnt1,sizeof(cnt));
		while (com < n) {
			for (int k=0; k<n; k++)
				for (int i=0; i<n; i++) {
					//printf("%d %d\n",i,cnt[i]);
					if (a[i] == at && cnt[i] == 0) {
						cnt[i] = -1;
						com++;
						for (int j=0; j<n; j++) {
							cnt[j] -= d[j][i];
							d[j][i] = 0;
						}
	    			}
				}
			at = (at+1)%3;
			cur++;
		}
		ret = min(cur,ret);
	}
	printf("%d\n",ret+n-1);
}
