#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;
int n,i,K,d[1000],g[1000][1000],c[1000],ans,v,D[1000];
bool vis[1000];
int calc(int x) {
	int ans=0,v;
	memcpy(d,D,sizeof(D));
	memset(vis,0,sizeof(vis));
	for (int k=0;k<n;k++) {
		int y=(x+1)%3+1,v=0;
		for (int i=1;i<=n;i++) if (!vis[i] && !d[i]) {
			if (c[i]==x) {v=i;y=x;break;}
			else if ((y==(x+1)%3+1) && (c[i]==x%3+1)) y=x%3+1,v=i;
			else if (y==(x+1)%3+1) v=i;
		}
		if (y==x) ans++; else if (y==x%3+1) ans+=2; else ans+=3;x=y;vis[v]=1;
		for (int i=1;i<=n;i++) if (g[v][i]) d[i]--;
	}
	return ans;
}
int main() {
	scanf("%d",&n);
	for (i=1;i<=n;i++) scanf("%d",&c[i]);
	for (i=1;i<=n;i++) {
		scanf("%d",&K);d[i]=K;
		for (;K;K--) scanf("%d",&v),g[v][i]=1;
	}
	memcpy(D,d,sizeof(d));
	ans=calc(1);ans=min(ans,calc(2));ans=min(ans,calc(3));
	printf("%d\n",ans);
}
