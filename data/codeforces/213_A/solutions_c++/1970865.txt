#include <cstdlib>
#include <iostream>
#include <fstream>

using namespace std;
int ans=1000000000;int n,a[4][202],b[202][202];
bool d[202];

bool check(int v)
{
	bool ok=true;
	int i;
	for (i=1;i<=b[v][0];i++)
	{
	 ok=d[b[v][i]];
	 if (!ok) break;
		}
 return ok;	
}

void go(int m,int cur)
{
 int ca=0,i;for (i=1;i<=n;i++) d[i]=false;bool stop;
 while (m>0)
 {
	stop=false;
	while (!stop)
	{
	stop=true;
	for (i=1;i<=a[cur][0];i++) if (!d[a[cur][i]])
	{
	 if (check(a[cur][i]))
	 {
		d[a[cur][i]]=true;ca++;m--;stop=false;
			}
		}
	}
  cur++;if (cur==4) cur=1;if (m>0) ca++;
 }
 if (ca<ans) ans=ca; 
}

int main()
{
 //ifstream f("input.txt");
 //ofstream g("output.txt");
 a[1][0]=0;a[2][0]=0;a[3][0]=0;
 cin>>n;
 int i,c;
 for (i=1;i<=n;i++)
 {
	cin>>c;a[c][0]++;a[c][a[c][0]]=i;
		}
 for (i=1;i<=n;i++)
 {
	cin>>b[i][0];
	for (int j=1;j<=b[i][0];j++) cin>>b[i][j];
		}
 go(n,1);go(n,2);go(n,3);
 cout<<ans<<endl;
}
