#include<bits/stdc++.h>
#include<functional>
#include<string.h>
using namespace std;
#define ll   long long  int
#define mp make_pair
#define s second
#define f first
#define mod 1000000007
#define pi pair<ll,pair<ll,ll> >
#define pb push_back
#define INF 1000000
ll c[211];
ll n;
vector<ll>v[211];
ll vis[211];
bool allow(ll ind){
	for(int i=0;i<(int)v[ind].size();i++){
	if(vis[v[ind][i]]==0) return 0;	
	}
	return 1;
}
ll check(ll s){
	s--;
	ll ans=0;
	ll marked=0;
	for(int i=0;i<211;i++) vis[i]=0;
	while(1){
		for(int i=1;i<=n;i++){
			if(c[i]==s+1 && allow(i) && !vis[i] ){
			vis[i]=1;
		    
		     i=0;
			marked++;
			
			}	
		}
		s++;
		s%=3;
		if(marked==n)break;
		ans++;
	}
//	ans--;
	return ans;
}
int main(){
	cin>>n;
	for(int i=1;i<=n;i++) cin>>c[i];
	ll ans=INF;
	ll u;
	for(int i=1;i<=n;i++){
	ll k;
	cin>>k;
	for(int j=1;j<=k;j++){
	cin>>u;
	v[i].pb(u);	
	}
	}
	for(int i=1;i<=3;i++){ ans=min(ans,check(i));}
	cout<<ans+n;
}
