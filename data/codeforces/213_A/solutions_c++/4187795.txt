#include <cstdio>

int n;
int coms[209];
int needs[209][209];
int neednum[209];
int done[209];

int main() {
	scanf("%d",&n);
	for(int i=1;i<=n;i++) scanf("%d",&coms[i]);
	for(int i=1;i<=n;i++) {
		scanf("%d",&neednum[i]);
		for(int j=0;j<neednum[i];j++) scanf("%d",&needs[i][j]);
	}
	int sol=1000000007;
	for(int st=1;st<4;st++) {
		int pls=st;
		int tm=0;
		int donetotal=0;
		for(int i=1;i<=n;i++) done[i]=0;
		while(donetotal<n) {
			int flg=1;
			for(int i=1;i<=n;i++) {
				if(coms[i]==pls&&done[i]==0) {
					int ok=1;
					for(int j=0;j<neednum[i];j++) {
						if(done[needs[i][j]]==0) ok=0;
					}
					if(ok) {
						done[i]=1;
						tm++;
						donetotal++;
						flg=0;
					}
				}
			}
			if(flg) {
				tm++;
				pls++;
				if(pls>3) pls=1;
			}
		}
		if(sol>tm) sol=tm;
	}
	printf("%d\n",sol);
	return 0;
}
