//By momo
#include<cstdio>
#include<algorithm>
#define N 210
using namespace std;
bool t[N][N],tbl[N][N];
int c[N],k[N],k2[N],don[N],x,ans=999999999;
int main(){
	int n;scanf("%d",&n);
	for(int i=1;i<=n;i++) scanf("%d",&c[i]);
	for(int i=1;i<=n;i++){
		scanf("%d",&k2[i]);
		for(int j=0;j<k2[i];j++) scanf("%d",&x),tbl[x][i]=1;
	}
	for(int s=1;s<=3;s++){
		int con=0;
		for(int i=1;i<=n;i++) for(int j=1;j<=n;j++) t[i][j]=tbl[i][j],k[i]=k2[i],don[i]=0;
		for(int p=s,cnt=0;cnt<n;p++,p>3?p=1:p=p){
			con++; int upd=1;
			while( upd ){
				upd=0;
				for(int i=1;i<=n;i++){
					if(k[i]==0&&!don[i]&&c[i]==p){
						cnt++; don[i]=1; upd=1;
						for(int j=1;j<=n;j++) if(t[i][j]) k[j]--;
					}
				}
			}
		}
		ans=min(ans,con-1);
	}
	printf("%d\n",ans+n);
}
