#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <string>
#include <algorithm>
#include <map>
#include <cmath>
#include <cstring>
#include <set>
//#pragma comment(linker,"/STACK:50000000")

using namespace std;

int n,i,j,ans,res,pos,cnt,cur,c[210],k[210],x[210][210];
bool f,ok[210];

bool can(int num)
{
	for(int i=0;i<k[num];i++)if(!ok[x[num][i]])return false;
	return true;
}

int main()
{
	//freopen("input.txt","r",stdin);
	//freopen("output.txt","w",stdout);
	cin>>n;
	for(i=0;i<n;i++)cin>>c[i],c[i]--;
	for(i=0;i<n;i++)
	{
		cin>>k[i];
		for(j=0;j<k[i];j++)cin>>x[i][j],x[i][j]--;
	}
	ans=(int)1e9;
	for(pos=0;pos<3;pos++)
	{
		memset(ok,false,sizeof(ok));
		cnt=0;
		res=0;
		cur=pos;
		while(cnt<n)
		{
			f=false;
			for(i=0;i<n;i++)if(c[i]==cur&&!ok[i]&&can(i))
			{
				f=true;
				ok[i]=true;
				cnt++;
				res++;
			}
			if(f)continue;
			cur++;cur%=3;
			res++;
		}
		ans=min(ans,res);
	}
	cout<<ans;
	return 0;
}
