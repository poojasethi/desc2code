#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 210
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,an;
int co[N],len[N],a[N][N],f[N];
inline bool ju(int x) {
	int i;
	For(i,1,len[x]) if (!f[a[x][i]]) return 0;
	return 1;
}
inline void work(int x) {
	int s=0,re=0,i;
	For(i,1,n) f[i]=0;
	for (;;) {
		int F=0;
		for (;;) {
			For(i,1,n) if (!f[i]&&co[i]==x&&ju(i)) {
				F=1; f[i]=1; re++; s++; break;
			}
			if (!F) break;
			F=0;
		}
		if (s==n) break;
		x++;
		if (x>3) x=1;
		re++;
	}
	an=min(an,re);
}
int main() {
	scanf("%d",&n);
	For(i,1,n) scanf("%d",&co[i]);
	For(i,1,n) {
		scanf("%d",&len[i]);
		For(j,1,len[i]) scanf("%d",&a[i][j]);
	}
	an=N*N;
	For(i,1,3) work(i);
	printf("%d\n",an);
	return 0;
}
