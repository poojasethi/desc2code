#include <cstdio>
#include <iostream>
#include <cstring>

using namespace std;

long in[205]={0};
long a[205]={0};

long c[205][205]={0};

long n,d[205]={0};
long hash[205]={0};

long calc(long x)
{
 long i,j;
 long cost=0;
 long k;
 
 memset(hash,0,sizeof(hash));
 for(i=1;i<=n;i++)
   d[i]=in[i];
 
 for(k=1;k<=n;)
   {
    for(i=1;i<=n;i++)
      if(hash[i]==0&&d[i]==0&&a[i]==x)
       break;
    if(i>n)
     {
      x=x%3+1;
      cost++;
      continue;
     }
    for(j=1;j<=n;j++)
      d[c[i][j]?j:0]--;
    hash[i]=1;
    k++;
   }
 
 return cost;
}

int main()
{
 long i,j;
 long ans=500;
 
 scanf("%ld",&n);
 for(i=1;i<=n;i++)
   scanf("%ld",&a[i]);
 for(i=1;i<=n;i++)
   {
    scanf("%ld",&in[i]);
    for(j=1;j<=in[i];j++)
      {
       long x;
       scanf("%ld",&x);
       c[x][i]=1;
      }
   }
 
 for(i=1;i<=3;i++)
   {
    long tmp=calc(i);
    if(tmp<ans)
     ans=tmp;
   }
 
 printf("%ld\n",ans+n);
 
 return 0;
}
