#include<cstdio>
#include<vector>
#include<cstring>
using namespace std;
const int N=200;
bool vis[N];
char t[N];
vector<int>e[N];
bool ok(int x)
{
	for(int i=0;i<e[x].size();i++)
	{
		if(!vis[e[x][i]])
			return 0;
	}
	return 1;
}
int min(int a,int b){return a<b?a:b;}
int main()
{
	int ti,ans;
	int i,j,k,a,n,p,s;
	scanf("%d",&n);
	for(i=0;i<n;i++)
		scanf("%d",&t[i]),t[i]--;
	for(i=0;i<n;i++)
	{
		scanf("%d",&k);
		for(j=0;j<k;j++)
		{
			scanf("%d",&a);
			e[i].push_back(a-1);
		}
	}
	ans=0x3f3f3f3f;
	for(i=0;i<3;i++)
	{
		p=i,s=0,ti=0;
		memset(vis,0,sizeof(vis));
		while(s<n)
		{
			k=s;
			for(j=0;j<n;j++)
			{
				if(t[j]==p&&!vis[j]&&ok(j))
				{
					s++;
					ti++;
					vis[j]=1;
				}
			}
			if(k==s)
			{
				ti++;
				p=(p+1)%3;
			}
		}
		ans=min(ans,ti);
	}
	printf("%d",ans);
	return 0;
}
   	    		 			 		 	 		 				 	 	