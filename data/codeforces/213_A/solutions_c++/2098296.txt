// In the name of God

#include <algorithm>
#include <iostream>
#include <vector>
#include <set>

using namespace std;

const int MAX = 200;
int C[MAX], iD[MAX];
vector <int> nbh[MAX], arr[3];

int main()
{
	int n;
	cin >> n;
	for (int i = 0; i < n; i++)
	{
		cin >> C[i];
		C[i]--;
	}
	for (int i = 0; i < n; i++)
	{
		int k, v;
		cin >> k;
		for (int j = 0; j < k; j++)
		{
			cin >> v;
			nbh[v - 1].push_back(i);
		}
	}
	int mn = 1000 * 1000 * 1000;
	for (int x = 0; x < 3; x++)
	{
		for (int i = 0; i < n; i++)
			for (int j = 0; j < nbh[i].size(); j++)
				iD[nbh[i][j]]++;
		for (int i = 0; i < n; i++)
			if (!iD[i])
				arr[C[i]].push_back(i);
		int rem = n, res = 0, p = x;
		while (rem > 0)
		{
			while (!arr[p].empty())
			{
				int t = arr[p].back(), adj;
				arr[p].pop_back();
				for (int i = 0; i < nbh[t].size(); i++)
					if (--iD[adj = nbh[t][i]] == 0)
						arr[C[adj]].push_back(adj);
				res++, rem--;
			}
			res++;
			p = (p + 1) % 3;
		}
		mn = min(res, mn);
	}
	cout << mn - 1 << '\n';
	return 0;
}
