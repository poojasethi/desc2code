#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
using namespace std;

const int MAX=200+10;

int n,c[MAX];
int g[MAX][MAX],in[MAX],go[MAX],temp[MAX],hash[MAX];

int work(int now)
{
	memset(hash,0,sizeof hash);
	int cost=0,p=now,tot=0,i,j,flag;
	for(i=1;i<=n;++i)
		temp[i]=in[i];
	while(tot<n)
	{
		flag=1;
		while(flag)
		{
			flag=0;
			for(i=1;i<=n;++i)
			{
				if(c[i]==p && !hash[i] && !temp[i])
				{
					++cost;
					++tot;
					hash[i]=1;
					for(j=1;j<=n;++j)
						if(g[i][j])
							--temp[j];
					flag=1;
				}
			}
		}
		++cost;
		++p;
		if(p==4)p=1;
	}
	return cost-1;
}

int main()
{
#ifndef ONLINE_JUDGE
	freopen("input.txt","r",stdin);freopen("output.txt","w",stdout);
#endif
	int i,j,a;
	scanf("%d",&n);
	for(i=1;i<=n;++i)
		scanf("%d",&c[i]);
	for(i=1;i<=n;++i)
	{
		scanf("%d",&in[i]);
		for(j=1;j<=in[i];++j)
		{
			scanf("%d ",&a);
			g[a][i]=1;
		}
	}
	printf("%d\n",min(min(work(1),work(2)),work(3)));
}
