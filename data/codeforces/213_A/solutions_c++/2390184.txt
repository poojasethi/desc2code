#include <iostream>
#include <vector>
#include <cmath>
#include <queue>

#define rep(i,n) for(int i=0;i<n;i++)

using namespace std;

int n,c[210],t1,t2,res=1e9,j,k,p,r;
vector<int> v[210];

int main(){

  cin>>n;
  rep(i,n){cin>>c[i];c[i]--;}
  rep(i,n){
    cin>>t1;
    rep(j,t1){
      cin>>t2;
      v[i].push_back(--t2);
    }
  }

  rep(ii,3){
    int f1[210] ={0};
    int f2[210] ={0};
    queue<int> q[3];
    rep(i,n)if(v[i].size()==0){q[c[i]].push(i);f2[i]=1;}
    if(q[ii].empty())continue;p=ii;r=0;

    while(1){
      for(k=0;k<n;k++)if(!f1[k])break;
      if(k==n)break;
      if(q[p].empty()){p=(p+1)%3;r++;continue;}
      int tp = q[p].front();q[p].pop();      
      f1[tp] = 1;
      rep(j,n)if(!f2[j]){
    for(k=0;k<v[j].size();k++)if(!f1[v[j][k]])break;
    if(k==v[j].size()){q[c[j]].push(j);f2[j]=1;}
      }
    }
    res = min(res,r);
  }

  cout<<res+n<<endl;

  return 0;

}
