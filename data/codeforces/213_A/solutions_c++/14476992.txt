#include <bits/stdc++.h>
using namespace std;
int n;
vector<int> script[4];
vector<int> adj[202];
bool visit[202];
int direct[3]={3,1,2};
inline bool isend(){
	for(int i=1;i<=n;++i)if(!visit[i])return false;
	return true;
}
int main(){
	int a,b,k,j,i;cin>>n;
	for(i=1;i<=n;++i){
		cin>>a;
		script[a].push_back(i);
	}
	for(i=1;i<=n;++i){
		cin>>k;
		for(j=0;j<k;++j)
			cin>>a,adj[i].push_back(a);
	}
	int ret= 1e9,pos;
	for(j=0;j<3;++j){
		pos= j;
		memset(visit,false,sizeof(visit));
		int cand = n;
		while(true){
			int comp = direct[pos];
			pos = (pos+1)%3;
			for(i=0;i<script[comp].size();++i){
				if(visit[script[comp][i]])continue;
				int cur = script[comp][i];
				bool ok=true;
				for(k=0;k<adj[cur].size();++k){
					if(!visit[adj[cur][k]]){ok=false;break;}
				}
				if(ok)
					visit[cur]=true,i=-1;
			}
			if(isend())break;
			++cand;
		}
		ret= min(cand,ret);
	}
	cout<<ret<<endl;
}
