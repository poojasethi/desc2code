#include <string>
#include <iostream>
#include <vector>
using namespace std;
int n,c[211],i,j,ans=1000000000;
bool t[211],a[211][211];
int main ()
{
	cin>>n;
	for(i=1;i<=n;i++)
		cin>>c[i];
	for(i=1;i<=n;i++)
	{
		cin>>j;
		while(j--)
		{
			int x;
			cin>>x;
			a[i][x]=true;
		}
	}
	for(int l=1;l<4;l++)
	{
		int cur=0;
		for(i=1;i<=n;i++)
			t[i]=false;
		int dn=n;
		int cc=l;
		while (dn>0)
		{
			bool tf=true;
			while (tf)
			{
				tf=false;
				for(i=1;i<=n;i++)
				{
					bool tt=!t[i]&&(c[i]==cc);
					for(j=1;j<=n;j++)
						if (a[i][j]&&!t[j])
						{
							tt=false;
							break;
						}
					if (tt)
					{
						tf=true;
						t[i]=true;
						dn--;
					}
				}
			}
			cc=cc+1;
			if (cc==4) cc=1;
			cur++;
		}
		if (cur<ans) ans=cur;
	}
	cout<<ans+n-1<<endl;
	return 0;
}