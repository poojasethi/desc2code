#include <algorithm>
#include <iostream>
using namespace std;
int N, C[210], K[210], A[210][210];
int run(int s) {
    bool P[210] = {0};
    for (int sum=0, done=0; true; s = (s+1)%3, ++sum) {
	int prev=done;
	while (1) {
	    for (int i=0; i<N; ++i) {
		if (P[i] || C[i]!=s) continue;
		int p = 0;
		for (int j=0; j<K[i]; ++j) p += P[A[i][j]];
		if (p != K[i]) continue;
		++sum, P[i]=1;
		if (++done == N) return sum;
	    }
	    if (prev==done) break;
	    prev=done;
	}
    }
}
int main() {
    while (cin >> N) {
	for (int i=0; i<N; ++i) cin >> C[i], --C[i];
	for (int i=0; i<N; ++i) {
	    cin >> K[i];
	    for (int j=0; j<K[i]; ++j) cin >> A[i][j], --A[i][j];
	}
	cout << min(run(0), min(run(1), run(2))) << endl;
    }
}
