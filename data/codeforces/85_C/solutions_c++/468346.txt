#include<cstdio>
#include<algorithm>
using namespace std;

const int maxn=100000+10;
int father[maxn],L[maxn],R[maxn],ls[maxn],rs[maxn],key[maxn];
int stk[maxn],stl[maxn];
pair<int,int> tmp[maxn];
double sum[maxn];
int n,m,root;
double res[maxn];

void dfs(int u)
{
    if (!ls[u]) L[u]=R[u]=key[u];
    else
    {
        dfs(ls[u]);
        dfs(rs[u]);
        L[u]=L[ls[u]];
        R[u]=R[rs[u]];
    }
}

int det(int a,int b) {return b<key[a]?ls[a]:rs[a];}

int main()
{
    //freopen("input.txt","r",stdin);

    scanf("%d",&n);
    for (int i=1;i<=n;i++) scanf("%d%d",&father[i],&key[i]);
    for (int i=1;i<=n;i++)
    if (father[i]==-1) root=i;else
    if (key[i]<key[father[i]]) ls[father[i]]=i;
    else rs[father[i]]=i;
    dfs(root);
    scanf("%d",&m);
    for (int i=0;i<m;i++) scanf("%d",&tmp[i].first),tmp[i].second=i;
    sort(tmp,tmp+m);

    int top=1;stk[1]=root;
    for (int i=0;i<m;i++)
    {
        while (top>1 && stl[top] && key[stl[top]]<tmp[i].first) top--;
        //if (i>1&& ls[stk[top]] && tmp[i].first<key[stk[top]]) printf("- 0\n");
        while (ls[stk[top]])
        {
            if (tmp[i].first<key[stk[top]]) 
            {
                sum[top]=sum[top-1]+L[rs[stk[top]]],stk[top+1]=ls[stk[top]];
                stl[top+1]=stk[top];
            } else 
            {
                sum[top]=sum[top-1]+R[ls[stk[top]]],stk[top+1]=rs[stk[top]];
                stl[top+1]=stl[top];
            }
            top++;
        }
        res[tmp[i].second]=sum[top-1]/(top-1);
    }
    for (int i=0;i<m;i++) printf("%0.10lf\n",res[i]);
}
