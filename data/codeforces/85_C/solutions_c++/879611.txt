#include <iostream>
#include <fstream>
#include <algorithm>
#include <bitset>
#include <cassert>
#include <cctype>
#include <cmath>
#include <complex>
#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <deque>
#include <iomanip>
#include <map>
#include <numeric>
#include <queue>
#include <set>
#include <stack>
#include <sstream>
#include <string>
#include <vector>
using namespace std;

#define EPS 1e-9
#define INF MOD
#define MOD 1000000007LL
#define fir first
#define iss istringstream
#define sst stringstream
#define ite iterator
#define ll long long
#define mp make_pair
#define rep(i,n) rep2(i,0,n)
#define rep2(i,m,n) for(int i=m;i<n;i++)
#define pi pair<int,int>
#define pb push_back
#define sec second
#define sh(i) (1LL<<i)
#define sz size()
#define vi vector<int>
#define vc vector
#define vl vector<ll>
#define vs vector<string>

int n,m,k[100010],ch[100010][2],R,p,K,mi[100010],ma[100010];
vi v;
vc<double> w;

void f(int c){
	if(ch[c][0]==-1){
		mi[c]=ma[c]=k[c];
		return;
	}
	f(ch[c][0]);
	mi[c]=mi[ch[c][0]];
	v.pb(k[c]);
	f(ch[c][1]);
	ma[c]=ma[ch[c][1]];
}

void g(int c,int d,double s){
	if(ch[c][0]==-1){
		w.pb(s/d);
		return;
	}
	g(ch[c][0],d+1,s+mi[ch[c][1]]);
	g(ch[c][1],d+1,s+ma[ch[c][0]]);
}

int main(){
	cin>>n;
	rep(i,n)ch[i][0]=ch[i][1]=-1;
	rep(i,n){
		cin>>p>>k[i];
		if(p==-1)R=i;
		else{
			p--;
			if(ch[p][0]>-1&&k[i]>k[ch[p][0]])ch[p][1]=i;
			else ch[p][1]=ch[p][0],ch[p][0]=i;
		}
	}
	f(R);
	g(R,0,0);
	cin>>m;
	rep(i,m){
		cin>>K;
		cout<<setprecision(11)<<w[lower_bound(v.begin(),v.end(),K)-v.begin()]<<endl;
	}
}
