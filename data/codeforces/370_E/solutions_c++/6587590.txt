#include <cstdio>
#include <cstring>
#include <algorithm>
#include <utility>

using namespace std;

typedef pair<int,int> PII;

#define X first
#define Y second
#define FOR(I,L,R) for(int I=(L);I<(R);I++)
#define FORD(I,R,L) for(int I=(R)-1;I>=(L);I--)
const int MaxN = 200010;

int n,a[MaxN],res[MaxN],cnt[MaxN];
PII op[MaxN],ed[MaxN];

int dp(){
	if(a[0]>1) return 0;
	op[0]=ed[0]=PII(1,1);
	FOR(i,1,n){
		op[i]=PII(op[i-1].X,op[i-1].Y+1);
		ed[i]=PII(ed[i-1].X,ed[i-1].Y+1);
		if(op[i].Y>5) op[i].X++,op[i].Y=1;
		if(ed[i].Y>2) ed[i].X++,ed[i].Y=1;
		if(a[i]){
			if(a[i]<op[i].X || a[i]>ed[i].X) return 0;
			op[i]=max(op[i],PII(a[i],1));
			ed[i]=min(ed[i],PII(a[i],5));
		}
	}
	res[n-1]=ed[n-1].X;
	if(ed[n-1].Y<2) res[n-1]--;
	if(res[n-1]<op[n-1].X) return 0;
	cnt[res[n-1]]++;
	FORD(i,n-1,0){
		res[i]=min(res[i+1],ed[i].X);
		if(cnt[res[i]]>=5) res[i]--;
		cnt[res[i]]++;
	}
	return 1;
}
int main()
{
	scanf("%d",&n);
	FOR(i,0,n) scanf("%d",&a[i]);
	if(!dp()) puts("-1");
	else{
		printf("%d\n",res[n-1]);
		FOR(i,0,n) printf("%d ",res[i]);
		puts("");
	}
	return 0;
}
