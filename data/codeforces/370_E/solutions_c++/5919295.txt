#include<stdio.h>
#include<stdlib.h>
#include<string.h> 
#include<math.h>
#include<algorithm>

using namespace std;

typedef pair<int,int> P;

#define mp make_pair
#define f first
#define s second
#define INF 2000000000

int n;
int a[200005];
int ret[200005],cnt[200005];
P lb[200005],ub[200005];
int main()
{
while(scanf("%d",&n)==1)
{ 
    for(int i=1;i<=n;i++)
    {
        scanf("%d",&a[i]);
    } 
    if(a[1]>1)
    {
        return puts("-1");
    } 
    lb[1]=ub[1]=mp(1,1);
    for(int i=2;i<=n;i++)
    {
        lb[i]=lb[i-1];
        lb[i].s++;
        ub[i]=ub[i-1];
        ub[i].s++;
        if(lb[i].s>5)
        {
            lb[i].f++;
            lb[i].s=1;
        }
        if(ub[i].s>2)
        {
            ub[i].f++;
            ub[i].s=1;
        }
        if(a[i])
        {
            if(!(lb[i].f<=a[i] && a[i]<=ub[i].f))
            {
                return puts("-1");
            }
            lb[i]=max(lb[i],mp(a[i],1));
            ub[i]=min(ub[i],mp(a[i],INF));
        }
        
    }
    P ans=ub[n];
    if(ans.s==1)
    {
        ans.f--;
        ans.s=INF;
    }
    if(ans<lb[n]) 
    {
        return puts("-1");
    }
    ret[n]=ans.f;
    cnt[ans.f]=1; 
    for(int i=n-1;i>=1;i--)
    {
        ret[i]=min(ret[i+1],ub[i].f);
        if(cnt[ret[i]]==5)
        {
            ret[i]--;
        }
        cnt[ret[i]]++;
    }
    printf("%d\n",ans.f);
    for(int i=1;i<=n;i++)
    {
        printf("%d%c",ret[i],i==n?'\n':' ');
    } 
}
return 0; 
}
