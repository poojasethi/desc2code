#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 200010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,u;
int s[N],id[N],be[N],f[N][6],h[N][6],a[N],b[N],en[N];
inline bool judge() {
	int A=u-j,B=k-s[i],C=be[i]-A-B,D=b[i]-b[i-1]-1;
	return 2*D<=C&&C<=5*D;
}
inline void tian(int x) {
	int i,j,k;
	for (i=m;i;i--) {
		int A=x-s[i];
		For(j,1,A) a[id[i]-j]=b[i];
		A=f[i][x]-h[i][x];
		For(j,1,A) a[en[i-1]+j]=b[i-1];
		A=b[i]-b[i-1]-1;
		if (!A) {
			x=h[i][x]; continue;
		}
		int D=be[i]-(x-s[i])-(f[i][x]-h[i][x]);
		int B=D/A,C=en[i-1]+f[i][x]-h[i][x]+1;
		For(j,1,A)For(k,1,(j<=D%A)+B) a[C++]=b[i-1]+j;
		x=h[i][x];
	}
}
int main() {
	scanf("%d",&n);
	For(i,1,n) scanf("%d",&a[i]);
	{
		for (i=1;i<=n;) {
			for (;i<=n&&!a[i];i++);
			if (i>n) break;
			for (j=i+1;j<=n&&!a[j];j++);
			if (a[i]==a[j]) For(k,i+1,j-1) a[k]=a[i];
			i=j;
		}
		id[0]=-4,s[0]=5;
		for (i=1;i<=n;) {
			int A=i;
			for (;i<=n&&!a[i];i++);
			if (i>n) break;
			for (j=i+1;j<=n&&a[i]==a[j];j++);
			id[++m]=i; s[m]=j-i; be[m]=i-A; b[m]=a[i]; en[m]=j-1;
			i=j;
		}
	}
	
	{
		f[0][5]=1;
		For(i,1,m)For(j,s[i-1],5)if (f[i-1][j])
		For(u,max(2,j),5)For(k,s[i],5) if (judge()) f[i][k]=u,h[i][k]=j;
	}
	
	{
		for (i=5;i;i--) if (f[m][i]) {
			if (i==5&&en[m]+1==n) continue;
			if (i==1&&en[m]==n) continue;
			int A=en[m]+1,B=b[m];
			if (i==1) a[A++]=B;
			for (j=A;j<n;j+=2) a[j]=a[j+1]=++B;
			for (;j<=n;j++) a[j]=a[j-1];
			tian(i);
			printf("%d\n",B);
			For(j,1,n) printf("%d ",a[j]);
			//for(;;);
			return 0;
		}
	}
	printf("-1\n");
	return 0;
}
