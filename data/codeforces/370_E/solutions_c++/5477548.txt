#include<iostream>
#include<cstring>
#include<stdio.h>
#include<algorithm>
#include<cmath>
#include<vector>
#include<deque>
#include<stack>
#include<map>
#include<set>
#define mp make_pair
#define pb push_back
#define MAX(a,b) (a>b?a:b)
#define MIN(a,b) (a<b?a:b)
#define F first
#define S second
using namespace std;
const int n_max=200003;
int a[n_max],ans,i,j,n,cur,x;
int par[n_max],l;
pair<int,int> dp[n_max][7];
pair<int,int> P;

main()
{scanf("%d",&n);
 for(i=1;i<=n;i++)scanf("%d",&a[i]);
 for(i=1;i<5;i++)dp[0][i]=mp(1,0);
 dp[0][5]=mp(0,0);
 /*for(i=2;i<=5;i++)dp[1][i]=mp(1,0);
    for(j=1;j<=5;j++)
        cout<<dp[1][j].F<<' '<<dp[1][j].S<<endl;
    system("pause");*/


 for(i=1;i<=n;i++){
    P=mp(10000000,0);
    for(j=2;j<=5;j++){
        if(dp[i-1][j].F<=dp[i-1][j].S)
        P.F=MIN(P.F,dp[i-1][j].F+1),
        //if(dp[i-1][j].S+1>=P.S)par[i]=j;
        P.S=MAX(P.S,dp[i-1][j].S+1);
        if(a[i])P.F=MAX(P.F,a[i]),
                P.S=MIN(P.S,a[i]);
    }
    dp[i][1]=P;

    for(j=2;j<=5;j++){
        dp[i][j]=dp[i-1][j-1];
        if(a[i])dp[i][j].F=MAX(dp[i][j].F,a[i]),
                dp[i][j].S=MIN(dp[i][j].S,a[i]);
    }
    /*for(j=1;j<=5;j++)
        cout<<dp[i][j].F<<' '<<dp[i][j].S<<endl;
    system("pause");*/
 }
 ans=-1;
 for(i=2;i<6;i++)
    if(dp[n][i].F<=dp[n][i].S)
    if(dp[n][i].S>=ans)ans=dp[n][i].S,l=i;
 if(ans==-1){printf("-1\n");return 0;}
 x=n;
 cur=ans;
 while(x>0){
   //     cout<<x<<' '<<l<<endl;
     for(i=x;i>x-l;i--)a[i]=cur;
     cur--;
     x-=l;
     for(i=2;i<6;i++)
     if(dp[x][i].F<=cur && dp[x][i].S>=cur){l=i;break;}
 }
 cout<<ans<<endl;
 for(i=1;i<=n;i++)cout<<a[i]<<' ';
 cout<<endl;
}

