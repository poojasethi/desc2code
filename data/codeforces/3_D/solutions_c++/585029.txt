#include<iostream>
#include<queue>
using namespace std;
#define LL long long
string st;
LL a[50010],b[50010],ans;
int n,cnt;
priority_queue<pair<int, int>, vector<pair<int, int> >, greater<pair<int, int> > > H;
int main(){
	cin>>st;
	for (int i=0;i<st.size();i++) if (st[i]=='?') n++;
	for (int i=1; i<=n; i++) cin>>a[i]>>b[i];
	for (int i=0,now=0;i<st.size();i++){
		if (st[i]=='(') cnt++;
		else if (st[i]==')') cnt--;
		else{
			now++;
			st[i]=')'; ans+=b[now]; cnt--;
			H.push(make_pair(a[now]-b[now], i));
		}
		if (cnt<0){
			if (H.empty())	break;
			pair<int, int> tmp = H.top(); H.pop();
			ans+=tmp.first; st[tmp.second]='('; cnt+=2;
		}
	}
	if (cnt!=0) cout<<-1<<endl; else cout<<ans<<endl<<st<<endl;
}
