#include <cstdio>
#include <iostream>
#include <algorithm>
#include <string>
#include <map>

using namespace std;

string s,nam[101],ans[101];
map<string,int> no;
int f[51][51],c[101][101];

int main(void)
{
  int p,n,m,q;
  scanf("%d %d %d %d",&p,&n,&m,&q);
  for(int i=1;i<=n;++i)
  {
    cin>>nam[i];
    no[nam[i]]=i;
  }
  for(int i=1;i<=m;++i)
  {
    cin>>nam[n+i];
    nam[n+i].erase(nam[n+i].end()-1);
    no[nam[n+i]]=n+i;
    do
    {
      cin>>s;
      int j=no[s];
      scanf("%d",&f[i][j]);
    }while(getchar()==',');
  }
  for(int count=1;count<=q;++count)
  {
    int i;
    scanf("%d",&i);
    cin>>s;
    ++c[i][no[s]];
    for(int j=1;j<=m;++j)
    {
      bool flag=true;
      for(int k=1;k<=n;++k)
      {
        if(c[i][k]<f[j][k])
        {
          flag=false;
          break;
        }
      }
      if(flag)
      {
        ++c[i][n+j];
        for(int k=1;k<=n;++k)
          c[i][k]-=f[j][k];
        break;
      }
    }
  }
  for(int i=1;i<=p;++i)
  {
    int t=0;
    for(int j=1;j<=n+m;++j)
      if(c[i][j]>0)
        ans[++t]=nam[j];
    printf("%d\n",t);
    if(t>0)
      sort(ans+1,ans+t+1);
    for(int j=1;j<=t;++j)
      cout<<ans[j]<<' '<<c[i][no[ans[j]]]<<endl;
  }
  return 0;
}