n = input()
if n<=2:
    print -1
    exit(0)
a = [0]
for x in raw_input().split():
    a.append(int(x))
rounds = 0
for i in xrange((n-1)/2,0,-1):
    d = max(a[i*2],a[i*2+1])
    idx = [i,2*i,2*i+1]
    rounds += d
    for j in idx:
        a[j] -= d
        a[j] = max(a[j],0)
for i in xrange(2,n+1):
    if a[i]:
        print -1
        exit(0)
print rounds+a[1]
