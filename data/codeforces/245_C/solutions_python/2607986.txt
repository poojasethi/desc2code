n = input()
coin = [0]
coin.extend(map( int, raw_input().split()))
coin.extend([0]*2*n)
steps = 0
#print coin
for i in range(n/2,0,-1):
    steps += max(coin[2*i],coin[2*i+1])
    coin[i] = max(0 , coin[i] - max(coin[2*i],coin[2*i+1]))
steps += coin[1]
if coin[1] and n < 3:
    print -1
elif (coin[n] and not n%2):
    print -1
else:
    print steps
