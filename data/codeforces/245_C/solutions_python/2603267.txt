n=input()
if n<3:
  print -1
  exit()
a=[0]+map(int,raw_input().split())+[0]
k=0
for x in range(n,0,-1):
  if x*2+1<=n:
    d=max(a[x*2],a[x*2+1])
    if d>0:
      a[x]-=d
      a[x*2]-=d
      a[x*2+1]-=d
      k+=d
print -1 if max(a[2:])>0 else k+max(0,a[1])
