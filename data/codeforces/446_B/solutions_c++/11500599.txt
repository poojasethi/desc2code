#include<bits/stdc++.h>
using namespace std;
#define l long long
priority_queue<l> Q;
l r[1003],c[1003],s[1000003],p[1000003],a=-1e16;
l i,j,n,m,k,P,d;
main()
{
    scanf("%I64d%I64d%I64d%I64d",&n,&m,&k,&P);
    for (i=1;i<=n;Q.push(r[i]),i++)
        for (j=1;j<=m;j++)
            scanf("%I64d",&d),r[i]+=d,c[j]+=d;
    for (i=1;i<=k;i++)
        s[i]=Q.top(),Q.pop(),Q.push(s[i]-m*P);
    while (!Q.empty()) Q.pop();
    for (i=1;i<=m;i++)
        Q.push(c[i]);
    for (i=1;i<=k;i++)
        p[i]=Q.top(),Q.pop(),Q.push(p[i]-n*P);
    for (i=1;i<=k;i++)
        s[i]+=s[i-1],p[i]+=p[i-1];
    for (i=0;i<=k;i++)
        a=max(a,s[i]+p[k-i]-i*(k-i)*P);
    printf("%I64d",a);
}
