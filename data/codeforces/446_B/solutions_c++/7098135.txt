#include<bits/stdc++.h>
using namespace std;
typedef long long l;
priority_queue<l>Q;
int i,n,m,k,p,d,j;
l r[1001],c[1001],S[1000001],P[1000001];
int main(){
    scanf("%d%d%d%d",&n,&m,&k,&p);
    for(i=1;i<=n;Q.push(r[i]),i++) for(j=1;j<=m;j++) scanf("%d",&d),r[i]+=d,c[j]+=d;
    for(i=1;i<=k;i++)S[i]=Q.top(),Q.pop(),Q.push(S[i]-m*p);
    while(!Q.empty())Q.pop();for(i=1;i<=m;i++)Q.push(c[i]);for(i=1;i<=k;i++)P[i]=Q.top(),Q.pop(),Q.push(P[i]-n*p);for(i=1;i<=k;i++)S[i]+=S[i-1],P[i]+=P[i-1];
    l ans=-99999999999999l;for(i=0;i<=k;i++) ans=max(ans,S[i]+P[k-i]-(l)(i)*(k-i)*p);
    printf("%I64d\n",ans);
}