#include<cstdio>
#include<cstring>
#include<queue>
#include<algorithm>
using namespace std;
typedef long long ll;
#define M 1000005
#define N 1005
priority_queue<ll> qa,qb;
ll fa[M],fb[M];
ll a[N],b[N];
ll ans;
int n,m,k,p;

int main(){
  int i,j;
  ll x;
  scanf("%d%d%d%d",&n,&m,&k,&p);
  for (i=0;i<n;++i)
    for (j=0;j<m;++j){
      scanf("%I64d",&x);
      a[i]+=x;
      b[j]+=x;
    }
  for (i=0;i<n;++i) qa.push(a[i]);
  for (j=0;j<m;++j) qb.push(b[j]);
  for (i=1;i<=k;++i){
    x=qa.top();
    qa.pop();
    qa.push(x-p*m);
    fa[i]=fa[i-1]+x;
    x=qb.top();
    qb.pop();
    qb.push(x-p*n);
    fb[i]=fb[i-1]+x;
  }
  ans=-1LL<<60;
  for (i=0;i<=k;++i)
    ans=max(ans,fa[i]+fb[k-i]-(ll)p*i*(k-i));
  printf("%I64d\n",ans);
  return 0;
}