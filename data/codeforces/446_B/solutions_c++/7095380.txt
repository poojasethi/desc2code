#include <iostream>
#include <cstdio>
#include <queue>
#include <utility>
using namespace std;
typedef long long ll;
const int maxn=1005,maxk=1000005;
ll a[maxk],b[maxk];
ll r[maxn],c[maxn];
priority_queue <ll> pr,pc;
int mat,m,n,k;
ll p;
int main()
{
	scanf("%d%d%d%I64d",&n,&m,&k,&p);
	for (int i=1;i<=n;i++)
	{
		for (int j=1;j<=m;j++)
		{
			scanf("%d",&mat),r[i]+=mat,c[j]+=mat;
		}
	}
	for (int i=1;i<=n;i++) pr.push(r[i]);
	for (int i=1;i<=m;i++) pc.push(c[i]);
	for (int i=1;i<=k;i++)
	{
		ll q1,q2;
		q1=pr.top();pr.pop();a[i]=a[i-1]+q1;pr.push(q1-p*m);
		q2=pc.top();pc.pop();b[i]=b[i-1]+q2;pc.push(q2-p*n);
	}
	ll ans=0x8000000000000000ll;
	for (int i=0;i<=k;i++) ans=max(ans,a[i]+b[k-i]-(ll)(k-i)*i*p);
	printf("%I64d\n",ans);
	return 0;
}