#include<cstdio>
#include<algorithm>
#include<queue>
using namespace std;
priority_queue<int> q1,q2;
int a1[1000][1000];
long long a2[1000001],a3[1000001];
int main()
{
	int n,m,k,p;long long o,a;
	scanf("%d%d%d%d",&n,&m,&k,&p);
	for(int i=0;i<n;++i)
	{
		a=0;
		for(int j=0;j<m;++j)
		{
			scanf("%d",a1[i]+j);
			a+=a1[i][j];
		}
		q1.push(a);
	}
	for(int j=0;j<m;++j)
	{
		a=0;
		for(int i=0;i<n;++i)
			a+=a1[i][j];
		q2.push(a);
	}
	for(int i=1;i<=k;++i)
	{
		a2[i]=a2[i-1]+q1.top();
		q1.push(q1.top()-m*p);
		q1.pop();
	}
	for(int i=1;i<=k;++i)
	{
		a3[i]=a3[i-1]+q2.top();
		q2.push(q2.top()-n*p);
		q2.pop();
	}
	o=a2[0]+a3[k];
	for(int i=1;i<=k;++i)
	{
		a=k-i;
		o=max(o,a2[i]+a3[a]-a*i*p);
	}
	printf("%I64d\n",o);
}
 				  	  					  		 	   	