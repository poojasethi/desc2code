#include<bits/stdc++.h>

#define FI(i,a,b) for(int i=(a);i<=(b);i++)
#define FD(i,a,b) for(int i=(a);i>=(b);i--)

#define LL long long

using namespace std;

int rs[1005],cs[1005],r,c,k,p;

LL ans,ra[1000005],ca[1000005];

priority_queue<LL,vector<LL>,less<LL> > rq,cq;

int main(){
  scanf("%d %d %d %d",&r,&c,&k,&p);
  FI(i,1,r) FI(j,1,c){
    int x;
    scanf("%d",&x);
    rs[i]+=x;
    cs[j]+=x;
  }
  FI(i,1,r) rq.push(rs[i]);
  FI(i,1,c) cq.push(cs[i]);
  
  FI(i,1,k){
    LL rt=rq.top();
    rq.pop();
    ra[i]=ra[i-1]+rt;
    rq.push(rt-p*c);
    
    LL ct=cq.top();
    cq.pop();
    ca[i]=ca[i-1]+ct;
    cq.push(ct-p*r);
  }
  ans=ra[k];
  FI(i,1,k) ans=max(ans,ra[k-i]+ca[i]-1LL*p*i*(k-i));
  printf("%lld\n",ans);
  return 0;
}