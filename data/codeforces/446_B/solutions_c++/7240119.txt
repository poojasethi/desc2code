#include <bits/stdc++.h>
using namespace std;
#define LL long long
LL N,M,K,P;
LL Row[1010];
LL Col[1010];
LL Dp[2][1000010];
void Iterate(priority_queue < LL > Q,int Rem,int opt)
{
	for(int i = 1;i<=K;i++)
	{
		LL val = Q.top();
		Q.pop();
		Dp[opt][i] = Dp[opt][i-1] + val;
		Q.push(val - Rem*P); 
	}
}
int main()
{
	LL v;
	cin>>N>>M>>K>>P;
	for(int i = 1;i<=N;i++)
	{
		for(int j = 1;j<=M;j++)
		{
			cin>>v;
			Row[i]+=v;
			Col[j]+=v;
		}
	}
	priority_queue < LL > Rows,Cols;
	for(int i = 1;i<=M;i++)
		Cols.push(Col[i]);
	for(int i = 1;i<=N;i++)
		Rows.push(Row[i]);
	Iterate(Rows,M,0);
	Iterate(Cols,N,1);
	LL Ans = -(1LL<<60);
	for(int i = 0;i<=K;i++){
		Ans = max(Ans,Dp[0][i] + Dp[1][K-i] - (K-i)*i*P);
	}
	cout<<Ans<<endl;
	return 0;
}