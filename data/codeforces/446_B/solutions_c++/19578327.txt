#include<bits/stdc++.h>
using namespace std;
typedef long long L;
priority_queue<L>que;
int i,n,m,k,p,d,j;
L r[1001],co[1001],S[1000001],P[1000001];
int main(){
    scanf("%d%d%d%d",&m,&n,&k,&p);
    for(i=1;i<=m;que.push(r[i]),i++)
        for(j=1;j<=n;j++)
            scanf("%d",&d),r[i]+=d,co[j]+=d;
    for(i=1;i<=k;i++)
        S[i]=que.top(),que.pop(),que.push(S[i]-n*p);
    while(!que.empty())que.pop();
    for(i=1;i<=n;i++)que.push(co[i]);
    for(i=1;i<=k;i++)
        P[i]=que.top(),que.pop(),que.push(P[i]-m*p);
    for(i=1;i<=k;i++)
        S[i]+=S[i-1],P[i]+=P[i-1];
    L ans=-99999999999999l;
    for(i=0;i<=k;i++)
        ans=max(ans,S[i]+P[k-i]-(L)(i)*(k-i)*p);
    printf("%I64d\n",ans);
}
