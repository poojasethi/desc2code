#include<bits/stdc++.h>
#define ll long long int
using namespace std;
ll x,n,m,k,p,a[1010],b[1010],sa[1000010],sb[1000010],y,z,res=-1e17;
priority_queue<ll>q1,q2;
int main(){
    cin>>n>>m>>k>>p;
    for(int i=1;i<=n;i++){
        for(int j=1;j<=m;j++){
            scanf("%I64d",&x);
            a[i]+=x;
            b[j]+=x;
        }
    }
    for(int i=1;i<=n;i++)q1.push(a[i]);
    for(int j=1;j<=m;j++)q2.push(b[j]);
    for(int i=0;i<=k;i++){
        y=q1.top();
        z=q2.top();
        q1.pop();
        q2.pop();
        sa[i+1]=sa[i]+y;
        sb[i+1]=sb[i]+z;
        y-=p*m;
        z-=p*n;
        q1.push(y);
        q2.push(z);
    }
    for(int i=0;i<=k;i++){
        res=max(res,sa[i]+sb[k-i]-i*(k-i)*p);
    }
    cout<<res<<endl;
}
