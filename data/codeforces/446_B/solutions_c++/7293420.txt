#include <stdio.h>
#include <iostream>
#include <queue>
using namespace std;
#define ll long long
priority_queue <ll> pq;
int n,m,k;
ll p,d,r[1005],c[1005],a[1000005],b[1000005],v=-10000000000000000;
int main( ){
    cin>>n>>m>>k>>p;
    for (int i=1;i<=n;pq.push(r[i]),i++)
		for (int j=1;j<=m;j++){
			cin>>d;
			r[i]+=d,c[j]+=d;
		}
    for (int i=1;i<=k;i++){
		a[i]=pq.top();
		pq.pop();
		pq.push(a[i]-m*p);
	}
    while (!pq.empty()) pq.pop();
    for (int i=1;i<=m;i++)
		pq.push(c[i]);
    for (int i=1;i<=k;i++){
		b[i]=pq.top();
		pq.pop();
		pq.push(b[i]-n*p);
	}
    for (int i=1;i<=k;i++){
		a[i]+=a[i-1];
		b[i]+=b[i-1];
	}
    for (int i=0;i<=k;i++)
		v=max(v,a[i]+b[k-i]-(ll)i*(k-i)*p);
    cout<<v<<endl;
    return 0;
}
