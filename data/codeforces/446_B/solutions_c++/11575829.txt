#include <cstdio>
#include <queue>
#include <algorithm>
using namespace std;
int n,m,k,p,x,sl[1005],sc[1005];
long long sell[1000005],selc[1000005],ans=1000000000,d;
priority_queue<long long> q1,q2;

int main()
{
	ans*=-ans;
    scanf("%d %d %d %d",&n,&m,&k,&p);
    for(int i=0;i<n;i++)for(int j=0;j<m;j++){
    	scanf("%d",&x);
    	sl[i]+=x;sc[j]+=x;
	}
    for(int i=0;i<n;i++)q1.push(sl[i]);
	for(int i=0;i<m;i++)q2.push(sc[i]);
	for(int i=1;i<=k;i++){
		d=q1.top();q1.pop();
		q1.push(d-p*m);
		sell[i]=sell[i-1]+d;
		d=q2.top();q2.pop();
		q2.push(d-p*n);
		selc[i]=selc[i-1]+d;
	}
	for(int i=0;i<=k;i++){
		ans=max(ans,sell[i]+selc[k-i]-((long long)i)*(k-i)*p);
	}
	printf("%I64d",ans);
	return 0;
}
