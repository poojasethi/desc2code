#include<iostream>
#include<queue>
#define LL long long

using namespace std;
 
LL n,m,k,p,a[1111][1111],sumr[1111],sumc[1111],maxr[1111111],maxc[1111111],ans=-9223372036854775808LL;
priority_queue<LL> r,c;

int main()
{
	cin>>n>>m>>k>>p;
	for(int i=1;i<=n;i++)
		for(int j=1;j<=m;j++)
		{
			cin>>a[i][j];
			sumr[i]+=a[i][j];
			sumc[j]+=a[i][j];
		}
	for(int i=1;i<=n;i++) r.push(sumr[i]);
	for(int i=1;i<=m;i++) c.push(sumc[i]);
	for(int i=1;i<=k;i++)
	{
		LL nowr=r.top();r.pop();
		maxr[i]=maxr[i-1]+nowr;
		nowr-=p*m;
		r.push(nowr);
		LL nowc=c.top();c.pop();
		maxc[i]=maxc[i-1]+nowc;
		nowc-=p*n;
		c.push(nowc);
	}
	for(int i=0;i<=k;i++)
	{
		LL now=maxr[i]+maxc[k-i]-i*(k-i)*p;
		if(now>ans) ans=now;
	}
	cout<<ans<<endl;
	return 0;
}
