#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
priority_queue<ll>Q;
int n,m,k;
ll p,d,r[1001],c[1001],Sum1[1000001],Sum2[1000001];
int main(){
    scanf("%d%d%d%I64d",&n,&m,&k,&p);
    for(int i=1;i<=n;Q.push(r[i]),i++) for(int j=1;j<=m;j++) scanf("%I64d",&d),r[i]+=d,c[j]+=d;
    for(int i=1;i<=k;i++)Sum1[i]=Q.top(),Q.pop(),Q.push(Sum1[i]-m*p);
    while(!Q.empty())Q.pop();
    for(int i=1;i<=m;i++)Q.push(c[i]);
    for(int i=1;i<=k;i++)Sum2[i]=Q.top(),Q.pop(),Q.push(Sum2[i]-n*p);
    for(int i=1;i<=k;i++)Sum1[i]+=Sum1[i-1],Sum2[i]+=Sum2[i-1];
    ll ans=-99999999999999999LL;
    for(int i=0;i<=k;i++) ans=max(ans,Sum1[i]+Sum2[k-i]-(ll)(i)*(k-i)*p);
    printf("%I64d\n",ans);
    return 0;
}