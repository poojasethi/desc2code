
#include <bits/stdc++.h>
using namespace std;

typedef long long LL;

priority_queue <LL> q;

int n,m,k,p,tmp;
int sr[1024],sc[1024];
LL ar[1048576],ac[1048576];
LL ans=-1e18;

void deal(int n,int m,int s[],LL a[]) {
	while (!q.empty()) q.pop();
	for (int i=0;i<n;i++) q.push(s[i]);
	for (int i=1;i<=k;i++) {
		LL t=q.top();
		q.pop();
		a[i]=a[i-1]+t;
		q.push(t-(LL)p*m);
	}
}

int main() {
	scanf("%d%d%d%d",&n,&m,&k,&p);
	for (int i=0;i<n;i++)
		for (int j=0;j<m;j++) {
			scanf("%d",&tmp);
			sr[i]+=tmp;
			sc[j]+=tmp;
		}
	deal(n,m,sr,ar);
	deal(m,n,sc,ac);
	for (int i=0;i<=k;i++) {
		ans=max(ans,ar[i]+ac[k-i]-(LL)i*p*(k-i));
	}
	cout << ans << endl;
	return 0;
}
