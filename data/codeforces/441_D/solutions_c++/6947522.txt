#include<stdio.h>
#include<algorithm>
#include<string.h>
using namespace std;
int next[3005];
int pre[3005];
int q[3005];
int used[3005];
int main ()
{
	int tot,k,a,b,n;
	scanf("%d",&n);
	for(int i =1;i<=n;i++){
		scanf("%d",&a);
		next[a] = i;
		pre[i] = a;
	}
	tot = 0;
	for(int i=1;i<=n;i++){
		if(used[i]) continue;
		int j = next[i];
		while(j!=i){
			used[j] = 1;
			j  = next[j];
		}
		tot++;
	}
	scanf("%d",&k);
	k = n-k;
	int r;
	if(tot<k){
		printf("%d\n",k-tot);
		for(int i=1;i<=n&&tot<k;i++){
			int j = next[i];
			if(j==i) continue;
			r = 0;
			q[r++] = j;
			for(j=next[j];j!=i;j=next[j]) {
				if(j<q[r-1])
					q[r++] = j;
			}
			while(r>0&&tot<k){
				j = q[--r];
				printf("%d %d ",i,j);
				a  = pre[i];
				b  = pre[j];
				next[a] = j;
				pre[j] = a;
				next[b]  = i;
				pre[i] = b;
				tot++;
			}
		}
	}
	else if(tot>k){
		printf("%d\n",tot-k);
		memset(used,0,sizeof(used));
		used[1]  =1;
		for(int j=next[1];j!=1;j=next[j]) used[j] = 1;
		for(int i=2;i<=n&&tot>k;i++){
			if(used[i])  continue;
			tot--;
			printf("1 %d ",i);
			used[i] = 1;
			for(int j=next[i];j!=i;j=next[j]) used[j]=1;
		}
	}
	else
		printf("0\n");
	return 0;
}
