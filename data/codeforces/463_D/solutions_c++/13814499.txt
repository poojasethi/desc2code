#include <cstdio>
#include <algorithm>
#include <iostream>
#include <cstring>
using namespace std;
int dp[5005][5005],n,m,i,j,k,a,b,c,d[5005][6],val[5005];
int f(int x,int y){
	if(x>n)
	return 0;
	if(dp[x][y]!=-1)
	return dp[x][y];
	int res=0,i,x1;
	x1=val[x];
	res=max(res,f(x+1,y));
	for(i=1;i<=k;i++)
	if(d[x1][i] < d[y][i])
	break;
	if(i==k+1)
	res=max(res,1+f(x+1,x1));
	return dp[x][y]=res;
}
int main(){
	scanf("%d %d",&n,&k);
	for(j=1;j<=k;j++)
	for(i=1;i<=n;i++){
        scanf("%d",&a);
        val[i]=a;
	    d[a][j]=i;
    }
    memset(dp,-1,sizeof dp);
    printf("%d\n",f(1,0));
    return 0;
}
