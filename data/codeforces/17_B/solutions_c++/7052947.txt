#include<cmath>
#include<cstring>
#include<cstdio>
#include<iostream>
using namespace std;
#define maxn 1111
int val[maxn];
int ct[maxn];
#define inf 0x3fffffff
int main(){
	int n;
	cin>>n;
	for(int i=1;i<=n;i++)
		cin>>val[i];
	for(int i=1;i<=n;i++)
		ct[i]=inf;
	int m;
	cin>>m;
	int a,b,c;
	for(int i=0;i<m;i++){
		cin>>a>>b>>c;
		if(val[a]>val[b])
			ct[b]=min(ct[b],c);
	}
	int num=0;
	int ans=0;
	for(int i=1;i<=n;i++){
		if(ct[i]!=inf)
			ans+=ct[i];
		else num++;
	}
	if(num>1)puts("-1");
	else cout<<ans<<endl;
	return 0;
}
  	 	        		   		   	 	