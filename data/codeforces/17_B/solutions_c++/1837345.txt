#include<iostream>
#include<algorithm>

using namespace std;

const int maxn = 11000;
 
int s[maxn] ,q[maxn];

int main(){
	int n , m;
	cin >> n;
	for(int i =0 ; i < n; i++)
	cin >> q[i];
	fill(s,s+maxn,-1);
	cin >> m;
	for(int i = 0; i < m ;i++)
	{
		int a , b , c;
		cin >> a >> b >> c;
		a--;
		b--;
		if(q[a]>q[b])
		{
			if(s[b]==-1)
			s[b]=c;
			else
			s[b]=min(s[b],c);
		}
	}
	int y =0 ;
	long long d =0 ;
	for(int i =0 ; i < n ;i++)
	if(s[i]==-1)
	y++;
	else
	d+=s[i];

	if(y>1)
	cout << -1 ;
	else
	cout << d;

	return 0;
	
}
