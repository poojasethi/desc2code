#include <iostream>
#include <cstring>

using namespace std;

int q[1000];
int r[1000];

int main()
{
	int n, m;
	memset (q, -1, sizeof (q ) );
	memset (r, -1, sizeof (r ) );

	cin >> n;
	for (int i = 0; i < n; i++ )
		cin >> q[i];

	cin >> m;
	for (int i = 0; i < m; i++ ){
		int a, b, c;
		cin >> a >> b >> c;
		a--; b--;
		if (q[a] > q[b] && (r[b] == -1 || r[b] > c ) )
			r[b] = c;
	} // end for

	int cnt = 0, res = 0;
	for (int i = 0; i < n; i++ )
		if (r[i] == -1 )
			cnt++;
		else
			res += r[i];

	if (cnt > 1 ){
		cout << -1 << endl;
	}else{
		cout << res << endl;	
	} // end if
	
	return 0;
}
