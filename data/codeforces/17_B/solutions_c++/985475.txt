#include<iostream>
using namespace std;
const int maxn=20000;
int q[maxn],arr[maxn];
int main(){
	fill(arr,arr+maxn,-1);
	int n,m;
	cin>>n;
	for(int i=0;i<n;i++)
		cin>>q[i];
	cin>>m;
	while(m--){
		int a,b,c;
		cin>>a>>b>>c;a--;b--;
		if(q[a]>q[b])
			if(arr[b]==-1)
				arr[b]=c;
			else
				arr[b]=min(arr[b],c);
	}
	long long ans=0,t=0;
	for(int i=0;i<n;i++){
		if(arr[i]==-1)
			t++;
		else
			ans+=arr[i];
	}
	if(t>1)
		cout<<-1<<endl;
	else
		cout<<ans<<endl;
}


