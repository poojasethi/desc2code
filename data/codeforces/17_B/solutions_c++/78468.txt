#include <iostream>
#include <vector>

using namespace std;


int mini;
int N;


int main(){
  mini = -1;
  cin >> N;
  vector<int> C (N, -1);
  vector<int> Q (N, -1);

  for(int i=0; i<N; ++i){
    cin >> Q[i];
  }

  int M;
  cin >> M;
  for(int i=0; i<M; ++i){
    int a, b, c;
    cin >> a >> b >> c;
    if(Q[a-1]<= Q[b-1]) continue;
    if(C[b-1] == -1 || C[b-1] > c){
      C[b-1] = c;
    }
  }

  int ans = 0;
  int B = N;
  for(int i=0; i<N; ++i){
    if(C[i] != -1){
      ans += C[i];
      --B;
    }
  }
  if(B==1) cout << ans << endl;
  else     cout << -1 << endl;

}
