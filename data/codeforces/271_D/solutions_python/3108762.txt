s,p=raw_input(),raw_input()
s=sorted(s[i:] for i in range(len(s)))
k,x,d=input(),0,ord('a')
l=''
for u in s:
  i,j,y,n=0,0,0,min(len(l),len(u))
  while i<n and l[i]==u[i]:i+=1
  n=len(u)
  while j<n:
    y+='0'==p[ord(u[j])-d]
    if y>k:
      break
    j+=1
  x+=max(0,j-i)
  l=u
print x