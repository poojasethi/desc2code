#include <cstdio>
#include <algorithm>
int k,ans;
char s[1510];
char flag[30];
int tot;
long long hash[1125760];
int main()
{
    int i,j,cnt;
    long long v;
    scanf("%s%s%d",s+1,flag,&k);
    for(i=1;s[i];i++)
    {
        cnt = v = 0;
        for(j=i;s[j];j++)
        {
            if(flag[s[j]-'a'] == '0') cnt++;
            if(cnt>k) break;
            hash[tot++] = v = (v*131)^s[j];
        }
    }
    std::sort(hash,hash+tot);
    printf("%d",std::unique(hash,hash+tot)-hash);
    return 0;
}