#include<cstdio>
#include<cstring>
#include<iostream>
using namespace std;
char a[1501],b[27];
int k,tree[2250000][26];
int main()
{
    int n;
    scanf("%s%s%d",a,b,&k);
    n=strlen(a);
    int ans,tmp,num;
    ans=0;
    for(int i=0;i<n;i++)
    {
        tmp=num=0;
        for(int j=i;j<n;j++)
        {
            if(b[a[j]-'a']=='0')num++;
            if(num>k)break;
            if(!tree[tmp][a[j]-'a']) tree[tmp][a[j]-'a']=++ans;
            tmp=tree[tmp][a[j]-'a'];
        }
    }
    printf("%d\n",ans);
    return 0;
}

				  			    		 	 	     	