#include<set>
#include<cstdio>
#include<cstring>

#define rep(i,n) for(int i=0;i<(n);i++)

using namespace std;

typedef long long ll;

const ll M1=1000000007;
const ll M2=1000000009;

int main(){
	char s[1501],good[27];
	int K; scanf("%s%s%d",s,good,&K);

	int len=strlen(s);

	set< pair<ll,ll> > ans;
	rep(i,len){
		ll hash1=0,hash2=0;
		int ilosc=0;
		for(int j=i;j<len;j++){
			hash1=hash1*M1+s[j];
			hash2=hash2*M2+s[j];
			if(good[s[j]-'a']=='0') ilosc++;
			if(ilosc<=K) ans.insert(make_pair(hash1,hash2));
		}
	}
	printf("%d\n",ans.size());

	return 0;
}
