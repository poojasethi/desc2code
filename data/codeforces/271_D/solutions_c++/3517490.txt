#include <iostream>
#include <cstring>
#include <cstdio>
#include <cmath>
using namespace std;
const int M = 2000;
char ch[M],g[M];
int v[1200000][26],k;

int main(){
	cin>>ch>>g>>k;
	int ans=1;
	for(int i=0;ch[i];i++){
		int tmp=0,x=1;
		for(int j=i;ch[j];j++){
			if(g[ch[j]-'a']=='0')
				tmp++;
			if(k<tmp)break;
			if(v[x][ch[j]-'a']==0)
				v[x][ch[j]-'a']=++ans;
			x=v[x][ch[j]-'a'];
		}
	}
	cout<<ans-1<<endl;
	return 0;
}
