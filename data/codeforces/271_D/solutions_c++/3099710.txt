#include<stdio.h>
#include<string.h>
#include<math.h>
#define MAXN 1501
#define MAX 3800000
int a[27];
char s[MAXN];
int ans,len,tot,k;
int v[MAX][26];

void add(int j)
{	int bad=0,x=0,tmp,i;
	for (i=j;i<len;i++)
	  {tmp=s[i]-97;
	   bad+=a[tmp];
	   if (bad>k) break;
	   if (v[x][tmp]==0) v[x][tmp]=++tot;
	   x=v[x][tmp];
	  }
}
int main()
{	char t[27];
	int i;
	scanf("%s%s",s,t);scanf("%d",&k);
	len=strlen(s);
	for (i=0;i<26;i++) a[i]=49-t[i];
	for (i=0;i<len;i++) add(i);
	printf("%d\n",tot);
	return 0;
}