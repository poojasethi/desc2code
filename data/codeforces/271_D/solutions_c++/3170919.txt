#include<cstdio>
#include<algorithm>
#include<cstring>
int n,k;char s[1510],bad[30];int zmax(char *s){int z[1510]={},mx=0;for(int i=1,l=0,r=0,n=strlen(s);i<n;++i){if(i<=r)z[i]=std::min(r-i+1,z[i-l]);while(i+z[i]<n&&s[z[i]]==s[i+z[i]])++z[i];mx=std::max(mx,z[i]);if(i+z[i]-1>r)l=i,r=i+z[i]-1;}return mx;}main(){scanf("%s%s%d",s,bad,&k);int n=strlen(s);std::reverse(s,s+n);int i,res=0;for(i=n-1;i>=0;--i){int cnt=0,j=i;while(j<n&&cnt<=k){if(bad[s[j]-'a']=='0')++cnt;if(cnt>k)break;++j;}res+=std::max(j-i-zmax(s+i),0);}printf("%d",res);}