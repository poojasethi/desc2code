#include<bits/stdc++.h>
using namespace std;
map<long long int, int> hash;
int main()
{
	string s;
	int k, ans = 0, i, j;
	string gob;
	cin >> s >> gob >> k;
	int counti;
	long long int hashVal;
	for(i = 0; i < s.size(); i++)
	{
		hashVal = 0;
		counti = 0;
		for(j = i; j < s.size(); j++)
		{
			counti += (gob[s[j]-'a']=='0');
			if(counti>k)
				break;
			hashVal = hashVal*29 + (long long int)(s[j]-'a' + 1);
			if(!hash[hashVal])
				ans++,hash[hashVal] = 1;
		}
	}
	cout << ans << endl;
	return 0;
}
