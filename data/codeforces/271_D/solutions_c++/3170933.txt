#include<cstdio>
#include<algorithm>
#include<cstring>
int n,k;char s[1510],B[30];int Z(char *s){int z[1510]={},M=0;for(int i=1,l=0,r=0,n=strlen(s);i<n;++i){if(i<=r)z[i]=std::min(r-i+1,z[i-l]);while(i+z[i]<n&&s[z[i]]==s[i+z[i]])++z[i];M=std::max(M,z[i]);if(i+z[i]-1>r)l=i,r=i+z[i]-1;}return M;}main(){scanf("%s%s%d",s,B,&k);int n=strlen(s);std::reverse(s,s+n);int i,R=0;for(i=n-1;i>=0;--i){int C=0,j=i;while(j<n&&C<=k){if(B[s[j]-'a']=='0')++C;if(C>k)break;++j;}R+=std::max(j-i-Z(s+i),0);}printf("%d",R);}