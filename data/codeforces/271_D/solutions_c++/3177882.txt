#include<cstdio>
#include<set>
#include<algorithm>
#define NMAX 1505
#define MOD1 10000007
#define MOD2 10000003
using namespace std;

int main() {
	char S[NMAX], G[30];
	int k;
	scanf("%s%s%d", S, G, &k);

	set< pair<int, int> > St;
	for(int i = 0; S[i]; ++i) {
		int b = 0, h1 = 0, h2 = 0;
		for(int j = i; S[j]; ++j) {
			if(G[S[j] - 'a'] == '0')
				++b;
			if(b > k)
				break;
			h1 = (h1 * 27 + S[j] - 'a' + 1) % MOD1;
			h2 = (h2 * 27 + S[j] - 'a' + 1) % MOD2;
			St.insert(make_pair(h1, h2));
		}
	}

	printf("%d\n", (int)St.size());
	return 0;
}

