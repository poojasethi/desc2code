#include<iostream>
#include<string.h>
#include<algorithm>
using namespace std;
typedef unsigned long long ll;
ll a[3000000],c;
char s[1520],v[30];
int n,k;
int main()
{
	cin>>s>>v;
	int n=strlen(s);
	cin>>k;
	for(int i=0;i<n;i++)
	{
		int kk=k;
		ll h=0;
		for(int j=i;j<n;j++)
		{
			if(v[s[j]-'a']=='0'&&!kk--)
				break;
			h=(h*131)^s[j];
			a[c++]=h;
		}
	}
	sort(a,a+c);
	cout<<unique(a,a+c)-a;
}