#include <cstdio>
#include <cstring>
#include <iostream>
#include <set>

using namespace std;

typedef long long int Lint;

const int MAXN=1515;

int N,K;

char s[MAXN],val[27];

set<Lint> res;

int main(){
	
	scanf(" %s %s %d",s+1,val,&K);
	
	N=strlen(s+1);
	
	for( int i=1 ; i<=N ; i++ ){
		
		int cnt=0;
		Lint tmp=0LL;
		
		for( int j=i ; j<=N ; j++ ){
			
			cnt+=1-val[s[j]-'a']+'0';
			
			if( cnt>K )
				break;
			
			tmp=tmp*109LL+s[j];
			res.insert(tmp);
		}
	}
	
	printf("%d\n",(int)res.size());
	return 0;
}
