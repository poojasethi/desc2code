#include<iostream>
#include<string.h>
#include<set>
using namespace std;
typedef unsigned long long ll;
set<ll>q;
char s[1520],v[30];
int n,k;
int main()
{
	cin>>s>>v;
	int n=strlen(s);
	cin>>k;
	for(int i=0;i<n;i++)
	{
		int kk=k;
		ll h=0;
		for(int j=i;j<n;j++)
		{
			if(v[s[j]-'a']=='0'&&!kk--)
				break;
			h=(h*131)^s[j];
			q.insert(h);
		}
	}
	cout<<q.size();
}