#include <cstdio>
#include <cstring>
#include <iostream>
#include <set>

using namespace std;

typedef long long Lint;

const int MAXN = 1905;

int N,maxx;
char ar[MAXN],val[27];

set<Lint> substr;

int main()
{
	scanf(" %s",ar);
	N = strlen(ar);
	
	scanf(" %s %d",val,&maxx);
	
	for( int i=0 ; i<N ; i++ ){
		int t=0;
		Lint tmp=0;
		for( int j=i ; j<N ; j++ ){
			t += 1-(val[ar[j]-'a']-'0');
			
			if( t > maxx )	break;
			
			tmp = tmp*109LL+ar[j];
			substr.insert(tmp);
		}
	}
	
	cout << substr.size() << endl;
	
	return 0;
}
