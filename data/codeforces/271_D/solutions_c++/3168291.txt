#include <cstdio>
#include <set>
#include <cstring>
#include <algorithm>
using namespace std;

char s[1600],f[27];
int c;
	int
main ( int argc, char *argv[] )
{
	scanf("%s",s); scanf("%s",f); scanf("%d",&c);
	set<long long>st;
	for(int i=0,len=strlen(s);i<len;++i) {
		long long th = 0;
		for(int j=i,r=c;j<len;++j) {
			if(f[s[j]-'a']=='0' && !r--) break;
			th = (th*131)^s[j];
		st.insert(th);
		}
	}
	printf("%d",st.size());
	return EXIT_SUCCESS;
}				/* ----------  end of function main  ---------- */
