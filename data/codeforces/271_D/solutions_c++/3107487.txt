#include <set>
#include <string>
#include <iostream>
#include <algorithm>
#define INS insert
#define LL long long
using namespace std;


int main(){
	int k, i, j;
	string s, t;
	set<LL> S;
	cin >> s >> t >> k;
	for(i = 0;i < s.size();i++){
		int remain = k;
		LL Hash = 0;
		for(j = i;j < s.size();j++){
			if(t[s[j] - 'a'] == '0')
				remain--;
			if(remain < 0)
				break;
		 	Hash = (LL)(Hash * 131) ^ s[j];
			S.INS(Hash);
		}
	}
	cout << (int)S.size() <<endl;
	return 0;
}
