#include <bits/stdc++.h>
using namespace std;
string a;
int N,x,K,cnt;
char c;
int b=256;
long long hsh;
set<long long >diff;
bool bad[300];
#define MOD 34027797218763967LL;
int main()
{
cin>>a;
for(int i=0;i<26;i++)
{
    cin>>c;
    if(c=='0')
    bad[i+97]=1;
    else bad[i+97]=0;
}
cin>>K;
for(int i=0;i<a.size();i++){
hsh=0;
cnt=0;
for(int j=i;j<a.size();j++)
{
    if(bad[a[j]])
    cnt++;
    hsh=(hsh*b+a[j])%MOD;
    if(cnt<=K)
    diff.insert(hsh);
}
}
cout<<diff.size();
    return 0;
}
