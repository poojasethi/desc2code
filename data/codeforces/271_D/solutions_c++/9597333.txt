#include <iostream>
#include <string>
#include <set>
using namespace std;
typedef unsigned long long ull;

const ull BASE = 1000000007;
string S, good;
int N, K;
set<ull> st;

int main()
{
	cin >> S >> good >> K;
	N = S.size();

	for (int i = 0; i < N; i++)
	{
		int cnt = 0;
		ull cur = 0, power = 1;
		for (int j = i; j < N; j++)
		{
			cnt += good[S[j]-'a'] == '0';
			if (cnt > K)
				break;

			cur += power*S[j];
			if (st.find(cur) == st.end())
				st.insert(cur);
			power *= BASE;
		}
	}

	cout << st.size() << "\n";

	return 0;
}