#include <cstdio>
#include <algorithm>
using namespace std;
typedef unsigned long long int ULL;

char s1[2000], s2[30];
pair<ULL, ULL> a[2260000];

int main (){
	scanf("%s%s", s1, s2);
	int n = 0, k; scanf("%d", &k);
	for(int i = 0; s1[i]; i++){
		int cnt = 0; ULL h1 = 5381, h2 = 0;
		for(int j = i; s1[j]; j++){
			if(s2[s1[j]-'a'] == '0') cnt++;
			if(cnt > k) break;
			h1 = h1 * 33ll + s1[j];
			h2 = h2 * 131ll + s1[j];
			a[n++] = make_pair(h1, h2);
		}
	}
	sort(a, a+n);
	printf("%d\n", (int)(unique(a, a+n)-a));
  return 0;
}
