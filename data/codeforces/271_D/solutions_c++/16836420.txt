#include<iostream>
#include<string>
#include<set>
#define  mod 34027797218763967LL
typedef long long ll;
using namespace std;
bool bad[26];
const int base=256;
ll hash,count;
	set<ll>st;


int main(){
	string  s,x;

	ll k;
	cin>>s;
	cin>>x;
	for(int i=0;i<26;i++)
	if(x[i]=='0')
	bad[i]=true;
	cin>>k;
	int len=s.size();
	for(int i=0;i<len;i++)
	{
		count=0;
		hash=0;
		for(int j=i;j<len;j++){
			hash=((hash)*(base)+s[j])%mod;
			if(bad[s[j]-'a'])
			count++;
			if(count<=k)
			st.insert(hash);
		}
	}
	cout<<st.size();
	return 0;
}
