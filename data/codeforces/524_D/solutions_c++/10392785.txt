#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,r,t=0,c,v,y,u,a[100000],s[100000],d[100000];
  char h[100];
  cin>>q>>y>>u;
  for(w=0;w<100000;w++)
   a[w]=0;
  v=0;
  for(w=0;w<q;w++){
   scanf("%s",h);
   s[w]=(((h[0]-48)*10+h[1]-48)*60+(h[3]-48)*10+h[4]-48)*60+(h[6]-48)*10+h[7]-48;
   }
  e=0;
  bool b=0;
  int lst=0,lst1=-u;
  for(w=0;(w<100000)&&(e<q);w++){
   v-=a[w];
   while((e<q)&&(s[e]==w)){
    if(v<y){
     v++;
     t++;
     d[e]=t;
     lst=t;
     lst1=w;
     if(v==y)
      b=1;}
    else{
     d[e]=lst;
     a[lst1+u]--;
     lst1=w;}
    a[w+u]++;
    e++;}}
  if(!b){
   cout<<"No solution";
   return 0;}
  cout<<t;
  for(w=0;w<q;w++)
   printf("\n%d",d[w]);
  return 0;}
