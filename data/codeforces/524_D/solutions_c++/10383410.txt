#include<stdio.h>
#include<algorithm>
#define mp make_pair
#define ft first
#define sd second
using namespace std;
const int maxn=200050;
typedef pair<int,int> pii;
int n,m,T,ans=0,id[maxn];
bool z=0;
pii p[maxn];
int ps=0;
int cnt[maxn];
int main()
{
#ifndef ONLINE_JUDGE
	freopen("data.in","r",stdin);
#endif
	int i,j,cur;
	scanf("%d%d%d",&n,&m,&T);
	for(i=1;i<=n;i++)
	{
		int t1,t2,t3,tim;
		scanf("%d:%d:%d",&t1,&t2,&t3);
		tim=(t1*60+t2)*60+t3;
		p[ps++]=mp(tim,i);
		p[ps++]=mp(tim+T,-i);
	}
	sort(p,p+ps);
	for(i=cur=0;i<ps;i++)
	{
		if(p[i].sd>0)
		{
			if((cur+1)>m)
				cnt[id[p[i].sd]=j]++;
			else 
				cnt[j=id[p[i].sd]=++ans]++,cur++;
			if(cur>=m) z=1;
		}
		else if(!--cnt[id[-p[i].sd]])
				cur--;
		//printf(" %d\n",cur);
	}
	if(!z) printf("No solution\n");
	else 
	{
		printf("%d\n",ans);
		for(i=1;i<=n;i++)
			printf("%d\n",id[i]);
	}
	return 0;
}
