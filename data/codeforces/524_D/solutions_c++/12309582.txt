#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<iostream>
#include<algorithm>
using namespace std;
const int maxn = 20005;
int n,m,T,t[maxn],q[maxn],head,tail;
int dp[maxn];
int getTime(int hh,int mm,int ss){
    return hh*3600+mm*60+ss;
}
int main(){
    cin>>n>>m>>T;
    int hh,mm,ss;
    head=tail=0;
    bool ok=0;
    for(int i=1;i<=n;i++){
        scanf("%d:%d:%d",&hh,&mm,&ss);
        t[i]=getTime(hh,mm,ss);
    }
    dp[0];
    dp[1]=1;
    q[tail++]=1;
    if(dp[1]==m) ok=1;
    for(int i=2;i<=n;i++){
        while(tail!=head&&t[q[head]]<t[i]-T+1) head++;
        if(tail!=head){
            int x=dp[q[head]],y=dp[q[tail-1]];
            if(y-x+1<m) dp[i]=dp[i-1]+1;
            else dp[i]=dp[i-1];
            if(dp[i]-dp[q[head]]+1==m) ok=1;
        }
        else dp[i]=dp[i-1]+1;
        q[tail++]=i;
    }
    if(!ok) printf("No solution\n");
    else{
        printf("%d\n",dp[n]);
        for(int i=1;i<=n;i++) printf("%d\n",dp[i]);
    }
    return 0;
}

	 	 	  	  				 	 		  		 					 	