#include <cstdio>
#include <cstring>
#include <cstdlib>
#include <algorithm>
#define MAXN 20005

using namespace std;

int main ()
{
	int N, M, T;
	scanf("%d %d %d",&N,&M,&T);
	static int a[MAXN];
	int i;
	for (i = 0; i < N; i++)
	{
		int h, m, s;
		scanf("%d:%d:%d",&h,&m,&s);
		a[i] = h * 60 * 60 + m * 60 + s;
	}
	static int q[MAXN];
	static int res[MAXN];
	int r = 0; int w = 0;
	char isOK = 0;
	int num = 0;

	for (i = 0; i < N; i++)
	{
		while ((r < w) && (q[r] < a[i])) r++;
		if ((w - r) < M)
		{
			num++;
			res[i] = num;
			q[w] = a[i] + T - 1;
			w++;
			if ((w - r) == M) isOK = 1;
		}
		else
		{
			res[i] = num;
			q[w-1] = a[i] + T - 1;
		}
	}

	if (!isOK) printf("No solution\n");
	else
	{
		printf("%d\n",num);
		for (i = 0; i < N; i++)
		{
			printf("%d\n",res[i]);
		}
	}
	return 0;
}