#include<cstring>
#include<algorithm>
#include<cstdio>

using namespace std;

const int maxn = 20005;

int da[maxn],ans[maxn];

int get()
{
    char s[maxn];scanf("%s",s);
    s[2] = s[5] = 0;
    return atoi(s)*3600 + atoi(s+3)*60 + atoi(s+6);
}

int q[maxn];

int main()
{
    int n,m,t;scanf("%d%d%d",&n,&m,&t);
    for(int i=1;i<=n;i++)
        da[i] = get();
    int front=1,tail=0,r = 1;q[++tail] = 1;ans[1] = 1;bool done = (m==1)?true:false;
    for(int i=2;i<=n;i++)
    {
        while(tail>=front&&da[i]-da[q[front]]>=t)
            front++;
        if(tail-front+1==m)
        {
            ans[i] = ans[q[tail]];
            q[tail] = i;
        }
        else
        {
            q[++tail] = i;
            ans[i] = ++r;
            if(tail-front+1==m)
                done = 1;
        }
    }
    if(done)
    {
        printf("%d\n",r);
        for(int i=1;i<=n;i++)
            printf("%d\n",ans[i]);
    }
    else
        puts("No solution");
}
