#include <bits/stdc++.h>
using namespace std;
typedef long long int ll;
int tim[20005];
int ans[20005];
int main(){
 int n,m,maxi;
 string s;
 cin >> n >> m >> maxi;
 for(int i=0;i<n;i++){
     cin >> s;
     int tot = 0;
     for(int j=0;j<s.length();j++) s[j] -= '0';
     tot += (s[7]+s[6]*10)+60*(s[4]+s[3]*10)+3600*(s[1]+s[0]*10);
     tim[i] = tot;
 }
 int j= 0;
 bool flag = false;
 int taken = 0;
 for(int i=0;i<n;i++){
     while(tim[j]-tim[i] < maxi){
       if(i==j || taken-ans[i]<m-1) taken++;
       if(j-i == m-1) flag = true;
       ans[j] = taken;
       j++;
       if(j==n) break;
     }
     if(j==n) break;
 }
 if(!flag){
     puts("No solution");
     return 0;
 }
 cout << ans[n-1] << endl;
 for(int i=0;i<n;i++) cout << ans[i] << endl;
 return 0;
}
