#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <string>
#include <map>
#define N 10201
#define INF 999999999

using namespace std;


int n,k,t;

int main(){
  	//freopen("input.txt","r",stdin);
  //  freopen("output.txt","w",stdout);
    scanf("%d %d %d\n",&n,&k,&t);

    int kol = 0, tm = 0, ans[111111];
    string s;
    int q[111111];
    int l = 0,r = 0,ch =0;
    for (int i=1;i<=n;i++){
        getline(cin,s);
        tm = 0;
        tm += (s[0]-'0')*36000;
        tm += (s[1]-'0')*3600;
        tm += (s[3]-'0')*600;
        tm += (s[4]-'0')*60;
        tm += (s[6]-'0')*10;
        tm += (s[7]-'0');
        while ((l<r)&&(q[l]<tm)) l++;
        if (r-l<k) q[r++] = tm + t - 1,ans[i]=++kol; else ans[i]=ans[i-1],q[r-1] = tm + t - 1;
        if ((r-l)==k) ch = 1;
    }
    if (ch==0){
        cout << "No solution" << endl;
    }else{
        printf("%d\n",kol);
        for (int i=1;i<=n;i++) printf("%d\n",ans[i]);
    }
    return 0;
}
