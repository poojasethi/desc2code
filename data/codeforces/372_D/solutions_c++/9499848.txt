#include<cstdio>
#include<cstring>
#include<iostream>
#include<algorithm>
#include<set>
#define N 200100
using namespace std;
typedef long long LL;
int V[N], nxt[N], p[N], A[N], B[N], d[N], n, m, i, j, ed, tm, k, f[N][18];
LL ans, s[N];
set<int> S;
void Add(int u, int v)
{
	V[++ed] = v, nxt[ed] = p[u], p[u] = ed;
}
void Dfs(int x, int fa)
{
	f[x][0] = fa, A[x] = ++tm, B[tm] = x, d[x] = d[fa] + 1;
	for (int i = p[x]; i != -1; i = nxt[i])
		if (V[i] != fa) Dfs(V[i], x);
}
int Lca(int u, int v)
{
	if (d[u] < d[v]) swap(u, v);
	for (int i = 17; i >= 0; i--)
		if (d[f[u][i]] >= d[v]) u = f[u][i];
	if (u == v) return u;
	for (int i = 17; i >= 0; i--)
		if (f[u][i] != f[v][i]) u = f[u][i], v = f[v][i];
	return f[u][0];
}
LL Calc(int x)
{
	if (!S.size()) return 0;
	set<int>::iterator it = S.lower_bound(A[x]);
	int p1, p2, z1, z2, z3;
	if (it == S.begin() || it == S.end())
		p1 = B[*S.begin()], p2 = B[*(--S.end())];
	else p1 = B[*it], p2 = B[*(--it)];
	z1 = Lca(x, p1), z2 = Lca(x, p2), z3 = Lca(p1, p2);
	return d[x] - d[z1] - d[z2] + d[z3];
}
int main()
{
	memset(p, -1, sizeof(p));
	scanf("%d%d", &n, &k);
	int u, v; k--;
	for (i = 1; i < n; i++)
	{
		scanf("%d%d", &u, &v);
		Add(u, v), Add(v, u);
	}
	Dfs(1, 0);
	for (i = 1; i <= 17; i++)
		for (j = 1; j <= n; j++)
			f[j][i] = f[f[j][i - 1]][i - 1];
	int j = 1, ans = 0, mx = 0;
	for (i = 1; i <= n; i++)
	{
		int x = Calc(j);
		while (ans + x <= k && j <= n)
			ans += x, S.insert(A[j]), j++, x = Calc(j);
		mx = max(mx, j - i);
		S.erase(A[i]), ans -= Calc(i);
	}
	printf("%d", mx);
	return 0;
}