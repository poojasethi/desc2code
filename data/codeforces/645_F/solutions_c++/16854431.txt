#include<bits/stdc++.h>

using namespace std;

#define pii pair<int,int>
#define ll long long
#define N (int)(1e6+10)
#define mod 1000000007
#define mp make_pair
#define pb push_back
#define nd second
#define st first
#define inf mod
#define endl '\n'
#define sag (sol|1)
#define sol (root<<1)
#define ort ((bas+son)>>1)
#define bit(x,y) ((x>>y)&1)

int i,j,k,n,m,x,y,z,A[N],comb[2*N];
int ans,p[N],q;
vector<int> d[N];

int fe(int x,int t){
	if(!t)
		return 1;
	int p = fe(x,t/2);
	p = (ll)p*p%mod;
	if(t&1)
		return (ll)p*x%mod;
	return p;
}

void add(int x){
	for(int i=0 ; i<d[x].size() ; i++){
		int t = d[x][i];
		ans = ((ll)ans-((ll)comb[A[t]]*p[t])%mod+mod)%mod;
		ans = ((ll)ans+((ll)comb[++A[t]]*p[t])%mod+mod)%mod;
	}
}

int main(){
	cin >> n >> k >> q;

	int p1=1,p2=1,p3=1;

	for(i=1 ; i<=k ; i++)
		p1 = (ll)p1*i%mod;

	p2 = fe(p1,mod-2);

	for(i=k ; i<2*N ; i++){
		comb[i] = ((ll)p1*p2)%mod*fe(p3,mod-2)%mod;
		p1 = (ll)p1*(i+1)%mod;
		p3 = (ll)p3*(i+1-k)%mod;
	}

	for(i=1 ; i<N ; i++){
		p[i] += i;
		for(j=i ; j<N ; j += i){
			if(j!=i)
				p[j] -= p[i];
			d[j].pb(i);
		}
	}

	for(i=1 ; i<=n+q ; i++){
		scanf("%d",&x);
		add(x);
		if(i>n)
			cout << ans << endl;
	}
}
