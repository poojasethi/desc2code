#include<bits/stdc++.h>
#define fi first
#define se second
using namespace std;
typedef long long ll;
typedef pair<int,ll> ii;
typedef pair<ii,int> i3;
ii pr[200005];
i3 a[200005];
ll b[800020],inf=1e18;
int n,m,ty,x,re[200005],y,po,s;
map<ii,int> d;
map<ii,int>::iterator co;

void up(int p,int l,int r){
if(ty) if(x<l||x>r) return ;
if(l==r){
    b[p]=a[l].fi.fi+a[l].fi.se;
    return ;
}
int mid=(l+r)/2;
up(2*p,l,mid);up(2*p+1,mid+1,r);
b[p]=max(b[2*p],b[2*p+1]);
}

int q(int p,int l,int r){
if(l>y) return -1;
else if(l==r){
    if(b[p]>=po) return l;
    else return -1;
}
int mid=(l+r)/2,tem=-1;
if(b[2*p]>=po) tem=q(2*p,l,mid);
if(tem!=-1) return tem;
if(b[2*p+1]>=po) return q(2*p+1,mid+1,r);
else return -1;
}

int main(){
cin>>n>>m;memset(re,0,sizeof(re));
for(int i=0;i<n;i++){
    scanf("%d%I64d",&a[i].fi.fi,&a[i].fi.se);
    a[i].se=i;
}
sort(a,a+n);d.clear();
ty=0;up(1,0,n-1);ty=1;
for(int i=0;i<m;i++){
    cin>>po>>s;
    y=upper_bound(a,a+n,i3(ii(po,inf),inf))-a;
    if(y){
        y--;
        x=q(1,0,n-1);
        if(x==-1){
            d[ii(po,s)]++;
            continue;
        }else{
            int te1=1;a[x].fi.se+=s;
            while(!d.empty()){
                co=d.lower_bound(ii(a[x].fi.fi,-1));
                if(co==d.end()) break;
                else{
                    if(co->fi.fi-a[x].fi.fi<=a[x].fi.se){
                        te1+=co->se;a[x].fi.se+=co->fi.se*co->se;d.erase(co);
                    }else break;
                }
            }
            re[x]+=te1;
            up(1,0,n-1);
        }
    }
}
for(int i=0;i<n;i++) pr[a[i].se].fi=re[i],pr[a[i].se].se=a[i].fi.se;
for(int i=0;i<n;i++) printf("%d %I64d\n",pr[i].fi,pr[i].se);
return 0;
}
