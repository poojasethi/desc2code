#include <cmath>
#include <map>
#include <vector>
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <algorithm>
#include <cstring>
#include <set>
#include <bitset>
#include <memory.h>
#include <functional>
#include <queue>
#include <fstream>
#include <ctime>
#include <deque>
#include <utility>
#include <stack>
#include <sstream>
#include <list>
#include <cctype> 
#include <numeric> 
using namespace std;
#define sqr(_) ((_)*(_))

typedef long long LL;

typedef pair<int, int> Pii;
#define x first
#define y second
#define mp make_pair
#define pb push_back

const int MAXN = 70 + 5;

int n, a, b, c, f[MAXN * MAXN * MAXN], pre[MAXN * MAXN * MAXN], head, tail, que[MAXN * MAXN * MAXN];
char str[MAXN][MAXN];

int calc(int a, int b, int c)
{
	if (a > b) swap(a, b);
	if (a > c) swap(a, c);
	if (b > c) swap(b, c);
	return a * MAXN * MAXN + b * MAXN + c;
}
void BFS()
{
	memset(f, 0x3f, sizeof(f));
	head = 0, tail = 1;
	que[1] = calc(1, 2, 3);
	f[calc(1, 2, 3)] = 0;
	pre[calc(1, 2, 3)] = -1;
	while (head < tail)
	{
		int x = que[++head];
		if (x == calc(a, b, c)) return ;
		int a = x / MAXN / MAXN, b = (x / MAXN) % MAXN, c = x % MAXN;
		for (int i = 1; i <= n; ++i)
			if (a != i && b != i && c != i)
			{
				if (str[a][i] == str[b][c] && f[calc(i, b, c)] > f[x] + 1)
					f[calc(i, b, c)] = f[x] + 1,
					pre[calc(i, b, c)] = x,
					que[++tail] = calc(i, b, c);
				if (str[b][i] == str[a][c] && f[calc(a, i, c)] > f[x] + 1)
					f[calc(a, i, c)] = f[x] + 1,
					pre[calc(a, i, c)] = x,
					que[++tail] = calc(a, i, c);
				if (str[c][i] == str[a][b] && f[calc(a, b, i)] > f[x] + 1)
					f[calc(a, b, i)] = f[x] + 1,
					pre[calc(a, b, i)] = x,
					que[++tail] = calc(a, b, i);
			}
	}
}
vector<int> L;
void Print(int x)
{
	if (pre[x] == -1) return ;
	int a = x / MAXN / MAXN, b = (x / MAXN) % MAXN, c = x % MAXN;
	int pa = pre[x] / MAXN / MAXN, pb = (pre[x] / MAXN) % MAXN, pc = pre[x] % MAXN;
	L.clear();
	int xr = 0, yr = 0;
	L.pb(a), L.pb(b), L.pb(c), L.pb(pa), L.pb(pb), L.pb(pc);
	sort(L.begin(), L.end());
	L.erase(unique(L.begin(), L.end()), L.end());
	for (int i = 0; i < (int)L.size(); ++i)
	{
		if (L[i] != a && L[i] != b && L[i] != c)
			yr = L[i];
		if (L[i] != pa && L[i] != pb && L[i] != pc)
			xr = L[i];
	}
	printf("%d %d\n", xr, yr);
	Print(pre[x]);
}
int main()
{
#ifndef ONLINE_JUDGE
	freopen("input.txt", "r", stdin), freopen("output.txt", "w", stdout);
#endif
	cin >> n;
	cin >> a >> b >> c;
	for (int i = 1; i <= n; ++i)
		scanf("%s", str[i] + 1);
	BFS();
	if (f[calc(a, b, c)] >= 0x3f3f3f3f)
		puts("-1");
	else
	cout << f[calc(a, b, c)] << endl,
	Print(calc(a, b, c));
	fclose(stdin);
	fclose(stdout);
	return 0;
}

