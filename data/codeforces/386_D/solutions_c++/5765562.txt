/*
 * Author:  raylee
 * Created Time:  2014/1/21 19:21:57
 * File Name: a.cpp
 */
//#pragma comment(linker, "/STACK:102400000,102400000")
#include<cstdio>
#include<iostream>
#include<cstring>
#include<cstdlib>
#include<cmath>
#include<algorithm>
#include<string>
#include<map>
#include<set>
#include<vector>
#include<queue>
#include<stack>
#include<ctime>
#include<climits>
using namespace std;
#define pb push_back
#define vi vector<int>
#define clr( x , y ) memset(x, y, sizeof(x))
typedef long long ll;

struct node{
    int a, b, c, step, fa;
}q[ 75 * 75 * 75 ];

bool vis[ 75 ][ 75 ][ 75 ];
char mat[ 75 ][ 75 ];

void print(int id){
    if(q[ id ].fa == -1) return ;
    int fa = q[ id ].fa;
    print(fa);
    if(q[ id ].a != q[ fa ].a) cout<<q[ fa ].a + 1<<" "<<q[ id ].a + 1<<endl;
    else if(q[ id ].b != q[ fa ].b) cout<<q[ fa ].b + 1<<" "<<q[ id ].b + 1<<endl;
    else if(q[ id ].c != q[ fa ].c) cout<<q[ fa ].c + 1<<" "<<q[ id ].c + 1<<endl;
}

int main(){
    int n, flag = 0, a, b, c, step, ans, key;
    cin>>n>>a>>b>>c; a--; b--; c--;
    for(int i = 0; i < n; i++) cin>>mat[ i ];
    node top, now; top.a = a; top.b = b; top.c = c; top.step = 0; top.fa = -1;
    int head = 0, tail = 0; q[ tail++ ] = top; vis[ a ][ b ][ c ] = 1;
    while(head < tail){
        top = q[ head ];
        a = top.a; b = top.b; c = top.c; step = top.step;
        if(a + b + c == 3){
            flag = 1;
            ans = step;
            key = head;
            break;
        }
        //a 
        for(int i = 0; i < n; i++){
            if(i == a || i == b || i == c) continue;
            if(vis[ i ][ b ][ c ]) continue;
            if(mat[ i ][ a ] != mat[ b ][ c ]) continue;
            now.a = i; now.b = b; now.c = c; now.step = step + 1;
            now.fa = head; vis[ i ][ b ][ c ] = 1; q[ tail++ ] = now;
        }
        //b
        for(int i = 0; i < n; i++){
            if(i == a || i == b || i == c) continue;
            if(vis[ a ][ i ][ c ]) continue;
            if(mat[ i ][ b ] != mat[ a ][ c ]) continue;
            now.a = a; now.b = i; now.c = c; now.step = step + 1;
            now.fa = head; vis[ a ][ i ][ c ] = 1; q[ tail++ ] = now;
        }
        //c
        for(int i = 0; i < n; i++){
            if(i == a || i == b || i == c) continue;
            if(vis[ a ][ b ][ i ]) continue;
            if(mat[ i ][ c ] != mat[ a ][ b ]) continue;
            now.a = a; now.b = b; now.c = i; now.step = step + 1;
            now.fa = head; vis[ a ][ b ][ i ] = 1; q[ tail++ ] = now;
        }
        head++;
    }
    if(!flag){
        cout<<-1<<endl; return 0;
    }
    cout<<ans<<endl;
    print(key);
    return 0;
}
