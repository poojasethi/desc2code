#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

#define n   75
#define INF (1<<30)
#define For(i,a,b)  for(int i=a;i<=b;i++)

int     N,l,r,F[n][n][n];
struct  Nod{
        int x[3];
        void    Rd(){
            For(i,0,2)  scanf("%d",&x[i]);  sort(x,x+3);
            F[x[0]][x[1]][x[2]]=0;
        }
}A[n*n*n],from[n][n][n],G[n][n][n];
char    s[n][n];

void    Upd(int x,int y,int z,int k,int t,int*g){
        int P[3];   P[0]=x;P[1]=y;P[2]=z;   sort(P,P+3);
        if  (k<F[P[0]][P[1]][P[2]]) {
            F[P[0]][P[1]][P[2]]=k;  r++;
            from[P[0]][P[1]][P[2]].x[0]=t;
            from[P[0]][P[1]][P[2]].x[1]=x;
            For(i,0,2)  A[r].x[i]=P[i],G[P[0]][P[1]][P[2]].x[i]=g[i];
        }
}
void    Write(int d,int x,int y,int z){
        if  (!d)    return  ;
        Write(d-1,G[x][y][z].x[0],G[x][y][z].x[1],G[x][y][z].x[2]);
        printf("%d %d\n",from[x][y][z].x[0],from[x][y][z].x[1]);
}

int     main(){
        scanf("%d",&N);
        For(i,1,N)  For(j,1,N)  For(k,1,N)  F[i][j][k]=INF; A[1].Rd();
        For(i,1,N)  scanf("%s",s[i]+1); 

        for (l=0,r=1;l<r;){
            int x=A[++l].x[0],y=A[l].x[1],z=A[l].x[2],k=F[x][y][z]+1;
            For(i,1,N)  if  (i!=x&&i!=y&&i!=z){
                if  (s[z][i]==s[x][y])  Upd(i,x,y,k,z,A[l].x);
                if  (s[x][i]==s[y][z])  Upd(i,y,z,k,x,A[l].x);
                if  (s[y][i]==s[x][z])  Upd(i,x,z,k,y,A[l].x);
            }
        }

        if  (F[1][2][3]==INF)   return  puts("-1");
        printf("%d\n",F[1][2][3]);  Write(F[1][2][3],1,2,3);
}
