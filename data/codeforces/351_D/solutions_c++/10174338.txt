#include <iostream>
#include <cstdio>
#include <cstring>
#include <cmath>
#include <algorithm>
using namespace std;
const int N=100005;
struct sl{
	int l,r,f;
}q[N];
int n,m,z,x,y,last[N],pre[N][3],a[N],b[N],wr[N];
inline bool cmp(sl x,sl y){
	return x.r<y.r;
}
int main(){
	//freopen("cf351D.in","r",stdin);freopen("cf351D.out","w",stdout);
	scanf("%d",&n);
	for (int i=1;i<=n;++i){
		scanf("%d",&x);
		pre[i][0]=last[x];pre[i][1]=i-last[x];
		if (pre[pre[i][0]][0]==0 || pre[i][1]==pre[pre[i][0]][1]) pre[i][2]=pre[pre[i][0]][2];
		else pre[i][2]=pre[i][0];
		last[x]=i;
	}
	scanf("%d",&m);
	for (int i=1;i<=m;++i) scanf("%d%d",&q[i].l,&q[i].r),q[i].f=i;
	sort(q+1,q+m+1,cmp);
	x=1;
	for (int i=1;i<=n;++i){
		for (int j=pre[i][0]+1;j<=i;++j) ++a[j],++b[j];
		for (int j=pre[pre[pre[i][0]][2]][0]+1;j<=pre[pre[i][2]][0];++j) --b[j];
		while (x<=m && q[x].r==i){
			wr[q[x].f]=a[q[x].l]+(b[q[x].l]==0);
			++x;
		}
	}
	for (int i=1;i<=m;++i) printf("%d\n",wr[i]);
}