#include <bits/stdc++.h>
using namespace std;
#define rep(i,a,n) for (int i=a;i<n;i++)
#define per(i,a,n) for (int i=n-1;i>=a;i--)
#define pb push_back
#define mp make_pair
#define all(x) (x).begin(),(x).end()
#define SZ(x) ((int)(x).size())
#define fi first
#define se second
typedef vector<int> VI;
typedef long long ll;
typedef pair<int,int> PII;
const ll mod=1000000007;
ll powmod(ll a,ll b) {ll res=1;a%=mod;for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}
// head

const int N=101000;
int a[N],diff[N],pre[N],go[N],p[N];
int n,m,ans[N],c[N],b[N],l,r;
vector<PII> q[N];
void modify(int *c,int x,int s) { for (;x<=n;x+=x&-x) c[x]+=s;}
int query(int *c,int x) { int s=0; for (;x;x-=x&-x) s+=c[x]; return s;}
int main() {
	scanf("%d",&n);
	rep(i,1,n+1) scanf("%d",a+i);
	scanf("%d",&m);
	rep(i,0,m) {
		scanf("%d%d",&l,&r);
		q[r].pb(mp(l,i));
	}
	rep(i,1,n+1) {
		r=pre[a[i]];
		if (r) modify(b,p[go[r]]+1,-1),modify(b,r+1,1);
		if (r==0) go[i]=i;
		else if (diff[a[i]]==0||i-r==diff[a[i]]) go[i]=go[r];
		else go[i]=r;
		modify(b,p[go[i]]+1,1); modify(b,i+1,-1);
		if (pre[a[i]]!=0) diff[a[i]]=i-pre[a[i]];
		modify(c,pre[a[i]]+1,1);
		modify(c,i+1,-1);
		rep(j,0,SZ(q[i])) {
			l=q[i][j].fi;
			ans[q[i][j].se]+=query(c,l)+!query(b,l);
		}
		p[i]=pre[a[i]];
		pre[a[i]]=i;
	}
	rep(i,0,m) printf("%d\n",ans[i]);
}
