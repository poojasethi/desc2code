#include <iostream>
#include <vector>
#include <map>
#include <cmath>

using namespace std;

int infinito=1000000000;

int n;
int b[100001];
int veces[100001];
int periodo[100001];
int limitele[100001];
int ultima[100001];

int minimo[1000000];
int cuantos[1000000];
int primero=(1<<17);
int tope=(1<<18);


vector<pair<int,int> > queries[100001];
int sol[100001];

void insertar(int pos,int c,int m)
{
  pos+=primero;
  cuantos[pos]=c;
  minimo[pos]=m;
  while (pos>1) {
    pos/=2;
    cuantos[pos]=cuantos[2*pos]+cuantos[2*pos+1];
    minimo[pos]=min(minimo[2*pos],minimo[2*pos+1]);
  }
}

int minimori(int pos)
{
  pos+=primero;
  int m=minimo[pos];
  while (pos>1) {
    if (pos%2==0)
      m=min(m,minimo[pos+1]);
    pos/=2;
  }
  return m;
}

int cuantosri(int pos)
{
  pos+=primero;
  int c=cuantos[pos];
  while (pos>1) {
    if (pos%2==0)
      c+=cuantos[pos+1];
    pos/=2;
  }
  return c;
}

int main()
{
  cin>>n;
  for (int i=1;i<=n;i++)
    cin>>b[i];
  for (int i=0;i<tope;i++)
    minimo[i]=infinito;
  int q;
  cin>>q;
  for (int i=0;i<q;i++) {
    int l,r;
    cin>>l>>r;
    queries[r].push_back(pair<int,int> (l,i));
  }
  for (int i=1;i<=n;i++) {
    int x=b[i];
    if (veces[x]==0) {
    } else if (veces[x]==1) {
      periodo[x]=i-ultima[x];
      insertar(ultima[x],0,infinito);
    } else {
      if (i-ultima[x]!=periodo[x]) {
	limitele[x]=ultima[x]-periodo[x]+1;
	periodo[x]=i-ultima[x];
      }
      insertar(ultima[x],0,infinito);
    }
    veces[x]++;
    ultima[x]=i;
    insertar(ultima[x],1,limitele[x]);
    vector<pair<int,int> > &v=queries[i];
    for (int j=0;j<int(v.size());j++) {
      pair<int,int> &p=v[j];
      int cr=cuantosri(p.first);
      int mr=minimori(p.first);
      if (mr<=p.first)
	sol[p.second]=cr;
      else
	sol[p.second]=cr+1;
    }
  }
  for (int i=0;i<q;i++)
    cout<<sol[i]<<endl;
}
