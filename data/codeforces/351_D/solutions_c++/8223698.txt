#include<cstdio>
#include<vector>
using namespace std;
const int N=100005;
int n,m;
int c[2][N],ans[N];
vector<int> v[N],d[N];
int a[N],lef[N],las[N],P[N];
void Insert(int t,int x,int d)
{
	for(;x;x-=x&-x)
		c[t][x]+=d;
}
int Query(int t,int x)
{
	int ret=0;
	for(;x<=n;x+=x&-x)
		ret+=c[t][x];
	return ret;
}
int main()
{
	int i,j,x,y;
	scanf("%d",&n);
	for(i=1;i<=n;i++)
	{
		scanf("%d",&a[i]);
		lef[i]=las[a[i]];
		las[a[i]]=i;
		if(i-lef[i]==lef[i]-lef[lef[i]])
			P[i]=P[lef[i]];
		else
			P[i]=lef[lef[i]];
	}
	scanf("%d",&m);
	for(i=1;i<=m;i++)
		scanf("%d%d",&x,&y),
		v[y].push_back(x),
		d[y].push_back(i);
	for(i=1;i<=n;i++)
	{
		if(lef[i])
			Insert(0,lef[i],-1),
			Insert(1,P[lef[i]],1),
			Insert(1,lef[i],-1);
		Insert(0,i,1);
		Insert(1,P[i],-1);
		Insert(1,i,1);
		for(j=0;j<v[i].size();j++)
			ans[d[i][j]]=Query(0,v[i][j])+!Query(1,v[i][j]);
	}
	for(i=1;i<=m;i++)
		printf("%d\n",ans[i]);
}