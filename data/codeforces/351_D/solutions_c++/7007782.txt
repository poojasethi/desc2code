#include <stdio.h>
#include <memory.h>
#include <algorithm>
using namespace std;
#define M 100010

int a[M],b[M];
int l[M],r[M],id[M],st[M],en[M],ans[M],p[M];
int n,q;

int cmp(int i,int j) {
	return en[i]<en[j];
}

void Input() {
	int i,j,k;
	scanf("%d",&n);
	for(i=1;i<=n;i++) {
		scanf("%d",&a[i]);
		p[i]=b[a[i]];
		b[a[i]]=i;
	}
	scanf("%d",&q);
	for(i=1;i<=q;i++) scanf("%d %d",&st[i],&en[i]),id[i]=i;
	sort(id+1,id+q+1,cmp);
	for(i=1;i<=q;i++) l[i]=st[id[i]],r[i]=en[id[i]];
}

void insert(int *X,int v,int val) {
	while(v<=n) {
		X[v]+=val;
		v+=v&-v;
	}
}

int calc(int *X,int v) {
	int s=0;
	while(v) {
		s+=X[v];
		v-=v&(-v);
	}
	return s;
}

int X[M],Y[M];

void Solve() {
	int i,st,sa,sb;
	memset(b,0,sizeof(b));
	st=1;
	for(i=1;i<=n;i++){
		insert(X,p[i]+1,1);
		insert(X,i+1,-1);
		if(p[p[i]] && i-p[i]!=p[i]-p[p[i]]) {
			insert(Y,b[a[i]]+1,1);
			b[a[i]]=p[p[i]];
			insert(Y,b[a[i]]+1,-1);
		}

		for(;st<=q && r[st]<i;st++);
		for(;st<=q && r[st]==i;st++) {
			sa=calc(X,l[st]);
			sb=calc(Y,l[st]);
			ans[id[st]]=sa;
			if(sa==sb) ans[id[st]]++;
		}
	}
	for(i=1;i<=q;i++) printf("%d\n",ans[i]);
}

int main() {
//	freopen("204_D.in","r",stdin);
	Input();
	Solve();
	return 0;
}
