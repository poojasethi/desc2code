#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<algorithm>
#include<iostream>
#include<deque>
using namespace std;
const int maxn=100005;
int n,Q,a[maxn],ans[maxn],las[maxn],pre[maxn],pos[maxn];
int X[maxn],Y[maxn];
struct question
{
	int l,r,id;
	inline bool operator<(const question &o)const
	{return r<o.r;}
}q[maxn];

void add(int *t,int x,int c)
{for(;x;x^=x&-x)t[x]+=c;}
int sum(int *t,int x)
{int s=0;for(;x<=n;x+=x&-x)s+=t[x];return s;}

void init()
{
	scanf("%d",&n);
	for(int i=1;i<=n;i++)
	{
		scanf("%d",a+i);
		pre[i]=las[a[i]];
		las[a[i]]=i;
	}
	scanf("%d",&Q);
	for(int i=1;i<=Q;i++)
		scanf("%d%d",&q[i].l,&q[i].r),q[i].id=i;
	sort(q+1,q+Q+1);
}

void work()
{
	for(int k=1,i=1,t1,t2;k<=Q;k++)
	{
		for(;i<=q[k].r;i++)
		{
			add(X,pre[i],-1);
			add(X,i,1);
			if(pre[pre[i]]&&i-pre[i]!=pre[i]-pre[pre[i]])
			{
				add(Y,pos[a[i]],-1);
				add(Y,pos[a[i]]=pre[pre[i]],1);
			}
		}
		t1=sum(X,q[k].l),t2=sum(Y,q[k].l);
		ans[q[k].id]=t1+(t1==t2);
	}
	for(int i=1;i<=Q;i++)
		printf("%d\n",ans[i]);
}

int main()
{
	init();
	work();
	return 0;
}
