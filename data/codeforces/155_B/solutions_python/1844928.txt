n=input()
c1=[]
c2=[]
for _ in range(n):
  a,b=map(int,raw_input().split())
  if b:c1.append((a,b))
  else:c2.append((a,b))
c=1;p=0
c1=sorted(c1,key=lambda x:x[1])
c2.sort()
while c>0:
  if len(c1):k=c1.pop()
  else:
    if len(c2):k=c2.pop()
    else:break
  p+=k[0]
  c+=k[1]-1
print p