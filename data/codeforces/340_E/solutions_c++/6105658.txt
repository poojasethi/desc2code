#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MD 1000000007
#define naga(x) ({((x)%MD+MD)%MD;})

typedef long long ll;

int f[2010][2010];
int n,a[2010],rank[2010],s,t;

void init(){
    f[0][0]=1;
    for(int i=1;i<=s+t;i++)
        f[i][0]=naga((ll)f[i-1][0]*i),f[i][1]=naga((ll)f[i][0]*i);
    for(int i=2;i<=t;i++){
        for(int j=0;j<=s+t;j++){
            f[j][i]=naga(naga((ll)j*f[j][i-1])+naga((ll)(i-1)*f[j+1][i-2]));
        }
    }
}

int main(){
    scanf("%d",&n);
    for(int i=1;i<=n;i++)scanf("%d",&a[i]),a[i]==-1?0:rank[a[i]]=i;
    for(int i=1;i<=n;i++)if(a[i]==-1)rank[i]?s++:t++;
    init();
    printf("%d",f[s][t]);
    return 0;
} 
