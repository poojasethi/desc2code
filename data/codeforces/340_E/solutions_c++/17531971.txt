#include<stdio.h>
#include<cstring>
#define mod 1000000007

__int64 dp[2010];
bool vis[2010];
__int64 a[2010];
int n;
__int64 jiecheng[2010];

int main()
{
    scanf("%d",&n);
    int tx=0;
    int ty=0;
    for(int i=1;i<=n;i++)
    {
        scanf("%I64d",&a[i]);
        if(a[i]!=-1) vis[a[i]]=true;
    }
    jiecheng[0]=1;
    for(int i=1;i<=2005;i++)
        jiecheng[i]=jiecheng[i-1]*i%mod;
    for(int i=1;i<=n;i++)
        if(a[i]==-1)
        {
            if(vis[i]) tx++;
            else ty++;
        }
    dp[0]=1;
    dp[1]=tx*dp[0]%mod;
    for(int i=2;i<=ty;i++)
        dp[i]=(tx*dp[i-1]%mod+(i-1)*dp[i-1]%mod+(i-1)*dp[i-2]%mod)%mod;
    printf("%I64d\n",jiecheng[tx]*dp[ty]%mod);
    return 0;
}
