#include <cstdio>
#include <cstdlib>
#include <ctime>
#include <cstring>
#include <cmath>
#include <algorithm>
#define Mod 1000000007LL
using namespace std;
typedef long long ll;
ll f[3001], dp[3001][3001], a[30001];
ll ans = 0, n;
int l[3001], r[3001];
int main( )
{
	scanf("%I64d", &n);
	f[0] = 1;
	ll tn = n;
	for (ll i = 1; i <= n; i ++)
	{
		scanf("%I64d", &a[i]), f[i] = f[i - 1] * i % Mod;
		if (a[i] == -1) l[i] = 1;
		else r[a[i]] = 1, -- tn;
	}
	for (ll i = 1; i <= n; i ++)
		if (!r[i] && l[i]) ++ ans;
	for (ll i = 0; i <= n; i ++)
		dp[i][i] = f[i];
	for (ll i = 1; i <= n; i ++)
		for (ll j = n; j >= 0; j --)
			if (i != j) dp[i][j] = (dp[i][j + 1] - dp[i - 1][j] + Mod) % Mod;
	printf("%I64d\n", dp[tn][tn - ans]);
	return 0;
}
