#include <bits/stdc++.h>
using namespace std;
#define ll long long
#define mod 1000000007
#define maxn 2001

ll ret[2*maxn][maxn], f[3*maxn/2];
int a[maxn], b[maxn];

int main()
{
	int n, i, k, x, y;
	f[0] = 1;
	for(i = 1; i <= 3*maxn/2; i++)
		f[i] = i*f[i - 1] % mod;
	for(n = 0; n <= 3*maxn/2; n++)
	{
		ret[n][0] = f[n];
		ret[n][1] = n*f[n] % mod;
	}
	for(k = 2; k < maxn; k++)
	for(n = 0; n <= 3*maxn/2; n++)
		ret[n][k] = (n*ret[n][k - 1] % mod + (k - 1)*ret[n + 1][k - 2] % mod) % mod;
	scanf("%d", &n);
	for(i = 1; i <= n; i++)
	{
		scanf("%d", a + i);
		if(a[i] != -1) b[a[i]] = i;
	}
	x = y = 0;
	for(i = 1; i <= n; i++)
		if(b[i] == 0)
		{
			if(a[i] == -1) x++;
			else y++;
		}
	printf("%I64d", ret[y][x]);
	return 0;
}