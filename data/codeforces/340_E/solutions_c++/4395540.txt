#include <iostream>
#include <algorithm>
#include <string>
#include <cstdio>
using namespace std;
typedef __int64 ll;
const int mod=1e9+7;
ll dp[2010][2010];
ll a[2010];
ll b[2010];
int main()
{
  int n;
  cin>>n;
  int s1=0,s2=0;
  for(int i=1;i<=n;i++)
  {
      cin>>a[i];
      if(a[i]==-1)
        b[i]=1,s1++;
  }
  for(int i=1;i<=n;i++)
  {
      if(b[a[i]]==1&&a[i]!=-1)
        s2++;
  }
  //printf("%d %d\n",s1,s2);
  dp[0][0]=1;
  for(int i=1;i<=n;i++)
  {
      dp[i][0]=(dp[i-1][0]*(ll)i)%mod;
  }
  for(int i=1;i<=n;i++)
    for(int j=1;j<=n;j++)
  {
      dp[i][j]=(dp[i][j-1]-dp[i-1][j-1])%mod;
  }
  printf("%I64d\n",(dp[s1][s1-s2]+mod)%mod);
}
