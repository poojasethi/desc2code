#include<stdio.h>
#include<memory.h>
	
typedef __int64 LL;	
const int N=2001,mod=1000000007;
LL f[N],dp[N],a[N];
bool mem[N];
int main(){
	int x,y,n,m,i,j,k;
	scanf("%d",&n);
	for(i=1;i<=n;i++){
		scanf("%I64d",a+i);
		if(x!=-1) mem[a[i]]=1;
	}
	for(f[0]=i=1;i<=n;i++) f[i]=f[i-1]*i%mod;
	for(x=y=0,i=1;i<=n;i++){
		if(!mem[i]&&a[i]==-1) y++;
		else if(!mem[i]&&a[i]!=-1) x++;
	}
	dp[0]=f[x];
	dp[1]=dp[0]*x%mod;
	for(i=2;i<=y;i++)
		dp[i]=(dp[i-1]*x+(dp[i-1]+dp[i-2])*(i-1))%mod;
	printf("%I64d\n",dp[y]);
	return 0;
}	
