#include <cstdio>
#include <cstring>
#include <algorithm>
#include <iostream>

using namespace std;

#define REP(i,n) for(int i=0;i<n;++i)
#define FOR(i,a,b) for(int i=a;i<=b;++i)
#define FORD(i,a,b) for(int i=a;i>=b;--i)

#define LL long long

#define N 2010
#define P 1000000007

int n, m, k;
bool used[N], freed[N];
LL f[N];

int main(){
	scanf("%d",&n);
	
	FOR(i,1,n){
		int a;
		scanf("%d ",&a);
		if(!~a) continue;
		used[a]=freed[i]=true;
	}
	
	FOR(i,1,n) if(!used[i])
		if(freed[i]) ++m; else ++k;
	
	
	f[0]=1;
	FOR(i,1,m) (f[0]*=i)%=P;
	
	f[1]=f[0]*m%P;
	
	FOR(i,2,k)
		f[i]=(m*f[i-1]+(i-1)*(f[i-1]+f[i-2]))%P;
	
	printf("%d\n",f[k]);
	
	return 0;
}
