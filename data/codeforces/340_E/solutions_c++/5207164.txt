#include<stdio.h>
#include<string.h>
#define M 1000000007
int a[2000];
long long dp[2001][2001];
bool free[2000];

int main(){
    int n,i,j;
    scanf("%d",&n);
    for(i=0;i<n;i++){
        scanf("%d",&a[i]);
        free[i]=(a[i]!=-1);
    }
    for(i=0;i<n;i++)if(a[i]!=-1)free[a[i]-1]=false;
    int f=0,p=0;
    for(i=0;i<n;i++){
        if(free[i])f++;
        if(a[i]==-1)p++;
    }
    memset(dp,0,sizeof(dp));
    dp[1][1]=1;
    for(i=2;i<=n;i++)dp[i][i]=dp[i-1][i-1]*i%M;
    for(i=p-1;i>=f;i--){
        for(j=i+1;j<=p;j++)dp[i][j]=(i*dp[i][j-1]+(j-i-1)*dp[i+1][j-1])%M;
    }
    printf("%I64d\n",dp[f][p]);
    return 0;
}