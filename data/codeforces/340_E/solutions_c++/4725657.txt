#include <iostream>
#include <vector>
#define M 1000000007
#define llong long long
using namespace std;
int d[2001];
int e[2001];
int f[2001][2001];
int dp (int p, int q) {
	if (f[p][q] > 0)
		return f[p][q];
	if (q == 0) {
		f[p][q] = (llong)p * dp (p-1, 0) % M;
	} else if (q == 1) {
		f[p][q] = (llong)p * dp (p, 0) % M;
	} else {
		f[p][q] = ((llong)p * dp (p, q - 1) % M + (llong)(q - 1) * dp (p + 1, q - 2) %M) % M;
	}
	return f[p][q];
}

int main () {
	int n, p = 0, q = 0;
	int i;
	cin >> n;
	for (i = 1; i <= n; ++i) {
		cin >> d[i];
		e[d[i]] = 1;
	}
	for (i = 1; i <= n; ++i) {
		if (e[i] == 0) {
			if (d[i] == -1)
				++q;
			else
				++p;
		}
	}
	f[0][0] = 1;
	cout << dp(p, q) << endl;
	return 0;
}

