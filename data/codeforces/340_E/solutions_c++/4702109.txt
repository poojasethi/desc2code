#include<cstdio>
#include<algorithm>
using namespace std;
long long mo = 1e9+7;
int a[2001],b[2001],n,x,y;
long long dp[20001];
int main(){
    scanf("%d",&n);
    for(int i=1;i<=n;i++){
        scanf("%d",&a[i]);
        if(a[i] != -1)
            b[a[i]] = 1;
    }
    for(int i=1;i<=n;i++)
        if(a[i] == -1){
            if(b[i] == 1) x++; 
            else y++;
        }
    dp[0] = 1ll; 
    for(int i=1;i<=x;i++)
        dp[0] = (dp[0]*i)%mo;
    dp[1] = (long long)x*dp[0]; dp[1] %= mo;
    for(int i=2;i<=y;i++)
        dp[i] = ((long long)(x+i-1)*dp[i-1] + (long long)(i-1)*dp[i-2])%mo;
    printf("%I64d\n",dp[y]);
    return 0;
}