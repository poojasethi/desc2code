//gskhirtladze

#include<iostream>
#include<stdio.h>
#include<algorithm>
#include<vector>
#include<math.h>
#include<map>

#define LL long long
#define R return
#define S system("pause")
#define P 1000000007

using namespace std;

LL i,j,n,x,y;
LL DP[3000][3000];
LL a[3000];

main()
 {
  DP[1][0]=1;
  for (i=2;i<=2000;i++)
   {
    for (j=0;j<i;j++)
     DP[i][j]=(((i-j)*DP[i-1][j])%P+(j*DP[i-1][j-1])%P)%P;
    DP[i][j]=((i-1)*DP[i-1][j-2])%P;
   }
  
  cin>>n;
  for (i=1;i<=n;i++)
   cin>>a[i];
  
  for (j=1;j<=n;j++)
   if (a[j] == -1) 
    {
     x++;
     y++;
     for (i=1;i<=n;i++)
      if (a[i] == j) y--;
    }
  
  cout<<DP[x][y]<<endl;
  
 }
