#include<stdio.h>
long long dp[2001][2001];
int a[2001];
int main()
{
    dp[0][0]=1;
    for(int i=1;i<=2000;i++)
    {
        dp[i][0]=(dp[i-1][0]*i)%1000000007;
        for(int j=1;j<=i;j++) dp[i][j]=((i-j)*dp[i-1][j-1]+(j-1)*dp[i-1][j-2])%1000000007;
    }
    
    int n;
    scanf("%d",&n);
    for(int i=0;i<n;i++)
        scanf("%d",&a[i]);
        
    int c1,c2;
    c1=c2=0;
    for(int i=0;i<n;i++)
    {
        c1+=(a[i]==-1);
        c2+=(a[i]!=-1 && a[a[i]-1]==-1);
    }
    c2=c1-c2;
    
    printf("%lld\n",dp[c1][c2]);
    
    return 0;
}
