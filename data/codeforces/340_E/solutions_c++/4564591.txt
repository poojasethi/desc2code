#include <cstdio>
#define P 1000000007
using namespace std;

int N,a[2005],f[2005][2005];
bool b[2005];

void doit()
{
	scanf("%d",&N);
	for (int i=1; i<=N; i++)
	{
		scanf("%d",&a[i]);
		if (a[i]>0) b[a[i]]=1;
	}
	int x=0,y=0;
	for (int i=1; i<=N; i++) if (a[i]==-1) if (!b[i]) x++; else y++;
	f[0][0]=1;
	for (int i=1; i<=N; i++)
	{
		f[i][0]=1ll*f[i-1][0]*i%P,f[i+1][1]=1ll*f[i][0]*i%P;
		for (int j=2; j<=i; j++) f[i][j]=(1ll*f[i-1][j-1]*(i-j)+1ll*f[i-1][j-2]*(j-1))%P;
	}
	printf("%d\n",f[x+y][x]);
}

int main()
{
	doit();
	return 0;
}
