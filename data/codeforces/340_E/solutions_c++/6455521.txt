#include<stdio.h>
#include<string.h>
#define siz 2010
#define mod 1000000007
int tmp[2][siz], n, k=0;
int keep[siz], ch[siz];
int main(){
    memset(keep,0,sizeof(keep));
    memset(ch,0,sizeof(ch));
    memset(tmp,0,sizeof(tmp));
    int i, j, co=0;
    scanf("%d", &n);
    for(i=1; i<=n; i++){
        scanf("%d", &j);
        if(j==-1){keep[i]=1;co++;}
        else ch[j]=1;
    }
    for(i=1; i<=n; i++){
        if(keep[i]&&!ch[i])k++;
    }
    n=co;
    tmp[1][0]=1;
    for(i=2; i<=n; i++){
        int ii=i%2, jj=(ii+1)%2;
        tmp[ii][0]=(tmp[jj][0]*(long long)i)%mod;
        for(j=1; j<=i&&j<=k; j++){
            tmp[ii][j]=(tmp[ii][j-1]-tmp[jj][j-1]+mod)%mod;
        }
    }
    printf("%d", tmp[(n%2)][k]);
    return 0;
}

 	 			 	   			 			 	 		 		