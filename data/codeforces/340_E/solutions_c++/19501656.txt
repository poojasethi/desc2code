#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;

const int N = 2010;
int n, a[N], f[N], dp[N][N];
bool use[N];

int main(int argc, char **argv) {
#ifndef ONLINE_JUDGE
	freopen("a.in", "r", stdin);
#endif
	f[0] = 1;
	for(int i=1 ; i<N ; ++i)
		f[i] = 1LL * i * f[i-1] % mod;
	for(int i=N-1 ; i>=0 ; --i) {
		dp[i][0] = f[i];
		for(int j=1 ; i+j<N ; ++j)
			dp[i][j] = (1LL * i * dp[i][j-1] + 1LL * (j-1) * dp[i+1][j-2])%mod;
	}

	scanf("%d", &n);
	for(int i=1 ; i<=n ; ++i) {
		scanf("%d", &a[i]);
		if(a[i] != -1) use[a[i]] = true;
	}
	int C=0, K=0;
	for(int i=1 ; i<=n ; ++i)
		if(a[i] == -1)
			use[i] ? ++C : ++K;
	cout << dp[C][K] << endl;
	return 0;
}
