M=10**9+7
n=input()
a=[0]*n
l=map(int,raw_input().split())
for v in l:a[v-1]|=v>0
z=[0,0]
for x,y in zip(a,l):z[x]+=y<0
n,m=z
a=0;b=1
for i in range(m):b=b*-~i%M
for i in range(n):a,b=b,(a*i+b*(i+m))%M
print b
