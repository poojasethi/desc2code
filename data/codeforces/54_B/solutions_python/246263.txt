#!/usr/bin/python
import sys

def rotate90 (t):
	res = []
	x = len (t)
	y = len (t[0])
	for i in range (y)[::-1]:
		temp = []
		for j in range (x):
			temp += [t[j][i]]
		res += [temp]
	return res

def canonical (t):
	x = len (t)
	y = len (t[0])
	res = t
	t = rotate90 (t)
	if x == y:
		res = min (res, t)
	t = rotate90 (t)
	res = min (res, t)
	if x == y:
		t = rotate90 (t)
		res = min (res, t)
	return res

def check (x, y):
	global a, b, c
	s = []
	for i in range (a / x):
		for j in range (b / y):
			t = []
			for u in range (x):
				t += [c[i * x + u][j * y:(j + 1) * y]]
			t = canonical (t)
			for k in range (len (s)):
				if t == s[k]:
					return False
			s += [t]
	return True

a, b = [int (x) for x in sys.stdin.readline ().split ()]
c = []
for i in range (a):
	c += [[d for d in sys.stdin.readline ().strip ()]]
#print c
#print rotate90 (c)
ans, ansx, ansy = 0, a + 1, b + 1
for x in range (1, a + 1):
	if a % x == 0:
		for y in range (1, b + 1):
			if b % y == 0:
				if check (x, y):
					ans += 1
					if ansx * ansy > x * y or \
					 ansx * ansy == x * y and ansx > x:
						ansx, ansy = x, y
#					print x, y
print ans
print ansx, ansy
