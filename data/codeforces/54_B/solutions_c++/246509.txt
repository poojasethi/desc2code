#include <iostream>
#include <stdio.h>
#include <cmath>
#include <string>
#include <cstring>
#include <vector>
#include <algorithm>
#include <set>
#include <queue>
#include <stdio.h>

using namespace std;

int m,n,ot = 0, minix = 100000,miniy = 100000;
char a[100][100];

bool check(int i,int j)
{
	set<string> b;
	string s;
	for(int x = 1; x <= n; x+=i)
		for(int y = 1; y <= m; y+=j)
			{
				s = "";
				for(int ii = y; ii < y+j; ++ ii)
				{
					for(int jj = x+i-1; jj >= x; -- jj)
						s += a[jj][ii];
				}		
				if(b.find(s)!=b.end()) return false;
				reverse(s.begin(),s.end());
				if(b.find(s)!=b.end()) return false;

				if(i!=j) { b.insert(s); continue; }

				s = "";
				for(int ii = x; ii < x+i; ++ ii)
				{      	
					for(int jj = y; jj < y+j; ++ jj)
						s += a[ii][jj];
				}		
				if(b.find(s)!=b.end())
					return false;
				reverse(s.begin(),s.end());
				if(b.find(s)!=b.end())
					return false;

				b.insert(s);
			}

	return true;
}

int main()
{

//	freopen("input.txt","r",stdin);
//	freopen("output.txt","w",stdout);

    cin >> n >> m;

    for(int i = 1; i <= n; ++ i)
    	for(int j = 1; j <= m; ++ j)
    		cin >> a[i][j];

    for(int i = 1; i <= n; ++ i)
    	for(int j = 1; j <= m; ++ j)
    		if(n%i==0 && m%j==0 && check(i,j))
    		{
   				++ ot;
   				if(minix*miniy > i*j || (minix*miniy == i*j && minix > i))
   				{
   					minix = i;
   					miniy = j;
   				}
    		}
	
	cout << ot << "\n" << minix << ' ' << miniy;

	return 0;
}
