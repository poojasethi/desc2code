#include <iostream>
using namespace std;

char p[20][21];
int h, w, x, y;

bool diff(int i1, int j1, int i2, int j2) {
	int i, j, d = 0;
	
	for (i = 0; i < x; i++) for (j = 0; j < y; j++) if (p[i1 * x + i][j1 * y + j] != p[i2 * x + i][j2 * y + j]) {d++; i = x; break;}
	for (i = 0; i < x; i++) for (j = 0; j < y; j++) if (p[i1 * x + i][j1 * y + j] != p[(i2 + 1) * x - i - 1][(j2 + 1) * y - j - 1]) {d++; i = x; break;}
//		cout << ' ' << x << ' ' << y << ' ' << i1 << ' ' << j1 << ' ' << i2 << ' ' << j2 << ' ' << d << '\n';
	if (x == y) {
		for (i = 0; i < x; i++) for (j = 0; j < y; j++) if (p[i1 * x + i][j1 * y + j] != p[i2 * x + j][(j2 + 1) * y - i - 1]) {d++; i = x; break;}
		for (i = 0; i < x; i++) for (j = 0; j < y; j++) if (p[i1 * x + i][j1 * y + j] != p[(i2 + 1) * x - j - 1][j2 * y + i]) {d++; i = x; break;}
//		cout << x << ' ' << y << ' ' << i1 << ' ' << j1 << ' ' << i2 << ' ' << j2 << ' ' << d << '\n';
		return d == 4;
	}
//	cout << x << ' ' << y << ' ' << i1 << ' ' << j1 << ' ' << i2 << ' ' << j2 << ' ' << d << '\n';
	return d == 2;
}

int main() {
	int i, j, k, l, nr = 0, xr = 20, yr = 21;
	
	cin >> h >> w;
	for (i = 0; i < h; i++) cin >> p[i];
	
	for (x = 1; x <= h; x++) if (!(h % x)) for (y = 1; y <= w; y++) if (!(w % y)) {
		for (i = 0; i < h / x; i++) for (j = 0; j < w / y; j++) {
			for (k = 0; k < h / x; k++) for (l = 0; l < w / y; l++) if (k - i | l -j) {
				if (!diff(i, j, k, l)) goto southpark;
			}
		}
		nr++;
		if (x * y < xr * yr || x * y == xr * yr && x < xr) xr = x, yr = y;
southpark:;
	}
	
	cout << nr << '\n' << xr << ' ' << yr << '\n';
	
	return 0;
}
