#include <bits/stdc++.h>
#define f(i,x,y) for (int i = x; i < y; i++)
#define fd(i,x,y) for(int i = x; i>= y; i--)
#define FOR(it,A) for(typeof A.begin() it = A.begin(); it!=A.end(); it++)
#define all(v) (v).begin(), (v).end()
#define rall(v) (v).rbegin(), (v).rend()
#define vint vector<int>
#define ll long long
#define clr(A,x) memset(A, x, sizeof A)
#define pb push_back
#define pii pair<int,int>
#define fst first
#define snd second
#define ones(x) __builtin_popcount(x)
#define cua(x) (x)*(x)
using namespace std;

int n,m;
char cad[30][30];
char a[4][30][30], b[30][30];
int x,y;

char lista[400][30][30];

bool iguales (char A[30][30], char B[30][30]){
	f(i,0,x)f(j,0,y) if (A[i][j] != B[i][j]) return 0;
	return 1;
}
bool ok(){
	f(t,1,4){
		swap(x,y);
		f(i,0,x)f(j,0,y) a[t][i][j] = a[t-1][j][x-1-i];
	}
	swap(x,y);

	if ( iguales (a[0], b) ) return 1;
	if (x==y and iguales (a[1],b)) return 1;
	if ( iguales (a[2], b) ) return 1;
	if (x==y and iguales (a[3],b)) return 1;
	return 0;
}

bool esmejor (int r, int s, int t, int w){
	if (r*s != t*w) return r*s < t*w;
	return r < t;
}

int main(){
	cin >> n >> m;
	f(i,0,n)f(j,0,m) cin >> cad[i][j];
	int cnt = 0;
	int _x,_y;

	for (x = 1; x<=n; x++)if(n%x==0) for (y=1; y<=m; y++)if (m%y==0){
		int sz = 0;
		for (int i = 0; i<n; i+=x) for (int j = 0; j<m; j+=y){
			f(ii,0,x)f(jj,0,y) lista[sz][ii][jj] = cad[i+ii][j+jj];
			sz++;
		}
		bool hay_iguales = 0;
		f(i,0,sz)f(j,i+1,sz){
			f(ii,0,x)f(jj,0,y) a[0][ii][jj] = lista[i][ii][jj],
										b[ii][jj]  = lista[j][ii][jj];
			if (ok()) hay_iguales = 1;
		}
		if (hay_iguales==0){
			cnt++;
			if (cnt==1 || esmejor (x,y, _x,_y)) _x = x, _y = y;
		}
	}
	cout << cnt << endl;
	cout << _x << " "<< _y << endl;
}

