#include <cstdio>
#include <map>
#include <string>
#include <vector>
#include <algorithm>
using namespace std;

#define REP(i,n) for(int (i)=0,_n=(n);(i)<_n;(i)++)
#define FOR(i,a,b) for(int (i)=(a),_n=(b);(i)<=_n;(i)++)
#define FORD(i,a,b) for(int (i)=(a),_n=(b);(i)>=_n;(i)--)
#define FOREACH(it,arr) for (__typeof((arr).begin()) it=(arr).begin(); it!=(arr).end(); it++)


int main()
{
    int  a, b;
    char arr[25][25];
    scanf( "%d %d", &a, &b );
    REP(i,a) scanf( "%s", arr[i] );
    int ans = 0, x = a, y = b;
    FOR(i,1,a) if ( a % i == 0 ) {
        FOR(j,1,b) if ( b % j == 0 ) {
            bool okay = true;       
            map <string,bool> m;
            REP(r,a) REP(c,b) if ( r % i == 0 && c % j == 0 ) {
                string s1; FOR(u,r,r+i-1)  { FOR(v,c,c+j-1)  s1 += arr[u][v]; s1 += "."; }
                string s2; FORD(v,c+j-1,c) { FOR(u,r,r+i-1)  s2 += arr[u][v]; s2 += "."; }
                string s3; FORD(u,r+i-1,r) { FORD(v,c+j-1,c) s3 += arr[u][v]; s3 += "."; }
                string s4; FOR(v,c,c+j-1)  { FORD(u,r+i-1,r) s4 += arr[u][v]; s4 += "."; }
                if ( m[s1] || m[s2] || m[s3] || m[s4] ) { okay = false; break; }
                m[s1] = m[s2] = m[s3] = m[s4] = true;
            }
            if ( okay ) {
                ans++;
                if ( i * j < x * y ) x = i, y = j;
                else if ( i * j == x * y && i < x ) x = i, y = j;
            }
        }
    }

    printf( "%d\n", ans );
    printf( "%d %d\n", x, y );
    return 0;
}
