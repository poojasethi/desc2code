    #include <iostream>
    #include <string>
    #include <set>  
    #include <algorithm>
    #include <vector>
    #include <cmath>
    #include <queue>
    #include <cstring>
    #include <cstdio>
    #include <map>
using namespace std;
vector<string>ans;
string g[22];
string mina(int x1,int y1,int x2,int y2)
{
	int xx=x2-x1,yy=y2-y1;
	string res="",buff[4]={"","","",""};
	for(int i=0;i<xx;i++)
		for(int j=0;j<yy;j++)
			buff[0]+=g[x1+i][y1+j];
	for(int i=0;i<xx;i++)
		for(int j=0;j<yy;j++)
			buff[1]+=g[x2-i-1][y2-j-1];
	res=min(buff[0],buff[1]);
	if(xx==yy)
	{
		for(int i=0;i<yy;i++)
			for(int j=0;j<xx;j++)
				buff[2]+=g[x1+j][y2-i-1];
		for(int i=0;i<xx;i++)
			for(int j=0;j<yy;j++)
				buff[3]+=g[x2-j-1][y1+i];
		res=min(res,min(buff[2],buff[3]));
	}
	return res;
}
int main()
{
	int n,m,cnt=0,mn_x=23,mn_y=23;
	cin>>n>>m;
	for(int i=0;i<n;i++)cin>>g[i];
	for(int i=1;i<=n;i++)
		if(n%i==0)
			for(int j=1;j<=m;j++)
				if(m%j==0)
				{
					ans.clear();
					bool flag=0;
					for(int ii=0;ii<n/i;ii++)
						for(int jj=0;jj<m/j;jj++)
							ans.push_back(mina(i*ii,j*jj,i*ii+i,j*jj+j));
					sort(ans.begin(),ans.end());
					for(int k=0;k<ans.size()-1;k++)
					{
						if(ans[k]==ans[k+1])flag=1;
					}
					if(!flag){
						cnt++;
						if(i*j<mn_x*mn_y)mn_x=i,mn_y=j;}
				}
	cout<<cnt<<endl;
	cout<<mn_x<<" "<<mn_y;
	return 0;
}
