#include <iostream>
#include <vector>
#include <set>
#include <cstdlib>
#include <cstdio>
#include <algorithm>
using namespace std;
set<vector<string> > S;
vector<string> v,s;

vector<string> rot(vector<string> a)
{
	int n = a.size();
	int m = a[0].length();
	
	vector<string> b;
	b.resize(m);
	for (int i = 0; i < m; i++) b[i].resize(n);
	
	for (int i = 0; i < n; i++)
	for (int j = 0; j < m; j++)
		b[j][n-i-1] = a[i][j];
	return b;
}

int main()
{
	#ifndef ONLINE_JUDGE
		freopen("input.txt","r",stdin);
		freopen("output.txt","w",stdout);
	#endif
		
	int n,m;
	
	cin>>n>>m;
	s.resize(n);
	for (int i = 0; i < n; i++)
		cin>>s[i];

	
	int xx = n , yy = m,cnt = 0;
	
	for (int x = 1; x <= n; ++x)
	if (n%x == 0)
	for (int y = 1; y <= m; ++y)
	if (m%y == 0) {
	
		S.clear();
		bool good = true;
		for (int i = 0; i < n && good; i+=x)
		for (int j = 0; j < m && good; j+=y) {
				
				v.clear();
				v.resize(x);
				for (int ii = i; ii < i+x; ++ii)
				for (int jj = j; jj < j+y; ++jj)
					v[ii-i] += s[ii][jj];
					
				if (S.find(v) != S.end()) good = false; else
				if (S.find(rot(v)) != S.end()) good = false; else
				if (S.find(rot(rot(v))) != S.end()) good = false; else
				if (S.find(rot(rot(rot(v)))) != S.end()) good = false;
				
				S.insert(v);
		}
		if (!good) continue;
		cnt++;
		if ( xx*yy > x*y || (xx*yy == x*y && xx > x)) xx = x, yy = y;
	}
	cout<<cnt<<endl<<xx<< " "<<yy<<endl;
}
