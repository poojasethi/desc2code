#include <cstdio>
#include <cstring>
#include <cmath>
#include <cstdlib>

#include <iostream>
#include <algorithm>
#include <utility>
#include <vector>

using namespace std;

#define REP(i,n) for (int i = 0; i < (int)n; i++)
#define REPE(i,c) for (typeof((c).end()) i = (c).begin(); i != (c).end(); ++i)
#define RESET(c,v) memset(c, v, sizeof(c))
#define ALL(c) (c).begin(), (c).end()

#define pb push_back
#define mp make_pair
#define TRACE(x...) x
#define PRINT(x...) TRACE(printf(x))
#define WATCH(x) TRACE(cout << #x" = " << x << endl)

int A, B;
char ar[100][100];

typedef vector<string> puzz;

puzz rot(puzz o)
{
	int x = o.size(), y = o[0].size();
	puzz r(y);
	REP(i, y) REP(j, x) r[i] += " ";
	REP(i, x) REP(j, y)
		r[j][x-i-1] = o[i][j];
	return r;
}

bool good(int x, int y)
{
	vector<puzz> p;
	for (int i = 0; i < A; i += x)
	for (int j = 0; j < B; j += y)
	{
		puzz c(x);
		for (int k = 0; k < x; k++)
		for (int l = 0; l < y; l++)
			c[k] += ar[i+k][j+l];
		
		REP(o, p.size())
		{
			REP(e, 4)
			{
				if (p[o] == c)
					return false;
				c = rot(c);
			}
		}
		p.pb(c);
	}
	return true;
}

int main()
{
	scanf("%d%d", &A, &B);
	REP(i, A) scanf("%s", ar[i]);
	
	int res = 0;
	int ax = 9999, ay = 9999;
	for (int X = 1; X <= A; X++)
	for (int Y = 1; Y <= B; Y++)
		if (A%X == 0 && B%Y == 0 && good(X, Y))
		{
			res++;
			if (mp(X*Y, X) < mp(ax*ay, ax))
				ax=X, ay=Y;
		}
	printf("%d\n%d %d\n", res, ax, ay);
}
