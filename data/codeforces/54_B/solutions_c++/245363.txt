#include <iostream>
#include <string>
#include <vector>
#include <set>

using namespace std;

int A,B;
vector<string> P;

vector<string> rotate( vector<string> s )
{
	vector<string> r( s[0].size(), string(s.size(),' ') );
	for ( int x=0; x<s[0].size(); x++ )
	for ( int y=0; y<s.size(); y++ )
		r[x][s.size()-1-y] = s[y][x];
	return r;
}

bool check( int X, int Y )
{
	if ( A % X > 0  ||  B % Y > 0 )
		return false;

	set<vector<string> > Q;

	for ( int i=0; i+X<=A; i+=X )
	for ( int j=0; j+Y<=B; j+=Y )
	{
		vector<string> t;
		for ( int k=i; k<i+X; k++ )
			t.push_back( P[k].substr( j, Y ) );

		for ( int k=0; k<4; k++ )
		{
			if ( Q.count( t ) )
				return false;
			t = rotate(t);
		}
		Q.insert( t );
	}
	
	return true;
}


int main()
{
	cin >> A >> B;
	P = vector<string>( A );
	for ( int y=0; y<A; y++ )
		cin >> P[y];

	/*
	for ( int i=0; i<4; i++ )
	{
		for ( int j=0; j<P.size(); j++ )
			cout << P[j] << endl;
		P = rotate(P);
	}
	*/

	int ansXY = 100000000;
	int ansX = 100000000;
	int ansY = 100000000;

	int c = 0;
	for ( int X=1; X<=A; X++ )
	for ( int Y=1; Y<=B; Y++ )
		if ( check(X,Y) )
		{
			// cout << X << "," << Y << endl,
			c++;
			if ( X*Y < ansXY  ||
				 X*Y == ansXY && X<ansX )
				ansXY = X*Y, ansX = X, ansY=Y;
		}
	
	cout << c << endl;
	cout << ansX << " " << ansY << endl;
}

