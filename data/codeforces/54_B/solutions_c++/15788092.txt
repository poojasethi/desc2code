#include<algorithm>
#include<iostream>
#include<fstream>
#include<cstring>
#include<string>
#include<cstdio>
#include<vector>
#include<queue>
#include<cmath>
#include<map>
#include<set>
#define ll long long
using namespace std;
int n,m,mn,a,b,fin;char c[25][25];
string move(int x1,int y1,int x2,int y2)
{
	int x=abs(x2-x1+1),y=abs(y2-y1+1);
	string ans="",t="";
	for(int i=1;i<=x;i++)
	for(int j=1;j<=y;j++)
	t+=c[x1+i-1][y1+j-1];
	ans=t;
	t="";
	for(int i=1;i<=x;i++)
	for(int j=1;j<=y;j++)
	t+=c[x2-i+1][y2-j+1];
	ans=min(ans,t);
	if(x==y)
	{
		t="";
		for(int i=1;i<=x;i++)
		for(int j=1;j<=y;j++)
		t+=c[x1+j-1][y2-(i-1)];
		ans=min(ans,t);
		t="";
		for(int i=1;i<=x;i++)
		for(int j=1;j<=y;j++)
		t+=c[x2-(j-1)][y1+i-1];
		ans=min(ans,t);
	}
	return ans;
}
int main()
{
	cin>>n>>m;
	for(int i=1;i<=n;i++)
	for(int j=1;j<=m;j++)
	cin>>c[i][j];
	for(int i=1;i<=n;i++)
	if(n%i==0)
	for(int j=1;j<=m;j++)
	if(m%j==0)
	{
		int can=1;
		map<string,int> p;
		for(int i2=i;i2<=n && can==1;i2+=i)
		for(int j2=j;j2<=m && can==1;j2+=j)
		{
			string ls=move(i2-i+1,j2-j+1,i2,j2);
			if(p[ls]==1)can=0;
			p[ls]=1;
		}
		if(can==1)
		{
			fin++;
			if((a==0 && b==0) || a*b>i*j){a=i;b=j;}
		}
	}
	cout<<fin<<endl<<a<<" "<<b<<endl;
	return 0;
}
