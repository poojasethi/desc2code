#include <cstdio>
#include <algorithm>
#include <cmath>
#include <queue>
#include <iostream>
#include <memory.h>
#include <vector>
#include <utility>
#include <string>
#include <string.h>
#include <set>
#include <map>
using namespace std;

#define pb push_back
#define mp make_pair
#define sz(a) int((a).size())
#define forn(i, n) for (int i=0; i<(n); ++i)

typedef long long ll;
typedef long double ld;
typedef pair<int,int> pii;
typedef vector<string> vs;


string a[32];
int n, m;
vector<vs> b;
vs c;

bool eq(vs& a, vs b)
{
  int n = sz(a), m = sz(a[0]);
  c = b;
  if (n == m)
  {
    forn (q, 4)
    {
      if (a == b) return true;
      forn (i, n) forn (j, m)
        c[m-j-1][i] = b[i][j];
          b = c;
    }
    return false;
  }
  else
  {
    forn (q, 2)
    {
      if (a == b) return true;
      forn (i, n/2) swap(b[i], b[n-i-1]);
      forn (i, n) reverse(b[i].begin(), b[i].end());
    }
  }
  return false;
}

bool check()
{
  forn (i, sz(b)) forn (j, i) if (eq(b[i], b[j])) return false;   
  return true;
}


int main()
{
 // freopen("a.in", "r", stdin);
  cin >> n >> m;
  forn (i, n) cin >> a[i];
  int res = 0, x = 100, y = 100;
  for (int i=1; i<=n; ++i) if (n%i==0)
    for (int j=1; j<=m; ++j) if (m%j==0)
    {
      b.clear();
      for (int ii=0; ii<n; ii+=i)  for (int jj=0; jj<m; jj+=j)
        {
           vs X;
           forn (k, i) X.pb(a[ii+k].substr(jj, j));
           b.pb(X);                         
        }          
          if (check())
           {
             ++res;
             if (x*y > i*j || (x*y==i*j && x > i))
               x = i, y = j;
           }  
    }

  printf("%d\n", res);
  printf("%d %d\n", x, y);


  return 0;
}