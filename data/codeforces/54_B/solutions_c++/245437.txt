#include<iostream>
#include<vector>
#include<string>
using namespace std;
int n,m;
vector<string> v;
vector<string> p90(vector<string> g)
{
	vector<string>  s;
	int x = (int)g.size();
	int y = g[0].length();
	s.resize(y);
	for(int i = 0; i < y; i++)
	{
		s[i] = "";
		for(int j = x - 1; j >= 0; j--)
			s[i] += g[j][i];
	}
	return s;
			
}
bool check(int x, int y)
{
	vector< vector<string> > g(n / x * m / y,vector<string>(x));
	for(int i = 0; i < n; i += x)
		for(int j = 0; j < m; j += y)
		{
			for(int k = 0; k < x; k++)
				g[(i / x) * (m / y) + j / y][k] = v[i + k].substr(j,y);
		}
	int s = n / x * m / y;
	for(int i = 0; i < s - 1; i++)
		for(int j = i + 1; j < s; j++)
		{
			for(int a = 0; a < 4; a++)
			{
				g[i] = p90(g[i]);
				for(int b = 0; b < 4; b++)
				{
					g[j] = p90(g[j]);
					if (g[i] == g[j])
						return false;
				}
			}
		}
	return true;
}
int main()
{
//	freopen("input.txt","r",stdin);
//	freopen("output.txt","w",stdout);
	int a = 1000,b = 1000,kol = 0;
	cin>>n>>m;
	v.resize(n);
	for(int i = 0; i < n; i++)
		cin>>v[i];
	for(int i = 1; i <= n; i++)
		for(int j = 1; j <= m; j++)
			if (n % i == 0 && m % j == 0 && check(i,j))
			{
				if (a * b > i * j || (a * b == i * j && a > i))
				{
					a = i;
					b = j;
				}
				kol++;
			}
	cout<<kol<<endl<<a<<" "<<b<<endl;
	return 0;
}
