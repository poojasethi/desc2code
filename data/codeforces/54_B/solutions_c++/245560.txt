#include <map>
#include <cmath>
#include <stack>
#include <queue>
#include <string>
#include <vector>
#include <fstream>
#include <sstream>
#include <stdio.h>
#include <iostream>
#include <algorithm>
using namespace std;
#define li		long long
#define rep(i,to)	for(li i=0;i<(li)to;i++)
#define pb(a)		push_back(a)
#define sz(v)		((li)v.size())
int main(){
	int n,m,res=0,x=100,y=100;
	cin>>n>>m;
	vector<string> vec(n);
	rep(i,n){
		string str;
		cin>>str;
		vec[i]=str;
	}
	for(int i=1;i<=n;i++)if(n%i==0)for(int j=1;j<=m;j++)if(m%j==0){
		map<vector<string>,int> mp;
		int a=0;
		for(;a<n/i;a++){
			int b=0;
			for(;b<m/j;b++){
				map<vector<string>,int> tmp;
				vector<string> v;
				for(int c=0;c<i;c++)	v.pb(vec[a*i+c].substr(b*j,j));
				tmp[v]=1;
				vector<string> t(i,string(j,' '));
				rep(c,i)rep(d,j)	t[c][d]=v[i-c-1][j-d-1];
				tmp[t]=1;
				if(i==j){
					vector<string> hoge(i,string(j,' ')),var(i,string(j,' '));
					rep(c,i)rep(d,j){
						hoge[c][d]=v[d][i-c-1];
						var[c][d]=t[d][i-c-1];
					}
					tmp[hoge]=1;
					tmp[hoge]=1;
				}
				map<vector<string>,int>::iterator it=tmp.begin();
				for(;it!=tmp.end();it++){
//					rep(stage,sz((*it).first))cout<<(*it).first[stage]<<endl;
					if(mp.count((*it).first)!=0)	break;
					mp[(*it).first]=1;
//					cout<<"ok"<<endl;
				}
				if(it!=tmp.end())	break;
			}
			if(b!=m/j)	break;
		}
		if(a==n/i){
			res++;
//			cout<<i<<" "<<j<<endl;
			if(x*y>i*j || (x*y==i*j&&x>i)){
				x=i;
				y=j;
			}
		}
	}
	cout<<res<<endl<<x<<" "<<y<<endl;
}
			
