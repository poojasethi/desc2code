#include<string.h>
#include<stdio.h>
#include<string>
#include<iostream>
#include<algorithm>
#include<map>
#include<set>
using namespace std;
char s[50][50];
map<string,int > ma;
int n,m;
int check(int x1,int y1,int row,int col)
{
	//printf("%d %d %d %d\n",x1,y1,row,col);
	string str,tmp;
	for(int i=x1;i<x1+row;i++)
	{
		for(int j=y1;j<y1+col;j++)
		{
			str.push_back(s[i][j]);
		}
	}
	//cout<<str<<" "<<ma[str]<<endl;
	if(ma[str]==0)	ma[str]=1;
	else  return 1;
	tmp.clear();
	for(int i=str.size()-1;i>=0;i--) tmp.push_back(str[i]); 
	if(ma[tmp]==0) ma[tmp]=1;
	
	//cout<<str<<" "<<tmp<<endl;
	if(row==col&&row!=1)
	{
		str.clear();
		for(int j=y1;j<y1+col;j++)
		{
			for(int i=x1+row-1;i>=x1;i--)
			{
				str.push_back(s[i][j]);
			}
		}
		//cout<<str<<" "<<ma[str]<<endl;
		if(ma[str]==0) ma[str]=1;
		else return 1;
		tmp.clear();
		for(int i=str.size()-1;i>=0;i--) tmp.push_back(str[i]);
		ma[tmp]=1;
		//cout<<str<<" "<<tmp<<endl;
	}
	return 0;
}

int solve(int row,int col)
{
	for(int x1=1;x1<=n;x1+=row)
	{
		for(int y1=1;y1<=m;y1+=col)
		{
			int flag=check(x1,y1,row,col);
			//printf("x=%d y=%d %d\n",x1,y1,flag);
			
			if(flag) return 0;
		}
	}
	return 1;
}

int main()
{
	while(scanf("%d %d",&n,&m)!=EOF)
	{
		int mins,x=-1,y=-1,ans=0;
		for(int i=1;i<=n;i++) scanf("%s",s[i]+1);
		for(int i=1;i<=n;i++)
		{
			if(n%i) continue;
			for(int j=1;j<=m;j++)
			{
				if(m%j) continue;
				ma.clear();
				//printf("row=%d col=%d\n",i,j);
				if(solve(i,j))
				{
					//printf("%d %d\n",i,j);
					ans++;
					if(x==-1&&y==-1)
					{
						x=i;
						y=j;
					}
					else if(i*j<x*y || i*j==x*y&&i<x)
					{
						x=i;
						y=j;
					}
				}
			} 
		}
		printf("%d\n%d %d\n",ans,x,y);
	}
 } 
   			 			 		  		 	 		  	 		 		