#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <queue>
#include <map>
#include <string.h>

const int N=100010;
const int inf=0x3f3f3f3f;

using namespace std;

int w,l;
char s[21][21];

bool check(int x,int y)
{
	for(int i=0;i<w/x;i++)
	{
		for(int ii=0;ii<l/y;ii++)
		{
			for(int j=0;j<w/x;j++)
			{
				for(int jj=0;jj<l/y;jj++)
				{
					if(i==j && ii==jj) continue;
					bool f=1;
					for(int ww=0;ww<x;ww++)
						for(int ll=0;ll<y;ll++)
							if(s[i*x+ww][ii*y+ll]!=s[j*x+ww][jj*y+ll]) f=0;
					if(f) return 0;
					f=1;
					for(int ww=0;ww<x;ww++)
						for(int ll=0;ll<y;ll++)
							if(s[i*x+ww][ii*y+ll]!=s[j*x+x-1-ww][jj*y+y-1-ll]) f=0;
					if(f) return 0;
					if(x==y)
					{
						f=1;
						for(int ww=0;ww<x;ww++)
							for(int ll=0;ll<y;ll++)
								if(s[i*x+ww][ii*y+ll]!=s[j*x+x-1-ll][jj*y+ww]) f=0;
						if(f) return 0;
						f=1;
						for(int ww=0;ww<x;ww++)
							for(int ll=0;ll<y;ll++)
								if(s[i*x+ww][ii*y+ll]!=s[j*x+ll][jj*y+y-1-ww]) f=0;
						if(f) return 0;
					}
				}
			}
		}
	}
	return 1;
}

int main()
{
	scanf("%d%d",&w,&l);
	for(int i=0;i<w;i++)
		scanf("%s",s[i]);
	int ret=0,x=w,y=l;
	for(int i=1;i<=w;i++)
	{
		for(int j=1;j<=l;j++)
		{
			if(w%i || l%j) continue;
			if(!check(i,j)) continue;
			//cout<<i<<" "<<j<<endl;
			if(x*y>j*i) x=i,y=j;
			else if(x*y==j*i && x>i) x=i,y=j;
			ret++;	
		}
	}
	cout<<ret<<endl;
	cout<<x<<" "<<y<<endl;
	return 0;
}
