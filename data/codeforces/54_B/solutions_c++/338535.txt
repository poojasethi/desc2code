#include <stdio.h>
#include <string.h>
#include <iostream>
#include <vector>
#include <algorithm>
#include <map>
#include <set>
using namespace std;

vector<string> pic;
int A, B;

vector<string> rotate(vector<string> vs) {
	int m = vs.size();
	int n = vs[0].size();
	vector<string> ret(n);
	for ( int i = 0; i < n; i++ )
		for ( int j = m-1; j >= 0; j-- )
			ret[i] += vs[j][i];
	return ret;
}

bool check(int i, int j) {
	set< vector<string> > ss;
	for ( int ii = 0; ii < A; ii+=i )
		for ( int jj = 0; jj < B; jj+=j ) {
			vector<string> p(i);
			for ( int m = 0; m < i; m++ )
				for ( int l = 0; l < j; l++ )
					p[m] += pic[m+ii][l+jj];

			for ( int x = 0; x < 4; x++ ) {
				if ( ss.count(p) )
					return false;
				p = rotate(p);
			}		
			ss.insert(p);
		}
	return true;
}

int main() {
	scanf("%d %d\n", &A, &B);
	pic.resize(A);
	for ( int i = 0; i < A; i++ )
		cin >> pic[i];

	int x = A, y = B;
	int cnt = 0;
	for ( int i = 1; i <= A; i++ ) if ( !(A%i) )
		for ( int j = 1; j <= B; j++ )	if ( !(B%j) ) {
			if ( check(i,j) ) {
				cnt++;
				if ( i*j < x*y || i*j == x*y && i<x )
					x = i, y = j;
			}
		}


	printf("%d\n", cnt);
	printf("%d %d\n", x, y);
}
