#include<iostream>
#include<sstream>
#include<vector>
#include<algorithm>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<set>
#define rep(i,n) for(int i=0;i<n;i++)
#define fr(i,c) for(__typeof (c.begin()) i=c.begin(); i!=c.end(); i++)
#define all(c) (c).begin(), (c).end()
#define pb push_back
using namespace std;

typedef vector<string> vs;
typedef long long ll;

int n,m;
bool contain(set<vs> &s,vs v){
  rep(d,4){
    if(s.count(v))return 1;
    vs nxt(v[0].size(),string(v.size(),' '));
    rep(i,v[0].size())rep(j,v.size())nxt[i][j]=v[v.size()-j-1][i];
    v=nxt;
  }
  return 0;
}
void run(){
  cin>>n>>m;
  int x=n,y=m,cnt=0;
  vs in(n);
  rep(i,n)cin>>in[i];
  for(int a=1;a<=n;a++)for(int b=1;b<=m;b++){
    if(n%a||m%b)continue;
    set<vs> s;
    rep(i,n/a)rep(j,m/b){
      vs v(a);
      rep(k,a)rep(l,b)v[k].pb(in[a*i+k][b*j+l]);
      if(contain(s,v))goto FAIL;
      s.insert(v);
    }
    cnt++;
    if(x*y>a*b||x*y==a*b&&x>a)x=a, y=b;
    FAIL:;
  }
  cout<<cnt<<endl;
  cout<<x<<" "<<y<<endl;
}
int main(){
#ifndef ONLINE_JUDGE
  rep(i,3)
#endif
    run();
  return 0;
}
