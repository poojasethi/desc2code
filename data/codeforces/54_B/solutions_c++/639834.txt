#include<iostream>
#include<string>
#include<map>
using namespace std;
string s[100], tmp1, tmp2, tmp3, tmp4;
map<string,int> ma1, ma2;
int m,n,i, j, t, ok, res, x, y, k, mix = 100, miy = 100;

int main(){
    cin>>m>>n;
    for(i = 0;i<m;i++)cin>>s[i];
    for(i = 1; i<= m; i++)if(m%i==0)
      for(j=1;j<=n;j++)if(n%j==0){
         ma1.clear();ma2.clear();
         ok = 1;
         for(x = 0; x < m; x+=i)
           for(y = 0; y < n; y+=j){
             if(!ok) break;
             tmp1 = ""; tmp2 = ""; tmp3 =""; tmp4 ="";
             for (t = x; t < x + i; t++) 
               for (k = y; k < y + j; k++) tmp1 += s[t][k];
             for (t = x + i - 1; t >= x; t--) 
               for (k = y + j - 1; k >= y; k--) tmp2 += s[t][k];
             for (k = y + j - 1; k >= y; k--)
               for (t = x; t < x + i; t++) tmp3 += s[t][k];
             for (k = y; k < y + j; k++)
               for (t = x + i - 1; t >= x; t--) tmp4 += s[t][k];  
             if(ma1.find(tmp1)!=ma1.end()){ok = 0; break;}
             if(ma1.find(tmp2)!=ma1.end()){ok = 0; break;}
             if(ma2.find(tmp3)!=ma2.end()){ok = 0; break;}
             if(ma2.find(tmp4)!=ma2.end()){ok = 0; break;}
             if(i==j && ma2.find(tmp1)!=ma2.end()){ok = 0; break;}
             if(i==j && ma2.find(tmp2)!=ma2.end()){ok = 0; break;}
             if(i==j && ma1.find(tmp3)!=ma1.end()){ok = 0; break;}
             if(i==j && ma1.find(tmp4)!=ma1.end()){ok = 0; break;}             
             ma1[tmp1]=1; ma2[tmp3]=1;
             
           }
         if(ok){
           res++;
           if (i*j<mix*miy){mix=i;miy=j;}
         }
      }
    cout<<res<<endl;
    cout<<mix<<" "<<miy;
    //system("pause");
}
