#include<iostream>
#include<string.h>
using namespace std ;

char in[55][55] ;
bool check(int x1,int y1,int x2,int y2,int sx,int sy)
{
 bool valid = true ;
 for(int i = 0;valid && i < sx;i++)
  for(int j = 0;j < sy;j++)
   if(in[x1 + i][y1 + j] != in[x2 + i][y2 + j])
    valid = false ;
 if(valid) return false ;
 //if(sx == 2 && sy == 1) cout << ": " << x1 << " " << y1 << " " << x2 << " " << y2 << endl ;
 
 valid = true ;
 for(int i = 0;valid && i < sx;i++)
  for(int j = 0;j < sy;j++)
   if(in[x1 + i][y1 + j] != in[x2 + sx - 1 - i][y2 + sy - 1 - j])
    valid = false ;
 if(valid) return false ;
 
 if(sx != sy) return true ;
 
 valid = true ;
 for(int i = 0;valid && i < sx;i++)
  for(int j = 0;j < sy;j++)
   if(in[x1 + i][y1 + j] != in[x2 + sy - 1 - j][y2 + i])
    valid = false ;
 if(valid) return false ;
 
 valid = true ;
 for(int i = 0;valid && i < sx;i++)
  for(int j = 0;j < sy;j++)
   if(in[x1 + i][y1 + j] != in[x2 + j][y2 + sx - 1 - i])
    valid = false ;
 if(valid) return false ;
 return true ;
}

int main()
{
 int n,m ;
 cin >> n >> m ;
 for(int i = 0;i < n;i++) cin >> in[i] ;
 
 int retX = n,retY = m,retA = n * m,ct = 0 ;
 for(int x = 1;x <= n;x++) if(n % x == 0)
  for(int y = 1;y <= m;y++) if(m % y == 0)
  {
   bool valid = true ;
   for(int xx1 = 0;valid && xx1 < n;xx1 += x)
    for(int yy1 = 0;valid && yy1 < m;yy1 += y)
     for(int xx2 = xx1;valid && xx2 < n;xx2 += x)
      for(int yy2 = 0;valid && yy2 < m;yy2 += y) if(xx2 > xx1 || xx2 == xx1 && yy2 > yy1)
      {
	   if(!check(xx1,yy1,xx2,yy2,x,y)) valid = false ;
      }
   if(valid) ct++ ;
   if(valid && x * y < retA) retA = x * y,retX = x,retY = y ;
  }
 cout << ct << endl << retX << " " << retY << endl ;
 return 0 ;
}
