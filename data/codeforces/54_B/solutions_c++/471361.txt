#include <stdio.h>

char p[25][25];

int compare(int w, int h, int xa, int ya, int xb, int yb) {
	int i, j, f=0;
	for(i=0;i<w;i++)
		for(j=0;j<h;j++)
			if(p[xa+i][ya+j] != p[xb+i][yb+j])
				f=1;
	if(f==0) return 1;
	f=0;
	for(i=0;i<w;i++)
		for(j=0;j<h;j++)
			if(p[xa+w-1-i][ya+h-1-j] != p[xb+i][yb+j])
				f=1;
	if(f==0) return 1;
	if (w == h) {
		f=0;
		for(i=0;i<w;i++)
			for(j=0;j<h;j++)
				if(p[xa+h-1-j][ya+i] != p[xb+i][yb+j])
					f=1;
		if(f==0) return 1;
		f=0;
		for(i=0;i<w;i++)
			for(j=0;j<h;j++)
				if(p[xa+j][ya+w-1-i] != p[xb+i][yb+j])
					f=1;
		if(f==0) return 1;
	}
	return 0;
}

int testok(int w, int h, int a, int b) {
	int aa = a/w, bb = b/h, i, j;
	for(i=0;i<aa*bb;i++)
		for(j=i+1;j<aa*bb;j++)
			if(compare(w, h, i/bb*w, i%bb*h, j/bb*w, j%bb*h))
				return 0;
	return 1;
}

int main(void) {
	int a, b, i, w, h;
	scanf("%d%d", &a, &b);
	for(i=0;i<a;i++)
		scanf("%s", p[i]);
	int bestarea = a*b, bestw=a, besth=b, cnt=0;
	for(w=1;w<=a;w++)
		for(h=1;h<=b;h++){
			if(a%w==0 && b%h==0 && testok(w, h, a, b)) {
				++cnt;
				if(bestarea > w*h) {
				bestarea = w*h;
				bestw = w;
				besth = h;
				}
			}
		}
	printf("%d\n%d %d\n",cnt, bestw, besth);
	return 0;
}
