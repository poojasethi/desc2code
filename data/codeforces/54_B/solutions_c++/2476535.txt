#include<iostream>
#include<cstdio>
#include<string>
#include<map>

using namespace std;

int n , m , ans , h , w;
string str;
map<string,bool> M;

void input() {
	scanf( "%d%d" , &n , &m );
	for ( int i = 0 ; i < n ; i++ ) {
		string s; cin >> s;
		str += s;
	}
}

bool check( int r , int c ) {
	M.clear();
	if ( n % r > 0 ) return false;
	if ( m % c > 0 ) return false;
	for ( int a = 0 ; a < n ; a++ )
		for ( int b = 0 ; b < m ; b++ )
			if ( a % r == 0 && b % c == 0 ) {
				string s = "";
				for ( int i = a ; i < a + r ; i++ )
					for ( int j = b ; j < b + c ; j++ )
						s += str.substr( i * m + j , 1 );
				if ( M[s] ) return false;
				s = "";
				for ( int i = a + r - 1 ; i >= a ; i-- )
					for ( int j = b + c - 1 ; j >= b ; j-- )
						s += str.substr( i * m + j , 1 );
				if ( M[s] ) return false;
				if ( r == c ) {
					s = "";
					for ( int j = b + c - 1 ; j >= b ; j-- )
						for ( int i = a ; i < a + r ; i++ )
							s += str.substr( i * m + j , 1 );
					if ( M[s] ) return false;
					s = "";
					for ( int j = b ; j < b + c ; j++ )
						for ( int i = a + r - 1 ; i >= a ; i-- )
							s += str.substr( i * m + j , 1 );
					if ( M[s] ) return false;
				}
				M[s] = true;
			}
	return true;
}

void solve() {
	h = n , w = m;
	for ( int i = 1 ; i <= n ; i++ )
		for ( int j = 1 ; j <= m ; j++ )
			if ( check( i , j ) ) {
				ans++;
				if ( i * j < h * w || ( i * j == h * w & i < h ) )
					h = i , w = j;
			}
	printf( "%d\n" , ans );
	printf( "%d %d\n" , h , w );
}

int main() {
	input();
	solve();
	
	return 0;
}
