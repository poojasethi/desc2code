#include <iostream>
#include <sstream>
#include <string>
#include <vector>
#include <deque>
#include <queue>
#include <set>
#include <map>
#include <algorithm>
#include <functional>
#include <utility>
#include <cmath>
#include <cstdlib>
#include <ctime>
#include <cstdio>

using namespace std;

#define REP(i,n) for((i)=0;(i)<(int)(n);(i)++)
#define foreach(c,itr) for(__typeof((c).begin()) itr=(c).begin();itr!=(c).end();itr++)

string board[30];
vector <string> v;

string func(int x1, int y1, int x2, int y2){
    int x=x2-x1,y=y2-y1,i,j;
    string ans,t;
    
    t = ""; REP(i,x) REP(j,y) t += board[x1+i][y1+j]; ans = t;
    t = ""; REP(i,x) REP(j,y) t += board[x2-1-i][y2-1-j]; ans = min(ans,t);
    
    if(x == y){
        t = ""; REP(i,y) REP(j,x) t += board[x1+j][y2-1-i]; ans = min(ans,t);
        t = ""; REP(i,y) REP(j,x) t += board[x2-1-j][y1+i]; ans = min(ans,t);
    }
    
    return ans;
}

int main(void){
    int X,Y,i,j,x,y,ans=0,ansx=-1,ansy=-1;
    
    cin >> X >> Y;
    REP(i,X) cin >> board[i];
    
    for(x=1;x<=X;x++) if(X%x == 0) for(y=1;y<=Y;y++) if(Y%y == 0){
        v.clear();
        REP(i,X/x) REP(j,Y/y) v.push_back(func(i*x,j*y,i*x+x,j*y+y));
        sort(v.begin(),v.end());
        bool good = true;
        REP(i,v.size()-1) if(v[i] == v[i+1]) good = false;
        
        if(good){
            ans++;
            if(ansx == -1 || x*y < ansx*ansy) {ansx = x; ansy = y;}
        }
    }
    
    cout << ans << endl << ansx << ' ' << ansy << endl;
    
    return 0;
}
