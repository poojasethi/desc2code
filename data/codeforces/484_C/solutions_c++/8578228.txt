#include<iostream>
#include<fstream>
#include<algorithm>
#include<vector>
using namespace std;
//int czy[100001];
int tab[1000001];
int per[3000001];
char wyn[1000001];
int gdzie[3000001];
vector<int> poz;
int czy[3000001];
int main(){
	string s;
	cin >>s;
	int m=s.size();
	int n;
	scanf("%d", &n);
	for(int t=1; t<=n; t++){
		poz.clear();
		int k,d;
		scanf("%d%d", &k, &d);
		int ile=-1;
		for(int i=0; i<d; i++)
			for(int j=i; j<k; j+=d){
				tab[j]=ile;
				ile++;
		}
		for(int i=1; i<=m-k+1; i++)
			per[i]=i-1;
		for(int i=m-k+1; i<=m; i++)
			per[i]=tab[i-(m-k+1)]+(m-k+1);
		for(int i=m+1; i<=2*m-k+1; i++)
			per[i]=i-1;
		int h=2*m-k;
		for(int i=0; i<=h; i++)
			czy[i]=0;
		int hh=h;
		poz.push_back(h);
		while(h!=0){
			h=per[h];
			poz.push_back(h);
			czy[h]=1;
		}
		h=hh;
		int ll=m-k+1;
		
		for(int i=0; i<poz.size()-ll; i++){
			gdzie[poz[i]]=poz[i+ll];
		}
	
		for(int i=m-k+1; i<h; i++){
			if(czy[i]==0){
				poz.clear();
				int pom=i;
				while(czy[pom]==0){
					czy[pom]=1;
					poz.push_back(pom);
					pom=per[pom];
				}
				for(int j=0; j<poz.size(); j++)
					gdzie[poz[j]]=poz[(j+ll)%poz.size()];
			}
		}
		
		for(int i=0; i<m; i++){
			wyn[gdzie[i+ll]]=s[i];
		}
		for(int i=0; i<m; i++){
			s[i]=wyn[i];
		}
		printf("%s\n", wyn);
	}
}


