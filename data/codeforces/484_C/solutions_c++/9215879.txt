#include <iostream>
#include <string>
#include <cstdio>

using namespace std;

const int limite=5000002;

int nextv2[limite];

void aplica(int v1[limite],int n1,int v2[limite],int n2)
{
  int b2=n2-n1;
  for (int i=1;i<=n1;i++)
    nextv2[b2+i]=v2[b2+v1[i]];
  for (int i=1;i<=n1;i++)
    v2[b2+i]=nextv2[b2+i];
}

int k;

int v[limite];
int vk[limite];

void genera(int len)
{
  if (len==k) {
    aplica(vk,k,v,k);
  } else {
    int nextlen=k-1+(len-(k-1))/2;
    genera(nextlen);
    if ((len-(k-1))%2==0) aplica(v,nextlen,v,len);
    else {
      aplica(v,nextlen,v,len-1);
      aplica(vk,k,v,len);
    }
  }
}

int n,d;

char s[limite];
char nexts[limite];

int main()
{
  //ios::sync_with_stdio(false);
  scanf("%s",s+1);
  n=1;
  while (s[n+1]!=0) n++;
  int casos;
  scanf("%d",&casos);
  for (int cas=0;cas<casos;cas++) {
    scanf("%d %d",&k,&d);
    for (int i=1;i<=n;i++)
      v[i]=i;
    int ivk=1;
    for (int i=0;i<d;i++)
      for (int j=i+1;j<=k;j+=d)
	vk[ivk++]=j;
    genera(n);
    for (int i=1;i<=n;i++)
      nexts[i]=s[v[i]];
    for (int i=1;i<=n;i++)
      s[i]=nexts[i];
    printf("%s\n",s+1);
  }
}
