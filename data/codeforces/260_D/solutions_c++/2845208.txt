#include <cstdio>
#include <queue>

#define X first
#define Y second

using namespace std;

int i,n,w,a,b;
priority_queue< pair<int,int> > pq[2];

int main() {
    scanf("%d",&n);
    for (i=1;i<=n;i++){
        scanf("%d%d",&a,&b);
        pq[a].push(make_pair(-b,i));
    }
    w=0;
    for (i=1;i<n;i++){
        if (-pq[w].top().X<-pq[w^1].top().X) w^=1;
        if ((pq[w].top().X==pq[w^1].top().X)&&(pq[w].size()>pq[w^1].size())) w^=1;
        a=pq[w].top().Y;b=-pq[w].top().X;
        printf("%d %d %d\n",pq[w].top().Y,pq[w^1].top().Y,-pq[w^1].top().X);
        b-=-pq[w^1].top().X;
        pq[0].pop();pq[1].pop();
        pq[w].push(make_pair(-b,a));
    }
    //while(1);
    return 0;
}