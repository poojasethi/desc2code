//In the name of God
#include <cstdio>
#include <vector>
using namespace std;

typedef pair<int, int> pii;

int n;
vector<pii> q[2];

int main() {
	scanf("%d", &n);
	for (int i = 1; i <= n; i++) {
		int s, c;
		scanf("%d%d", &c, &s);
		q[c].push_back(pii(s, i));
	}
	while (!q[0].empty()) {
		int c = 0;
		if (q[1].size() > q[0].size())
			c = 1;
		if (q[c].back().first <= q[1 - c].back().first) {
			printf("%d %d %d\n", q[c].back().second, q[1 - c].back().second, q[c].back().first);
			q[1 - c].back().first -= q[c].back().first;
			q[c].pop_back();
		}
		else {
			printf("%d %d %d\n", q[0].back().second, q[1].back().second, q[1 - c].back().first);
			q[c].back().first -= q[1 - c].back().first;
			q[1 - c].pop_back();
		}
	}
	return 0;
}
