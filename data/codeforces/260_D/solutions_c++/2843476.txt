#include <cstdio>
#include <utility>
#include <queue>
#define mp make_pair
#define X first
#define Y second
#define REP(i,n) for (int i=1;i<=n;++i)
using namespace std;

int n,w;
priority_queue< pair<int,int> > pq[2];

int main() {
	scanf("%d",&n);
	REP(i,n) {
		int a,b;
		scanf("%d%d",&a,&b);
		pq[a].push(mp(-b,i));
	}
	w=0;
	REP(i,n-1) {
		if (-pq[w].top().X<-pq[w^1].top().X) w^=1;
		if ((pq[w].top().X==pq[w^1].top().X)&&(pq[w].size()>pq[w^1].size())) w^=1;
		int a=-pq[w].top().X;
		int b=pq[w].top().Y;
		printf("%d %d %d\n",pq[w].top().Y,pq[w^1].top().Y,-pq[w^1].top().X);
		a-=-pq[w^1].top().X;
		pq[0].pop(); pq[1].pop();
		pq[w].push(mp(-a,b));
	}
	return 0;
}
