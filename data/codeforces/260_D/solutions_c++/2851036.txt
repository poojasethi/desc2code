#include<stdio.h>

const int MAXN=100000+9;

int a[MAXN],b[MAXN],s[MAXN];
int u[MAXN],v[MAXN],w[MAXN];
int main()
{
#ifndef ONLINE_JUDGE
	freopen("input.txt","r",stdin);
	freopen("output.txt","w",stdout);
#endif
	int n,i,j;
	scanf("%d",&n);
	int p=0,q=0;
	for(i=1;i<=n;++i)
	{
		scanf("%d%d",&j,s+i);
		if(j)
			a[++p]=i;
		else b[++q]=i;
	}
	int e=0;
	for(i=j=1;i<=p && j<=q;)
	{
		u[++e]=a[i],v[e]=b[j];
		if(s[a[i]]>s[b[j]])
		{
			s[a[i]]-=s[b[j]];
			w[e]=s[b[j++]];
		}
		else
		{
			s[b[j]]-=s[a[i]];
			w[e]=s[a[i++]];
		}
	}
	for(++i;i<=p;++i)
		u[++e]=a[i],v[e]=b[q];
	for(++j;j<=q;++j)
		u[++e]=a[p],v[e]=b[j];
	for(i=1;i<=e;++i)
		printf("%d %d %d\n",u[i],v[i],w[i]);
	return 0;
}
