#include<cstdio>
#include<iostream>
#include<queue>
#include<algorithm>
using namespace std;
const int N = 1e5 + 2;
int n;
priority_queue<pair<int, int> > q[2];
int main()
{
    ios::sync_with_stdio(false);
    cin >> n;
    int c, x;
    for(int i = 0; i < n; ++i)
    {
        cin >> c >> x;
        q[c].push(make_pair(-x, i + 1));
    }
    while(!q[0].empty() && !q[1].empty())
    {
        pair<int, int> t0 = q[0].top(), t1 = q[1].top();
        q[0].pop(); q[1].pop();
        int d = max(t0.first, t1.first);
        t0.first -= d;
        t1.first -= d;
        printf("%d %d %d\n", t0.second, t1.second, -d);
        if(t0.first || q[0].empty())  q[0].push(t0);
        else q[1].push(t1);
    }
    return 0;
}
