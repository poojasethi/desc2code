#include <cstdio>
#include <iostream>
#include <set>

using namespace std;
typedef pair<int,int> pii;

set<pii> B,W;
int n;

int main()
{
   cin >> n;
   for (int i=0 ; i<n ; i++)
   {
      int c,s;
      cin >> c >> s;
      if ( c ) B.insert(make_pair( s , i + 1 ));
      else W.insert(make_pair( s , i + 1 ));
   }
   while ( !B.empty() )
   {
      if ( B.begin()->first > W.begin()->first || ( B.begin()->first == W.begin()->first && W.size() > B.size() ) ) B.swap(W);
      cout << B.begin()->second << " " << W.begin()->second << " " << B.begin()->first << endl;
      pair<int,int> tmp = *W.begin();
      tmp.first -= B.begin()->first;
      W.erase(W.begin());
      B.erase(B.begin());
      W.insert(tmp);
   }
   return 0;
}
