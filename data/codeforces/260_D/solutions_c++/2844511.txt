#include<stdio.h>
#include<set>
#define MP make_pair
using namespace std;
set < pair < int , int > > S[2];
int n,col,val,i,val1,val2;
pair < int , int > top1,top2;
int main()
{
    scanf("%d",&n);
    for(i=0;i<n;i++)
    {
        scanf("%d%d",&col,&val);
        S[col].insert(MP(val,i+1));
    }
    for(i=0;i<n-1;i++)
    {
        top1=*(S[0].begin());
        top2=*(S[1].begin());
        S[0].erase(top1);
        S[1].erase(top2);
        val1=top1.first;
        val2=top2.first;
        printf("%d %d %d\n",top1.second,top2.second,min(val1,val2));
        if((val1>val2&&(!S[1].empty()))||(S[0].empty()))
            S[0].insert(MP(val1-val2,top1.second));
        else
            S[1].insert(MP(val2-val1,top2.second));
    }
}