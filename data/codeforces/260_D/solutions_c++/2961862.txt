#include <iostream>
#include <algorithm>
#include <stdio.h>

using namespace std;

struct tree{
    int i;
    int v;
    bool operator<(const tree& t)const{return this->v<t.v;}
};

tree black[100001];
tree white[100001];

int main(void){
    int n,c,v;
    cin>>n;
    int b=0,w=0;
    for(int i=0;i<n;i++){
        cin>>c>>v;
        if(c) black[b++]={i+1,v};
        else white[w++]={i+1,v};
    }

    for(int i=0,j=0;;){
        v=(black[i].v>white[j].v?white[j].v:black[i].v);
        cout<<black[i].i<<" "<<white[j].i<<" "<<v<<endl;
        black[i].v-=v;white[j].v-=v;
        if(i==b-1&&j==w-1) break;
        if(black[i].v==0&&i<b-1) i++;
        else if(white[j].v==0&&j<w-1) j++;
    }
}