#include<cstdio>
#include<iostream>
#include<algorithm>
using namespace std;
const int maxn=100005;
int n,m[2];
struct Node
{
	int s,v;
}a[2][maxn];
int cmp(Node a,Node b){return a.s<b.s;}
int main()
{
	cin>>n;;
	for(int i=1,c;i<=n;i++)
		scanf("%d",&c),scanf("%d",&a[c][++m[c]].s),a[c][m[c]].v=i;
	sort(a[0]+1,a[0]+m[0]+1,cmp);
	sort(a[1]+1,a[1]+m[1]+1,cmp);
	for(int l=1,r=1;l<=m[0]&&r<=m[1];)
	{
		int e=min(a[0][l].s,a[1][r].s);
		printf("%d %d %d\n",a[0][l].v,a[1][r].v,e);
		a[0][l].s-=e;a[1][r].s-=e;
		if(a[0][l].s)r++;else if(a[1][r].s)l++;else if(l<m[0])l++;else r++;
	}
	return 0;
}