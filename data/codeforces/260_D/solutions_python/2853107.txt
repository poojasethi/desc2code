import sys
n = input()
w,b,now=[],[],1
for ch in sys.stdin:
	x = map(int,ch.split())+[now]
	now = now+1
	if x[0]:
		w.append(x)
	else:
		b.append(x)
w=sorted(w,key=lambda x:x[1])
b=sorted(b,key=lambda x:x[1])
i,j=0,0
while i < len(w) and j < len(b):
	print w[i][2],b[j][2],
	if w[i][1] < b[j][1] or (w[i][1]==b[j][1] and len(w) - i > len(b) - j):
		print w[i][1]
		b[j][1] -= w[i][1]
		i += 1
	else :
		print b[j][1]
		w[i][1] -= b[j][1]
		j += 1
