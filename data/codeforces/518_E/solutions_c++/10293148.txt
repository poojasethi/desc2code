#include <iostream>
#include <cstdlib>
#include <cstdio>
#include <stdio.h>
using namespace std;
int main(){
  //freopen("input.txt","r",stdin);
  //freopen("output.txt","w",stdout);
  int q,w,e,e1,r,t,c,v,c1,v1,a[100000],i=2000000000;
  scanf("%d%d",&q,&t);
  char s[20];
  for(w=0;w<q;w++){
   scanf("%s",s);
   if(s[0]=='?')
    a[w]=i;
   else{
    e=r=0;c=1;
    if(s[0]=='-'){
     c=-1;
     e++;}
    for(;s[e];e++)
     r=r*10+s[e]-48;
    a[w]=r*c;}}
  for(w=0;w<t;w++){
   e=w;
   c=-1001000000;
   while(e<q){
    while((e<q)&&(a[e]!=i)){
     if(c>=a[e]){
      cout<<"Incorrect sequence";
      return 0;}
     c=a[e];
     e+=t;}
    if((e<q)&&(a[e]==i)){
     e1=0;
     for(r=e;(r<q)&&(a[r]==i);r+=t)
      e1++;
     if(r<q)
      v=a[r];
     else
      v=1001000000;
     if(v-c<=e1){
      cout<<"Incorrect sequence";
      return 0;}
     c1=v1=0;
     if(v1>=v)
      c1=v1=v-1;
     if(c1<=c)
      c1=v1=c+1;
     while(v1-c1+1<e1){
      if(c+1<c1)
       c1--;
      if(v1<v-1)
       v1++;}
     for(;e<r;e+=t){
      a[e]=c1;c1++;}
     if(r<q)
      c=a[r]-1;}}}
  for(w=0;w<q;w++)
   printf("%d ",a[w]);
  return 0;}
