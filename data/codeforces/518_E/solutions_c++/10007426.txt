#include<iostream>
#include<vector>
#include<algorithm>
#include<cmath>
#include<string>
#include<map>
#include<set>
#include<queue>
#include<stack>
using namespace std;
/*
   Akshay Aggarwal (c)
   */
#define ll long long
int main()
{
	ll n,k;
	cin>>n>>k;
	vector<ll> arr(n);
	vector<bool> fnd(n,1);
	for(ll i=0;i<n;++i)
	{
		string x;
		cin>>x;
		if(x[0]=='?')fnd[i]=0;
		else 
		{
			arr[i]=0;
			ll j=0;
			if(x[0]=='-')j++;
			for(;j<(ll)x.length();j++)
			{
				arr[i]*=10;
				arr[i]+=x[j]-'0';
			}
			if(x[0]=='-')arr[i]=-arr[i];
		}
	}
	for(ll i=0;i<k;++i)
	{
		ll m=-100000000002;
		ll M=-m;
		ll j=i;
		ll cnt=0;
		while(j<n)
		{
			ll prev=j;
			cnt=0;
			M=100000000002;
			while(j<n && fnd[j]==0){j+=k;cnt++;}
			if(j<n)
			{
				M=arr[j];
			}
			if(M <= m+cnt)
			{
				cout<<"Incorrect sequence\n";
				return 0;
			}
			if(cnt!=0)
			{
				if(m >= -(cnt/2+1))
				{
					for(ll q=prev;q<j;q+=k)
						arr[q]=arr[q-k]+1;
				}
				else if(M <= cnt/2 +1)
				{
					for(ll q=j-k;q>=prev;q-=k)
						arr[q]=arr[q+k]-1;
				}
				else
				{
					arr[prev]=-(cnt/2);
					for(ll q=prev+k;q<j;q+=k)
						arr[q]=arr[q-k]+1;

				}
			}
			m=M;
			j+=k;
		}		
	}
	for(ll i=0;i<n;++i)cout<<arr[i]<<" ";
	cout<<endl;
	return 0;
}
