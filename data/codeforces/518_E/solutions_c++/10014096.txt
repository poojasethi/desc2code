#include <cstdio>
#include <algorithm>
#define N 100005
#define INF (1 << 30)
#define fi(a, b, c) for(int a = (b); a < (c); a++)
using namespace std;

int n, m, a[N], b[N];
char buf[12];

int main(){
	scanf("%d %d", &n, &m);
	fi(i, 0, n){
		scanf("%s", buf);
		if(buf[0] == '?') a[i] = INF;
		else a[i] = atoi(buf);
	}
	
	fi(i, 0, m){
		int prev = -INF, s = (n - i - 1) / m + 1;
		fi(j, 0, s) b[j] = a[i + j * m];
		
		fi(j, 0, s){
			int k = j, next = INF;
			while(k < s && b[k] == INF) k++;
			if(k < s) next = b[k];
			
			if(next <= k - j + prev){
				puts("Incorrect sequence");
				scanf("\n");
				return 0;	
			}
			
			int up = (k - j + 1) / 2;
			up = min(up, next);
			up = max(up, prev + k - j + 1);
			
			fi(x, j, k) b[x] = up - k + x;
			
			prev = next;
			j = k;
		}
		
		fi(j, 0, s) a[i + j * m] = b[j];
	}
	
	fi(i, 0, n) printf("%d%c", a[i], i == n - 1 ? '\n' : ' ');
	
	scanf("\n");
}
