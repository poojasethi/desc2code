#include<stdio.h>
#include<string.h>
#define max(a,b) ((a)>(b)?(a):(b))
#define min(a,b) ((a)<(b)?(a):(b))

char buf[30];
int a[100000];
bool unk[100000];
int cnt,bufi,n,k,q,prev,now;
char c;

void read()
{
	if(buf[0]=='?') unk[cnt++]=true;
	else sscanf(buf,"%i",&a[cnt++]);
	for(int i=0;i<bufi;i++) buf[i]=0;
	bufi=0;
}

bool Qs(int now)
{
	int f;
	if(prev<0)
	{
		if(now==-1) f=-(q-1)/2;
		else f=min(-(q-1)/2,a[now]-q);
	}	
	else
	{
		if(now==-1) f=max(-(q-1)/2,a[prev]+1);
		else
		{
			if(a[now]-a[prev]<=q) return true;
			
			if(a[prev]>=0) f=a[prev]+1;
			else
			if(a[now]<=0) f=a[now]-q;
			else
			{
				f=max(a[prev]+1,-(q-1)/2);
				f=min(f,a[now]-q);
			}
		}
	}
	for(int i=0;i<q;i++)
		a[prev+(i+1)*k]=f+i;
	q=0;
	return false;
}


int main()
{
	scanf("%i %i\n%c",&n,&k,&c);
	while(c!='\n')
	{
		if(c==' ') read();
		else buf[bufi++]=c;
		scanf("%c",&c);
	}
	read();
	
	for(int i=0;i<k;i++)
	{
		prev=i-k;
		for(int j=i;j<n;j+=k)
		{
			if(unk[j]) q++;
			else
			{
				if(prev>=0&&a[j]<=a[prev])
				{
					printf("Incorrect sequence");
					return 0;
				}
				if(q) 
					if(Qs(j))
					{
						printf("Incorrect sequence");
						return 0;
					}
				prev=j;
			}
		}
		if(q) Qs(-1);
	}
	
	
	for(int i=0;i<n;i++) printf("%i ",a[i]);
	
	return 0;
}