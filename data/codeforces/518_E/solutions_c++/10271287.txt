#include<bits/stdc++.h>
using namespace std;
int a[100005],vis[100005],b[100005],viss[100005];
int n,k;

void init(char *s,int id){
	if(s[0]=='?'){
		return;
	}
	vis[id]=1;
	int ans=0,i=0,len=strlen(s),flag=0;
	if(s[0]=='-') flag=1,i++;
	for(;i<len;i++){
		ans=ans*10+s[i]-'0';
	}
	a[id]=flag?-ans:ans;
}

int check(int len){
	int id=-1,pos,i,j;
	for(i=0;i<len;i++){
		if(viss[i]){
			if(id==-1) pos=b[i],id=i;
			else if(pos+i-id>b[i]) return 0;
		}
	}
	int l=0,r=0;
	for(i=0;i<=len;i++){
		if(viss[i] || i==len){
			r=i;
			if(l==r){
				l=i+1;
				continue;
			}
			int cnt=r-l,minn=-cnt/2,maxx=cnt-1-cnt/2;
			if(l!=0 && b[l-1]>=minn) minn=b[l-1]+1,maxx=minn+cnt-1;
			if(r!=len && b[r]<=maxx) maxx=b[r]-1,minn=maxx-cnt+1;
			for(j=l;j<r;j++) b[j]=minn++;
			l=i+1;
		}
	}
	return 1;
}

int main(void){
	int i,j;  char temp[100005];
	while(~scanf("%d%d",&n,&k)){
		memset(a,0x3f,sizeof(a));
		memset(vis,0,sizeof(vis));
		int ok=1;
		for(i=0;i<n;i++){
			scanf("%s",temp);
			init(temp,i);
		}
		for(i=0;i<k;i++){
			j=i;
			int len=0;
			while(j<n) b[len]=a[j],viss[len++]=vis[j],j+=k;
			if(check(len)){
				j=i; len=0;
				while(j<n) a[j]=b[len++],j+=k;
			}
			else ok=0;
			if(!ok) break;
		}
		if(!ok) puts("Incorrect sequence");
		else{
			for(i=0;i<n-1;i++) printf("%d ",a[i]);
			printf("%d\n",a[n-1]); 
		}
	}
	return 0;
}

