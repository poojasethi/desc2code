#include <cstdio>
int min(int a, int b) {
  return a < b ? a : b;
}
int max(int a, int b) {
  return a > b ? a : b;
}
char s[1000];
int a[200005];
int main() {
  int n, k;
  scanf("%d %d", &n, &k);
  for (int i = 0; i < n; i++) {
    scanf("%s", s);
    if (s[0] == '?') {
      a[i] = 1010000005;
    } else {
      sscanf(s, "%d", &a[i]);
    }
  }
  for (int i = n; i < n + k; i++) {
    a[i] = 1011000005;
  }
  for (int i = 0; i < k; i++) {
    int atleast = -1010000005;
    int count = 0;
    for (int j = i; j < n + k; j += k) {
      if (a[j] == 1010000005) {
        count++;
      } else {
        // resolve
        if (a[j] - atleast <= count) {
          printf("Incorrect sequence\n");
          return 0;
        }
        int start = max(atleast + 1, min(a[j] - count, -count/2));
        for (int x = count; x > 0; x--, start++) {
          a[j - x * k] = start;
        }
        atleast = a[j];
        count = 0;
      }
    }
  }
  for (int i = 0; i < n; i++) {
    printf("%d ", a[i]);
  }
  return 0;
}