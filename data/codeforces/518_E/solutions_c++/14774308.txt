#include <bits/stdc++.h>
#define inf 1010000006

using namespace std;

int n, a[1234567], k;
string s;

int rc(string s){
    int sum = 0;
    if(s[0] == '-'){
        for(int i = 1; i < s.length(); i++) sum = sum*10 + s[i] - 48; return -sum;}
    for(int i = 0; i < s.length(); i++) sum = sum*10 + s[i] - 48; return sum;
}

int main()
{
    ios_base::sync_with_stdio(false);
   //freopen("e.in","r",stdin);
    //freopen("e.out","w",stdout);
    cin >> n >> k;
    for(int i = 0; i < n; i++){
        cin >> s;
        if(s[0] == '?') a[i] = inf;
            else a[i] = rc(s);
    }
    for(int i = n; i < n + k; i++) a[i] = inf + 1234567;
    for(int i = 0; i < k; i++){
        int st = -inf;
        int cnt = 0;
        for(int j = i; j < n+k; j += k){
            if(a[j] == inf) cnt++;
            else{
                if(a[j] - st <= cnt) {cout<<"Incorrect sequence"; return 0;}
                int start = max(st + 1, min(a[j] - cnt, - cnt/2));
                for (int x = cnt; x > 0; x--, start++) a[j - x * k] = start;
                st = a[j];
                cnt = 0;
            }
        }
    }
    for(int i = 0; i < n; i++) cout << a[i] <<" ";
    return 0;
}
