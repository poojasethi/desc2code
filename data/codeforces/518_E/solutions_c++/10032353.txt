#include<bits/stdc++.h>

#define mp make_pair
#define pb push_back
#define fi first
#define se second
#define sz(a) ((int)a.size())
#define rep(i,n) for(int i=0;i<n;i++)
#define repl(i,n) for(int i=1;i<=n;i++)
#define repr(i,a,b) for(int i=a;i<=b;i++)

using namespace std;

typedef pair<int, int> pii;
typedef vector<int> vi;

typedef long long ll;
typedef pair<ll, ll> pll;
typedef vector<ll> vll;

string a[100001];
int ai[100001];

bool replace(int n, int k, int pos) {
	int cnt = 0, i = pos;
	while (i < n and a[i] == "?") {
		cnt++;
		a[i] = "x";
		i += k;
	}
	int l, u;
	pos >= k ? l = ai[pos - k] + 1 : l = -2000000000;
	i < n ? u = ai[i] - cnt : u = 2000000000;
	if (u < l) return false;
	int m;
	if (l >= -cnt/2) {
		m = l;
	} else {
		if (u <= -cnt/2) {
			m = u;
		} else {
			m = -cnt/2;
		}
	}
	rep(i, cnt) ai[pos + i * k] = m + i;
	return true;
}

bool solve(int n, int k) {
	rep(i, n) {
		if (a[i] == "x") continue;
		if (a[i] == "?") {
			if (!replace(n, k, i)) return false;
		} 
	}
	rep(i, n-k) {
		if (ai[i] >= ai[i+k]) return false;
	}
	return true;
}

int main() {
	int n, k;
	cin >> n >> k;
	rep(i, n) {
		cin >> a[i];
		if (a[i] != "?") ai[i] = atoi(a[i].c_str());
	}
	if (solve(n, k)) {
		rep(i, n) cout << ai[i] << " ";
	} else {
		cout << "Incorrect sequence";
	}
	return 0;
}
