#include<bits/stdc++.h>
using namespace std;
#define inf 0x3f3f3f3f
char s[20];
int a[200005];
int main()
{
    int n,k,i,j;
    scanf("%d%d",&n,&k);
    for(i=1;i<=n;++i)
    {
        scanf("%s",s);
        if(s[0]=='?') a[i]=inf;
        else sscanf(s,"%d",&a[i]);
    }
    for(i=n+1;i<=n+k;++i)
    {
        a[i]=inf+1;
    }
    for(i=1;i<=k;++i)
    {
        int cnt=0,pre=-inf;
        for(j=i;j<=n+k;j+=k)
        {
            if(a[j]==inf) ++cnt;
            else
            {
                if(a[j]-pre<=cnt)
                {
                    puts("Incorrect sequence");
                    return 0;
                }
                int num=max(pre+1,min(-cnt/2,a[j]-cnt));
                for(int t=cnt;t>0;--t) a[j-t*k]=num++;
                cnt=0;
                pre=a[j];
            }
        }
    }
    for(i=1;i<n;++i) printf("%d ",a[i]);
    printf("%d\n",a[i]);
    return 0;
}

	 	 		 				 				 		    		 		