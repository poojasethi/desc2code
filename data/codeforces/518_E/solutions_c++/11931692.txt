#include <bits/stdc++.h>

#define pb push_back
#define KILL {cout << "Incorrect sequence" << endl; return 0;}

using namespace std;

const int maxl = 1000 * 100 + 5;
const int oo = 1000 * 1000 * 1000 + maxl + 5;

vector < int > a [ maxl ];
int n, k;

int main (){
	cin >> n >> k;

	for ( int i = 0 ; i < k ; i++ )
		a [ i ].pb ( -oo );

	for ( int i = 0 ; i < n ; i++ ){
		int x;

		std::cin >> std::ws;
		if ( cin.peek () == '?' ){
			char tmp;
			cin >> tmp;
			x = oo;
		}
		else
			cin >> x;

		a [ i % k ].pb ( x );
	}

	for ( int i = 0 ; i < k ; i++ )
		a [ i ].pb ( oo - 1 );

	for ( int i = 0 ; i < k ; i++ ){
		int l = 0;
		for ( int j = 0 ; j < a [ i ].size () ; j++ )
			if ( a [ i ][ j ] == oo )
				continue;
			else {
				int mn = a [ i ][ l ], mx = a [ i ][ j ], start;
				if ( (mx - mn) < (j - l) )
					KILL

				start = max ( min ( -((j - l - 1) / 2), mx - (j - l - 1)), mn + 1);

				for ( int k = l + 1 ; k < j ; k++ )
					a [ i ][ k ] = start + k - l - 1;

				l = j;
			}
	}

	for ( int i = 0 ; i < n ; i++ )
		cout << a [ i % k ][ i / k + 1 ] << " ";
	cout << endl;
}
