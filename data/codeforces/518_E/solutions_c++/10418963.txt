#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<cmath>
#include<string>
#include<cstring>
#include<algorithm>
using namespace std;
int n,k;
char a[13];
int qus[200051];
int num[200051]; 
int INF=2147483646; 
void init()
{
	cin>>n>>k;
	for(int i=1;i<=n;i++)
	{
        scanf("%s",&a);
        if(a[0]=='?')
        {qus[i]=INF;}
        else
        {sscanf(a,"%d",&qus[i]);}	     
    }
    for(int i=n+1;i<=n+k;i++)
      qus[i]=INF+1;
    for(int i=1;i<=k;i++)
    {
    	int cnt=0,pre=-INF;
    	for(int j=i;j<=n+k;j+=k)
    	{
    		if(qus[j]==INF)cnt++;
    		else
    		{
    			if(qus[j]<=cnt+pre)
    			{
    				cout<<"Incorrect sequence"<<endl;
    				return;
    			}
    			int st=max(pre+1,min(-cnt/2,qus[j]-cnt));
    			for(int l=cnt;l>0;l--)qus[j-l*k]=st++;
    			cnt=0;
    			pre=qus[j];
    		}
    	}
    	
    }
    for(int i=1;i<=n;i++)
      cout<<qus[i]<<" ";
    cout<<endl;
}
int main()
{
	init();
	return 0;
}