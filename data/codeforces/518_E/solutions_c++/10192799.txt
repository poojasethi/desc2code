#include<iostream>
#include<cstdio>
using namespace std;

const int maxn = 210 * 1000;

int s2n(string &s){
	int x = 0, f = 0;
	for (int i=0 ; i<s.size() ; i++){
		if (s[i]=='-'){
			f = 1;
			continue;
		}	
		x *= 10;
		x += s[i]-'0';
	}
	if (f) x = -x;
	return x;
}

int n, k;
int a[maxn], b[maxn];

int main(){
	ios::sync_with_stdio(0);
	cin >> n >> k;
	string s;
	for (int i=0 ; i<n ; i++){
		cin >> s;
		if (s[0]=='?')
			b[i] = 1;
		else
			a[i] = s2n(s);
	}
	for (int i=0 ; i<n ; i++){
		if (b[i]){
			int t = 1;
			while( i + t*k <n && b[ i + t*k])
				t++;
			int p = -2000 * 1000 * 1000;
			int q = -p;
			if (i-k>=0) p = max(p, a[i-k]+1);
			if (i + t*k <n) q = min(q, a[i + t*k]-t);
			if (p > q){
				cout << "Incorrect sequence" << endl;
				return 0;
			}
			int S = -t/2;
			if (p >= -t/2)
				S = p;
			else if (q <= -t/2)
				S = q;
			for (int j=0 ; j<t ; j++){
				a[i + j*k] = S+j;
				b[i + j*k] = 0;
			}	
		}
		if (i-k >= 0) if (a[i-k] >= a[i]){
			cout << "Incorrect sequence" << endl;
			return 0;
		}
	}
	for (int i=0 ; i<n ; i++)
		cout << a[i] << " ";
	cout << endl;	
}
