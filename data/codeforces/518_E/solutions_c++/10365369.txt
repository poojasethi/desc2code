#include <cstdio>   
#include <algorithm>   
#include <stdio.h>
#include <stdlib.h>
using namespace std;  
int const INF = 0x3fffffff;  
char s[20];  
int a[200000];  
  
int main()   
{  
    int n, k;  
    scanf("%d %d", &n, &k);  
    for(int i = 0; i < n; i++)   
    {  
        scanf("%s", s);  
        if(s[0] == '?')  
            a[i] = INF;  
        else  
            sscanf(s, "%d", &a[i]);  
    }  
    for(int i = n; i < n + k; i++)  
        a[i] = INF + 1;  
    for(int i = 0; i < k; i++)   
    {  
        int mi = -INF, cnt = 0;  
        for(int j = i; j < n + k; j += k)   
        {  
            if(a[j] == INF)  
                cnt++;  
            else   
            {  
                if(a[j] - mi <= cnt)   
                {  
                    printf("Incorrect sequence\n");  
                    return 0;  
                }  
                int num = max(mi + 1, min(a[j] - cnt, -cnt / 2));  
                for(int tmp = cnt; tmp > 0; tmp--)  
                {  
                    int idx = j - tmp * k;  
                    a[idx] = num++;  
                }  
                mi = a[j];  
                cnt = 0;  
            }  
        }  
    }  
    for(int i = 0; i < n - 1; i++)  
        printf("%d ", a[i]);  
        printf("%d\n", a[n - 1]);  
} 
 					 	 			   	 	  	 	  	   		