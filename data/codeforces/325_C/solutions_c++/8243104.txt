#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <queue>
#define N 100010
#define inf 314000000
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
struct ww {
	int a,c;
	vector<int> b;
} a[N];
struct w {
	int f1,f2,ma,mi;
} b[N];
int i,j,k,n,m,x,y;
int f[N],sheng[N],s[N];
vector<int> c[N],d[N];

struct dui {
	int x,y;
	inline bool operator < (const dui &A) const {
		return x>A.x||x==A.x&&s[y]>s[A.y];
	}
};
priority_queue<dui> Q;
void dfs(int x) {
	if (f[x]) return;
	int i,j;
	f[x]=2; b[x].f1=1;
	for (i=0;i<d[x].size();i++) {
		ww A=a[d[x][i]];
		int F=0,s2=A.a,flag=0;
		for (j=0;j<A.b.size();j++) {
			int B=A.b[j];
			if (!b[B].f1) {
				flag=1; break;
			}
		}
		if (flag) continue;
		for (j=0;j<A.b.size();j++) {
			int B=A.b[j];
			if (f[B]==2) F=1;
			else {
				dfs(B);
				F|=b[B].f2;
				s2=min(s2+b[B].ma,inf);
			}
		}
		if (!F) b[x].ma=max(b[x].ma,s2);
		else b[x].f2=1;
	}
	f[x]=1;
}
int main() {
	scanf("%d%d",&m,&n);
	For(i,1,m) {
		scanf("%d%d",&x,&y);
		ww A={}; A.c=x;
		For(j,1,y) {
			scanf("%d",&k);
			if (k<0) A.a++;
			else {
				A.b.push_back(k);
				c[k].push_back(i);
			}
		}
		d[x].push_back(i);
		a[i]=A;
		sheng[i]=A.b.size();
		s[i]=A.a;
		Q.push((dui){sheng[i],i});
	}
	For(i,1,n) b[i].mi=inf;
	for (;!Q.empty();) {
		dui A=Q.top();
		Q.pop();
		int B=a[A.y].c;
		if (A.x) break;
		b[B].mi=min(b[B].mi,s[A.y]);
		if (b[B].f1) continue;
		b[B].f1=1;
		for (i=0;i<c[B].size();i++) {
			int C=c[B][i];
			sheng[C]--;
			s[C]=min(s[C]+b[B].mi,inf);
			Q.push((dui){sheng[C],C});
		}
	}
	For(i,1,n) if (b[i].f1&&!f[i]) dfs(i);
	For(i,1,n) {
		if (!b[i].f1) printf("-1 -1\n");
		else printf("%d %d\n",b[i].mi,b[i].f2?-2:b[i].ma);
	}
	return 0;
}