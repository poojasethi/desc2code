#include <bits/stdc++.h>
using namespace std;
#define rep(i,a,n) for (int i=a;i<n;i++)
#define per(i,a,n) for (int i=n-1;i>=a;i--)
#define pb push_back
#define mp make_pair
#define all(x) (x).begin(),(x).end()
#define SZ(x) ((int)(x).size())
#define fi first
#define se second
typedef vector<int> VI;
typedef long long ll;
typedef pair<int,int> PII;
const ll mod=1000000007;
const int mv=314000000,inf=1000000000;
ll powmod(ll a,ll b) {ll res=1;a%=mod;for(;b;b>>=1){if(b&1)res=res*a%mod;a=a*a%mod;}return res;}
// head

const int N=101000;
int n,m,k,p;
int rp[N],d[N],ind[N],val[N],vad[N];
int dis[N],Dis[N],q[N],t;
priority_queue<PII> hp;
VI e[N],ev[N],rl[N],rr[N];
int main() {
	scanf("%d%d",&m,&n);
	rep(i,0,m) {
		scanf("%d",rp+i);
		scanf("%d",&k);
		rep(j,0,k) {
			scanf("%d",&p);
			if (p==-1) ++val[i]; else {
				rl[i].pb(p); ev[p].pb(i);
			}
		}
		d[i]=SZ(rl[i]);
	}
	rep(i,1,n+1) dis[i]=inf;
	rep(i,0,m) if (d[i]==0) hp.push(mp(-val[i],rp[i]));
	while (!hp.empty()) {
		int u=hp.top().se,v=-hp.top().fi; hp.pop();
		if (dis[u]!=inf) continue;
		dis[u]=v;
		rep(j,0,SZ(ev[u])) {
			v=ev[u][j];
			if (!(--d[v])) {
				int sm=val[v];
				rep(k,0,SZ(rl[v])) sm=min(mv,sm+dis[rl[v][k]]);
				hp.push(mp(-sm,rp[v]));
			}
		}
	}
	rep(i,0,m) {
		vad[i]=1;
		rep(j,0,SZ(rl[i])) vad[i]&=(dis[rl[i][j]]!=inf);
		if (vad[i]) {
			rr[rp[i]].pb(i);
			rep(j,0,SZ(rl[i])) {
				e[rl[i][j]].pb(rp[i]);
				ind[rp[i]]++;
			}
		}
	}
	rep(i,1,n+1) if (ind[i]==0) q[t++]=i;
	rep(i,0,t) {
		int u=q[i];
		rep(j,0,SZ(e[u])) {
			int v=e[u][j];
			if (!(--ind[v])) q[t++]=v;
		}
	}
	rep(i,1,n+1) Dis[i]=-inf;
	rep(i,0,t) {
		int u=q[i];
		rep(j,0,SZ(rr[u])) {
			int v=rr[u][j];
			int sm=val[v];
			rep(k,0,SZ(rl[v])) sm=min(mv,sm+Dis[rl[v][k]]);
			Dis[u]=max(Dis[u],sm);
		}
	}
	rep(i,1,n+1) if (dis[i]==inf) puts("-1 -1");
		else if (Dis[i]<0) printf("%d -2\n",dis[i]);
		else printf("%d %d\n",dis[i],Dis[i]);
}
