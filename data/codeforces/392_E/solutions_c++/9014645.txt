#include <cmath>
#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <algorithm>
using namespace std;
int v[405],V[405],a[405],dp[405][405][2],f[405],i,j,k,n,ans;
int main()
{
    scanf("%d",&n);
    for (i=1; i<=n; i++) scanf("%d",&v[i]);
    for (i=1; i<=n; i++) scanf("%d",&a[i]);
    for (i=1; i<=n; i++) V[i]=-453266144;
    for (i=1; i<=n; i++)
      for (j=i; j<=n; j++)
        V[j]=max(V[j],V[j-i]+v[i]);
    for (i=1; i<=n; i++) dp[i][i][0]=dp[i][i][1]=V[1];
    ans=max(ans,V[1]);
    for (i=1; i<n; i++)
      for (j=1; j<=n-i; j++)
      {
          dp[j][i+j][0]=dp[j][i+j][1]=-453266144;
          if (abs(a[j]-a[i+j])==1)
              dp[j][i+j][0]=dp[j][i+j][1]=V[2]+dp[j+1][i+j-1][1];
          for (k=j+1; k<i+j; k++)
          if (dp[j][k][0]>=-8000000 && dp[k][i+j][0]>=-8000000)
          {
              if (a[k]>a[i+j] && a[k]<a[j] || a[k]<a[i+j] && a[k]>a[j])
                dp[j][i+j][0]=max(dp[j][k][0]+dp[k][i+j][0]-V[abs(a[k]-a[i+j])+1]-V[abs(a[k]-a[j])+1]+V[abs(a[j]-a[i+j])+1],dp[j][i+j][0]);
              if (a[k]<a[j] && a[k]<a[i+j]); else dp[j][i+j][1]=max(dp[j][k][0]+dp[k][i+j][0]-V[abs(a[k]-a[i+j])+1]-V[abs(a[k]-a[j])+1]+V[abs(a[k]-a[j])+abs(a[i+j]-a[k])+1],dp[j][i+j][1]);
          }
          for (k=j+1; k<=i+j; k++) dp[j][i+j][1]=max(dp[j][i+j][1],dp[j][k-1][1]+dp[k][i+j][1]);
          ans=max(ans,dp[j][i+j][1]);
      }
    for (i=1; i<=n; i++)
    {
        f[i]=f[i-1];
        for (j=0; j<i; j++)
          f[i]=max(f[i],f[j]+dp[j+1][i][1]);
    }
    cout<<f[n]<<endl;
    return 0;
}
