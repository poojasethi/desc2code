#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define N 410
#define inf 1000000000
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,l;
int f[N][N],h[N][N],g[N][N],v[N],w[N],an[N];
void dp() {
	For(i,1,n) f[i][i]=h[i][i]=g[i][i]=v[1];
	For(i,1,n)For(j,i+1,n) g[i][j]=h[i][j]=-inf;
	For(l,1,n)For(i,1,n-l) {
		j=i+l;
		f[i][j]=max(f[i+1][j],f[i][j-1])+v[1];
		if (w[i]+1==w[j]) h[i][j]=f[i+1][j-1]+v[2];
		if (w[i]-1==w[j]) g[i][j]=f[i+1][j-1]+v[2];
		For(k,i+1,j-1) if (w[k]>w[i]&&w[k]<w[j]) {
			int A=w[k]-w[i],B=w[j]-w[k];
			if (A>k-i||B>j-k) continue;
			h[i][j]=max(h[i][j],h[i][k]+h[k][j]-v[A+1]-v[B+1]+v[A+B+1]);
		}
		For(k,i+1,j-1) if (w[k]<w[i]&&w[k]>w[j]) {
			int A=w[i]-w[k],B=w[k]-w[j];
			if (A>k-i||B>j-k) continue;
			g[i][j]=max(g[i][j],g[i][k]+g[k][j]-v[A+1]-v[B+1]+v[A+B+1]);
		}
		For(k,i+1,j-1) if (w[k]>w[i]&&w[k]>w[j]) {
			int A=w[k]-w[i],B=w[k]-w[j];
			if (A>k-i||B>j-k) continue;
			f[i][j]=max(f[i][j],h[i][k]+g[k][j]-v[A+1]-v[B+1]+v[A+B+1]);
		}
		For(k,i,j-1) f[i][j]=max(f[i][j],f[i][k]+f[k+1][j]);
		f[i][j]=max(f[i][j],max(h[i][j],g[i][j]));
	}
	For(i,1,n) an[i]=-inf;
	For(i,1,n) {
		an[i]=an[i-1];
		For(j,1,i) an[i]=max(an[j-1]+f[j][i],an[i]);
	}
}
int main() {
	scanf("%d",&n);
	For(i,1,n) scanf("%d",&v[i]);
	For(i,1,n) scanf("%d",&w[i]);
	dp();
	printf("%d\n",an[n]);
	return 0;
}
