#include <bits/stdc++.h>
using namespace std;
const int maxn=100010;
#define int long long
int mark[maxn];
vector<int>adj[maxn],v;
int marked=0;
void dfs(int v){
    mark[v]=1,marked++;
    for(int i=0;i<adj[v].size();i++){
        int u=adj[v][i];
        if(!mark[u])
            dfs(u);
    }
}
main()
{
    int n,m,k;
    cin>>n>>m>>k;
    for(int i=0;i<m;i++){
        int u,v;
        cin>>u>>v;
        u--,v--;
        adj[u].push_back(v),adj[v].push_back(u);
    }
    for(int i=0;i<n;i++){
        int mark1=marked;
        if(!mark[i])
            dfs(i),v.push_back(marked-mark1);;
    }
    int ans=1;
    if(v.size()==1){
        cout<<ans%k<<endl;
        return 0;
    }
    for(int i=0;i<v.size();i++)
        ans*=v[i],ans%=k;
    for(int i=0;i<v.size()-2;i++)
        ans=ans*n,ans%=k;
    cout<<ans%k<<endl;
    return 0;
}
