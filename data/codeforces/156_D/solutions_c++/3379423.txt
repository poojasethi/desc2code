#include <cstdio>
#include <algorithm>
using namespace std;

typedef long long LL;

const int N = 100003;
int p[N];
int r[N];

int find(int x)
{
    if(x != p[x])
        p[x] = find(p[x]);
    return p[x];
}

int main()
{
    int n, m, k;
    scanf("%d%d%d", &n, &m, &k);
    for(int i = 1; i <= n; ++i) {
        p[i] = i;
        r[i] = 1;
    }
    while(m--) {
        int a, b;
        scanf("%d%d", &a, &b);
        a = find(a);
        b = find(b);
        if(a != b) {
            p[a] = b;
            r[b] += r[a];
        }
    }
    
    int res = 1, c = 0;
    for(int i = 1; i <= n; ++i)
        if(p[i] == i) {
            res = (LL)res * r[i] % k;
            ++c;
        }
    
    if(c == 1) {
        printf("%d", 1 % k);
        return 0;
    }
    
    c -= 2;
    while(c--)
        res = (LL)res * n % k;
    printf("%d\n", res);
    return 0;
}
