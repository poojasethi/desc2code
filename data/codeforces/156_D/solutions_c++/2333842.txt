#include <cstdio>
#include <algorithm>
using namespace std;

const int N = 100050;

int f[N], n, m, modu, size[N];

int find (int x) { return (f[x] == x) ? x : (f[x] = find(f[x])); }

int main ()
{
#ifdef LOCAL
	freopen("in", "r", stdin);
#endif
	scanf("%d%d%d", &n, &m, &modu);
	for (int i = 1; i <= n; ++i) f[i] = i;
	for (int i = 1, a, b; i <= m; ++i)
	{
		scanf("%d%d", &a, &b);
		f[find(a)] = find(b);
	}
	for (int i = 1; i <= n; ++i)
		size[find(i)] ++;
	int res(1), cnt(0);
	for (int i = 1; i <= n; ++i)
		if (find(i) == i)
		{
			res = (long long)res * size[i] % modu;
			++cnt;
		}
	for (int i = 1; i <= cnt - 2; ++i)
		res = (long long)res * n % modu;
	printf("%d\n", cnt == 1 ? (1 % modu) : res);
}

