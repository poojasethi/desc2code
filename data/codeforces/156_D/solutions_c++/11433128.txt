#include<bits/stdc++.h>

using namespace std;

typedef vector<int> vi;
typedef vector<vi> vii;

vi vis;
vii edgeList;

int cnt;

void visit(int i) {
	vis[i] = 1;
	cnt++;
	for(int j=0; j<edgeList[i].size(); j++) {
		int u = edgeList[i][j];
		if (vis[u]==0) visit(u);
	}
}

int main() {
	int n, m, k, S, a, b;
	vi cc;

	cin >> n >> m >> k;
	
	vis.assign(n + 1, 0);
	edgeList.assign(n + 1, vi());
	
	for(int i=0; i<m; i++) {
		scanf("%d %d", &a, &b);
		edgeList[a].push_back(b);
		edgeList[b].push_back(a);
	}
	
	for(int i=1; i<=n; i++) {
		if (vis[i]==0) {
			cnt = 0;
			visit(i);
			cc.push_back(cnt);
		}
	}
	
	long long res = 1;
	
	if (cc.size() == 1) cout << (res%k) << "\n";

	else {
		for(int i=0; i<cc.size(); i++) {
			res = (res * cc[i]) % k;
		}
		for(int i=0; i<cc.size()-2; i++) {
			res = (res * n) % k;
		}
		cout << res << "\n";
	}
	
	
}
