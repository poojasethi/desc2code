#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
const int maxn = 100000 + 5;
int par[maxn], cnt[maxn];

int getp(int x)
{
    return par[x] == x ? x : par[x] = getp(par[x]);
}
int main()
{
    int n, m, k;
    cin >> n >> m >> k;
    for(int i = 0; i <= n; i++) par[i] = i;
    for(int i = 0; i < m; i++) {
        int a, b;
        scanf("%d%d", &a, &b);
        par[getp(a)] = par[getp(b)];
    }
    for(int i = 1; i <= n; i++) {
        cnt[getp(i)]++;
    }
    long long ans = 1;
    int t = 0;
    for(int i = 1; i <= n; i++) {
        if(getp(i) == i) {
            ans = (ans*cnt[i])%k;
            t++;
        }
    }
    if(t == 1) {
        ans /= cnt[getp(1)];
    }
    for(int i = 0; i < t - 2; i++) {
        ans = (ans*n)%k;
    }
    cout << ans << endl;
}

		 		 		    		  	 	    		 	 		