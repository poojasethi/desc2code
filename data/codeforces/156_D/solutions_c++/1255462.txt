#include <iostream>
#include <cstring>
#include <cstdio>
using namespace std;
int f[100010], s[100010];
int n, m, k;

int find(int k)
{
	if (f[k] == k)
		return k;
	f[k] = find(f[k]);
	return f[k];
}

int main()
{
	scanf("%d%d%d", &n, &m, &k);
	for (int i = 1; i <= n; i++)
		f[i] = i;
	for (int i = 1; i <= m; i++)
	{
		int x, y;
		scanf("%d%d", &x, &y);
		if (find(x) != find(y))
			f[f[x]] = f[y];
	}
	int sum = 0;
	long long s2 = 1;
	memset(s, 0, sizeof(s));
	for (int i = 1; i <= n; i++)
		s[find(i)]++;
	for (int i = 1; i <= n; i++)
		if (s[i] > 0)
		{
			sum++;
			s2 = (s2 * s[i]) % k;
		}
	if (sum == 1)
		printf("%d\n", 1 % k);
	else
	{
		for (int i = 1; i <= sum - 2; i++)
			s2 = (s2 * n) % k;
		cout << s2 << endl;
	}
	return 0;
}
