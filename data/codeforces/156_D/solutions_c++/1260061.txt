#include<iostream>
using namespace std;
#define N 100005
int fa[N],num[N];
int n,m,k;

int Find(int x)
{
    if(!fa[x]) return x;
    return fa[x]=Find(fa[x]);
}

int main()
{
    cin>>n>>m>>k;
    for(int i=0;i<m;i++)
    {
        int a,b;
        cin>>a>>b;
        a=Find(a);
        b=Find(b);
        if(a!=b)   fa[a]=b;
    }
    
    for(int i=1;i<=n;i++) num[Find(i)]++;
    
    int t=0;
    long long ans=1%k;
    for(int i=1;i<=n;i++)
    {
        if(num[i])
        {
            t++;
            ans=ans*num[i]%k;
        }
    }
    if(t==1) { cout<<1%k<<endl; return 0;}
    
    for(t-=2;t>0;t--)  ans=ans*n%k;
    
    cout<<ans<<endl;
  //  while(1);
}
/*
8 8 999999937
1 2
1 3
1 4
1 5
1 6
1 7
1 8
8 7


*/
        
    
    
