#include<iostream>
#include<iomanip>
#include<cstdio>
#include<cstring>
#include<string>
using namespace std;

int n,m,k,fs[100001],nx[300000],to[300000],e,l[100001],op,ed,p;
long long ans;
bool done[100001];

int main()
{
    ios::sync_with_stdio(false);
    cin>>n>>m>>k;
    ans=1;
    for(int i=1,x,y;i<=m;++i)cin>>x>>y,nx[++e]=fs[x],fs[x]=e,to[e]=y,nx[++e]=fs[y],fs[y]=e,to[e]=x;
    for(int i=1;i<=n;++i)if(!done[i])
    {
		for(done[l[op=ed=0]=i]=1;op<=ed;++op)
			for(int v=fs[l[op]];v;v=nx[v])if(!done[to[v]])
				done[l[++ed]=to[v]]=1;
		ans*=ed+1;ans%=k;
		p++;
	}
	for(int i=2;i<p;++i)ans*=n,ans%=k;
	cout<<(p==1?1%k:ans)<<endl;
    return 0;
}
