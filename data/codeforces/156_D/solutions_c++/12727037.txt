#include <cstdio>

typedef long long ll;

const int maxn = 100010;
int n, m, k, a, b, cnt=0, res=1, ans=1, p[maxn], num[maxn]={0};

int find(int x) { 
	return p[x]-x ? p[x]=find(p[x]) : x; 
}

int mul(int a, int b) {
	return (int)((ll)a*(ll)b%(ll)k);
}

int main() { 
	scanf("%d%d%d", &n, &m, &k);
	if(k == 1) { puts("0"); return 0; }
	for(int i=1; i <= n; i++) p[i]=i;
	for(; m--;) {
		scanf("%d%d", &a, &b);
		p[find(a)]=find(b);
	}
	for(int i=1; i <= n; i++) num[find(i)]++;
	for(int i=1; i <= n; i++) if(num[i]) cnt++, ans=mul(ans, num[i]);
	if(cnt == 1) puts("1");
	else {
		for(a=n, n=cnt-2; n>0; n >>= 1) {
			if(n&1) res=mul(res, a);
			a=mul(a, a);
		}
		printf("%d\n", mul(res, ans));
	}
	return 0;
}
	  					 			  			 				 			  			