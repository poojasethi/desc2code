#include<iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#include<vector>
#define vpp vector<int>::iterator
using namespace std;
vector<int> head[100001];
int sum,p,n,m,ss;
long long ans=1;
bool b[100111];
void dfs(int x)
{
	ss++;
	b[x]=true;
	for (vpp pp=head[x].begin();pp!=head[x].end();++pp)
		if (!b[*pp])
		dfs(*pp);
}
int main()
{
	scanf("%d%d%d",&n,&m,&p);
	for (int i=1;i<=m;++i)
	{
		int x,y;
		scanf("%d%d",&x,&y);
		head[x].push_back(y);
		head[y].push_back(x);
	}
	int k=0;
	for (int i=1;i<=n;++i)
	if (!b[i])
	{
		k++;ss=0;
		dfs(i);
		ans=(ans*ss)%p;
	}
	for (int i=1;i<k-1;++i) ans=ans*n%p;
	if (k==1) cout<<1%p<<endl;
	else cout<<ans<<endl;
	return 0;
}
	
