#include <cmath>
#include <cstdio>
#include <cstring>
#include <iostream>
#include <algorithm>

using namespace std;

int Fa[100010], Siz[100010];

int Get_Fa(int x) {
	return Fa[x] == x ? x : Fa[x] = Get_Fa(Fa[x]);
}

int main() {
	int N, M, K, u, v;
	scanf("%d%d%d", &N, &M, &K);
	for (int i = 1; i <= N; ++ i) Fa[i] = i;
	for (int i = 1; i <= M; ++ i) {
		int u, v;
		scanf("%d%d", &u, &v);
		Fa[Get_Fa(u)] = Get_Fa(v);
	}
	for (int i = 1; i <= N; ++ i) {
		++ Siz[Get_Fa(i)];
	}
	int Cnt = 0;
	long long Ans = 1;
	for (int i = 1; i <= N; ++ i) {
		if (i == Fa[i]) (Ans *= Siz[i]) %= K, ++ Cnt;
	}
	if (Cnt == 1) {
		Ans = 1 % K;
		printf("%lld\n", Ans);
		return 0;
	}
	for (int i = 1; i <= Cnt - 2; ++ i) {
		(Ans *= N) %= K;
	}
	printf("%lld\n", Ans % K);
	return 0;
}