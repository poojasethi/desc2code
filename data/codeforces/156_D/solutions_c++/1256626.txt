#include <stdio.h>
#include <vector>
using namespace std;

#define FOREACH(it,vec) for(typeof((vec).begin()) it = (vec).begin(); it != (vec).end(); it++)

typedef vector<int> VI;

int N, M, MOD;
VI adj[100000];
bool vis[100000];

int gr;

void visit(int i) {
	if (vis[i])
		return;
	gr++;
	vis[i] = true;
	FOREACH(it,adj[i])
		visit(*it);
}

int main() {
	scanf("%d %d %d", &N, &M, &MOD);
	for (int i = 0; i < M; i++) {
		int a, b;
		scanf("%d %d", &a, &b);
		a--; b--;
		adj[a].push_back(b);
		adj[b].push_back(a);
	}
	int ak = 0;
	long long erg = 1;
	for (int i = 0; i < N; i++) {
		if (!vis[i]) {
			ak++;
			gr = 0;
			visit(i);
			erg = erg*gr%MOD;
		}
	}
	for (int i = 0; i < ak-2; i++)
		erg = erg*N%MOD;
	if (ak == 1)
		erg = 1%MOD;
	printf("%d\n", (int)erg);
	return 0;
}
