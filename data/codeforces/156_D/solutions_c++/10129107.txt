#include<bits/stdc++.h>
using namespace std;

const int N=100100;
int sz[N],p[N];

int f(int u){
    return u==p[u]?u:p[u]=f(p[u]);
}

int main(){
    int n,m,mod;
    scanf("%d%d%d",&n,&m,&mod);
    for(int i=1;i<=n;i++)p[i]=i;
    for(int i=0;i<m;i++){
        int x,y;
        scanf("%d%d",&x,&y);
        int fx=f(x),fy=f(y);
        if(fx!=fy)p[fx]=fy;
    }
    for(int i=1;i<=n;i++){
        int fx=f(i);
        sz[fx]++;
    }
    long long mul=1,tot=0;
    for(int i=1;i<=n;i++){
        if(sz[i])mul*=sz[i],mul%=mod,tot++;
    }
    if(1==tot){
        cout<<1%mod<<endl;
    }
    else{
        long long ret=1;
        for(int i=0;i<tot-2;i++){
            ret*=n;
            ret%=mod;
        }
        ret*=mul;ret%=mod;
        cout<<ret<<endl;
    }
    return 0;
}

 			 							 				 		 	 	 				 	