#include <iostream>
#include <stdio.h>
#include <algorithm>
#include <queue>
#include <map>
#include <string.h>

const long long N=100010;
const long long inf=0x3f3f3f3f;

using namespace std;

long long n,m,k;
long long p[N],cnt[N];

long long find(long long x)
{
	if(x!=p[x]) p[x]=find(p[x]);
	return p[x];
}

int main()
{
	scanf("%lld%lld%lld",&n,&m,&k);
	for(long long i=0;i<=n;i++)
		p[i]=i;
	for(long long i=0;i<m;i++)
	{
		long long a,b;
		scanf("%lld%lld",&a,&b);
		if(find(a)!=find(b))
			p[find(a)]=find(b);
	}
	for(long long i=1;i<=n;i++)
		cnt[find(i)]++;
	long long ret=1,c=0;
	for(long long i=1;i<=n;i++)
		if(cnt[i]) c++,ret*=cnt[i],ret%=k;
	for(long long i=2;i<c;i++)
		ret*=n,ret%=k;
	if(c>1)
		printf("%lld\n",ret%k);
	else
		printf("%lld\n",1%k);
	return 0;
}
