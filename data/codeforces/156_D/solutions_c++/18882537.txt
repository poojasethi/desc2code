#include<cstdio>
#include<cstdlib>
#include<cmath>
#include<cstring>
#include<iostream>
#include<algorithm>
using namespace std;

typedef long long int64;
int n,m,mod,pre[100005],size[100005],ans,c;
int find(int x) {
	return pre[x]==x?x:pre[x]=find(pre[x]);
}
int main() {
	scanf("%d%d%d",&n,&m,&mod);
	for (int i=1;i<=n;i++) {
		pre[i]=i;
		size[i]=1;
	}
	for (int i=1;i<=m;i++) {
		int u,v;
		scanf("%d%d",&u,&v);
		if (find(u)==find(v)) continue;
		size[find(u)]+=size[find(v)];
		pre[find(v)]=find(u);
	}
	ans=1;
	for (int i=1;i<=n;i++) if (pre[i]==i) {
		ans=(int64)ans*size[i]%mod;
		c++;
	}
	if (c==1) {
		printf("%d\n",1%mod);
		return 0;
	}
	for (int i=1;i<=c-2;i++) ans=(int64)ans*n%mod;
	printf("%d\n",ans);
	return 0;
}
