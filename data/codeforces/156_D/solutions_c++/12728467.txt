#include<stdio.h>
#include<stdlib.h>
#include<iostream>
using namespace std; 
typedef long long LL;
int fa[200000],num[200000]; 
int getfa(int x)
{
	if (fa[x]==x) return x; 
	else
	{
		 fa[x]=getfa(fa[x]); 
		 return fa[x]; 
	}
}
int main()
{
	int i,n,m,k,a,b; 
	//freopen("in.txt","r",stdin); 
	scanf("%d%d%d",&n,&m,&k); 
	for (i=1; i<=n; i++)
	{
	   fa[i]=i;
	   num[i]=1; 
    }
    for (i=1; i<=m; i++)
    {
    	cin>>a>>b; 
    	a=getfa(a);
	    b=getfa(b); 
    	if (a==b) continue; 
    	else
    	{
    		fa[a]=b; 
			num[b]+=num[a];  
    	}
    }
    LL ans=1 % k; 
    int c=0; 
    for (i=1; i<=n; i++) 
    {
      if (getfa(i)==i) 
	  {
	      ans=ans*num[i] % k; 
	      c++; 
	  }
    }
    for(i=1;i<=c-2; i++) 
	  ans=ans*n % k; 
	if (c==1) 
	{   
	    ans=1 % k; 
		cout<<ans<<endl; 
	}  else
	{
		cout<<ans<<endl; 
	}
	i=1; 
} 
 	 	  					 			   	 	  	  		  	