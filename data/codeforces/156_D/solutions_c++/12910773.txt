//求真立人跪涛爷
//这结论实在是太神了ORZ
//ans=πAi*n^(cnt-2)
//其中Ai为第i个连通块大小，cnt为连通块个数
#include<bits/stdc++.h>
#define N 100005
using namespace std;
int f[N],sum[N],ans,cnt,i,n,m,P,x,y;
int get(int u){return f[u]==u?u:f[u]=get(f[u]);}
int main()
{
    scanf("%d%d%d",&n,&m,&P);
    for (i=1;i<=n;i++) f[i]=i;
    for (i=1;i<=m;i++)
        scanf("%d%d",&x,&y),f[get(x)]=get(y);
    ans=1;cnt=0;for (i=1;i<=n;i++) ++sum[get(i)];
    for (i=1;i<=n;i++)
        if (get(i)==i)
            ans=1ll*ans*sum[i]%P,cnt++;
    if (cnt==1) return printf("%d\n",1%P),0;
    //已经联通的图原来是输出1的囧；在这里设P=1的trick有点凶 
    for (i=1;i<=cnt-2;i++)
        ans=1ll*ans*n%P;
    printf("%d\n",ans%P);
}