#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#define int64 long long
#define N 100010
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,K,x,y;
int f[N],s[N];
int64 an=1;
int get(int x) {
	return f[x]==x?x:f[x]=get(f[x]);
}
int main() {
	scanf("%d%d%d",&n,&m,&K);
	For(i,1,n) f[i]=i;
	For(i,1,m) {
		scanf("%d%d",&x,&y);
		f[get(x)]=get(y);
	}
	For(i,1,n) s[get(i)]++;
	k=0;
	For(i,1,n) if (get(i)==i) an=an*s[i]%K,k++;
	For(i,1,k-2) an=an*n%K;
	if (k==1) an=1;
	printf("%I64d\n",an%K);
	return 0;
}
