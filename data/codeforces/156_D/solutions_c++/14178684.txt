#include<cstdio>

int n,m,i,j,K,l,p,x,y;
int f[100010],s[100010];

int get(int i){return f[i]==i?i:f[i]=get(f[i]);}
int main()
{
	scanf("%d%d%d",&n,&m,&K);
	for(int i=1;i<=n;i++)f[i]=i;
	for(int i=1;i<=m;i++)
	{
		scanf("%d%d",&x,&y);
		f[get(x)]=get(y);
	}
	for(int i=1;i<=n;i++)s[get(i)]++;
	int ans=1;
	for(int i=1;i<=n;i++)if(s[i])p++,ans=1LL*ans*s[i]%K;
	for(int i=1;i<=p-2;i++)ans=1LL*ans*n%K;
	if(p==1)printf("%d\n",1%K);
	else printf("%d\n",int(ans));
	return 0;
}
