#include<iostream>
#include<cstdio>
#include<cstring>
using namespace std;
int too[300000],next[300000],head[300000],cp;
int cnt,n,m,k,s[200000],t,b[200000];
void makeedge(int x,int y)
{
	next[++cp]=head[x];head[x]=cp;too[cp]=y;
	next[++cp]=head[y];head[y]=cp;too[cp]=x;
}
void dfs(int u,int f)
{
	cnt++;b[u]=true;
	for (int pp=head[u];pp;pp=next[pp])
		if (b[too[pp]]==false)
		{
			dfs(too[pp],u);
		}
}
int main()
{
	scanf("%d%d%d",&n,&m,&k);
	for (int i=1;i<=m;++i)
	{
		int x,y;
		scanf("%d%d",&x,&y);
		makeedge(x,y);
	}
	memset(b,0,sizeof(b));
	for (int i=1;i<=n;++i)
		if (b[i]==false)
		{
			cnt=0;
			dfs(i,0);
			s[++t]=cnt;
		}
	if (t==1)
	{
		printf("%d\n",1%k);
		return 0;
	}
	long long ans=1;
	for (int i=1;i<=t;++i)
	{
		ans=ans*s[i]%k;
	}
	for (int i=1;i<t-1;++i)
		ans=ans*n %k;
	cout<<ans<<endl;
	return 0;
}
	  		  	  	  											 	 	