#include<iostream>
#include<cstdio>
#include<cstdlib>
#include<cstring>
#include<vector>
#include<set>
#include<map>
#include<utility>

using namespace std;
string s,t;
int a[30][30];
int n,m,k;
char output[100*1000+10];
void bad(){
	cout<<-1<<endl;
	exit(0);
}

int main(){
	for(int i=0;i<30;i++){
		for(int j=0;j<30;j++){
			a[i][j]=100*100;
			if(i==j){
				a[i][j]=0;
			}
		}
	}
	cin>>s>>t;
	cin>>n;
	long long out=0,w;
	{
		char x,y;
		for(int i=0;i<n;i++){
			cin>>x>>y>>w;
			if(a[x-'a'][y-'a']>w){
				a[x-'a'][y-'a']=w;
			}

		}
	}

	for(int k=0;k<26;k++){
		for(int i=0;i<26;i++){
			for(int j=0;j<26;j++){
				a[i][j]=min(a[i][j],a[i][k]+a[k][j]);
			}
		}
	}

	if(s.length()!=t.length()){
		bad();
	}
	for(int i=0;i<(int)s.length();i++){
		s[i]-='a';
		t[i]-='a';
		if(s[i]==t[i]){
			output[i]=s[i]+'a';
			continue;
		}
		int min=10000;
		char ch='a';
		for(int j=0;j<26;j++){
			if(a[(int)s[i]][j]+a[(int)t[i]][j]<min){
				min=a[(int)s[i]][j]+a[(int)t[i]][j];
				ch=char(j+'a');
			}
		}
		if(min==10000){
			bad();
		}
		out+=min;
		output[i]=ch;
	}
	cout<<out<<endl;	
	cout<<output<<endl;
	return 0;
}
