#include<iostream>
#include<cstdio>

using namespace std;

int main()
{
	int d[26][26];
	string s1,s2;
	cin>>s1>>s2;
	if(s1.size()!=s2.size())
	{
		puts("-1");
		return 0;
	}
	int n;
	scanf("%d",&n);
	for(int i=0;i<26;i++)
		for(int j=0;j<26;j++)
			d[i][j]=1<<28;
	char a[2],b[2];
	int aa,bb,ww;
	for(int i=0;i<26;i++)
		d[i][i]=0;
	for(int i=0;i<n;i++)
	{
		scanf("%s %s %d",a,b,&ww);
		aa=a[0]-'a';
		bb=b[0]-'a';
		d[aa][bb]=min(ww,d[aa][bb]);
	}
//	puts("ok");
	//floyd
	for(int k=0;k<26;k++)
		for(int i=0;i<26;i++)
			for(int j=0;j<26;j++)
				d[i][j]=min(d[i][j],d[i][k]+d[k][j]);
	int rpta=0;
	string rr;
	for(int i=0;i<s1.size();i++)
	{
		aa=s1[i]-'a';
		bb=s2[i]-'a';
		int asumar=1<<28,index;
		for(int k=0;k<26;k++)
		{
			if(d[aa][k]>=1<<28 or d[bb][k]>=1<<28)
				continue;
			if(d[aa][k]+d[bb][k]<asumar)
			{
				asumar=d[aa][k]+d[bb][k];
				index=k;
			}
		}
		if(asumar>=1<<28)
		{
			puts("-1");
			return 0;
		}
		rpta+=asumar;
		rr.push_back('a'+index);
	}
	printf("%d\n",rpta);
	cout<<rr<<endl;
}
