#include<iostream>
#define int long long
using namespace std;
const int inf=1e9;
string s,t;
int m;
int a[30][30];
 main()
{
	for(int i=0;i<30;i++)
	for(int j=0;j<30;j++)
	if(i!=j)
	a[i][j]=inf;
	cin>>s>>t>>m;
	if(s.size()!=t.size())
	{
		cout<<-1<<endl;
		return 0;
	}
	for(int i=0;i<m;i++)
	{
		char u,y;
		int w;
		cin>>u>>y>>w;
		a[u-'a'][y-'a']=min(a[u-'a'][y-'a'],w);
	}
	for(int k=0;k<26;k++)
	    for(int i=0;i<26;i++)
	        for(int j=0;j<26;j++)
				a[i][j]=min(a[i][j],a[i][k]+a[k][j]);
	string ans="";
	int sum=0;
    for(int i=0;i<s.size();i++)
	{
		int minn=1e9;
		int miin=0;
		for(int j=0;j<26;j++)
		{
			if(a[s[i]-'a'][j]+a[t[i]-'a'][j]<minn)
			{
				minn=a[s[i]-'a'][j]+a[t[i]-'a'][j];
				miin=j;
			}
		}
	//	cout<<minn<<endl;
		if(minn==1e9)
		{
			cout<<-1<<endl;
			return 0;
		}
		sum+=minn;
		ans+='a'+miin;

	}
	cout<<sum<<endl<<ans<<endl;
//	cin>>m;
}
