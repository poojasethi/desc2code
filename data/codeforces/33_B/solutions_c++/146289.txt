#include <iostream>
#include <cstdio>
#include <vector>
#include <algorithm>
#include <cmath>
#include <queue>
#include <set>
#include <map>
#include <string>
#include <cstring>
#define max_val 100000000
using namespace std;
char F[100010],S[100010];
int lf,ls;
int move[30][30];
int ANS;
int main(){
  int i,j,k,n;
  for(i=0;i<30;++i)
   for(j=0;j<30;++j)move[i][j]=max_val;
  //system("pause");
  scanf("%s",F);lf=strlen(F);
  scanf("%s",S);ls=strlen(S);
  if(lf!=ls){ANS=-1;goto end;}
  scanf("%d",&n);
  for(i=0;i<n;++i){
   char a,b;cin>>a>>b>>j;
   move[a-'a'][b-'a']=min(move[a-'a'][b-'a'],j);
                  }
  for(i=0;i<30;++i)move[i][i]=0;
  for(k=0;k<30;++k)
   for(i=0;i<30;++i)
    for(j=0;j<30;++j)
     move[i][j]=min(move[i][j],move[i][k]+move[k][j]);
  ANS=0;
  for(i=0;i<lf;++i){
   k=max_val;char E;
   for(char I='a';I<='z';++I){
    int ok=k;
    k=min(k,move[F[i]-'a'][I-'a']+move[S[i]-'a'][I-'a']);
    if(k!=ok)E=I;
                             }
   if(k>=max_val){ANS=-1;goto end;}
   ANS+=k;F[i]=E;
                   }
  end:printf("%d\n",ANS);
      if(ANS!=-1)printf("%s\n",F);
      //system("pause");
  return 0;
}
