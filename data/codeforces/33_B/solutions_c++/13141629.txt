#include<bits/stdc++.h>
using namespace std;
#define For(i,a,b) for(int i=a; i<=b; i++)
string s,t;
int a[130][130],n,c;
const int maxx=300000;
char u, v;
void floy()
{
   For(i,int('a'),int('z'))
   {
       For(j,int('a'),int('z'))
       {
           For(l,int ('a'),int('z'))
           a[j][l]=min (a[j][l],a[j][i]+a[i][l]);
       }
   }
}
int main()
{
    cin>>s>>t;
    cin>>n;
    For(i,int('a'),int('z'))
    For(j,int('a'),int('z'))
    if (i!=j) a[i][j]=maxx;else a[i][j]=0;
    For(i,1,n)
    {
        cin>>u>>v>>c;
         a[int (u)][int(v)]=min(a[int (u)][int(v)],c);

    }


    floy();
    if(s.size()!=t.size()) {cout<<-1; return 0;}
    int phi=0; string kq;
    For(i,0,t.size()-1)
    {
        u=s[i]; v=t[i]; int tam=maxx; char chrt;
        for(char j='a'; j<='z'; j++)
        {
             if (a[int(u)][int(j)]+a[int(v)][int(j)]<=tam) {tam=a[int(u)][j]+a[int(v)][j]; chrt=j;}
        }
        if (tam>=maxx) {cout<<-1; return 0;}
        else {phi+=tam; kq+=chrt;}
    }
    cout<<phi<<"\n";
    cout<<kq;

}

				 		 	  		 				 	 		 	  			