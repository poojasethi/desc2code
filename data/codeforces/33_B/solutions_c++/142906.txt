#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <string>

#define ll long long
#define chr(a) ((a)-'a')

const int INF = 100*1000*1000;

using namespace std;

string s1, s2;
ll ans=0;
string res;
int reb[100][100];

int main() {
	int n=chr('z')+1;
	for (int i=0; i<n; ++i)
		for (int j=0; j<n; ++j)
			if (i!=j) reb[i][j]=INF;

	cin >> s1 >> s2;
	int z=0; 
	cin >> z;
	if (s1.length()!=s2.length()) { printf("-1\n"); return 0; }
	
	for (int i=0; i<z; ++i) {
		string a, b; int w; cin >> a >> b >> w;
		int & t = reb[chr(a[0])][chr(b[0])];
		t = min(t, w);
	}

	for (int k=0; k<n; ++k)
		for (int i=0; i<n; ++i)
			for (int j=0; j<n; ++j) {
				if ( reb[i][j] > (reb[i][k]+reb[k][j]) )
					reb[i][j] = reb[i][k] + reb[k][j];
			}

	int ln = s1.length();
	for (int i=0; i<ln; ++i) {
		char a = 0;
		int t = INF;
		int c1=chr(s1[i]);
		int c2=chr(s2[i]);
		
		for (int j=0; j<n; ++j) {
			int p = reb[c1][j] + reb[c2][j];
			if (p<t) {t=p; a = j+'a';}
		}

		if (t>=INF) { printf("-1\n"); return 0;}
		res += a;
		ans += t;
	}

	cout << ans << "\n" << res << "\n";
	return 0;
}
