#include <iostream>
#include <vector>
#include <cstring>
using namespace std;

int main(){
	int i,j,k,ans;
	int n,x,y,z;
	string s1,s2;
	char c1,c2;
	int a[30][30];
	
	for(i=0;i<30;i++){
		for(j=0;j<30;j++)
			a[i][j] = 1000000;
		a[i][i] = 0;
	}
	cin>>s1>>s2;
	
	cin>>n;
	for(i=0;i<n;i++){
		cin>>c1>>c2>>k;
		x = (c1 - 97); y = (c2 - 97);
		a[x][y] = min(a[x][y],k);
	}
	for(k=0;k<26;k++){
		for(i=0;i<26;i++){
			for(j=0;j<26;j++)
				a[i][j] = min(a[i][j],a[i][k]+a[k][j]);
		}
	}
	
	if(s1.size() != s2.size())
		cout<<-1<<endl;
	else{
		ans = 0;
		for(i=0;i<s1.size();i++){
			x = s1[i]-97;
			y = s2[i]-97;
			
			k = -1;
			for(j=0;j<26;j++){
				if(a[x][j] != 1000000 && a[y][j] != 1000000){
					if(k == -1 || a[x][j]+a[y][j]<z){
						k = j;
						z = a[x][j] + a[y][j];
					}
				}
			}
			if(k == -1){
				cout<<-1<<endl;
				return 0;
			}
			ans += z;
			s1[i] = char(k+97);				
		}
		cout<<ans<<endl;
		cout<<s1<<endl;
	}
	return 0;
}