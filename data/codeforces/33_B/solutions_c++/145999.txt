#include<iostream>
#include<string>
using namespace std;

#define REP(i,a,b) for(i=a; i<b; ++i)
#define rep(i,n) REP(i,0,n)

int dist[26][26];
const int inf = 1000000;

int main() {
  int i,j,k;
  rep(i,26) {
    rep(j,26) dist[i][j] = inf;
    dist[i][i] = 0;
  }

  int n,w,ans = 0;
  string s,t,u,v,a;
  cin>>s>>t;

  cin>>n;
  rep(i,n) {
    cin>>u>>v>>w;
    dist[u.at(0)-'a'][v.at(0)-'a'] = min(w, dist[u.at(0)-'a'][v.at(0)-'a']);
  }

  if(s.length() != t.length()) {
    cout<<-1<<endl;
    goto END;
  }

  rep(k,26) rep(i,26) rep(j,26)
    dist[i][j] = min(dist[i][k]+dist[k][j], dist[i][j]);

  rep(i,s.length()) {
    if(s.at(i) != t.at(i)) {
      int st = dist[s.at(i)-'a'][t.at(i)-'a'];
      int ts = dist[t.at(i)-'a'][s.at(i)-'a'];

      int tans = 1000000;
      char tm = s.at(i);
      for(j=0; j<26; ++j) {
	if(tans > dist[s.at(i)-'a'][j]+dist[t.at(i)-'a'][j]) {
	  tm = j+'a';
	  tans = dist[s.at(i)-'a'][j]+dist[t.at(i)-'a'][j];
	}
      }

      if(tans == 1000000) {
	cout<<-1<<endl;
	goto END;
      }

      ans += tans;
      s.at(i) = tm;
    }
  }

    cout<<ans<<endl;
    cout<<s<<endl;
 END:
  ;
}
