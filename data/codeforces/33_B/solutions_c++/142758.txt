#include<iostream>
#include<cstdio>
#include<algorithm>
#include<cstring>

using namespace std;

#define INF 100000000

char s1[100001],s2[100001],ans[100001];
int d[26][26];


int main()
{
	scanf("%s%s",s1,s2);
	if (strlen(s1)!=strlen(s2)) { printf("-1\n");return 0; }
	int n;
	scanf("%d",&n);
	for(int i=0;i<26;i++) for(int j=0;j<26;j++) d[i][j] = INF;
	for(int i=0;i<26;i++) d[i][i] = 0;
	for(int i=0;i<n;i++)
	{
		char c1,c2;
		int v;
		scanf("\n%c %c %d",&c1,&c2,&v);
		d[c1-'a'][c2-'a']=min(d[c1-'a'][c2-'a'],v);
	}

	n = 26;
	for(int k=0;k<n;k++)
		for(int i=0;i<n;i++)
			for(int j=0;j<n;j++)
				if (d[i][k]<INF&&d[k][j]<INF&&d[i][k]+d[k][j]<d[i][j])
					d[i][j]=d[i][k]+d[k][j];
	int sum = 0;
	for(int i=0;s1[i];i++)
	{
		if (s1[i]==s2[i]) { ans[i] = s1[i]; continue; }
		else
		{
			int c1 = s1[i]-'a',c2 = s2[i]-'a';

			int s = INF;
			for(int x = 0;x<26;x++)
			{
				if (d[c1][x]+d[c2][x]<s) { s = d[c1][x]+d[c2][x]; ans[i] = x+'a'; }
			}
			if (s==INF)
			{
				printf("-1\n");
				return 0;
			}
			else sum+=s;
		}
	}
	printf("%d\n%s\n",sum,ans);	

	return 0;
}