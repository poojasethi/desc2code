#include <iostream>
#include <string>
using namespace std;

int main()
{
	string s, t;
	int n;
	cin >> s >> t >> n;
	
	int g[256][256];
	for (int i = 0; i < 256; ++i)
	{
		for (int j = 0; j < 256; ++j)
			g[i][j] = 1000000;
		g[i][i] = 0;
	}
	for (int i = 0; i < n; ++i)
	{
		char a, b; int len;
		cin >> a >> b >> len;
		g[a][b] = min(g[a][b], len);
	}
	for (int k = 'a'; k <= 'z'; ++k)
		for (int i = 'a'; i <= 'z'; ++i)
			for (int j = 'a'; j <= 'z'; ++j)
				g[i][j] = min(g[i][j], g[i][k] + g[k][j]);

	int best[256][256];
	char go[256][256];
	for (int i = 'a'; i <= 'z'; ++i)
		for (int j = 'a'; j <= 'z'; ++j)
		{
			best[i][j] = 2000000;
			for (int k = 'a'; k <= 'z'; ++k)
				if (g[i][k] + g[j][k] < best[i][j])
				{
					best[i][j] = g[i][k] + g[j][k];
					go[i][j] = k;
				}
		}

	int ans = 0;
	int len = s.length();
	string str = s;
	if (len != t.length())
		ans = -1;
	else
		for (int i = 0; i < len; ++i)
			if (best[s[i]][t[i]] >= 1000000)
			{
				ans = -1;
				break;
			}
			else
			{
				ans += best[s[i]][t[i]];
				str[i] = go[s[i]][t[i]];
			}

	cout << ans << '\n';
	if (ans != -1)
		cout << str << '\n';

	return 0;
}