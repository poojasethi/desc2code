#include <bits/stdc++.h>
using namespace std;

char S[1000001], T[1000001];
char ans[1000001];

int cost[100][100];

int main() {
	///freopen("2.in", "r", stdin);
	scanf("%s %s", S, T);
	int n;
	scanf("%d", &n);
	for(int i = 0; i < 26; i ++) for(int j = 0; j < 26; j ++) {
		if(i == j) cost[i][j] = 0;
		else cost[i][j] = 1e9;
	}
	for(int i = 0; i < n; i ++) {
        char s[10], ss[10];
		int x;
		scanf("%s %s %d", s, ss, &x);
        cost[s[0] - 'a'][ss[0] - 'a'] = min(cost[s[0]-'a'][ss[0]-'a'], x);
	}
    for(int k = 0; k < 26; k ++) for(int i = 0; i < 26; i ++) for(int j = 0; j < 26; j ++) cost[i][j] = min(cost[i][j], cost[i][k] + cost[k][j]);
    int m = strlen(S);
    int mm = strlen(T);
    if(m != mm) return puts("-1");
    int tot = 0;
    for(int i = 0; i < m; i ++) {
        int mi = 1e9, y = -1;
        for(int j = 0; j < 26; j ++) {
        	int x = cost[S[i]-'a'][j] + cost[T[i]-'a'][j];
            if(x < mi) mi = x, y = j;
        }
        if(mi >= 1e9) return puts("-1");
        tot += mi;
        ans[i] = 'a' + y;
    }
    cout << tot << endl;
    ans[m] = 0;
    cout << ans << endl;
}
