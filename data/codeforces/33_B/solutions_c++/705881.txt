#include <stdio.h>
#include <string.h>

int a[128][128];
char A[100005], B[100005];
int main(void) {
	scanf("%s%s", A, B);
	memset(a,-1,sizeof(a));
	if(strlen(A)!=strlen(B)) { puts("-1"); return 0;}
	int n;
	scanf("%d", &n);
	for(int i=0;i<n;i++) {
		char x[4], y[4];
		int z;
		scanf("%s%s%d", x, y, &z);
		if(a[x[0]][y[0]] == -1 || a[x[0]][y[0]] > z)
		a[x[0]][y[0]] = z;
	}
	for(int i='a';i<='z';i++)
		a[i][i] = 0;
	for(int k='a';k<='z';k++)
		for(int i='a';i<='z';i++)
			for(int j='a';j<='z';j++)
				if(a[i][k]>=0&&a[k][j]>=0&&(a[i][j]==-1||a[i][j]>a[i][k]+a[k][j]))
					a[i][j]=a[i][k]+a[k][j];
	int ans=0;
	for(int i=0;A[i];i++) {
		if(A[i]==B[i]) continue;
		int v=-1;
		char c='a';
		for(int j='a';j<='z';j++) {
			if(a[A[i]][j]>=0 && a[B[i]][j]>=0 && (v==-1||v>a[A[i]][j]+a[B[i]][j])) {
				v=a[A[i]][j]+a[B[i]][j];
				c=j;
			}
		}
		if(v==-1) {puts("-1"); return 0;}
		A[i] = c;
		ans += v;
	}
	printf("%d\n", ans);
	printf("%s\n", A);
	return 0;
}
