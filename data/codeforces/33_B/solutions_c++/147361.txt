#include <iostream>
#include <string>
#include <algorithm>

using namespace std;

int t[256][256];

int main()
{
	string a, b;
	cin >> a >> b;
	
	if( a.size() != b.size() )
	{
		cout << -1 << endl;
		return 0;
	}
	
	int q;
	cin >> q;
	
	for( int i = 'a'; i <= 'z'; ++i )
	for( int j = 'a'; j <= 'z'; ++j )
		t[i][j] = (i!=j)<<20;
	
	string fr, to;
	int c;
	
	for( int i = 0; i != q; ++i )
	{
		cin >> fr >> to >> c;
		t[fr[0]][to[0]] = min(t[fr[0]][to[0]], c);
	}
	
	for( int k = 'a'; k <= 'z'; ++k )
	for( int i = 'a'; i <= 'z'; ++i )
	for( int j = 'a'; j <= 'z'; ++j )
		t[i][j] = min(t[i][j], t[i][k] + t[k][j]);
		
	int rv = 0;
	for( int i = 0, l = a.size(); i != l; ++i )
	{
		int m = 1<<20;
		char x;
		for( int c = 'a'; c <= 'z'; ++c )
		{
			int q = t[a[i]][c] + t[b[i]][c];
			if( q < m )
			{
				m = q;
				x = c;
			}
		}
		if( m == (1<<20) )
		{
			rv = -1;
			break;
		}
		rv += m;
		a[i] = x;
	}
	
	cout << rv << endl;
	if( rv != -1 )
		cout << a << endl;
	return 0;
}