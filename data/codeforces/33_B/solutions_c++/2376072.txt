#include <iostream>
#include <cstdlib>
#include <string>
#include <vector>
#define int long long
#define INF 2000000000

using namespace std;

//ifstream cin("input.txt");
//ofstream cout("output.txt");

vector <vector <int> > g;

void floyd(int n)
{
	int k, i, j;

	for (k = 0; k < n; k++)
		for (i = 0; i < n; i++)
			for (j = 0; j < n; j++)
			    g[i][j] = min(g[i][j], g[i][k] + g[k][j]);
}

main()
{
	string a, b, res;
	int n, w, i, counter = 0, now, j;
	char c1, c2, c;
	const int k = 26;
	cin >> a >> b >> n;
	g.resize(k, vector <int>(k, INF));

	for (i = 0; i < k; i++)
		g[i][i] = 0;

	for (i = 0; i < n; i++)
	{
		cin >> c1 >> c2 >> w;
		c1 -= 'a', c2 -= 'a';
		g[c1][c2] = min(g[c1][c2], w);
	}
	floyd(k);

	if (a.size() == b.size())
	{
		for (i = 0; i < a.size(); i++)
		{
			now = INF, c1 = a[i] - 'a', c2 = b[i] - 'a';

			for (j = 0; j < k; j++)
			    if (g[c1][j] + g[c2][j] < now)
				{
					now = g[c1][j] + g[c2][j];
					c = 'a' + j;
				}
			res += c, counter += now;
		}

		if (counter < INF)
			cout << counter << endl << res << endl;
		else
			cout << -1 << endl;
	}
	else
		cout << -1 << endl;
}
