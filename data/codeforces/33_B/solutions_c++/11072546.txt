#include <bits/stdc++.h>
using namespace std;
string s1,s2;
int len1, len2;
int n;
#define fi first
#define se second
#define mp make_pair
#define pb push_back
typedef pair<int,int> pii;
vector<pii> ve[26]; 
int ar[26][26];
string hasil;
int total = 0;
int main()
{
	cin>>s1;
	cin>>s2;
	len1 = s1.length();
	len2 = s2.length();
	if(len1 ^ len2)
	{
		puts("-1");
		return 0;
	}
	for(int i=0;i<26;i++) for(int j=0;j<26;j++)
	{
		if(i^j) ar[i][j] = 1000000000;
	}
	scanf("%d", &n);
	for(int i=0;i<n;i++)
	{
		char a,b;
		int x;
		cin>>a>>b>>x;
		ar[a-'a'][b-'a'] = min(ar[a-'a'][b-'a'],x);
	}
	//BIKIN SHORTEST PATHNYA
	for(int k=0;k<26;k++)
	{
		for(int i=0;i<26;i++)
		{
			for(int j=0;j<26;j++)
			{
				ar[i][j] = min(ar[i][j],ar[i][k] + ar[k][j]);
			}
		}
	}
	for(int i=0;i<len1;i++)
	{
		int ch1 = s1[i] - 'a';
		int ch2 = s2[i] - 'a';
		int temp = -1;
		int mini = 1000000000;
		for(int j=0;j<26;j++)
		{
			if(mini > ar[ch1][j] + ar[ch2][j])
			{
				mini = ar[ch1][j] + ar[ch2][j];
				temp = j;
			}
		}
		if(temp == -1) 
		{
			puts("-1");
			return 0;
		}
		total += mini;
		hasil+=(temp+'a');
	}
	printf("%d\n", total);
	puts(hasil.c_str());
	return 0;
}
