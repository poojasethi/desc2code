//In the Name of God
#include<iostream>
#include<conio.h>
#include<vector>

using namespace std;

const int maxn=110,inf=100000000100;
long long w[30][30][30];
long long ans,d,p,n;
string s,t,x,y,ret;

int main()
{
  for(int i=0;i<30;i++)
    for(int j=0;j<30;j++)
      {
	w[0][i][j]=inf;
	if(i==j)
	  w[0][i][j]=0;
      }
  cin>>s>>t;
  ret=s;
  cin>>n;
  for(int i=0;i<n;i++)
    {
      cin>>x>>y;
      cin>>d;
      if(w[0][x[0]-'a'][y[0]-'a']>d)
      w[0][x[0]-'a'][y[0]-'a']=d;
    }
    if(s.size()!=t.size())
      {
        cout<<-1<<endl;
	// getch();
        return 0;
      }
  for(int k=1;k<=26;k++)
    for(int i=0;i<26;i++)
      for(int j=0;j<26;j++)
	w[k][i][j]=min(w[k-1][i][k-1]+w[k-1][k-1][j],w[k-1][i][j]);
  for(int i=0;i<s.size();i++)
    {
      p=inf;
      for(int j=0;j<26;j++)
	if(w[26][s[i]-'a'][j]+w[26][t[i]-'a'][j]<p)
	  {
	    p=w[26][s[i]-'a'][j]+w[26][t[i]-'a'][j];
	    ret[i]=(char)(j+'a');
	  }
      ans+=p;
    }
  if(ans>=inf)
    cout<<-1<<endl;
  else
    {
      cout<<ans<<endl;
      cout<<ret<<endl;
    }
  // getch();
  return 0;
}
