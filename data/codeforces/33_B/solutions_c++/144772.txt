#include <iostream>
#include <cstdio>

#define INF 1000000000

using namespace std;

int main() {
	//freopen("input.txt", "r", stdin);
	string x, y;
	cin >> x;
	cin >> y;
	if (x.size() != y.size()) {
		cout << -1;
		return 0;
	}
	int n;
	cin >> n;
	int c[26][26];
	for (int i = 0; i < 26; i++)
		for (int j = 0; j < 26; j++)
			c[i][j] = INF;
	for (int i = 0; i < n; i++) {
		char u, v;
		int w;
		cin >> u >> v >> w;
		int i = (int) (u - 'a');
		int j = (int) (v - 'a');
		if (c[i][j] > w)
			c[i][j] = w;
	}
	for (int k = 0; k < 26; k++)
		for (int i = 0; i < 26; i++)
			for (int j = 0; j < 26; j++)
				if (c[i][j] > c[i][k] + c[k][j])
					c[i][j] = c[i][k] + c[k][j];
	for (int i = 0; i < 26; i++)
		c[i][i] = 0;
	int r = 0;
	string s;
	for (int i = 0; i < (int) x.size(); i++) {
		int l = INF;
		int k = -1;
		for (int j = 0; j < 26; j++)
			if (l > c[x[i] - 'a'][j] + c[y[i] - 'a'][j]) {
				l = c[x[i] - 'a'][j] + c[y[i] - 'a'][j];
				k = j;
			}
		if (k == -1) {
			cout << -1;
			return 0;
		}
		r += l;
		s += (char) (k + 'a');
	}
	cout << r << endl << s;
	return 0;
}
