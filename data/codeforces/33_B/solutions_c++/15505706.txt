#include <iostream>
#include <cstring>
using namespace std;

int w[128][128];
int inf = 300000000;

char a[120000], b[120000], rr[120000];
int main ()
{
  for (int i = 0; i < 128; ++i)
    for (int j = 0; j < 128; ++j) w[i][j] = inf;
  for (int i = 0; i < 128; ++i) w[i][i] = 0;
  
  cin >> a >> b;
  int l = strlen (a); if (strlen(b) != l) { cout << "-1\n"; return 0; }
  
  int n; cin >> n;
  
  char p, q; int r;
  for (int i = 0; i < n; ++i)
  {
    cin >> p >> q >> r;
    if (w[p][q] > r) w[p][q] = r;
  }
  
  for (int k = 'a'; k <= 'z'; ++k)
    for (int i = 'a'; i <= 'z'; ++i)
      for (int j = 'a'; j <= 'z'; ++j)
	if (w[i][j] > w[i][k] + w[k][j]) w[i][j] = w[i][k] + w[k][j];
  
  int res = 0;
  for (int i = 0; i < l; ++i)
  {
    int min = inf;
    for (int j = 'a'; j <= 'z'; ++j) if (min > w[a[i]][j] + w[b[i]][j])
      { min = w[a[i]][j] + w[b[i]][j]; rr[i] = j; }
    if (min >= inf) { cout << "-1\n"; return 0; }
    res += min;
  }
  
  rr[l] = '\0';
  cout << res << endl << rr << endl;
  return 0;
}
 	   	 					 	 	 						  		 	 	