#include <iostream>
#include<string>
#define inf 100000
using namespace std;
int m,c[30][30],n;
string x,y,z;
int main()
{int i,j,k;
  getline(cin,x);
  getline(cin,y);
  cin>>m;
  char c1,c2;
  int cost;
  for(i=0;i<=25;++i)
   for(j=0;j<=25;++j)
    c[i][j]=inf;
  for(i=0;i<=25;++i)
   c[i][i]=0;
   for(i=1;i<=m;++i)
    {cin>>c1>>c2;
     cin>>cost;
     c[c1-'a'][c2-'a']=min(c[c1-'a'][c2-'a'],cost);
    }

   for(k=0;k<=25;++k)
    for(i=0;i<=25;++i)
     for(j=0;j<=25;++j)
      c[i][j]=min(c[i][j],c[i][k]+c[k][j]);
  int sw=1,mn,n=x.size(),s=0;
  if(n!=y.size())
   sw=0;
   for(i=0;i<n&&sw;++i)
    if(x[i]!=y[i])
     {mn=inf;
      sw=0;
        for(k=0;k<=25;++k)
         if(c[x[i]-'a'][k]+c[y[i]-'a'][k]<mn)
          {sw=1;mn=c[x[i]-'a'][k]+c[y[i]-'a'][k];c1=k;}
          x[i]=c1+'a';
     s+=mn;
     }
     if(sw)
     {
        cout<<s<<'\n';
        cout<<x<<'\n';
     }
     else
     cout<<-1<<'\n';


  return 0;
}
