# include <iostream>
# include <cstdio>
# include <cstring>
using namespace std;

char a[200000], b[200000], Ans[200000], c1[10], c2[10];
int n, m, w, g[30][30]; bool flag = false;

inline int calc(char a,char b,int k)
{
	int res = 0x7fffffff;
	a -= 'a'; b -= 'a';
	for(int i=0; i<26; i++)
		res = min(res , g[a][i] + g[b][i]);
	for(int i=0; i<26; i++)
		if(g[a][i] + g[b][i] == res) {
			Ans[k]=i+'a'; break; 
		}
	if(res>1000) flag = true;
	return res;
}

int main()
{
	scanf("%s%s", a, b);  n = strlen(a);
	if(strlen(b)!=n) { puts("-1"); return 0;}
	
	int N = 26;
	for(int i=0; i<N; i++)
		for(int j=0; j<N; j++) 
			if(i!=j) g[i][j]=0x3fffffff;
			
	scanf("%d", &m);
	for(int i=0; i<m; i++)
	{
		scanf("%s%s%d", c1, c2, &w);
		g[c1[0]-'a'][c2[0]-'a']=min(g[c1[0]-'a'][c2[0]-'a'],w);
	}
	
	for(int k=0; k<N; k++)
		for(int i=0; i<N; i++)
			for(int j=0; j<N; j++)
				if(g[i][k]+g[k][j]<g[i][j]) g[i][j]=g[i][k]+g[k][j];
	
	int ans = 0;
	for(int i=0; i<n; i++) 
		ans += calc(a[i], b[i], i);
		
	if(flag) puts("-1"); else 	
	printf("%d\n%s\n", ans, Ans);
	//while(1);
}

 	 	  			 			    		  	