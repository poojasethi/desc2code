#include<stdio.h>
#include<string.h>
#include<queue>

using namespace std;
char x[100005],  y[100005],  z[100005];
int mat[30][30];
queue  <int>  q;

int main()
{
  int n,  m,  k,  i,  j,  nr=0,  w,  min;
  char a,  b;
  gets(x);
  gets(y);
  n=strlen(x);
  m=strlen(y);
  scanf("%d",  &k);
  for(i=1;  i<=28;  i++)
	for(j=1;  j<=28;  j++)
	  if(i!=j)
		mat[i][j]  =  5000;
  for(i=1;  i<=k;  i++)
  {
	scanf("\n%c ",&a);
	scanf("%c",&b);
	scanf("%d",&w);
	if(mat[a-'a'+1][b-'a'+1]  >  w)
	  mat[a-'a'+1][b-'a'+1]  =  w;
  }
  for(i=1;  i<=27;  i++)
	for(j=1;  j<=27;  j++)
	  for(k=1;  k<=27;  k++)
		if(mat[j][i]+mat[i][k]<mat[j][k])
		  mat[j][k]=mat[j][i]+mat[i][k];
  if(n  !=  m)
  {
	printf("-1");
	return 0;
  }
  for(i=1;  i<=n;  i++)
  {
	min  =  5000;
	for(j=1;  j<=26;  j++)
	  if(mat[x[i-1]-'a'+1][j]  +  mat[y[i-1]-'a'+1][j]  <  min)
	  {
	    min  =  mat[x[i-1]-'a'+1][j]  +  mat[y[i-1]-'a'+1][j];
		z[i]=j+'a'-1;
	  }
	if(min  ==  5000)
	{
	  printf("-1");
	  return 0;
	}
	nr  +=  min;
  }
  printf("%d\n",nr);
  for(i=1;i<=n;i++)
	printf("%c",z[i]);
  return 0;
}

				 		 	        		 				  	 	