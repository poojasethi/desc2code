#include<iostream>
#include<cstdio>
#include<cstring>
#include<cmath>
#include<algorithm>

using namespace std;
const int N=100005;
int f[N],c[N];

int father(int p)
{
    if (f[p]==p) return p; else return f[p]=father(f[p]);
}

bool lucky(int x)
{
    while (x>0)
    {
        if (x%10!=4 && x%10!=7) return false;
        x/=10;
    }
    return true;
}

int main()
{
    int i,n,x,y,w;
    scanf("%d",&n);
    for (i=1; i<=n; i++) {f[i]=i; c[i]=1;}
    for (i=1; i<n; i++)
    {
        scanf("%d%d%d",&x,&y,&w);
        if (!lucky(w))
        {
            x=father(x); y=father(y);
            f[x]=y; c[y]+=c[x]; c[x]=0;
        }
    }
    long long ans=0;
    for (i=1; i<=n; i++)
    ans+=(long long )c[i]*(n-c[i])*(n-c[i]-1);
    cout<<ans<<endl;
}


