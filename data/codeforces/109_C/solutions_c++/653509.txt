#include <vector>
#include <iostream>
#include <algorithm>
#include <cstdio>
using namespace std;

const int N = 100003;
int n, j, k, l, p[N], sz[N];

int main()
{
	cin>>n;
	for(int i = 1; i <= n; i ++) sz[i] = 1;
	for(int i = 1; i < n; i ++)
	{
		scanf("%d %d %d", &j, &k, &l);
		while(l != 0)
		{
			if(l % 10 == 4 || l % 10 == 7) l /= 10;
			else break;
		}
		if(l)
		{
			while(p[j] != 0) j = p[j];
			while(p[k] != 0) k = p[k];
			if(sz[j] < sz[k]) swap(j, k);
			p[k] = j;
			sz[j] += sz[k];
			sz[k] = 0;
		}
	}
	long long ans = n;
	ans *= n - 1; ans *= n - 2;
	for(int i = 1; i <= n; i ++)
		if(sz[i])
		{
			long long r = sz[i];
			long long b = 2 * (r - 1) * (n - 2) - (r - 1) * (r - 2);
			ans -= r * b;
		}
	cout<<ans<<endl;


	return 0;
}
