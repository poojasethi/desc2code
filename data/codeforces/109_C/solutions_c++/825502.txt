#include<iostream>

using namespace std;

int g[100001]={},f[100001]={};

bool islucky(int n)
{
	while(n>0)
	{
		if(n%10 != 4 && n%10 != 7)	return false;
		n /= 10;
	}
	return true;
}

int find(int n)
{
	return f[n] == n ? n : (f[n] = find(f[n]));
}

int main()
{
	int u,v,w;
	long long ans = 0,le = 0 , g1,n;

	cin>>n;

	for(int i = 1 ; i <= n ; ++i )	
	{
		g[i] = 1;
		f[i] = i;
	}

	for(int i = 0 ; i < n-1 ; ++i )
	{
		cin>>u>>v>>w;

		if(!islucky(w))
		{
			g[find(v)] += g[find(u)];
			g[find(u)] = 0;
			f[find(u)] = find(v);
			
		}
	}

	ans = n * (n-1) * (n-2);

	for(int i = 1 ; i <= n ; ++i )
	{
//		cout<<g[i] <<' '<<f[i]<<endl;
		if(g[i] > 1 )
		{
			g1 = g[i];

			ans -= g1*(g1-1)*(g1-2) + g1*(g1-1)*(n-g1)*2;
		}
	}

	cout<<ans<<endl;
}
