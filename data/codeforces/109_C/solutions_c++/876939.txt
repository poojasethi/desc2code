#include <cstdio>
#include <cstring>
#include <iostream>

using namespace std ;

const int N = 100010 ;

int n ;
int p[N], s[N] ;

bool check (int x)
{
    while (x)
    {
        if (x % 10 != 4 && x % 10 != 7) return 0 ;
        x /= 10 ;
    }
    return 1 ;
}

int find (int x)
{
    if (p[x] != x) p[x] = find (p[x]) ;
    return p[x] ;
}

int main ()
{
    scanf ("%d", &n) ;
    for (int i = 1; i <= n; i ++ ) p[i] = i, s[i] = 1 ;
    for (int i = 1, a, b, c; i < n; i ++ )
    {
        scanf ("%d%d%d", &a, &b, &c) ;
        if (!check (c)) s[find (a)] += s[find (b)], p[find (b)] = find (a) ;
    }
    long long res = 0 ;
    for (int i = 1; i <= n; i ++ ) res += (n - s[find (i)]) * (n - s[find (i)] - 1ll) ;
    printf ("%I64d\n", res) ;
    return 0 ;
}
