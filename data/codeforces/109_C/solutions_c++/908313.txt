#include <iostream>
#include <vector>

using namespace std;

bool eslucky(int x)
{
  while (x>0) {
    if (x%10!=4 and x%10!=7) return false;
    x/=10;
  }
  return true;
}

typedef long long int lint;

int main()
{
  int n;
  cin>>n;
  vector<int> padre(n,-1);
  for (int i=0;i<n-1;i++) {
    int u,v,w;
    cin>>u>>v>>w;
    if (not eslucky(w)) {
      u--;v--;
      while (padre[u]>=0) u=padre[u];
      while (padre[v]>=0) v=padre[v];
      if (padre[u]<padre[v]) {
	padre[u]+=padre[v];
	padre[v]=u;
      } else {
	padre[v]+=padre[u];
	padre[u]=v;
      }
    }
  }
  lint sol=0;
  for (int i=0;i<n;i++) {
    int u=i;
    while (padre[u]>=0) u=padre[u];
    lint c=n+padre[u];
    sol+=(c*(c-1));
  }
  cout<<sol<<endl;
}

