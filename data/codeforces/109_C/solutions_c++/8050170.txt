#include<iostream>

using namespace std ;

const int maxn=1e5+5 ;
int par[maxn] , ch[maxn] ;
bool f ;
int n ;
long long ans=0 ;

int get_par(int x)
{
	return par[x]==x ? x : par[x]=get_par(par[x]) ;
}

int main()
{
	ios_base::sync_with_stdio(0) ;
	cin >> n ;
	for(int i=1 ; i<=n ; i++)
	{
		par[i]=i ;
		ch[i]=1 ;
	}
	for(int i=1 ; i<n ; i++)
	{
		int u , v , w ;
		cin >> v >> u >> w ;
		u=get_par(u) , v=get_par(v) ;
		f=(w>0) ? 1 : 0 ;
		for( ; w>0 ; w/=10) 
			if(w%10!=4 && w%10!=7)
				f=0 ;
		if(f)
			continue ;
		else
		{
			par[u]=v ;
			ch[v]+=ch[u] ;
		} 
	}
	for(int i=1 ; i<=n ; i++)
		ans+=(long long)(n-ch[get_par(i)])*(n-ch[get_par(i)]-1) ;
	cout << ans << endl ;
	return 0 ;
}

