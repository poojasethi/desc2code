#include <cstdio>
#include <cstdlib>
#include <cstring>
#include <algorithm>
using namespace std;

const int N=(int)1e5+5,K=60;
int n,q,L,R,D;

struct data{
	int v[60];
} res,tmp,t[N*4];

void update(data &c,data &a,data &b){
	for(int j=0;j<K;j++)
		c.v[j]=a.v[j]+b.v[(j+a.v[j])%K];
}

void modify(int cur,int beg,int end){
	if(end-beg==1){
		for(int j=0;j<K;j++){
			if(j%D==0)
				t[cur].v[j]=2;
			else
				t[cur].v[j]=1;
		}
		return;
	}
	int mid=beg+end>>1;
	if(L<=mid)
		modify(cur<<1,beg,mid);
	else
		modify(cur<<1|1,mid,end);
	update(t[cur],t[cur<<1],t[cur<<1|1]);
}
void query(int cur,int beg,int end){
	if(R<=beg||L>=end) return;
	if(L<=beg&&R>=end){
		tmp=res;
		update(res,tmp,t[cur]);
		return;
	}
	int mid=beg+end>>1;
	query(cur<<1,beg,mid);
	query(cur<<1|1,mid,end);
}

int main(){
	scanf("%d",&n);
	for(int i=1;i<=n;i++){
		scanf("%d",&D);
		L=i;
		modify(1,0,n);
	}
	scanf("%d",&q);
	while(q--){
		char c;
		while((c=getchar())!='A'&&c!='C');
		if(c=='A'){
			scanf("%d%d",&L,&R);
			L--; R--;
			for(int j=0;j<K;j++) res.v[j]=0;
			query(1,0,n);
			printf("%d\n",res.v[0]);
		}
		else{
			scanf("%d%d",&L,&D);
			modify(1,0,n);
		}
	}
}
