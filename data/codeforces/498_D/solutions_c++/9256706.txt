#include <algorithm>
#include <cstdio>
using namespace std;

#define MX 100005
int n, qn, qi;
int a[MX];
int nxt[MX];

void update(int i) {
    int j, t;
    
    t = 0;
    for (j = i + 1; j <= n; j++) {
        if (t % a[j] == 0) t += 2;
        else t++;
        if (t == 60) break;
    }
    nxt[i] = j;
}

int main() {
//  freopen("in.txt", "r", stdin);
//  freopen("out.txt", "w", stdout);
    
    int i, x, y, z, tot;
    char s[5];
    
    scanf("%d", &n);
    for (i = 1; i <= n; i++) scanf("%d", &a[i]);
    
    for (i = 0; i <= n; i++) update(i);
    scanf("%d", &qn);
    for (qi = 1; qi <= qn; qi++) {
        scanf("%s%d%d", s, &x, &y);
        if (s[0] == 'A') {
            x--, y--;
            tot = 0;
            for (; (z = nxt[x]) <= y; x = z) tot += 60;
            for (z = x + 1; z <= y; z++) {
                if (tot % a[z] == 0) tot += 2;
                else tot++;
            }
            printf("%d\n", tot);
        }
        else {
            a[x] = y;
            for (z = max(0, x - 60); z < x; z++) update(z);
        }
    }
    return 0;
}