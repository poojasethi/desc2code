#include <cstdio>
#include <iostream>
#include <cstring>
#include <algorithm>
#include <cmath>
#include <vector>
#include <queue>
using namespace std;
const int N=1E5+5;
const int M=10;
int n,m,a[N],f[N][M+1],p,ans,x,y;
char ch;

inline int read()
{
    int x=0,f=1;char ch=getchar();
    while(ch>'9'||ch<'0'){if(ch=='-')f=-1;ch=getchar();}
    while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}
    return x*f;
}

void work(int x)
{
    p=x;
    for (int t=1;t<=60&&p<=n;t++) 
        if (t%a[p]) p++;
    f[x][0]=p;
//  for (int j=1;j<=M;j++) f[x][j]=f[p][j-1];
}

int main()
{
    cin>>n;
    for (int i=1;i<=n;i++) a[i]=read();
    for (int j=0;j<=M;j++) f[n+1][j]=n+1;
    for (int i=n;i;i--) work(i);
    cin>>m;
    for (int i=1;i<=m;i++)
    {
//      cerr<<i<<endl;
        scanf("\n%c",&ch);
        x=read();y=read();
        if (ch=='C')
        {
            a[x]=y;
            for (int j=x;j>=x-60&&j>0;j--) if (f[j][0]>x) work(j);
        } else
        {
            ans=0; p=x;
        //  for (p=x;f[p][M]<y;p=f[p][M]) ans+=60*M;
            for (;f[p][0]<y;p=f[p][0]) ans+=60;
            for (int t=1;;t++) 
            {
                ans++;
                if (t%a[p]) p++;
                if (p==y) break;
            }
            printf("%d\n",ans+1);
        }
    }
}