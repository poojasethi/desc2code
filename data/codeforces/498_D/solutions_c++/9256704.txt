#include <iostream>

using namespace std;

const int primero=1<<17;
const int tope=1<<18;

int n;
int tiempo[tope][60];

void inserta(int pos,int val)
{
  pos+=primero;
  for (int i=0;i<60;i++) {
    if (i%val==0)
      tiempo[pos][i]=2;
    else
      tiempo[pos][i]=1;
  }
  while (pos>1) {
    pos/=2;
    for (int i=0;i<60;i++)
      tiempo[pos][i]=tiempo[2*pos][i]+tiempo[2*pos+1][(i+tiempo[2*pos][i])%60];
  }
}

int tiempori[60];
int nexttiempori[60];

int tiempoentre(int pos0,int pos1)
{
  pos0+=primero;
  pos1+=primero;
  for (int i=0;i<60;i++)
    tiempori[i]=0;
  int t=2;
  while (pos0+1<pos1) {
    if (pos0%2==0) {
      t+=tiempo[pos0+1][t%60];
    }
    pos0/=2;
    if (pos1%2==1) {
      for (int i=0;i<60;i++)
	nexttiempori[i]=tiempo[pos1-1][i]+tiempori[(i+tiempo[pos1-1][i])%60];
      for (int i=0;i<60;i++)
	tiempori[i]=nexttiempori[i];
    }
    pos1/=2;
  }
  return t+tiempori[t%60];
}

int main()
{
  ios::sync_with_stdio(false);
  cin>>n;
  for (int i=1;i<=n;i++) {
    int a;
    cin>>a;
    inserta(i,a);
  }
  int m;
  cin>>m;
  for (int i=0;i<m;i++) {
    char tipo;
    int x,y;
    cin>>tipo>>x>>y;
    if (tipo=='A') {
      cout<<tiempoentre(x,y)<<endl;
    } else {
      inserta(x,y);
    }
  }
}
