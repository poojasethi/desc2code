//hoax submission
#include <cstdio>
#include <iostream>
const int N = 100005;
using namespace std;
int n,a[N],t[N*4][60],q,x,y,s;
void build(int k,int l,int r){
    if(l==r){
        for(int i=0;i<60;++i)
            t[k][i]=(i%a[l]==0 ? 1:0)+1;
        return;
    }
    int mid=(l+r)>>1;
    build(k*2,l,mid);
    build(k*2+1,mid+1,r);
    for(int i=0;i<60;++i)
        t[k][i]=t[k*2][i]+t[k*2+1][(i+t[k*2][i])%60];
}
int query(int k,int l,int r){
    int res=0;
    if(x<=l && r<=y){
        res=t[k][s];
        s=(s+t[k][s])%60;
        return res;
    }
    int mid=(l+r)>>1;
    if(x<=mid)res+=query(k*2,l,mid);
    if(y>mid)res+=query(k*2+1,mid+1,r);
    return res;
}
void modify(int k,int l,int r){
    if(l==r){
        for(int i=0;i<60;++i)
            t[k][i]=(i%y==0 ? 1:0)+1;
        return;
    }
    int mid=(l+r)>>1;
    if(x<=mid)modify(k*2,l,mid);
    else modify(k*2+1,mid+1,r);
    for(int i=0;i<60;++i)
        t[k][i]=t[k*2][i]+t[k*2+1][(i+t[k*2][i])%60];
}
int main(){
    scanf("%d",&n);
    for(int i=1;i<=n;++i)scanf("%d",&a[i]);
    build(1,1,n);
    scanf("%d",&q);
    char ss[5];
    while(q-- > 0){
        scanf("%s", ss);
        char c = ss[0];
        scanf("%d%d",&x,&y);
        if(c=='A')--y,s=0,printf("%d\n",query(1,1,n));
        if(c=='C')modify(1,1,n);
    }
    return 0;
}