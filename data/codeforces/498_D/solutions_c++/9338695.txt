#include <algorithm>
#include <iostream>
#include <cstdio>

using namespace std;

#define M        60
#define ARR_MAX  100005

short int jam[ARR_MAX];
int farthest[ARR_MAX];
int n,m;

void next(int &t,int &cur) {
	if(t%jam[cur]==0) t+=2;
	else t++;
	cur++;
}

int get_farthest(int cur) {
	int tm=0;
	while(tm < M && cur <= n) next(tm,cur);
	return cur;
}

int main() {
	scanf("%d",&n);
	for(int i=1;i<=n;i++) cin>>jam[i];
	for(int i=1;i<=n;i++)
		farthest[i]=get_farthest(i);
	char cmd[2];int x,y;scanf("%d",&m);
	while(m--) {
		scanf("%s%d%d",cmd,&x,&y);
		if(cmd[0]=='A') {
			int ans=0;
			while(farthest[x] < y) {
				x = farthest[x];
				ans += M;
			}
			while(x < y) next(ans,x);
			printf("%d\n",ans);
		}else {
			jam[x]=y;
			for(int i=max(1,x-M);i<x;i++)
				farthest[i]=get_farthest(i);
		}
	}
	return 0;
}