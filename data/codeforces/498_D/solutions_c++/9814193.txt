#include<cstdio>
#include<cstdlib>
#include<algorithm>
#include<cstring>
#define MAXN 100005
#define M 60
using namespace std ;
typedef long long LL ;

int N, Q ;
int go[MAXN], a[MAXN] ;

int Step(int x, int t) {return 1+(t%a[x]==0) ;}
int Work(int x)
{
	int tmp = 0 ;
	while(tmp < M && x <= N) tmp += Step(x, tmp), x ++ ;
	return x ;
}
int main()
{
	char ss[10] ;
	int fr, to ;
	int i, j ;
	scanf("%d", &N) ;
	for(i = 1; i <= N; i ++) scanf("%d", &a[i]) ;
	for(i = 1; i <= N; i ++) go[i] = Work(i) ;
	scanf("%d", &Q) ;
	while(Q --)
	{
		scanf("%s%d%d", ss, &fr, &to) ;
		if(ss[0] == 'A')
		{
			int ans = 0 ;
			while(go[fr] < to)
				fr = go[fr], ans += M ;
			while(fr < to)
				ans += Step(fr, ans), fr ++ ;
			printf("%d\n", ans) ;
		}
		else 
		{
			a[fr] = to ;
			for(i = fr; i >= 1 && go[i] >= fr; i --)
				go[i] = Work(i) ;
		}
	}
	//system("pause") ;
	return 0 ;
}
