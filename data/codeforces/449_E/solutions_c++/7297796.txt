#include <iostream>
#include <cstdio>
using namespace std;
typedef long long LL;
#define N 1000010
#define mod 1000000007LL
LL phi[N], sum[N], f[3][N];

void get_phi(){
	phi[1] = 0;
	for (int i = 2; i < N; i ++) 
		if (!phi[i]) {
			phi[i] = i - 1;
			for (int j = i; j < N; j += i) {
				if (!phi[j]) {
					if ((j / i) % i == 0) phi[j] = phi[j / i] * i;
					else phi[j] = phi[j / i] * (i - 1);
				}
			}
		}
}

void get_gcd_sum(int x = 0){
	for (int i = 1; i < N; i ++)
		for (int j = 2 * i; j < N; j += i)
			sum[j] += phi[j / i] * i;
}

void get_f(){
	f[0][1] = f[1][1] = f[2][1] = 1;
	for (LL i = 2; i < N; i ++) {
		f[0][i] = (2 * i - i * i + (i - 1) * i * (2 * i - 1) / 3 + 2 * sum[i]) % mod;
		f[1][i] = (f[0][i] * i) % mod;
		f[2][i] = (f[1][i] * i) % mod;
	}
	for (int j = 0; j < 3; j ++) 
		for (int i = 2; i < N; i ++) 
			f[j][i] = (f[j][i] + f[j][i - 1]) % mod;
}



int main() {
	get_phi();
	get_gcd_sum();
	get_f();
	int k, l;
	LL m, n, res;
	scanf("%d", &k);
	for (int i = 0; i < k; i ++) {
		scanf("%I64d%I64d", &m, &n);
		l = min(m, n); m ++; n ++;
		res = 0;
		res += (((m * n) % mod) * f[0][l]) % mod;
		res -= (((m + n) * f[1][l])) % mod;
		res += f[2][l];
		res = res % mod; 
		if (res < 0) res += mod;
		printf("%I64d\n", res);
	}
	return 0;
}
