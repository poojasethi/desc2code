#include <algorithm>
#include <cstring>
#include <cstdlib>
#include <cstdio>
#include <vector>
#include <ctime>
#define fi first
#define se second
#define PA pair<int,int>
#define VI vector<int>
#define VP vector<PA >
#define mk(x,y) make_pair(x,y)
#define N 1000010
#define mo 1000000007
#define int64 long long
#define For(i,x,y) for (i=x;i<=y;i++)
using namespace std;
int i,j,k,n,m,T;
int f[N],p[N],phi[N],s[N],f1[N],f2[N],f3[N];
VI a[N];
inline int64 F(int64 L,int64 i) {
	return (L*L+2*i*i-2*i*L-2*L+2*__gcd(i,L))%mo;
}
int main() {
	For(i,1,N-1) for (j=i;j<N;j+=i) a[j].push_back(i);
	phi[1]=1;
	For(i,2,N-1) {
		if (!f[i]) f[i]=p[++*p]=i,phi[i]=i-1;
		for (j=1;j<=*p&&p[j]<=f[i]&&i*p[j]<N;j++) {
			int A=i*p[j];
			f[A]=p[j];
			phi[A]=phi[i]*(p[j]<f[i]?p[j]-1:p[j]);
		}
	}
	For(i,1,N-1) {
		n=i/2-(i%2==0);
		s[i]=(1ll*n*i*i%mo-2ll*n*i+1ll*n*(n+1)*(2*n+1)/3%mo-1ll*i*n*(n+1)%mo)%mo;
		//For(j,1,n) s[i]=(s[i]+F(i,j))%mo;
		s[i]=((i%2==0)*F(i,i/2)+F(i,0)+s[i]*2)%mo;
		for (j=0;j<a[i].size();j++) {
			int A=a[i][j];
			s[i]=(4ll*phi[A]*(n/A)+s[i])%mo;
		}
	}
	For(i,1,N-1) {
		f1[i]=(f1[i-1]+s[i])%mo;
		f2[i]=(1ll*i*s[i]+f2[i-1])%mo;
		f3[i]=(1ll*i*i%mo*s[i]+f3[i-1])%mo;
	}
	scanf("%d",&T);
	for (;T;T--) {
		scanf("%d%d",&n,&m);
		int x=min(n,m);
		int an=(1ll*(n+1)*(m+1)%mo*f1[x]-1ll*(n+m+2)*f2[x]+f3[x])%mo;
		if (an<0) an+=mo;
		printf("%d\n",an);
	}
	return 0;
}
