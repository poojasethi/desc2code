#include <cstdio>
#include <map>
#include <vector>
#include <cstring>
#include <iostream>
#define rep(i,a,b) for (int i=a;i<=(int)(b);++i)
#define REP(i,a) for (int i=0; i < (int)(a); ++i)
#define fi first
#define se second
#define ll long long 
#define mp make_pair
#define pb push_back
#define d(x) cout<<x<<endl
#define mod (1000000007ll)
using namespace std;

const int N=1000000, nn = N + 10;

ll is[nn],phi[nn],s[nn],s0[nn],s1[nn],s2[nn],c1[nn],c2[nn],c3[nn];

void add(ll &x,ll y) {
	x = (x + y)%mod;
}
ll calc(ll x,ll y,ll z) {
	if (x%3==0) x/=3;else
	if (y%3==0) y/=3;else
	if (z%3==0) z/=3;
	return (ll)x*(ll)y%mod*(ll)z%mod;
}
int main() {
	rep(i,1,N) is[i]=1,phi[i]=i;
	is[1] = 0;
	rep(i,2,N) {
		if (!is[i]) continue;
		phi[i]--;
		for (int j=i+i;j<=N;j+=i) is[j]=0, phi[j]=phi[j]/i*(i-1);
	}
	rep(k,1,N)
		for (int i = k; i<=N; i += k)
			add(s[i],phi[i/k]*k);
	rep(i,1,N) {
		add(s0[i] ,s0[i-1] + s[i]);
		add(s1[i], s1[i-1] + (ll)i*(ll)s[i]%mod);
		add(s2[i], s2[i-1] + (ll)i*(ll)i%mod*(ll)s[i]%mod);
		ll L = i;
		ll tmp = ((ll)calc(L,L+1,2*L+1) - 3ll*L*L) % mod;
		add(c1[i], c1[i-1]+tmp);
		add(c2[i], c2[i-1]+tmp*(ll)i%mod);
		add(c3[i], c3[i-1]+tmp*(ll)i%mod*(ll)i%mod);
	}
	int q; scanf("%d",&q);
	while (q--) {
		int n,m; scanf("%d%d",&n,&m);
		if (n > m) swap(n,m);
		ll ans = (ll)(n+1)*(ll)(m+1)%mod*( c1[n] + 2ll*s0[n]) % mod
		+(c3[n] + 2ll*s2[n])%mod -
		(ll)( c2[n] + s1[n]*2ll%mod )%mod*(ll)(m+n+2)%mod;
		ans%=mod;
		d((ans+mod) % mod);
		
	}
	return 0;
}


