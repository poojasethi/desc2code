#include<cstdio>
#include<cmath>
#include<iostream>
#include<algorithm>
using namespace std;
const int maxn=100010;
const double eps=1e-8,G=9.8;
int n,i,j,q[maxn],m;
struct pt{double x,y;}p[maxn],ans[maxn];
double v,a[maxn];
double high(int k,double x){
	double t=x/(v*cos(a[k]));
	return v*sin(a[k])*t-G*t*t/2.0;
}
bool cmp(pt a,pt b){return a.x<b.x;}
bool cmp2(int x,int y){return a[x]<a[y];}
int main(){
    //freopen("AC.in","r",stdin);
    //freopen("AC.out","w",stdout);
	scanf("%d%lf",&n,&v);
	for(i=0;i<n;q[i]=i++)
        scanf("%lf",a+i);
	scanf("%d",&m);
	for(i=0;i<m;i++)scanf("%lf%lf",&p[i].x,&p[i].y);
	sort(p,p+m,cmp);
	sort(q,q+n,cmp2);
	for(i=j=0;i<n;i++){
		for(;j<m&&high(q[i],p[j].x)-p[j].y>eps;j++);
		if(high(q[i],p[j].x)<eps||j==m)ans[q[i]].x=v*v*sin(2*a[q[i]])/G,ans[q[i]].y=0.0;
		else ans[q[i]]=(pt){p[j].x,high(q[i],p[j].x)};
	}
	for(i=0;i<n;i++)
		printf("%.10lf %.10lf\n",ans[i].x,ans[i].y);
	return 0;
}
